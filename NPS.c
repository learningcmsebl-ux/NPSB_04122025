typedef unsigned char   undefined;

typedef unsigned char    byte;
typedef unsigned char    dwfenc;
typedef unsigned int    dword;
typedef long long    longlong;
typedef unsigned long    qword;
typedef long    sqword;
typedef unsigned char    uchar;
typedef unsigned int    uint;
typedef unsigned long long    uint16;
typedef unsigned long    ulong;
typedef unsigned long long    ulonglong;
typedef unsigned char    undefined1;
typedef unsigned short    undefined2;
typedef unsigned int    undefined3;
typedef unsigned int    undefined4;
typedef unsigned long    undefined5;
typedef unsigned long    undefined7;
typedef unsigned long    undefined8;
typedef unsigned short    ushort;
typedef unsigned short    word;
typedef struct eh_frame_hdr eh_frame_hdr, *Peh_frame_hdr;

struct eh_frame_hdr {
    byte eh_frame_hdr_version; // Exception Handler Frame Header Version
    dwfenc eh_frame_pointer_encoding; // Exception Handler Frame Pointer Encoding
    dwfenc eh_frame_desc_entry_count_encoding; // Encoding of # of Exception Handler FDEs
    dwfenc eh_frame_table_encoding; // Exception Handler Table Encoding
};

typedef struct fde_table_entry fde_table_entry, *Pfde_table_entry;

struct fde_table_entry {
    dword initial_loc; // Initial Location
    dword data_loc; // Data location
};

typedef ushort sa_family_t;

typedef void _IO_lock_t;

typedef struct _IO_marker _IO_marker, *P_IO_marker;

typedef struct _IO_FILE _IO_FILE, *P_IO_FILE;

typedef long __off_t;

typedef long __off64_t;

typedef ulong size_t;

struct _IO_FILE {
    int _flags;
    char *_IO_read_ptr;
    char *_IO_read_end;
    char *_IO_read_base;
    char *_IO_write_base;
    char *_IO_write_ptr;
    char *_IO_write_end;
    char *_IO_buf_base;
    char *_IO_buf_end;
    char *_IO_save_base;
    char *_IO_backup_base;
    char *_IO_save_end;
    struct _IO_marker *_markers;
    struct _IO_FILE *_chain;
    int _fileno;
    int _flags2;
    __off_t _old_offset;
    ushort _cur_column;
    char _vtable_offset;
    char _shortbuf[1];
    _IO_lock_t *_lock;
    __off64_t _offset;
    void *__pad1;
    void *__pad2;
    void *__pad3;
    void *__pad4;
    size_t __pad5;
    int _mode;
    char _unused2[20];
};

struct _IO_marker {
    struct _IO_marker *_next;
    struct _IO_FILE *_sbuf;
    int _pos;
};

typedef struct stat stat, *Pstat;

typedef ulong __dev_t;

typedef ulong __ino_t;

typedef ulong __nlink_t;

typedef uint __mode_t;

typedef uint __uid_t;

typedef uint __gid_t;

typedef long __blksize_t;

typedef long __blkcnt_t;

typedef struct timespec timespec, *Ptimespec;

typedef long __time_t;

struct timespec {
    __time_t tv_sec;
    long tv_nsec;
};

struct stat {
    __dev_t st_dev;
    __ino_t st_ino;
    __nlink_t st_nlink;
    __mode_t st_mode;
    __uid_t st_uid;
    __gid_t st_gid;
    int __pad0;
    __dev_t st_rdev;
    __off_t st_size;
    __blksize_t st_blksize;
    __blkcnt_t st_blocks;
    struct timespec st_atim;
    struct timespec st_mtim;
    struct timespec st_ctim;
    long __unused[3];
};

typedef void * (CRYPTO_MEM_LEAK_CB)(ulong, char *, int, int, void *);

typedef struct crypto_threadid_st crypto_threadid_st, *Pcrypto_threadid_st;

struct crypto_threadid_st {
    void *ptr;
    ulong val;
};

typedef struct crypto_threadid_st CRYPTO_THREADID;

typedef struct st_CRYPTO_EX_DATA_IMPL st_CRYPTO_EX_DATA_IMPL, *Pst_CRYPTO_EX_DATA_IMPL;

struct st_CRYPTO_EX_DATA_IMPL {
};

typedef struct bio_st bio_st, *Pbio_st;

typedef struct bio_method_st bio_method_st, *Pbio_method_st;

typedef struct bio_st BIO;

typedef void (bio_info_cb)(struct bio_st *, int, char *, int, long, long);

typedef struct bio_method_st BIO_METHOD;

typedef struct crypto_ex_data_st crypto_ex_data_st, *Pcrypto_ex_data_st;

typedef struct crypto_ex_data_st CRYPTO_EX_DATA;

typedef struct stack_st_void stack_st_void, *Pstack_st_void;

typedef struct stack_st stack_st, *Pstack_st;

typedef struct stack_st _STACK;

struct crypto_ex_data_st {
    struct stack_st_void *sk;
    int dummy;
};

struct bio_method_st {
    int type;
    char *name;
    int (*bwrite)(BIO *, char *, int);
    int (*bread)(BIO *, char *, int);
    int (*bputs)(BIO *, char *);
    int (*bgets)(BIO *, char *, int);
    long (*ctrl)(BIO *, int, long, void *);
    int (*create)(BIO *);
    int (*destroy)(BIO *);
    long (*callback_ctrl)(BIO *, int, bio_info_cb *);
};

struct stack_st {
    int num;
    char **data;
    int sorted;
    int num_alloc;
    int (*comp)(void *, void *);
};

struct bio_st {
    BIO_METHOD *method;
    long (*callback)(struct bio_st *, int, char *, int, long, long);
    char *cb_arg;
    int init;
    int shutdown;
    int flags;
    int retry_reason;
    int num;
    void *ptr;
    struct bio_st *next_bio;
    struct bio_st *prev_bio;
    int references;
    ulong num_read;
    ulong num_write;
    CRYPTO_EX_DATA ex_data;
};

struct stack_st_void {
    _STACK stack;
};

typedef struct st_CRYPTO_EX_DATA_IMPL CRYPTO_EX_DATA_IMPL;

typedef struct CRYPTO_dynlock_value CRYPTO_dynlock_value, *PCRYPTO_dynlock_value;

struct CRYPTO_dynlock_value {
};

typedef struct lhash_st lhash_st, *Plhash_st;

typedef struct lhash_st _LHASH;

typedef struct lhash_node_st lhash_node_st, *Plhash_node_st;

typedef struct lhash_node_st LHASH_NODE;

typedef int (*LHASH_COMP_FN_TYPE)(void *, void *);

typedef ulong (*LHASH_HASH_FN_TYPE)(void *);

struct lhash_st {
    LHASH_NODE **b;
    LHASH_COMP_FN_TYPE comp;
    LHASH_HASH_FN_TYPE hash;
    uint num_nodes;
    uint num_alloc_nodes;
    uint p;
    uint pmax;
    ulong up_load;
    ulong down_load;
    ulong num_items;
    ulong num_expands;
    ulong num_expand_reallocs;
    ulong num_contracts;
    ulong num_contract_reallocs;
    ulong num_hash_calls;
    ulong num_comp_calls;
    ulong num_insert;
    ulong num_replace;
    ulong num_delete;
    ulong num_no_delete;
    ulong num_retrieve;
    ulong num_retrieve_miss;
    ulong num_hash_comps;
    int error;
};

struct lhash_node_st {
    void *data;
    struct lhash_node_st *next;
    ulong hash;
};

typedef void (*LHASH_DOALL_ARG_FN_TYPE)(void *, void *);

typedef void (*LHASH_DOALL_FN_TYPE)(void *);

typedef struct _IO_FILE FILE;

typedef struct sockaddr sockaddr, *Psockaddr;

struct sockaddr {
    sa_family_t sa_family;
    char sa_data[14];
};

typedef uint __socklen_t;

typedef __socklen_t socklen_t;

typedef long __ssize_t;

typedef __ssize_t ssize_t;

typedef int __key_t;

typedef __key_t key_t;

typedef int __pid_t;

typedef long __suseconds_t;

typedef long __clock_t;

typedef struct hostent hostent, *Phostent;

struct hostent {
    char *h_name;
    char **h_aliases;
    int h_addrtype;
    int h_length;
    char **h_addr_list;
};

typedef struct bignum_st bignum_st, *Pbignum_st;

typedef struct bignum_st BIGNUM;

struct bignum_st {
    ulong *d;
    int top;
    int dmax;
    int neg;
    int flags;
};

typedef struct asn1_string_st asn1_string_st, *Pasn1_string_st;

typedef struct asn1_string_st ASN1_STRING;

struct asn1_string_st {
    int length;
    int type;
    uchar *data;
    long flags;
};

typedef struct evp_pkey_ctx_st evp_pkey_ctx_st, *Pevp_pkey_ctx_st;

typedef struct evp_pkey_ctx_st EVP_PKEY_CTX;

struct evp_pkey_ctx_st {
};

typedef struct st_ERR_FNS st_ERR_FNS, *Pst_ERR_FNS;

struct st_ERR_FNS {
};

typedef void (CRYPTO_EX_free)(void *, void *, CRYPTO_EX_DATA *, int, long, void *);

typedef int (CRYPTO_EX_new)(void *, void *, CRYPTO_EX_DATA *, int, long, void *);

typedef int (CRYPTO_EX_dup)(CRYPTO_EX_DATA *, CRYPTO_EX_DATA *, void *, int, long, void *);

typedef struct st_ERR_FNS ERR_FNS;

typedef union pthread_mutex_t pthread_mutex_t, *Ppthread_mutex_t;

typedef struct __pthread_mutex_s __pthread_mutex_s, *P__pthread_mutex_s;

typedef struct __pthread_internal_list __pthread_internal_list, *P__pthread_internal_list;

typedef struct __pthread_internal_list __pthread_list_t;

struct __pthread_internal_list {
    struct __pthread_internal_list *__prev;
    struct __pthread_internal_list *__next;
};

struct __pthread_mutex_s {
    int __lock;
    uint __count;
    int __owner;
    uint __nusers;
    int __kind;
    int __spins;
    __pthread_list_t __list;
};

union pthread_mutex_t {
    struct __pthread_mutex_s __data;
    char __size[40];
    long __align;
};

typedef union pthread_condattr_t pthread_condattr_t, *Ppthread_condattr_t;

union pthread_condattr_t {
    char __size[4];
    int __align;
};

typedef union pthread_mutexattr_t pthread_mutexattr_t, *Ppthread_mutexattr_t;

union pthread_mutexattr_t {
    char __size[4];
    int __align;
};

typedef union pthread_cond_t pthread_cond_t, *Ppthread_cond_t;

typedef struct _struct_16 _struct_16, *P_struct_16;

struct _struct_16 {
    int __lock;
    uint __futex;
    ulonglong __total_seq;
    ulonglong __wakeup_seq;
    ulonglong __woken_seq;
    void *__mutex;
    uint __nwaiters;
    uint __broadcast_seq;
};

union pthread_cond_t {
    struct _struct_16 __data;
    char __size[48];
    longlong __align;
};

typedef ulong pthread_t;

typedef union pthread_attr_t pthread_attr_t, *Ppthread_attr_t;

union pthread_attr_t {
    char __size[56];
    long __align;
};

typedef struct err_state_st err_state_st, *Perr_state_st;

struct err_state_st {
    CRYPTO_THREADID tid;
    int err_flags[16];
    ulong err_buffer[16];
    char *err_data[16];
    int err_data_flags[16];
    char *err_file[16];
    int err_line[16];
    int top;
    int bottom;
};

typedef struct err_state_st ERR_STATE;

typedef struct ERR_string_data_st ERR_string_data_st, *PERR_string_data_st;

struct ERR_string_data_st {
    ulong error;
    char *string;
};

typedef struct lhash_st_ERR_STATE lhash_st_ERR_STATE, *Plhash_st_ERR_STATE;

struct lhash_st_ERR_STATE {
};

typedef struct ERR_string_data_st ERR_STRING_DATA;

typedef struct lhash_st_ERR_STRING_DATA lhash_st_ERR_STRING_DATA, *Plhash_st_ERR_STRING_DATA;

struct lhash_st_ERR_STRING_DATA {
};

typedef union sigval sigval, *Psigval;

typedef union sigval sigval_t;

union sigval {
    int sival_int;
    void *sival_ptr;
};

typedef union _union_1441 _union_1441, *P_union_1441;

typedef struct _struct_1442 _struct_1442, *P_struct_1442;

typedef struct _struct_1443 _struct_1443, *P_struct_1443;

typedef struct _struct_1444 _struct_1444, *P_struct_1444;

typedef struct _struct_1445 _struct_1445, *P_struct_1445;

typedef struct _struct_1446 _struct_1446, *P_struct_1446;

typedef struct _struct_1447 _struct_1447, *P_struct_1447;

struct _struct_1445 {
    __pid_t si_pid;
    __uid_t si_uid;
    int si_status;
    __clock_t si_utime;
    __clock_t si_stime;
};

struct _struct_1444 {
    __pid_t si_pid;
    __uid_t si_uid;
    sigval_t si_sigval;
};

struct _struct_1443 {
    int si_tid;
    int si_overrun;
    sigval_t si_sigval;
};

struct _struct_1446 {
    void *si_addr;
};

struct _struct_1442 {
    __pid_t si_pid;
    __uid_t si_uid;
};

struct _struct_1447 {
    long si_band;
    int si_fd;
};

union _union_1441 {
    int _pad[28];
    struct _struct_1442 _kill;
    struct _struct_1443 _timer;
    struct _struct_1444 _rt;
    struct _struct_1445 _sigchld;
    struct _struct_1446 _sigfault;
    struct _struct_1447 _sigpoll;
};

typedef struct siginfo siginfo, *Psiginfo;

struct siginfo {
    int si_signo;
    int si_errno;
    int si_code;
    union _union_1441 _sifields;
};

typedef struct siginfo siginfo_t;

typedef struct asn1_object_st asn1_object_st, *Pasn1_object_st;

typedef struct asn1_object_st ASN1_OBJECT;

struct asn1_object_st {
    char *sn;
    char **ln;
    int nid;
    int length;
    uchar *data;
    int flags;
};

typedef struct asn1_ctx_st asn1_ctx_st, *Pasn1_ctx_st;

typedef struct asn1_ctx_st ASN1_CTX;

struct asn1_ctx_st {
    uchar *p;
    int eos;
    int error;
    int inf;
    int tag;
    int xclass;
    long slen;
    uchar *max;
    uchar *q;
    uchar **pp;
    int line;
};

typedef struct asn1_const_ctx_st asn1_const_ctx_st, *Pasn1_const_ctx_st;

typedef struct asn1_const_ctx_st ASN1_const_CTX;

struct asn1_const_ctx_st {
    uchar *p;
    int eos;
    int error;
    int inf;
    int tag;
    int xclass;
    long slen;
    uchar *max;
    uchar *q;
    uchar **pp;
    int line;
};

typedef struct SHA256state_st SHA256state_st, *PSHA256state_st;

struct SHA256state_st {
    uint h[8];
    uint Nl;
    uint Nh;
    uint data[16];
    uint num;
    uint md_len;
};

typedef struct SHA256state_st SHA256_CTX;

typedef long __syscall_slong_t;


// WARNING! conflicting data type names: /DWARF/__off64_t - /types.h/__off64_t

typedef dword uint32_t;

typedef uchar uint8_t;

typedef ulong sizetype;

typedef word uint16_t;

typedef struct sqlexd.conflict8 sqlexd.conflict8, *Psqlexd.conflict8;

typedef struct sqladts sqladts, *Psqladts;

typedef struct sqltdss sqltdss, *Psqltdss;

typedef struct sqltvn sqltvn, *Psqltvn;

struct sqlexd.conflict8 {
    ulong sqlvsn;
    uint arrsiz;
    uint iters;
    uint offset;
    ushort selerr;
    ushort sqlety;
    uint occurs;
    short *cud;
    uchar *sqlest;
    char *stmt;
    struct sqladts *sqladtp;
    struct sqltdss *sqltdsp;
    uchar **sqphsv;
    ulong *sqphsl;
    int *sqphss;
    short **sqpind;
    int *sqpins;
    ulong *sqparm;
    ulong **sqparc;
    ushort *sqpadto;
    ushort *sqptdso;
    uint sqlcmax;
    uint sqlcmin;
    uint sqlcincr;
    uint sqlctimeout;
    uint sqlcnowait;
    int sqfoff;
    uint sqcmod;
    uint sqfmod;
    uchar *sqhstv[8];
    ulong sqhstl[8];
    int sqhsts[8];
    short *sqindv[8];
    int sqinds[8];
    ulong sqharm[8];
    ulong *sqharc[8];
    ushort sqadto[8];
    ushort sqtdso[8];
};

struct sqltdss {
    uint tdsvsn;
    ushort tdsnum;
    uchar *tdsval[1];
};

struct sqltvn {
    uchar *tvnvsn;
    ushort tvnvsnl;
    uchar *tvnnm;
    ushort tvnnml;
    uchar *tvnsnm;
    ushort tvnsnml;
};

struct sqladts {
    uint adtvsn;
    ushort adtmode;
    ushort adtnum;
    struct sqltvn adttvn[1];
};

typedef struct anon_struct_260_2_43c7b5cf anon_struct_260_2_43c7b5cf, *Panon_struct_260_2_43c7b5cf;

struct anon_struct_260_2_43c7b5cf {
    ushort len;
    uchar arr[257];
};

typedef struct anon_struct_26_2_43c7b5cf anon_struct_26_2_43c7b5cf, *Panon_struct_26_2_43c7b5cf;

struct anon_struct_26_2_43c7b5cf {
    ushort len;
    uchar arr[23];
};

typedef struct anon_struct_18_2_43c7b5cf anon_struct_18_2_43c7b5cf, *Panon_struct_18_2_43c7b5cf;

struct anon_struct_18_2_43c7b5cf {
    ushort len;
    uchar arr[16];
};

typedef struct anon_struct_68_2_43c7b5cf anon_struct_68_2_43c7b5cf, *Panon_struct_68_2_43c7b5cf;

struct anon_struct_68_2_43c7b5cf {
    ushort len;
    uchar arr[65];
};

typedef struct anon_struct_10_2_43c7b5cf anon_struct_10_2_43c7b5cf, *Panon_struct_10_2_43c7b5cf;

struct anon_struct_10_2_43c7b5cf {
    ushort len;
    uchar arr[7];
};

typedef struct anon_struct_6_2_43c7b5cf anon_struct_6_2_43c7b5cf, *Panon_struct_6_2_43c7b5cf;

struct anon_struct_6_2_43c7b5cf {
    ushort len;
    uchar arr[4];
};

typedef struct anon_struct_16_2_43c7b5cf anon_struct_16_2_43c7b5cf, *Panon_struct_16_2_43c7b5cf;

struct anon_struct_16_2_43c7b5cf {
    ushort len;
    uchar arr[13];
};

typedef struct anon_struct_8_2_43c7b5cf anon_struct_8_2_43c7b5cf, *Panon_struct_8_2_43c7b5cf;

struct anon_struct_8_2_43c7b5cf {
    ushort len;
    uchar arr[5];
};

typedef struct anon_struct_4_2_43c7b5cf anon_struct_4_2_43c7b5cf, *Panon_struct_4_2_43c7b5cf;

struct anon_struct_4_2_43c7b5cf {
    ushort len;
    uchar arr[2];
};

typedef struct anon_struct_20_2_43c7b5cf anon_struct_20_2_43c7b5cf, *Panon_struct_20_2_43c7b5cf;

struct anon_struct_20_2_43c7b5cf {
    ushort len;
    uchar arr[17];
};

typedef struct anon_struct_8_2_43c7b5cf.conflict anon_struct_8_2_43c7b5cf.conflict, *Panon_struct_8_2_43c7b5cf.conflict;

struct anon_struct_8_2_43c7b5cf.conflict {
    ushort len;
    uchar arr[6];
};

typedef struct anon_struct_14_2_43c7b5cf anon_struct_14_2_43c7b5cf, *Panon_struct_14_2_43c7b5cf;

struct anon_struct_14_2_43c7b5cf {
    ushort len;
    uchar arr[12];
};

typedef struct anon_struct_1028_2_43c7b5cf anon_struct_1028_2_43c7b5cf, *Panon_struct_1028_2_43c7b5cf;

struct anon_struct_1028_2_43c7b5cf {
    ushort len;
    uchar arr[1025];
};

typedef struct anon_struct_36_2_43c7b5cf anon_struct_36_2_43c7b5cf, *Panon_struct_36_2_43c7b5cf;

struct anon_struct_36_2_43c7b5cf {
    ushort len;
    uchar arr[33];
};


// WARNING! conflicting data type names: /DWARF/get_hsm_keys.c/Get_CAVV_Key/anon_struct_6_2_43c7b5cf - /DWARF/get_hsm_keys.c/Get_IM_Key/anon_struct_6_2_43c7b5cf


// WARNING! conflicting data type names: /DWARF/get_hsm_keys.c/Get_UCAF_Key/anon_struct_6_2_43c7b5cf - /DWARF/get_hsm_keys.c/Get_IM_Key/anon_struct_6_2_43c7b5cf

typedef struct SService SService, *PSService;

typedef struct SService TSService;

struct SService {
    char szMti[5];
    char szProcCode[3];
    char szFctCode[4];
    char szSrcAcc[3];
    char szDestAcc[3];
};

typedef struct sig_inf sig_inf, *Psig_inf;

typedef struct sig_inf alrm_inf_t;


// WARNING! conflicting data type names: /DWARF/pthreadtypes.h/pthread_mutex_t - /pthreadtypes.h/pthread_mutex_t

struct sig_inf {
    int flag;
    pthread_t tid;
    int tid_spec;
    int done;
    union pthread_cond_t cond;
    union pthread_mutex_t lock;
};

typedef struct timeou_s timeou_s, *Ptimeou_s;

typedef struct timeou_s timeout_t;

struct timeou_s {
    int indice;
    int delta;
};

typedef struct anon_struct_4100_2_43c7b5cf anon_struct_4100_2_43c7b5cf, *Panon_struct_4100_2_43c7b5cf;

struct anon_struct_4100_2_43c7b5cf {
    ushort len;
    uchar arr[4097];
};

typedef struct STlvProd STlvProd, *PSTlvProd;

typedef struct STlvProd TSTlvProd;

struct STlvProd {
    int nPresent[999];
    int nPosTlv[999];
    int nLength;
    char sTlvData[4098];
};

typedef struct sqlexd.conflict7 sqlexd.conflict7, *Psqlexd.conflict7;

struct sqlexd.conflict7 {
    ulong sqlvsn;
    uint arrsiz;
    uint iters;
    uint offset;
    ushort selerr;
    ushort sqlety;
    uint occurs;
    short *cud;
    uchar *sqlest;
    char *stmt;
    struct sqladts *sqladtp;
    struct sqltdss *sqltdsp;
    uchar **sqphsv;
    ulong *sqphsl;
    int *sqphss;
    short **sqpind;
    int *sqpins;
    ulong *sqparm;
    ulong **sqparc;
    ushort *sqpadto;
    ushort *sqptdso;
    uint sqlcmax;
    uint sqlcmin;
    uint sqlcincr;
    uint sqlctimeout;
    uint sqlcnowait;
    int sqfoff;
    uint sqcmod;
    uint sqfmod;
    uchar *sqhstv[6];
    ulong sqhstl[6];
    int sqhsts[6];
    short *sqindv[6];
    int sqinds[6];
    ulong sqharm[6];
    ulong *sqharc[6];
    ushort sqadto[6];
    ushort sqtdso[6];
};

typedef struct date_t date_t, *Pdate_t;

typedef struct date_t t_date;

struct date_t {
    char jj[2];
    char mm[4];
    char aa[4];
};

typedef __pid_t pid_t;


// WARNING! conflicting data type names: /DWARF/pthreadtypes.h/__pthread_internal_list - /pthreadtypes.h/__pthread_internal_list


// WARNING! conflicting data type names: /DWARF/pthreadtypes.h/__pthread_list_t - /pthreadtypes.h/__pthread_list_t


// WARNING! conflicting data type names: /DWARF/pthreadtypes.h/__pthread_mutex_s - /pthreadtypes.h/__pthread_mutex_s

typedef struct anon_struct_48_8_26092177_for___data anon_struct_48_8_26092177_for___data, *Panon_struct_48_8_26092177_for___data;

struct anon_struct_48_8_26092177_for___data {
    int __lock;
    uint __futex;
    ulonglong __total_seq;
    ulonglong __wakeup_seq;
    ulonglong __woken_seq;
    void *__mutex;
    uint __nwaiters;
    uint __broadcast_seq;
};

typedef struct SSubTagNps SSubTagNps, *PSSubTagNps;

typedef struct SSubTagNps TSSubTagNps;

struct SSubTagNps {
    int nPresent[300];
    int nPosTag[300];
    int nLength;
    char sSubData[999];
};

typedef struct SNpsInfo SNpsInfo, *PSNpsInfo;

struct SNpsInfo {
    int nFieldPos[129];
    int nMsgType;
    int nLength;
    char sHeader[1];
    char sBitMap[17];
    char sData[2048];
};

typedef struct SNpsInfo TSNpsInfo;

typedef struct STagNps STagNps, *PSTagNps;

typedef struct STagNps TSTagNps;

struct STagNps {
    int nPresent[100];
    int nPosTag[100];
    int nLength;
    char sChipData[258];
};

typedef struct sqlcxp.conflict3 sqlcxp.conflict3, *Psqlcxp.conflict3;

struct sqlcxp.conflict3 {
    ushort fillen;
    char filnam[21];
};

typedef struct sqlexd.conflict2 sqlexd.conflict2, *Psqlexd.conflict2;

struct sqlexd.conflict2 {
    ulong sqlvsn;
    uint arrsiz;
    uint iters;
    uint offset;
    ushort selerr;
    ushort sqlety;
    uint occurs;
    short *cud;
    uchar *sqlest;
    char *stmt;
    struct sqladts *sqladtp;
    struct sqltdss *sqltdsp;
    uchar **sqphsv;
    ulong *sqphsl;
    int *sqphss;
    short **sqpind;
    int *sqpins;
    ulong *sqparm;
    ulong **sqparc;
    ushort *sqpadto;
    ushort *sqptdso;
    uint sqlcmax;
    uint sqlcmin;
    uint sqlcincr;
    uint sqlctimeout;
    uint sqlcnowait;
    int sqfoff;
    uint sqcmod;
    uint sqfmod;
    uchar *sqhstv[2];
    ulong sqhstl[2];
    int sqhsts[2];
    short *sqindv[2];
    int sqinds[2];
    ulong sqharm[2];
    ulong *sqharc[2];
    ushort sqadto[2];
    ushort sqtdso[2];
};


// WARNING! conflicting data type names: /DWARF/siginfo.h/siginfo_t - /siginfo.h/siginfo_t

typedef __clock_t __sigchld_clock_t;

typedef union anon_union_112_8_26c2b70a_for__sifields anon_union_112_8_26c2b70a_for__sifields, *Panon_union_112_8_26c2b70a_for__sifields;

typedef struct anon_struct_8_2_0a3d7222_for__kill anon_struct_8_2_0a3d7222_for__kill, *Panon_struct_8_2_0a3d7222_for__kill;

typedef struct anon_struct_16_3_5124685d_for__timer anon_struct_16_3_5124685d_for__timer, *Panon_struct_16_3_5124685d_for__timer;

typedef struct anon_struct_16_3_9bedbd60_for__rt anon_struct_16_3_9bedbd60_for__rt, *Panon_struct_16_3_9bedbd60_for__rt;

typedef struct anon_struct_32_5_7a6ff138_for__sigchld anon_struct_32_5_7a6ff138_for__sigchld, *Panon_struct_32_5_7a6ff138_for__sigchld;

typedef struct anon_struct_8_1_ff5bff1a_for__sigfault anon_struct_8_1_ff5bff1a_for__sigfault, *Panon_struct_8_1_ff5bff1a_for__sigfault;

typedef struct anon_struct_16_2_3c0246b2_for__sigpoll anon_struct_16_2_3c0246b2_for__sigpoll, *Panon_struct_16_2_3c0246b2_for__sigpoll;

typedef struct anon_struct_16_3_349d2ff7_for__sigsys anon_struct_16_3_349d2ff7_for__sigsys, *Panon_struct_16_3_349d2ff7_for__sigsys;

struct anon_struct_16_2_3c0246b2_for__sigpoll {
    long si_band;
    int si_fd;
};

struct anon_struct_16_3_5124685d_for__timer {
    int si_tid;
    int si_overrun;
    sigval_t si_sigval;
};

struct anon_struct_8_2_0a3d7222_for__kill {
    __pid_t si_pid;
    __uid_t si_uid;
};

struct anon_struct_32_5_7a6ff138_for__sigchld {
    __pid_t si_pid;
    __uid_t si_uid;
    int si_status;
    __sigchld_clock_t si_utime;
    __sigchld_clock_t si_stime;
};

struct anon_struct_16_3_349d2ff7_for__sigsys {
    void *_call_addr;
    int _syscall;
    uint _arch;
};

struct anon_struct_16_3_9bedbd60_for__rt {
    __pid_t si_pid;
    __uid_t si_uid;
    sigval_t si_sigval;
};

struct anon_struct_8_1_ff5bff1a_for__sigfault {
    void *si_addr;
};

union anon_union_112_8_26c2b70a_for__sifields {
    int _pad[28];
    struct anon_struct_8_2_0a3d7222_for__kill _kill;
    struct anon_struct_16_3_5124685d_for__timer _timer;
    struct anon_struct_16_3_9bedbd60_for__rt _rt;
    struct anon_struct_32_5_7a6ff138_for__sigchld _sigchld;
    struct anon_struct_8_1_ff5bff1a_for__sigfault _sigfault;
    struct anon_struct_16_2_3c0246b2_for__sigpoll _sigpoll;
    struct anon_struct_16_3_349d2ff7_for__sigsys _sigsys;
};

typedef struct SNodeStruct SNodeStruct, *PSNodeStruct;

typedef struct SNodeStruct TSNodeStruct;

typedef __time_t time_t;

typedef struct SNodeData SNodeData, *PSNodeData;

typedef struct SNodeData TSNodeData;

struct SNodeData {
    time_t tPurgeTime;
    char szFstKey[56];
    char szSndKey[56];
    char szTrdKey[56];
    char szFrtKey[56];
    char szFftKey[56];
    int nFstBufLen;
    char sFstBuf[4096];
    int nSndBufLen;
    char sSndBuf[4096];
    int nFstPrvtDataLen;
    char sFstPrvtData[56];
    int nSndPrvtDataLen;
    char sSndPrvtData[56];
    int nTrdPrvtDataLen;
    char sTrdPrvtData[56];
    int nLineIndexOracleCtx;
};

struct SNodeStruct {
    time_t tCreationTime;
    TSNodeData data;
    struct SNodeStruct *Next;
    union pthread_mutex_t lock;
};

typedef struct sqlcxp.conflict4 sqlcxp.conflict4, *Psqlcxp.conflict4;

struct sqlcxp.conflict4 {
    ushort fillen;
    char filnam[17];
};

typedef struct anon_struct_34_2_43c7b5cf anon_struct_34_2_43c7b5cf, *Panon_struct_34_2_43c7b5cf;

struct anon_struct_34_2_43c7b5cf {
    ushort len;
    uchar arr[32];
};

typedef struct sqlcxp.conflict7 sqlcxp.conflict7, *Psqlcxp.conflict7;

struct sqlcxp.conflict7 {
    ushort fillen;
    char filnam[11];
};

typedef struct anon_struct_22_2_43c7b5cf anon_struct_22_2_43c7b5cf, *Panon_struct_22_2_43c7b5cf;

struct anon_struct_22_2_43c7b5cf {
    ushort len;
    uchar arr[20];
};

typedef struct sigaction sigaction, *Psigaction;

typedef union anon_union_8_2_5ad2d23e_for___sigaction_handler anon_union_8_2_5ad2d23e_for___sigaction_handler, *Panon_union_8_2_5ad2d23e_for___sigaction_handler;

typedef struct __sigset_t __sigset_t, *P__sigset_t;

typedef void (*__sighandler_t)(int);

struct __sigset_t {
    ulong __val[16];
};

union anon_union_8_2_5ad2d23e_for___sigaction_handler {
    __sighandler_t sa_handler;
    void (*sa_sigaction)(int, struct siginfo_t *, void *);
};

struct sigaction {
    union anon_union_8_2_5ad2d23e_for___sigaction_handler __sigaction_handler;
    struct __sigset_t sa_mask;
    int sa_flags;
    void (*sa_restorer)(void);
};

typedef enum E_REPEATABLE {
    NOT_REPEATABLE=0,
    IS_REPEATABLE=1
} E_REPEATABLE;

typedef enum E_LENGTH_UNIT {
    LU_BYTE=0,
    LU_NIBBLES=1,
    LU_QTY=2
} E_LENGTH_UNIT;

typedef enum E_FIELD_LENGTH {
    FL_FIX=0,
    FL_L=1,
    FL_LL=2,
    FL_LLL=3,
    FL_B=4,
    FL_BB=5,
    FL_D=6,
    FL_DD=7,
    FL_QTY=8
} E_FIELD_LENGTH;

typedef struct tlv_field_t tlv_field_t, *Ptlv_field_t;

typedef struct field_info_s field_info_s, *Pfield_info_s;

typedef struct field_info_s field_info_t;

typedef enum E_FIELD_TYPE {
    FT_UNDEF=0,
    FT_SINGLE=1,
    FT_STRUCT_TLV=2,
    FT_STRUCT_STATIC=3,
    FT_STRUCT_BER=4,
    FT_STRUCT_BITMAPPED=5,
    FT_QTY=6
} E_FIELD_TYPE;

typedef enum E_FIELD_FORMAT {
    FF_HEX=0,
    FF_BIN=1,
    FF_BCD=2,
    FF_ALPHA_A=3,
    FF_ALPHA_N=4,
    FF_ALPHA_AN=5,
    FF_ALPHA_ANS=6,
    FF_ALPHA_NS=7,
    FF_Z=8,
    FF_X_BCD=9,
    FF_X_ALPHA_N=10,
    FF_CBCD=11,
    FF_QTY=12
} E_FIELD_FORMAT;

typedef enum E_ALPHA_FORMAT {
    AF_ASCII=0,
    AF_EBCDIC=1,
    AF_QTY=2
} E_ALPHA_FORMAT;

struct field_info_s {
    enum E_FIELD_TYPE eFieldType;
    enum E_FIELD_FORMAT eFormatType;
    enum E_ALPHA_FORMAT eAlphaFormat;
    enum E_FIELD_LENGTH eLengthType;
    enum E_LENGTH_UNIT eLengthUnit;
    int nLength;
    int nPrintPolicy;
    char szPattern[41];
    char szLabel[41];
    char szPropertiesName[65];
};

struct tlv_field_t {
    char szTag[13];
    field_info_t field_info;
    enum E_REPEATABLE eIsRepeatable;
};

typedef struct TlvInfoProperties TlvInfoProperties, *PTlvInfoProperties;

typedef enum E_TL_TYPE {
    TLV_LT_ASCII=0,
    TLV_LT_BIN=1
} E_TL_TYPE;

struct TlvInfoProperties {
    int nTagLen;
    int nLengthLen;
    enum E_TL_TYPE eLengthType;
    enum E_TL_TYPE eTagType;
    int nNbFields;
    struct tlv_field_t tabFieldsInfo[512];
    char szPropertiesName[65];
};

typedef struct TlvInfo TlvInfo, *PTlvInfo;

struct TlvInfo {
    int nLength;
    char sData[1024];
    int nPresent[513];
    int nPosTlv[513];
    int nRepeatedFieldPos[64][2];
    int nNextFreeRFPos;
    struct TlvInfoProperties *pkProperties;
};

typedef struct s_response s_response, *Ps_response;

struct s_response {
    char *reponse;
    char *description;
};

typedef struct s_response t_response;

typedef enum anon_enum_32 {
    MM_NOSEV=0,
    PP_PRINT=0,
    PTHREAD_SCOPE_SYSTEM=0,
    MM_HALT=1,
    MM_HARD=1,
    PP_ENCRYPT=1,
    PTHREAD_SCOPE_PROCESS=1,
    MM_ERROR=2,
    MM_SOFT=2,
    PP_HIDE=2,
    MM_WARNING=3,
    PP_QTY=3,
    MM_FIRM=4,
    MM_INFO=4,
    MM_APPL=8,
    MM_UTIL=16,
    MM_OPSYS=32,
    MM_RECOVER=64,
    MM_NRECOV=128,
    MM_PRINT=256,
    MM_CONSOLE=512
} anon_enum_32;

typedef struct STlvPrivate STlvPrivate, *PSTlvPrivate;

typedef struct STlvPrivate TSTlvPrivate;

struct STlvPrivate {
    int nPresent[999];
    int nPosTlv[999];
    int nLength;
    char sTlvData[2048];
};

typedef struct SHsmCtx SHsmCtx, *PSHsmCtx;

typedef struct SHsmCtx TSHsmCtx;

struct SHsmCtx {
    char szBufferBal[4096];
    int nLenBal;
    int free;
    int status;
    int flag_bal;
    int co_number;
    pthread_t tid;
    union pthread_mutex_t HsmMutex;
    union pthread_cond_t HsmCond;
};

typedef struct sqlcxp.conflict6 sqlcxp.conflict6, *Psqlcxp.conflict6;

struct sqlcxp.conflict6 {
    ushort fillen;
    char filnam[12];
};

typedef struct s_prod_err s_prod_err, *Ps_prod_err;

typedef struct s_prod_err t_prod_err;

struct s_prod_err {
    char *error_code;
    char *error_text;
};


// WARNING! conflicting data type names: /DWARF/libio.h/_IO_marker - /libio.h/_IO_marker


// WARNING! conflicting data type names: /DWARF/libio.h/_IO_FILE - /stdio.h/_IO_FILE

typedef struct SResources SResources, *PSResources;

struct SResources {
    char resource_id[7];
    char resource_code[3];
    char resource_name[17];
    char component_type[5];
    char status[2];
    char subject_of_supervise[2];
    char object_name[61];
    char pris_object_path[61];
    long ipc_critical_level_nb_msg;
    int ipc_critical_percent_freespace;
    int ufs_critical_percent_freespace;
    long ufs_critical_size_freespace;
    int dbts_critical_count_extent;
    char pris_start_script_name[41];
    char pris_start_script_path[61];
    char pris_stop_script_name[41];
    char pris_stop_script_path[61];
    char pris_subject_of_auto_start[2];
    char pris_support_adm_message[2];
    char pris_comms_id[3];
    char pris_protocol_id[3];
    char pris_connect_mode[2];
    char pris_device_name[65];
    char pris_remote_application_name[65];
    char pris_remote_application_id[65];
    char pris_local_application_name[65];
    char pris_local_application_id[65];
    char pris_log_file_name[21];
    int pris_log_max_size;
    int pris_start_cycle;
    int pris_end_cycle;
    char pris_trace_level[2];
    int pris_nb_static_threads;
    int pris_nb_user_threads_vs_kernel;
    int pris_timer_acquirer;
    int pris_delta_timer_iss_acq;
    long pris_echo_test_timer;
    int pris_transaction_sim_max;
    char pris_gen_reversal_timeout_late[2];
    int pris_nb_no_succ_response_stop;
    int pris_nb_timeout_stop;
    int pris_current_cycle;
    char resource_live[2];
    char pris_processing_step[4];
    char pris_internal_id[33];
    pid_t pris_pid;
    pid_t pris_ppid;
    pthread_t pris_thread_id;
    int pris_min_troubles_ind;
    int pris_max_troubles_ind;
    char pris_troubleshoot[2];
    char pris_troubleshoot_upd_resid[7];
    char pris_troubleshoot_update_date[15];
    char pris_bank_code[7];
    char pris_acq_transport_key_number[4];
    char pris_iss_transport_key_number[4];
};

typedef struct SResources TSResources;

typedef struct SAccntType SAccntType, *PSAccntType;

typedef struct SAccntType TSAccntType;

struct SAccntType {
    char *szNwAccntType;
    char *szIsoAccntType;
};

typedef struct STransType STransType, *PSTransType;

typedef struct STransType TSTransType;

struct STransType {
    int nNwMsgType;
    char *szNwTransType;
    char *szIsoTransType;
    char *szIsoFuncCode;
};

typedef struct sqlcxp.conflict13 sqlcxp.conflict13, *Psqlcxp.conflict13;

struct sqlcxp.conflict13 {
    ushort fillen;
    char filnam[30];
};

typedef enum __socket_type {
    SOCK_STREAM=1,
    SOCK_DGRAM=2,
    SOCK_RAW=3,
    SOCK_RDM=4,
    SOCK_SEQPACKET=5,
    SOCK_DCCP=6,
    SOCK_PACKET=10,
    SOCK_NONBLOCK=2048,
    SOCK_CLOEXEC=524288
} __socket_type;


// WARNING! conflicting data type names: /DWARF/stdio.h/FILE - /stdio.h/FILE

typedef struct linger linger, *Plinger;

struct linger {
    int l_onoff;
    int l_linger;
};

typedef struct SParamCtx SParamCtx, *PSParamCtx;

typedef struct SParamCtx TSParamCtx;

typedef void *sql_context;

struct SParamCtx {
    pthread_t ID;
    sql_context ctx;
};

typedef struct oraca oraca, *Poraca;

typedef struct anon_struct_72_2_8d586bf6_for_orastxt anon_struct_72_2_8d586bf6_for_orastxt, *Panon_struct_72_2_8d586bf6_for_orastxt;

typedef struct anon_struct_72_2_8c87f956_for_orasfnm anon_struct_72_2_8c87f956_for_orasfnm, *Panon_struct_72_2_8c87f956_for_orasfnm;

struct anon_struct_72_2_8d586bf6_for_orastxt {
    ushort orastxtl;
    char orastxtc[70];
};

struct anon_struct_72_2_8c87f956_for_orasfnm {
    ushort orasfnml;
    char orasfnmc[70];
};

struct oraca {
    char oracaid[8];
    int oracabc;
    int oracchf;
    int oradbgf;
    int orahchf;
    int orastxtf;
    struct anon_struct_72_2_8d586bf6_for_orastxt orastxt;
    struct anon_struct_72_2_8c87f956_for_orasfnm orasfnm;
    int oraslnr;
    int orahoc;
    int oramoc;
    int oracoc;
    int oranor;
    int oranpr;
    int oranex;
};

typedef struct sqlcxp.conflict12 sqlcxp.conflict12, *Psqlcxp.conflict12;

struct sqlcxp.conflict12 {
    ushort fillen;
    char filnam[15];
};

typedef struct tlv_info_s tlv_info_s, *Ptlv_info_s;

typedef struct tlv_info_s tlv_info_t;

struct tlv_info_s {
    char sTlvName[3];
    int nType;
    int nLength;
};

typedef struct SLineExchange SLineExchange, *PSLineExchange;

typedef struct SLineExchange TSLineExchange;

typedef struct timeval timeval, *Ptimeval;

struct timeval {
    __time_t tv_sec;
    __suseconds_t tv_usec;
};

struct SLineExchange {
    int nLength;
    char sBuffer[4096];
    struct timeval Stime;
};


// WARNING! conflicting data type names: /DWARF/control_limit.c/CheckLimits/anon_struct_22_2_43c7b5cf - /DWARF/connect.c/ConnectOracleCmd/anon_struct_22_2_43c7b5cf


// WARNING! conflicting data type names: /DWARF/time.h/timespec - /time.h/timespec

typedef struct tm tm, *Ptm;

struct tm {
    int tm_sec;
    int tm_min;
    int tm_hour;
    int tm_mday;
    int tm_mon;
    int tm_year;
    int tm_wday;
    int tm_yday;
    int tm_isdst;
    long tm_gmtoff;
    char *tm_zone;
};

typedef struct timezone timezone, *Ptimezone;

struct timezone {
    int tz_minuteswest;
    int tz_dsttime;
};

typedef struct sqlcxp.conflict5 sqlcxp.conflict5, *Psqlcxp.conflict5;

struct sqlcxp.conflict5 {
    ushort fillen;
    char filnam[13];
};

typedef struct sqlexd.conflict3 sqlexd.conflict3, *Psqlexd.conflict3;

struct sqlexd.conflict3 {
    ulong sqlvsn;
    uint arrsiz;
    uint iters;
    uint offset;
    ushort selerr;
    ushort sqlety;
    uint occurs;
    short *cud;
    uchar *sqlest;
    char *stmt;
    struct sqladts *sqladtp;
    struct sqltdss *sqltdsp;
    uchar **sqphsv;
    ulong *sqphsl;
    int *sqphss;
    short **sqpind;
    int *sqpins;
    ulong *sqparm;
    ulong **sqparc;
    ushort *sqpadto;
    ushort *sqptdso;
    uint sqlcmax;
    uint sqlcmin;
    uint sqlcincr;
    uint sqlctimeout;
    uint sqlcnowait;
    int sqfoff;
    uint sqcmod;
    uint sqfmod;
    uchar *sqhstv[10];
    ulong sqhstl[10];
    int sqhsts[10];
    short *sqindv[10];
    int sqinds[10];
    ulong sqharm[10];
    ulong *sqharc[10];
    ushort sqadto[10];
    ushort sqtdso[10];
};

typedef struct anon_struct_54_2_43c7b5cf anon_struct_54_2_43c7b5cf, *Panon_struct_54_2_43c7b5cf;

struct anon_struct_54_2_43c7b5cf {
    ushort len;
    uchar arr[51];
};

typedef struct anon_struct_132_2_43c7b5cf anon_struct_132_2_43c7b5cf, *Panon_struct_132_2_43c7b5cf;

struct anon_struct_132_2_43c7b5cf {
    ushort len;
    uchar arr[129];
};

typedef struct anon_struct_12_2_43c7b5cf anon_struct_12_2_43c7b5cf, *Panon_struct_12_2_43c7b5cf;

struct anon_struct_12_2_43c7b5cf {
    ushort len;
    uchar arr[9];
};


// WARNING! conflicting data type names: /DWARF/log_event.c/LogEvent/anon_struct_4_2_43c7b5cf - /DWARF/get_hsm_keys.c/Get_IssScriptData/anon_struct_4_2_43c7b5cf

typedef struct STagIso STagIso, *PSTagIso;

typedef struct STagIso TSTagIso;

struct STagIso {
    int nPresent[100];
    int nPosTag[100];
    int nLength;
    char sChipData[999];
};

typedef struct SIsoInfo SIsoInfo, *PSIsoInfo;

struct SIsoInfo {
    int nFieldPos[129];
    int nMsgType;
    int nLength;
    char sBitMap[16];
    char sData[2048];
};

typedef struct SIsoInfo TSIsoInfo;

typedef struct STrnRefT STrnRefT, *PSTrnRefT;

typedef struct STrnRefT STrnRef;

struct STrnRefT {
    char fRefNbr[13];
    char fCardNbr[23];
    char fTrnLocalDate[13];
    char fTrnAmt[13];
};

typedef struct SContextT SContextT, *PSContextT;

struct SContextT {
    char fTransLang;
    int fRespCode;
    int fTransCode;
    int fNextTrans;
    int fAuthoSrc;
    char fCoordNbr[4];
    TSIsoInfo fP7Buff;
    TSIsoInfo fP7FeesBuff;
};

typedef struct SSystemT SSystemT, *PSSystemT;

typedef struct SSystemT SSystem;

struct SSystemT {
    int fTrnInPrgFlg;
    char fCardHolderMsg[256];
    char fCrdAccId[16];
};

typedef struct SContextT SContext;

typedef struct sqlexd.conflict6 sqlexd.conflict6, *Psqlexd.conflict6;

struct sqlexd.conflict6 {
    ulong sqlvsn;
    uint arrsiz;
    uint iters;
    uint offset;
    ushort selerr;
    ushort sqlety;
    uint occurs;
    short *cud;
    uchar *sqlest;
    char *stmt;
    struct sqladts *sqladtp;
    struct sqltdss *sqltdsp;
    uchar **sqphsv;
    ulong *sqphsl;
    int *sqphss;
    short **sqpind;
    int *sqpins;
    ulong *sqparm;
    ulong **sqparc;
    ushort *sqpadto;
    ushort *sqptdso;
    uint sqlcmax;
    uint sqlcmin;
    uint sqlcincr;
    uint sqlctimeout;
    uint sqlcnowait;
    int sqfoff;
    uint sqcmod;
    uint sqfmod;
    uchar *sqhstv[7];
    ulong sqhstl[7];
    int sqhsts[7];
    short *sqindv[7];
    int sqinds[7];
    ulong sqharm[7];
    ulong *sqharc[7];
    ushort sqadto[7];
    ushort sqtdso[7];
};

typedef struct sqlcxp.conflict10 sqlcxp.conflict10, *Psqlcxp.conflict10;

struct sqlcxp.conflict10 {
    ushort fillen;
    char filnam[27];
};


// WARNING! conflicting data type names: /DWARF/stat.h/stat - /stat.h/stat


// WARNING! conflicting data type names: /DWARF/maj_autho.c/UpdateAuthoActivityForAtmAdvice/anon_struct_6_2_43c7b5cf - /DWARF/get_hsm_keys.c/Get_IM_Key/anon_struct_6_2_43c7b5cf

typedef struct s_tlv_print s_tlv_print, *Ps_tlv_print;

typedef struct s_tlv_print t_tlv_print;

struct s_tlv_print {
    char *description;
    char *value;
};

typedef struct ISOTAG ISOTAG, *PISOTAG;

struct ISOTAG {
    char *sTagDesc;
    char *sTagValue;
};

typedef struct anon_struct_24_2_43c7b5cf anon_struct_24_2_43c7b5cf, *Panon_struct_24_2_43c7b5cf;

struct anon_struct_24_2_43c7b5cf {
    ushort len;
    uchar arr[22];
};

typedef struct sqlcxp.conflict11 sqlcxp.conflict11, *Psqlcxp.conflict11;

struct sqlcxp.conflict11 {
    ushort fillen;
    char filnam[24];
};

typedef struct NPSTAG NPSTAG, *PNPSTAG;

struct NPSTAG {
    char *sTagDesc;
    char *sTagValue;
};

typedef struct STimeExchange STimeExchange, *PSTimeExchange;

struct STimeExchange {
    char sens;
    TSNodeData sData;
};

typedef struct STimeExchange TSTimeExchange;

typedef struct SNpsF127Info SNpsF127Info, *PSNpsF127Info;

struct SNpsF127Info {
    int nFieldPos[21];
    int nMsgType;
    int nLength;
    char sHeader[16];
    char sBitMap[24];
    char sData[2048];
};

typedef struct SNpsF127Info TSNpsF127Info;

typedef struct ACTION ACTION, *PACTION;

struct ACTION {
    char *sIsoReasonCode;
    char *sNwRsp;
    char *texte;
};

typedef struct sqlcxp sqlcxp, *Psqlcxp;

struct sqlcxp {
    ushort fillen;
    char filnam[16];
};

typedef struct sqlexd sqlexd, *Psqlexd;

struct sqlexd {
    ulong sqlvsn;
    uint arrsiz;
    uint iters;
    uint offset;
    ushort selerr;
    ushort sqlety;
    uint occurs;
    short *cud;
    uchar *sqlest;
    char *stmt;
    struct sqladts *sqladtp;
    struct sqltdss *sqltdsp;
    uchar **sqphsv;
    ulong *sqphsl;
    int *sqphss;
    short **sqpind;
    int *sqpins;
    ulong *sqparm;
    ulong **sqparc;
    ushort *sqpadto;
    ushort *sqptdso;
    uint sqlcmax;
    uint sqlcmin;
    uint sqlcincr;
    uint sqlctimeout;
    uint sqlcnowait;
    int sqfoff;
    uint sqcmod;
    uint sqfmod;
    uchar *sqhstv[4];
    ulong sqhstl[4];
    int sqhsts[4];
    short *sqindv[4];
    int sqinds[4];
    ulong sqharm[4];
    ulong *sqharc[4];
    ushort sqadto[4];
    ushort sqtdso[4];
};

typedef struct anon_struct_4098_2_43c7b5cf anon_struct_4098_2_43c7b5cf, *Panon_struct_4098_2_43c7b5cf;

struct anon_struct_4098_2_43c7b5cf {
    ushort len;
    uchar arr[4096];
};

typedef struct anon_struct_64_2_43c7b5cf anon_struct_64_2_43c7b5cf, *Panon_struct_64_2_43c7b5cf;

struct anon_struct_64_2_43c7b5cf {
    ushort len;
    uchar arr[61];
};

typedef struct anon_struct_44_2_43c7b5cf anon_struct_44_2_43c7b5cf, *Panon_struct_44_2_43c7b5cf;

struct anon_struct_44_2_43c7b5cf {
    ushort len;
    uchar arr[41];
};


// WARNING! conflicting data type names: /DWARF/nps_tool_kit.c/get_Account_type/anon_struct_6_2_43c7b5cf - /DWARF/get_hsm_keys.c/Get_IM_Key/anon_struct_6_2_43c7b5cf

typedef struct sqlexd.conflict1 sqlexd.conflict1, *Psqlexd.conflict1;

struct sqlexd.conflict1 {
    ulong sqlvsn;
    uint arrsiz;
    uint iters;
    uint offset;
    ushort selerr;
    ushort sqlety;
    uint occurs;
    short *cud;
    uchar *sqlest;
    char *stmt;
    struct sqladts *sqladtp;
    struct sqltdss *sqltdsp;
    uchar **sqphsv;
    ulong *sqphsl;
    int *sqphss;
    short **sqpind;
    int *sqpins;
    ulong *sqparm;
    ulong **sqparc;
    ushort *sqpadto;
    ushort *sqptdso;
    uint sqlcmax;
    uint sqlcmin;
    uint sqlcincr;
    uint sqlctimeout;
    uint sqlcnowait;
    int sqfoff;
    uint sqcmod;
    uint sqfmod;
    uchar *sqhstv[5];
    ulong sqhstl[5];
    int sqhsts[5];
    short *sqindv[5];
    int sqinds[5];
    ulong sqharm[5];
    ulong *sqharc[5];
    ushort sqadto[5];
    ushort sqtdso[5];
};

typedef struct sqlcxp.conflict1 sqlcxp.conflict1, *Psqlcxp.conflict1;

struct sqlcxp.conflict1 {
    ushort fillen;
    char filnam[23];
};

typedef struct anon_struct_32_2_43c7b5cf anon_struct_32_2_43c7b5cf, *Panon_struct_32_2_43c7b5cf;

struct anon_struct_32_2_43c7b5cf {
    ushort len;
    uchar arr[30];
};

typedef struct anon_struct_2050_2_43c7b5cf anon_struct_2050_2_43c7b5cf, *Panon_struct_2050_2_43c7b5cf;

struct anon_struct_2050_2_43c7b5cf {
    ushort len;
    uchar arr[2048];
};

typedef struct SArgParam SArgParam, *PSArgParam;

struct SArgParam {
    int nIndice;
};

typedef struct SArgParam TSArgParam;

typedef struct SBalExchange SBalExchange, *PSBalExchange;

typedef struct SBalExchange TSBalExchange;

typedef struct SBalHeader SBalHeader, *PSBalHeader;

typedef struct SBalHeader TSBalHeader;

struct SBalHeader {
    char sPartner[2];
    char sSource[2];
    pid_t nPartnerId;
    pid_t nSourceId;
    int nCommand;
    int nLen;
    time_t nTimeStamp;
};

struct SBalExchange {
    TSBalHeader sHeader;
    char sBody[4096];
};

typedef struct SBalMessage SBalMessage, *PSBalMessage;

struct SBalMessage {
    long lType;
    TSBalExchange sText;
};

typedef struct SHsmHeader SHsmHeader, *PSHsmHeader;

struct SHsmHeader {
    char sPartner[2];
    char sSource[2];
    pid_t nPartnerId;
    pid_t nSourceId;
    int nCommand;
    int nLen;
    int nCoNumber;
    int tid;
    int nIndex;
    time_t nTimeStamp;
};

typedef struct SHsmExchange SHsmExchange, *PSHsmExchange;

typedef struct SHsmHeader TSHsmHeader;

struct SHsmExchange {
    TSHsmHeader sHeader;
    char sBody[4096];
};

typedef struct SBalMessage TSBalMessage;

typedef struct SHsmMessage SHsmMessage, *PSHsmMessage;

typedef struct SHsmExchange TSHsmExchange;

struct SHsmMessage {
    long lType;
    TSHsmExchange sText;
};

typedef struct SHsmMessage TSHsmMessage;

typedef struct sqlca sqlca, *Psqlca;

typedef struct anon_struct_72_2_21082896_for_sqlerrm anon_struct_72_2_21082896_for_sqlerrm, *Panon_struct_72_2_21082896_for_sqlerrm;

struct anon_struct_72_2_21082896_for_sqlerrm {
    ushort sqlerrml;
    char sqlerrmc[70];
};

struct sqlca {
    char sqlcaid[8];
    int sqlabc;
    int sqlcode;
    struct anon_struct_72_2_21082896_for_sqlerrm sqlerrm;
    char sqlerrp[8];
    int sqlerrd[6];
    char sqlwarn[8];
    char sqlext[8];
};

typedef struct SThrInfo SThrInfo, *PSThrInfo;

typedef struct SThrInfo TSThrInfo;

struct SThrInfo {
    pthread_t tid;
};

typedef struct servent servent, *Pservent;

struct servent {
    char *s_name;
    char **s_aliases;
    int s_port;
    char *s_proto;
};

typedef struct tag_info_s tag_info_s, *Ptag_info_s;

typedef struct tag_info_s tag_info_t;

struct tag_info_s {
    char sTagName[5];
    int nType;
    int nLength;
};

typedef struct fld_info_s fld_info_s, *Pfld_info_s;

struct fld_info_s {
    int type;
    int length;
};

typedef struct fld_info_s fld_info_t;

typedef struct sqlexd.conflict sqlexd.conflict, *Psqlexd.conflict;

struct sqlexd.conflict {
    ulong sqlvsn;
    uint arrsiz;
    uint iters;
    uint offset;
    ushort selerr;
    ushort sqlety;
    uint occurs;
    short *cud;
    uchar *sqlest;
    char *stmt;
    struct sqladts *sqladtp;
    struct sqltdss *sqltdsp;
    uchar **sqphsv;
    ulong *sqphsl;
    int *sqphss;
    short **sqpind;
    int *sqpins;
    ulong *sqparm;
    ulong **sqparc;
    ushort *sqpadto;
    ushort *sqptdso;
    uint sqlcmax;
    uint sqlcmin;
    uint sqlcincr;
    uint sqlctimeout;
    uint sqlcnowait;
    int sqfoff;
    uint sqcmod;
    uint sqfmod;
    uchar *sqhstv[3];
    ulong sqhstl[3];
    int sqhsts[3];
    short *sqindv[3];
    int sqinds[3];
    ulong sqharm[3];
    ulong *sqharc[3];
    ushort sqadto[3];
    ushort sqtdso[3];
};

typedef struct sqlcxp.conflict sqlcxp.conflict, *Psqlcxp.conflict;

struct sqlcxp.conflict {
    ushort fillen;
    char filnam[18];
};

typedef struct sqlexd.conflict5 sqlexd.conflict5, *Psqlexd.conflict5;

struct sqlexd.conflict5 {
    ulong sqlvsn;
    uint arrsiz;
    uint iters;
    uint offset;
    ushort selerr;
    ushort sqlety;
    uint occurs;
    short *cud;
    uchar *sqlest;
    char *stmt;
    struct sqladts *sqladtp;
    struct sqltdss *sqltdsp;
    uchar **sqphsv;
    ulong *sqphsl;
    int *sqphss;
    short **sqpind;
    int *sqpins;
    ulong *sqparm;
    ulong **sqparc;
    ushort *sqpadto;
    ushort *sqptdso;
    uint sqlcmax;
    uint sqlcmin;
    uint sqlcincr;
    uint sqlctimeout;
    uint sqlcnowait;
    int sqfoff;
    uint sqcmod;
    uint sqfmod;
    uchar *sqhstv[11];
    ulong sqhstl[11];
    int sqhsts[11];
    short *sqindv[11];
    int sqinds[11];
    ulong sqharm[11];
    ulong *sqharc[11];
    ushort sqadto[11];
    ushort sqtdso[11];
};

typedef struct sqlcxp.conflict9 sqlcxp.conflict9, *Psqlcxp.conflict9;

struct sqlcxp.conflict9 {
    ushort fillen;
    char filnam[14];
};

typedef struct anon_struct_2002_2_43c7b5cf anon_struct_2002_2_43c7b5cf, *Panon_struct_2002_2_43c7b5cf;

struct anon_struct_2002_2_43c7b5cf {
    ushort len;
    uchar arr[2000];
};

typedef struct sqlexd.conflict4 sqlexd.conflict4, *Psqlexd.conflict4;

struct sqlexd.conflict4 {
    ulong sqlvsn;
    uint arrsiz;
    uint iters;
    uint offset;
    ushort selerr;
    ushort sqlety;
    uint occurs;
    short *cud;
    uchar *sqlest;
    char *stmt;
    struct sqladts *sqladtp;
    struct sqltdss *sqltdsp;
    uchar **sqphsv;
    ulong *sqphsl;
    int *sqphss;
    short **sqpind;
    int *sqpins;
    ulong *sqparm;
    ulong **sqparc;
    ushort *sqpadto;
    ushort *sqptdso;
    uint sqlcmax;
    uint sqlcmin;
    uint sqlcincr;
    uint sqlctimeout;
    uint sqlcnowait;
    int sqfoff;
    uint sqcmod;
    uint sqfmod;
    uchar *sqhstv[43];
    ulong sqhstl[43];
    int sqhsts[43];
    short *sqindv[43];
    int sqinds[43];
    ulong sqharm[43];
    ulong *sqharc[43];
    ushort sqadto[43];
    ushort sqtdso[43];
};


// WARNING! conflicting data type names: /DWARF/get_resources.c/GetResources/anon_struct_24_2_43c7b5cf - /DWARF/get_pin_info.c/get_pin_info/anon_struct_24_2_43c7b5cf

typedef struct TSNps TSNps, *PTSNps;

typedef struct TSNps SNps;

struct TSNps {
    char F_szRsrcId[7];
    char F_szResourceStatus[4];
    int F_nSendNbr;
    int F_nEchoTestPeriod;
};

typedef struct SMsgBitMap SMsgBitMap, *PSMsgBitMap;

typedef struct SMsgBitMap TSMsgBitMap;

struct SMsgBitMap {
    int nPresenceFlag;
};

typedef struct in_addr in_addr, *Pin_addr;

typedef uint32_t in_addr_t;

struct in_addr {
    in_addr_t s_addr;
};

typedef uint16_t in_port_t;

typedef struct sockaddr_in sockaddr_in, *Psockaddr_in;

struct sockaddr_in {
    sa_family_t sin_family;
    in_port_t sin_port;
    struct in_addr sin_addr;
    uchar sin_zero[8];
};

typedef struct STlvAutho STlvAutho, *PSTlvAutho;

typedef struct STlvAutho TSTlvAutho;

struct STlvAutho {
    int nPresent[999];
    int nPosTlv[999];
    int nLength;
    char sTlvData[4098];
};

typedef struct sqlcxp.conflict8 sqlcxp.conflict8, *Psqlcxp.conflict8;

struct sqlcxp.conflict8 {
    ushort fillen;
    char filnam[19];
};


// WARNING! conflicting data type names: /DWARF/get_pwc_globals.c/GetGlobalsVar/anon_struct_34_2_43c7b5cf - /DWARF/init_resource.c/ResetResource/anon_struct_34_2_43c7b5cf

typedef struct __sigset_t sigset_t;

typedef struct s_secdata s_secdata, *Ps_secdata;

typedef struct s_secdata t_secdata;

struct s_secdata {
    int offset;
    int length;
};

typedef struct sqlcxp.conflict2 sqlcxp.conflict2, *Psqlcxp.conflict2;

struct sqlcxp.conflict2 {
    ushort fillen;
    char filnam[22];
};

typedef struct TSDBConThread TSDBConThread, *PTSDBConThread;

struct TSDBConThread {
    int nId;
    int nIndex;
    int nState;
    time_t nExpiryTime;
    pthread_t nThreadId;
    pthread_t tid;
    union pthread_mutex_t ThrMutex;
    union pthread_cond_t ThrCond;
    union pthread_mutex_t ResultMutex;
    union pthread_cond_t ResultCond;
    int nConState;
    int nCtxState;
    int nFullTrace;
};

typedef void *__gnuc_va_list;

typedef __gnuc_va_list va_list;

typedef struct timezone *__timezone_ptr_t;

typedef union _union_1457 _union_1457, *P_union_1457;


// WARNING! conflicting data type names: /signal.h/__sighandler_t - /DWARF/signal.h/__sighandler_t

union _union_1457 {
    __sighandler_t sa_handler;
    void (*sa_sigaction)(int, siginfo_t *, void *);
};


// WARNING! conflicting data type names: /sigaction.h/sigaction - /DWARF/sigaction.h/sigaction

typedef int (*__compar_fn_t)(void *, void *);

typedef struct Elf64_Phdr Elf64_Phdr, *PElf64_Phdr;

typedef enum Elf_ProgramHeaderType {
    PT_NULL=0,
    PT_LOAD=1,
    PT_DYNAMIC=2,
    PT_INTERP=3,
    PT_NOTE=4,
    PT_SHLIB=5,
    PT_PHDR=6,
    PT_TLS=7,
    PT_GNU_EH_FRAME=1685382480,
    PT_GNU_STACK=1685382481,
    PT_GNU_RELRO=1685382482
} Elf_ProgramHeaderType;

struct Elf64_Phdr {
    enum Elf_ProgramHeaderType p_type;
    dword p_flags;
    qword p_offset;
    qword p_vaddr;
    qword p_paddr;
    qword p_filesz;
    qword p_memsz;
    qword p_align;
};

typedef struct Elf64_Rela Elf64_Rela, *PElf64_Rela;

struct Elf64_Rela {
    qword r_offset; // location to apply the relocation action
    qword r_info; // the symbol table index and the type of relocation
    qword r_addend; // a constant addend used to compute the relocatable field value
};

typedef struct Elf64_Shdr Elf64_Shdr, *PElf64_Shdr;

typedef enum Elf_SectionHeaderType {
    SHT_NULL=0,
    SHT_PROGBITS=1,
    SHT_SYMTAB=2,
    SHT_STRTAB=3,
    SHT_RELA=4,
    SHT_HASH=5,
    SHT_DYNAMIC=6,
    SHT_NOTE=7,
    SHT_NOBITS=8,
    SHT_REL=9,
    SHT_SHLIB=10,
    SHT_DYNSYM=11,
    SHT_INIT_ARRAY=14,
    SHT_FINI_ARRAY=15,
    SHT_PREINIT_ARRAY=16,
    SHT_GROUP=17,
    SHT_SYMTAB_SHNDX=18,
    SHT_ANDROID_REL=1610612737,
    SHT_ANDROID_RELA=1610612738,
    SHT_GNU_ATTRIBUTES=1879048181,
    SHT_GNU_HASH=1879048182,
    SHT_GNU_LIBLIST=1879048183,
    SHT_CHECKSUM=1879048184,
    SHT_SUNW_move=1879048186,
    SHT_SUNW_COMDAT=1879048187,
    SHT_SUNW_syminfo=1879048188,
    SHT_GNU_verdef=1879048189,
    SHT_GNU_verneed=1879048190,
    SHT_GNU_versym=1879048191
} Elf_SectionHeaderType;

struct Elf64_Shdr {
    dword sh_name;
    enum Elf_SectionHeaderType sh_type;
    qword sh_flags;
    qword sh_addr;
    qword sh_offset;
    qword sh_size;
    dword sh_link;
    dword sh_info;
    qword sh_addralign;
    qword sh_entsize;
};

typedef struct Elf64_Dyn Elf64_Dyn, *PElf64_Dyn;

typedef enum Elf64_DynTag {
    DT_NULL=0,
    DT_NEEDED=1,
    DT_PLTRELSZ=2,
    DT_PLTGOT=3,
    DT_HASH=4,
    DT_STRTAB=5,
    DT_SYMTAB=6,
    DT_RELA=7,
    DT_RELASZ=8,
    DT_RELAENT=9,
    DT_STRSZ=10,
    DT_SYMENT=11,
    DT_INIT=12,
    DT_FINI=13,
    DT_SONAME=14,
    DT_RPATH=15,
    DT_SYMBOLIC=16,
    DT_REL=17,
    DT_RELSZ=18,
    DT_RELENT=19,
    DT_PLTREL=20,
    DT_DEBUG=21,
    DT_TEXTREL=22,
    DT_JMPREL=23,
    DT_BIND_NOW=24,
    DT_INIT_ARRAY=25,
    DT_FINI_ARRAY=26,
    DT_INIT_ARRAYSZ=27,
    DT_FINI_ARRAYSZ=28,
    DT_RUNPATH=29,
    DT_FLAGS=30,
    DT_PREINIT_ARRAY=32,
    DT_PREINIT_ARRAYSZ=33,
    DT_RELRSZ=35,
    DT_RELR=36,
    DT_RELRENT=37,
    DT_ANDROID_REL=1610612751,
    DT_ANDROID_RELSZ=1610612752,
    DT_ANDROID_RELA=1610612753,
    DT_ANDROID_RELASZ=1610612754,
    DT_ANDROID_RELR=1879040000,
    DT_ANDROID_RELRSZ=1879040001,
    DT_ANDROID_RELRENT=1879040003,
    DT_GNU_PRELINKED=1879047669,
    DT_GNU_CONFLICTSZ=1879047670,
    DT_GNU_LIBLISTSZ=1879047671,
    DT_CHECKSUM=1879047672,
    DT_PLTPADSZ=1879047673,
    DT_MOVEENT=1879047674,
    DT_MOVESZ=1879047675,
    DT_FEATURE_1=1879047676,
    DT_POSFLAG_1=1879047677,
    DT_SYMINSZ=1879047678,
    DT_SYMINENT=1879047679,
    DT_GNU_XHASH=1879047924,
    DT_GNU_HASH=1879047925,
    DT_TLSDESC_PLT=1879047926,
    DT_TLSDESC_GOT=1879047927,
    DT_GNU_CONFLICT=1879047928,
    DT_GNU_LIBLIST=1879047929,
    DT_CONFIG=1879047930,
    DT_DEPAUDIT=1879047931,
    DT_AUDIT=1879047932,
    DT_PLTPAD=1879047933,
    DT_MOVETAB=1879047934,
    DT_SYMINFO=1879047935,
    DT_VERSYM=1879048176,
    DT_RELACOUNT=1879048185,
    DT_RELCOUNT=1879048186,
    DT_FLAGS_1=1879048187,
    DT_VERDEF=1879048188,
    DT_VERDEFNUM=1879048189,
    DT_VERNEED=1879048190,
    DT_VERNEEDNUM=1879048191,
    DT_AUXILIARY=2147483645,
    DT_FILTER=2147483647
} Elf64_DynTag;

struct Elf64_Dyn {
    enum Elf64_DynTag d_tag;
    qword d_val;
};

typedef struct Elf64_Sym Elf64_Sym, *PElf64_Sym;

struct Elf64_Sym {
    dword st_name;
    byte st_info;
    byte st_other;
    word st_shndx;
    qword st_value;
    qword st_size;
};

typedef struct GnuBuildId GnuBuildId, *PGnuBuildId;

struct GnuBuildId {
    dword namesz; // Length of name field
    dword descsz; // Length of description field
    dword type; // Vendor specific type
    char name[4]; // Vendor name
    byte hash[20];
};

typedef struct Elf64_Ehdr Elf64_Ehdr, *PElf64_Ehdr;

struct Elf64_Ehdr {
    byte e_ident_magic_num;
    char e_ident_magic_str[3];
    byte e_ident_class;
    byte e_ident_data;
    byte e_ident_version;
    byte e_ident_osabi;
    byte e_ident_abiversion;
    byte e_ident_pad[7];
    word e_type;
    word e_machine;
    dword e_version;
    qword e_entry;
    qword e_phoff;
    qword e_shoff;
    dword e_flags;
    word e_ehsize;
    word e_phentsize;
    word e_phnum;
    word e_shentsize;
    word e_shnum;
    word e_shstrndx;
};

typedef struct NoteAbiTag NoteAbiTag, *PNoteAbiTag;

struct NoteAbiTag {
    dword namesz; // Length of name field
    dword descsz; // Length of description field
    dword type; // Vendor specific type
    char name[4]; // Vendor name
    dword abiType; // 0 == Linux
    dword requiredKernelVersion[3]; // Major.minor.patch
};



undefined thread_key_exchange;
undefined thread_echo_test;
undefined stdout;
TSThrInfo[512] tab_ThrInfo;
undefined thread_wait_BAL;
SNps G_sNps;
undefined thread_TIMEOUT;
undefined thread_SAF;
undefined thread_CTL;
undefined thread_wait_LINE;
undefined main;
undefined __libc_csu_init;
undefined __libc_csu_fini;
undefined1 completed.6355;
undefined8 stderr;
char[65] DeviceName;
int max_request;
char[3] CommsId;
int MaxTroublesInd;
char[64] trace_file;
int max_size;
int EchoTestTimer;
char[65] LocalAppId;
int trace_level;
int max_thread;
char[65] RemoteAppId;
char[7] AcquirerBank;
char[65] LocalAppName;
int nTimerAcq;
int nUserThread;
char[65] RemoteAppName;
char[3] ProtocolId;
int nIssAcqDelta;
int MinTroublesInd;
undefined sig_segment_violation;
int nBalMsg;
undefined thread_ADMIN;
undefined thread_SIG;
undefined sig_alarm;
int nBalAdm;
char[33] ResourceInternalId;
undefined DAT_004a29eb;
undefined DAT_004a29ef;
int nFdConnect;
undefined DAT_004a7e3c;
int echoTentative;
undefined DAT_004a6744;
undefined DAT_004a2d59;
undefined DAT_004a2d5d;
undefined DAT_004a2d61;
undefined DAT_004a2d65;
sqladts sqladt;
sqltdss sqltds;
sqlcxp sqlfpn;
short[198] sqlcud0;
uint sqlctx;
string s_begin_NULL_;_EXCEPTION_WHEN_OTHE_004a3450;
undefined DAT_004a31ee;
undefined DAT_004a31fa;
undefined DAT_004a323a;
string s_begin_NULL_;_EXCEPTION_WHEN_OTHE_004a3550;
string s_begin_NULL_;_EXCEPTION_WHEN_OTHE_004a3600;
undefined DAT_004a4d5a;
undefined DAT_004a32c9;
string s_begin_:response_code_:=_EBL_FUND_004a36b0;
string s_begin_:response_code_:=_EBL_FUND_004a3758;
undefined thread_proc_BAL;
undefined DAT_004c9c2d;
undefined thread_proc_LINE;
undefined thread_proc_TIME;
undefined DAT_004a40cb;
char[4] ResourceStatus;
undefined DAT_004a2b1c;
undefined DAT_004a3182;
undefined DAT_004a4327;
undefined DAT_004a44e5;
undefined DAT_004a4cee;
undefined DAT_004a4cf1;
undefined DAT_004a4d27;
undefined DAT_004a4d63;
undefined DAT_004a5543;
undefined DAT_004a554a;
undefined DAT_004a66ff;
undefined DAT_004a6704;
undefined DAT_004a6709;
undefined2 DAT_004a670e;
undefined DAT_004a6713;
undefined DAT_004a6718;
undefined2 DAT_004a671d;
undefined DAT_004a7da4;
undefined DAT_004a7e20;
undefined DAT_004a7e3d;
undefined DAT_004a8fd3;
undefined DAT_004a904e;
undefined2 DAT_004a9052;
undefined DAT_004a9056;
undefined DAT_004a908d;
undefined DAT_004a9091;
undefined DAT_004a9095;
undefined DAT_004a9099;
undefined DAT_004a909d;
undefined DAT_004a90d4;
undefined DAT_004a90d8;
undefined DAT_004a90dc;
undefined DAT_004a90e0;
undefined DAT_004a90e4;
undefined DAT_004a90e8;
undefined DAT_004a90ec;
undefined DAT_004aac27;
undefined DAT_004aac5d;
undefined DAT_004c7452;
undefined DAT_004c759a;
undefined DAT_004c759e;
undefined DAT_004c764a;
undefined DAT_004c9c1d;
undefined DAT_004c9c21;
undefined DAT_004c9c29;
undefined DAT_004c9c31;
undefined DAT_004c9c59;
undefined DAT_004c9d8f;
undefined DAT_004cd00c;
undefined DAT_004d1dfe;
undefined DAT_004d1e2b;
undefined DAT_004d1e47;
undefined DAT_004d1e6a;
undefined DAT_004d1e8d;
undefined DAT_004d1ecc;
undefined2 DAT_004d1ee1;
undefined DAT_004d1efb;
undefined DAT_004d1f75;
undefined DAT_004d1fb6;
undefined DAT_004d4402;
undefined DAT_004d443d;
undefined DAT_004d448b;
undefined DAT_004d44e6;
undefined DAT_004d45aa;
undefined DAT_004d45cf;
undefined DAT_004d45e2;
undefined DAT_004d4635;
undefined DAT_004d464d;
undefined DAT_004d4662;
undefined DAT_004d467a;
undefined DAT_004d4691;
undefined DAT_004d46a4;
undefined DAT_004d46de;
undefined DAT_004d46f5;
undefined DAT_004d4707;
undefined DAT_004d471d;
undefined DAT_004d4731;
undefined DAT_004d4749;
undefined DAT_004d475e;
undefined DAT_004d476f;
undefined DAT_004d4788;
undefined DAT_004d479b;
undefined DAT_004d47b2;
undefined DAT_004d47d1;
undefined DAT_004d47e8;
undefined2 DAT_004d4825;
undefined DAT_004d484c;
undefined DAT_004d48ad;
undefined DAT_004d48b7;
undefined DAT_004d48c9;
undefined DAT_004d6e34;
undefined DAT_004d7d79;
undefined DAT_004d9b69;
undefined DAT_004a4d56;
undefined DAT_004a4d5f;
undefined DAT_004d1efa;
undefined DAT_004a4df4;
TSTransType[21] sTransType;
TSAccntType[4] sAccntType;
undefined DAT_004a4e08;
undefined DAT_004a315e;
undefined DAT_004a4ee6;
undefined DAT_004a4ef9;
undefined DAT_004a4f1b;
undefined DAT_004a4f1f;
undefined DAT_004a4f23;
undefined DAT_004a4f41;
int debug_option;
TSMsgBitMap[128] sAutRepMsgBitMap;
undefined DAT_004a5429;
undefined DAT_004a5376;
sqlcxp.conflict sqlfpn;
short[32] sqlcud0;
ACTION[32] aAction;
int nFdLocal;
undefined DAT_004a6d01;
tag_info_t[26] tab_NpsTagInfo;
tag_info_t[9] tab_NpsSFldInfo;
tag_info_t[3] tab_NpsF46SFldInfo;
fld_info_t[128] tab_NpsFldInfo;
fld_info_t[20] tab_NpsF127FldInfo;
undefined DAT_004a7340;
undefined DAT_004a744c;
pointer PTR_s_NPS_TAG_ISS_SCRIPT1_006fe9c0;
undefined DAT_004a7931;
undefined DAT_004a799d;
undefined DAT_004a79a1;
undefined DAT_004a79a5;
undefined DAT_004a7a39;
sqlcxp.conflict1 sqlfpn;
string s_declare_v_a_text_atm_statement_l_004a7af8;
short[67] sqlcud0;
undefined DAT_004a7e39;
undefined DAT_004caed9;
char[7] ResourceId;
string s_begin_:response_code_:=_PCRD_P7__004a8048;
sqlcxp.conflict2 sqlfpn;
short[59] sqlcud0;
string s_begin_:response_code_:=_PCRD_P7__004a80c8;
TSNodeStruct ListHeadIss;
TSNodeStruct ListHeadAcq;
alrm_inf_t[256] tab_alrm;
TSBalExchange[500] tab_BalDemande;
pthread_mutex_t flag_mutex;
undefined thread_wait_TIME;
int iBalGet;
int iBalPut;
int nBalSlots;
int nBalItem;
pthread_mutex_t BalWriteMutex;
pthread_cond_t BalWriteCond;
pthread_mutex_t BalTabMutex;
pthread_mutex_t BalReadMutex;
pthread_cond_t BalReadCond;
int iLineGet;
int nLineSlots;
int iLinePut;
int nLineItem;
pthread_cond_t LineWriteCond;
pthread_mutex_t LineWriteMutex;
pthread_mutex_t LineTabMutex;
TSLineExchange[500] tab_LineDemande;
pthread_cond_t LineReadCond;
pthread_mutex_t LineReadMutex;
int iTimePut;
int iTimeGet;
int nTimeItem;
int nTimeSlots;
pthread_cond_t TimeWriteCond;
pthread_mutex_t TimeWriteMutex;
TSTimeExchange[100] tab_TimeDemande;
pthread_mutex_t TimeTabMutex;
pthread_mutex_t TimeReadMutex;
pthread_cond_t TimeReadCond;
uchar[256] abAsciiEbcdic;
uchar[256] abEbcdicAscii;
char lrc;
undefined DAT_004a7626;
undefined DAT_004a8e68;
undefined DAT_004a8e6d;
undefined DAT_004a8ed5;
undefined DAT_004a8ee5;
undefined DAT_004a8ee9;
sqlcxp.conflict3 sqlfpn;
string s_begin_:response_code_:=_PCRD_GEN_004a9598;
short[28] sqlcud0;
short[125] sqlcud0;
sqlcxp.conflict4 sqlfpn;
sqlca sqlca;
short[115] sqlcud0;
sqlcxp.conflict5 sqlfpn;
short[71] sqlcud0;
undefined DAT_004a4e04;
t_tlv_print[74] sPrivateDataDesc;
t_tlv_print[7] sPrivateCpsDesc;
t_tlv_print[1] sAdditRespDataDesc;
undefined DAT_004aa703;
t_tlv_print[4] sPrivateAddPosDesc;
char *[10] sSecurityDesc;
t_tlv_print[7] sPrivateNetworkDesc;
pointer PTR_s_ISO_TAG_ISS_SCRIPT1_006ff520;
t_secdata[11] secdata;
char DAT_0000000c;
short[113] sqlcud0;
sqlcxp.conflict6 sqlfpn;
short[294] sqlcud0;
sqlcxp.conflict7 sqlfpn;
string s_alter_SESSION_SET_NLS_DATE_FORMA_004abe78;
pthread_mutex_t ConnectMutex;
TSParamCtx[512] tab_ParamCtx;
string s_begin_SELECT_'1'_INTO_:T_dummy_F_004abef8;
int fd_trace;
pthread_mutex_t trace_mutex;
undefined DAT_00000000;
undefined DAT_00000004;
char *[13] t_month;
int[12] l_month;
TSDBConThread[100] tab_DBConThread;
undefined DAT_0070c288;
pthread_mutex_t TabMutex;
undefined thread_dbcon_refresh;
int nNbThreads;
TlvInfoProperties ISSPayFacDataProp;
fld_info_t[128] tab_IsoFldInfo;
tag_info_t[39] tab_IsoTagInfo;
string s_RCES_._RESOURCE_LIVE_,_LPAD_(_'_'_004c6188;
short[192] sqlcud0;
string s_declare_T_GLOBALS_VAR_POWERCARD__004c63d8;
sqlcxp.conflict8 sqlfpn;
tlv_info_t[165] tab_TlvPrivateInfo;
string s_begin_:response_code_:=_PCRD_SAF_004c6530;
short[247] sqlcud0;
sqlcxp.conflict9 sqlfpn;
string s_begin_:response_code_:=_PCRD_SAF_004c6640;
string s_begin_:response_code_:=_PCRD_SAF_004c66b8;
string s_begin_:response_code_:=_PCRD_SAF_004c67b8;
string s_begin_COMMIT_;_END_;_004c6c69;
short[48] sqlcud0;
sqlcxp.conflict10 sqlfpn;
string s_begin_:response_code_:=_PCRD_P7__004c6f30;
short[40] sqlcud0;
sqlcxp.conflict11 sqlfpn;
string s_begin_:response_code_:=_PCRD_P7__004c6ff0;
string s_begin_:response_code_:=_PCRD_P7__004c70e8;
string s_begin_:response_code_:=_PCRD_P7__004c71e8;
string s_begin_:response_code_:=_PCRD_P7__004c72f8;
string s_begin_:response_code_:=_PCRD_P7__004c73e0;
undefined DAT_004d1e2a;
undefined DAT_004c7467;
undefined DAT_004c7698;
undefined DAT_004c75f4;
undefined DAT_004c9eaa;
undefined DAT_004c83bc;
undefined DAT_004c8442;
string s_begin_:response_code_:=_PCRD_P7__004c8b98;
short[36] sqlcud0;
string s_declare_pin_error_flag_BOOLEAN_:_004c8c70;
sqlcxp.conflict12 sqlfpn;
string s_declare_approval_flag_BOOLEAN_:=_004c8f50;
string s_begin_:response_code_:=_PCRD_ATM_004c92a0;
short[51] sqlcud0;
string s_begin_:response_code_:=_PCRD_SPE_004c9348;
string s_begin_:response_code_:=_PCRD_P7__004c9418;
sqlcxp.conflict13 sqlfpn;
string s_begin_:response_code_:=_PCRD_P7__004c9510;
short[63] sqlcud0;
string s_begin_:response_code_:=_PCRD_P7__004c97f8;
short[137] sqlcud0;
string s_begin_:response_code_:=_PCRD_P7__004c98d0;
undefined DAT_004c9ea9;
undefined DAT_004c9dd1;
string s_begin_:response_code_:=_PCRD_P7__004ca3d8;
string s_begin_:response_code_:=_PCRD_P7__004ca4c8;
string s_begin_:response_code_:=_P7_OCT_A_004ca5d8;
short[86] sqlcud0;
string s_begin_:response_code_:=_P7_OCT_A_004ca6a8;
string s_begin_:response_code_:=_PCRD_P7__004ca768;
string s_begin_:response_code_:=_PCRD_CUP_004ca848;
short[44] sqlcud0;
string s_begin_:lRet_:=_PCRD_P7_CTRL_SECU_004caac8;
string s_begin_:response_code_:=_PCRD_P7__004caef8;
string s_begin_:response_code_:=_PCRD_P7__004cb538;
short[90] sqlcud0;
string s_begin_:response_code_:=_PCRD_AUT_004cb640;
string s_begin_:response_code_:=_PCRD_AUT_004cb738;
string s_begin_:response_code_:=_PCRD_ATM_004cb838;
t_response[28] hsm_response;
undefined DAT_004a40cc;
undefined DAT_004cb9ea;
undefined DAT_004cba3b;
undefined DAT_004cba8a;
undefined DAT_004cbc04;
undefined DAT_004cbc5c;
undefined DAT_004cbc9a;
undefined DAT_004cbd3b;
undefined DAT_004cbd8e;
undefined DAT_004cbf2c;
undefined DAT_004cc00d;
undefined DAT_004cc112;
undefined DAT_004a2afc;
undefined DAT_004cc1ef;
undefined DAT_004cc249;
undefined DAT_004cc29a;
undefined DAT_004cc33b;
undefined DAT_004d6914;
undefined DAT_004cc45a;
undefined DAT_004cc4c8;
undefined DAT_004cc511;
undefined DAT_004cc580;
undefined DAT_004cc5ef;
undefined DAT_004cc65e;
undefined DAT_004cc6d1;
undefined DAT_004cc742;
undefined DAT_004cc7b3;
undefined DAT_004cc856;
undefined DAT_004cc8c7;
undefined DAT_004cc998;
undefined DAT_004cc9f2;
undefined DAT_004ccacd;
undefined DAT_004ccb59;
undefined DAT_004ccb84;
undefined DAT_004ccd2e;
undefined DAT_004ccd7f;
undefined DAT_004ccdd0;
undefined DAT_004cce21;
undefined DAT_004cce90;
undefined DAT_004ccee1;
undefined DAT_004d8f6a;
undefined DAT_004ccf90;
undefined DAT_004cd007;
undefined DAT_004cd00a;
undefined DAT_004cd057;
undefined DAT_004d685d;
undefined DAT_004cd10f;
undefined DAT_004cd16b;
undefined DAT_004cd1d4;
undefined DAT_004cd274;
undefined DAT_004cd2a1;
undefined DAT_004cd2bc;
undefined DAT_004da282;
undefined DAT_004cd39d;
undefined DAT_004cd416;
undefined DAT_004cd487;
TSHsmCtx[512] tab_HsmCtx;
int nBalHsm;
undefined thread_HSM;
undefined8 OPENSSL_ia32cap_P;
undefined DAT_004cf29e;
undefined DAT_004cf2a1;
undefined DAT_004cf2a4;
undefined DAT_004cf2a7;
undefined DAT_004cf2aa;
undefined DAT_004cf2ad;
undefined DAT_004cf2b0;
undefined DAT_004cf2b3;
undefined DAT_004cf2b6;
undefined DAT_004cf51a;
undefined DAT_004cf51e;
undefined DAT_004cf7e1;
t_prod_err[13] prod_err;
short[1032] sqlcud0;
string s_begin_:response_:=_PCRD_GET_HSM__004d2e78;
string s_begin_:response_:=_PCRD_GET_HSM__004d3328;
tlv_info_t[24] tab_TlvProdInfo;
undefined DAT_004d404b;
undefined DAT_004d404f;
undefined DAT_004d4054;
tlv_info_t[283] tab_TlvAuthoInfo;
t_tlv_print[22] sTlvProd;
t_tlv_print[267] sTlvPrint;
undefined4 m.3831;
undefined4 m.3838;
undefined4 K256;
undefined8 app_locks;
undefined8 dynlock_create_callback;
undefined8 dynlock_lock_callback;
undefined8 dynlock_destroy_callback;
undefined8 add_lock_callback;
undefined8 locking_callback;
undefined8 threadid_callback;
undefined8 id_callback;
undefined1[328] lock_names;
undefined DAT_004d56ee;
undefined4 trigger.5147;
undefined8 dyn_locks;
pointer malloc_func;
pointer realloc_func;
pointer malloc_locked_func;
undefined default_malloc_locked_ex;
undefined4 allow_customize;
pointer malloc_ex_func;
pointer realloc_ex_func;
pointer free_func;
pointer malloc_locked_ex_func;
pointer free_locked_func;
undefined default_malloc_ex;
undefined default_realloc_ex;
undefined4 allow_customize_debug;
undefined8 malloc_debug_func;
undefined8 realloc_debug_func;
undefined8 free_debug_func;
undefined8 set_debug_options_func;
undefined8 get_debug_options_func;
undefined4 done.4573;
undefined4 int_err_library_number;
undefined8 int_error_hash;
undefined4 int_thread_hash_references;
undefined err_state_LHASH_COMP;
undefined err_state_LHASH_HASH;
undefined8 int_thread_hash;
undefined err_string_data_LHASH_HASH;
undefined err_string_data_LHASH_COMP;
undefined8 err_fns;
undefined1[88] err_defaults;
undefined8 ERR_str_libraries;
undefined8 ERR_str_reasons;
undefined8 ERR_str_functs;
undefined4 init.5116;
undefined8 SYS_str_reasons;
undefined1[4064] strerror_tab.5114;
undefined1[256] buf.5244;
undefined1[600] fallback.5284;
undefined8 options;
undefined4 num_disable;
undefined1[16] disabling_threadid;
undefined4 mh_mode;
undefined8 amih;
undefined app_info_LHASH_COMP;
undefined app_info_LHASH_HASH;
undefined mem_LHASH_HASH;
undefined8 mh;
undefined8 order;
undefined mem_LHASH_COMP;
undefined print_leak_LHASH_DOALL_ARG;
undefined cb_leak_LHASH_DOALL_ARG;
pointer PTR_s_undefined_004dcce8;
pointer nid_objs;
undefined DAT_004dccf4;
pointer PTR_lvalues_004dccf8;
undefined4 obj_cleanup_defer;
undefined cleanup1_LHASH_DOALL;
undefined8 added;
undefined cleanup2_LHASH_DOALL;
undefined cleanup3_LHASH_DOALL;
undefined4 new_nid;
undefined added_obj_LHASH_HASH;
undefined added_obj_LHASH_COMP;
undefined DAT_004dccf0;
undefined1[3428] obj_objs;
undefined1[3652] ln_objs;
undefined1[3652] sn_objs;
undefined4 bn_limit_bits;
undefined4 bn_limit_num;
undefined4 bn_limit_bits_high;
undefined4 bn_limit_num_high;
undefined4 bn_limit_bits_low;
undefined4 bn_limit_num_low;
undefined4 bn_limit_bits_mont;
undefined4 bn_limit_num_mont;
undefined1[24] const_one.5772;
undefined1[256] bits.5776;
undefined4 init.5980;
undefined1[16] data.5981;
undefined DAT_004e804e;
undefined DAT_004e8051;
undefined1[80] methods_filep;
undefined lh_strhash;
undefined strcmp;
undefined4 ex_class;
undefined ex_class_item_LHASH_HASH;
undefined ex_class_item_LHASH_COMP;
undefined8 ex_data;
undefined def_cleanup_util_cb;
undefined def_cleanup_cb;
undefined8 impl;
undefined1[48] impl_default;
uchar[17] Rots;
uchar[64] Tab_KeyTr2;
uchar[16][65] I_Key;
undefined DAT_004e8840;
uchar[64] Tab_Ptr;
uchar[64] Tab_Etr;
uchar[8][64] S;
uchar[33] Ln;
uchar[33] Rn;
uchar[16] Tab_Rots;
uchar[64] Tab_KeyTr1;
uchar[64] Tab_InitialTr;
uchar[512] Tab_S;
uchar[64] Tab_Swap;
uchar[64] Tab_FinalTr;
pointer __frame_dummy_init_array_entry;

int _init(EVP_PKEY_CTX *ctx)

{
  int iVar1;
  
  __gmon_start__();
  iVar1 = OPENSSL_cpuid_setup();
  return iVar1;
}



void FUN_00402180(void)

{
  (*(code *)(undefined *)0x0)();
  return;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

long ftell(FILE *__stream)

{
  long lVar1;
  
  lVar1 = ftell(__stream);
  return lVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

int pthread_cond_signal(pthread_cond_t *__cond)

{
  int iVar1;
  
  iVar1 = pthread_cond_signal(__cond);
  return iVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

int * __errno_location(void)

{
  int *piVar1;
  
  piVar1 = __errno_location();
  return piVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

int printf(char *__format,...)

{
  int iVar1;
  
  iVar1 = printf(__format);
  return iVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

int pause(void)

{
  int iVar1;
  
  iVar1 = pause();
  return iVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

long syscall(long __sysno,...)

{
  long lVar1;
  
  lVar1 = syscall(__sysno);
  return lVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

int pthread_condattr_init(pthread_condattr_t *__attr)

{
  int iVar1;
  
  iVar1 = pthread_condattr_init(__attr);
  return iVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

int pthread_kill(pthread_t __threadid,int __signo)

{
  int iVar1;
  
  iVar1 = pthread_kill(__threadid,__signo);
  return iVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

int bind(int __fd,sockaddr *__addr,socklen_t __len)

{
  int iVar1;
  
  iVar1 = bind(__fd,__addr,__len);
  return iVar1;
}



void sqlbuft(void)

{
  sqlbuft();
  return;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

int sprintf(char *__s,char *__format,...)

{
  int iVar1;
  
  iVar1 = sprintf(__s,__format);
  return iVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

char * strstr(char *__haystack,char *__needle)

{
  char *pcVar1;
  
  pcVar1 = strstr(__haystack,__needle);
  return pcVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

int socket(int __domain,int __type,int __protocol)

{
  int iVar1;
  
  iVar1 = socket(__domain,__type,__protocol);
  return iVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

ssize_t msgrcv(int __msqid,void *__msgp,size_t __msgsz,long __msgtyp,int __msgflg)

{
  ssize_t sVar1;
  
  sVar1 = msgrcv(__msqid,__msgp,__msgsz,__msgtyp,__msgflg);
  return sVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

int accept(int __fd,sockaddr *__addr,socklen_t *__addr_len)

{
  int iVar1;
  
  iVar1 = accept(__fd,__addr,__addr_len);
  return iVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

ulong strtoul(char *__nptr,char **__endptr,int __base)

{
  ulong uVar1;
  
  uVar1 = strtoul(__nptr,__endptr,__base);
  return uVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

int sigwait(sigset_t *__set,int *__sig)

{
  int iVar1;
  
  iVar1 = sigwait(__set,__sig);
  return iVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

ssize_t recv(int __fd,void *__buf,size_t __n,int __flags)

{
  ssize_t sVar1;
  
  sVar1 = recv(__fd,__buf,__n,__flags);
  return sVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

char * strerror(int __errnum)

{
  char *pcVar1;
  
  pcVar1 = strerror(__errnum);
  return pcVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

ssize_t write(int __fd,void *__buf,size_t __n)

{
  ssize_t sVar1;
  
  sVar1 = write(__fd,__buf,__n);
  return sVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

char * strchr(char *__s,int __c)

{
  char *pcVar1;
  
  pcVar1 = strchr(__s,__c);
  return pcVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

char * asctime(tm *__tp)

{
  char *pcVar1;
  
  pcVar1 = asctime(__tp);
  return pcVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

size_t strlen(char *__s)

{
  size_t sVar1;
  
  sVar1 = strlen(__s);
  return sVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

int pthread_mutexattr_destroy(pthread_mutexattr_t *__attr)

{
  int iVar1;
  
  iVar1 = pthread_mutexattr_destroy(__attr);
  return iVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

int memcmp(void *__s1,void *__s2,size_t __n)

{
  int iVar1;
  
  iVar1 = memcmp(__s1,__s2,__n);
  return iVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

char * strncpy(char *__dest,char *__src,size_t __n)

{
  char *pcVar1;
  
  pcVar1 = strncpy(__dest,__src,__n);
  return pcVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

tm * localtime_r(time_t *__timer,tm *__tp)

{
  tm *ptVar1;
  
  ptVar1 = localtime_r(__timer,__tp);
  return ptVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

int pthread_condattr_destroy(pthread_condattr_t *__attr)

{
  int iVar1;
  
  iVar1 = pthread_condattr_destroy(__attr);
  return iVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

void * memset(void *__s,int __c,size_t __n)

{
  void *pvVar1;
  
  pvVar1 = memset(__s,__c,__n);
  return pvVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

void abort(void)

{
                    // WARNING: Subroutine does not return
  abort();
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

int pthread_create(pthread_t *__newthread,pthread_attr_t *__attr,__start_routine *__start_routine,
                  void *__arg)

{
  int iVar1;
  
  iVar1 = pthread_create(__newthread,__attr,__start_routine,__arg);
  return iVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

int pthread_attr_setscope(pthread_attr_t *__attr,int __scope)

{
  int iVar1;
  
  iVar1 = pthread_attr_setscope(__attr,__scope);
  return iVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

int msgsnd(int __msqid,void *__msgp,size_t __msgsz,int __msgflg)

{
  int iVar1;
  
  iVar1 = msgsnd(__msqid,__msgp,__msgsz,__msgflg);
  return iVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

int pthread_attr_setstacksize(pthread_attr_t *__attr,size_t __stacksize)

{
  int iVar1;
  
  iVar1 = pthread_attr_setstacksize(__attr,__stacksize);
  return iVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

int open(char *__file,int __oflag,...)

{
  int iVar1;
  
  iVar1 = open(__file,__oflag);
  return iVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

tm * localtime(time_t *__timer)

{
  tm *ptVar1;
  
  ptVar1 = localtime(__timer);
  return ptVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

uint sleep(uint __seconds)

{
  uint uVar1;
  
  uVar1 = sleep(__seconds);
  return uVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

int pthread_mutex_unlock(pthread_mutex_t *__mutex)

{
  int iVar1;
  
  iVar1 = pthread_mutex_unlock(__mutex);
  return iVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

__pid_t waitpid(__pid_t __pid,int *__stat_loc,int __options)

{
  __pid_t _Var1;
  
  _Var1 = waitpid(__pid,__stat_loc,__options);
  return _Var1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

int msgget(key_t __key,int __msgflg)

{
  int iVar1;
  
  iVar1 = msgget(__key,__msgflg);
  return iVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

void * memcpy(void *__dest,void *__src,size_t __n)

{
  void *pvVar1;
  
  pvVar1 = memcpy(__dest,__src,__n);
  return pvVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

int connect(int __fd,sockaddr *__addr,socklen_t __len)

{
  int iVar1;
  
  iVar1 = connect(__fd,__addr,__len);
  return iVar1;
}



void sqlcxt(void)

{
  sqlcxt();
  return;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

pthread_t pthread_self(void)

{
  pthread_t pVar1;
  
  pVar1 = pthread_self();
  return pVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

time_t time(time_t *__timer)

{
  time_t tVar1;
  
  tVar1 = time(__timer);
  return tVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

int getsockname(int __fd,sockaddr *__addr,socklen_t *__len)

{
  int iVar1;
  
  iVar1 = getsockname(__fd,__addr,__len);
  return iVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

char * strcpy(char *__dest,char *__src)

{
  char *pcVar1;
  
  pcVar1 = strcpy(__dest,__src);
  return pcVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

int fmtmsg(long __classification,char *__label,int __severity,char *__text,char *__action,
          char *__tag)

{
  int iVar1;
  
  iVar1 = fmtmsg(__classification,__label,__severity,__text,__action,__tag);
  return iVar1;
}



void __isoc99_sscanf(void)

{
  __isoc99_sscanf();
  return;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

int fclose(FILE *__stream)

{
  int iVar1;
  
  iVar1 = fclose(__stream);
  return iVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

int __xstat(int __ver,char *__filename,stat *__stat_buf)

{
  int iVar1;
  
  iVar1 = __xstat(__ver,__filename,__stat_buf);
  return iVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

char * stpcpy(char *__dest,char *__src)

{
  char *pcVar1;
  
  pcVar1 = stpcpy(__dest,__src);
  return pcVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

int pthread_detach(pthread_t __th)

{
  int iVar1;
  
  iVar1 = pthread_detach(__th);
  return iVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

int pthread_sigmask(int __how,__sigset_t *__newmask,__sigset_t *__oldmask)

{
  int iVar1;
  
  iVar1 = pthread_sigmask(__how,__newmask,__oldmask);
  return iVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

ushort ** __ctype_b_loc(void)

{
  ushort **ppuVar1;
  
  ppuVar1 = __ctype_b_loc();
  return ppuVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

int fseek(FILE *__stream,long __off,int __whence)

{
  int iVar1;
  
  iVar1 = fseek(__stream,__off,__whence);
  return iVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

FILE * fopen64(char *__filename,char *__modes)

{
  FILE *pFVar1;
  
  pFVar1 = fopen64(__filename,__modes);
  return pFVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

int listen(int __fd,int __n)

{
  int iVar1;
  
  iVar1 = listen(__fd,__n);
  return iVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

hostent * gethostbyname(char *__name)

{
  hostent *phVar1;
  
  phVar1 = gethostbyname(__name);
  return phVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

int pthread_mutex_destroy(pthread_mutex_t *__mutex)

{
  int iVar1;
  
  iVar1 = pthread_mutex_destroy(__mutex);
  return iVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

int fflush(FILE *__stream)

{
  int iVar1;
  
  iVar1 = fflush(__stream);
  return iVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

void free(void *__ptr)

{
  do {
                    // WARNING: Do nothing block with infinite loop
  } while( true );
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

long atol(char *__nptr)

{
  long lVar1;
  
  lVar1 = atol(__nptr);
  return lVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

int pthread_cond_init(pthread_cond_t *__cond,pthread_condattr_t *__cond_attr)

{
  int iVar1;
  
  iVar1 = pthread_cond_init(__cond,__cond_attr);
  return iVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

void exit(int __status)

{
                    // WARNING: Subroutine does not return
  exit(__status);
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

int pthread_attr_init(pthread_attr_t *__attr)

{
  int iVar1;
  
  iVar1 = pthread_attr_init(__attr);
  return iVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

char * getenv(char *__name)

{
  char *pcVar1;
  
  pcVar1 = getenv(__name);
  return pcVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

double atof(char *__nptr)

{
  double dVar1;
  
  dVar1 = atof(__nptr);
  return dVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

int fputc(int __c,FILE *__stream)

{
  int iVar1;
  
  iVar1 = fputc(__c,__stream);
  return iVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

int sigemptyset(sigset_t *__set)

{
  int iVar1;
  
  iVar1 = sigemptyset(__set);
  return iVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

int sigaction(int __sig,sigaction *__act,sigaction *__oact)

{
  int iVar1;
  
  iVar1 = sigaction(__sig,__act,__oact);
  return iVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

void * malloc(size_t __size)

{
  do {
                    // WARNING: Do nothing block with infinite loop
  } while( true );
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

int vfprintf(FILE *__s,char *__format,__gnuc_va_list __arg)

{
  int iVar1;
  
  iVar1 = vfprintf(__s,__format,__arg);
  return iVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

int shutdown(int __fd,int __how)

{
  int iVar1;
  
  iVar1 = shutdown(__fd,__how);
  return iVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

int pthread_mutexattr_init(pthread_mutexattr_t *__attr)

{
  int iVar1;
  
  iVar1 = pthread_mutexattr_init(__attr);
  return iVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

int strcmp(char *__s1,char *__s2)

{
  do {
                    // WARNING: Do nothing block with infinite loop
  } while( true );
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

__pid_t getppid(void)

{
  __pid_t _Var1;
  
  _Var1 = getppid();
  return _Var1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

long strtol(char *__nptr,char **__endptr,int __base)

{
  long lVar1;
  
  lVar1 = strtol(__nptr,__endptr,__base);
  return lVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

int kill(__pid_t __pid,int __sig)

{
  int iVar1;
  
  iVar1 = kill(__pid,__sig);
  return iVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

int fprintf(FILE *__stream,char *__format,...)

{
  int iVar1;
  
  iVar1 = fprintf(__stream,__format);
  return iVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

__pid_t getpid(void)

{
  __pid_t _Var1;
  
  _Var1 = getpid();
  return _Var1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

int pthread_mutex_lock(pthread_mutex_t *__mutex)

{
  int iVar1;
  
  iVar1 = pthread_mutex_lock(__mutex);
  return iVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

int pthread_mutex_init(pthread_mutex_t *__mutex,pthread_mutexattr_t *__mutexattr)

{
  int iVar1;
  
  iVar1 = pthread_mutex_init(__mutex,__mutexattr);
  return iVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

size_t fread(void *__ptr,size_t __size,size_t __n,FILE *__stream)

{
  size_t sVar1;
  
  sVar1 = fread(__ptr,__size,__n,__stream);
  return sVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

int gethostname(char *__name,size_t __len)

{
  int iVar1;
  
  iVar1 = gethostname(__name,__len);
  return iVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

int pthread_cond_timedwait(pthread_cond_t *__cond,pthread_mutex_t *__mutex,timespec *__abstime)

{
  int iVar1;
  
  iVar1 = pthread_cond_timedwait(__cond,__mutex,__abstime);
  return iVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

int pthread_cond_wait(pthread_cond_t *__cond,pthread_mutex_t *__mutex)

{
  int iVar1;
  
  iVar1 = pthread_cond_wait(__cond,__mutex);
  return iVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

int sigaddset(sigset_t *__set,int __signo)

{
  int iVar1;
  
  iVar1 = sigaddset(__set,__signo);
  return iVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

int puts(char *__s)

{
  int iVar1;
  
  iVar1 = puts(__s);
  return iVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

int feof(FILE *__stream)

{
  int iVar1;
  
  iVar1 = feof(__stream);
  return iVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

int atoi(char *__nptr)

{
  int iVar1;
  
  iVar1 = atoi(__nptr);
  return iVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

char * strtok(char *__s,char *__delim)

{
  char *pcVar1;
  
  pcVar1 = strtok(__s,__delim);
  return pcVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

char * fgets(char *__s,int __n,FILE *__stream)

{
  char *pcVar1;
  
  pcVar1 = fgets(__s,__n,__stream);
  return pcVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

int gettimeofday(timeval *__tv,__timezone_ptr_t __tz)

{
  int iVar1;
  
  iVar1 = gettimeofday(__tv,__tz);
  return iVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

void * memmove(void *__dest,void *__src,size_t __n)

{
  void *pvVar1;
  
  pvVar1 = memmove(__dest,__src,__n);
  return pvVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

int isprint(int param_1)

{
  int iVar1;
  
  iVar1 = isprint(param_1);
  return iVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

void pthread_exit(void *__retval)

{
                    // WARNING: Subroutine does not return
  pthread_exit(__retval);
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

int setsockopt(int __fd,int __level,int __optname,void *__optval,socklen_t __optlen)

{
  int iVar1;
  
  iVar1 = setsockopt(__fd,__level,__optname,__optval,__optlen);
  return iVar1;
}



void __libc_start_main(void)

{
  __libc_start_main();
  return;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

int ferror(FILE *__stream)

{
  int iVar1;
  
  iVar1 = ferror(__stream);
  return iVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

void qsort(void *__base,size_t __nmemb,size_t __size,__compar_fn_t __compar)

{
  qsort(__base,__nmemb,__size,__compar);
  return;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

size_t fwrite(void *__ptr,size_t __size,size_t __n,FILE *__s)

{
  size_t sVar1;
  
  sVar1 = fwrite(__ptr,__size,__n,__s);
  return sVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

int close(int __fd)

{
  int iVar1;
  
  iVar1 = close(__fd);
  return iVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

tm * gmtime_r(time_t *__timer,tm *__tp)

{
  tm *ptVar1;
  
  ptVar1 = gmtime_r(__timer,__tp);
  return ptVar1;
}



void __gmon_start__(void)

{
  __gmon_start__();
  return;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

void CRYPTO_lock_part_0(void)

{
  int iVar1;
  size_t sVar2;
  long lVar3;
  char *pcVar4;
  
  lVar3 = 0x253;
  iVar1 = 0x4d56cb;
  OpenSSLDie("cryptlib.c",0x253,"pointer != NULL");
  if (iVar1 < 2) {
    puts("Usage : <ResourceId> <ProgramName>");
                    // WARNING: Subroutine does not return
    exit(-1);
  }
  strcpy(G_sNps.F_szRsrcId,*(char **)(lVar3 + 8));
  pcVar4 = *(char **)(lVar3 + 8);
  sVar2 = strlen(pcVar4);
  fprintf(_stdout,"ResourceId :%s,%s,%d .\n",&G_sNps,pcVar4,sVar2);
  iVar1 = InitModule(G_sNps.F_szRsrcId);
  if (iVar1 != 0) {
    fprintf(_stdout,"Error when calling InitModule(%.6s).\n",&G_sNps);
    fwrite("Unable to start the interface.\n",1,0x1f,_stdout);
                    // WARNING: Subroutine does not return
    exit(-1);
  }
  iVar1 = pthread_create(&tab_ThrInfo[1].tid,(pthread_attr_t *)0x0,thread_wait_BAL,(void *)0x0);
  if (iVar1 < 0) {
    pcVar4 = "Unable to create the BAL_THREAD_ID thread";
  }
  else {
    iVar1 = pthread_create(&tab_ThrInfo[2].tid,(pthread_attr_t *)0x0,thread_wait_LINE,(void *)0x0);
    if (iVar1 < 0) {
      pcVar4 = "Unable to create the LINE_THREAD_ID thread";
    }
    else {
      iVar1 = pthread_create(&tab_ThrInfo[8].tid,(pthread_attr_t *)0x0,thread_CTL,(void *)0x0);
      if (iVar1 < 0) {
        pcVar4 = "Unable to create the CTL_THREAD_ID thread";
      }
      else {
        iVar1 = pthread_create(&tab_ThrInfo[5].tid,(pthread_attr_t *)0x0,thread_TIMEOUT,(void *)0x0)
        ;
        if (iVar1 < 0) {
          pcVar4 = "Unable to create the TIME_THREAD_ID thread";
        }
        else {
          iVar1 = pthread_create(&tab_ThrInfo[6].tid,(pthread_attr_t *)0x0,thread_SAF,(void *)0x0);
          if (-1 < iVar1) {
            trace_event("Creation de Thread Echo Test",1);
            iVar1 = pthread_create(&tab_ThrInfo[6].tid,(pthread_attr_t *)0x0,thread_echo_test,
                                   (void *)0x0);
            if (-1 < iVar1) {
              trace_event("Creation de Thread Dynamic Key Exchange",1);
              iVar1 = pthread_create(&tab_ThrInfo[0x11].tid,(pthread_attr_t *)0x0,
                                     thread_key_exchange,(void *)0x0);
              pcVar4 = "Unable to create the Dynamic Key Exchange thread";
              if (-1 < iVar1) {
                do {
                  pause();
                } while( true );
              }
              goto LAB_00402a1e;
            }
          }
          pcVar4 = "Unable to create the SAF_THREAD_ID thread";
        }
      }
    }
  }
LAB_00402a1e:
  trace_event(pcVar4,1);
  trace_event("End   main(ERROR)",1);
                    // WARNING: Subroutine does not return
  exit(-1);
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address
// WARNING: Unknown calling convention

int main(int argc,char **argv)

{
  int iVar1;
  size_t sVar2;
  char *pcVar3;
  
  if (argc < 2) {
    puts("Usage : <ResourceId> <ProgramName>");
                    // WARNING: Subroutine does not return
    exit(-1);
  }
  strcpy(G_sNps.F_szRsrcId,argv[1]);
  pcVar3 = argv[1];
  sVar2 = strlen(pcVar3);
  fprintf(_stdout,"ResourceId :%s,%s,%d .\n",&G_sNps,pcVar3,sVar2);
  iVar1 = InitModule(G_sNps.F_szRsrcId);
  if (iVar1 != 0) {
    fprintf(_stdout,"Error when calling InitModule(%.6s).\n",&G_sNps);
    fwrite("Unable to start the interface.\n",1,0x1f,_stdout);
                    // WARNING: Subroutine does not return
    exit(-1);
  }
  iVar1 = pthread_create(&tab_ThrInfo[1].tid,(pthread_attr_t *)0x0,thread_wait_BAL,(void *)0x0);
  if (iVar1 < 0) {
    pcVar3 = "Unable to create the BAL_THREAD_ID thread";
  }
  else {
    iVar1 = pthread_create(&tab_ThrInfo[2].tid,(pthread_attr_t *)0x0,thread_wait_LINE,(void *)0x0);
    if (iVar1 < 0) {
      pcVar3 = "Unable to create the LINE_THREAD_ID thread";
    }
    else {
      iVar1 = pthread_create(&tab_ThrInfo[8].tid,(pthread_attr_t *)0x0,thread_CTL,(void *)0x0);
      if (iVar1 < 0) {
        pcVar3 = "Unable to create the CTL_THREAD_ID thread";
      }
      else {
        iVar1 = pthread_create(&tab_ThrInfo[5].tid,(pthread_attr_t *)0x0,thread_TIMEOUT,(void *)0x0)
        ;
        if (iVar1 < 0) {
          pcVar3 = "Unable to create the TIME_THREAD_ID thread";
        }
        else {
          iVar1 = pthread_create(&tab_ThrInfo[6].tid,(pthread_attr_t *)0x0,thread_SAF,(void *)0x0);
          if (-1 < iVar1) {
            trace_event("Creation de Thread Echo Test",1);
            iVar1 = pthread_create(&tab_ThrInfo[6].tid,(pthread_attr_t *)0x0,thread_echo_test,
                                   (void *)0x0);
            if (-1 < iVar1) {
              trace_event("Creation de Thread Dynamic Key Exchange",1);
              iVar1 = pthread_create(&tab_ThrInfo[0x11].tid,(pthread_attr_t *)0x0,
                                     thread_key_exchange,(void *)0x0);
              pcVar3 = "Unable to create the Dynamic Key Exchange thread";
              if (-1 < iVar1) {
                do {
                  pause();
                } while( true );
              }
              goto LAB_00402a1e;
            }
          }
          pcVar3 = "Unable to create the SAF_THREAD_ID thread";
        }
      }
    }
  }
LAB_00402a1e:
  trace_event(pcVar3,1);
  trace_event("End   main(ERROR)",1);
                    // WARNING: Subroutine does not return
  exit(-1);
}



void processEntry _start(undefined8 param_1,undefined8 param_2)

{
  undefined1 auStack_8 [8];
  
  __libc_start_main(main,param_2,&stack0x00000008,__libc_csu_init,__libc_csu_fini,param_1,auStack_8)
  ;
  do {
                    // WARNING: Do nothing block with infinite loop
  } while( true );
}



// WARNING: Removing unreachable block (ram,0x00402ab7)
// WARNING: Removing unreachable block (ram,0x00402ac1)

void deregister_tm_clones(void)

{
  return;
}



// WARNING: Removing unreachable block (ram,0x00402af4)
// WARNING: Removing unreachable block (ram,0x00402afe)

void register_tm_clones(void)

{
  return;
}



void __do_global_dtors_aux(void)

{
  if (completed_6355 == '\0') {
    deregister_tm_clones();
    completed_6355 = '\x01';
  }
  return;
}



// WARNING: Removing unreachable block (ram,0x00402b3a)
// WARNING: Removing unreachable block (ram,0x00402b44)

void frame_dummy(void)

{
  register_tm_clones();
  return;
}



// WARNING: Unknown calling convention

void sig_alarm(int X)

{
  pthread_t pVar1;
  long lVar2;
  char *pcVar3;
  char szDetail [80];
  
  pcVar3 = szDetail;
  for (lVar2 = 10; lVar2 != 0; lVar2 = lVar2 + -1) {
    *(undefined8 *)pcVar3 = 0;
    pcVar3 = (char *)((long)pcVar3 + 8);
  }
  pVar1 = pthread_self();
  sprintf(szDetail,"TIMEOUT  : %d\n",pVar1);
  trace_event(szDetail,1);
  return;
}



// WARNING: Unknown calling convention

void sig_segment_violation(int X)

{
  pthread_t pVar1;
  long lVar2;
  char *pcVar3;
  char szDetail [80];
  
  pcVar3 = szDetail;
  for (lVar2 = 10; lVar2 != 0; lVar2 = lVar2 + -1) {
    *(undefined8 *)pcVar3 = 0;
    pcVar3 = (char *)((long)pcVar3 + 8);
  }
  pVar1 = pthread_self();
  sprintf(szDetail,"SEGV  : %d, X=%d\n",pVar1,X);
  trace_event(szDetail,1);
  pthread_kill(tab_ThrInfo[3].tid,0xc);
  sleep(10);
  return;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address
// WARNING: Unknown calling convention

int ThreadMaskSignals(void)

{
  int iVar1;
  size_t __n;
  char *__ptr;
  sigset_t set;
  
  iVar1 = sigemptyset((sigset_t *)&set);
  if (iVar1 < 0) {
    __n = 0x21;
    __ptr = "Error when calling sigemptyset()\n";
  }
  else {
    iVar1 = sigaddset((sigset_t *)&set,0xd);
    if (iVar1 < 0) {
      __n = 0x26;
      __ptr = "Error when calling sigaddset(SIGPIPE)\n";
    }
    else {
      iVar1 = sigaddset((sigset_t *)&set,0x11);
      if (iVar1 < 0) {
        __n = 0x26;
        __ptr = "Error when calling sigaddset(SIGCHLD)\n";
      }
      else {
        iVar1 = sigaddset((sigset_t *)&set,0xc);
        if (iVar1 < 0) {
          __ptr = "Error when calling sigaddset(SIGUSR2)\n";
          __n = 0x26;
        }
        else {
          iVar1 = pthread_sigmask(0,(__sigset_t *)&set,(__sigset_t *)0x0);
          if (-1 < iVar1) {
            fwrite("End   ThreadMaskSignal(OK)\n",1,0x1b,_stdout);
            return 0;
          }
          __n = 0x28;
          __ptr = "Error when calling sigaddset(SIG_BLOCK)\n";
        }
      }
    }
  }
  fwrite(__ptr,1,__n,stderr);
  fwrite("End   ThreadMaskSignal(FATAL)\n",1,0x1e,_stdout);
  return 1;
}



// WARNING: Unknown calling convention

void GetGlobals(TSResources *P_sResource)

{
  long lVar1;
  size_t sVar2;
  char *pcVar3;
  byte bVar4;
  
  bVar4 = 0;
  trace_file._0_8_ = *(undefined8 *)P_sResource->pris_log_file_name;
  trace_file._16_4_ = *(undefined4 *)(P_sResource->pris_log_file_name + 0x10);
  trace_file._8_8_ = *(undefined8 *)(P_sResource->pris_log_file_name + 8);
  max_size = P_sResource->pris_log_max_size;
  lVar1 = strtol(P_sResource->pris_trace_level,(char **)0x0,10);
  trace_level = (int)lVar1;
  CommsId._0_2_ = *(undefined2 *)P_sResource->pris_comms_id;
  ProtocolId._0_2_ = *(undefined2 *)P_sResource->pris_protocol_id;
  CommsId[2] = '\0';
  ProtocolId[2] = '\0';
  pcVar3 = DeviceName;
  for (lVar1 = 8; lVar1 != 0; lVar1 = lVar1 + -1) {
    pcVar3[0] = '\0';
    pcVar3[1] = '\0';
    pcVar3[2] = '\0';
    pcVar3[3] = '\0';
    pcVar3[4] = '\0';
    pcVar3[5] = '\0';
    pcVar3[6] = '\0';
    pcVar3[7] = '\0';
    pcVar3 = pcVar3 + ((ulong)bVar4 * -2 + 1) * 8;
  }
  *pcVar3 = '\0';
  sVar2 = strlen(P_sResource->pris_device_name);
  memcpy(DeviceName,P_sResource->pris_device_name,sVar2);
  pcVar3 = RemoteAppName;
  for (lVar1 = 8; lVar1 != 0; lVar1 = lVar1 + -1) {
    pcVar3[0] = '\0';
    pcVar3[1] = '\0';
    pcVar3[2] = '\0';
    pcVar3[3] = '\0';
    pcVar3[4] = '\0';
    pcVar3[5] = '\0';
    pcVar3[6] = '\0';
    pcVar3[7] = '\0';
    pcVar3 = pcVar3 + ((ulong)bVar4 * -2 + 1) * 8;
  }
  *pcVar3 = '\0';
  sVar2 = strlen(P_sResource->pris_remote_application_name);
  memcpy(RemoteAppName,P_sResource->pris_remote_application_name,sVar2);
  pcVar3 = RemoteAppId;
  for (lVar1 = 8; lVar1 != 0; lVar1 = lVar1 + -1) {
    pcVar3[0] = '\0';
    pcVar3[1] = '\0';
    pcVar3[2] = '\0';
    pcVar3[3] = '\0';
    pcVar3[4] = '\0';
    pcVar3[5] = '\0';
    pcVar3[6] = '\0';
    pcVar3[7] = '\0';
    pcVar3 = pcVar3 + ((ulong)bVar4 * -2 + 1) * 8;
  }
  *pcVar3 = '\0';
  sVar2 = strlen(P_sResource->pris_remote_application_id);
  memcpy(RemoteAppId,P_sResource->pris_remote_application_id,sVar2);
  pcVar3 = LocalAppName;
  for (lVar1 = 8; lVar1 != 0; lVar1 = lVar1 + -1) {
    pcVar3[0] = '\0';
    pcVar3[1] = '\0';
    pcVar3[2] = '\0';
    pcVar3[3] = '\0';
    pcVar3[4] = '\0';
    pcVar3[5] = '\0';
    pcVar3[6] = '\0';
    pcVar3[7] = '\0';
    pcVar3 = pcVar3 + ((ulong)bVar4 * -2 + 1) * 8;
  }
  *pcVar3 = '\0';
  sVar2 = strlen(P_sResource->pris_local_application_name);
  memcpy(LocalAppName,P_sResource->pris_local_application_name,sVar2);
  pcVar3 = LocalAppId;
  for (lVar1 = 8; lVar1 != 0; lVar1 = lVar1 + -1) {
    pcVar3[0] = '\0';
    pcVar3[1] = '\0';
    pcVar3[2] = '\0';
    pcVar3[3] = '\0';
    pcVar3[4] = '\0';
    pcVar3[5] = '\0';
    pcVar3[6] = '\0';
    pcVar3[7] = '\0';
    pcVar3 = pcVar3 + ((ulong)bVar4 * -2 + 1) * 8;
  }
  *pcVar3 = '\0';
  sVar2 = strlen(P_sResource->pris_local_application_id);
  memcpy(LocalAppId,P_sResource->pris_local_application_id,sVar2);
  nTimerAcq = P_sResource->pris_timer_acquirer;
  nIssAcqDelta = P_sResource->pris_delta_timer_iss_acq;
  MinTroublesInd = P_sResource->pris_min_troubles_ind;
  MaxTroublesInd = P_sResource->pris_max_troubles_ind;
  max_thread = P_sResource->pris_nb_static_threads;
  nUserThread = P_sResource->pris_nb_user_threads_vs_kernel;
  max_request = P_sResource->pris_nb_static_threads * 0x14;
  AcquirerBank._0_4_ = *(undefined4 *)P_sResource->pris_bank_code;
  AcquirerBank._4_2_ = *(undefined2 *)(P_sResource->pris_bank_code + 4);
  G_sNps.F_nEchoTestPeriod = (int)P_sResource->pris_echo_test_timer;
  EchoTestTimer = G_sNps.F_nEchoTestPeriod;
  return;
}



// WARNING: Unknown calling convention

int InitModule(char *P_szResourceId)

{
  uint uVar1;
  int iVar2;
  int iVar3;
  uint *puVar4;
  long lVar5;
  size_t __n;
  char *pcVar6;
  char app_pid [9];
  char app_ppid [9];
  char sLine [512];
  TSResources sResource;
  
  app_pid[0] = '\0';
  app_pid[1] = '\0';
  app_pid[2] = '\0';
  app_pid[3] = '\0';
  app_pid[4] = '\0';
  app_pid[5] = '\0';
  app_pid[6] = '\0';
  app_pid[7] = '\0';
  app_pid[8] = '\0';
  app_ppid[0] = '\0';
  app_ppid[1] = '\0';
  app_ppid[2] = '\0';
  app_ppid[3] = '\0';
  app_ppid[4] = '\0';
  app_ppid[5] = '\0';
  app_ppid[6] = '\0';
  app_ppid[7] = '\0';
  app_ppid[8] = '\0';
  pcVar6 = sLine;
  for (lVar5 = 0x40; lVar5 != 0; lVar5 = lVar5 + -1) {
    pcVar6[0] = '\0';
    pcVar6[1] = '\0';
    pcVar6[2] = '\0';
    pcVar6[3] = '\0';
    pcVar6[4] = '\0';
    pcVar6[5] = '\0';
    pcVar6[6] = '\0';
    pcVar6[7] = '\0';
    pcVar6 = pcVar6 + 8;
  }
  nBalMsg = OpenBalCom(0x100);
  if (nBalMsg < 0) {
    fwrite("OpenBalCom(BAL_MSG) failed. \n",1,0x1d,stderr);
  }
  else {
    uVar1 = getpid();
    EmptyQueue(nBalMsg,(ulong)uVar1);
    nBalAdm = OpenBalCom(0x101);
    if (nBalAdm < 0) {
      fwrite("OpenBalCom(BAL_ADM) failed. \n",1,0x1d,stderr);
    }
    else {
      uVar1 = getpid();
      EmptyQueue(nBalAdm,(ulong)uVar1);
      iVar2 = pthread_create(&tab_ThrInfo[4].tid,(pthread_attr_t *)0x0,thread_ADMIN,(void *)0x0);
      if (-1 < iVar2) {
        iVar2 = 0x712878;
        iVar3 = pthread_create(&tab_ThrInfo[3].tid,(pthread_attr_t *)0x0,thread_SIG,(void *)0x0);
        if (-1 < iVar3) {
          EnableThreads(iVar2);
          AllocateOracleCtx(0);
          iVar2 = ConnectOracle(0);
          if (iVar2 != 0) {
            fwrite("ConnectOracle() failed.\n",1,0x18,stderr);
            return 1;
          }
          sResource.resource_id._0_4_ = *(undefined4 *)P_szResourceId;
          sResource.resource_id._4_2_ = *(undefined2 *)(P_szResourceId + 4);
          iVar2 = GetResources(0,&sResource);
          if (iVar2 == 0) {
            iVar2 = ResourceActivity(0,P_szResourceId,1);
            if (iVar2 == 0) {
              GetGlobals(&sResource);
              DumpGlobals();
              install_handler(3,sig_segment_violation);
              install_handler(4,sig_segment_violation);
              install_handler(5,sig_segment_violation);
              install_handler(6,sig_segment_violation);
              install_handler(8,sig_segment_violation);
              install_handler(7,sig_segment_violation);
              install_handler(0x1f,sig_segment_violation);
              iVar2 = init_trace();
              if (iVar2 == 0) {
                trace_event("***************************************",5);
                trace_event("**         New Session Started       **",5);
                trace_event("***************************************",5);
                InitTabHsmCtx(0);
                G_sNps.F_szResourceStatus[0] = '\0';
                G_sNps.F_szResourceStatus[1] = '\0';
                G_sNps.F_szResourceStatus[2] = '\0';
                G_sNps.F_szResourceStatus[3] = '\0';
                iVar2 = ResetResource(0,P_szResourceId,ResourceInternalId);
                if (iVar2 == 0) {
                  G_sNps.F_szResourceStatus[0] = '\0';
                  G_sNps.F_szResourceStatus[1] = '\0';
                  G_sNps.F_szResourceStatus[2] = 'F';
                  G_sNps.F_szResourceStatus[0] = 'O';
                  G_sNps.F_szResourceStatus[1] = 'F';
                  sResource.pris_processing_step[0] = 'O';
                  sResource.pris_processing_step[1] = 'F';
                  sResource.pris_processing_step[2] = 'F';
                  sResource.resource_live[0] = 'C';
                  uVar1 = getpid();
                  sprintf(app_pid,"%08d",(ulong)uVar1);
                  uVar1 = getppid();
                  sprintf(app_ppid,"%08d",(ulong)uVar1);
                  InitList();
                  InitTabAlarm();
                  InitBalProdConso();
                  InitLineProdConso();
                  InitTimeProdConso();
                  InitDBConThreads();
                  install_handler(0xe,sig_alarm);
                  DeconnectOracle(0);
                  FreeOracleCtx(0);
                  return 0;
                }
                __n = 0x18;
                pcVar6 = "ResetResource() failed.\n";
              }
              else {
                __n = 0x15;
                pcVar6 = "init_trace() failed.\n";
              }
            }
            else {
              __n = 0x27;
              pcVar6 = "Resources_Ativity table update failed.\n";
            }
          }
          else {
            pcVar6 = "GetResources() failed.\n";
            __n = 0x17;
          }
          fwrite(pcVar6,1,__n,stderr);
          DeconnectOracle(0);
          FreeOracleCtx(0);
          return 1;
        }
      }
      puVar4 = (uint *)__errno_location();
      fprintf(stderr,"pthread_create Error %d\n",(ulong)*puVar4);
    }
  }
  return 1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

void DumpGlobals(void)

{
  fprintf(stderr,"\n Comms Id ..................= %.2s ",CommsId);
  fprintf(stderr,"\n trace_file.................= %s ",trace_file);
  fprintf(stderr,"\n trace_level................= %d ",(ulong)(uint)trace_level);
  fprintf(stderr,"\n Acquirer Timer.............= %d ",(ulong)(uint)nTimerAcq);
  fprintf(stderr,"\n Delta Time Acquirer/Issuer.= %d ",(ulong)(uint)nIssAcqDelta);
  fprintf(stderr,"\n Min Troubles Ind...........= %d ",(ulong)(uint)MinTroublesInd);
  fprintf(stderr,"\n Max Troubles Ind...........= %d ",(ulong)(uint)MaxTroublesInd);
  fprintf(stderr,"\n Nbr Max Threads............= %d ",(ulong)(uint)max_thread);
  fprintf(stderr,"\n Nbr User Threads...........= %d ",(ulong)(uint)nUserThread);
  fprintf(stderr,"\n Max Request................= %d ",(ulong)(uint)max_request);
  fprintf(stderr,"\n Protocol ID................= %.2s ",ProtocolId);
  fprintf(stderr,"\n Device Name................= %.15s ",DeviceName);
  fprintf(stderr,"\n Remote Application Name....= %.15s ",RemoteAppName);
  fprintf(stderr,"\n Remote Application Id......= %.15s ",RemoteAppId);
  fprintf(stderr,"\n Local  Application Name....= %.15s ",LocalAppName);
  fprintf(stderr,"\n Local  Application Id......= %.15s ",LocalAppId);
  fputc(10,stderr);
  return;
}



// WARNING: Unknown calling convention

int GetMaxSafCounter(void)

{
  return 10;
}



// WARNING: Unknown calling convention

int GetAdviceInterval(char *ResourceId)

{
  return 2;
}



// WARNING: Unknown calling convention

char GetDeclineAdvicesFlag(char *Resource)

{
  return 'N';
}



// WARNING: Unknown calling convention

int FCT_NW_MNG_REQ_TO_NW(int nIndexCtx,TSIsoInfo *P_psIsoInfo,char *pReqType)

{
  int iVar1;
  size_t sVar2;
  long lVar3;
  TSIsoInfo *IsoInfo;
  char *pcVar4;
  byte bVar5;
  int vTempLen;
  char FunctionCode [4];
  int tmpFieldLen;
  time_t nPurgeTime;
  char tmpField [256];
  char sLine [512];
  TSNpsInfo vNpsInfo;
  char vTempField [4096];
  char vGmtDate [4096];
  TSNodeData Node;
  
  bVar5 = 0;
  trace_event("Start FCT_NW_MNG_REQ_TO_NW()",5);
  pcVar4 = vTempField;
  for (lVar3 = 0x200; lVar3 != 0; lVar3 = lVar3 + -1) {
    pcVar4[0] = '\0';
    pcVar4[1] = '\0';
    pcVar4[2] = '\0';
    pcVar4[3] = '\0';
    pcVar4[4] = '\0';
    pcVar4[5] = '\0';
    pcVar4[6] = '\0';
    pcVar4[7] = '\0';
    pcVar4 = pcVar4 + (ulong)bVar5 * -0x10 + 8;
  }
  FunctionCode[0] = '\0';
  FunctionCode[1] = '\0';
  FunctionCode[2] = '\0';
  FunctionCode[3] = '\0';
  pcVar4 = vGmtDate;
  for (lVar3 = 0x200; lVar3 != 0; lVar3 = lVar3 + -1) {
    pcVar4[0] = '\0';
    pcVar4[1] = '\0';
    pcVar4[2] = '\0';
    pcVar4[3] = '\0';
    pcVar4[4] = '\0';
    pcVar4[5] = '\0';
    pcVar4[6] = '\0';
    pcVar4[7] = '\0';
    pcVar4 = pcVar4 + (ulong)bVar5 * -0x10 + 8;
  }
  pcVar4 = tmpField;
  for (lVar3 = 0x20; lVar3 != 0; lVar3 = lVar3 + -1) {
    pcVar4[0] = '\0';
    pcVar4[1] = '\0';
    pcVar4[2] = '\0';
    pcVar4[3] = '\0';
    pcVar4[4] = '\0';
    pcVar4[5] = '\0';
    pcVar4[6] = '\0';
    pcVar4[7] = '\0';
    pcVar4 = pcVar4 + (ulong)bVar5 * -0x10 + 8;
  }
  pcVar4 = sLine;
  for (lVar3 = 0x40; lVar3 != 0; lVar3 = lVar3 + -1) {
    pcVar4[0] = '\0';
    pcVar4[1] = '\0';
    pcVar4[2] = '\0';
    pcVar4[3] = '\0';
    pcVar4[4] = '\0';
    pcVar4[5] = '\0';
    pcVar4[6] = '\0';
    pcVar4[7] = '\0';
    pcVar4 = pcVar4 + (ulong)bVar5 * -0x10 + 8;
  }
  InitNpsInfo(&vNpsInfo);
  vNpsInfo.nMsgType = 800;
  current_gmt_date(vGmtDate);
  iVar1 = GetIsoField(6,P_psIsoInfo,vTempField,&vTempLen);
  if (iVar1 == 0) {
    AddNpsField(6,&vNpsInfo,vTempField,vTempLen);
  }
  else {
    AddNpsField(6,&vNpsInfo,vGmtDate + 2,10);
  }
  GetInternalStan(nIndexCtx,vTempField);
  AddNpsField(10,&vNpsInfo,vTempField,6);
  GetIsoField(0x17,P_psIsoInfo,vTempField,&vTempLen);
  iVar1 = memcmp(vTempField,&DAT_004a29eb,3);
  if (iVar1 == 0) {
    vTempField[2] = '1';
    vTempField[0] = '0';
    vTempField[1] = '0';
  }
  else {
    iVar1 = memcmp(vTempField,&DAT_004a29ef,3);
    if (iVar1 == 0) {
      vTempField[2] = '2';
      vTempField[0] = '0';
      vTempField[1] = '0';
    }
    else {
      vTempField[2] = '1';
      vTempField[0] = '3';
      vTempField[1] = '0';
    }
  }
  AddNpsField(0x45,&vNpsInfo,vTempField,3);
  iVar1 = Buffer_To_Nps(nIndexCtx,&vNpsInfo);
  if (iVar1 == 0) {
    InitNodeData(&Node);
    GetIssuerPurgeTime(&nPurgeTime);
    Node.tPurgeTime = nPurgeTime;
    sprintf(sLine,"NPS purge time %d");
    trace_event(sLine,5);
    GetNpsField(10,&vNpsInfo,tmpField,&tmpFieldLen);
    sprintf(Node.szFstKey,"%04d",(ulong)(uint)vNpsInfo.nMsgType);
    Node.szFstKey[4] = tmpField[0];
    Node.szFstKey[5] = tmpField[1];
    Node.szFstKey[6] = tmpField[2];
    Node.szFstKey[7] = tmpField[3];
    Node.szFstKey[8] = tmpField[4];
    Node.szFstKey[9] = tmpField[5];
    sprintf(sLine,"Cle de Chainage   = %.10s ",Node.szFstKey);
    trace_event(sLine,5);
    sVar2 = strlen(pReqType);
    sprintf(sLine,"==> pReqType=[%s]. strlen(pReqType)=[%d]",pReqType,sVar2);
    trace_event(sLine,5);
    sVar2 = strlen(pReqType);
    memcpy(Node.sFstPrvtData,pReqType,sVar2);
    Node.nFstPrvtDataLen = (int)sVar2;
    Node.nFstBufLen = NpsBuildMsg(Node.sFstBuf,&vNpsInfo,IsoInfo);
    Node.nSndBufLen = IsoBuildMsg(Node.sSndBuf,P_psIsoInfo);
    sprintf(sLine,"Len Fst %d , Len Snd %d ",(ulong)(uint)Node.nFstBufLen,
            (ulong)(uint)Node.nSndBufLen);
    trace_event(sLine,5);
    iVar1 = InsertRequest('B',&Node);
    if (iVar1 == 0) {
      trace_event("End   FCT_NW_MNG_REQ_TO_NW(OK)",5);
      iVar1 = 0;
    }
    else {
      iVar1 = -1;
      trace_event("End FCT_NW_MNG_REQ_TO_NW(NOK) ",5);
    }
  }
  else {
    iVar1 = -1;
    trace_event("End FCT_NW_MNG_REQ_TO_NW: Buffer_To_Nps() failed",1);
  }
  return iVar1;
}



// WARNING: Unknown calling convention

int FCT_NW_MNG_REP_FROM_NW(int nIndexCtx,TSNpsInfo *NpsInfo)

{
  int iVar1;
  long lVar2;
  TSResources *pTVar3;
  char *pcVar4;
  byte bVar5;
  int FieldLen;
  int Length;
  char sStan [7];
  char SourceId [9];
  char sLine [512];
  TSResources sResource;
  TSIsoInfo IsoInfo;
  char FieldData [4096];
  char sSecurityData [4097];
  TSBalExchange BalMessage;
  TSNodeData Node;
  TSTlvPrivate TlvInfo;
  
  bVar5 = 0;
  trace_event("Start FCT_NW_MNG_REP_FROM_NW()",5);
  pTVar3 = &sResource;
  for (lVar2 = 0x73; lVar2 != 0; lVar2 = lVar2 + -1) {
    pTVar3->resource_id[0] = '\0';
    pTVar3->resource_id[1] = '\0';
    pTVar3->resource_id[2] = '\0';
    pTVar3->resource_id[3] = '\0';
    pTVar3->resource_id[4] = '\0';
    pTVar3->resource_id[5] = '\0';
    pTVar3->resource_id[6] = '\0';
    pTVar3->resource_code[0] = '\0';
    pTVar3 = (TSResources *)((long)pTVar3 + (ulong)bVar5 * -0x10 + 8);
  }
  InitNodeData(&Node);
  iVar1 = GetNpsField(10,NpsInfo,sStan,&FieldLen);
  pcVar4 = "Missing Stan Field";
  if (iVar1 != 0) {
LAB_00403dac:
    trace_event(pcVar4,1);
    trace_event("FCT_NW_MNG_REP_FROM_NW(NOK)",1);
    return -1;
  }
  iVar1 = GetNpsField(0x45,NpsInfo,FieldData,&FieldLen);
  if (iVar1 != 0) {
    pcVar4 = "Missing DE70";
    goto LAB_00403dac;
  }
  sprintf(Node.szFstKey,"%04d",(ulong)(NpsInfo->nMsgType - 10));
  Node.szFstKey[4] = sStan[0];
  Node.szFstKey[5] = sStan[1];
  Node.szFstKey[6] = sStan[2];
  Node.szFstKey[7] = sStan[3];
  Node.szFstKey[8] = sStan[4];
  Node.szFstKey[9] = sStan[5];
  sprintf(sLine,"Cle de Recherche   = %.10s ",Node.szFstKey);
  trace_event(sLine,5);
  iVar1 = FetchRequest('B',&Node);
  if (iVar1 == -0xc) {
    pcVar4 = "Response Was Delayed";
LAB_00403d1c:
    trace_event(pcVar4,1);
    trace_event("End FCT_NW_MNG_REP_FROM_NW (NOK)",1);
    return -1;
  }
  pcVar4 = "FetchRequest failed (ENOEXIST)";
  if (iVar1 == -0xb) goto LAB_00403d1c;
  trace_event("FetchRequest SUCCES ",5);
  pcVar4 = Node.sFstPrvtData;
  iVar1 = memcmp(pcVar4,"ECHO_NPS",8);
  if (iVar1 == 0) {
    sprintf(sLine,"=> MESSAGE ECHO RESPONSE RECEIVED : NpsStan[%.8s][%s] ",pcVar4,sStan);
    trace_event(sLine,5);
    echoTentative = 0;
    return 0;
  }
  if ((Node.nFstPrvtDataLen != 0) && (iVar1 = memcmp(pcVar4,"SCREEN",6), iVar1 == 0)) {
    InitIsoInfo(&IsoInfo);
    AnalyseIso(Node.sSndBuf,&IsoInfo);
    IsoInfo.nMsgType = 0x650;
    InsertIsoField(0x26,&IsoInfo,"000",3);
    dump_p7_struct(&IsoInfo);
    iVar1 = GetIsoField(0x2b,&IsoInfo,FieldData,&FieldLen);
    if (iVar1 == 0) {
      InitTlvPrivate(&TlvInfo);
      AnalyseTlvPrivate(FieldData,FieldLen,&TlvInfo);
      GetTlvPrivate("A09",&TlvInfo,FieldData,&FieldLen);
    }
    GetIsoField(0x34,&IsoInfo,sSecurityData,&FieldLen);
    GetSecurityData(4,sSecurityData,SourceId,&Length);
    sprintf(sLine,"==> SourceId=[%s], nBalAdm=[%d], sSecurityData=[%s]",SourceId,
            (ulong)(uint)nBalAdm,sSecurityData);
    trace_event(sLine,5);
    lVar2 = strtol(SourceId,(char **)0x0,10);
    BalMessage.sHeader.nPartnerId = (pid_t)lVar2;
    BalMessage.sHeader.nSourceId = getpid();
    BalMessage.sHeader.nCommand = 0x650;
    Length = IsoBuildMsg(BalMessage.sBody,&IsoInfo);
    BalMessage.sHeader.nLen = Length;
    iVar1 = WriteBalMsg(nBalAdm,&BalMessage);
    if (iVar1 != 0) {
      fwrite("WriteBalMsg failed.\n",1,0x14,stderr);
      return -1;
    }
  }
  sResource.resource_id[0] = G_sNps.F_szRsrcId[0];
  sResource.resource_id[1] = G_sNps.F_szRsrcId[1];
  sResource.resource_id[2] = G_sNps.F_szRsrcId[2];
  sResource.resource_id[3] = G_sNps.F_szRsrcId[3];
  sResource.resource_id[4] = G_sNps.F_szRsrcId[4];
  sResource.resource_id[5] = G_sNps.F_szRsrcId[5];
  iVar1 = GetResources(nIndexCtx,&sResource);
  if (iVar1 != 0) {
    shutdown_resource(nIndexCtx,G_sNps.F_szRsrcId);
    pcVar4 = "GetResources() failed.";
    goto LAB_00403e8b;
  }
  iVar1 = memcmp(FieldData,&DAT_004a7e3c,3);
  if (iVar1 == 0) {
    G_sNps.F_szResourceStatus[0] = 'O';
    G_sNps.F_szResourceStatus[1] = 'F';
    G_sNps.F_szResourceStatus[2] = 'F';
    iVar1 = UpdateResource(nIndexCtx,G_sNps.F_szRsrcId,"YYY","OFL");
    if (iVar1 == 0) goto LAB_00403cb4;
  }
  else {
LAB_00403cb4:
    iVar1 = memcmp(FieldData,"001",3);
    if (iVar1 != 0) {
LAB_00403cfb:
      trace_event("End FCT_NW_MNG_REP_FROM_NW(OK)",5);
      return 0;
    }
    G_sNps.F_szResourceStatus[0] = 'O';
    G_sNps.F_szResourceStatus[1] = 'N';
    G_sNps.F_szResourceStatus[2] = 'L';
    iVar1 = UpdateResource(nIndexCtx,G_sNps.F_szRsrcId,"YYY","ONL");
    if (iVar1 == 0) goto LAB_00403cfb;
  }
  shutdown_resource(nIndexCtx,G_sNps.F_szRsrcId);
  pcVar4 = "UpdateResource() failed.";
LAB_00403e8b:
  trace_event(pcVar4,0);
  DeconnectOracle(nIndexCtx);
  FreeOracleCtx(nIndexCtx);
  StopCltCom(nFdConnect);
                    // WARNING: Subroutine does not return
  exit(0);
}



// WARNING: Unknown calling convention

int FCT_NW_ADV_REQ_FROM_NW(int nIndexCtx,TSNpsInfo *NpsInfo)

{
  int iVar1;
  long lVar2;
  char *pcVar3;
  byte bVar4;
  int FieldLen;
  char szStlmntDate [24];
  char sBuffer [1024];
  TSNpsInfo NewNpsInfo;
  char FieldData [4096];
  
  bVar4 = 0;
  trace_event("Start FCT_NW_ADV_REQ_FROM_NW()",5);
  szStlmntDate[0] = '\0';
  szStlmntDate[1] = '\0';
  szStlmntDate[2] = '\0';
  szStlmntDate[3] = '\0';
  szStlmntDate[4] = '\0';
  szStlmntDate[5] = '\0';
  szStlmntDate[6] = '\0';
  szStlmntDate[7] = '\0';
  szStlmntDate[8] = '\0';
  szStlmntDate[9] = '\0';
  szStlmntDate[10] = '\0';
  szStlmntDate[0xb] = '\0';
  szStlmntDate[0xc] = '\0';
  szStlmntDate[0xd] = '\0';
  szStlmntDate[0xe] = '\0';
  szStlmntDate[0xf] = '\0';
  szStlmntDate[0x10] = '\0';
  szStlmntDate[0x11] = '\0';
  szStlmntDate[0x12] = '\0';
  szStlmntDate[0x13] = '\0';
  szStlmntDate[0x14] = '\0';
  szStlmntDate[0x15] = '\0';
  szStlmntDate[0x16] = '\0';
  szStlmntDate[0x17] = '\0';
  pcVar3 = sBuffer;
  for (lVar2 = 0x80; lVar2 != 0; lVar2 = lVar2 + -1) {
    pcVar3[0] = '\0';
    pcVar3[1] = '\0';
    pcVar3[2] = '\0';
    pcVar3[3] = '\0';
    pcVar3[4] = '\0';
    pcVar3[5] = '\0';
    pcVar3[6] = '\0';
    pcVar3[7] = '\0';
    pcVar3 = pcVar3 + (ulong)bVar4 * -0x10 + 8;
  }
  pcVar3 = FieldData;
  for (lVar2 = 0x200; lVar2 != 0; lVar2 = lVar2 + -1) {
    pcVar3[0] = '\0';
    pcVar3[1] = '\0';
    pcVar3[2] = '\0';
    pcVar3[3] = '\0';
    pcVar3[4] = '\0';
    pcVar3[5] = '\0';
    pcVar3[6] = '\0';
    pcVar3[7] = '\0';
    pcVar3 = pcVar3 + (ulong)bVar4 * -0x10 + 8;
  }
  InitNpsInfo(&NewNpsInfo);
  NewNpsInfo.nMsgType = 0x33e;
  iVar1 = GetNpsField(6,NpsInfo,FieldData,&FieldLen);
  if (iVar1 == 0) {
    AddNpsField(6,&NewNpsInfo,FieldData,FieldLen);
  }
  iVar1 = GetNpsField(10,NpsInfo,FieldData,&FieldLen);
  if (iVar1 == 0) {
    AddNpsField(10,&NewNpsInfo,FieldData,FieldLen);
  }
  iVar1 = GetNpsField(0xe,NpsInfo,FieldData,&FieldLen);
  if (iVar1 == 0) {
    AddNpsField(0xe,&NewNpsInfo,FieldData,FieldLen);
  }
  iVar1 = GetNpsField(0xb,NpsInfo,FieldData,&FieldLen);
  if (iVar1 == 0) {
    AddNpsField(0xb,&NewNpsInfo,FieldData,FieldLen);
  }
  AddNpsField(0x26,&NewNpsInfo,"00",2);
  iVar1 = GetNpsField(0x45,NpsInfo,FieldData,&FieldLen);
  if (iVar1 == 0) {
    AddNpsField(0x45,&NewNpsInfo,FieldData,FieldLen);
  }
  iVar1 = GetNpsField(0x45,NpsInfo,FieldData,&FieldLen);
  if (iVar1 == 0) {
    iVar1 = memcmp(FieldData,&DAT_004a6744,3);
    if (iVar1 == 0) {
      iVar1 = GetNpsField(0xe,NpsInfo,szStlmntDate,&FieldLen);
      if (iVar1 == 0) {
        SetStlmntDate(nIndexCtx,"NT",szStlmntDate);
      }
    }
  }
  iVar1 = Buffer_To_Nps(nIndexCtx,&NewNpsInfo);
  if (iVar1 == 0) {
    trace_event("End   FCT_NW_ADV_REQ_FROM_NW(OK)",5);
    iVar1 = 0;
  }
  else {
    iVar1 = -1;
    trace_event("End  FCT_NW_MNG_REQ_FROM_NW(): Buffer_To_Nps() failed",1);
  }
  return iVar1;
}



// WARNING: Unknown calling convention

int BuildNwMngMsg(int nIndexCtx,TSNpsInfo *pNpsInfo,char *pInfoCode)

{
  long lVar1;
  char *pcVar2;
  char sLine [512];
  char vTempField [4096];
  char vGmtDate [4096];
  
  pcVar2 = vTempField;
  for (lVar1 = 0x200; lVar1 != 0; lVar1 = lVar1 + -1) {
    pcVar2[0] = '\0';
    pcVar2[1] = '\0';
    pcVar2[2] = '\0';
    pcVar2[3] = '\0';
    pcVar2[4] = '\0';
    pcVar2[5] = '\0';
    pcVar2[6] = '\0';
    pcVar2[7] = '\0';
    pcVar2 = pcVar2 + 8;
  }
  pcVar2 = vGmtDate;
  for (lVar1 = 0x200; lVar1 != 0; lVar1 = lVar1 + -1) {
    pcVar2[0] = '\0';
    pcVar2[1] = '\0';
    pcVar2[2] = '\0';
    pcVar2[3] = '\0';
    pcVar2[4] = '\0';
    pcVar2[5] = '\0';
    pcVar2[6] = '\0';
    pcVar2[7] = '\0';
    pcVar2 = pcVar2 + 8;
  }
  pcVar2 = sLine;
  for (lVar1 = 0x40; lVar1 != 0; lVar1 = lVar1 + -1) {
    *(undefined8 *)pcVar2 = 0;
    pcVar2 = (char *)((long)pcVar2 + 8);
  }
  sprintf(sLine,"Start BuildNwMngMsg(%s)");
  trace_event(sLine,5);
  InitNpsInfo(pNpsInfo);
  pNpsInfo->nMsgType = 800;
  current_gmt_date(vGmtDate);
  AddNpsField(6,pNpsInfo,vGmtDate + 2,10);
  GetInternalStan(nIndexCtx,vTempField);
  AddNpsField(10,pNpsInfo,vTempField,6);
  AddNpsField(0x45,pNpsInfo,pInfoCode,3);
  DumpStructNps(pNpsInfo);
  trace_event("End   BuildNwMngMsg(OK)",5);
  return 0;
}



// WARNING: Unknown calling convention

int initial_sign_on_to_nw(int nIndexCtx)

{
  uint uVar1;
  int iVar2;
  int iVar3;
  long lVar4;
  TSIsoInfo *IsoInfo;
  uint uVar5;
  char *pcVar6;
  byte bVar7;
  char npsRespCode [4];
  char sSignOn [4];
  int flag_alarm;
  int inLength;
  int FieldLen;
  char npsRefNbr [13];
  char sentRefNbr [13];
  char RefNbr [13];
  char FieldData [256];
  char sLine [512];
  char outBuffer [1024];
  char inBuffer [1024];
  TSNpsInfo vNpsInfo;
  TSNpsInfo NpsInfo;
  TSNpsInfo inNpsInfo;
  
  bVar7 = 0;
  flag_alarm = -1;
  trace_event("Start initial_sign_on_to_nw()",5);
  npsRespCode[0] = '\0';
  npsRespCode[1] = '\0';
  npsRespCode[2] = '\0';
  npsRespCode[3] = '\0';
  sentRefNbr[0] = '\0';
  sentRefNbr[1] = '\0';
  sentRefNbr[2] = '\0';
  sentRefNbr[3] = '\0';
  sentRefNbr[4] = '\0';
  sentRefNbr[5] = '\0';
  sentRefNbr[6] = '\0';
  sentRefNbr[7] = '\0';
  sentRefNbr[8] = '\0';
  sentRefNbr[9] = '\0';
  sentRefNbr[10] = '\0';
  sentRefNbr[0xb] = '\0';
  sentRefNbr[0xc] = '\0';
  pcVar6 = FieldData;
  for (lVar4 = 0x20; lVar4 != 0; lVar4 = lVar4 + -1) {
    pcVar6[0] = '\0';
    pcVar6[1] = '\0';
    pcVar6[2] = '\0';
    pcVar6[3] = '\0';
    pcVar6[4] = '\0';
    pcVar6[5] = '\0';
    pcVar6[6] = '\0';
    pcVar6[7] = '\0';
    pcVar6 = pcVar6 + (ulong)bVar7 * -0x10 + 8;
  }
  npsRefNbr[0] = '\0';
  npsRefNbr[1] = '\0';
  npsRefNbr[2] = '\0';
  npsRefNbr[3] = '\0';
  npsRefNbr[4] = '\0';
  npsRefNbr[5] = '\0';
  npsRefNbr[6] = '\0';
  npsRefNbr[7] = '\0';
  npsRefNbr[8] = '\0';
  npsRefNbr[9] = '\0';
  npsRefNbr[10] = '\0';
  npsRefNbr[0xb] = '\0';
  npsRefNbr[0xc] = '\0';
  sSignOn[0] = '\0';
  sSignOn[1] = '\0';
  sSignOn[2] = '\0';
  sSignOn[3] = '\0';
  pcVar6 = sLine;
  for (lVar4 = 0x40; lVar4 != 0; lVar4 = lVar4 + -1) {
    pcVar6[0] = '\0';
    pcVar6[1] = '\0';
    pcVar6[2] = '\0';
    pcVar6[3] = '\0';
    pcVar6[4] = '\0';
    pcVar6[5] = '\0';
    pcVar6[6] = '\0';
    pcVar6[7] = '\0';
    pcVar6 = pcVar6 + (ulong)bVar7 * -0x10 + 8;
  }
  pcVar6 = outBuffer;
  for (lVar4 = 0x80; lVar4 != 0; lVar4 = lVar4 + -1) {
    pcVar6[0] = '\0';
    pcVar6[1] = '\0';
    pcVar6[2] = '\0';
    pcVar6[3] = '\0';
    pcVar6[4] = '\0';
    pcVar6[5] = '\0';
    pcVar6[6] = '\0';
    pcVar6[7] = '\0';
    pcVar6 = pcVar6 + (ulong)bVar7 * -0x10 + 8;
  }
  pcVar6 = inBuffer;
  for (lVar4 = 0x80; lVar4 != 0; lVar4 = lVar4 + -1) {
    pcVar6[0] = '\0';
    pcVar6[1] = '\0';
    pcVar6[2] = '\0';
    pcVar6[3] = '\0';
    pcVar6[4] = '\0';
    pcVar6[5] = '\0';
    pcVar6[6] = '\0';
    pcVar6[7] = '\0';
    pcVar6 = pcVar6 + (ulong)bVar7 * -0x10 + 8;
  }
  InitNpsInfo(&vNpsInfo);
  InitNpsInfo(&NpsInfo);
  InitNpsInfo(&inNpsInfo);
  sSignOn[0] = '0';
  sSignOn[1] = '0';
  sSignOn[2] = '1';
  uVar5 = 0;
  BuildNwMngMsg(nIndexCtx,&vNpsInfo,sSignOn);
  iVar2 = NpsBuildMsg(outBuffer,&vNpsInfo,IsoInfo);
  do {
    uVar1 = uVar5 + 1;
    flag_alarm = -1;
    sprintf(sLine,"Send SignOn Atempt (%d)",(ulong)uVar1);
    trace_event(sLine,1);
    iVar3 = WriteLineMsg(nFdConnect,outBuffer,iVar2);
    if (iVar3 != 0) {
      trace_event("Can Not Write The First SignOn To Line",0);
      shutdown_resource(nIndexCtx,G_sNps.F_szRsrcId);
    }
    THR_Alarm(10,&flag_alarm);
    iVar3 = ReadLineMsg(nFdConnect,inBuffer,&inLength);
    THR_Alarm(0,&flag_alarm);
    if (iVar3 == 0) {
      trace_event("Sign On Response Received .....",1);
      DumpNps(inBuffer);
      AnalyseNps(inBuffer,&inNpsInfo);
      GetNpsField(10,&vNpsInfo,sentRefNbr,&FieldLen);
      GetNpsField(10,&inNpsInfo,npsRefNbr,&FieldLen);
      GetNpsField(0x26,&inNpsInfo,npsRespCode,&FieldLen);
      fprintf(stderr,"\n type  = %d ",(ulong)(uint)inNpsInfo.nMsgType);
      fprintf(stderr,"\n RRN R = %.12s ",npsRefNbr);
      fprintf(stderr,"\n RRN S = %.12s ",sentRefNbr);
      fprintf(stderr,"\n RESP CODE  = %.3s ",npsRespCode);
      sprintf(sLine,"Received. MTI=[%d], F11=[%s], F39=[%s]. Sent F11=[%s]",
              (ulong)(uint)inNpsInfo.nMsgType,npsRefNbr,npsRespCode,sentRefNbr);
      trace_event(sLine,5);
      if (((inNpsInfo.nMsgType == 0x32a) && (iVar3 = memcmp(npsRefNbr,sentRefNbr,0xc), iVar3 == 0))
         && (iVar3 = memcmp(npsRespCode,"00",3), iVar3 == 0)) {
        trace_event("End   initial_sign_on_to_nw(OK)",5);
        return 0;
      }
      trace_event(" ===> Next SIGN ON attempt in 10 seconds <===",5);
      sleep(10);
      uVar5 = uVar1;
    }
    else if (flag_alarm == 0) {
      trace_event("Response Not Received.....",1);
      uVar5 = uVar1;
    }
    else {
      trace_event("Probleme On Receiving Response.....",1);
      shutdown_resource(nIndexCtx,G_sNps.F_szRsrcId);
    }
    if (4 < (int)uVar5) {
      trace_event("End   initial_sign_on_to_nw(NOK)",5);
      iVar2 = shutdown_resource(nIndexCtx,G_sNps.F_szRsrcId);
      return iVar2;
    }
  } while( true );
}



// WARNING: Unknown calling convention

int SendNwMngMsg(int nIndexCtx,char *InfoCode)

{
  int iVar1;
  TSNpsInfo vNpsInfo;
  
  trace_event("Start SendNwMngMsg()",5);
  BuildNwMngMsg(nIndexCtx,&vNpsInfo,InfoCode);
  iVar1 = Buffer_To_Nps(nIndexCtx,&vNpsInfo);
  if (iVar1 == 0) {
    trace_event("End   SendNwMngMsg(OK)",5);
    iVar1 = 0;
  }
  else {
    iVar1 = -1;
    trace_event("End  SendNwMngMsg(): Buffer_To_Nps() failed",1);
  }
  return iVar1;
}



// WARNING: Unknown calling convention

int sign_off(int nIndexCtx)

{
  trace_event("Start sign_off()",5);
  SendNwMngMsg(nIndexCtx,"002");
  trace_event("End   sign_off(OK)",5);
  return 0;
}



// WARNING: Unknown calling convention

int sign_on(int nIndexCtx)

{
  trace_event("Start sign_on()",5);
  SendNwMngMsg(nIndexCtx,"001");
  trace_event("End   sign_on(OK)",5);
  return 0;
}



// WARNING: Unknown calling convention

int echo_test(int nIndexCtx)

{
  trace_event("Start echo_test()",5);
  SendNwMngMsg(nIndexCtx,"301");
  trace_event("End   echo_test(OK)",5);
  return 0;
}



// WARNING: Unknown calling convention

int getCSMCode(char *sCsm,char *sCode,char *sResult)

{
  int iVar1;
  size_t sVar2;
  char *pcVar3;
  size_t sVar4;
  char sLine [512];
  char sCsmDup [1025];
  
  sVar2 = strlen(sCsm);
  pcVar3 = (char *)memcpy(sCsmDup,sCsm,sVar2);
  pcVar3 = strtok(pcVar3," ");
  if (pcVar3 != (char *)0x0) {
    while (pcVar3 = strtok((char *)0x0," "), pcVar3 != (char *)0x0) {
      sVar2 = strlen(sCode);
      iVar1 = memcmp(pcVar3,sCode,sVar2);
      if (iVar1 == 0) {
        sVar4 = strlen(pcVar3);
        memcpy(sResult,pcVar3 + sVar2,sVar4 - sVar2);
        sprintf(sLine,"Debug Res=[%s]\n",sResult);
        trace_event(sLine,5);
        return 0;
      }
      sprintf(sLine,"Debug val=[%s]\n",pcVar3);
      trace_event(sLine,5);
    }
    sprintf(sLine,"Debug val=[%s]\n",0);
    trace_event(sLine,5);
  }
  return -1;
}



// WARNING: Unknown calling convention

int FCT_KEY_EXCHANGE(int nIndexCtx,TSNpsInfo *pNpsInfo)

{
  undefined4 uVar1;
  int iVar2;
  uint uVar3;
  long lVar4;
  ulong uVar5;
  char *pcVar6;
  byte bVar7;
  int FieldLen;
  int FieldLen1;
  char szZpkZmk [256];
  char szZpkZmkTmp [256];
  char szZpkLmk [256];
  char vZmkLmk [256];
  char szCheckValueIn [256];
  char szCheckValueOut [256];
  char ligne [256];
  char sLine [512];
  TSSubTagNps tlvInfo;
  char FieldData [4096];
  char FieldData1 [4096];
  
  bVar7 = 0;
  trace_event(" START FCT_KEY_EXCHANGE()",5);
  pcVar6 = szCheckValueIn;
  for (lVar4 = 0x20; lVar4 != 0; lVar4 = lVar4 + -1) {
    pcVar6[0] = '\0';
    pcVar6[1] = '\0';
    pcVar6[2] = '\0';
    pcVar6[3] = '\0';
    pcVar6[4] = '\0';
    pcVar6[5] = '\0';
    pcVar6[6] = '\0';
    pcVar6[7] = '\0';
    pcVar6 = pcVar6 + (ulong)bVar7 * -0x10 + 8;
  }
  pcVar6 = szCheckValueOut;
  for (lVar4 = 0x20; lVar4 != 0; lVar4 = lVar4 + -1) {
    pcVar6[0] = '\0';
    pcVar6[1] = '\0';
    pcVar6[2] = '\0';
    pcVar6[3] = '\0';
    pcVar6[4] = '\0';
    pcVar6[5] = '\0';
    pcVar6[6] = '\0';
    pcVar6[7] = '\0';
    pcVar6 = pcVar6 + (ulong)bVar7 * -0x10 + 8;
  }
  pcVar6 = FieldData;
  for (lVar4 = 0x200; lVar4 != 0; lVar4 = lVar4 + -1) {
    pcVar6[0] = '\0';
    pcVar6[1] = '\0';
    pcVar6[2] = '\0';
    pcVar6[3] = '\0';
    pcVar6[4] = '\0';
    pcVar6[5] = '\0';
    pcVar6[6] = '\0';
    pcVar6[7] = '\0';
    pcVar6 = pcVar6 + (ulong)bVar7 * -0x10 + 8;
  }
  pcVar6 = FieldData1;
  for (lVar4 = 0x200; lVar4 != 0; lVar4 = lVar4 + -1) {
    pcVar6[0] = '\0';
    pcVar6[1] = '\0';
    pcVar6[2] = '\0';
    pcVar6[3] = '\0';
    pcVar6[4] = '\0';
    pcVar6[5] = '\0';
    pcVar6[6] = '\0';
    pcVar6[7] = '\0';
    pcVar6 = pcVar6 + (ulong)bVar7 * -0x10 + 8;
  }
  iVar2 = GetNpsField(0x2d,pNpsInfo,FieldData1,&FieldLen1);
  if (iVar2 == 0) {
    sprintf(ligne,"FD-46 (%s): ",FieldData1);
    trace_event(ligne,5);
    InitNpsSubFldInfo(&tlvInfo);
    AnalyseNpsF46SubFld(FieldData1,FieldLen1,&tlvInfo);
    lVar4 = 0x20;
    builtin_strncpy(ligne + 0x10,"...",4);
    pcVar6 = szZpkZmk;
    for (; lVar4 != 0; lVar4 = lVar4 + -1) {
      pcVar6[0] = '\0';
      pcVar6[1] = '\0';
      pcVar6[2] = '\0';
      pcVar6[3] = '\0';
      pcVar6[4] = '\0';
      pcVar6[5] = '\0';
      pcVar6[6] = '\0';
      pcVar6[7] = '\0';
      pcVar6 = pcVar6 + (ulong)bVar7 * -0x10 + 8;
    }
    builtin_strncpy(ligne,"Getting 740 TAG ",0x10);
    pcVar6 = szZpkZmkTmp;
    for (lVar4 = 0x20; lVar4 != 0; lVar4 = lVar4 + -1) {
      pcVar6[0] = '\0';
      pcVar6[1] = '\0';
      pcVar6[2] = '\0';
      pcVar6[3] = '\0';
      pcVar6[4] = '\0';
      pcVar6[5] = '\0';
      pcVar6[6] = '\0';
      pcVar6[7] = '\0';
      pcVar6 = pcVar6 + (ulong)bVar7 * -0x10 + 8;
    }
    pcVar6 = szZpkLmk;
    for (lVar4 = 0x20; lVar4 != 0; lVar4 = lVar4 + -1) {
      pcVar6[0] = '\0';
      pcVar6[1] = '\0';
      pcVar6[2] = '\0';
      pcVar6[3] = '\0';
      pcVar6[4] = '\0';
      pcVar6[5] = '\0';
      pcVar6[6] = '\0';
      pcVar6[7] = '\0';
      pcVar6 = pcVar6 + (ulong)bVar7 * -0x10 + 8;
    }
    trace_event(ligne,5);
    iVar2 = GetNpsF46SubFldTag("740",&tlvInfo,FieldData,&FieldLen);
    if (iVar2 == 0) {
      sprintf(ligne,"740 TAG (%s): ",FieldData);
      trace_event(ligne,5);
      memcpy(szZpkZmk,FieldData,(long)FieldLen);
    }
    sprintf(ligne,"szZpkZmk : [%s]",szZpkZmk);
    trace_event(ligne,5);
    uVar1 = ligne._16_4_;
    builtin_strncpy(ligne,"Getting 742 TAG...",0x12);
    ligne._18_2_ = SUB42(uVar1,2) & 0xff00;
    trace_event(ligne,5);
    pcVar6 = FieldData;
    for (lVar4 = 0x200; lVar4 != 0; lVar4 = lVar4 + -1) {
      pcVar6[0] = '\0';
      pcVar6[1] = '\0';
      pcVar6[2] = '\0';
      pcVar6[3] = '\0';
      pcVar6[4] = '\0';
      pcVar6[5] = '\0';
      pcVar6[6] = '\0';
      pcVar6[7] = '\0';
      pcVar6 = pcVar6 + (ulong)bVar7 * -0x10 + 8;
    }
    iVar2 = GetNpsF46SubFldTag("742",&tlvInfo,FieldData,&FieldLen);
    if (iVar2 == 0) {
      sprintf(ligne,"742 TAG (%s): ",FieldData);
      trace_event(ligne,5);
      memcpy(szCheckValueIn,FieldData,(long)FieldLen);
      pcVar6 = vZmkLmk;
      for (lVar4 = 0x20; lVar4 != 0; lVar4 = lVar4 + -1) {
        pcVar6[0] = '\0';
        pcVar6[1] = '\0';
        pcVar6[2] = '\0';
        pcVar6[3] = '\0';
        pcVar6[4] = '\0';
        pcVar6[5] = '\0';
        pcVar6[6] = '\0';
        pcVar6[7] = '\0';
        pcVar6 = pcVar6 + (ulong)bVar7 * -0x10 + 8;
      }
      uVar3 = GetZMK(nIndexCtx,G_sNps.F_szRsrcId,vZmkLmk);
      uVar5 = (ulong)uVar3;
      if (uVar3 == 0) {
        uVar3 = key_exchange_scheme(nIndexCtx,vZmkLmk,szZpkZmk,szCheckValueIn,szZpkLmk,
                                    szCheckValueOut);
        uVar5 = (ulong)uVar3;
        if (uVar3 == 0) {
          SetAWK(nIndexCtx,G_sNps.F_szRsrcId,szZpkLmk,szCheckValueOut);
          uVar3 = SetIWK(nIndexCtx,G_sNps.F_szRsrcId,szZpkLmk,szCheckValueOut);
          uVar5 = (ulong)uVar3;
        }
      }
      goto LAB_004049f1;
    }
  }
  uVar5 = 0;
LAB_004049f1:
  sprintf(sLine," END   FCT_KEY_EXCHANGE( %d )",uVar5);
  trace_event(sLine,5);
  return (int)uVar5;
}



// WARNING: Unknown calling convention

int BuildField123(int nIndexCtx,char *inFieldData123,char *outFieldData123)

{
  int iVar1;
  uint uVar2;
  uint uVar3;
  long lVar4;
  char *pcVar5;
  uint *puVar6;
  uint *puVar7;
  size_t sVar8;
  int iVar9;
  long lVar10;
  bool bVar11;
  byte bVar12;
  char sCodeValue [256];
  char sLine [512];
  
  bVar12 = 0;
  lVar10 = 0xc;
  iVar9 = 0xc;
  sprintf(sLine,"Start BuildField123(%.70s)",inFieldData123);
  trace_event(sLine,5);
  lVar4 = 0x20;
  builtin_strncpy(outFieldData123,"CSM(MCL/",8);
  pcVar5 = sCodeValue;
  for (; lVar4 != 0; lVar4 = lVar4 + -1) {
    *(undefined8 *)pcVar5 = 0;
    pcVar5 = (char *)((long)pcVar5 + ((ulong)bVar12 * -2 + 1) * 8);
  }
  builtin_strncpy(outFieldData123 + 8,"RSM ",4);
  iVar1 = getCSMCode(inFieldData123,"ORG/",sCodeValue);
  if (iVar1 == 0) {
    builtin_strncpy(outFieldData123 + 0xc,"RCV/",4);
    puVar7 = (uint *)sCodeValue;
    do {
      puVar6 = puVar7;
      uVar2 = *puVar6 + 0xfefefeff & ~*puVar6;
      uVar3 = uVar2 & 0x80808080;
      puVar7 = puVar6 + 1;
    } while (uVar3 == 0);
    bVar11 = (uVar2 & 0x8080) == 0;
    if (bVar11) {
      uVar3 = uVar3 >> 0x10;
    }
    if (bVar11) {
      puVar7 = (uint *)((long)puVar6 + 6);
    }
    sVar8 = (long)puVar7 + ((-3 - (ulong)CARRY1((byte)uVar3,(byte)uVar3)) - (long)sCodeValue);
    iVar9 = (int)sVar8 + 0x10;
    memcpy(outFieldData123 + 0x10,sCodeValue,sVar8);
    lVar10 = (long)iVar9;
  }
  pcVar5 = sCodeValue;
  for (lVar4 = 0x20; lVar4 != 0; lVar4 = lVar4 + -1) {
    *(undefined8 *)pcVar5 = 0;
    pcVar5 = (char *)((long)pcVar5 + ((ulong)bVar12 * -2 + 1) * 8);
  }
  iVar1 = getCSMCode(inFieldData123,"RCV/",sCodeValue);
  if (iVar1 == 0) {
    builtin_strncpy(outFieldData123 + lVar10," ORG/",5);
    puVar7 = (uint *)sCodeValue;
    do {
      puVar6 = puVar7;
      uVar2 = *puVar6 + 0xfefefeff & ~*puVar6;
      uVar3 = uVar2 & 0x80808080;
      puVar7 = puVar6 + 1;
    } while (uVar3 == 0);
    bVar11 = (uVar2 & 0x8080) == 0;
    if (bVar11) {
      uVar3 = uVar3 >> 0x10;
    }
    if (bVar11) {
      puVar7 = (uint *)((long)puVar6 + 6);
    }
    sVar8 = (long)puVar7 + ((-3 - (ulong)CARRY1((byte)uVar3,(byte)uVar3)) - (long)sCodeValue);
    memcpy(outFieldData123 + (iVar9 + 5),sCodeValue,sVar8);
    lVar10 = (long)(iVar9 + 5 + (int)sVar8);
  }
  outFieldData123[lVar10] = '\0';
  sprintf(sLine,"End   BuildField123(%.50s)",outFieldData123);
  trace_event(sLine,5);
  return 0;
}



// WARNING: Unknown calling convention

int FCT_NW_MNG_REQ_FROM_NW(int nIndexCtx,TSNpsInfo *NpsInfo)

{
  int iVar1;
  uint uVar2;
  uint uVar3;
  long lVar4;
  uint *puVar5;
  uint *puVar6;
  char *pcVar7;
  bool bVar8;
  byte bVar9;
  int FieldLen;
  char szStlmntDate [24];
  char sBuffer [1024];
  TSNpsInfo NewNpsInfo;
  char FieldData [4096];
  char outFieldData123 [4096];
  
  bVar9 = 0;
  trace_event("Start FCT_NW_MNG_REQ_FROM_NW()",5);
  szStlmntDate[0] = '\0';
  szStlmntDate[1] = '\0';
  szStlmntDate[2] = '\0';
  szStlmntDate[3] = '\0';
  szStlmntDate[4] = '\0';
  szStlmntDate[5] = '\0';
  szStlmntDate[6] = '\0';
  szStlmntDate[7] = '\0';
  szStlmntDate[8] = '\0';
  szStlmntDate[9] = '\0';
  szStlmntDate[10] = '\0';
  szStlmntDate[0xb] = '\0';
  szStlmntDate[0xc] = '\0';
  szStlmntDate[0xd] = '\0';
  szStlmntDate[0xe] = '\0';
  szStlmntDate[0xf] = '\0';
  szStlmntDate[0x10] = '\0';
  szStlmntDate[0x11] = '\0';
  szStlmntDate[0x12] = '\0';
  szStlmntDate[0x13] = '\0';
  szStlmntDate[0x14] = '\0';
  szStlmntDate[0x15] = '\0';
  szStlmntDate[0x16] = '\0';
  szStlmntDate[0x17] = '\0';
  pcVar7 = sBuffer;
  for (lVar4 = 0x80; lVar4 != 0; lVar4 = lVar4 + -1) {
    pcVar7[0] = '\0';
    pcVar7[1] = '\0';
    pcVar7[2] = '\0';
    pcVar7[3] = '\0';
    pcVar7[4] = '\0';
    pcVar7[5] = '\0';
    pcVar7[6] = '\0';
    pcVar7[7] = '\0';
    pcVar7 = pcVar7 + (ulong)bVar9 * -0x10 + 8;
  }
  InitNpsInfo(&NewNpsInfo);
  NewNpsInfo.nMsgType = 0x32a;
  iVar1 = GetNpsField(6,NpsInfo,FieldData,&FieldLen);
  if (iVar1 == 0) {
    AddNpsField(6,&NewNpsInfo,FieldData,FieldLen);
  }
  iVar1 = GetNpsField(10,NpsInfo,FieldData,&FieldLen);
  if (iVar1 == 0) {
    AddNpsField(10,&NewNpsInfo,FieldData,FieldLen);
  }
  iVar1 = GetNpsField(0xb,NpsInfo,FieldData,&FieldLen);
  if (iVar1 == 0) {
    AddNpsField(0xb,&NewNpsInfo,FieldData,FieldLen);
  }
  AddNpsField(0x26,&NewNpsInfo,"00",2);
  iVar1 = GetNpsField(0x45,NpsInfo,FieldData,&FieldLen);
  if (iVar1 == 0) {
    AddNpsField(0x45,&NewNpsInfo,FieldData,FieldLen);
  }
  iVar1 = memcmp(FieldData,&DAT_004a6744,3);
  if (iVar1 == 0) {
    iVar1 = GetNpsField(0xe,NpsInfo,szStlmntDate,&FieldLen);
    if (iVar1 == 0) {
      SetStlmntDate(nIndexCtx,"NT",szStlmntDate);
    }
  }
  iVar1 = memcmp(FieldData,&DAT_004a2d59,3);
  if ((((iVar1 == 0) || (iVar1 = memcmp(FieldData,&DAT_004a2d5d,3), iVar1 == 0)) ||
      (iVar1 = memcmp(FieldData,&DAT_004a2d61,3), iVar1 == 0)) ||
     (iVar1 = memcmp(FieldData,&DAT_004a2d65,3), iVar1 == 0)) {
    trace_event("Change Key Request...",5);
    iVar1 = FCT_KEY_EXCHANGE(nIndexCtx,NpsInfo);
    if (iVar1 == 0) {
      iVar1 = GetNpsField(0x34,NpsInfo,FieldData,&FieldLen);
      if (iVar1 == 0) {
        PutNpsField(0x34,&NewNpsInfo,FieldData,FieldLen);
      }
      iVar1 = GetNpsField(0x77,NpsInfo,FieldData,&FieldLen);
      if (iVar1 == 0) {
        PutNpsField(0x77,&NewNpsInfo,FieldData,FieldLen);
      }
      iVar1 = GetNpsField(0x7a,NpsInfo,FieldData,&FieldLen);
      if (iVar1 == 0) {
        BuildField123(nIndexCtx,FieldData,outFieldData123);
        puVar6 = (uint *)outFieldData123;
        do {
          puVar5 = puVar6;
          uVar2 = *puVar5 + 0xfefefeff & ~*puVar5;
          uVar3 = uVar2 & 0x80808080;
          puVar6 = puVar5 + 1;
        } while (uVar3 == 0);
        bVar8 = (uVar2 & 0x8080) == 0;
        if (bVar8) {
          uVar3 = uVar3 >> 0x10;
        }
        if (bVar8) {
          puVar6 = (uint *)((long)puVar5 + 6);
        }
        PutNpsField(0x7a,&NewNpsInfo,outFieldData123,
                    (((int)puVar6 + -3) - (uint)CARRY1((byte)uVar3,(byte)uVar3)) -
                    (int)outFieldData123);
      }
    }
    else {
      PutNpsField(0x26,&NewNpsInfo,"96",2);
    }
  }
  iVar1 = Buffer_To_Nps(nIndexCtx,&NewNpsInfo);
  if (iVar1 == 0) {
    trace_event("End   FCT_NW_MNG_REQ_FROM_NW(OK)",5);
    iVar1 = 0;
  }
  else {
    iVar1 = -1;
    trace_event("End  FCT_NW_MNG_REQ_FROM_NW(): Buffer_To_Nps() failed",1);
  }
  return iVar1;
}



// WARNING: Removing unreachable block (ram,0x00405325)
// WARNING: Removing unreachable block (ram,0x00405384)
// WARNING: Unknown calling convention

int InsertReconcNPS(int nIndexCtx,char *sReconcType,TSIsoInfo *sIsoInfo)

{
  int iVar1;
  uint uVar2;
  uint uVar3;
  size_t __n;
  long lVar4;
  ulong uVar5;
  uint *puVar6;
  uint *puVar7;
  char *pcVar8;
  uchar *puVar9;
  bool bVar10;
  byte bVar11;
  char T_ReconcType [4];
  int T_RetVal;
  sqlca sqlca;
  sqlexd sqlstm;
  char sLine [512];
  char sTlvBuffer [4096];
  anon_struct_4098_2_43c7b5cf T_TLV_data;
  anon_struct_4098_2_43c7b5cf T_TLV_warning;
  TSTlvAutho sTlvInfo;
  
  bVar11 = 0;
  pcVar8 = sLine;
  for (lVar4 = 0x40; lVar4 != 0; lVar4 = lVar4 + -1) {
    pcVar8[0] = '\0';
    pcVar8[1] = '\0';
    pcVar8[2] = '\0';
    pcVar8[3] = '\0';
    pcVar8[4] = '\0';
    pcVar8[5] = '\0';
    pcVar8[6] = '\0';
    pcVar8[7] = '\0';
    pcVar8 = pcVar8 + 8;
  }
  sprintf(sLine,"Start InsertReconcNPS(%s)",sReconcType);
  trace_event(sLine,5);
  T_ReconcType[0] = '\0';
  T_ReconcType[1] = '\0';
  T_ReconcType[2] = '\0';
  T_ReconcType[3] = '\0';
  uVar3 = 0xffe;
  puVar7 = (uint *)sTlvBuffer;
  for (lVar4 = 0x200; lVar4 != 0; lVar4 = lVar4 + -1) {
    puVar7[0] = 0;
    puVar7[1] = 0;
    puVar7 = puVar7 + (ulong)bVar11 * -4 + 2;
  }
  puVar9 = T_TLV_data.arr + 2;
  T_TLV_data.arr[0] = '\0';
  T_TLV_data.arr[1] = '\0';
  bVar10 = ((ulong)puVar9 & 4) != 0;
  if (bVar10) {
    T_TLV_data.arr[2] = '\0';
    T_TLV_data.arr[3] = '\0';
    T_TLV_data.arr[4] = '\0';
    T_TLV_data.arr[5] = '\0';
    uVar3 = 0xffa;
    puVar9 = T_TLV_data.arr + 6;
  }
  for (uVar5 = (ulong)(uVar3 >> 3); uVar5 != 0; uVar5 = uVar5 - 1) {
    puVar9[0] = '\0';
    puVar9[1] = '\0';
    puVar9[2] = '\0';
    puVar9[3] = '\0';
    puVar9[4] = '\0';
    puVar9[5] = '\0';
    puVar9[6] = '\0';
    puVar9[7] = '\0';
    puVar9 = puVar9 + (ulong)bVar11 * -0x10 + 8;
  }
  if (!bVar10) {
    puVar9[0] = '\0';
    puVar9[1] = '\0';
    puVar9[2] = '\0';
    puVar9[3] = '\0';
    puVar9 = puVar9 + 4;
  }
  puVar9[0] = '\0';
  puVar9[1] = '\0';
  uVar3 = 0xffe;
  T_TLV_data.len = 0;
  puVar9 = T_TLV_warning.arr + 2;
  T_TLV_warning.arr[0] = '\0';
  T_TLV_warning.arr[1] = '\0';
  bVar10 = ((ulong)puVar9 & 4) != 0;
  if (bVar10) {
    T_TLV_warning.arr[2] = '\0';
    T_TLV_warning.arr[3] = '\0';
    T_TLV_warning.arr[4] = '\0';
    T_TLV_warning.arr[5] = '\0';
    uVar3 = 0xffa;
    puVar9 = T_TLV_warning.arr + 6;
  }
  for (uVar5 = (ulong)(uVar3 >> 3); uVar5 != 0; uVar5 = uVar5 - 1) {
    puVar9[0] = '\0';
    puVar9[1] = '\0';
    puVar9[2] = '\0';
    puVar9[3] = '\0';
    puVar9[4] = '\0';
    puVar9[5] = '\0';
    puVar9[6] = '\0';
    puVar9[7] = '\0';
    puVar9 = puVar9 + (ulong)bVar11 * -0x10 + 8;
  }
  if (!bVar10) {
    puVar9[0] = '\0';
    puVar9[1] = '\0';
    puVar9[2] = '\0';
    puVar9[3] = '\0';
    puVar9 = puVar9 + 4;
  }
  puVar9[0] = '\0';
  puVar9[1] = '\0';
  T_TLV_warning.len = 0;
  __n = strlen(sReconcType);
  memcpy(T_ReconcType,sReconcType,__n);
  InitTlvAutho(&sTlvInfo);
  iVar1 = IsoToTlv(nIndexCtx,sIsoInfo,&sTlvInfo);
  if (iVar1 == 0) {
    PutTlvAutho("201",&sTlvInfo,G_sNps.F_szRsrcId,6);
    PutTlvAutho("253",&sTlvInfo,AcquirerBank,6);
    PutTlvAutho("200",&sTlvInfo,"000001",6);
    PutTlvAutho("039",&sTlvInfo,"500",3);
    AuthoBuildTlv(sTlvBuffer,&sTlvInfo);
    PrintTlvBuffer(sTlvBuffer);
    puVar7 = (uint *)sTlvBuffer;
    do {
      puVar6 = puVar7;
      uVar2 = *puVar6 + 0xfefefeff & ~*puVar6;
      uVar3 = uVar2 & 0x80808080;
      puVar7 = puVar6 + 1;
    } while (uVar3 == 0);
    bVar10 = (uVar2 & 0x8080) == 0;
    if (bVar10) {
      uVar3 = uVar3 >> 0x10;
    }
    if (bVar10) {
      puVar7 = (uint *)((long)puVar6 + 6);
    }
    pcVar8 = (char *)((long)puVar7 +
                     ((-3 - (ulong)CARRY1((byte)uVar3,(byte)uVar3)) - (long)sTlvBuffer));
    memcpy(T_TLV_data.arr,sTlvBuffer,(size_t)pcVar8);
    T_TLV_data.len = (ushort)pcVar8;
    sqlstm.sqadto[0] = 0;
    sqlstm.sqlest = (uchar *)&sqlca;
    sqlstm.sqladtp = &sqladt;
    sqlstm.sqtdso[0] = 0;
    sqlstm.sqltdsp = &sqltds;
    sqlstm.sqadto[1] = 0;
    sqlstm.sqtdso[1] = 0;
    T_RetVal = 999;
    sqlstm.stmt = 
    "begin :T_RetVal := PCRD_P7_SETTLEMENT_MNG . INSERT_SETTLEMENT ( :T_ReconcType , :T_TLV_data , :T_TLV_warning ) ; END ;"
    ;
    sqlstm.sqlvsn = 0xc;
    sqlstm.arrsiz = 4;
    sqlstm.iters = 1;
    sqlstm.cud = sqlcud0;
    sqlstm.offset = 5;
    sqlstm.sqlety = 0x1100;
    sqlstm.sqhstv[0] = (uchar *)&T_RetVal;
    sqlstm.occurs = 0;
    sqlstm.sqhstl[0] = 4;
    sqlstm.sqphsv = sqlstm.sqhstv;
    sqlstm.sqhsts[0] = 0;
    sqlstm.sqindv[0] = (short *)0x0;
    sqlstm.sqinds[0] = 0;
    sqlstm.sqharm[0] = 0;
    sqlstm.sqhstl[1] = 4;
    sqlstm.sqhsts[1] = 0;
    sqlstm.sqindv[1] = (short *)0x0;
    sqlstm.sqinds[1] = 0;
    sqlstm.sqharm[1] = 0;
    sqlstm.sqhstl[2] = 0x1002;
    sqlstm.sqhsts[2] = 0;
    sqlstm.sqindv[2] = (short *)0x0;
    sqlstm.sqinds[2] = 0;
    sqlstm.sqphsl = sqlstm.sqhstl;
    sqlstm.sqharm[2] = 0;
    sqlstm.sqadto[2] = 0;
    sqlstm.sqphss = sqlstm.sqhsts;
    sqlstm.sqtdso[2] = 0;
    sqlstm.sqhstl[3] = 0x1002;
    sqlstm.sqpind = sqlstm.sqindv;
    sqlstm.sqhsts[3] = 0;
    sqlstm.sqpins = sqlstm.sqinds;
    sqlstm.sqindv[3] = (short *)0x0;
    sqlstm.sqinds[3] = 0;
    sqlstm.sqharm[3] = 0;
    sqlstm.sqparm = sqlstm.sqharm;
    sqlstm.sqadto[3] = 0;
    sqlstm.sqtdso[3] = 0;
    sqlstm.sqparc = sqlstm.sqharc;
    sqlstm.sqpadto = sqlstm.sqadto;
    sqlstm.sqptdso = sqlstm.sqtdso;
    sqlstm.sqhstv[1] = (uchar *)T_ReconcType;
    sqlstm.sqhstv[2] = (uchar *)&T_TLV_data;
    sqlstm.sqhstv[3] = (uchar *)&T_TLV_warning;
    sqlcxt((long)nIndexCtx * 0x10 + 0x713948,&sqlctx,&sqlstm,&sqlfpn);
    if (sqlca.sqlcode < 0) {
      sprintf(sLine,"%.80s",sqlca.sqlerrm.sqlerrmc);
      trace_event(sLine,0);
      sprintf(sLine,"==> T_RetVal=[%d]",(ulong)(uint)T_RetVal);
      trace_event(sLine,0);
      trace_event("End   InsertReconcNPS(MALFUNCTION)",0);
      T_RetVal = -2;
    }
    else {
      sprintf(sLine,"End   InsertReconcNPS(%d)",(ulong)(uint)T_RetVal);
      trace_event(sLine,0);
    }
  }
  else {
    trace_event("IsoToTlv Error ...",1);
    InsertIsoField(0x26,sIsoInfo,"909",3);
    trace_event("End   InsertReconcNPS(NOK)",0);
    T_RetVal = -1;
  }
  return T_RetVal;
}



// WARNING: Removing unreachable block (ram,0x004059ad)
// WARNING: Unknown calling convention

int GetStlmntDate(int nIndexCtx,char *szNetCode,char *szStlmntDate)

{
  ulong uVar1;
  char *pcVar2;
  uint uVar3;
  uchar *puVar4;
  int iVar5;
  bool bVar6;
  byte bVar7;
  char T_cNetCode [3];
  int nStatus;
  char T_cStlmntDate [5];
  char T_cBusinessDate [5];
  char szFuncName [14];
  char szPlSqlFuncName [31];
  sqlca sqlca;
  char local_fmt_1 [128];
  anon_struct_4098_2_43c7b5cf *local_1318;
  int *local_1310;
  undefined8 local_12f8;
  undefined8 local_12f0;
  undefined4 local_12d8;
  undefined4 local_12d4;
  undefined8 local_12c8;
  undefined8 local_12c0;
  undefined4 local_12a8;
  undefined4 local_12a4;
  undefined8 local_1298;
  undefined8 local_1290;
  undefined1 local_1278 [32];
  undefined2 local_1258;
  undefined2 local_1256;
  undefined2 local_1250;
  undefined2 local_124e;
  char sLine [512];
  anon_struct_4098_2_43c7b5cf vcErrMsg;
  
  bVar7 = 0;
  builtin_strncpy(szFuncName,"GetStlmntDate",0xe);
  builtin_strncpy(szPlSqlFuncName,"PCRD_HOST_SPEC.GET_STLMNT_DATE",0x1f);
  sprintf((char *)&vcErrMsg,"Start %%s(%s)","%.2s");
  sprintf(sLine,(char *)&vcErrMsg,szFuncName,szNetCode);
  trace_event(sLine,5);
  puVar4 = vcErrMsg.arr + 2;
  T_cNetCode[2] = '\0';
  T_cStlmntDate[0] = '\0';
  T_cStlmntDate[1] = '\0';
  T_cStlmntDate[2] = '\0';
  T_cStlmntDate[3] = '\0';
  T_cStlmntDate[4] = '\0';
  T_cBusinessDate[0] = '\0';
  T_cBusinessDate[1] = '\0';
  T_cBusinessDate[2] = '\0';
  T_cBusinessDate[3] = '\0';
  uVar3 = 0xffe;
  bVar6 = ((ulong)puVar4 & 4) != 0;
  T_cBusinessDate[4] = '\0';
  vcErrMsg.arr[0] = '\0';
  vcErrMsg.arr[1] = '\0';
  if (bVar6) {
    vcErrMsg.arr[2] = '\0';
    vcErrMsg.arr[3] = '\0';
    vcErrMsg.arr[4] = '\0';
    vcErrMsg.arr[5] = '\0';
    uVar3 = 0xffa;
    puVar4 = vcErrMsg.arr + 6;
  }
  for (uVar1 = (ulong)(uVar3 >> 3); uVar1 != 0; uVar1 = uVar1 - 1) {
    puVar4[0] = '\0';
    puVar4[1] = '\0';
    puVar4[2] = '\0';
    puVar4[3] = '\0';
    puVar4[4] = '\0';
    puVar4[5] = '\0';
    puVar4[6] = '\0';
    puVar4[7] = '\0';
    puVar4 = puVar4 + (ulong)bVar7 * -0x10 + 8;
  }
  if (!bVar6) {
    puVar4[0] = '\0';
    puVar4[1] = '\0';
    puVar4[2] = '\0';
    puVar4[3] = '\0';
    puVar4 = puVar4 + 4;
  }
  puVar4[0] = '\0';
  puVar4[1] = '\0';
  T_cNetCode._0_2_ = *(undefined2 *)szNetCode;
  vcErrMsg.len = 0x1000;
  sprintf(sLine,"%s(): Start Call of PL/SQL %s()",szFuncName,szPlSqlFuncName);
  trace_event(sLine,5);
  sprintf(local_fmt_1,"%%s %%-20.20s : [%s]","%.2s");
  sprintf(sLine,local_fmt_1,&DAT_004a31ee,"T_cNetCode",T_cNetCode);
  trace_event(sLine,4);
  local_fmt_1._40_8_ = &sqlca;
  local_fmt_1._56_8_ = &sqladt;
  local_fmt_1[0x16] = '\0';
  local_fmt_1[0x17] = '\x11';
  local_fmt_1._64_8_ = &sqltds;
  local_1256 = 0;
  local_1258 = 0;
  local_1250 = 0;
  local_fmt_1._48_8_ = s_begin_NULL___EXCEPTION_WHEN_OTHE_004a3450;
  local_124e = 0;
  local_fmt_1[0] = '\f';
  local_fmt_1[1] = '\0';
  local_fmt_1[2] = '\0';
  local_fmt_1[3] = '\0';
  local_fmt_1[4] = '\0';
  local_fmt_1[5] = '\0';
  local_fmt_1[6] = '\0';
  local_fmt_1[7] = '\0';
  local_fmt_1[8] = '\x04';
  local_fmt_1[9] = '\0';
  local_fmt_1[10] = '\0';
  local_fmt_1[0xb] = '\0';
  local_fmt_1._32_8_ = sqlcud0;
  local_1310 = &nStatus;
  local_fmt_1[0xc] = '\x01';
  local_fmt_1[0xd] = '\0';
  local_fmt_1[0xe] = '\0';
  local_fmt_1[0xf] = '\0';
  local_fmt_1[0x10] = '$';
  local_fmt_1[0x11] = '\0';
  local_fmt_1[0x12] = '\0';
  local_fmt_1[0x13] = '\0';
  local_fmt_1[0x18] = '\0';
  local_fmt_1[0x19] = '\0';
  local_fmt_1[0x1a] = '\0';
  local_fmt_1[0x1b] = '\0';
  local_fmt_1._72_8_ = &local_1318;
  local_12f8 = 0x1002;
  local_12d8 = 0;
  local_fmt_1._80_8_ = &local_12f8;
  local_12c8 = 0;
  local_12a8 = 0;
  local_1298 = 0;
  local_fmt_1._88_8_ = &local_12d8;
  local_12f0 = 4;
  local_12d4 = 0;
  local_12c0 = 0;
  local_fmt_1._96_8_ = &local_12c8;
  local_12a4 = 0;
  local_1290 = 0;
  local_fmt_1._104_8_ = &local_12a8;
  local_fmt_1._112_8_ = &local_1298;
  local_fmt_1._120_8_ = local_1278;
  local_1318 = &vcErrMsg;
  sqlcxt((long)nIndexCtx * 0x10 + 0x713948,&sqlctx,local_fmt_1,&sqlfpn);
  if (sqlca.sqlcode < 0) {
    sprintf(sLine,"%s()-%s() failed : %.60s",szFuncName,szPlSqlFuncName,sqlca.sqlerrm.sqlerrmc);
    trace_event(sLine,1);
    sprintf(sLine,"End   %s(%d)",szFuncName,0xfffffffe);
    trace_event(sLine,5);
    iVar5 = -2;
  }
  else if (nStatus == 0) {
    sprintf(local_fmt_1,"%%s %%-20.20s : [%s]","%.4s");
    sprintf(sLine,local_fmt_1,&DAT_004a31fa,"T_cStlmntDate",T_cStlmntDate);
    trace_event(sLine,4);
    sprintf(local_fmt_1,"%%s %%-20.20s : [%s]","%.4s");
    sprintf(sLine,local_fmt_1,&DAT_004a31fa,"T_cBusinessDate",T_cBusinessDate);
    trace_event(sLine,4);
    sprintf(local_fmt_1,"%%s %%-20.20s : [%s]","%d");
    sprintf(sLine,local_fmt_1,&DAT_004a31fa,"nStatus",(ulong)(uint)nStatus);
    trace_event(sLine,4);
    sprintf(sLine,"%s(): End   Call of PL/SQL %s()",szFuncName,szPlSqlFuncName);
    trace_event(sLine,5);
    *(undefined4 *)szStlmntDate = T_cStlmntDate._0_4_;
    sprintf(local_fmt_1,"End   %%s(%%d, %s)","%.4s");
    sprintf(sLine,local_fmt_1,szFuncName,0,szStlmntDate);
    trace_event(sLine,5);
    iVar5 = 0;
  }
  else {
    puVar4 = vcErrMsg.arr;
    iVar5 = 0;
    if (vcErrMsg.len != 0) {
      do {
        pcVar2 = "vcErrMsg";
        if (iVar5 != 0) {
          pcVar2 = " ";
        }
        sprintf(sLine,"%s %-20.20s : [%.55s]",&DAT_004a323a,pcVar2,puVar4);
        iVar5 = iVar5 + 0x37;
        trace_event(sLine,4);
        puVar4 = puVar4 + 0x37;
      } while (iVar5 < (int)(uint)vcErrMsg.len);
    }
    sprintf(local_fmt_1,"%%s %%-20.20s : [%s]","%d");
    sprintf(sLine,local_fmt_1,&DAT_004a31fa,"nStatus",(ulong)(uint)nStatus);
    trace_event(sLine,4);
    sprintf(sLine,"%s(): End   Call of PL/SQL %s()",szFuncName,szPlSqlFuncName);
    trace_event(sLine,5);
    sprintf(sLine,"%s()-%s() failed : %d",szFuncName,"PCRD_SPECIFICS_PROCESSING_2.GET_STLMNT_DATE",
            (ulong)(uint)nStatus);
    trace_event(sLine,1);
    sprintf(sLine,"End   %s(%d)",szFuncName,0xffffffff);
    trace_event(sLine,5);
    iVar5 = -1;
  }
  return iVar5;
}



// WARNING: Removing unreachable block (ram,0x00406077)
// WARNING: Unknown calling convention

int SetStlmntDate(int nIndexCtx,char *szNetCode,char *szStlmntDate)

{
  ulong uVar1;
  char *pcVar2;
  int iVar3;
  uint uVar4;
  uchar *puVar5;
  bool bVar6;
  byte bVar7;
  char T_cNetCode [3];
  int nStatus;
  char T_cStlmntDate [5];
  char szFuncName [14];
  char szPlSqlFuncName [31];
  sqlca sqlca;
  char local_fmt_1 [128];
  anon_struct_4098_2_43c7b5cf *local_1318;
  int *local_1310;
  undefined8 local_12f8;
  undefined8 local_12f0;
  undefined4 local_12d8;
  undefined4 local_12d4;
  undefined8 local_12c8;
  undefined8 local_12c0;
  undefined4 local_12a8;
  undefined4 local_12a4;
  undefined8 local_1298;
  undefined8 local_1290;
  undefined1 local_1278 [32];
  undefined2 local_1258;
  undefined2 local_1256;
  undefined2 local_1250;
  undefined2 local_124e;
  char sLine [512];
  anon_struct_4098_2_43c7b5cf vcErrMsg;
  
  bVar7 = 0;
  builtin_strncpy(szFuncName,"SetStlmntDate",0xe);
  builtin_strncpy(szPlSqlFuncName,"PCRD_HOST_SPEC.SET_STLMNT_DATE",0x1f);
  sprintf((char *)&vcErrMsg,"Start %%s(%s)","%.2s");
  sprintf(sLine,(char *)&vcErrMsg,szFuncName,szNetCode);
  trace_event(sLine,5);
  puVar5 = vcErrMsg.arr + 2;
  T_cNetCode[2] = '\0';
  T_cStlmntDate[4] = '\0';
  vcErrMsg.arr[0] = '\0';
  vcErrMsg.arr[1] = '\0';
  uVar4 = 0xffe;
  bVar6 = ((ulong)puVar5 & 4) != 0;
  if (bVar6) {
    vcErrMsg.arr[2] = '\0';
    vcErrMsg.arr[3] = '\0';
    vcErrMsg.arr[4] = '\0';
    vcErrMsg.arr[5] = '\0';
    uVar4 = 0xffa;
    puVar5 = vcErrMsg.arr + 6;
  }
  for (uVar1 = (ulong)(uVar4 >> 3); uVar1 != 0; uVar1 = uVar1 - 1) {
    puVar5[0] = '\0';
    puVar5[1] = '\0';
    puVar5[2] = '\0';
    puVar5[3] = '\0';
    puVar5[4] = '\0';
    puVar5[5] = '\0';
    puVar5[6] = '\0';
    puVar5[7] = '\0';
    puVar5 = puVar5 + (ulong)bVar7 * -0x10 + 8;
  }
  if (!bVar6) {
    puVar5[0] = '\0';
    puVar5[1] = '\0';
    puVar5[2] = '\0';
    puVar5[3] = '\0';
    puVar5 = puVar5 + 4;
  }
  puVar5[0] = '\0';
  puVar5[1] = '\0';
  T_cNetCode._0_2_ = *(undefined2 *)szNetCode;
  vcErrMsg.len = 0x1000;
  T_cStlmntDate._0_4_ = *(undefined4 *)szStlmntDate;
  sprintf(sLine,"%s(): Start Call of PL/SQL %s()",szFuncName,szPlSqlFuncName);
  trace_event(sLine,5);
  sprintf(local_fmt_1,"%%s %%-20.20s : [%s]","%.2s");
  sprintf(sLine,local_fmt_1,&DAT_004a31ee,"T_cNetCode",T_cNetCode);
  trace_event(sLine,4);
  sprintf(local_fmt_1,"%%s %%-20.20s : [%s]","%.4s");
  sprintf(sLine,local_fmt_1,&DAT_004a31ee,"T_cStlmntDate");
  trace_event(sLine,4);
  local_fmt_1._56_8_ = &sqladt;
  local_fmt_1[0x16] = '\0';
  local_fmt_1[0x17] = '\x11';
  local_1258 = 0;
  local_1250 = 0;
  local_fmt_1._64_8_ = &sqltds;
  local_1256 = 0;
  local_124e = 0;
  local_fmt_1[0] = '\f';
  local_fmt_1[1] = '\0';
  local_fmt_1[2] = '\0';
  local_fmt_1[3] = '\0';
  local_fmt_1[4] = '\0';
  local_fmt_1[5] = '\0';
  local_fmt_1[6] = '\0';
  local_fmt_1[7] = '\0';
  local_fmt_1._48_8_ = s_begin_NULL___EXCEPTION_WHEN_OTHE_004a3550;
  local_fmt_1[8] = '\x04';
  local_fmt_1[9] = '\0';
  local_fmt_1[10] = '\0';
  local_fmt_1[0xb] = '\0';
  local_fmt_1[0xc] = '\x01';
  local_fmt_1[0xd] = '\0';
  local_fmt_1[0xe] = '\0';
  local_fmt_1[0xf] = '\0';
  local_fmt_1[0x10] = ';';
  local_fmt_1[0x11] = '\0';
  local_fmt_1[0x12] = '\0';
  local_fmt_1[0x13] = '\0';
  local_fmt_1._32_8_ = sqlcud0;
  local_1310 = &nStatus;
  local_fmt_1[0x18] = '\0';
  local_fmt_1[0x19] = '\0';
  local_fmt_1[0x1a] = '\0';
  local_fmt_1[0x1b] = '\0';
  local_fmt_1._72_8_ = &local_1318;
  local_12f8 = 0x1002;
  local_12d8 = 0;
  local_12c8 = 0;
  local_fmt_1._80_8_ = &local_12f8;
  local_12a8 = 0;
  local_1298 = 0;
  local_12f0 = 4;
  local_fmt_1._88_8_ = &local_12d8;
  local_12d4 = 0;
  local_12c0 = 0;
  local_12a4 = 0;
  local_fmt_1._96_8_ = &local_12c8;
  local_1290 = 0;
  local_fmt_1._104_8_ = &local_12a8;
  local_fmt_1._112_8_ = &local_1298;
  local_fmt_1._120_8_ = local_1278;
  local_fmt_1._40_8_ = &sqlca;
  local_1318 = &vcErrMsg;
  sqlcxt((long)nIndexCtx * 0x10 + 0x713948,&sqlctx,local_fmt_1,&sqlfpn);
  if (sqlca.sqlcode < 0) {
    sprintf(sLine,"%s()-%s() failed : %.60s",szFuncName,szPlSqlFuncName,sqlca.sqlerrm.sqlerrmc);
    trace_event(sLine,1);
    sprintf(sLine,"End   %s(%d)",szFuncName,0xfffffffe);
    trace_event(sLine,5);
    iVar3 = -2;
  }
  else if (nStatus == 0) {
    sprintf(local_fmt_1,"%%s %%-20.20s : [%s]","%d");
    sprintf(sLine,local_fmt_1,&DAT_004a31fa,"nStatus",(ulong)(uint)nStatus);
    trace_event(sLine,4);
    sprintf(sLine,"%s(): End   Call of PL/SQL %s()",szFuncName,szPlSqlFuncName);
    trace_event(sLine,5);
    sprintf(sLine,"End   %s(%d)",szFuncName,0);
    trace_event(sLine,5);
    iVar3 = 0;
  }
  else {
    puVar5 = vcErrMsg.arr;
    iVar3 = 0;
    if (vcErrMsg.len != 0) {
      do {
        pcVar2 = "vcErrMsg";
        if (iVar3 != 0) {
          pcVar2 = " ";
        }
        iVar3 = iVar3 + 0x37;
        sprintf(sLine,"%s %-20.20s : [%.55s]",&DAT_004a323a,pcVar2,puVar5);
        puVar5 = puVar5 + 0x37;
        trace_event(sLine,4);
      } while (iVar3 < (int)(uint)vcErrMsg.len);
    }
    sprintf(local_fmt_1,"%%s %%-20.20s : [%s]","%d");
    sprintf(sLine,local_fmt_1,&DAT_004a31fa,"nStatus",(ulong)(uint)nStatus);
    trace_event(sLine,4);
    sprintf(sLine,"%s(): End   Call of PL/SQL %s()",szFuncName,szPlSqlFuncName);
    trace_event(sLine,5);
    sprintf(sLine,"%s()-%s() failed : %d",szFuncName,szPlSqlFuncName,(ulong)(uint)nStatus);
    trace_event(sLine,1);
    sprintf(sLine,"End   %s(%d)",szFuncName,0xffffffff);
    trace_event(sLine,5);
    iVar3 = -1;
  }
  return iVar3;
}



// WARNING: Removing unreachable block (ram,0x00406715)
// WARNING: Unknown calling convention

int GetRcvingId(int nIndexCtx,char *szBin,char *szRcvingId)

{
  uchar *puVar1;
  ulong uVar2;
  char *pcVar3;
  uint uVar4;
  uchar *puVar5;
  int iVar6;
  bool bVar7;
  byte bVar8;
  int nStatus;
  char T_cBin [7];
  char T_cRcvingId [12];
  anon_struct_64_2_43c7b5cf vcCFuncName;
  anon_struct_64_2_43c7b5cf vcPlSqlFuncName;
  sqlca sqlca;
  char local_fmt_1 [128];
  anon_struct_4098_2_43c7b5cf *local_1318;
  anon_struct_64_2_43c7b5cf *local_1310;
  anon_struct_64_2_43c7b5cf *local_1308;
  int *local_1300;
  undefined8 local_12f8;
  undefined8 local_12f0;
  undefined8 local_12e8;
  undefined8 local_12e0;
  undefined4 local_12d8;
  undefined4 local_12d4;
  undefined4 local_12d0;
  undefined4 local_12cc;
  undefined8 local_12c8;
  undefined8 local_12c0;
  undefined8 local_12b8;
  undefined8 local_12b0;
  undefined4 local_12a8;
  undefined4 local_12a4;
  undefined4 local_12a0;
  undefined4 local_129c;
  undefined8 local_1298;
  undefined8 local_1290;
  undefined8 local_1288;
  undefined8 local_1280;
  undefined1 local_1278 [32];
  undefined2 local_1258;
  undefined2 local_1256;
  undefined2 local_1254;
  undefined2 local_1252;
  undefined2 local_1250;
  undefined2 local_124e;
  undefined2 local_124c;
  undefined2 local_124a;
  char sLine [512];
  anon_struct_4098_2_43c7b5cf vcErrMsg;
  
  bVar8 = 0;
  builtin_memcpy(vcCFuncName.arr,"GetRcvingId",0xc);
  builtin_memcpy(vcPlSqlFuncName.arr,"PCRD_HOST_SPEC.GET_NPS_RCVING_ID",0x21);
  vcCFuncName.len = 0xb;
  vcPlSqlFuncName.len = 0x20;
  sprintf((char *)&vcErrMsg,"Start %%s(%s)",&DAT_004a4d5a);
  sprintf(sLine,(char *)&vcErrMsg,vcCFuncName.arr);
  trace_event(sLine,5);
  puVar5 = vcErrMsg.arr + 2;
  T_cBin[6] = '\0';
  uVar4 = 0xffe;
  bVar7 = ((ulong)puVar5 & 4) != 0;
  T_cRcvingId[0] = '\0';
  T_cRcvingId[1] = '\0';
  T_cRcvingId[2] = '\0';
  T_cRcvingId[3] = '\0';
  T_cRcvingId[4] = '\0';
  T_cRcvingId[5] = '\0';
  T_cRcvingId[6] = '\0';
  T_cRcvingId[7] = '\0';
  T_cRcvingId[8] = '\0';
  T_cRcvingId[9] = '\0';
  T_cRcvingId[10] = '\0';
  T_cRcvingId[0xb] = '\0';
  vcErrMsg.arr[0] = '\0';
  vcErrMsg.arr[1] = '\0';
  if (bVar7) {
    vcErrMsg.arr[2] = '\0';
    vcErrMsg.arr[3] = '\0';
    vcErrMsg.arr[4] = '\0';
    vcErrMsg.arr[5] = '\0';
    uVar4 = 0xffa;
    puVar5 = vcErrMsg.arr + 6;
  }
  for (uVar2 = (ulong)(uVar4 >> 3); uVar2 != 0; uVar2 = uVar2 - 1) {
    puVar5[0] = '\0';
    puVar5[1] = '\0';
    puVar5[2] = '\0';
    puVar5[3] = '\0';
    puVar5[4] = '\0';
    puVar5[5] = '\0';
    puVar5[6] = '\0';
    puVar5[7] = '\0';
    puVar5 = puVar5 + (ulong)bVar8 * -0x10 + 8;
  }
  if (!bVar7) {
    puVar5[0] = '\0';
    puVar5[1] = '\0';
    puVar5[2] = '\0';
    puVar5[3] = '\0';
    puVar5 = puVar5 + 4;
  }
  puVar5[0] = '\0';
  puVar5[1] = '\0';
  T_cBin._0_4_ = *(undefined4 *)szBin;
  puVar5 = vcCFuncName.arr;
  vcErrMsg.len = 0x1000;
  T_cBin._4_2_ = *(undefined2 *)(szBin + 4);
  puVar1 = vcPlSqlFuncName.arr;
  sprintf(sLine,"%s(): Start Call of PL/SQL %s()",puVar5,puVar1);
  trace_event(sLine,5);
  sprintf(local_fmt_1,"%%s %%-20.20s : [%s]",&DAT_004a4d5a);
  sprintf(sLine,local_fmt_1,&DAT_004a31ee,"T_cBin",T_cBin);
  trace_event(sLine,4);
  local_fmt_1._40_8_ = &sqlca;
  local_fmt_1._56_8_ = &sqladt;
  local_fmt_1[0x16] = '\0';
  local_fmt_1[0x17] = '\x11';
  local_fmt_1._64_8_ = &sqltds;
  local_1256 = 0;
  local_1258 = 0;
  local_1250 = 0;
  local_fmt_1._48_8_ = s_begin_NULL___EXCEPTION_WHEN_OTHE_004a3600;
  local_124e = 0;
  local_fmt_1[0] = '\f';
  local_fmt_1[1] = '\0';
  local_fmt_1[2] = '\0';
  local_fmt_1[3] = '\0';
  local_fmt_1[4] = '\0';
  local_fmt_1[5] = '\0';
  local_fmt_1[6] = '\0';
  local_fmt_1[7] = '\0';
  local_fmt_1[8] = '\x04';
  local_fmt_1[9] = '\0';
  local_fmt_1[10] = '\0';
  local_fmt_1[0xb] = '\0';
  local_fmt_1._32_8_ = sqlcud0;
  local_1300 = &nStatus;
  local_fmt_1[0xc] = '\x01';
  local_fmt_1[0xd] = '\0';
  local_fmt_1[0xe] = '\0';
  local_fmt_1[0xf] = '\0';
  local_fmt_1[0x10] = 'R';
  local_fmt_1[0x11] = '\0';
  local_fmt_1[0x12] = '\0';
  local_fmt_1[0x13] = '\0';
  local_fmt_1[0x18] = '\0';
  local_fmt_1[0x19] = '\0';
  local_fmt_1[0x1a] = '\0';
  local_fmt_1[0x1b] = '\0';
  local_12f8 = 0x1002;
  local_12d8 = 0;
  local_12c8 = 0;
  local_12a8 = 0;
  local_1298 = 0;
  local_12f0 = 0x3f;
  local_12d4 = 0;
  local_12c0 = 0;
  local_12a4 = 0;
  local_1290 = 0;
  local_12e8 = 0x3f;
  local_12d0 = 0;
  local_12b8 = 0;
  local_12a0 = 0;
  local_1288 = 0;
  local_1252 = 0;
  local_1254 = 0;
  local_124a = 0;
  local_fmt_1._72_8_ = &local_1318;
  local_124c = 0;
  local_12e0 = 4;
  local_12cc = 0;
  local_fmt_1._80_8_ = &local_12f8;
  local_12b0 = 0;
  local_fmt_1._88_8_ = &local_12d8;
  local_129c = 0;
  local_1280 = 0;
  local_fmt_1._96_8_ = &local_12c8;
  local_fmt_1._104_8_ = &local_12a8;
  local_fmt_1._112_8_ = &local_1298;
  local_fmt_1._120_8_ = local_1278;
  local_1318 = &vcErrMsg;
  local_1310 = &vcCFuncName;
  local_1308 = &vcPlSqlFuncName;
  sqlcxt((long)nIndexCtx * 0x10 + 0x713948,&sqlctx,local_fmt_1,&sqlfpn);
  if (sqlca.sqlcode < 0) {
    sprintf(sLine,"%s()-%s() failed : %.60s",puVar5,puVar1,sqlca.sqlerrm.sqlerrmc);
    trace_event(sLine,1);
    sprintf(sLine,"End   %s(%d)",puVar5,0xfffffffe);
    trace_event(sLine,5);
    iVar6 = -2;
  }
  else if (nStatus == 0) {
    sprintf(local_fmt_1,"%%s %%-20.20s : [%s]","%.11s");
    sprintf(sLine,local_fmt_1,&DAT_004a31fa,"T_cRcvingId",T_cRcvingId);
    trace_event(sLine,4);
    sprintf(local_fmt_1,"%%s %%-20.20s : [%s]","%d");
    sprintf(sLine,local_fmt_1,&DAT_004a31fa,"nStatus",(ulong)(uint)nStatus);
    trace_event(sLine,4);
    sprintf(sLine,"%s(): End   Call of PL/SQL %s()",puVar5,puVar1);
    trace_event(sLine,5);
    *(undefined8 *)szRcvingId = T_cRcvingId._0_8_;
    *(undefined2 *)(szRcvingId + 8) = T_cRcvingId._8_2_;
    szRcvingId[10] = T_cRcvingId[10];
    sprintf(local_fmt_1,"End   %%s(%%d, %s)","%.4s");
    sprintf(sLine,local_fmt_1,puVar5,0,szRcvingId);
    trace_event(sLine,5);
    iVar6 = 0;
  }
  else {
    puVar5 = vcErrMsg.arr;
    iVar6 = 0;
    if (vcErrMsg.len != 0) {
      do {
        pcVar3 = "vcErrMsg";
        if (iVar6 != 0) {
          pcVar3 = " ";
        }
        sprintf(sLine,"%s %-20.20s : [%.55s]",&DAT_004a323a,pcVar3,puVar5);
        iVar6 = iVar6 + 0x37;
        trace_event(sLine,4);
        puVar5 = puVar5 + 0x37;
      } while (iVar6 < (int)(uint)vcErrMsg.len);
    }
    puVar5 = vcCFuncName.arr;
    sprintf(local_fmt_1,"%%s %%-20.20s : [%s]","%d");
    sprintf(sLine,local_fmt_1,&DAT_004a31fa,"nStatus",(ulong)(uint)nStatus);
    trace_event(sLine,4);
    sprintf(sLine,"%s(): End   Call of PL/SQL %s()",puVar5,vcPlSqlFuncName.arr);
    trace_event(sLine,5);
    sprintf(sLine,"%s()-%s() failed : %d",puVar5,vcPlSqlFuncName.arr,(ulong)(uint)nStatus);
    trace_event(sLine,1);
    sprintf(sLine,"End   %s(%d)",puVar5,0xffffffff);
    trace_event(sLine,5);
    iVar6 = -1;
  }
  return iVar6;
}



// WARNING: Removing unreachable block (ram,0x00406ea9)
// WARNING: Removing unreachable block (ram,0x00406f97)
// WARNING: Unknown calling convention

int GetOrgnlData(int nIndexCtx,char *szTlvBuffer,char *szRespCode,char *szOrgnlData,
                char *szOrgnlRefNbr,char *szOrgnlAuthId)

{
  uchar *puVar1;
  int iVar2;
  ulong uVar3;
  char *pcVar4;
  uint uVar5;
  uchar *puVar6;
  bool bVar7;
  byte bVar8;
  uchar auStackY_44e4 [8012];
  char cRespCode [4];
  int nStatus;
  char cOrgnlAuthId [7];
  char cOrgnlRefNbr [13];
  anon_struct_44_2_43c7b5cf vcOrgnlData;
  anon_struct_64_2_43c7b5cf vcCFuncName;
  anon_struct_64_2_43c7b5cf vcPlSqlFuncName;
  sqlca sqlca;
  char local_fmt [128];
  anon_struct_4098_2_43c7b5cf *local_2328;
  anon_struct_64_2_43c7b5cf *local_2320;
  anon_struct_64_2_43c7b5cf *local_2318;
  int *local_2310;
  undefined8 local_2308;
  undefined8 local_2300;
  undefined8 local_22f8;
  undefined8 local_22f0;
  undefined4 local_22e8;
  undefined4 local_22e4;
  undefined4 local_22e0;
  undefined4 local_22dc;
  undefined8 local_22d8;
  undefined8 local_22d0;
  undefined8 local_22c8;
  undefined8 local_22c0;
  undefined4 local_22b8;
  undefined4 local_22b4;
  undefined4 local_22b0;
  undefined4 local_22ac;
  undefined8 local_22a8;
  undefined8 local_22a0;
  undefined8 local_2298;
  undefined8 local_2290;
  undefined1 local_2288 [32];
  undefined2 local_2268;
  undefined2 local_2266;
  undefined2 local_2264;
  undefined2 local_2262;
  undefined2 local_2260;
  undefined2 local_225e;
  undefined2 local_225c;
  undefined2 local_225a;
  char sLine [512];
  anon_struct_4098_2_43c7b5cf vcTlvBuffer;
  anon_struct_4098_2_43c7b5cf vcErrMsg;
  
  bVar8 = 0;
  builtin_memcpy(vcPlSqlFuncName.arr,"PCRD_HOST_SPEC.GET_ORIGINAL_TRANS_DATA",0x27);
  vcPlSqlFuncName.len = 0x26;
  builtin_memcpy(vcCFuncName.arr,"GetOrgnlData",0xd);
  vcCFuncName.len = 0xc;
  sprintf(sLine,"Start %s()");
  trace_event(sLine,5);
  uVar5 = 0xffe;
  vcTlvBuffer.arr[0] = '\0';
  vcTlvBuffer.arr[1] = '\0';
  puVar6 = vcTlvBuffer.arr + 2;
  bVar7 = ((ulong)puVar6 & 4) != 0;
  if (bVar7) {
    vcTlvBuffer.arr[2] = '\0';
    vcTlvBuffer.arr[3] = '\0';
    vcTlvBuffer.arr[4] = '\0';
    vcTlvBuffer.arr[5] = '\0';
    uVar5 = 0xffa;
    puVar6 = vcTlvBuffer.arr + 6;
  }
  for (uVar3 = (ulong)(uVar5 >> 3); uVar3 != 0; uVar3 = uVar3 - 1) {
    puVar6[0] = '\0';
    puVar6[1] = '\0';
    puVar6[2] = '\0';
    puVar6[3] = '\0';
    puVar6[4] = '\0';
    puVar6[5] = '\0';
    puVar6[6] = '\0';
    puVar6[7] = '\0';
    puVar6 = puVar6 + (ulong)bVar8 * -0x10 + 8;
  }
  if (!bVar7) {
    puVar6[0] = '\0';
    puVar6[1] = '\0';
    puVar6[2] = '\0';
    puVar6[3] = '\0';
    puVar6 = puVar6 + 4;
  }
  puVar6[0] = '\0';
  puVar6[1] = '\0';
  puVar6 = vcOrgnlData.arr + 2;
  cRespCode[0] = '\0';
  cRespCode[1] = '\0';
  cRespCode[2] = '\0';
  cRespCode[3] = '\0';
  vcOrgnlData.arr[0] = '\0';
  vcOrgnlData.arr[1] = '\0';
  uVar5 = 0x27;
  bVar7 = ((ulong)puVar6 & 4) != 0;
  if (bVar7) {
    vcOrgnlData.arr[2] = '\0';
    vcOrgnlData.arr[3] = '\0';
    vcOrgnlData.arr[4] = '\0';
    vcOrgnlData.arr[5] = '\0';
    uVar5 = 0x23;
    puVar6 = vcOrgnlData.arr + 6;
  }
  for (uVar3 = (ulong)(uVar5 >> 3); uVar3 != 0; uVar3 = uVar3 - 1) {
    puVar6[0] = '\0';
    puVar6[1] = '\0';
    puVar6[2] = '\0';
    puVar6[3] = '\0';
    puVar6[4] = '\0';
    puVar6[5] = '\0';
    puVar6[6] = '\0';
    puVar6[7] = '\0';
    puVar6 = puVar6 + (ulong)bVar8 * -0x10 + 8;
  }
  if (!bVar7) {
    puVar6[0] = '\0';
    puVar6[1] = '\0';
    puVar6[2] = '\0';
    puVar6[3] = '\0';
    puVar6 = puVar6 + 4;
  }
  puVar6[0] = '\0';
  puVar6[1] = '\0';
  puVar6[2] = '\0';
  puVar6 = vcErrMsg.arr + 2;
  cOrgnlAuthId[4] = '\0';
  cOrgnlAuthId[5] = '\0';
  local_2328 = &vcErrMsg;
  vcErrMsg.arr[0] = '\0';
  vcErrMsg.arr[1] = '\0';
  bVar7 = ((ulong)puVar6 & 4) != 0;
  cOrgnlRefNbr[0] = '\0';
  cOrgnlRefNbr[1] = '\0';
  cOrgnlRefNbr[2] = '\0';
  cOrgnlRefNbr[3] = '\0';
  cOrgnlRefNbr[4] = '\0';
  cOrgnlRefNbr[5] = '\0';
  cOrgnlRefNbr[6] = '\0';
  cOrgnlRefNbr[7] = '\0';
  cOrgnlRefNbr[8] = '\0';
  cOrgnlRefNbr[9] = '\0';
  cOrgnlRefNbr[10] = '\0';
  cOrgnlRefNbr[0xb] = '\0';
  cOrgnlRefNbr[0xc] = '\0';
  cOrgnlAuthId[0] = '\0';
  cOrgnlAuthId[1] = '\0';
  cOrgnlAuthId[2] = '\0';
  cOrgnlAuthId[3] = '\0';
  uVar5 = 0xffe;
  cOrgnlAuthId[6] = '\0';
  if (bVar7) {
    vcErrMsg.arr[2] = '\0';
    vcErrMsg.arr[3] = '\0';
    vcErrMsg.arr[4] = '\0';
    vcErrMsg.arr[5] = '\0';
    uVar5 = 0xffa;
    puVar6 = vcErrMsg.arr + 6;
  }
  for (uVar3 = (ulong)(uVar5 >> 3); uVar3 != 0; uVar3 = uVar3 - 1) {
    puVar6[0] = '\0';
    puVar6[1] = '\0';
    puVar6[2] = '\0';
    puVar6[3] = '\0';
    puVar6[4] = '\0';
    puVar6[5] = '\0';
    puVar6[6] = '\0';
    puVar6[7] = '\0';
    puVar6 = puVar6 + (ulong)bVar8 * -0x10 + 8;
  }
  if (!bVar7) {
    puVar6[0] = '\0';
    puVar6[1] = '\0';
    puVar6[2] = '\0';
    puVar6[3] = '\0';
    puVar6 = puVar6 + 4;
  }
  puVar6[0] = '\0';
  puVar6[1] = '\0';
  vcOrgnlData.len = 0x29;
  puVar6 = vcCFuncName.arr;
  vcErrMsg.len = 0x1000;
  iVar2 = sprintf((char *)vcTlvBuffer.arr,"%s",szTlvBuffer);
  vcTlvBuffer.len = (ushort)iVar2;
  puVar1 = vcPlSqlFuncName.arr;
  sprintf(sLine,"%s(): Start Call of PL/SQL %s()",puVar6,puVar1);
  trace_event(sLine,5);
  sprintf(local_fmt,"%%s %%-20.20s : [%s]","%.40s");
  sprintf(sLine,local_fmt,&DAT_004a31ee,"vcTlvBuffer.arr",vcTlvBuffer.arr);
  trace_event(sLine,4);
  sprintf(local_fmt,"%%s %%-20.20s : [%s]","%d");
  sprintf(sLine,local_fmt,&DAT_004a31ee,"vcTlvBuffer.len",(ulong)vcTlvBuffer.len);
  trace_event(sLine,4);
  local_fmt._40_8_ = &sqlca;
  local_fmt._56_8_ = &sqladt;
  local_fmt[0x16] = '\0';
  local_fmt[0x17] = '\x11';
  local_fmt._64_8_ = &sqltds;
  local_2260 = 0;
  local_2268 = 0;
  local_2266 = 0;
  local_fmt._48_8_ = s_begin_NULL___EXCEPTION_WHEN_OTHE_004a3600;
  local_225e = 0;
  local_fmt[0] = '\f';
  local_fmt[1] = '\0';
  local_fmt[2] = '\0';
  local_fmt[3] = '\0';
  local_fmt[4] = '\0';
  local_fmt[5] = '\0';
  local_fmt[6] = '\0';
  local_fmt[7] = '\0';
  local_fmt[8] = '\x04';
  local_fmt[9] = '\0';
  local_fmt[10] = '\0';
  local_fmt[0xb] = '\0';
  local_fmt._32_8_ = sqlcud0;
  local_fmt[0xc] = '\x01';
  local_fmt[0xd] = '\0';
  local_fmt[0xe] = '\0';
  local_fmt[0xf] = '\0';
  local_fmt[0x10] = 'q';
  local_fmt[0x11] = '\0';
  local_fmt[0x12] = '\0';
  local_fmt[0x13] = '\0';
  local_fmt[0x18] = '\0';
  local_fmt[0x19] = '\0';
  local_fmt[0x1a] = '\0';
  local_fmt[0x1b] = '\0';
  local_2308 = 0x1002;
  local_22e8 = 0;
  local_22d8 = 0;
  local_22b8 = 0;
  local_22a8 = 0;
  local_2300 = 0x3f;
  local_22e4 = 0;
  local_22d0 = 0;
  local_22b4 = 0;
  local_22a0 = 0;
  local_22f8 = 0x3f;
  local_22e0 = 0;
  local_22c8 = 0;
  local_22b0 = 0;
  local_225c = 0;
  local_2310 = &nStatus;
  local_2298 = 0;
  local_2264 = 0;
  local_22f0 = 4;
  local_2262 = 0;
  local_22dc = 0;
  local_225a = 0;
  local_fmt._72_8_ = &local_2328;
  local_22c0 = 0;
  local_fmt._80_8_ = &local_2308;
  local_22ac = 0;
  local_2290 = 0;
  local_fmt._88_8_ = &local_22e8;
  local_fmt._96_8_ = &local_22d8;
  local_fmt._104_8_ = &local_22b8;
  local_fmt._112_8_ = &local_22a8;
  local_fmt._120_8_ = local_2288;
  local_2320 = &vcCFuncName;
  local_2318 = &vcPlSqlFuncName;
  sqlcxt((long)nIndexCtx * 0x10 + 0x713948,&sqlctx,local_fmt,&sqlfpn);
  if (sqlca.sqlcode < 0) {
    sprintf(sLine,"%s()-%s() failed : %.60s",puVar6,puVar1,sqlca.sqlerrm.sqlerrmc);
    trace_event(sLine,1);
    sprintf(sLine,"End   %s(%d)",puVar6,0xfffffffe);
    trace_event(sLine,5);
    iVar2 = -2;
  }
  else if (nStatus == 0) {
    sprintf(local_fmt,"%%s %%-20.20s : [%s]",&DAT_004a32c9);
    sprintf(sLine,local_fmt,&DAT_004a31fa,"cRespCode",cRespCode);
    trace_event(sLine,4);
    sprintf(local_fmt,"%%s %%-20.20s : [%s]","%.40s");
    sprintf(sLine,local_fmt,&DAT_004a31fa,"vcOrgnlData",vcOrgnlData.arr);
    trace_event(sLine,4);
    sprintf(local_fmt,"%%s %%-20.20s : [%s]","%.12s");
    sprintf(sLine,local_fmt,&DAT_004a31fa,"cOrgnlRefNbr",cOrgnlRefNbr);
    trace_event(sLine,4);
    sprintf(local_fmt,"%%s %%-20.20s : [%s]",&DAT_004a4d5a);
    sprintf(sLine,local_fmt,&DAT_004a31fa,"cOrgnlAuthId",cOrgnlAuthId);
    trace_event(sLine,4);
    sprintf(local_fmt,"%%s %%-20.20s : [%s]","%d");
    sprintf(sLine,local_fmt,&DAT_004a31fa,"nStatus",(ulong)(uint)nStatus);
    trace_event(sLine,4);
    sprintf(sLine,"%s(): End   Call of PL/SQL %s()",puVar6,puVar1);
    trace_event(sLine,5);
    *(undefined2 *)szRespCode = cRespCode._0_2_;
    szRespCode[2] = cRespCode[2];
    memcpy(szOrgnlData,vcOrgnlData.arr,(ulong)vcOrgnlData.len);
    *(undefined8 *)szOrgnlRefNbr = cOrgnlRefNbr._0_8_;
    *(undefined4 *)(szOrgnlRefNbr + 8) = cOrgnlRefNbr._8_4_;
    *(undefined4 *)szOrgnlAuthId = cOrgnlAuthId._0_4_;
    *(undefined2 *)(szOrgnlAuthId + 4) = cOrgnlAuthId._4_2_;
    sprintf(local_fmt,"End   %%s(%%d, %s)","%.3s, %.12s, %.6s, %.40s");
    sprintf(sLine,local_fmt,puVar6,0,szRespCode,szOrgnlRefNbr,szOrgnlAuthId,szOrgnlData);
    trace_event(sLine,5);
    iVar2 = 0;
  }
  else {
    iVar2 = 0;
    puVar6 = vcErrMsg.arr;
    if (vcErrMsg.len != 0) {
      do {
        pcVar4 = "vcErrMsg";
        if (iVar2 != 0) {
          pcVar4 = " ";
        }
        sprintf(sLine,"%s %-20.20s : [%.55s]",&DAT_004a323a,pcVar4,puVar6);
        iVar2 = iVar2 + 0x37;
        trace_event(sLine,4);
        puVar6 = puVar6 + 0x37;
      } while (iVar2 < (int)(uint)vcErrMsg.len);
    }
    puVar6 = vcCFuncName.arr;
    sprintf(local_fmt,"%%s %%-20.20s : [%s]","%d");
    sprintf(sLine,local_fmt,&DAT_004a31fa,"nStatus",(ulong)(uint)nStatus);
    trace_event(sLine,4);
    sprintf(sLine,"%s(): End   Call of PL/SQL %s()",puVar6,vcPlSqlFuncName.arr);
    trace_event(sLine,5);
    sprintf(sLine,"%s()-%s() failed : %d",puVar6,vcPlSqlFuncName.arr,(ulong)(uint)nStatus);
    trace_event(sLine,1);
    sprintf(sLine,"End   %s(%d)",puVar6,0xffffffff);
    trace_event(sLine,5);
    iVar2 = -1;
  }
  return iVar2;
}



// WARNING: Unknown calling convention

int get_card_number(int nIndiceCtx,char *sAccountNumber,char *sPan)

{
  size_t __n;
  int response_code;
  anon_struct_26_2_43c7b5cf T_Card_Number;
  anon_struct_26_2_43c7b5cf T_Account_Number;
  sqlca sqlca;
  char sLine [512];
  
  trace_event("Start Get card number () ",5);
  T_Card_Number.arr[0] = '\0';
  T_Card_Number.arr[1] = '\0';
  T_Card_Number.arr[2] = '\0';
  T_Card_Number.arr[3] = '\0';
  T_Card_Number.arr[4] = '\0';
  T_Card_Number.arr[5] = '\0';
  T_Card_Number.arr[6] = '\0';
  T_Card_Number.arr[7] = '\0';
  T_Card_Number.arr[8] = '\0';
  T_Card_Number.arr[9] = '\0';
  T_Card_Number.arr[10] = '\0';
  T_Card_Number.arr[0xb] = '\0';
  T_Card_Number.arr[0xc] = '\0';
  T_Card_Number.arr[0xd] = '\0';
  T_Card_Number.arr[0xe] = '\0';
  T_Card_Number.arr[0xf] = '\0';
  T_Card_Number.arr[0x10] = '\0';
  T_Card_Number.arr[0x11] = '\0';
  T_Card_Number.arr[0x12] = '\0';
  T_Card_Number.arr[0x13] = '\0';
  T_Card_Number.arr[0x14] = '\0';
  T_Card_Number.arr[0x15] = '\0';
  T_Card_Number.arr[0x16] = '\0';
  T_Account_Number.arr[0x14] = '\0';
  T_Account_Number.arr[0x15] = '\0';
  T_Card_Number.len = 0;
  T_Account_Number.len = 0;
  T_Account_Number.arr[0] = '\0';
  T_Account_Number.arr[1] = '\0';
  T_Account_Number.arr[2] = '\0';
  T_Account_Number.arr[3] = '\0';
  T_Account_Number.arr[4] = '\0';
  T_Account_Number.arr[5] = '\0';
  T_Account_Number.arr[6] = '\0';
  T_Account_Number.arr[7] = '\0';
  T_Account_Number.arr[8] = '\0';
  T_Account_Number.arr[9] = '\0';
  T_Account_Number.arr[10] = '\0';
  T_Account_Number.arr[0xb] = '\0';
  T_Account_Number.arr[0xc] = '\0';
  T_Account_Number.arr[0xd] = '\0';
  T_Account_Number.arr[0xe] = '\0';
  T_Account_Number.arr[0xf] = '\0';
  T_Account_Number.arr[0x10] = '\0';
  T_Account_Number.arr[0x11] = '\0';
  T_Account_Number.arr[0x12] = '\0';
  T_Account_Number.arr[0x13] = '\0';
  T_Account_Number.arr[0x16] = '\0';
  __n = strlen(sAccountNumber);
  memcpy(T_Account_Number.arr,sAccountNumber,__n);
  sLine._56_8_ = &sqladt;
  T_Account_Number.len = (ushort)__n;
  sLine[0x16] = '\0';
  sLine[0x17] = '\x11';
  sLine[0x170] = '\0';
  sLine[0x171] = '\0';
  sLine._64_8_ = &sqltds;
  sLine[0x178] = '\0';
  sLine[0x179] = '\0';
  sLine[0x172] = '\0';
  sLine[0x173] = '\0';
  sLine._48_8_ = s_begin__response_code____EBL_FUND_004a36b0;
  sLine[0x17a] = '\0';
  sLine[0x17b] = '\0';
  response_code = 0x38d;
  sLine[0] = '\f';
  sLine[1] = '\0';
  sLine[2] = '\0';
  sLine[3] = '\0';
  sLine[4] = '\0';
  sLine[5] = '\0';
  sLine[6] = '\0';
  sLine[7] = '\0';
  sLine._32_8_ = sqlcud0;
  sLine._176_8_ = &response_code;
  sLine[8] = '\x04';
  sLine[9] = '\0';
  sLine[10] = '\0';
  sLine[0xb] = '\0';
  sLine[0xc] = '\x01';
  sLine[0xd] = '\0';
  sLine[0xe] = '\0';
  sLine[0xf] = '\0';
  sLine[0x10] = -0x70;
  sLine[0x11] = '\0';
  sLine[0x12] = '\0';
  sLine[0x13] = '\0';
  sLine[0x18] = '\0';
  sLine[0x19] = '\0';
  sLine[0x1a] = '\0';
  sLine[0x1b] = '\0';
  sLine[0xd0] = '\x04';
  sLine[0xd1] = '\0';
  sLine[0xd2] = '\0';
  sLine[0xd3] = '\0';
  sLine[0xd4] = '\0';
  sLine[0xd5] = '\0';
  sLine[0xd6] = '\0';
  sLine[0xd7] = '\0';
  sLine[0xf0] = '\0';
  sLine[0xf1] = '\0';
  sLine[0xf2] = '\0';
  sLine[0xf3] = '\0';
  sLine[0x100] = '\0';
  sLine[0x101] = '\0';
  sLine[0x102] = '\0';
  sLine[0x103] = '\0';
  sLine[0x104] = '\0';
  sLine[0x105] = '\0';
  sLine[0x106] = '\0';
  sLine[0x107] = '\0';
  sLine[0x120] = '\0';
  sLine[0x121] = '\0';
  sLine[0x122] = '\0';
  sLine[0x123] = '\0';
  sLine[0x130] = '\0';
  sLine[0x131] = '\0';
  sLine[0x132] = '\0';
  sLine[0x133] = '\0';
  sLine[0x134] = '\0';
  sLine[0x135] = '\0';
  sLine[0x136] = '\0';
  sLine[0x137] = '\0';
  sLine[0xd8] = '\x19';
  sLine[0xd9] = '\0';
  sLine[0xda] = '\0';
  sLine[0xdb] = '\0';
  sLine[0xdc] = '\0';
  sLine[0xdd] = '\0';
  sLine[0xde] = '\0';
  sLine[0xdf] = '\0';
  sLine[0xf4] = '\0';
  sLine[0xf5] = '\0';
  sLine[0xf6] = '\0';
  sLine[0xf7] = '\0';
  sLine[0x108] = '\0';
  sLine[0x109] = '\0';
  sLine[0x10a] = '\0';
  sLine[0x10b] = '\0';
  sLine[0x10c] = '\0';
  sLine[0x10d] = '\0';
  sLine[0x10e] = '\0';
  sLine[0x10f] = '\0';
  sLine[0x124] = '\0';
  sLine[0x125] = '\0';
  sLine[0x126] = '\0';
  sLine[0x127] = '\0';
  sLine[0x138] = '\0';
  sLine[0x139] = '\0';
  sLine[0x13a] = '\0';
  sLine[0x13b] = '\0';
  sLine[0x13c] = '\0';
  sLine[0x13d] = '\0';
  sLine[0x13e] = '\0';
  sLine[0x13f] = '\0';
  sLine[0xe0] = '\x19';
  sLine[0xe1] = '\0';
  sLine[0xe2] = '\0';
  sLine[0xe3] = '\0';
  sLine[0xe4] = '\0';
  sLine[0xe5] = '\0';
  sLine[0xe6] = '\0';
  sLine[0xe7] = '\0';
  sLine[0xf8] = '\0';
  sLine[0xf9] = '\0';
  sLine[0xfa] = '\0';
  sLine[0xfb] = '\0';
  sLine[0x110] = '\0';
  sLine[0x111] = '\0';
  sLine[0x112] = '\0';
  sLine[0x113] = '\0';
  sLine[0x114] = '\0';
  sLine[0x115] = '\0';
  sLine[0x116] = '\0';
  sLine[0x117] = '\0';
  sLine[0x128] = '\0';
  sLine[0x129] = '\0';
  sLine[0x12a] = '\0';
  sLine[299] = '\0';
  sLine[0x174] = '\0';
  sLine[0x175] = '\0';
  sLine[0x140] = '\0';
  sLine[0x141] = '\0';
  sLine[0x142] = '\0';
  sLine[0x143] = '\0';
  sLine[0x144] = '\0';
  sLine[0x145] = '\0';
  sLine[0x146] = '\0';
  sLine[0x147] = '\0';
  sLine[0x17c] = '\0';
  sLine[0x17d] = '\0';
  sLine._72_8_ = sLine + 0xb0;
  sLine._80_8_ = sLine + 0xd0;
  sLine._88_8_ = sLine + 0xf0;
  sLine._96_8_ = sLine + 0x100;
  sLine._104_8_ = sLine + 0x120;
  sLine._112_8_ = sLine + 0x130;
  sLine._120_8_ = sLine + 0x150;
  sLine._128_8_ = sLine + 0x170;
  sLine._136_8_ = sLine + 0x178;
  sLine._40_8_ = &sqlca;
  sLine._184_8_ = &T_Account_Number;
  sLine._192_8_ = &T_Card_Number;
  sqlcxt((long)nIndiceCtx * 0x10 + 0x713948,&sqlctx,sLine,&sqlfpn);
  if (sqlca.sqlcode < 0) {
    sprintf(sLine,"%.50s",sqlca.sqlerrm.sqlerrmc);
    trace_event(sLine,1);
    trace_event("End Get card number (SYSTEM_MALFUNCTION)",5);
    response_code = 0x38d;
  }
  else {
    if (response_code == 0) {
      sprintf(sLine,"Get card number (%d)",0);
      trace_event(sLine,5);
      memcpy(sPan,T_Card_Number.arr,(ulong)T_Card_Number.len);
      sprintf(sLine,"Get card number (%d)",(ulong)(uint)response_code);
      trace_event(sLine,5);
    }
    sprintf(sLine,"End Get card number (%d)",(ulong)(uint)response_code);
    trace_event(sLine,5);
  }
  return response_code;
}



// WARNING: Unknown calling convention

int get_Account_type(int nIndiceCtx,char *sAccountNumber,char *sAcctType)

{
  size_t __n;
  int response_code;
  anon_struct_6_2_43c7b5cf T_Acct_Type;
  anon_struct_26_2_43c7b5cf T_Account_Number;
  sqlca sqlca;
  char sLine [512];
  
  trace_event("Start Get account type () ",5);
  T_Acct_Type.arr[0] = '\0';
  T_Acct_Type.arr[1] = '\0';
  T_Acct_Type.arr[2] = '\0';
  T_Account_Number.arr[0x14] = '\0';
  T_Account_Number.arr[0x15] = '\0';
  T_Acct_Type.len = 0;
  T_Account_Number.len = 0;
  T_Account_Number.arr[0] = '\0';
  T_Account_Number.arr[1] = '\0';
  T_Account_Number.arr[2] = '\0';
  T_Account_Number.arr[3] = '\0';
  T_Account_Number.arr[4] = '\0';
  T_Account_Number.arr[5] = '\0';
  T_Account_Number.arr[6] = '\0';
  T_Account_Number.arr[7] = '\0';
  T_Account_Number.arr[8] = '\0';
  T_Account_Number.arr[9] = '\0';
  T_Account_Number.arr[10] = '\0';
  T_Account_Number.arr[0xb] = '\0';
  T_Account_Number.arr[0xc] = '\0';
  T_Account_Number.arr[0xd] = '\0';
  T_Account_Number.arr[0xe] = '\0';
  T_Account_Number.arr[0xf] = '\0';
  T_Account_Number.arr[0x10] = '\0';
  T_Account_Number.arr[0x11] = '\0';
  T_Account_Number.arr[0x12] = '\0';
  T_Account_Number.arr[0x13] = '\0';
  T_Account_Number.arr[0x16] = '\0';
  __n = strlen(sAccountNumber);
  memcpy(T_Account_Number.arr,sAccountNumber,__n);
  sLine._56_8_ = &sqladt;
  T_Account_Number.len = (ushort)__n;
  sLine[0x16] = '\0';
  sLine[0x17] = '\x11';
  sLine[0x170] = '\0';
  sLine[0x171] = '\0';
  sLine._64_8_ = &sqltds;
  sLine[0x178] = '\0';
  sLine[0x179] = '\0';
  sLine[0x172] = '\0';
  sLine[0x173] = '\0';
  sLine._48_8_ = s_begin__response_code____EBL_FUND_004a3758;
  sLine[0x17a] = '\0';
  sLine[0x17b] = '\0';
  response_code = 0x38d;
  sLine[0] = '\f';
  sLine[1] = '\0';
  sLine[2] = '\0';
  sLine[3] = '\0';
  sLine[4] = '\0';
  sLine[5] = '\0';
  sLine[6] = '\0';
  sLine[7] = '\0';
  sLine._32_8_ = sqlcud0;
  sLine._176_8_ = &response_code;
  sLine[8] = '\x04';
  sLine[9] = '\0';
  sLine[10] = '\0';
  sLine[0xb] = '\0';
  sLine[0xc] = '\x01';
  sLine[0xd] = '\0';
  sLine[0xe] = '\0';
  sLine[0xf] = '\0';
  sLine[0x10] = -0x55;
  sLine[0x11] = '\0';
  sLine[0x12] = '\0';
  sLine[0x13] = '\0';
  sLine[0x18] = '\0';
  sLine[0x19] = '\0';
  sLine[0x1a] = '\0';
  sLine[0x1b] = '\0';
  sLine[0xd0] = '\x04';
  sLine[0xd1] = '\0';
  sLine[0xd2] = '\0';
  sLine[0xd3] = '\0';
  sLine[0xd4] = '\0';
  sLine[0xd5] = '\0';
  sLine[0xd6] = '\0';
  sLine[0xd7] = '\0';
  sLine[0xf0] = '\0';
  sLine[0xf1] = '\0';
  sLine[0xf2] = '\0';
  sLine[0xf3] = '\0';
  sLine[0x100] = '\0';
  sLine[0x101] = '\0';
  sLine[0x102] = '\0';
  sLine[0x103] = '\0';
  sLine[0x104] = '\0';
  sLine[0x105] = '\0';
  sLine[0x106] = '\0';
  sLine[0x107] = '\0';
  sLine[0x120] = '\0';
  sLine[0x121] = '\0';
  sLine[0x122] = '\0';
  sLine[0x123] = '\0';
  sLine[0x130] = '\0';
  sLine[0x131] = '\0';
  sLine[0x132] = '\0';
  sLine[0x133] = '\0';
  sLine[0x134] = '\0';
  sLine[0x135] = '\0';
  sLine[0x136] = '\0';
  sLine[0x137] = '\0';
  sLine[0xd8] = '\x19';
  sLine[0xd9] = '\0';
  sLine[0xda] = '\0';
  sLine[0xdb] = '\0';
  sLine[0xdc] = '\0';
  sLine[0xdd] = '\0';
  sLine[0xde] = '\0';
  sLine[0xdf] = '\0';
  sLine[0xf4] = '\0';
  sLine[0xf5] = '\0';
  sLine[0xf6] = '\0';
  sLine[0xf7] = '\0';
  sLine[0x108] = '\0';
  sLine[0x109] = '\0';
  sLine[0x10a] = '\0';
  sLine[0x10b] = '\0';
  sLine[0x10c] = '\0';
  sLine[0x10d] = '\0';
  sLine[0x10e] = '\0';
  sLine[0x10f] = '\0';
  sLine[0x124] = '\0';
  sLine[0x125] = '\0';
  sLine[0x126] = '\0';
  sLine[0x127] = '\0';
  sLine[0x138] = '\0';
  sLine[0x139] = '\0';
  sLine[0x13a] = '\0';
  sLine[0x13b] = '\0';
  sLine[0x13c] = '\0';
  sLine[0x13d] = '\0';
  sLine[0x13e] = '\0';
  sLine[0x13f] = '\0';
  sLine[0xe0] = '\x05';
  sLine[0xe1] = '\0';
  sLine[0xe2] = '\0';
  sLine[0xe3] = '\0';
  sLine[0xe4] = '\0';
  sLine[0xe5] = '\0';
  sLine[0xe6] = '\0';
  sLine[0xe7] = '\0';
  sLine[0xf8] = '\0';
  sLine[0xf9] = '\0';
  sLine[0xfa] = '\0';
  sLine[0xfb] = '\0';
  sLine[0x110] = '\0';
  sLine[0x111] = '\0';
  sLine[0x112] = '\0';
  sLine[0x113] = '\0';
  sLine[0x114] = '\0';
  sLine[0x115] = '\0';
  sLine[0x116] = '\0';
  sLine[0x117] = '\0';
  sLine[0x128] = '\0';
  sLine[0x129] = '\0';
  sLine[0x12a] = '\0';
  sLine[299] = '\0';
  sLine[0x174] = '\0';
  sLine[0x175] = '\0';
  sLine[0x140] = '\0';
  sLine[0x141] = '\0';
  sLine[0x142] = '\0';
  sLine[0x143] = '\0';
  sLine[0x144] = '\0';
  sLine[0x145] = '\0';
  sLine[0x146] = '\0';
  sLine[0x147] = '\0';
  sLine[0x17c] = '\0';
  sLine[0x17d] = '\0';
  sLine._72_8_ = sLine + 0xb0;
  sLine._80_8_ = sLine + 0xd0;
  sLine._88_8_ = sLine + 0xf0;
  sLine._96_8_ = sLine + 0x100;
  sLine._104_8_ = sLine + 0x120;
  sLine._112_8_ = sLine + 0x130;
  sLine._120_8_ = sLine + 0x150;
  sLine._128_8_ = sLine + 0x170;
  sLine._136_8_ = sLine + 0x178;
  sLine._40_8_ = &sqlca;
  sLine._184_8_ = &T_Account_Number;
  sLine._192_8_ = &T_Acct_Type;
  sqlcxt((long)nIndiceCtx * 0x10 + 0x713948,&sqlctx,sLine,&sqlfpn);
  if (sqlca.sqlcode < 0) {
    sprintf(sLine,"%.50s",sqlca.sqlerrm.sqlerrmc);
    trace_event(sLine,1);
    trace_event("End Get account type (SYSTEM_MALFUNCTION)",5);
    response_code = 0x38d;
  }
  else {
    if (response_code == 0) {
      sprintf(sLine,"Get account type (%d)(%s)",0,T_Acct_Type.arr);
      trace_event(sLine,5);
      memcpy(sAcctType,T_Acct_Type.arr,(ulong)T_Acct_Type.len);
      sprintf(sLine,"Get account type (%d)(%s)",(ulong)(uint)response_code,sAcctType);
      trace_event(sLine,5);
    }
    sprintf(sLine,"End Get account type (%d)(%s)",(ulong)(uint)response_code,T_Acct_Type.arr);
    trace_event(sLine,5);
  }
  return response_code;
}



// WARNING: Unknown calling convention

void * thread_ADMIN(void *arg)

{
  __pid_t _Var1;
  int iVar2;
  pthread_t __th;
  TSBalExchange sBalMsg;
  
  trace_event(">>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>",4);
  trace_event("> Start thread_ADMIN >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>",4);
  trace_event(">>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>",4);
  __th = pthread_self();
  pthread_detach(__th);
  AllocateOracleCtx(4);
  ConnectOracle(4);
  while( true ) {
    _Var1 = getpid();
    iVar2 = ReadBalMsg(nBalAdm,(long)_Var1,0,&sBalMsg);
    if (iVar2 < 0) break;
    AdmProcMsg(4,&sBalMsg);
  }
  trace_event("End   thread_ADMIN(FATAL)",5);
                    // WARNING: Subroutine does not return
  pthread_exit((void *)0x0);
}



// WARNING: Unknown calling convention

void AdmProcMsg(int nIndexCtx,TSBalExchange *sBalMsg)

{
  long lVar1;
  int FieldLen;
  char FieldData [256];
  char sLine [512];
  TSIsoInfo IsoInfo;
  
  InitIsoInfo(&IsoInfo);
  AnalyseIso(sBalMsg->sBody,&IsoInfo);
  builtin_strncpy(sLine,"Service Message Received ",0x1a);
  trace_event(sLine,5);
  if (IsoInfo.nMsgType == 0x646) {
    GetIsoField(0x17,&IsoInfo,FieldData,&FieldLen);
    lVar1 = strtol(FieldData,(char **)0x0,10);
    switch((int)lVar1) {
    case 600:
      FCT_STOP_INTERFACE(nIndexCtx,&IsoInfo);
      break;
    case 0x259:
      FCT_REFRESH_PARAMS(nIndexCtx,&IsoInfo);
      break;
    case 0x25a:
      FCT_REPORT_STATUS(nIndexCtx,&IsoInfo);
      break;
    case 0x25b:
    case 0x25c:
    case 0x261:
      FCT_NW_MNG_REQ_TO_NW(nIndexCtx,&IsoInfo,"SCREEN");
      break;
    default:
      sprintf(sLine,"Function Code %.3s not supported.",FieldData);
      trace_event(sLine,5);
      break;
    case 0x262:
      FCT_LINE_DOWN(nIndexCtx,&IsoInfo);
      break;
    case 0x263:
      FCT_LINE_UP(nIndexCtx,&IsoInfo);
      break;
    case 0x26c:
      FCT_STATISTICS(nIndexCtx,&IsoInfo);
    }
  }
  return;
}



// WARNING: Unknown calling convention

void FCT_STOP_INTERFACE(int nIndexCtx,TSIsoInfo *IsoInfo)

{
  trace_event("Start  FCT_STOP_INTERFACE()",5);
  shutdown_resource(nIndexCtx,G_sNps.F_szRsrcId);
  trace_event("End  FCT_STOP_INTERFACE()",5);
  return;
}



// WARNING: Unknown calling convention

void FCT_REFRESH_PARAMS(int nIndexCtx,TSIsoInfo *IsoInfo)

{
  trace_event("Start  FCT_REFRESH_PARAMS()",5);
  trace_event("End  FCT_REFRESH_PARAMS()",5);
  return;
}



// WARNING: Unknown calling convention

void FCT_REPORT_STATUS(int nIndexCtx,TSIsoInfo *IsoInfo)

{
  uint uVar1;
  uint uVar2;
  int nLength;
  uint *puVar3;
  uint *puVar4;
  bool bVar5;
  char FieldData [256];
  TSTlvPrivate TlvInfo;
  
  trace_event("Start  FCT_REPORT_STATUS()",5);
  IsoInfo->nMsgType = 0x650;
  InitTlvPrivate(&TlvInfo);
  puVar4 = (uint *)ResourceInternalId;
  do {
    puVar3 = puVar4;
    uVar1 = *puVar3 + 0xfefefeff & ~*puVar3;
    uVar2 = uVar1 & 0x80808080;
    puVar4 = puVar3 + 1;
  } while (uVar2 == 0);
  bVar5 = (uVar1 & 0x8080) == 0;
  if (bVar5) {
    uVar2 = uVar2 >> 0x10;
  }
  if (bVar5) {
    puVar4 = (uint *)((long)puVar3 + 6);
  }
  AddTlvPrivate("P12",&TlvInfo,ResourceInternalId,
                ((int)puVar4 - (uint)CARRY1((byte)uVar2,(byte)uVar2)) + -0x70e163);
  nLength = PrivateBuildTlv(FieldData,&TlvInfo);
  PutIsoField(0x2f,IsoInfo,FieldData,nLength);
  dump_p7_struct(IsoInfo);
  ReplyIsoMsgToBal(nBalAdm,IsoInfo,(char *)0x0,"000");
  trace_event("End  REPORT_STATUS()",5);
  return;
}



// WARNING: Unknown calling convention

void FCT_STATISTICS(int nIndexCtx,TSIsoInfo *IsoInfo)

{
  trace_event("Start  FCT_STATISTICS()",5);
  trace_event("End  FCT_STATISTICS()",5);
  return;
}



// WARNING: Unknown calling convention

void FCT_LINE_DOWN(int nIndexCtx,TSIsoInfo *IsoInfo)

{
  int iVar1;
  
  trace_event("Start  FCT_LINE_DOWN()",5);
  iVar1 = ResourceActivity(nIndexCtx,G_sNps.F_szRsrcId,2);
  if (iVar1 != 0) {
    fwrite("Resources_Ativity table update failed.\n",1,0x27,stderr);
    return;
  }
  iVar1 = UpdateResource(nIndexCtx,G_sNps.F_szRsrcId,"CCC","OFF");
  if (iVar1 == 0) {
    trace_event("End  FCT_LINE_DOWN()",5);
    return;
  }
  fwrite("UpdateResource() failed.\n",1,0x19,stderr);
  return;
}



// WARNING: Unknown calling convention

void FCT_LINE_UP(int nIndexCtx,TSIsoInfo *IsoInfo)

{
  int iVar1;
  
  trace_event("Start  FCT_LINE_UP()",5);
  iVar1 = ResourceActivity(nIndexCtx,G_sNps.F_szRsrcId,1);
  if (iVar1 != 0) {
    fwrite("Resources_Ativity table update failed.\n",1,0x27,stderr);
    return;
  }
  iVar1 = UpdateResource(nIndexCtx,G_sNps.F_szRsrcId,"YYY","ONL");
  if (iVar1 == 0) {
    trace_event("End  FCT_LINE_UP()",5);
    return;
  }
  fwrite("UpdateResource() failed.\n",1,0x19,stderr);
  return;
}



// WARNING: Unknown calling convention

int SendShutDownSignalsToLineThreads(void)

{
  trace_event("Start SendShutDownSignalsToLineThreads()",5);
  trace_event("End   SendShutDownSignalsToLineThreads(OK)",5);
  return 0;
}



// WARNING: Unknown calling convention

int shutdown_resource(int nIndexCtx,char *ResourceId)

{
  int iVar1;
  uint uVar2;
  
  trace_event("Start shutdown_resource()",5);
  trace_event("Shutdown Resource ...In Progress",0);
  iVar1 = UpdateResource(nIndexCtx,ResourceId,"NNN","OFF");
  if (iVar1 != 0) {
    trace_event("Cannot update resource status at ShutDown ",5);
  }
  iVar1 = ResourceActivity(nIndexCtx,ResourceId,2);
  if (iVar1 != 0) {
    trace_event("Cannot update resource activity at ShutDown ",5);
  }
  uVar2 = getpid();
  EmptyQueue(nBalMsg,(ulong)uVar2);
  uVar2 = getpid();
  EmptyQueue(nBalAdm,(ulong)uVar2);
  sign_off(nIndexCtx);
  trace_event("Stopping Line Threads           ",0);
  SendShutDownSignalsToLineThreads();
  trace_event("Stopping Bal Threads           ",0);
  SendShutDownSignalsToBalThreads();
  trace_event("Stopping Time Threads           ",0);
  SendShutDownSignalsToTimeThreads();
  trace_event("Stopping Communication          ",0);
  StopCltCom(nFdConnect);
  trace_event("Deconnecting from Oracle        ",0);
  DeconnectOracle(nIndexCtx);
  FreeOracleCtx(nIndexCtx);
  trace_event("About to Exit The Program       ",0);
  sleep(3);
                    // WARNING: Subroutine does not return
  exit(0);
}



// WARNING: Unknown calling convention

void * thread_proc_BAL(void *arg)

{
  int indice;
  pthread_t __th;
  int nIndiceCtx;
  TSBalExchange sBalMsg;
  
  trace_event(">>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>",4);
  trace_event("> Start thread_proc_BAL >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>",4);
  trace_event(">>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>",4);
  __th = pthread_self();
  pthread_detach(__th);
                    // WARNING: Load size is inaccurate
  indice = *arg;
  free(arg);
  ConnectOracle(indice);
  do {
    CBalWaitMsg();
    CBalGetMsg(&sBalMsg);
    CBalFreeEntry();
    BalProcMsg(indice,&sBalMsg);
  } while( true );
}



// WARNING: Unknown calling convention

void * thread_wait_BAL(void *arg)

{
  int iVar1;
  uint uVar2;
  __pid_t _Var3;
  pthread_t __th;
  int *__arg;
  int *piVar4;
  int iVar5;
  TSThrInfo *__newthread;
  pthread_attr_t pattr;
  char sLine [512];
  TSBalExchange sBalMsg;
  
  trace_event(">>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>",4);
  trace_event("> Start New thread_wait_BAL >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>",4);
  trace_event(">>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>",4);
  __th = pthread_self();
  pthread_detach(__th);
  if (0 < max_thread) {
    iVar5 = 0;
    __newthread = tab_ThrInfo + 0x14;
    do {
      pthread_attr_init((pthread_attr_t *)&pattr);
      uVar2 = pthread_attr_setstacksize((pthread_attr_t *)&pattr,0x100000);
      if (uVar2 != 0) {
        sprintf(sLine,"ERROR: rc from pthread_attr_setstacksize() is %d\n",(ulong)uVar2);
        trace_event(sLine,5);
      }
      __arg = (int *)malloc(4);
      AllocateOracleCtx(iVar5 + 0x14);
      *__arg = iVar5 + 0x14;
      iVar1 = pthread_create(&__newthread->tid,(pthread_attr_t *)&pattr,thread_proc_BAL,__arg);
      if (iVar1 < 0) {
        piVar4 = __errno_location();
        trace_event("pthread_create Error %d",*piVar4);
        free(__arg);
        goto LAB_004088ec;
      }
      iVar5 = iVar5 + 1;
      __newthread = __newthread + 1;
    } while (iVar5 < max_thread);
  }
  while( true ) {
    _Var3 = getpid();
    iVar5 = ReadBalMsg(nBalMsg,(long)_Var3,0,&sBalMsg);
    if (iVar5 < 0) break;
    PBalWaitEntry();
    PBalPutMsg(&sBalMsg);
    PBalConsoInfo();
  }
  trace_event("Error Reading Message.",1);
LAB_004088ec:
  trace_event("End   thread_wait_BAL(ERROR)",1);
                    // WARNING: Subroutine does not return
  pthread_exit((void *)0x0);
}



// WARNING: Unknown calling convention

void BalProcMsg(int nIndexCtx,TSBalExchange *sBalMsg)

{
  int iVar1;
  int FieldLen;
  char sSource [9];
  char FieldData [256];
  char sLine [512];
  TSIsoInfo IsoInfo;
  
  trace_event("Start BalProcMsg()",5);
  InitIsoInfo(&IsoInfo);
  AnalyseIso(sBalMsg->sBody,&IsoInfo);
  dump_p7_struct(&IsoInfo);
  if (IsoInfo.nMsgType == 0x4b0) {
LAB_00408ab4:
    GetIsoField(0x34,&IsoInfo,FieldData,&FieldLen);
    sSource[0] = '\0';
    sSource[1] = '\0';
    sSource[2] = '\0';
    sSource[3] = '\0';
    sSource[4] = '\0';
    sSource[5] = '\0';
    sSource[6] = '\0';
    sSource[7] = '\0';
    sSource[8] = '\0';
    GetSecurityData(5,FieldData,sSource,&FieldLen);
    iVar1 = memcmp(sSource,&DAT_004c9c2d,2);
    if (iVar1 == 0) {
      IsoInfo.nMsgType = 0x44c;
    }
    FCT_AUT_REQ_TO_NW(nIndexCtx,&IsoInfo);
    goto LAB_004089db;
  }
  if (IsoInfo.nMsgType < 0x4b1) {
    if (IsoInfo.nMsgType != 0x456) {
      if (IsoInfo.nMsgType != 0x46a) {
        if (IsoInfo.nMsgType != 0x44c) goto LAB_004089b3;
        goto LAB_00408ab4;
      }
      goto LAB_00408a00;
    }
  }
  else {
    if (IsoInfo.nMsgType == 0x4ce) {
LAB_00408a00:
      FCT_ADV_REP_TO_NW(nIndexCtx,&IsoInfo);
      goto LAB_004089db;
    }
    if (IsoInfo.nMsgType == 0x6a4) {
      FCT_SHUTDOWN_BAL(nIndexCtx);
      goto LAB_004089db;
    }
    if (IsoInfo.nMsgType != 0x4ba) {
LAB_004089b3:
      sprintf(sLine," END     BalProcMsg(NOK --> Msg %d Not Handled)");
      trace_event(sLine,5);
      goto LAB_004089db;
    }
  }
  GetIsoField(0x34,&IsoInfo,FieldData,&FieldLen);
  sSource[0] = '\0';
  sSource[1] = '\0';
  sSource[2] = '\0';
  sSource[3] = '\0';
  sSource[4] = '\0';
  sSource[5] = '\0';
  sSource[6] = '\0';
  sSource[7] = '\0';
  sSource[8] = '\0';
  GetSecurityData(5,FieldData,sSource,&FieldLen);
  iVar1 = memcmp(sSource,&DAT_004c9c2d,2);
  if (iVar1 == 0) {
    IsoInfo.nMsgType = 0x4ba;
  }
  FCT_AUT_REP_TO_NW(nIndexCtx,&IsoInfo);
LAB_004089db:
  trace_event("End   BalProcMsg()",5);
  return;
}



// WARNING: Unknown calling convention

void * thread_proc_LINE(void *arg)

{
  int indice;
  pthread_t __th;
  long lVar1;
  int nIndiceCtx;
  char *pcVar2;
  timeval lastTime;
  char sLine [512];
  TSLineExchange sLineMsg;
  
  pcVar2 = sLine;
  for (lVar1 = 0x40; lVar1 != 0; lVar1 = lVar1 + -1) {
    pcVar2[0] = '\0';
    pcVar2[1] = '\0';
    pcVar2[2] = '\0';
    pcVar2[3] = '\0';
    pcVar2[4] = '\0';
    pcVar2[5] = '\0';
    pcVar2[6] = '\0';
    pcVar2[7] = '\0';
    pcVar2 = pcVar2 + 8;
  }
  trace_event(">>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>",4);
  trace_event("> Start thread_proc_LINE >>>>>>>>>>>>>>>>>>>>>>>>>>>>>",4);
  trace_event(">>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>",4);
  __th = pthread_self();
  pthread_detach(__th);
                    // WARNING: Load size is inaccurate
  sprintf(sLine," ==> ((TSArgParam *)arg)->nIndice = %d",(ulong)*arg);
  trace_event(sLine,5);
                    // WARNING: Load size is inaccurate
  indice = *arg;
  free(arg);
  ConnectOracle(indice);
  gettimeofday((timeval *)&lastTime,(__timezone_ptr_t)0x0);
  do {
    CLineWaitMsg();
    CLineGetMsg(&sLineMsg);
    CLineFreeEntry();
    CheckAndRefreshDBCon(indice,lastTime);
    LineProcMsg(indice,&sLineMsg);
    gettimeofday((timeval *)&lastTime,(__timezone_ptr_t)0x0);
  } while( true );
}



// WARNING: Unknown calling convention

int ConnectInterface(int P_nIndiceCtx)

{
  int iVar1;
  uint uVar2;
  size_t __n;
  long lVar3;
  TSResources *pTVar4;
  char *pcVar5;
  byte bVar6;
  char app_pid [9];
  char app_ppid [9];
  char calling_adress [17];
  char szDetail [256];
  TSResources sResource;
  
  bVar6 = 0;
  iVar1 = 100;
  pTVar4 = &sResource;
  for (lVar3 = 0x73; lVar3 != 0; lVar3 = lVar3 + -1) {
    pTVar4->resource_id[0] = '\0';
    pTVar4->resource_id[1] = '\0';
    pTVar4->resource_id[2] = '\0';
    pTVar4->resource_id[3] = '\0';
    pTVar4->resource_id[4] = '\0';
    pTVar4->resource_id[5] = '\0';
    pTVar4->resource_id[6] = '\0';
    pTVar4->resource_code[0] = '\0';
    pTVar4 = (TSResources *)(pTVar4->resource_code + 1);
  }
  sprintf(szDetail,"Start ConnectInterface(%d)",(ulong)(uint)P_nIndiceCtx);
  trace_event(szDetail,5);
  AllocateOracleCtx(P_nIndiceCtx);
  ConnectOracle(P_nIndiceCtx);
  while( true ) {
    nFdConnect = InitCltCom(RemoteAppName,RemoteAppId);
    if (0 < nFdConnect) break;
    sleep(0x1e);
    iVar1 = iVar1 + -1;
    if (iVar1 == 0) {
      shutdown_resource(P_nIndiceCtx,G_sNps.F_szRsrcId);
      trace_event("InitCltCom() failed.",0);
      DeconnectOracle(P_nIndiceCtx);
      FreeOracleCtx(P_nIndiceCtx);
                    // WARNING: Subroutine does not return
      exit(0);
    }
  }
  iVar1 = initial_sign_on_to_nw(P_nIndiceCtx);
  if (iVar1 == 0) {
    sResource.resource_id[0] = G_sNps.F_szRsrcId[0];
    sResource.resource_id[1] = G_sNps.F_szRsrcId[1];
    sResource.resource_id[2] = G_sNps.F_szRsrcId[2];
    sResource.resource_id[3] = G_sNps.F_szRsrcId[3];
    sResource.resource_id[4] = G_sNps.F_szRsrcId[4];
    sResource.resource_id[5] = G_sNps.F_szRsrcId[5];
    iVar1 = GetResources(P_nIndiceCtx,&sResource);
    if (iVar1 == 0) {
      iVar1 = UpdateResource(P_nIndiceCtx,G_sNps.F_szRsrcId,"YYY","ONL");
      if (iVar1 == 0) {
        uVar2 = getpid();
        sprintf(app_pid,"%08d",(ulong)uVar2);
        uVar2 = getppid();
        sprintf(app_ppid,"%08d",(ulong)uVar2);
        LogEvent(P_nIndiceCtx,G_sNps.F_szRsrcId,"","INSN",(char *)0x0,(char *)0x0,(char *)0x0,
                 app_pid,app_ppid);
        G_sNps.F_szResourceStatus[2] = 'L';
        G_sNps.F_szResourceStatus[0] = 'O';
        G_sNps.F_szResourceStatus[1] = 'N';
        pcVar5 = trace_file;
        for (lVar3 = 8; lVar3 != 0; lVar3 = lVar3 + -1) {
          pcVar5[0] = '\0';
          pcVar5[1] = '\0';
          pcVar5[2] = '\0';
          pcVar5[3] = '\0';
          pcVar5[4] = '\0';
          pcVar5[5] = '\0';
          pcVar5[6] = '\0';
          pcVar5[7] = '\0';
          pcVar5 = pcVar5 + ((ulong)bVar6 * -2 + 1) * 8;
        }
        __n = strlen(sResource.pris_log_file_name);
        memcpy(trace_file,sResource.pris_log_file_name,__n);
        DeconnectOracle(P_nIndiceCtx);
        FreeOracleCtx(P_nIndiceCtx);
        sprintf(szDetail,"End   ConnectInterface(%d)",(ulong)(uint)P_nIndiceCtx);
        trace_event(szDetail,5);
        return 0;
      }
      shutdown_resource(P_nIndiceCtx,G_sNps.F_szRsrcId);
      pcVar5 = "UpdateResource() failed.";
    }
    else {
      shutdown_resource(P_nIndiceCtx,G_sNps.F_szRsrcId);
      pcVar5 = "GetResources() failed.";
    }
  }
  else {
    shutdown_resource(P_nIndiceCtx,G_sNps.F_szRsrcId);
    pcVar5 = "initial_sign_on_to_nw() failed.";
  }
  trace_event(pcVar5,0);
  DeconnectOracle(P_nIndiceCtx);
  FreeOracleCtx(P_nIndiceCtx);
  StopCltCom(nFdConnect);
                    // WARNING: Subroutine does not return
  exit(0);
}



// WARNING: Unknown calling convention

int ReconnectInterface(int P_nIndiceCtx)

{
  int iVar1;
  uint uVar2;
  size_t __n;
  long lVar3;
  TSResources *pTVar4;
  char *pcVar5;
  byte bVar6;
  char app_pid [9];
  char app_ppid [9];
  char calling_adress [17];
  char szDetail [256];
  TSResources sResource;
  
  bVar6 = 0;
  sprintf(szDetail,"Start ReconnectInterface(%d)",P_nIndiceCtx);
  trace_event(szDetail,5);
  pTVar4 = &sResource;
  for (lVar3 = 0x73; lVar3 != 0; lVar3 = lVar3 + -1) {
    pTVar4->resource_id[0] = '\0';
    pTVar4->resource_id[1] = '\0';
    pTVar4->resource_id[2] = '\0';
    pTVar4->resource_id[3] = '\0';
    pTVar4->resource_id[4] = '\0';
    pTVar4->resource_id[5] = '\0';
    pTVar4->resource_id[6] = '\0';
    pTVar4->resource_code[0] = '\0';
    pTVar4 = (TSResources *)((long)pTVar4 + (ulong)bVar6 * -0x10 + 8);
  }
  StopCltCom(nFdConnect);
  AllocateOracleCtx(P_nIndiceCtx);
  ConnectOracle(P_nIndiceCtx);
  G_sNps.F_szResourceStatus[0] = 'O';
  G_sNps.F_szResourceStatus[1] = 'F';
  G_sNps.F_szResourceStatus[2] = 'F';
  sResource.resource_id[0] = G_sNps.F_szRsrcId[0];
  sResource.resource_id[1] = G_sNps.F_szRsrcId[1];
  sResource.resource_id[2] = G_sNps.F_szRsrcId[2];
  sResource.resource_id[3] = G_sNps.F_szRsrcId[3];
  sResource.resource_id[4] = G_sNps.F_szRsrcId[4];
  sResource.resource_id[5] = G_sNps.F_szRsrcId[5];
  iVar1 = GetResources(P_nIndiceCtx,&sResource);
  if (iVar1 == 0) {
    iVar1 = UpdateResource(P_nIndiceCtx,G_sNps.F_szRsrcId,"CCC","CNT");
    if (iVar1 == 0) {
      trace_event(" Wait 30s Before Retrying the InitCltCom() Call",5);
      sleep(0x1e);
      while( true ) {
        nFdConnect = InitCltCom(RemoteAppName,RemoteAppId);
        if (-1 < nFdConnect) break;
        trace_event(" Problem while Calling InitCltCom(). Wait 30s Before Retry",5);
        sleep(0x1e);
      }
      G_sNps.F_szResourceStatus[2] = 'T';
      G_sNps.F_szResourceStatus[0] = 'C';
      G_sNps.F_szResourceStatus[1] = 'N';
      iVar1 = initial_sign_on_to_nw(P_nIndiceCtx);
      if (iVar1 != 0) {
        shutdown_resource(P_nIndiceCtx,G_sNps.F_szRsrcId);
        pcVar5 = "initial_sign_on_to_nw() failed.";
        goto LAB_004091dc;
      }
      sResource.resource_id[0] = G_sNps.F_szRsrcId[0];
      sResource.resource_id[1] = G_sNps.F_szRsrcId[1];
      sResource.resource_id[2] = G_sNps.F_szRsrcId[2];
      sResource.resource_id[3] = G_sNps.F_szRsrcId[3];
      sResource.resource_id[4] = G_sNps.F_szRsrcId[4];
      sResource.resource_id[5] = G_sNps.F_szRsrcId[5];
      iVar1 = GetResources(P_nIndiceCtx,&sResource);
      if (iVar1 != 0) goto LAB_004091c6;
      iVar1 = UpdateResource(P_nIndiceCtx,G_sNps.F_szRsrcId,"YYY","ONL");
      if (iVar1 == 0) {
        G_sNps.F_szResourceStatus[2] = 'L';
        G_sNps.F_szResourceStatus[0] = 'O';
        G_sNps.F_szResourceStatus[1] = 'N';
        uVar2 = getpid();
        sprintf(app_pid,"%08d",(ulong)uVar2);
        uVar2 = getppid();
        sprintf(app_ppid,"%08d",(ulong)uVar2);
        LogEvent(P_nIndiceCtx,G_sNps.F_szRsrcId,"","INSN",(char *)0x0,(char *)0x0,(char *)0x0,
                 app_pid,app_ppid);
        pcVar5 = trace_file;
        for (lVar3 = 8; lVar3 != 0; lVar3 = lVar3 + -1) {
          pcVar5[0] = '\0';
          pcVar5[1] = '\0';
          pcVar5[2] = '\0';
          pcVar5[3] = '\0';
          pcVar5[4] = '\0';
          pcVar5[5] = '\0';
          pcVar5[6] = '\0';
          pcVar5[7] = '\0';
          pcVar5 = pcVar5 + ((ulong)bVar6 * -2 + 1) * 8;
        }
        __n = strlen(sResource.pris_log_file_name);
        memcpy(trace_file,sResource.pris_log_file_name,__n);
        DeconnectOracle(P_nIndiceCtx);
        FreeOracleCtx(P_nIndiceCtx);
        sprintf(szDetail,"End   ReconnectInterface(%d)",(ulong)(uint)P_nIndiceCtx);
        trace_event(szDetail,5);
        return 0;
      }
    }
    shutdown_resource(P_nIndiceCtx,G_sNps.F_szRsrcId);
    pcVar5 = "UpdateResource() failed.";
  }
  else {
LAB_004091c6:
    shutdown_resource(P_nIndiceCtx,G_sNps.F_szRsrcId);
    pcVar5 = "GetResources() failed.";
  }
LAB_004091dc:
  trace_event(pcVar5,0);
  DeconnectOracle(P_nIndiceCtx);
  FreeOracleCtx(P_nIndiceCtx);
  StopCltCom(nFdConnect);
                    // WARNING: Subroutine does not return
  exit(0);
}



// WARNING: Unknown calling convention

void * thread_wait_LINE(void *arg)

{
  int iVar1;
  int iVar2;
  uint uVar3;
  pthread_t __th;
  int *__arg;
  uint *puVar4;
  long lVar5;
  TSResources *pTVar6;
  TSLineExchange *pTVar7;
  TSThrInfo *__newthread;
  byte bVar8;
  pthread_attr_t pattr;
  char sLine [512];
  TSResources sResource;
  TSLineExchange sLineMsg;
  
  bVar8 = 0;
  pTVar6 = &sResource;
  for (lVar5 = 0x73; lVar5 != 0; lVar5 = lVar5 + -1) {
    pTVar6->resource_id[0] = '\0';
    pTVar6->resource_id[1] = '\0';
    pTVar6->resource_id[2] = '\0';
    pTVar6->resource_id[3] = '\0';
    pTVar6->resource_id[4] = '\0';
    pTVar6->resource_id[5] = '\0';
    pTVar6->resource_id[6] = '\0';
    pTVar6->resource_code[0] = '\0';
    pTVar6 = (TSResources *)(pTVar6->resource_code + 1);
  }
  pTVar7 = &sLineMsg;
  for (lVar5 = 0x203; lVar5 != 0; lVar5 = lVar5 + -1) {
    pTVar7->nLength = 0;
    pTVar7->sBuffer[0] = '\0';
    pTVar7->sBuffer[1] = '\0';
    pTVar7->sBuffer[2] = '\0';
    pTVar7->sBuffer[3] = '\0';
    pTVar7 = (TSLineExchange *)(pTVar7->sBuffer + 4);
  }
  trace_event(">>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>",4);
  trace_event("> New Start thread_wait_LINE >>>>>>>>>>>>>>>>>>>>>>>>>>>>>",4);
  trace_event(">>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>",4);
  __th = pthread_self();
  pthread_detach(__th);
  iVar1 = ConnectInterface(0);
  if (iVar1 != 0) {
    trace_event("ConnectInterface(MAIN_THREAD_ID) failed.",0);
                    // WARNING: Subroutine does not return
    exit(0);
  }
  sprintf(sLine,"==> max_thread = %d",(ulong)(uint)max_thread);
  trace_event(sLine,5);
  sprintf(sLine,"==> nUserThread = %d",(ulong)(uint)nUserThread);
  trace_event(sLine,5);
  if (0 < max_thread) {
    iVar1 = 0;
    __newthread = tab_ThrInfo + 0x100;
    do {
      pthread_attr_init((pthread_attr_t *)&pattr);
      uVar3 = pthread_attr_setstacksize((pthread_attr_t *)&pattr,0x100000);
      if (uVar3 != 0) {
        sprintf(sLine,"ERROR: rc from pthread_attr_setstacksize() is %d\n",(ulong)uVar3);
        trace_event(sLine,5);
      }
      __arg = (int *)malloc(4);
      AllocateOracleCtx(iVar1 + 0x100);
      *__arg = iVar1 + 0x100;
      iVar2 = pthread_create(&__newthread->tid,(pthread_attr_t *)&pattr,thread_proc_LINE,__arg);
      if (iVar2 < 0) {
        trace_event("End   thread_wait_LINE(ERROR)",1);
        puVar4 = (uint *)__errno_location();
        fprintf(stderr,"pthread_create Error %d\n",(ulong)*puVar4);
        free(__arg);
                    // WARNING: Subroutine does not return
        pthread_exit((void *)0x0);
      }
      iVar1 = iVar1 + 1;
      __newthread = __newthread + 1;
    } while (iVar1 < max_thread);
  }
  do {
    while( true ) {
      pTVar7 = &sLineMsg;
      for (lVar5 = 0x203; lVar5 != 0; lVar5 = lVar5 + -1) {
        pTVar7->nLength = 0;
        pTVar7->sBuffer[0] = '\0';
        pTVar7->sBuffer[1] = '\0';
        pTVar7->sBuffer[2] = '\0';
        pTVar7->sBuffer[3] = '\0';
        pTVar7 = (TSLineExchange *)((long)pTVar7 + (ulong)bVar8 * -0x10 + 8);
      }
      iVar1 = ReadLineMsg(nFdConnect,sLineMsg.sBuffer,&sLineMsg.nLength);
      if (iVar1 != 0) break;
      DumpNps(sLineMsg.sBuffer);
      PLineWaitEntry();
      PLinePutMsg(&sLineMsg);
      PLineConsoInfo();
    }
    iVar1 = ReconnectInterface(0);
  } while (iVar1 == 0);
  trace_event("ReconnectInterface(MAIN_THREAD_ID) failed.",0);
                    // WARNING: Subroutine does not return
  exit(0);
}



// WARNING: Unknown calling convention

void LineProcMsg(int nIndexCtx,TSLineExchange *sLineMsg)

{
  char sLine [512];
  TSNpsInfo NpsInfo;
  
  trace_event("Start LineProcMsg()",5);
  InitNpsInfo(&NpsInfo);
  AnalyseNps(sLineMsg->sBuffer,&NpsInfo);
  sprintf(sLine,"Message Type : %d",(ulong)(uint)NpsInfo.nMsgType);
  trace_event(sLine,4);
  if (NpsInfo.nMsgType == 0x1ae) {
    FCT_REV_REP_FROM_NW(nIndexCtx,&NpsInfo);
    goto LAB_004095b0;
  }
  if (NpsInfo.nMsgType < 0x1af) {
    if (NpsInfo.nMsgType == 200) {
LAB_00409697:
      FCT_AUT_REQ_FROM_NW(nIndexCtx,&NpsInfo);
      goto LAB_004095b0;
    }
    if (NpsInfo.nMsgType < 0xc9) {
      if (NpsInfo.nMsgType == 0x6e) {
LAB_00409602:
        FCT_AUT_REP_FROM_NW(nIndexCtx,&NpsInfo);
        goto LAB_004095b0;
      }
      if (NpsInfo.nMsgType < 0x6f) {
        if (NpsInfo.nMsgType == 100) goto LAB_00409697;
      }
      else if (NpsInfo.nMsgType - 0x78U < 2) goto LAB_004096e0;
    }
    else if (NpsInfo.nMsgType < 0xde) {
      if (0xdb < NpsInfo.nMsgType) {
LAB_004096e0:
        FCT_ADV_REQ_FROM_NW(nIndexCtx,&NpsInfo);
        goto LAB_004095b0;
      }
      if (NpsInfo.nMsgType == 0xd2) goto LAB_00409602;
    }
    else if (NpsInfo.nMsgType - 0x1a4U < 2) {
      FCT_REV_REQ_FROM_NW(nIndexCtx,&NpsInfo);
      goto LAB_004095b0;
    }
  }
  else if (NpsInfo.nMsgType < 0x20c) {
    if ((0x209 < NpsInfo.nMsgType) || (NpsInfo.nMsgType == 0x1f6)) {
      FCT_RECONC_ADV(nIndexCtx,&NpsInfo,"ISS");
      goto LAB_004095b0;
    }
    if (NpsInfo.nMsgType < 0x1f7) {
      if (NpsInfo.nMsgType == 500) {
LAB_0040959a:
        FCT_RECONC_ADV(nIndexCtx,&NpsInfo,"ACQ");
        goto LAB_004095b0;
      }
    }
    else if (0x207 < NpsInfo.nMsgType) goto LAB_0040959a;
  }
  else {
    if (NpsInfo.nMsgType == 0x32a) {
      FCT_NW_MNG_REP_FROM_NW(nIndexCtx,&NpsInfo);
      goto LAB_004095b0;
    }
    if (NpsInfo.nMsgType < 0x32b) {
      if (NpsInfo.nMsgType == 800) {
        FCT_NW_MNG_REQ_FROM_NW(nIndexCtx,&NpsInfo);
        goto LAB_004095b0;
      }
    }
    else if (NpsInfo.nMsgType - 0x334U < 2) {
      FCT_NW_ADV_REQ_FROM_NW(nIndexCtx,&NpsInfo);
      goto LAB_004095b0;
    }
  }
  sprintf(sLine,"==> NO PROCESSING FOR MESSAGE [%.4d] ");
LAB_004095b0:
  trace_event("End   LineProcMsg(OK)",5);
  return;
}



// WARNING: Unknown calling convention

void * thread_proc_TIME(void *arg)

{
  int indice;
  pthread_t __th;
  int nIndiceCtx;
  TSTimeExchange sTimeMsg;
  
  trace_event(">>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>",4);
  trace_event("> Start thread_proc_TIME >>>>>>>>>>>>>>>>>>>>>>>>>>>>>",4);
  trace_event(">>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>",4);
  __th = pthread_self();
  pthread_detach(__th);
                    // WARNING: Load size is inaccurate
  indice = *arg;
  free(arg);
  ConnectOracle(indice);
  do {
    CTimeWaitMsg();
    CTimeGetMsg(&sTimeMsg);
    CTimeFreeEntry();
    TimeProcMsg(indice,&sTimeMsg);
  } while( true );
}



// WARNING: Unknown calling convention

void * thread_TIMEOUT(void *arg)

{
  int iVar1;
  pthread_t __th;
  int *__arg;
  uint *puVar2;
  int indice;
  TSThrInfo *__newthread;
  pthread_attr_t pattr;
  
  indice = 0xf;
  trace_event(">>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>",4);
  trace_event("> Start thread_TIMEOUT >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>",4);
  trace_event(">>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>",4);
  __th = pthread_self();
  pthread_detach(__th);
  ThreadMaskSignals();
  __newthread = tab_ThrInfo + 0xf;
  do {
    pthread_attr_init((pthread_attr_t *)&pattr);
    pthread_attr_setscope((pthread_attr_t *)&pattr,0);
    __arg = (int *)malloc(4);
    AllocateOracleCtx(indice);
    *__arg = indice;
    iVar1 = pthread_create(&__newthread->tid,(pthread_attr_t *)&pattr,thread_proc_TIME,__arg);
    if (iVar1 < 0) {
      puVar2 = (uint *)__errno_location();
      fprintf(stderr,"pthread_create Error %d\n",(ulong)*puVar2);
      free(__arg);
                    // WARNING: Subroutine does not return
      pthread_exit((void *)0x0);
    }
    indice = indice + 1;
    __newthread = __newthread + 1;
  } while (indice != 0x11);
  do {
    sleep(2);
    FreeTimeOutRequest('B');
    FreeTimeOutRequest('L');
  } while( true );
}



// WARNING: Unknown calling convention

int AcquirerTimeProcMsg(int nIndexCtx,TSTimeExchange *sTimeMsg)

{
  int nFd;
  int iVar1;
  long lVar2;
  char *pcVar3;
  size_t __n;
  byte bVar4;
  char sActionCode [4];
  char TableIndicator [4];
  int nLength;
  int Length;
  int FieldLen;
  char sCaptureCode [7];
  char sRoutingCode [7];
  char SourceId [9];
  char sProcCode [9];
  char tmpField [256];
  char sLine [512];
  char sBuffer [1024];
  TSIsoInfo IsoInfo;
  char sSecurityData [4097];
  TSBalExchange BalMessage;
  
  nFd = nFdConnect;
  bVar4 = 0;
  trace_event("Start AcquirerTimeProcMsg()",5);
  sRoutingCode[4] = '\0';
  sRoutingCode[5] = '\0';
  iVar1 = (sTimeMsg->sData).nFstPrvtDataLen;
  __n = (size_t)iVar1;
  pcVar3 = tmpField;
  for (lVar2 = 0x20; lVar2 != 0; lVar2 = lVar2 + -1) {
    pcVar3[0] = '\0';
    pcVar3[1] = '\0';
    pcVar3[2] = '\0';
    pcVar3[3] = '\0';
    pcVar3[4] = '\0';
    pcVar3[5] = '\0';
    pcVar3[6] = '\0';
    pcVar3[7] = '\0';
    pcVar3 = pcVar3 + (ulong)bVar4 * -0x10 + 8;
  }
  sCaptureCode[0] = '\0';
  sCaptureCode[1] = '\0';
  sCaptureCode[2] = '\0';
  sCaptureCode[3] = '\0';
  sCaptureCode[4] = '\0';
  sCaptureCode[5] = '\0';
  sCaptureCode[6] = '\0';
  sRoutingCode[0] = '\0';
  sRoutingCode[1] = '\0';
  sRoutingCode[2] = '\0';
  sRoutingCode[3] = '\0';
  sRoutingCode[6] = '\0';
  TableIndicator[0] = '\0';
  TableIndicator[1] = '\0';
  TableIndicator[2] = '\0';
  TableIndicator[3] = '\0';
  SourceId[0] = '\0';
  SourceId[1] = '\0';
  SourceId[2] = '\0';
  SourceId[3] = '\0';
  SourceId[4] = '\0';
  SourceId[5] = '\0';
  SourceId[6] = '\0';
  SourceId[7] = '\0';
  SourceId[8] = '\0';
  sProcCode[0] = '\0';
  sProcCode[1] = '\0';
  sProcCode[2] = '\0';
  sProcCode[3] = '\0';
  sProcCode[4] = '\0';
  sProcCode[5] = '\0';
  sProcCode[6] = '\0';
  sProcCode[7] = '\0';
  sProcCode[8] = '\0';
  pcVar3 = sBuffer;
  for (lVar2 = 0x80; lVar2 != 0; lVar2 = lVar2 + -1) {
    pcVar3[0] = '\0';
    pcVar3[1] = '\0';
    pcVar3[2] = '\0';
    pcVar3[3] = '\0';
    pcVar3[4] = '\0';
    pcVar3[5] = '\0';
    pcVar3[6] = '\0';
    pcVar3[7] = '\0';
    pcVar3 = pcVar3 + (ulong)bVar4 * -0x10 + 8;
  }
  pcVar3 = sLine;
  for (lVar2 = 0x40; lVar2 != 0; lVar2 = lVar2 + -1) {
    pcVar3[0] = '\0';
    pcVar3[1] = '\0';
    pcVar3[2] = '\0';
    pcVar3[3] = '\0';
    pcVar3[4] = '\0';
    pcVar3[5] = '\0';
    pcVar3[6] = '\0';
    pcVar3[7] = '\0';
    pcVar3 = pcVar3 + (ulong)bVar4 * -0x10 + 8;
  }
  pcVar3 = sSecurityData;
  for (lVar2 = 0x200; lVar2 != 0; lVar2 = lVar2 + -1) {
    pcVar3[0] = '\0';
    pcVar3[1] = '\0';
    pcVar3[2] = '\0';
    pcVar3[3] = '\0';
    pcVar3[4] = '\0';
    pcVar3[5] = '\0';
    pcVar3[6] = '\0';
    pcVar3[7] = '\0';
    pcVar3 = pcVar3 + (ulong)bVar4 * -0x10 + 8;
  }
  *pcVar3 = '\0';
  if (iVar1 == 0) {
LAB_00409a5e:
    trace_event("End   AcquirerTimeProcMsg( OK )",5);
    InitIsoInfo(&IsoInfo);
    AnalyseIso((sTimeMsg->sData).sFstBuf,&IsoInfo);
    trace_event("==> Original Msg <==",5);
    dump_p7_struct(&IsoInfo);
    InsertIsoField(0x26,&IsoInfo,"912",3);
    pcVar3 = sSecurityData;
    for (lVar2 = 0x200; lVar2 != 0; lVar2 = lVar2 + -1) {
      pcVar3[0] = '\0';
      pcVar3[1] = '\0';
      pcVar3[2] = '\0';
      pcVar3[3] = '\0';
      pcVar3[4] = '\0';
      pcVar3[5] = '\0';
      pcVar3[6] = '\0';
      pcVar3[7] = '\0';
      pcVar3 = pcVar3 + (ulong)bVar4 * -0x10 + 8;
    }
    SourceId[0] = '\0';
    SourceId[1] = '\0';
    SourceId[2] = '\0';
    SourceId[3] = '\0';
    SourceId[4] = '\0';
    SourceId[5] = '\0';
    SourceId[6] = '\0';
    SourceId[7] = '\0';
    SourceId[8] = '\0';
    *pcVar3 = '\0';
    GetIsoField(0x34,&IsoInfo,sSecurityData,&FieldLen);
    GetSecurityData(4,sSecurityData,SourceId,&Length);
    IsoInfo.nMsgType = IsoInfo.nMsgType + 10;
    dump_p7_struct(&IsoInfo);
    lVar2 = strtol(SourceId,(char **)0x0,10);
    BalMessage.sHeader.nPartnerId = (pid_t)lVar2;
    BalMessage.sHeader.nSourceId = getpid();
    BalMessage.sHeader.nCommand = IsoInfo.nMsgType;
    Length = IsoBuildMsg(BalMessage.sBody,&IsoInfo);
    BalMessage.sHeader.nLen = Length;
    iVar1 = WriteBalMsg(nBalMsg,&BalMessage);
    if (iVar1 == 0) {
      iVar1 = GetIsoField(2,&IsoInfo,sProcCode,&nLength);
      if ((iVar1 == 0) && (iVar1 = memcmp(sProcCode,"01",2), iVar1 == 0)) {
        IsoInfo.nMsgType = IsoInfo.nMsgType + -10;
        GetSecurityData(5,sSecurityData,sCaptureCode,&Length);
        GetSecurityData(7,sSecurityData,sRoutingCode,&Length);
        builtin_strncpy(TableIndicator,"ATM",4);
        if ((IsoInfo.nMsgType == 0x44c) || (IsoInfo.nMsgType == 0x4b0)) {
          AutomaticReversalProcessing
                    (nIndexCtx,"C",sCaptureCode,sRoutingCode,TableIndicator,&IsoInfo,"4006");
        }
      }
      trace_event("End   AcquirerTimeProcMsg( OK )",5);
      iVar1 = 0;
    }
    else {
      iVar1 = -1;
      trace_event("End AcquirerTimeProcMsg( NOK ): WriteBal() failed.",1);
    }
  }
  else {
    pcVar3 = (sTimeMsg->sData).sFstPrvtData;
    iVar1 = memcmp(pcVar3,&DAT_004a40cb,__n);
    if (iVar1 == 0) {
      SafTimeOutTraitement(nIndexCtx,(sTimeMsg->sData).sSndBuf);
      trace_event("End   AcquirerTimeProcMsg( OK )",5);
      return 0;
    }
    iVar1 = memcmp(pcVar3,"ECHO_NPS",__n);
    if (iVar1 == 0) {
      echoTentative = echoTentative + 1;
      if (echoTentative == MaxTroublesInd) {
        sprintf(sLine,">> StopCltCom for nFd : [%d]",(ulong)(uint)nFd);
        trace_event(sLine,0);
        StopCltCom(nFd);
        BalMessage.sBody[0x30e] = 'C';
        BalMessage.sBody[0x30f] = 'C';
        BalMessage.sBody[0x310] = 'C';
        ResourceStatus[0] = 'C';
        ResourceStatus[1] = 'C';
        ResourceStatus[2] = 'C';
        sleep(1);
        echoTentative = 0;
        return 0;
      }
    }
    else {
      iVar1 = memcmp(pcVar3,"KEY_NPS",__n);
      if (iVar1 != 0) goto LAB_00409a5e;
    }
    iVar1 = 0;
  }
  return iVar1;
}



// WARNING: Unknown calling convention

int IssuerTimeProcMsg(int P_nIndexCtx,TSTimeExchange *sTimeMsg)

{
  trace_event("Start IssuerTimeProcMsg()",5);
  trace_event("End   IssuerTimeProcMsg()",5);
  return 0;
}



// WARNING: Unknown calling convention

int TimeProcMsg(int P_nIndexCtx,TSTimeExchange *sTimeMsg)

{
  char cVar1;
  
  trace_event("Start TimeProcMsg",5);
  trace_event("Time Out Detected ....",5);
  cVar1 = sTimeMsg->sens;
  if (cVar1 == 'B') {
    AcquirerTimeProcMsg(P_nIndexCtx,sTimeMsg);
  }
  else if (cVar1 == 'L') {
    IssuerTimeProcMsg(P_nIndexCtx,sTimeMsg);
  }
  else if (cVar1 == 'S') {
    FCT_SHUTDOWN_TIME(P_nIndexCtx);
  }
  trace_event("End   TimeProcMsg(OK)",5);
  return 0;
}



// WARNING: Unknown calling convention

int BuildTimeOutReversalMsg(TSIsoInfo *IsoInfo,TSIsoInfo *IsoRevInfo)

{
  trace_event("Start BuildTimeOutReversalMsg",5);
  trace_event("End   BuildTimeOutReversalMsg(OK)",5);
  return 0;
}



// WARNING: Unknown calling convention

void * thread_SAF(void *arg)

{
  pthread_t __th;
  
  trace_event(">>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>",4);
  trace_event(">> Start thread_SAF...>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>",4);
  trace_event(">>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>",4);
  __th = pthread_self();
  pthread_detach(__th);
  AllocateOracleCtx(6);
  ConnectOracle(6);
  do {
    SafManagement(6,G_sNps.F_szRsrcId);
    sleep(5);
  } while( true );
}



// WARNING: Unknown calling convention

int SafManagement(int nIndiceCtx,char *sResource)

{
  char DeclineAdviceFlag;
  int iVar1;
  uint uVar2;
  long lVar3;
  TSIsoInfo *pTVar4;
  char *pcVar5;
  uint *puVar6;
  byte bVar7;
  char sAuthoTable [4];
  int tmpFieldLen;
  int nSendCounter;
  int nLength;
  char sMti [5];
  char sResponseCode [5];
  char sStan [7];
  char sSrcResource [7];
  char sProcCodeTmp [7];
  char sSendCounter [9];
  char sDate [13];
  char sCardNumber [23];
  char tmpField [256];
  char sLine [512];
  TSIsoInfo sMsgIso;
  char sBuffer [4096];
  char sTlvBuffer [4096];
  char sStandInResource [4096];
  TSTlvAutho sTlvInfo;
  
  bVar7 = 0;
  sSrcResource[4] = '\0';
  sSrcResource[5] = '\0';
  sStan[4] = '\0';
  sStan[5] = '\0';
  sCardNumber[0x14] = '\0';
  sCardNumber[0x15] = '\0';
  pcVar5 = sBuffer;
  for (lVar3 = 0x200; lVar3 != 0; lVar3 = lVar3 + -1) {
    pcVar5[0] = '\0';
    pcVar5[1] = '\0';
    pcVar5[2] = '\0';
    pcVar5[3] = '\0';
    pcVar5[4] = '\0';
    pcVar5[5] = '\0';
    pcVar5[6] = '\0';
    pcVar5[7] = '\0';
    pcVar5 = pcVar5 + 8;
  }
  sDate[0] = '\0';
  sDate[1] = '\0';
  sDate[2] = '\0';
  sDate[3] = '\0';
  sDate[4] = '\0';
  sDate[5] = '\0';
  sDate[6] = '\0';
  sDate[7] = '\0';
  sDate[8] = '\0';
  sDate[9] = '\0';
  sDate[10] = '\0';
  sDate[0xb] = '\0';
  sDate[0xc] = '\0';
  sMti[0] = '\0';
  sMti[1] = '\0';
  sMti[2] = '\0';
  sMti[3] = '\0';
  sMti[4] = '\0';
  sStan[0] = '\0';
  sStan[1] = '\0';
  sStan[2] = '\0';
  sStan[3] = '\0';
  sStan[6] = '\0';
  sSrcResource[0] = '\0';
  sSrcResource[1] = '\0';
  sSrcResource[2] = '\0';
  sSrcResource[3] = '\0';
  sSrcResource[6] = '\0';
  sResponseCode[0] = '\0';
  sResponseCode[1] = '\0';
  sResponseCode[2] = '\0';
  sResponseCode[3] = '\0';
  sResponseCode[4] = '\0';
  sCardNumber[0] = '\0';
  sCardNumber[1] = '\0';
  sCardNumber[2] = '\0';
  sCardNumber[3] = '\0';
  sCardNumber[4] = '\0';
  sCardNumber[5] = '\0';
  sCardNumber[6] = '\0';
  sCardNumber[7] = '\0';
  pcVar5 = sTlvBuffer;
  for (lVar3 = 0x200; lVar3 != 0; lVar3 = lVar3 + -1) {
    pcVar5[0] = '\0';
    pcVar5[1] = '\0';
    pcVar5[2] = '\0';
    pcVar5[3] = '\0';
    pcVar5[4] = '\0';
    pcVar5[5] = '\0';
    pcVar5[6] = '\0';
    pcVar5[7] = '\0';
    pcVar5 = pcVar5 + 8;
  }
  sCardNumber[8] = '\0';
  sCardNumber[9] = '\0';
  sCardNumber[10] = '\0';
  sCardNumber[0xb] = '\0';
  sCardNumber[0xc] = '\0';
  sCardNumber[0xd] = '\0';
  sCardNumber[0xe] = '\0';
  sCardNumber[0xf] = '\0';
  sCardNumber[0x10] = '\0';
  sCardNumber[0x11] = '\0';
  sCardNumber[0x12] = '\0';
  sCardNumber[0x13] = '\0';
  sCardNumber[0x16] = '\0';
  sSendCounter[0] = '\0';
  sSendCounter[1] = '\0';
  sSendCounter[2] = '\0';
  sSendCounter[3] = '\0';
  sSendCounter[4] = '\0';
  sSendCounter[5] = '\0';
  sSendCounter[6] = '\0';
  sSendCounter[7] = '\0';
  sSendCounter[8] = '\0';
  sAuthoTable[0] = '\0';
  sAuthoTable[1] = '\0';
  sAuthoTable[2] = '\0';
  sAuthoTable[3] = '\0';
  pcVar5 = sStandInResource;
  for (lVar3 = 0x200; lVar3 != 0; lVar3 = lVar3 + -1) {
    pcVar5[0] = '\0';
    pcVar5[1] = '\0';
    pcVar5[2] = '\0';
    pcVar5[3] = '\0';
    pcVar5[4] = '\0';
    pcVar5[5] = '\0';
    pcVar5[6] = '\0';
    pcVar5[7] = '\0';
    pcVar5 = pcVar5 + 8;
  }
  InitIsoInfo(&sMsgIso);
  do {
    pcVar5 = (char *)0x32;
    sleep(0x32);
    DeclineAdviceFlag = GetDeclineAdvicesFlag(pcVar5);
    iVar1 = GetSafData(nIndiceCtx,sResource,'A',DeclineAdviceFlag,sMti,sStan,sSrcResource,
                       &nSendCounter,sResponseCode,sCardNumber,sTlvBuffer);
  } while (iVar1 != 0);
  trace_event("Read   Saf Data",5);
  trace_event("========= === ======",5);
  sprintf(sLine,"sCardNumber ... = [%s] ",sCardNumber);
  trace_event(sLine,5);
  sprintf(sLine,"sMti ... .......= [%s] ",sMti);
  trace_event(sLine,5);
  sprintf(sLine,"sStan ... ......= [%s] ",sStan);
  trace_event(sLine,5);
  sprintf(sLine,"sSrcResource ...= [%s] ",sSrcResource);
  trace_event(sLine,5);
  sprintf(sLine,"sResource ..... = [%s] ",sResource);
  trace_event(sLine,5);
  sprintf(sLine,"nSendCounter  ..= [%d] ",(ulong)(uint)nSendCounter);
  trace_event(sLine,5);
  InitTlvAutho(&sTlvInfo);
  AnalyseTlvAutho(sTlvBuffer,&sTlvInfo);
  GetTlvAutho("288",&sTlvInfo,sAuthoTable,&nLength);
  PrintTlvBuffer(sTlvBuffer);
  SafTlvToIso(nIndiceCtx,&sTlvInfo,&sMsgIso);
  dump_p7_struct(&sMsgIso);
  PutTlvAutho("288",&sTlvInfo,sAuthoTable,3);
  PutTlvAutho("201",&sTlvInfo,sSrcResource,6);
  PutTlvAutho("200",&sTlvInfo,sResource,6);
  PutTlvAutho("277",&sTlvInfo,"S",1);
  PutTlvAutho("255",&sTlvInfo,"E0",2);
  sprintf(sSendCounter,"%08d",(ulong)(uint)nSendCounter);
  PutTlvAutho("071",&sTlvInfo,sSendCounter,8);
  AuthoBuildTlv(sTlvBuffer,&sTlvInfo);
  pcVar5 = sBuffer;
  for (lVar3 = 0x200; lVar3 != 0; lVar3 = lVar3 + -1) {
    pcVar5[0] = '\0';
    pcVar5[1] = '\0';
    pcVar5[2] = '\0';
    pcVar5[3] = '\0';
    pcVar5[4] = '\0';
    pcVar5[5] = '\0';
    pcVar5[6] = '\0';
    pcVar5[7] = '\0';
    pcVar5 = pcVar5 + (ulong)bVar7 * -0x10 + 8;
  }
  uVar2 = atoi(sMti);
  if (0 < nSendCounter) {
    sDate[0] = '\0';
    sDate[1] = '\0';
    sDate[2] = '\0';
    sDate[3] = '\0';
    sDate[4] = '\0';
    sDate[5] = '\0';
    sDate[6] = '\0';
    sDate[7] = '\0';
    sDate[8] = '\0';
    sDate[9] = '\0';
    sDate[10] = '\0';
    sDate[0xb] = '\0';
    sDate[0xc] = '\0';
    current_gmt_date(sDate);
    PutIsoField(6,&sMsgIso,sDate + 2,10);
    sMsgIso.nMsgType = uVar2 + 1;
  }
  if (uVar2 == 0x4c4) {
    pTVar4 = &sMsgIso;
    puVar6 = (uint *)&stack0xffffffffffff8878;
    for (lVar3 = 0x143; lVar3 != 0; lVar3 = lVar3 + -1) {
      *(undefined8 *)puVar6 = *(undefined8 *)pTVar4->nFieldPos;
      pTVar4 = (TSIsoInfo *)((long)pTVar4 + (ulong)bVar7 * -0x10 + 8);
      puVar6 = puVar6 + (ulong)bVar7 * -4 + 2;
    }
    uVar2 = pTVar4->nFieldPos[0];
    *puVar6 = uVar2;
    iVar1 = GetNpsField(2,(TSNpsInfo *)tmpField,(char *)&tmpFieldLen,(int *)(ulong)uVar2);
    pcVar5 = " END     SafManagement( NOK --> ISO_PROC_CODE Not Present ) ";
    if (iVar1 == 0) {
      sProcCodeTmp[6] = '\0';
      sProcCodeTmp[0] = tmpField[0];
      sProcCodeTmp[1] = tmpField[1];
      sProcCodeTmp[2] = tmpField[2];
      sProcCodeTmp[3] = tmpField[3];
      sProcCodeTmp[4] = tmpField[4];
      sProcCodeTmp[5] = tmpField[5];
      sprintf(sLine,"sProcCodeTmp = [%s]",sProcCodeTmp);
      trace_event(sLine,5);
      trace_event("Sent 1220 SAF message.",5);
      trace_event("Response to 1220 SAF message received.",5);
      return 0;
    }
  }
  else {
    if (uVar2 != 0x58c) {
      sprintf(sLine,"End SafManagement(UNKNOWN MSG(MALFUNCTION) %d",(ulong)uVar2);
      trace_event(sLine,4);
      return -1;
    }
    iVar1 = FCT_REV_REQ_TO_NW(nIndiceCtx,&sMsgIso,sTlvBuffer);
    if (iVar1 == 0) {
      trace_event("Sent 1420 SAF message..",5);
      trace_event("Response to 1420 SAF message received.",5);
      return 0;
    }
    pcVar5 = "Could not send SAF message %4d through line.";
  }
  sprintf(sLine,pcVar5,(ulong)(uint)sMsgIso.nMsgType);
  trace_event(sLine,5);
  return -1;
}



// WARNING: Unknown calling convention

int SafResponseReceived(int nIndiceCtx,char *sPan,char *sMti,char *sStan,char *sSourceResource,
                       char *sResource,char *sSlfMti,char *sSlfResponseCode)

{
  int iVar1;
  char sLine [512];
  
  trace_event("Delete Saf Data",5);
  trace_event("========= === ======",5);
  sprintf(sLine,"sMti ... ..........= [%s] ",sPan);
  trace_event(sLine,5);
  sprintf(sLine,"sMti ... ..........= [%s] ",sMti);
  trace_event(sLine,5);
  sprintf(sLine,"sStan ... .........= [%s] ",sStan);
  trace_event(sLine,5);
  sprintf(sLine,"sSourceResource .. = [%s] ",sSourceResource);
  trace_event(sLine,5);
  sprintf(sLine,"sResource .........= [%s] ",sResource);
  trace_event(sLine,5);
  sprintf(sLine,"sSlfResponseCode ..= [%s] ",sSlfResponseCode);
  trace_event(sLine,5);
  sprintf(sLine,"sSlfMti........... = [%s] ",sSlfMti);
  trace_event(sLine,5);
  iVar1 = DeleteSafData(nIndiceCtx,sPan,sMti,'A',sStan,sSourceResource,sResource,sSlfMti,
                        sSlfResponseCode);
  return iVar1;
}



// WARNING: Unknown calling convention

int SafTimeOutReceived(int nIndiceCtx,char *sPan,char *sMti,char *sStan,char *sSourceResource,
                      char *sResource,char *sSlfMti,char *sSlfResponseCode,int nSendCounter)

{
  uint uVar1;
  int iVar2;
  int extraout_EAX;
  char sLine [512];
  
  trace_event("Start SafTimeOutReceived()",5);
  trace_event("Update Saf Data",5);
  trace_event("========= === ======",5);
  sprintf(sLine,"sMti ... ........= [%s] ",sMti);
  trace_event(sLine,5);
  sprintf(sLine,"sStan ... .......= [%s] ",sStan);
  trace_event(sLine,5);
  sprintf(sLine,"sSourceResource.. = [%s] ",sSourceResource);
  trace_event(sLine,5);
  sprintf(sLine,"sResource ........= [%s] ",sResource);
  trace_event(sLine,5);
  sprintf(sLine,"nSendCounter  ... = [%d] ",(ulong)(uint)nSendCounter);
  trace_event(sLine,5);
  uVar1 = GetMaxSafCounter();
  sprintf(sLine,"MaxSendValue .. ..= [%d] ",(ulong)uVar1);
  trace_event(sLine,5);
  iVar2 = GetMaxSafCounter();
  if (nSendCounter < iVar2) {
    UpdateSafData(nIndiceCtx,sMti,'A',sStan,sSourceResource,sResource);
  }
  else {
    DeleteSafData(nIndiceCtx,sPan,sMti,'A',sStan,sSourceResource,sResource,sSlfMti,sSlfResponseCode)
    ;
  }
  trace_event("Start SafTimeOutReceived()",5);
  return extraout_EAX;
}



// WARNING: Unknown calling convention

int SafResponseTraitement
              (int nIndiceCtx,char *sTlvBuffer,char *sSlfMti,char *sSlfResponseCode,
              char *sInternalRespCode)

{
  int iVar1;
  size_t sVar2;
  long lVar3;
  char *pcVar4;
  byte bVar5;
  int nLength;
  char sMti [5];
  char sStan [7];
  char sResource [7];
  char sSrcResource [7];
  char sStandInResource [7];
  char sPan [23];
  char sTlvPrivateBuffer [4097];
  TSTlvPrivate sTlvPrivateInfo;
  TSTlvAutho sTlvInfo;
  
  bVar5 = 0;
  trace_event("Saf Response Received Processing ..",5);
  sStandInResource[4] = '\0';
  sStandInResource[5] = '\0';
  sStan[4] = '\0';
  sStan[5] = '\0';
  sResource[4] = '\0';
  sResource[5] = '\0';
  sPan[0x14] = '\0';
  sPan[0x15] = '\0';
  sSrcResource[4] = '\0';
  sSrcResource[5] = '\0';
  sPan[0] = '\0';
  sPan[1] = '\0';
  sPan[2] = '\0';
  sPan[3] = '\0';
  sPan[4] = '\0';
  sPan[5] = '\0';
  sPan[6] = '\0';
  sPan[7] = '\0';
  sPan[8] = '\0';
  sPan[9] = '\0';
  sPan[10] = '\0';
  sPan[0xb] = '\0';
  sPan[0xc] = '\0';
  sPan[0xd] = '\0';
  sPan[0xe] = '\0';
  sPan[0xf] = '\0';
  sPan[0x10] = '\0';
  sPan[0x11] = '\0';
  sPan[0x12] = '\0';
  sPan[0x13] = '\0';
  sPan[0x16] = '\0';
  sMti[0] = '\0';
  sMti[1] = '\0';
  sMti[2] = '\0';
  sMti[3] = '\0';
  sMti[4] = '\0';
  sStan[0] = '\0';
  sStan[1] = '\0';
  sStan[2] = '\0';
  sStan[3] = '\0';
  sStan[6] = '\0';
  sResource[0] = '\0';
  sResource[1] = '\0';
  sResource[2] = '\0';
  sResource[3] = '\0';
  sResource[6] = '\0';
  sSrcResource[0] = '\0';
  sSrcResource[1] = '\0';
  sSrcResource[2] = '\0';
  sSrcResource[3] = '\0';
  sSrcResource[6] = '\0';
  sStandInResource[0] = '\0';
  sStandInResource[1] = '\0';
  sStandInResource[2] = '\0';
  sStandInResource[3] = '\0';
  sStandInResource[6] = '\0';
  InitTlvAutho(&sTlvInfo);
  AnalyseTlvAutho(sTlvBuffer,&sTlvInfo);
  GetTlvAutho("201",&sTlvInfo,sSrcResource,&nLength);
  GetTlvAutho("200",&sTlvInfo,sResource,&nLength);
  GetTlvAutho("300",&sTlvInfo,sMti,&nLength);
  GetTlvAutho("011",&sTlvInfo,sStan,&nLength);
  GetTlvAutho("002",&sTlvInfo,sPan,&nLength);
  SafResponseReceived(nIndiceCtx,sPan,sMti,sStan,sSrcResource,sResource,sSlfMti,sInternalRespCode);
  PutTlvBuffer("039",sTlvBuffer,sInternalRespCode,3);
  pcVar4 = sTlvPrivateBuffer;
  for (lVar3 = 0x200; lVar3 != 0; lVar3 = lVar3 + -1) {
    pcVar4[0] = '\0';
    pcVar4[1] = '\0';
    pcVar4[2] = '\0';
    pcVar4[3] = '\0';
    pcVar4[4] = '\0';
    pcVar4[5] = '\0';
    pcVar4[6] = '\0';
    pcVar4[7] = '\0';
    pcVar4 = pcVar4 + (ulong)bVar5 * -0x10 + 8;
  }
  *pcVar4 = '\0';
  iVar1 = GetTlvBuffer("061",sTlvBuffer,sTlvPrivateBuffer,&nLength);
  if (iVar1 == 0) {
    AnalyseTlvPrivate(sTlvPrivateBuffer,nLength,&sTlvPrivateInfo);
  }
  else {
    InitTlvPrivate(&sTlvPrivateInfo);
  }
  sVar2 = strlen(sSlfResponseCode);
  PutTlvPrivate("039",&sTlvPrivateInfo,sSlfResponseCode,(int)sVar2);
  nLength = PrivateBuildTlv(sTlvPrivateBuffer,&sTlvPrivateInfo);
  PutTlvBuffer("061",sTlvBuffer,sTlvPrivateBuffer,nLength);
  sStandInResource[0] = '0';
  sStandInResource[1] = '0';
  sStandInResource._2_2_ = (undefined2)sMti._0_4_;
  sStandInResource._4_2_ = SUB42(sMti._0_4_,2);
  PutTlvBuffer("201",sTlvBuffer,sStandInResource,6);
  return 0;
}



// WARNING: Unknown calling convention

int SafTimeOutTraitement(int nIndiceCtx,char *sTlvBuffer)

{
  int nSendCounter;
  int extraout_EAX;
  int nLength;
  char sMti [5];
  char sStan [7];
  char sResource [7];
  char sSrcResource [7];
  char sSendCounter [9];
  char sPan [20];
  TSTlvAutho sTlvInfo;
  
  trace_event("Start SafTimeOutTraitement()",5);
  PrintTlvBuffer(sTlvBuffer);
  sResource[4] = '\0';
  sResource[5] = '\0';
  sSrcResource[4] = '\0';
  sSrcResource[5] = '\0';
  sStan[4] = '\0';
  sStan[5] = '\0';
  sMti[0] = '\0';
  sMti[1] = '\0';
  sMti[2] = '\0';
  sMti[3] = '\0';
  sMti[4] = '\0';
  sStan[0] = '\0';
  sStan[1] = '\0';
  sStan[2] = '\0';
  sStan[3] = '\0';
  sStan[6] = '\0';
  sResource[0] = '\0';
  sResource[1] = '\0';
  sResource[2] = '\0';
  sResource[3] = '\0';
  sResource[6] = '\0';
  sSendCounter[0] = '\0';
  sSendCounter[1] = '\0';
  sSendCounter[2] = '\0';
  sSendCounter[3] = '\0';
  sSendCounter[4] = '\0';
  sSendCounter[5] = '\0';
  sSendCounter[6] = '\0';
  sSendCounter[7] = '\0';
  sSendCounter[8] = '\0';
  sSrcResource[0] = '\0';
  sSrcResource[1] = '\0';
  sSrcResource[2] = '\0';
  sSrcResource[3] = '\0';
  sSrcResource[6] = '\0';
  sPan[0] = '\0';
  sPan[1] = '\0';
  sPan[2] = '\0';
  sPan[3] = '\0';
  sPan[4] = '\0';
  sPan[5] = '\0';
  sPan[6] = '\0';
  sPan[7] = '\0';
  sPan[8] = '\0';
  sPan[9] = '\0';
  sPan[10] = '\0';
  sPan[0xb] = '\0';
  sPan[0xc] = '\0';
  sPan[0xd] = '\0';
  sPan[0xe] = '\0';
  sPan[0xf] = '\0';
  sPan[0x10] = '\0';
  sPan[0x11] = '\0';
  sPan[0x12] = '\0';
  sPan[0x13] = '\0';
  InitTlvAutho(&sTlvInfo);
  AnalyseTlvAutho(sTlvBuffer,&sTlvInfo);
  GetTlvAutho("201",&sTlvInfo,sSrcResource,&nLength);
  GetTlvAutho("200",&sTlvInfo,sResource,&nLength);
  GetTlvAutho("300",&sTlvInfo,sMti,&nLength);
  GetTlvAutho("011",&sTlvInfo,sStan,&nLength);
  GetTlvAutho("071",&sTlvInfo,sSendCounter,&nLength);
  GetTlvAutho("002",&sTlvInfo,sPan,&nLength);
  nSendCounter = atoi(sSendCounter);
  SafTimeOutReceived(nIndiceCtx,sPan,sMti,sStan,sSrcResource,sResource,sMti,"912",nSendCounter);
  trace_event("End   SafTimeOutTraitement()",5);
  return extraout_EAX;
}



// WARNING: Unknown calling convention

int GenerateEchoTest(int P_nIndexCtx)

{
  char sLine [512];
  
  sprintf(sLine,"Start GenerateEchoTest(%d,%d)",P_nIndexCtx,(ulong)(uint)G_sNps.F_nEchoTestPeriod);
  trace_event(sLine,5);
  trace_event("End   GenerateEchoTest()",5);
  return 0;
}



// WARNING: Unknown calling convention

int PrepareNetMsg(int P_nIndexCtx,char *P_szFctCode,TSIsoInfo *P_psIsoInfo)

{
  char sLine [512];
  
  sprintf(sLine,"Start PrepareNetMsg(%d, %s)",P_nIndexCtx,P_szFctCode);
  trace_event(sLine,5);
  trace_event("End   PrepareNetMsg(OK)",5);
  return 0;
}



// WARNING: Unknown calling convention

void * thread_SIG(void *arg)

{
  int iVar1;
  __pid_t _Var2;
  pthread_t __th;
  uint *puVar3;
  long lVar4;
  char *pcVar5;
  int sig_recu;
  char szDetail [80];
  sigset_t set;
  
  pcVar5 = szDetail;
  for (lVar4 = 10; lVar4 != 0; lVar4 = lVar4 + -1) {
    pcVar5[0] = '\0';
    pcVar5[1] = '\0';
    pcVar5[2] = '\0';
    pcVar5[3] = '\0';
    pcVar5[4] = '\0';
    pcVar5[5] = '\0';
    pcVar5[6] = '\0';
    pcVar5[7] = '\0';
    pcVar5 = pcVar5 + 8;
  }
  trace_event(">>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>",4);
  trace_event("> Start thread_SIG >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>",4);
  trace_event(">>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>",4);
  __th = pthread_self();
  pthread_detach(__th);
LAB_0040ae39:
  do {
    sigemptyset((sigset_t *)&set);
    sigaddset((sigset_t *)&set,2);
    sigaddset((sigset_t *)&set,0xd);
    sigaddset((sigset_t *)&set,0x11);
    sigaddset((sigset_t *)&set,0xc);
    pthread_sigmask(0,(sigset_t *)&set,(__sigset_t *)0x0);
    iVar1 = sigwait((sigset_t *)&set,&sig_recu);
    if (iVar1 < 0) {
      puVar3 = (uint *)__errno_location();
      sprintf(szDetail,"SigWait Error : %d",(ulong)*puVar3);
      trace_event(szDetail,1);
    }
    sprintf(szDetail,"Signal Received : %d\n",(ulong)(uint)sig_recu);
    trace_event(szDetail,4);
    if (sig_recu != 0x11) goto LAB_0040ae30;
    do {
      _Var2 = waitpid(-1,(int *)0x0,1);
    } while (0 < _Var2);
  } while (sig_recu != 0xc);
  goto LAB_0040aee9;
LAB_0040ae30:
  if (sig_recu == 0xc) {
LAB_0040aee9:
    trace_event("**************************************************************",0);
    trace_event("***              Message Halt Received ( SIGUSR2 )          **",0);
    trace_event("**************************************************************",0);
    _Var2 = getpid();
    SendStopIsoMessage(G_sNps.F_szRsrcId,_Var2);
  }
  goto LAB_0040ae39;
}



// WARNING: Unknown calling convention

void * thread_signin(void *arg)

{
  int iVar1;
  pthread_t __th;
  undefined4 extraout_var;
  
  trace_event(">>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>",4);
  trace_event("> Start thread_signin>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>",4);
  trace_event(">>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>",4);
  __th = pthread_self();
  pthread_detach(__th);
  AllocateOracleCtx(0xd);
  ConnectOracle(0xd);
  iVar1 = GenerateEchoTest(0xd);
  return (void *)CONCAT44(extraout_var,iVar1);
}



// WARNING: Unknown calling convention

int SendNwMngMsgEcho(int nIndexCtx,char *InfoCode)

{
  int iVar1;
  int iVar2;
  long lVar3;
  TSIsoInfo *IsoInfo_00;
  char *pcVar4;
  byte bVar5;
  time_t tPurgeTime;
  char RefNbr [13];
  char FieldData [256];
  char sLine [512];
  char sBuffer [1024];
  TSIsoInfo IsoInfo;
  TSNpsInfo NpsInfo;
  char sGmtDate [4096];
  TSNodeData Node;
  
  bVar5 = 0;
  trace_event("Start  SendNwMngMsgEcho()",5);
  pcVar4 = sBuffer;
  for (lVar3 = 0x80; lVar3 != 0; lVar3 = lVar3 + -1) {
    pcVar4[0] = '\0';
    pcVar4[1] = '\0';
    pcVar4[2] = '\0';
    pcVar4[3] = '\0';
    pcVar4[4] = '\0';
    pcVar4[5] = '\0';
    pcVar4[6] = '\0';
    pcVar4[7] = '\0';
    pcVar4 = pcVar4 + (ulong)bVar5 * -0x10 + 8;
  }
  RefNbr[0] = '\0';
  RefNbr[1] = '\0';
  RefNbr[2] = '\0';
  RefNbr[3] = '\0';
  RefNbr[4] = '\0';
  RefNbr[5] = '\0';
  RefNbr[6] = '\0';
  RefNbr[7] = '\0';
  RefNbr[8] = '\0';
  RefNbr[9] = '\0';
  RefNbr[10] = '\0';
  RefNbr[0xb] = '\0';
  RefNbr[0xc] = '\0';
  pcVar4 = sGmtDate;
  for (lVar3 = 0x200; lVar3 != 0; lVar3 = lVar3 + -1) {
    pcVar4[0] = '\0';
    pcVar4[1] = '\0';
    pcVar4[2] = '\0';
    pcVar4[3] = '\0';
    pcVar4[4] = '\0';
    pcVar4[5] = '\0';
    pcVar4[6] = '\0';
    pcVar4[7] = '\0';
    pcVar4 = pcVar4 + (ulong)bVar5 * -0x10 + 8;
  }
  InitNpsInfo(&NpsInfo);
  NpsInfo.nMsgType = 800;
  current_gmt_date(sGmtDate);
  AddNpsField(6,&NpsInfo,sGmtDate + 2,10);
  GetInternalStan(nIndexCtx,FieldData);
  AddNpsField(10,&NpsInfo,FieldData,6);
  current_julian_date_qjjj(RefNbr);
  RefNbr[4] = sGmtDate[6];
  RefNbr[5] = sGmtDate[7];
  RefNbr._6_2_ = (undefined2)FieldData._0_4_;
  RefNbr._8_2_ = SUB42(FieldData._0_4_,2);
  RefNbr[10] = FieldData[4];
  RefNbr[0xb] = FieldData[5];
  AddNpsField(0x45,&NpsInfo,InfoCode,3);
  iVar1 = NpsBuildMsg(sBuffer,&NpsInfo,IsoInfo_00);
  InitNodeData(&Node);
  AnalyseIso(sBuffer,&IsoInfo);
  GetSafPurgeTime(&tPurgeTime);
  builtin_strncpy(Node.szFstKey,"0800",4);
  Node.nFstPrvtDataLen = 8;
  Node.tPurgeTime = tPurgeTime;
  Node.szFstKey[4] = FieldData[0];
  Node.szFstKey[5] = FieldData[1];
  Node.szFstKey[6] = FieldData[2];
  Node.szFstKey[7] = FieldData[3];
  Node.szFstKey[8] = FieldData[4];
  Node.szFstKey[9] = FieldData[5];
  builtin_strncpy(Node.sFstPrvtData,"ECHO_NPS",8);
  sprintf(sLine,"Cle de Chainage = %.10s ",Node.szFstKey);
  trace_event(sLine,5);
  iVar2 = InsertRequest('B',&Node);
  if (iVar2 == 0) {
    DumpNps(sBuffer);
    sprintf(sLine,"nFdConnect  = [%d] ",(ulong)(uint)nFdConnect);
    trace_event(sLine,5);
    iVar1 = WriteLineMsg(nFdConnect,sBuffer,iVar1);
    if (iVar1 == 0) {
      trace_event("End  SendNwMngMsgEcho(OK)",5);
      iVar1 = 0;
    }
    else {
      iVar1 = -1;
      trace_event("SendNwMngMsgEcho(NOK): WriteLineMsg() failed",5);
    }
  }
  else {
    iVar1 = -1;
    trace_event("End FCT_NW_MNG_REQ_TO_NW(NOK) ERROR",5);
  }
  return iVar1;
}



// WARNING: Unknown calling convention

int PeriodicalNetMsgManagement(int nIndexCtx,char *sInfoCode,int nTimer)

{
  int iVar1;
  char sLine [512];
  
  sprintf(sLine,"Start PeriodicalNetMsgManagement (%s,%d) ",sInfoCode,nTimer);
  trace_event(sLine,5);
  ResourceStatus[0] = G_sNps.F_szResourceStatus[0];
  ResourceStatus[1] = G_sNps.F_szResourceStatus[1];
  ResourceStatus[2] = G_sNps.F_szResourceStatus[2];
  sprintf(sLine,"nTimer   = [%d] , ResourceStatus = [%s]",(ulong)(uint)nTimer,ResourceStatus);
  trace_event(sLine,5);
  echoTentative = 0;
  do {
    do {
      while( true ) {
        ResourceStatus[0] = G_sNps.F_szResourceStatus[0];
        ResourceStatus[1] = G_sNps.F_szResourceStatus[1];
        ResourceStatus[2] = G_sNps.F_szResourceStatus[2];
        iVar1 = memcmp(ResourceStatus,&DAT_004a2b1c,3);
        if (iVar1 == 0) break;
        sleep(1);
      }
      sleep(nTimer);
      iVar1 = memcmp(ResourceStatus,&DAT_004a2b1c,3);
    } while (iVar1 != 0);
    SendNwMngMsgEcho(nIndexCtx,"301");
  } while( true );
}



// WARNING: Unknown calling convention

void * thread_echo_test(void *arg)

{
  int iVar1;
  pthread_t __th;
  undefined4 extraout_var;
  
  trace_event(">>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>",4);
  trace_event("> Start thread_AUTO_ECHO >>>>>>>>>>>>>>>>>>>>>>>>>>>>>",4);
  trace_event(">>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>",4);
  __th = pthread_self();
  pthread_detach(__th);
  ThreadMaskSignals();
  fprintf(stderr,"\n Thread AUTO_ECHO ID = %d ",__th);
  AllocateOracleCtx(0xd);
  ConnectOracle(0xd);
  iVar1 = PeriodicalNetMsgManagement(0xd,"301",EchoTestTimer);
  return (void *)CONCAT44(extraout_var,iVar1);
}



// WARNING: Unknown calling convention

int SendNwMngMsgKeyExchange(int nIndexCtx,char *InfoCode)

{
  int iVar1;
  int iVar2;
  long lVar3;
  TSIsoInfo *IsoInfo_00;
  char *pcVar4;
  byte bVar5;
  time_t tPurgeTime;
  char RefNbr [13];
  char FieldData [256];
  char sLine [512];
  char sBuffer [1024];
  TSIsoInfo IsoInfo;
  TSNpsInfo NpsInfo;
  char sGmtDate [4096];
  TSNodeData Node;
  
  bVar5 = 0;
  trace_event("Start  SendNwMngMsgKeyExchange()",5);
  pcVar4 = sBuffer;
  for (lVar3 = 0x80; lVar3 != 0; lVar3 = lVar3 + -1) {
    pcVar4[0] = '\0';
    pcVar4[1] = '\0';
    pcVar4[2] = '\0';
    pcVar4[3] = '\0';
    pcVar4[4] = '\0';
    pcVar4[5] = '\0';
    pcVar4[6] = '\0';
    pcVar4[7] = '\0';
    pcVar4 = pcVar4 + (ulong)bVar5 * -0x10 + 8;
  }
  RefNbr[0] = '\0';
  RefNbr[1] = '\0';
  RefNbr[2] = '\0';
  RefNbr[3] = '\0';
  RefNbr[4] = '\0';
  RefNbr[5] = '\0';
  RefNbr[6] = '\0';
  RefNbr[7] = '\0';
  RefNbr[8] = '\0';
  RefNbr[9] = '\0';
  RefNbr[10] = '\0';
  RefNbr[0xb] = '\0';
  RefNbr[0xc] = '\0';
  pcVar4 = sGmtDate;
  for (lVar3 = 0x200; lVar3 != 0; lVar3 = lVar3 + -1) {
    pcVar4[0] = '\0';
    pcVar4[1] = '\0';
    pcVar4[2] = '\0';
    pcVar4[3] = '\0';
    pcVar4[4] = '\0';
    pcVar4[5] = '\0';
    pcVar4[6] = '\0';
    pcVar4[7] = '\0';
    pcVar4 = pcVar4 + (ulong)bVar5 * -0x10 + 8;
  }
  InitNpsInfo(&NpsInfo);
  NpsInfo.nMsgType = 800;
  current_gmt_date(sGmtDate);
  AddNpsField(6,&NpsInfo,sGmtDate + 2,10);
  GetInternalStan(nIndexCtx,FieldData);
  AddNpsField(10,&NpsInfo,FieldData,6);
  current_julian_date_qjjj(RefNbr);
  RefNbr[4] = sGmtDate[6];
  RefNbr[5] = sGmtDate[7];
  RefNbr._6_2_ = (undefined2)FieldData._0_4_;
  RefNbr._8_2_ = SUB42(FieldData._0_4_,2);
  RefNbr[10] = FieldData[4];
  RefNbr[0xb] = FieldData[5];
  AddNpsField(0x45,&NpsInfo,InfoCode,3);
  iVar1 = NpsBuildMsg(sBuffer,&NpsInfo,IsoInfo_00);
  InitNodeData(&Node);
  AnalyseIso(sBuffer,&IsoInfo);
  GetSafPurgeTime(&tPurgeTime);
  builtin_strncpy(Node.sFstPrvtData,"KEY_NPS",7);
  builtin_strncpy(Node.szFstKey,"0800",4);
  Node.nFstPrvtDataLen = 7;
  Node.tPurgeTime = tPurgeTime;
  Node.szFstKey[4] = FieldData[0];
  Node.szFstKey[5] = FieldData[1];
  Node.szFstKey[6] = FieldData[2];
  Node.szFstKey[7] = FieldData[3];
  Node.szFstKey[8] = FieldData[4];
  Node.szFstKey[9] = FieldData[5];
  sprintf(sLine,"Cle de Chainage = %.10s ",Node.szFstKey);
  trace_event(sLine,5);
  iVar2 = InsertRequest('B',&Node);
  if (iVar2 == 0) {
    DumpNps(sBuffer);
    sprintf(sLine,"nFdConnect  = [%d] ",(ulong)(uint)nFdConnect);
    trace_event(sLine,5);
    iVar1 = WriteLineMsg(nFdConnect,sBuffer,iVar1);
    if (iVar1 == 0) {
      trace_event("End  SendNwMngMsgKeyExchange(OK)",5);
      iVar1 = 0;
    }
    else {
      iVar1 = -1;
      trace_event("SendNwMngMsgKeyExchange(NOK): WriteLineMsg() failed",5);
    }
  }
  else {
    iVar1 = -1;
    trace_event("End FCT_NW_MNG_REQ_TO_NW(NOK) ERROR",5);
  }
  return iVar1;
}



// WARNING: Unknown calling convention

int PeriodicalKeyExchange(int nIndexCtx,char *sInfoCode,int nTimer)

{
  int iVar1;
  char sLine [512];
  
  sprintf(sLine,"Start PeriodicalKeyExchange (%s,%d) ",sInfoCode,nTimer);
  trace_event(sLine,5);
  ResourceStatus[0] = G_sNps.F_szResourceStatus[0];
  ResourceStatus[1] = G_sNps.F_szResourceStatus[1];
  ResourceStatus[2] = G_sNps.F_szResourceStatus[2];
  sprintf(sLine,"nTimer   = [%d] , ResourceStatus = [%s]",(ulong)(uint)nTimer,ResourceStatus);
  trace_event(sLine,5);
  do {
    while( true ) {
      ResourceStatus[0] = G_sNps.F_szResourceStatus[0];
      ResourceStatus[1] = G_sNps.F_szResourceStatus[1];
      ResourceStatus[2] = G_sNps.F_szResourceStatus[2];
      iVar1 = memcmp(ResourceStatus,&DAT_004a2b1c,3);
      if (iVar1 != 0) break;
      SendNwMngMsgKeyExchange(nIndexCtx,"162");
      sleep(nTimer);
    }
    sleep(1);
  } while( true );
}



// WARNING: Unknown calling convention

void * thread_key_exchange(void *arg)

{
  int iVar1;
  pthread_t __th;
  undefined4 extraout_var;
  
  trace_event(">>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>",4);
  trace_event("> Start thread_AUTO_KEY_EXCHANGE_NEW_2>>>>>>>>>>>>>>>>>>>>>>>>>>>>>",4);
  trace_event(">>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>",4);
  __th = pthread_self();
  pthread_detach(__th);
  ThreadMaskSignals();
  fprintf(stderr,"\n Thread AUTO_KEY_EXCHANGE = %d ",__th);
  AllocateOracleCtx(0x11);
  ConnectOracle(0x11);
  iVar1 = PeriodicalKeyExchange(0x11,"162",0x15180);
  return (void *)CONCAT44(extraout_var,iVar1);
}



// WARNING: Unknown calling convention

void * thread_CTL(void *arg)

{
  pthread_t __th;
  
  trace_event(">>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>",4);
  trace_event("> Start thread_CTL >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>",4);
  trace_event(">>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>",4);
  __th = pthread_self();
  pthread_detach(__th);
  do {
    pause();
  } while( true );
}



// WARNING: Unknown calling convention

int Buffer_To_Nps(int nIndexCtx,TSNpsInfo *NpsInfo)

{
  int iVar1;
  long lVar2;
  TSIsoInfo *IsoInfo;
  char *pcVar3;
  byte bVar4;
  char BuffSnd [4096];
  
  bVar4 = 0;
  trace_event("Start  Buffer_To_Nps()",5);
  pcVar3 = BuffSnd;
  for (lVar2 = 0x200; lVar2 != 0; lVar2 = lVar2 + -1) {
    *(undefined8 *)pcVar3 = 0;
    pcVar3 = (char *)((long)pcVar3 + ((ulong)bVar4 * -2 + 1) * 8);
  }
  iVar1 = NpsBuildMsg(BuffSnd,NpsInfo,IsoInfo);
  trace_event("DATA SENT :",4);
  DumpNps(BuffSnd);
  iVar1 = WriteLineMsg(nFdConnect,BuffSnd,iVar1);
  if (iVar1 == 0) {
    trace_event("End  Buffer_To_Nps()",5);
    iVar1 = 0;
  }
  else {
    iVar1 = -1;
    trace_event("End Buffer_To_Nps(): Line Close Forced ",1);
    StopCltCom(nFdConnect);
    trace_event("End Buffer_To_Nps():WriteLineMsg() failed",1);
  }
  return iVar1;
}



// WARNING: Unknown calling convention

int ConvNpsRespCodeToIso(char *pNpsRespCode,char *pIsoRespCode)

{
  int iVar1;
  char vTmpRespCode [2];
  char sLine [512];
  
  sprintf(sLine,"START   ConvNpsRespCodeToIso( Input  : %.2s )",pNpsRespCode);
  trace_event(sLine,5);
  vTmpRespCode = *(char (*) [2])pNpsRespCode;
  iVar1 = memcmp(vTmpRespCode,"00",2);
  if (iVar1 == 0) goto LAB_0040c4e0;
  iVar1 = memcmp(vTmpRespCode,"01",2);
  if (iVar1 != 0) {
    iVar1 = memcmp(vTmpRespCode,&DAT_004a7e3d,2);
    if (iVar1 != 0) {
      iVar1 = memcmp(vTmpRespCode,&DAT_004d1dfe,2);
      if (iVar1 == 0) {
        pIsoRespCode[2] = '9';
        pIsoRespCode[0] = '1';
        pIsoRespCode[1] = '0';
        goto LAB_0040c4a9;
      }
      iVar1 = memcmp(vTmpRespCode,&DAT_004d1e2b,2);
      if (iVar1 != 0) {
        iVar1 = memcmp(vTmpRespCode,&DAT_004d1e47,2);
        if (iVar1 == 0) goto LAB_0040c528;
        iVar1 = memcmp(vTmpRespCode,&DAT_004d1e6a,2);
        if (iVar1 == 0) goto LAB_0040c4f8;
        iVar1 = memcmp(vTmpRespCode,&DAT_004d1e8d,2);
        if (iVar1 != 0) {
          iVar1 = memcmp(vTmpRespCode,&DAT_004cd00c,2);
          if (iVar1 == 0) {
            pIsoRespCode[2] = '1';
            pIsoRespCode[0] = '0';
            pIsoRespCode[1] = '0';
            goto LAB_0040c4a9;
          }
          iVar1 = memcmp(vTmpRespCode,&DAT_004d1ecc,2);
          if (iVar1 == 0) goto LAB_0040c528;
          iVar1 = memcmp(vTmpRespCode,&DAT_004d1ee1,2);
          if (iVar1 != 0) {
            iVar1 = memcmp(vTmpRespCode,&DAT_004d1efb,2);
            if (iVar1 != 0) {
              iVar1 = memcmp(vTmpRespCode,&DAT_004d1f75,2);
              if (iVar1 == 0) {
LAB_0040c558:
                pIsoRespCode[2] = '2';
                pIsoRespCode[0] = '9';
                pIsoRespCode[1] = '0';
                goto LAB_0040c4a9;
              }
              iVar1 = memcmp(vTmpRespCode,&DAT_004d1fb6,2);
              if (iVar1 == 0) {
LAB_0040c590:
                pIsoRespCode[2] = '0';
                pIsoRespCode[0] = '1';
                pIsoRespCode[1] = '1';
                goto LAB_0040c4a9;
              }
              iVar1 = memcmp(vTmpRespCode,&DAT_004a66ff,2);
              if (iVar1 == 0) {
                pIsoRespCode[2] = '8';
                pIsoRespCode[0] = '1';
                pIsoRespCode[1] = '1';
                goto LAB_0040c4a9;
              }
              iVar1 = memcmp(vTmpRespCode,&DAT_004a6704,2);
              if (iVar1 == 0) {
LAB_0040c5ba:
                pIsoRespCode[2] = '2';
                pIsoRespCode[0] = '9';
                pIsoRespCode[1] = '1';
                goto LAB_0040c4a9;
              }
              iVar1 = memcmp(vTmpRespCode,&DAT_004a6709,2);
              if (iVar1 == 0) {
                pIsoRespCode[2] = '4';
                pIsoRespCode[0] = '0';
                pIsoRespCode[1] = '0';
                goto LAB_0040c4a9;
              }
              iVar1 = memcmp(vTmpRespCode,&DAT_004a670e,2);
              if (iVar1 != 0) {
                iVar1 = memcmp(vTmpRespCode,&DAT_004a6713,2);
                if (iVar1 != 0) {
                  iVar1 = memcmp(vTmpRespCode,&DAT_004a6718,2);
                  if (iVar1 != 0) {
                    iVar1 = memcmp(vTmpRespCode,&DAT_004a671d,2);
                    if (iVar1 != 0) {
                      iVar1 = memcmp(vTmpRespCode,&DAT_004c9c2d,2);
                      if (iVar1 != 0) {
                        iVar1 = memcmp(vTmpRespCode,&DAT_004a9052,2);
                        if (iVar1 == 0) goto LAB_0040c4f8;
                        iVar1 = memcmp(vTmpRespCode,&DAT_004c9c59,2);
                        if (iVar1 != 0) {
                          iVar1 = memcmp(vTmpRespCode,&DAT_004a9091,2);
                          if (iVar1 == 0) {
                            pIsoRespCode[0] = '3';
                            pIsoRespCode[1] = '0';
                            pIsoRespCode[2] = '1';
                            goto LAB_0040c4a9;
                          }
                          iVar1 = memcmp(vTmpRespCode,&DAT_004a7e20,2);
                          if (iVar1 == 0) {
                            pIsoRespCode[0] = '3';
                            pIsoRespCode[1] = '0';
                            pIsoRespCode[2] = '2';
                            goto LAB_0040c4a9;
                          }
                          iVar1 = memcmp(vTmpRespCode,&DAT_004d4402,2);
                          if (iVar1 == 0) {
LAB_0040c608:
                            pIsoRespCode[0] = '3';
                            pIsoRespCode[1] = '0';
                            pIsoRespCode[2] = '3';
                            goto LAB_0040c4a9;
                          }
                          iVar1 = memcmp(vTmpRespCode,&DAT_004c9c31,2);
                          if (iVar1 == 0) {
                            pIsoRespCode[0] = '3';
                            pIsoRespCode[1] = '9';
                            pIsoRespCode[2] = '9';
                            goto LAB_0040c4a9;
                          }
                          iVar1 = memcmp(vTmpRespCode,&DAT_004c9c1d,2);
                          if (iVar1 == 0) {
                            pIsoRespCode[0] = '3';
                            pIsoRespCode[1] = '0';
                            pIsoRespCode[2] = '5';
                            goto LAB_0040c4a9;
                          }
                          iVar1 = memcmp(vTmpRespCode,&DAT_004d443d,2);
                          if (iVar1 == 0) goto LAB_0040c4f8;
                          iVar1 = memcmp(vTmpRespCode,&DAT_004c759e,2);
                          if (iVar1 == 0) {
                            pIsoRespCode[0] = '3';
                            pIsoRespCode[1] = '0';
                            pIsoRespCode[2] = '7';
                            goto LAB_0040c4a9;
                          }
                          iVar1 = memcmp(vTmpRespCode,&DAT_004c9c21,2);
                          if (iVar1 != 0) {
                            iVar1 = memcmp(vTmpRespCode,&DAT_004a9095,2);
                            if (iVar1 != 0) {
                              iVar1 = memcmp(vTmpRespCode,&DAT_004d448b,2);
                              if (iVar1 == 0) {
LAB_0040c662:
                                pIsoRespCode[0] = '1';
                                pIsoRespCode[1] = '0';
                                pIsoRespCode[2] = '1';
                                goto LAB_0040c4a9;
                              }
                              iVar1 = memcmp(vTmpRespCode,&DAT_004c9c29,2);
                              if (iVar1 == 0) {
LAB_0040c650:
                                pIsoRespCode[0] = '1';
                                pIsoRespCode[1] = '0';
                                pIsoRespCode[2] = '2';
                                goto LAB_0040c4a9;
                              }
                              iVar1 = memcmp(vTmpRespCode,&DAT_004c759a,2);
                              if (iVar1 == 0) goto LAB_0040c498;
                              iVar1 = memcmp(vTmpRespCode,&DAT_004a9099,2);
                              if (iVar1 != 0) {
                                iVar1 = memcmp(vTmpRespCode,&DAT_004a904e,2);
                                if (iVar1 != 0) {
                                  iVar1 = memcmp(vTmpRespCode,&DAT_004a7da4,2);
                                  if (iVar1 == 0) {
                                    pIsoRespCode[0] = '2';
                                    pIsoRespCode[1] = '0';
                                    pIsoRespCode[2] = '6';
                                    goto LAB_0040c4a9;
                                  }
                                  iVar1 = memcmp(vTmpRespCode,&DAT_004a3182,2);
                                  if (iVar1 != 0) {
                                    iVar1 = memcmp(vTmpRespCode,"40",2);
                                    if (iVar1 == 0) {
                                      pIsoRespCode[0] = '1';
                                      pIsoRespCode[1] = '1';
                                      pIsoRespCode[2] = '5';
                                      goto LAB_0040c4a9;
                                    }
                                    iVar1 = memcmp(vTmpRespCode,&DAT_004a8fd3,2);
                                    if (iVar1 == 0) {
                                      pIsoRespCode[0] = '2';
                                      pIsoRespCode[1] = '0';
                                      pIsoRespCode[2] = '8';
                                      goto LAB_0040c4a9;
                                    }
                                    iVar1 = memcmp(vTmpRespCode,&DAT_004d44e6,2);
                                    if (iVar1 != 0) {
                                      iVar1 = memcmp(vTmpRespCode,&DAT_004a554a,2);
                                      if (iVar1 == 0) {
                                        pIsoRespCode[0] = '2';
                                        pIsoRespCode[1] = '0';
                                        pIsoRespCode[2] = '9';
                                        goto LAB_0040c4a9;
                                      }
                                      iVar1 = memcmp(vTmpRespCode,&DAT_004a5543,2);
                                      if (iVar1 != 0) {
                                        iVar1 = memcmp(vTmpRespCode,&DAT_004c9d8f,2);
                                        if (iVar1 != 0) {
                                          iVar1 = memcmp(vTmpRespCode,&DAT_004a90d4,2);
                                          if (iVar1 != 0) {
                                            iVar1 = memcmp(vTmpRespCode,"47",2);
                                            if (iVar1 != 0) {
                                              iVar1 = memcmp(vTmpRespCode,&DAT_004a909d,2);
                                              if (iVar1 != 0) {
                                                iVar1 = memcmp(vTmpRespCode,&DAT_004a9056,2);
                                                if (iVar1 != 0) {
                                                  iVar1 = memcmp(vTmpRespCode,&DAT_004a4d27,2);
                                                  if (iVar1 != 0) {
                                                    iVar1 = memcmp(vTmpRespCode,&DAT_004a908d,2);
                                                    if (iVar1 == 0) {
                                                      pIsoRespCode[0] = '1';
                                                      pIsoRespCode[1] = '1';
                                                      pIsoRespCode[2] = '6';
                                                      goto LAB_0040c4a9;
                                                    }
                                                    iVar1 = memcmp(vTmpRespCode,&DAT_004c764a,2);
                                                    if (iVar1 != 0) {
                                                      iVar1 = memcmp(vTmpRespCode,&DAT_004a90d8,2);
                                                      if (iVar1 != 0) {
                                                        iVar1 = memcmp(vTmpRespCode,&DAT_004a90e8,2)
                                                        ;
                                                        if (iVar1 == 0) goto LAB_0040c662;
                                                        iVar1 = memcmp(vTmpRespCode,"55",2);
                                                        if (iVar1 == 0) {
                                                          pIsoRespCode[0] = '1';
                                                          pIsoRespCode[1] = '1';
                                                          pIsoRespCode[2] = '7';
                                                          goto LAB_0040c4a9;
                                                        }
                                                        iVar1 = memcmp(vTmpRespCode,&DAT_004d45aa,2)
                                                        ;
                                                        if (iVar1 == 0) {
                                                          pIsoRespCode[0] = '1';
                                                          pIsoRespCode[1] = '1';
                                                          pIsoRespCode[2] = '1';
                                                          goto LAB_0040c4a9;
                                                        }
                                                        iVar1 = memcmp(vTmpRespCode,&DAT_004d6e34,2)
                                                        ;
                                                        if (iVar1 == 0) {
                                                          pIsoRespCode[0] = '1';
                                                          pIsoRespCode[1] = '1';
                                                          pIsoRespCode[2] = '9';
                                                          goto LAB_0040c4a9;
                                                        }
                                                        iVar1 = memcmp(vTmpRespCode,&DAT_004d45cf,2)
                                                        ;
                                                        if (iVar1 == 0) {
                                                          pIsoRespCode[0] = '1';
                                                          pIsoRespCode[1] = '2';
                                                          pIsoRespCode[2] = '0';
                                                          goto LAB_0040c4a9;
                                                        }
                                                        iVar1 = memcmp(vTmpRespCode,&DAT_004d45e2,2)
                                                        ;
                                                        if (iVar1 == 0) goto LAB_0040c650;
                                                        iVar1 = memcmp(vTmpRespCode,&DAT_004aac27,2)
                                                        ;
                                                        if (iVar1 != 0) {
                                                          iVar1 = memcmp(vTmpRespCode,&DAT_004a44e5,
                                                                         2);
                                                          if (iVar1 == 0) {
LAB_0040c728:
                                                            pIsoRespCode[0] = '1';
                                                            pIsoRespCode[1] = '2';
                                                            pIsoRespCode[2] = '1';
                                                            goto LAB_0040c4a9;
                                                          }
                                                          iVar1 = memcmp(vTmpRespCode,&DAT_004d7d79,
                                                                         2);
                                                          if (iVar1 != 0) {
                                                            iVar1 = memcmp(vTmpRespCode,
                                                                           &DAT_004a90dc,2);
                                                            if (iVar1 == 0) {
                                                              pIsoRespCode[0] = '1';
                                                              pIsoRespCode[1] = '2';
                                                              pIsoRespCode[2] = '2';
                                                              goto LAB_0040c4a9;
                                                            }
                                                            iVar1 = memcmp(vTmpRespCode,"64",2);
                                                            if (iVar1 == 0) goto LAB_0040c590;
                                                            iVar1 = memcmp(vTmpRespCode,
                                                                           &DAT_004d4635,2);
                                                            if (iVar1 == 0) {
                                                              pIsoRespCode[0] = '1';
                                                              pIsoRespCode[1] = '2';
                                                              pIsoRespCode[2] = '3';
                                                              goto LAB_0040c4a9;
                                                            }
                                                            iVar1 = memcmp(vTmpRespCode,
                                                                           &DAT_004d464d,2);
                                                            if (iVar1 != 0) {
                                                              iVar1 = memcmp(vTmpRespCode,
                                                                             &DAT_004d4662,2);
                                                              if (iVar1 != 0) {
                                                                iVar1 = memcmp(vTmpRespCode,
                                                                               &DAT_004d467a,2);
                                                                if (iVar1 != 0) {
                                                                  iVar1 = memcmp(vTmpRespCode,
                                                                                 &DAT_004d4691,2);
                                                                  if (iVar1 != 0) {
                                                                    iVar1 = memcmp(vTmpRespCode,
                                                                                   &DAT_004d46a4,2);
                                                                    if (iVar1 != 0) {
                                                                      iVar1 = memcmp(vTmpRespCode,
                                                                                     &DAT_004a4327,2
                                                                                    );
                                                                      if (iVar1 != 0) {
                                                                        iVar1 = memcmp(vTmpRespCode,
                                                                                       &DAT_004a90e0
                                                                                       ,2);
                                                                        if (iVar1 != 0) {
                                                                          iVar1 = memcmp(
                                                  vTmpRespCode,&DAT_004a90e4,2);
                                                  if (iVar1 != 0) {
                                                    iVar1 = memcmp(vTmpRespCode,&DAT_004d46de,2);
                                                    if (iVar1 != 0) {
                                                      iVar1 = memcmp(vTmpRespCode,&DAT_004d46f5,2);
                                                      if (iVar1 == 0) {
                                                        pIsoRespCode[0] = '1';
                                                        pIsoRespCode[1] = '0';
                                                        pIsoRespCode[2] = '6';
                                                        goto LAB_0040c4a9;
                                                      }
                                                      iVar1 = memcmp(vTmpRespCode,&DAT_004d4707,2);
                                                      if (iVar1 != 0) {
                                                        iVar1 = memcmp(vTmpRespCode,&DAT_004d471d,2)
                                                        ;
                                                        if (iVar1 == 0) {
                                                          pIsoRespCode[0] = '3';
                                                          pIsoRespCode[1] = '0';
                                                          pIsoRespCode[2] = '4';
                                                          goto LAB_0040c4a9;
                                                        }
                                                        iVar1 = memcmp(vTmpRespCode,&DAT_004d4731,2)
                                                        ;
                                                        if (iVar1 != 0) {
                                                          iVar1 = memcmp(vTmpRespCode,&DAT_004d4749,
                                                                         2);
                                                          if (iVar1 != 0) {
                                                            iVar1 = memcmp(vTmpRespCode,
                                                                           &DAT_004d475e,2);
                                                            if (iVar1 != 0) {
                                                              iVar1 = memcmp(vTmpRespCode,
                                                                             &DAT_004d476f,2);
                                                              if (iVar1 != 0) {
                                                                iVar1 = memcmp(vTmpRespCode,
                                                                               &DAT_004d4788,2);
                                                                if (iVar1 != 0) {
                                                                  iVar1 = memcmp(vTmpRespCode,
                                                                                 &DAT_004d479b,2);
                                                                  if (iVar1 != 0) {
                                                                    iVar1 = memcmp(vTmpRespCode,
                                                                                   &DAT_004d47b2,2);
                                                                    if (iVar1 != 0) {
                                                                      iVar1 = memcmp(vTmpRespCode,
                                                                                     &DAT_004c7452,2
                                                                                    );
                                                                      if (iVar1 != 0) {
                                                                        iVar1 = memcmp(vTmpRespCode,
                                                                                       &DAT_004d47d1
                                                                                       ,2);
                                                                        if (iVar1 == 0) {
                                                                          pIsoRespCode[0] = '9';
                                                                          pIsoRespCode[1] = '9';
                                                                          pIsoRespCode[2] = '3';
                                                                          goto LAB_0040c4a9;
                                                                        }
                                                                        iVar1 = memcmp(vTmpRespCode,
                                                                                       &DAT_004d47e8
                                                                                       ,2);
                                                                        if (iVar1 != 0) {
                                                                          iVar1 = memcmp(
                                                  vTmpRespCode,"88",2);
                                                  if (iVar1 != 0) {
                                                    iVar1 = memcmp(vTmpRespCode,&DAT_004d9b69,2);
                                                    if (iVar1 != 0) {
                                                      iVar1 = memcmp(vTmpRespCode,&DAT_004d4825,2);
                                                      if (iVar1 != 0) {
                                                        iVar1 = memcmp(vTmpRespCode,&DAT_004aac5d,2)
                                                        ;
                                                        if (iVar1 == 0) goto LAB_0040c5ba;
                                                        iVar1 = memcmp(vTmpRespCode,&DAT_004d484c,2)
                                                        ;
                                                        if (iVar1 == 0) goto LAB_0040c558;
                                                        iVar1 = memcmp(vTmpRespCode,"93",2);
                                                        if (iVar1 != 0) {
                                                          iVar1 = memcmp(vTmpRespCode,"94",2);
                                                          if (iVar1 == 0) goto LAB_0040c608;
                                                          iVar1 = memcmp(vTmpRespCode,&DAT_004a4d63,
                                                                         2);
                                                          if (iVar1 == 0) {
                                                            pIsoRespCode[0] = '5';
                                                            pIsoRespCode[1] = '0';
                                                            pIsoRespCode[2] = '1';
                                                            goto LAB_0040c4a9;
                                                          }
                                                          iVar1 = memcmp(vTmpRespCode,&DAT_004a90ec,
                                                                         2);
                                                          if (iVar1 == 0) goto LAB_0040c4f8;
                                                          iVar1 = memcmp(vTmpRespCode,&DAT_004d48ad,
                                                                         2);
                                                          if (iVar1 != 0) {
                                                            iVar1 = memcmp(vTmpRespCode,
                                                                           &DAT_004d48b7,2);
                                                            if (iVar1 == 0) goto LAB_0040c728;
                                                            iVar1 = memcmp(vTmpRespCode,
                                                                           &DAT_004d48c9,2);
                                                            if (iVar1 != 0) {
                                                              iVar1 = memcmp(vTmpRespCode,
                                                                             &DAT_004a4cee,2);
                                                              if (iVar1 != 0) {
                                                                iVar1 = memcmp(vTmpRespCode,
                                                                               &DAT_004a4cf1,2);
                                                                if (iVar1 != 0) {
                                                                  pIsoRespCode[0] = '9';
                                                                  pIsoRespCode[1] = '9';
                                                                  pIsoRespCode[2] = '5';
                                                                  goto LAB_0040c4a9;
                                                                }
                                                              }
                                                              goto LAB_0040c4f8;
                                                            }
                                                          }
                                                        }
                                                      }
                                                    }
                                                  }
                                                  }
                                                  }
                                                  }
                                                  }
                                                  }
                                                  }
                                                  }
                                                  }
                                                  }
                                                  }
                                                  }
                                                  }
                                                  }
                                                  }
                                                  }
                                                  }
                                                  }
                                                  }
                                                  }
                                                  }
                                                  }
                                                  }
                                                  }
                                                  goto LAB_0040c528;
                                                  }
                                                }
                                              }
                                            }
                                          }
                                        }
LAB_0040c4f8:
                                        pIsoRespCode[2] = '9';
                                        pIsoRespCode[0] = '9';
                                        pIsoRespCode[1] = '0';
                                        goto LAB_0040c4a9;
                                      }
                                    }
                                  }
                                }
                              }
                            }
                          }
                        }
                      }
                    }
                  }
                }
              }
LAB_0040c528:
              pIsoRespCode[2] = '0';
              pIsoRespCode[0] = '1';
              pIsoRespCode[1] = '0';
              goto LAB_0040c4a9;
            }
          }
LAB_0040c4e0:
          pIsoRespCode[2] = '0';
          pIsoRespCode[0] = '0';
          pIsoRespCode[1] = '0';
          goto LAB_0040c4a9;
        }
      }
      pIsoRespCode[2] = '0';
      pIsoRespCode[0] = '2';
      pIsoRespCode[1] = '0';
      goto LAB_0040c4a9;
    }
  }
LAB_0040c498:
  pIsoRespCode[2] = '7';
  pIsoRespCode[0] = '1';
  pIsoRespCode[1] = '0';
LAB_0040c4a9:
  sprintf(sLine,"END     ConvNpsRespCodeToIso( Output : %.3s )",pIsoRespCode);
  trace_event(sLine,5);
  return 0;
}



// WARNING: Unknown calling convention

int ConvNpsToISO(int nIndexCtx,TSNpsInfo *NpsInfo,TSIsoInfo *IsoInfo)

{
  undefined6 uVar1;
  int iVar2;
  uint uVar3;
  uint uVar4;
  int iVar5;
  int iVar6;
  uint *puVar7;
  long lVar8;
  TSTlvAutho *pTVar9;
  TSTlvAutho *pTVar10;
  uint *puVar11;
  TSTransType *pTVar12;
  char *pcVar13;
  undefined8 uVar14;
  undefined8 uVar15;
  bool bVar16;
  byte bVar17;
  char sRespCodeTmp [3];
  int tmpFieldLen;
  char sFctCodeTmp [4];
  char sAcqCountryCode [4];
  char szRespCode [4];
  char sAcqCode [4];
  char PosData [4];
  int nLen;
  int tmpFieldLen1;
  char vMsgTypeSz [5];
  char sMerType [5];
  char sStan [7];
  char szProcCode [7];
  char szOrgnlAuthId [7];
  char sPid [9];
  char sPurgeTime [10];
  char szExpiryDate [10];
  char szServiceCode [10];
  char szPvv [10];
  char szCvv [10];
  char sSecurityData [11];
  char sDateTmp [12];
  char vAcqBank [12];
  char sPosDataTmp [13];
  char szOrgnlRefNbr [13];
  char sProcCode [19];
  char szCardNbr [24];
  char sCardNbr [25];
  char szOrgnlData [40];
  char IsoOrigData [41];
  char sTrackII [41];
  char NpsOrigData [43];
  char szTrack2 [56];
  char tmpField [256];
  char tmpField1 [256];
  char sub_data [256];
  char sLine [512];
  TSNpsF127Info msgF127Info;
  TSSubTagNps tlvInfoSub;
  char sTlvBuffer [4097];
  TSTlvPrivate TlvInfo;
  TSTlvAutho sTlvInfo;
  
  bVar17 = 0;
  szExpiryDate[8] = '\0';
  szExpiryDate[9] = '\0';
  pcVar13 = sLine;
  for (lVar8 = 0x40; lVar8 != 0; lVar8 = lVar8 + -1) {
    pcVar13[0] = '\0';
    pcVar13[1] = '\0';
    pcVar13[2] = '\0';
    pcVar13[3] = '\0';
    pcVar13[4] = '\0';
    pcVar13[5] = '\0';
    pcVar13[6] = '\0';
    pcVar13[7] = '\0';
    pcVar13 = pcVar13 + 8;
  }
  szServiceCode[8] = '\0';
  szServiceCode[9] = '\0';
  szPvv[8] = '\0';
  szPvv[9] = '\0';
  szCvv[8] = '\0';
  szCvv[9] = '\0';
  vMsgTypeSz[0] = '\0';
  vMsgTypeSz[1] = '\0';
  vMsgTypeSz[2] = '\0';
  vMsgTypeSz[3] = '\0';
  vMsgTypeSz[4] = '\0';
  szCardNbr[0] = '\0';
  szCardNbr[1] = '\0';
  szCardNbr[2] = '\0';
  szCardNbr[3] = '\0';
  szCardNbr[4] = '\0';
  szCardNbr[5] = '\0';
  szCardNbr[6] = '\0';
  szCardNbr[7] = '\0';
  pcVar13 = szTrack2;
  for (lVar8 = 7; lVar8 != 0; lVar8 = lVar8 + -1) {
    pcVar13[0] = '\0';
    pcVar13[1] = '\0';
    pcVar13[2] = '\0';
    pcVar13[3] = '\0';
    pcVar13[4] = '\0';
    pcVar13[5] = '\0';
    pcVar13[6] = '\0';
    pcVar13[7] = '\0';
    pcVar13 = pcVar13 + 8;
  }
  szCardNbr[8] = '\0';
  szCardNbr[9] = '\0';
  szCardNbr[10] = '\0';
  szCardNbr[0xb] = '\0';
  szCardNbr[0xc] = '\0';
  szCardNbr[0xd] = '\0';
  szCardNbr[0xe] = '\0';
  szCardNbr[0xf] = '\0';
  szCardNbr[0x10] = '\0';
  szCardNbr[0x11] = '\0';
  szCardNbr[0x12] = '\0';
  szCardNbr[0x13] = '\0';
  szCardNbr[0x14] = '\0';
  szCardNbr[0x15] = '\0';
  szCardNbr[0x16] = '\0';
  szCardNbr[0x17] = '\0';
  szExpiryDate[0] = '\0';
  szExpiryDate[1] = '\0';
  szExpiryDate[2] = '\0';
  szExpiryDate[3] = '\0';
  szExpiryDate[4] = '\0';
  szExpiryDate[5] = '\0';
  szExpiryDate[6] = '\0';
  szExpiryDate[7] = '\0';
  szServiceCode[0] = '\0';
  szServiceCode[1] = '\0';
  szServiceCode[2] = '\0';
  szServiceCode[3] = '\0';
  szServiceCode[4] = '\0';
  szServiceCode[5] = '\0';
  szServiceCode[6] = '\0';
  szServiceCode[7] = '\0';
  szPvv[0] = '\0';
  szPvv[1] = '\0';
  szPvv[2] = '\0';
  szPvv[3] = '\0';
  szPvv[4] = '\0';
  szPvv[5] = '\0';
  szPvv[6] = '\0';
  szPvv[7] = '\0';
  szCvv[0] = '\0';
  szCvv[1] = '\0';
  szCvv[2] = '\0';
  szCvv[3] = '\0';
  szCvv[4] = '\0';
  szCvv[5] = '\0';
  szCvv[6] = '\0';
  szCvv[7] = '\0';
  pcVar13 = NpsOrigData;
  for (lVar8 = 5; lVar8 != 0; lVar8 = lVar8 + -1) {
    pcVar13[0] = '\0';
    pcVar13[1] = '\0';
    pcVar13[2] = '\0';
    pcVar13[3] = '\0';
    pcVar13[4] = '\0';
    pcVar13[5] = '\0';
    pcVar13[6] = '\0';
    pcVar13[7] = '\0';
    pcVar13 = pcVar13 + 8;
  }
  pcVar13[0] = '\0';
  pcVar13[1] = '\0';
  pcVar13[2] = '\0';
  puVar7 = (uint *)IsoOrigData;
  for (lVar8 = 5; lVar8 != 0; lVar8 = lVar8 + -1) {
    puVar7[0] = 0;
    puVar7[1] = 0;
    puVar7 = puVar7 + 2;
  }
  sStan[4] = '\0';
  sStan[5] = '\0';
  szOrgnlAuthId[4] = '\0';
  szOrgnlAuthId[5] = '\0';
  sStan[0] = '\0';
  sStan[1] = '\0';
  sStan[2] = '\0';
  sStan[3] = '\0';
  sStan[6] = '\0';
  szProcCode[0] = '\0';
  szProcCode[1] = '\0';
  szProcCode[2] = '\0';
  szProcCode[3] = '\0';
  szProcCode[6] = '\0';
  szRespCode[0] = '\0';
  szRespCode[1] = '\0';
  szRespCode[2] = '\0';
  szRespCode[3] = '\0';
  szOrgnlData[0] = '\0';
  szOrgnlData[1] = '\0';
  szOrgnlData[2] = '\0';
  szOrgnlData[3] = '\0';
  szOrgnlData[4] = '\0';
  szOrgnlData[5] = '\0';
  szOrgnlData[6] = '\0';
  szOrgnlData[7] = '\0';
  *(char *)puVar7 = '\0';
  szProcCode[4] = '\0';
  szProcCode[5] = '\0';
  pcVar13 = sTlvBuffer;
  for (lVar8 = 0x200; lVar8 != 0; lVar8 = lVar8 + -1) {
    pcVar13[0] = '\0';
    pcVar13[1] = '\0';
    pcVar13[2] = '\0';
    pcVar13[3] = '\0';
    pcVar13[4] = '\0';
    pcVar13[5] = '\0';
    pcVar13[6] = '\0';
    pcVar13[7] = '\0';
    pcVar13 = pcVar13 + 8;
  }
  szOrgnlData[8] = '\0';
  szOrgnlData[9] = '\0';
  szOrgnlData[10] = '\0';
  szOrgnlData[0xb] = '\0';
  szOrgnlData[0xc] = '\0';
  szOrgnlData[0xd] = '\0';
  szOrgnlData[0xe] = '\0';
  szOrgnlData[0xf] = '\0';
  szOrgnlData[0x10] = '\0';
  szOrgnlData[0x11] = '\0';
  szOrgnlData[0x12] = '\0';
  szOrgnlData[0x13] = '\0';
  szOrgnlData[0x14] = '\0';
  szOrgnlData[0x15] = '\0';
  szOrgnlData[0x16] = '\0';
  szOrgnlData[0x17] = '\0';
  szOrgnlData[0x18] = '\0';
  szOrgnlData[0x19] = '\0';
  szOrgnlData[0x1a] = '\0';
  szOrgnlData[0x1b] = '\0';
  szOrgnlData[0x1c] = '\0';
  szOrgnlData[0x1d] = '\0';
  szOrgnlData[0x1e] = '\0';
  szOrgnlData[0x1f] = '\0';
  szOrgnlData[0x20] = '\0';
  szOrgnlData[0x21] = '\0';
  szOrgnlData[0x22] = '\0';
  szOrgnlData[0x23] = '\0';
  szOrgnlData[0x24] = '\0';
  szOrgnlData[0x25] = '\0';
  szOrgnlData[0x26] = '\0';
  szOrgnlData[0x27] = '\0';
  szOrgnlRefNbr[0] = '\0';
  szOrgnlRefNbr[1] = '\0';
  szOrgnlRefNbr[2] = '\0';
  szOrgnlRefNbr[3] = '\0';
  szOrgnlRefNbr[4] = '\0';
  szOrgnlRefNbr[5] = '\0';
  szOrgnlRefNbr[6] = '\0';
  szOrgnlRefNbr[7] = '\0';
  szOrgnlRefNbr[8] = '\0';
  szOrgnlRefNbr[9] = '\0';
  szOrgnlRefNbr[10] = '\0';
  szOrgnlRefNbr[0xb] = '\0';
  szOrgnlRefNbr[0xc] = '\0';
  szOrgnlAuthId[0] = '\0';
  szOrgnlAuthId[1] = '\0';
  szOrgnlAuthId[2] = '\0';
  szOrgnlAuthId[3] = '\0';
  szOrgnlAuthId[6] = '\0';
  *pcVar13 = '\0';
  puVar7 = (uint *)tmpField;
  for (lVar8 = 0x20; lVar8 != 0; lVar8 = lVar8 + -1) {
    puVar7[0] = 0;
    puVar7[1] = 0;
    puVar7 = puVar7 + 2;
  }
  sDateTmp[0] = '\0';
  sDateTmp[1] = '\0';
  sDateTmp[2] = '\0';
  sDateTmp[3] = '\0';
  sDateTmp[4] = '\0';
  sDateTmp[5] = '\0';
  sDateTmp[6] = '\0';
  sDateTmp[7] = '\0';
  sDateTmp[8] = '\0';
  sDateTmp[9] = '\0';
  sDateTmp[10] = '\0';
  sDateTmp[0xb] = '\0';
  sPosDataTmp[0] = '\0';
  sPosDataTmp[1] = '\0';
  sPosDataTmp[2] = '\0';
  sPosDataTmp[3] = '\0';
  sPosDataTmp[4] = '\0';
  sPosDataTmp[5] = '\0';
  sPosDataTmp[6] = '\0';
  sPosDataTmp[7] = '\0';
  sPosDataTmp[8] = '\0';
  sPosDataTmp[9] = '\0';
  sPosDataTmp[10] = '\0';
  sPosDataTmp[0xb] = '\0';
  puVar7 = (uint *)tmpField1;
  for (lVar8 = 0x20; lVar8 != 0; lVar8 = lVar8 + -1) {
    puVar7[0] = 0;
    puVar7[1] = 0;
    puVar7 = puVar7 + 2;
  }
  sPosDataTmp[0xc] = '\0';
  sProcCode[0x10] = '\0';
  sProcCode[0x11] = '\0';
  sRespCodeTmp[0] = '\0';
  sRespCodeTmp[1] = '\0';
  sRespCodeTmp[2] = '\0';
  sPid[0] = '\0';
  sPid[1] = '\0';
  sPid[2] = '\0';
  sPid[3] = '\0';
  sPid[4] = '\0';
  sPid[5] = '\0';
  sPid[6] = '\0';
  sPid[7] = '\0';
  sPid[8] = '\0';
  sFctCodeTmp[0] = '\0';
  sFctCodeTmp[1] = '\0';
  sFctCodeTmp[2] = '\0';
  sFctCodeTmp[3] = '\0';
  sAcqCode[0] = '\0';
  sAcqCode[1] = '\0';
  sAcqCode[2] = '\0';
  sAcqCode[3] = '\0';
  sProcCode[0] = '\0';
  sProcCode[1] = '\0';
  sProcCode[2] = '\0';
  sProcCode[3] = '\0';
  sProcCode[4] = '\0';
  sProcCode[5] = '\0';
  sProcCode[6] = '\0';
  sProcCode[7] = '\0';
  sProcCode[8] = '\0';
  sProcCode[9] = '\0';
  sProcCode[10] = '\0';
  sProcCode[0xb] = '\0';
  sProcCode[0xc] = '\0';
  sProcCode[0xd] = '\0';
  sProcCode[0xe] = '\0';
  sProcCode[0xf] = '\0';
  sProcCode[0x12] = '\0';
  sCardNbr[0] = '\0';
  sCardNbr[1] = '\0';
  sCardNbr[2] = '\0';
  sCardNbr[3] = '\0';
  sCardNbr[4] = '\0';
  sCardNbr[5] = '\0';
  sCardNbr[6] = '\0';
  sCardNbr[7] = '\0';
  sCardNbr[8] = '\0';
  sCardNbr[9] = '\0';
  sCardNbr[10] = '\0';
  sCardNbr[0xb] = '\0';
  sCardNbr[0xc] = '\0';
  sCardNbr[0xd] = '\0';
  sCardNbr[0xe] = '\0';
  sCardNbr[0xf] = '\0';
  sCardNbr[0x10] = '\0';
  sCardNbr[0x11] = '\0';
  sCardNbr[0x12] = '\0';
  sCardNbr[0x13] = '\0';
  sCardNbr[0x14] = '\0';
  sCardNbr[0x15] = '\0';
  sCardNbr[0x16] = '\0';
  sCardNbr[0x17] = '\0';
  sCardNbr[0x18] = '\0';
  sprintf(sLine,"Start ConvNpsToISO..(%d)",(ulong)(uint)nIndexCtx);
  trace_event(sLine,5);
  InitIsoInfo(IsoInfo);
  iVar2 = GetNpsField(0x22,NpsInfo,szTrack2,&nLen);
  if (iVar2 == 0) {
    GetTrack2Data(szTrack2,szCardNbr,szExpiryDate,szServiceCode,szPvv,szCvv);
  }
  iVar2 = NpsInfo->nMsgType;
  if (iVar2 < 0xde) {
    if (iVar2 < 0xdc) {
      if (iVar2 < 0x7a) {
        if (iVar2 < 0x78) {
          if (iVar2 != 100) goto LAB_0040dc88;
          IsoInfo->nMsgType = 0x44c;
        }
        else {
          IsoInfo->nMsgType = 0x460;
        }
      }
      else {
        if (iVar2 != 200) goto LAB_0040dc88;
        IsoInfo->nMsgType = 0x4b0;
      }
    }
    else {
      IsoInfo->nMsgType = 0x4c4;
    }
  }
  else if (iVar2 == 0x1f6) {
LAB_0040f350:
    IsoInfo->nMsgType = 0x5f0;
  }
  else if (iVar2 < 0x1f7) {
    if (iVar2 != 0x1a4) {
      if (iVar2 != 500) goto LAB_0040dc88;
      goto LAB_0040f350;
    }
    IsoInfo->nMsgType = 0x58c;
  }
  else {
    if (iVar2 < 0x208) {
LAB_0040dc88:
      sprintf(sLine,"MsgType: %d not Handeled");
      trace_event(sLine,5);
      return -1;
    }
    if (iVar2 < 0x20c) goto LAB_0040f350;
    if (iVar2 != 800) goto LAB_0040dc88;
    IsoInfo->nMsgType = 0x70c;
  }
  iVar2 = GetNpsField(1,NpsInfo,sCardNbr,&tmpFieldLen);
  if (iVar2 == 0) {
    AddIsoField(1,IsoInfo,sCardNbr,tmpFieldLen);
  }
  else {
    puVar7 = (uint *)szCardNbr;
    if (szCardNbr[0] != '\0') {
      do {
        puVar11 = puVar7;
        uVar4 = *puVar11 + 0xfefefeff & ~*puVar11;
        uVar3 = uVar4 & 0x80808080;
        puVar7 = puVar11 + 1;
      } while (uVar3 == 0);
      bVar16 = (uVar4 & 0x8080) == 0;
      if (bVar16) {
        uVar3 = uVar3 >> 0x10;
      }
      if (bVar16) {
        puVar7 = (uint *)((long)puVar11 + 6);
      }
      AddIsoField(1,IsoInfo,szCardNbr,
                  (((int)puVar7 + -3) - (uint)CARRY1((byte)uVar3,(byte)uVar3)) - (int)szCardNbr);
    }
  }
  iVar2 = GetNpsField(2,NpsInfo,szProcCode,&tmpFieldLen);
  if (iVar2 == 0) {
    iVar2 = NpsInfo->nMsgType;
    tlvInfoSub.nPresent[0] = 0x6f54774e;
    tlvInfoSub.nPresent[1] = 0x506f7349;
    tlvInfoSub.nPresent[2] = 0x43636f72;
    tlvInfoSub.nPresent[3] = 0x65646f;
    sprintf((char *)&TlvInfo,"Start %%s(%s)",&DAT_004a4d5a);
    sprintf((char *)&sTlvInfo,(char *)&TlvInfo,&tlvInfoSub);
    trace_event((char *)&sTlvInfo,5);
    iVar6 = 0;
    pTVar12 = sTransType;
    builtin_strncpy(tmpField,"XX0000",6);
    do {
      if (iVar2 == pTVar12->nNwMsgType) {
        iVar5 = memcmp(pTVar12->szNwTransType,szProcCode,2);
        if (iVar5 == 0) {
          tmpField._0_2_ = *(undefined2 *)sTransType[iVar6].szIsoTransType;
          break;
        }
      }
      iVar6 = iVar6 + 1;
      pTVar12 = pTVar12 + 1;
    } while (iVar6 != 0x15);
    pcVar13 = szProcCode + 2;
    iVar2 = memcmp("00",pcVar13,2);
    if (iVar2 == 0) {
      lVar8 = 0;
LAB_0040f63d:
      tmpField._2_2_ = *(undefined2 *)sAccntType[lVar8].szIsoAccntType;
    }
    else {
      iVar2 = memcmp(&DAT_004d1ee1,pcVar13,2);
      if (iVar2 == 0) {
        lVar8 = 1;
        goto LAB_0040f63d;
      }
      iVar2 = memcmp(&DAT_004a671d,pcVar13,2);
      if (iVar2 == 0) {
        lVar8 = 2;
        goto LAB_0040f63d;
      }
      iVar2 = memcmp(&DAT_004c759e,pcVar13,2);
      if (iVar2 == 0) {
        lVar8 = 3;
        goto LAB_0040f63d;
      }
    }
    pcVar13 = szProcCode + 4;
    iVar2 = memcmp("00",pcVar13,2);
    if (iVar2 == 0) {
      lVar8 = 0;
LAB_0040f66a:
      tmpField._4_2_ = *(undefined2 *)sAccntType[lVar8].szIsoAccntType;
    }
    else {
      iVar2 = memcmp(&DAT_004d1ee1,pcVar13,2);
      if (iVar2 == 0) {
        lVar8 = 1;
        goto LAB_0040f66a;
      }
      iVar2 = memcmp(&DAT_004a671d,pcVar13,2);
      if (iVar2 == 0) {
        lVar8 = 2;
        goto LAB_0040f66a;
      }
      iVar2 = memcmp(&DAT_004c759e,pcVar13,2);
      if (iVar2 == 0) {
        lVar8 = 3;
        goto LAB_0040f66a;
      }
    }
    sprintf((char *)&TlvInfo,"End   %%s(%%d, %s)",&DAT_004a4d5a);
    sprintf((char *)&sTlvInfo,(char *)&TlvInfo,&tlvInfoSub,6,tmpField);
    trace_event((char *)&sTlvInfo,5);
    tmpFieldLen = 6;
    AddIsoField(2,IsoInfo,tmpField,6);
  }
  iVar2 = GetNpsField(3,NpsInfo,tmpField,&tmpFieldLen);
  if (iVar2 == 0) {
    AddIsoField(3,IsoInfo,tmpField,tmpFieldLen);
  }
  iVar2 = GetNpsField(4,NpsInfo,tmpField,&tmpFieldLen);
  if (iVar2 != 0) {
    GetNpsField(3,NpsInfo,tmpField,&tmpFieldLen);
  }
  AddIsoField(4,IsoInfo,tmpField,tmpFieldLen);
  iVar2 = GetNpsField(5,NpsInfo,tmpField,&tmpFieldLen);
  if (iVar2 != 0) {
    GetNpsField(3,NpsInfo,tmpField,&tmpFieldLen);
  }
  AddIsoField(5,IsoInfo,tmpField,tmpFieldLen);
  iVar2 = GetNpsField(0x30,NpsInfo,tmpField,&tmpFieldLen);
  if (iVar2 == 0) {
    sAcqCountryCode = (char  [4])(tmpField._0_4_ & 0xffffff);
  }
  else {
    sAcqCountryCode[0] = '\0';
    sAcqCountryCode[1] = '\0';
    sAcqCountryCode[2] = '0';
    sAcqCountryCode[0] = '0';
    sAcqCountryCode[1] = '5';
  }
  iVar2 = GetNpsField(6,NpsInfo,tmpField,&tmpFieldLen);
  if (iVar2 == 0) {
    AddIsoField(6,IsoInfo,tmpField,tmpFieldLen);
  }
  iVar2 = GetNpsField(8,NpsInfo,tmpField,&tmpFieldLen);
  if (iVar2 == 0) {
    AddIsoField(8,IsoInfo,tmpField,tmpFieldLen);
  }
  iVar2 = GetNpsField(9,NpsInfo,tmpField,&tmpFieldLen);
  if ((iVar2 == 0) || (iVar2 = GetNpsField(8,NpsInfo,tmpField,&tmpFieldLen), iVar2 == 0)) {
    AddIsoField(9,IsoInfo,tmpField,tmpFieldLen);
  }
  iVar2 = GetNpsField(10,NpsInfo,sStan,&tmpFieldLen);
  if (iVar2 == 0) {
    AddIsoField(10,IsoInfo,sStan,tmpFieldLen);
  }
  sDateTmp[0] = '\0';
  sDateTmp[1] = '\0';
  sDateTmp[2] = '\0';
  sDateTmp[3] = '\0';
  sDateTmp[4] = '\0';
  sDateTmp[5] = '\0';
  sDateTmp[6] = '\0';
  sDateTmp[7] = '\0';
  sDateTmp[8] = '\0';
  sDateTmp[9] = '\0';
  sDateTmp[10] = '\0';
  sDateTmp[0xb] = '\0';
  current_gmt_date(sDateTmp);
  iVar2 = GetNpsField(0xb,NpsInfo,tmpField,&tmpFieldLen);
  if (iVar2 == 0) {
    sDateTmp._6_2_ = (undefined2)tmpField._0_4_;
    sDateTmp._8_2_ = SUB42(tmpField._0_4_,2);
    sDateTmp[10] = tmpField[4];
    sDateTmp[0xb] = tmpField[5];
  }
  iVar2 = GetNpsField(0xc,NpsInfo,tmpField,&tmpFieldLen);
  if (iVar2 == 0) {
    sDateTmp[2] = tmpField[0];
    sDateTmp[3] = tmpField[1];
    sDateTmp[4] = tmpField[2];
    sDateTmp[5] = tmpField[3];
  }
  AddIsoField(0xb,IsoInfo,sDateTmp,0xc);
  iVar2 = GetNpsField(0xd,NpsInfo,tmpField,&tmpFieldLen);
  if (iVar2 == 0) {
    AddIsoField(0xd,IsoInfo,tmpField,tmpFieldLen);
  }
  else {
    puVar7 = (uint *)szExpiryDate;
    if (szExpiryDate[0] != '\0') {
      do {
        puVar11 = puVar7;
        uVar4 = *puVar11 + 0xfefefeff & ~*puVar11;
        uVar3 = uVar4 & 0x80808080;
        puVar7 = puVar11 + 1;
      } while (uVar3 == 0);
      bVar16 = (uVar4 & 0x8080) == 0;
      if (bVar16) {
        uVar3 = uVar3 >> 0x10;
      }
      if (bVar16) {
        puVar7 = (uint *)((long)puVar11 + 6);
      }
      AddIsoField(0xd,IsoInfo,szExpiryDate,
                  (((int)puVar7 + -3) - (uint)CARRY1((byte)uVar3,(byte)uVar3)) - (int)szExpiryDate);
    }
  }
  iVar2 = GetNpsField(0xe,NpsInfo,tmpField,&tmpFieldLen);
  if (iVar2 == 0) {
    AddIsoField(0xe,IsoInfo,tmpField,4);
  }
  iVar2 = GetNpsField(0xf,NpsInfo,tmpField,&tmpFieldLen);
  if (iVar2 == 0) {
    AddIsoField(0xf,IsoInfo,tmpField,tmpFieldLen);
  }
  iVar2 = GetNpsField(0x11,NpsInfo,tmpField,&tmpFieldLen);
  if (iVar2 == 0) {
    AddIsoField(0x11,IsoInfo,tmpField,tmpFieldLen);
  }
  iVar2 = GetNpsField(0x7e,NpsInfo,tmpField,&tmpFieldLen);
  if (iVar2 == 0) {
    InitNpsF127Info(&msgF127Info);
    AnalyseNpsF127(tmpField,&msgF127Info);
    iVar2 = GetNpsF127Field(0xc,&msgF127Info,tmpField,&tmpFieldLen);
    if (iVar2 == 0) {
      sprintf(sLine,"(NPS_F127_13_POS_GEO_DATA) + 14 = [%.3s]",tmpField + 0xe);
      trace_event(sLine,5);
      AddIsoField(0x12,IsoInfo,tmpField + 0xe,3);
    }
  }
  AddIsoField(0x12,IsoInfo,"050",3);
  iVar2 = GetNpsField(0x13,NpsInfo,tmpField,&tmpFieldLen);
  if (iVar2 == 0) {
    AddIsoField(0x13,IsoInfo,tmpField,tmpFieldLen);
  }
  iVar2 = GetNpsField(0x14,NpsInfo,tmpField,&tmpFieldLen);
  if (iVar2 == 0) {
    AddIsoField(0x14,IsoInfo,tmpField,tmpFieldLen);
  }
  iVar2 = GetNpsField(0x15,NpsInfo,tmpField,&tmpFieldLen);
  if (iVar2 == 0) {
    PosData[0] = '\0';
    PosData[1] = '\0';
    PosData[2] = '\0';
    PosData[3] = '\0';
    iVar2 = memcmp(tmpField,&DAT_004d475e,2);
    if (iVar2 == 0) {
      uVar14 = 0;
      sprintf(sLine,"==> PosEntryMode: %s",tmpField);
      uVar15 = 1;
      trace_event(sLine,5);
    }
    else {
      uVar14 = 0;
      uVar15 = 0;
      iVar2 = memcmp(tmpField,&DAT_004d1e8d,2);
      if (iVar2 == 0) {
        sprintf(sLine,"===> PosEntryMode: %s",tmpField);
        uVar14 = 1;
        trace_event(sLine,5);
      }
    }
    sprintf(sLine,"==> EntryCapability: %d, ContactLessTransaction.: %d",uVar15,uVar14);
    trace_event(sLine,5);
    iVar2 = GetNpsField(0x33,NpsInfo,tmpField,&tmpFieldLen);
    if (iVar2 == 0) {
      builtin_strncpy(sPosDataTmp,"21130121",8);
    }
    else {
      builtin_strncpy(sPosDataTmp,"21130125",8);
    }
    if ((int)uVar15 == 1) {
      sPosDataTmp[0xc] = '\0';
      builtin_strncpy(sPosDataTmp,"51130121",8);
    }
    builtin_strncpy(sPosDataTmp + 8,"0146",4);
    if ((int)uVar14 == 1) {
      builtin_strncpy(sPosDataTmp,"511301310141",0xd);
      sprintf(sLine,"==> sPosDataTmp..: %s",sPosDataTmp);
      trace_event(sLine,5);
      AddIsoField(0x15,IsoInfo,sPosDataTmp,0xc);
    }
    if (NpsInfo->nMsgType != 0x1a4) {
      sprintf(sLine,"==> sPosDataTmp..: %s",sPosDataTmp);
      trace_event(sLine,5);
      AddIsoField(0x15,IsoInfo,sPosDataTmp,0xc);
    }
  }
  iVar2 = GetNpsField(0x16,NpsInfo,tmpField,&tmpFieldLen);
  if (iVar2 == 0) {
    AddIsoField(0x16,IsoInfo,tmpField,tmpFieldLen);
  }
  iVar2 = GetNpsField(2,NpsInfo,tmpField,&tmpFieldLen);
  if (iVar2 == 0) {
    uVar3 = NpsInfo->nMsgType;
    tlvInfoSub.nPresent[0] = 0x6f54774e;
    tlvInfoSub.nPresent[1] = 0x466f7349;
    tlvInfoSub.nPresent[2] = 0x43636e75;
    tlvInfoSub.nPresent[3] = 0x65646f;
    sprintf((char *)&TlvInfo,"Start %%s(%s)",&DAT_004a4d56);
    sprintf((char *)&sTlvInfo,(char *)&TlvInfo,&tlvInfoSub,(ulong)uVar3);
    trace_event((char *)&sTlvInfo,5);
    iVar2 = 0;
    pTVar12 = sTransType;
    tmpField1[0] = 'X';
    tmpField1[1] = 'X';
    tmpField1[2] = 'X';
    do {
      if ((uVar3 == pTVar12->nNwMsgType) &&
         (iVar6 = memcmp(pTVar12->szNwTransType,szProcCode,2), iVar6 == 0)) {
        tmpField1._0_2_ = *(undefined2 *)sTransType[iVar2].szIsoFuncCode;
        tmpField1[2] = sTransType[iVar2].szIsoFuncCode[2];
        break;
      }
      iVar2 = iVar2 + 1;
      pTVar12 = pTVar12 + 1;
    } while (iVar2 != 0x15);
    sprintf((char *)&TlvInfo,"End   %%s(%%d, %s)",&DAT_004a32c9);
    sprintf((char *)&sTlvInfo,(char *)&TlvInfo,&tlvInfoSub,3,tmpField1);
    trace_event((char *)&sTlvInfo,5);
    tmpFieldLen = 3;
    AddIsoField(0x17,IsoInfo,tmpField1,3);
  }
  iVar2 = GetNpsField(0x37,NpsInfo,tmpField,&tmpFieldLen);
  if (iVar2 == 0) {
    AddIsoField(0x18,IsoInfo,tmpField,tmpFieldLen);
  }
  iVar2 = GetNpsField(0x1a,NpsInfo,tmpField,&tmpFieldLen);
  if (iVar2 == 0) {
    AddIsoField(0x1a,IsoInfo,tmpField,tmpFieldLen);
  }
  iVar2 = GetNpsField(0x1b,NpsInfo,tmpField,&tmpFieldLen);
  if (iVar2 == 0) {
    AddIsoField(1,IsoInfo,tmpField,tmpFieldLen);
  }
  GetNpsField(0x1c,NpsInfo,tmpField,&tmpFieldLen);
  iVar2 = GetNpsField(0x5e,NpsInfo,tmpField,&tmpFieldLen);
  if (iVar2 == 0) {
    AddIsoField(0x1d,IsoInfo,tmpField,0x18);
  }
  vAcqBank[0] = '\0';
  vAcqBank[1] = '\0';
  vAcqBank[2] = '\0';
  vAcqBank[3] = '\0';
  vAcqBank[4] = '\0';
  vAcqBank[5] = '\0';
  vAcqBank[6] = '\0';
  vAcqBank[7] = '\0';
  vAcqBank[8] = '\0';
  vAcqBank[9] = '\0';
  vAcqBank[10] = '\0';
  vAcqBank[0xb] = '\0';
  iVar2 = GetNpsField(0x1f,NpsInfo,vAcqBank,&tmpFieldLen);
  if (iVar2 == 0) {
    AddIsoField(0x1f,IsoInfo,vAcqBank,tmpFieldLen);
  }
  iVar2 = memcmp(PosData,&DAT_004d1efa,3);
  if (iVar2 == 0) {
    trace_event(" Checking QPay Authorisation...",5);
    iVar2 = memcmp(vAcqBank,&DAT_004a4d5f,6);
    if (iVar2 != 0) goto LAB_0040d09e;
    bVar16 = true;
    trace_event(" QPya authorisation ...",5);
  }
  else {
LAB_0040d09e:
    bVar16 = false;
  }
  iVar2 = GetNpsField(0x20,NpsInfo,tmpField,&tmpFieldLen);
  if (iVar2 == 0) {
    AddIsoField(0x20,IsoInfo,tmpField,tmpFieldLen);
  }
  iVar2 = GetNpsField(0x22,NpsInfo,tmpField,&tmpFieldLen);
  if (iVar2 == 0) {
    AddIsoField(0x22,IsoInfo,tmpField,tmpFieldLen);
  }
  if (bVar16) {
    dump_p7_struct(IsoInfo);
    trace_event("Qpay Authorisation",5);
    puVar7 = (uint *)sTrackII;
    for (lVar8 = 5; lVar8 != 0; lVar8 = lVar8 + -1) {
      puVar7[0] = 0;
      puVar7[1] = 0;
      puVar7 = puVar7 + (ulong)bVar17 * -4 + 2;
    }
    *(char *)puVar7 = '\0';
    iVar2 = GetQpayTrack2Data(nIndexCtx,tmpField,sTrackII);
    puVar7 = (uint *)sTrackII;
    if (iVar2 == 0) {
      do {
        puVar11 = puVar7;
        uVar4 = *puVar11 + 0xfefefeff & ~*puVar11;
        uVar3 = uVar4 & 0x80808080;
        puVar7 = puVar11 + 1;
      } while (uVar3 == 0);
      bVar16 = (uVar4 & 0x8080) == 0;
      if (bVar16) {
        uVar3 = uVar3 >> 0x10;
      }
      if (bVar16) {
        puVar7 = (uint *)((long)puVar11 + 6);
      }
      PutIsoField(0x22,IsoInfo,sTrackII,
                  (((int)puVar7 + -3) - (uint)CARRY1((byte)uVar3,(byte)uVar3)) - (int)sTrackII);
      GetTrack2Data(sTrackII,szCardNbr,szExpiryDate,szServiceCode,szPvv,szCvv);
    }
    iVar2 = GetIsoField(2,IsoInfo,sProcCode,&tmpFieldLen);
    if (iVar2 == 0) {
      sprintf(sLine," Processing Code [%s]",sProcCode);
      trace_event(sLine,5);
      sProcCode[0] = '9';
      sProcCode[1] = '0';
      sprintf(sLine," Processing Code AFTER [%s]",sProcCode);
      trace_event(sLine,5);
      PutIsoField(2,IsoInfo,sProcCode,tmpFieldLen);
    }
  }
  iVar2 = GetNpsField(0x24,NpsInfo,tmpField,&tmpFieldLen);
  if (iVar2 == 0) {
    PutIsoField(0x24,IsoInfo,tmpField,tmpFieldLen);
  }
  iVar2 = GetNpsField(0x25,NpsInfo,tmpField1,&tmpFieldLen);
  if (iVar2 == 0) {
    PutIsoField(0x25,IsoInfo,tmpField1,tmpFieldLen);
  }
  iVar2 = GetNpsField(0x26,NpsInfo,tmpField,&tmpFieldLen);
  if (iVar2 == 0) {
    sRespCodeTmp[0] = '\0';
    sRespCodeTmp[1] = '\0';
    sRespCodeTmp[2] = '\0';
    ConvNpsRespCodeToIso(tmpField,sRespCodeTmp);
    PutIsoField(0x26,IsoInfo,sRespCodeTmp,3);
  }
  iVar2 = GetNpsField(0x27,NpsInfo,tmpField,&tmpFieldLen);
  if (iVar2 == 0) {
    PutIsoField(0x27,IsoInfo,tmpField,tmpFieldLen);
  }
  else {
    puVar7 = (uint *)szServiceCode;
    if (szServiceCode[0] != '\0') {
      do {
        puVar11 = puVar7;
        uVar4 = *puVar11 + 0xfefefeff & ~*puVar11;
        uVar3 = uVar4 & 0x80808080;
        puVar7 = puVar11 + 1;
      } while (uVar3 == 0);
      bVar16 = (uVar4 & 0x8080) == 0;
      if (bVar16) {
        uVar3 = uVar3 >> 0x10;
      }
      if (bVar16) {
        puVar7 = (uint *)((long)puVar11 + 6);
      }
      PutIsoField(0x27,IsoInfo,szServiceCode,
                  (((int)puVar7 + -3) - (uint)CARRY1((byte)uVar3,(byte)uVar3)) - (int)szServiceCode)
      ;
    }
  }
  iVar2 = GetNpsField(0x28,NpsInfo,tmpField,&tmpFieldLen);
  if (iVar2 == 0) {
    PutIsoField(0x28,IsoInfo,tmpField,tmpFieldLen);
  }
  iVar2 = GetNpsField(0x29,NpsInfo,tmpField,&tmpFieldLen);
  if ((iVar2 == 0) || (iVar2 = GetNpsField(0x28,NpsInfo,tmpField,&tmpFieldLen), iVar2 == 0)) {
    PutIsoField(0x29,IsoInfo,tmpField,tmpFieldLen);
  }
  puVar7 = (uint *)tmpField;
  for (lVar8 = 0x20; lVar8 != 0; lVar8 = lVar8 + -1) {
    puVar7[0] = 0;
    puVar7[1] = 0;
    puVar7 = puVar7 + (ulong)bVar17 * -4 + 2;
  }
  iVar2 = GetNpsField(0x2a,NpsInfo,tmpField,&tmpFieldLen);
  if (iVar2 == 0) {
    if (IsoInfo->nMsgType == 0x58c) {
      if (0 < tmpFieldLen) {
        puVar7 = (uint *)tmpField;
        do {
          if ((char)*puVar7 == '\0') {
            *(char *)puVar7 = ' ';
          }
          puVar7 = (uint *)((long)puVar7 + 1);
        } while (puVar7 != (uint *)(tmpField + (ulong)(tmpFieldLen - 1) + 1));
      }
      tmpField[tmpFieldLen] = '\0';
    }
    PutIsoField(0x2a,IsoInfo,tmpField,tmpFieldLen);
  }
  iVar2 = GetNpsField(0x2b,NpsInfo,tmpField,&tmpFieldLen);
  if (iVar2 == 0) {
    PutIsoField(0x2b,IsoInfo,tmpField,tmpFieldLen);
  }
  iVar2 = GetNpsField(0x2c,NpsInfo,tmpField,&tmpFieldLen);
  if (iVar2 == 0) {
    PutIsoField(0x2c,IsoInfo,tmpField,tmpFieldLen);
  }
  iVar2 = GetNpsField(0x2d,NpsInfo,tmpField,&tmpFieldLen);
  if (iVar2 == 0) {
    PutIsoField(0x2d,IsoInfo,tmpField,tmpFieldLen);
  }
  iVar2 = GetNpsField(0x2e,NpsInfo,tmpField,&tmpFieldLen);
  if (iVar2 == 0) {
    sprintf(sLine,"- FLD (%d) : (%d) : ",0x2e,(ulong)(uint)tmpFieldLen);
    trace_event(sLine,4);
    InitNpsSubFldInfo(&tlvInfoSub);
    AnalyseNpsSubFld(tmpField,tmpFieldLen,&tlvInfoSub);
    iVar2 = GetNpsSubFldTag("918",&tlvInfoSub,sub_data,&tmpFieldLen);
    if (iVar2 == 0) {
      sprintf(sLine,"- SUB FLD 918 IS (%s) :",sub_data);
      trace_event(sLine,4);
      iVar2 = memcmp(sub_data,&DAT_004a4df4,3);
      if (iVar2 == 0) {
        builtin_strncpy(sLine,"PRE AUTH NOT SUPPORTED IN NPSB ! ",0x22);
        trace_event(sLine,5);
        return -1;
      }
    }
  }
  InitTlvPrivate(&TlvInfo);
  puVar7 = (uint *)vAcqBank;
  if (vAcqBank[0] != '\0') {
    do {
      puVar11 = puVar7;
      uVar4 = *puVar11 + 0xfefefeff & ~*puVar11;
      uVar3 = uVar4 & 0x80808080;
      puVar7 = puVar11 + 1;
    } while (uVar3 == 0);
    bVar16 = (uVar4 & 0x8080) == 0;
    if (bVar16) {
      uVar3 = uVar3 >> 0x10;
    }
    if (bVar16) {
      puVar7 = (uint *)((long)puVar11 + 6);
    }
    AddTlvPrivate("P09",&TlvInfo,vAcqBank,
                  (((int)puVar7 + -3) - (uint)CARRY1((byte)uVar3,(byte)uVar3)) - (int)vAcqBank);
  }
  if (sAcqCode[0] != '\0') {
    puVar7 = (uint *)sAcqCode;
    do {
      puVar11 = puVar7;
      uVar4 = *puVar11 + 0xfefefeff & ~*puVar11;
      uVar3 = uVar4 & 0x80808080;
      puVar7 = puVar11 + 1;
    } while (uVar3 == 0);
    bVar16 = (uVar4 & 0x8080) == 0;
    if (bVar16) {
      uVar3 = uVar3 >> 0x10;
    }
    if (bVar16) {
      puVar7 = (uint *)((long)puVar11 + 6);
    }
    AddTlvPrivate("P68",&TlvInfo,sAcqCode,
                  (((int)puVar7 + -3) - (uint)CARRY1((byte)uVar3,(byte)uVar3)) - (int)sAcqCode);
  }
  iVar2 = GetNpsField(10,NpsInfo,tmpField,&tmpFieldLen);
  if (iVar2 == 0) {
    if (NpsInfo->nMsgType == 0x1a4) {
      AddTlvPrivate("P13",&TlvInfo,"000000",6);
    }
    else {
      AddTlvPrivate("P13",&TlvInfo,tmpField,6);
    }
  }
  iVar2 = GetNpsField(0x33,NpsInfo,tmpField,&tmpFieldLen);
  if (iVar2 == 0) {
    pTVar10 = &sTlvInfo;
    for (lVar8 = 0x20; lVar8 != 0; lVar8 = lVar8 + -1) {
      pTVar10->nPresent[0] = 0;
      pTVar10->nPresent[1] = 0;
      pTVar10 = (TSTlvAutho *)((long)pTVar10 + (ulong)bVar17 * -0x10 + 8);
    }
    iVar2 = GetIWK(nIndexCtx,G_sNps.F_szRsrcId,(char *)&sTlvInfo);
    pTVar10 = &sTlvInfo;
    if (iVar2 == 0) {
      do {
        pTVar9 = pTVar10;
        uVar4 = pTVar9->nPresent[0] + 0xfefefeffU & ~pTVar9->nPresent[0];
        uVar3 = uVar4 & 0x80808080;
        pTVar10 = (TSTlvAutho *)(pTVar9->nPresent + 1);
      } while (uVar3 == 0);
      bVar16 = (uVar4 & 0x8080) == 0;
      if (bVar16) {
        uVar3 = uVar3 >> 0x10;
      }
      if (bVar16) {
        pTVar10 = (TSTlvAutho *)((long)pTVar9->nPresent + 6);
      }
      AddTlvPrivate("P10",&TlvInfo,(char *)&sTlvInfo,
                    (((int)pTVar10 + -3) - (uint)CARRY1((byte)uVar3,(byte)uVar3)) - (int)&sTlvInfo);
    }
  }
  tmpFieldLen = PrivateBuildTlv(tmpField,&TlvInfo);
  if (0 < tmpFieldLen) {
    PutIsoField(0x2f,IsoInfo,tmpField,tmpFieldLen);
  }
  iVar2 = GetNpsField(0x30,NpsInfo,tmpField,&tmpFieldLen);
  if (iVar2 == 0) {
    PutIsoField(0x30,IsoInfo,tmpField,tmpFieldLen);
  }
  iVar2 = GetNpsField(0x31,NpsInfo,tmpField,&tmpFieldLen);
  if (iVar2 != 0) {
    GetNpsField(0x30,NpsInfo,tmpField,&tmpFieldLen);
  }
  PutIsoField(0x31,IsoInfo,tmpField,tmpFieldLen);
  iVar2 = memcmp(sAcqCountryCode,&DAT_004a4e08,3);
  if ((iVar2 == 0) ||
     ((iVar2 = GetNpsField(0x32,NpsInfo,tmpField,&tmpFieldLen), iVar2 != 0 &&
      (iVar2 = GetNpsField(0x31,NpsInfo,tmpField,&tmpFieldLen), iVar2 != 0)))) {
    GetNpsField(0x30,NpsInfo,tmpField,&tmpFieldLen);
  }
  PutIsoField(0x32,IsoInfo,tmpField,tmpFieldLen);
  iVar2 = GetNpsField(0x33,NpsInfo,tmpField,&tmpFieldLen);
  if (iVar2 == 0) {
    PutIsoField(0x33,IsoInfo,tmpField,0x10);
  }
  puVar7 = (uint *)tmpField1;
  for (lVar8 = 0x20; lVar8 != 0; lVar8 = lVar8 + -1) {
    puVar7[0] = 0;
    puVar7[1] = 0;
    puVar7 = puVar7 + (ulong)bVar17 * -4 + 2;
  }
  GetNpsField(0x34,NpsInfo,tmpField,&tmpFieldLen);
  PutSecurityData(0,tmpField1,"02",2);
  PutSecurityData(1,tmpField1,"01",2);
  PutSecurityData(2,tmpField1,"000",3);
  PutSecurityData(3,tmpField1,"000",3);
  sPid[0] = '\0';
  sPid[1] = '\0';
  sPid[2] = '\0';
  sPid[3] = '\0';
  sPid[4] = '\0';
  sPid[5] = '\0';
  sPid[6] = '\0';
  sPid[7] = '\0';
  sPid[8] = '\0';
  uVar3 = getpid();
  sprintf(sPid,"%08d",(ulong)uVar3);
  PutSecurityData(4,tmpField1,sPid,8);
  PutSecurityData(5,tmpField1,G_sNps.F_szRsrcId,6);
  PutSecurityData(6,tmpField1,"00000000",8);
  PutSecurityData(7,tmpField1,"000000",6);
  PutSecurityData(8,tmpField1,"NPS            ",0xf);
  PutSecurityData(9,tmpField1,"000000000",9);
  puVar7 = (uint *)tmpField1;
  do {
    puVar11 = puVar7;
    uVar4 = *puVar11 + 0xfefefeff & ~*puVar11;
    uVar3 = uVar4 & 0x80808080;
    puVar7 = puVar11 + 1;
  } while (uVar3 == 0);
  bVar16 = (uVar4 & 0x8080) == 0;
  if (bVar16) {
    uVar3 = uVar3 >> 0x10;
  }
  if (bVar16) {
    puVar7 = (uint *)((long)puVar11 + 6);
  }
  PutIsoField(0x34,IsoInfo,tmpField1,
              (((int)puVar7 + -3) - (uint)CARRY1((byte)uVar3,(byte)uVar3)) - (int)tmpField1);
  iVar2 = GetNpsField(0x5e,NpsInfo,tmpField,&tmpFieldLen);
  if (iVar2 == 0) {
    PutIsoField(0x35,IsoInfo,tmpField,tmpFieldLen);
  }
  puVar7 = (uint *)tmpField1;
  for (lVar8 = 0x20; lVar8 != 0; lVar8 = lVar8 + -1) {
    puVar7[0] = 0;
    puVar7[1] = 0;
    puVar7 = puVar7 + (ulong)bVar17 * -4 + 2;
  }
  iVar2 = GetNpsField(0x16,NpsInfo,tmpField,&tmpFieldLen);
  if ((iVar2 != 0) || (iVar2 = GetNpsField(0x36,NpsInfo,tmpField1,&tmpFieldLen1), iVar2 != 0)) {
    trace_event("MAG TRX NO FIELD 47",5);
    puVar7 = (uint *)tmpField;
    for (lVar8 = 0x20; lVar8 != 0; lVar8 = lVar8 + -1) {
      puVar7[0] = 0;
      puVar7[1] = 0;
      puVar7 = puVar7 + (ulong)bVar17 * -4 + 2;
    }
    sPosDataTmp[0] = '\0';
    sPosDataTmp[1] = '\0';
    sPosDataTmp[2] = '\0';
    sPosDataTmp[3] = '\0';
    sPosDataTmp[4] = '\0';
    sPosDataTmp[5] = '\0';
    sPosDataTmp[6] = '\0';
    sPosDataTmp[7] = '\0';
    sPosDataTmp[8] = '\0';
    sPosDataTmp[9] = '\0';
    sPosDataTmp[10] = '\0';
    sPosDataTmp[0xb] = '\0';
    sPosDataTmp[0xc] = '\0';
    iVar2 = GetNpsField(0x15,NpsInfo,tmpField,&tmpFieldLen);
    if (iVar2 != 0) {
      trace_event(" Field 22 not Present",5);
      iVar2 = GetNpsField(0x33,NpsInfo,tmpField,&tmpFieldLen);
      if (iVar2 == 0) {
        trace_event(" Pin Present, and the Field 22 is not present",5);
        builtin_strncpy(sPosDataTmp,"21130121",8);
      }
      else {
        trace_event(" Pin Not Present, and the Field 22 is not present",5);
        builtin_strncpy(sPosDataTmp,"21130125",8);
      }
      builtin_strncpy(sPosDataTmp + 8,"0146",4);
      PutIsoField(0x15,IsoInfo,sPosDataTmp,0xc);
    }
  }
  iVar2 = GetNpsField(0x16,NpsInfo,tmpField,&tmpFieldLen);
  if (iVar2 != 0) goto LAB_0040d731;
  puVar7 = (uint *)tmpField;
  for (lVar8 = 0x20; lVar8 != 0; lVar8 = lVar8 + -1) {
    puVar7[0] = 0;
    puVar7[1] = 0;
    puVar7 = puVar7 + (ulong)bVar17 * -4 + 2;
  }
  sPosDataTmp[0] = '\0';
  sPosDataTmp[1] = '\0';
  sPosDataTmp[2] = '\0';
  sPosDataTmp[3] = '\0';
  sPosDataTmp[4] = '\0';
  sPosDataTmp[5] = '\0';
  sPosDataTmp[6] = '\0';
  sPosDataTmp[7] = '\0';
  sPosDataTmp[8] = '\0';
  sPosDataTmp[9] = '\0';
  sPosDataTmp[10] = '\0';
  sPosDataTmp[0xb] = '\0';
  sPosDataTmp[0xc] = '\0';
  iVar2 = GetNpsField(0x15,NpsInfo,tmpField,&tmpFieldLen);
  if (iVar2 == 0) {
    iVar2 = memcmp(tmpField,&DAT_004d1e47,2);
    if (iVar2 == 0) {
      trace_event("CHIP DATA :: CHECK 47 FIELD",5);
      iVar2 = GetNpsField(0x2e,NpsInfo,tmpField,&tmpFieldLen);
      if (iVar2 == 0) {
        PutIsoField(0x2e,IsoInfo,tmpField,tmpFieldLen);
      }
      iVar2 = GetNpsField(0x33,NpsInfo,tmpField,&tmpFieldLen);
      if (iVar2 != 0) goto LAB_0040f40f;
LAB_0040f4c4:
      builtin_strncpy(sPosDataTmp,"51130151",8);
LAB_0040f42c:
      builtin_strncpy(sPosDataTmp + 8,"1146",4);
      PutIsoField(0x15,IsoInfo,sPosDataTmp,0xc);
    }
  }
  else {
    iVar2 = GetNpsField(0x38,NpsInfo,tmpField,&tmpFieldLen);
    if (iVar2 == 0) {
      iVar2 = GetNpsField(0x33,NpsInfo,tmpField,&tmpFieldLen);
      if (iVar2 == 0) goto LAB_0040f4c4;
LAB_0040f40f:
      builtin_strncpy(sPosDataTmp,"51130155",8);
      goto LAB_0040f42c;
    }
  }
  iVar2 = GetNpsField(0x36,NpsInfo,tmpField,&tmpFieldLen);
  if (iVar2 == 0) {
    PutIsoField(0x36,IsoInfo,tmpField,tmpFieldLen);
  }
LAB_0040d731:
  iVar2 = GetNpsField(0x59,NpsInfo,NpsOrigData,&tmpFieldLen);
  if (iVar2 == 0) {
    sprintf(sLine,"NPS ORG DATA %s Len %d ",NpsOrigData,(ulong)(uint)tmpFieldLen);
    trace_event(sLine,5);
    builtin_strncpy(IsoOrigData,"12000000000000000000000000000000000",0x23);
    PutIsoField(10,IsoInfo,NpsOrigData + 4,6);
    uVar1 = IsoOrigData._18_6_;
    IsoOrigData[4] = NpsOrigData[4];
    IsoOrigData[5] = NpsOrigData[5];
    IsoOrigData[6] = NpsOrigData[6];
    IsoOrigData[7] = NpsOrigData[7];
    puVar7 = (uint *)tmpField1;
    for (lVar8 = 0x20; lVar8 != 0; lVar8 = lVar8 + -1) {
      puVar7[0] = 0;
      puVar7[1] = 0;
      puVar7 = puVar7 + (ulong)bVar17 * -4 + 2;
    }
    tmpField1[0] = sDateTmp[0];
    tmpField1[1] = sDateTmp[1];
    tmpField1[2] = (char)NpsOrigData._16_8_;
    tmpField1._3_5_ = SUB85(NpsOrigData._16_8_,1);
    tmpField1._8_2_ = SUB82(NpsOrigData._16_8_,6);
    IsoOrigData._10_6_ = (undefined6)CONCAT53(tmpField1._3_5_,CONCAT12(tmpField1[2],sDateTmp._0_2_))
    ;
    IsoOrigData._16_2_ = SUB82(NpsOrigData._16_8_,4);
    IsoOrigData[0x12] = tmpField1[8];
    IsoOrigData[0x13] = tmpField1[9];
    IsoOrigData[0x14] = NpsOrigData[0x18];
    IsoOrigData[0x15] = NpsOrigData[0x19];
    IsoOrigData._18_6_ = uVar1;
                    // WARNING: Ignoring partial resolution of indirect
    puVar7 = (uint *)vAcqBank;
    do {
      puVar11 = puVar7;
      uVar4 = *puVar11 + 0xfefefeff & ~*puVar11;
      uVar3 = uVar4 & 0x80808080;
      puVar7 = puVar11 + 1;
    } while (uVar3 == 0);
    bVar16 = (uVar4 & 0x8080) == 0;
    if (bVar16) {
      uVar3 = uVar3 >> 0x10;
    }
    if (bVar16) {
      puVar7 = (uint *)((long)puVar11 + 6);
    }
    memcpy(IsoOrigData + 0x16,vAcqBank,
           (size_t)((long)puVar7 + ((-3 - (ulong)CARRY1((byte)uVar3,(byte)uVar3)) - (long)vAcqBank))
          );
    sprintf(sLine,"ISO ORG DATA IS %s",IsoOrigData);
    trace_event(sLine,5);
    puVar7 = (uint *)IsoOrigData;
    do {
      puVar11 = puVar7;
      uVar4 = *puVar11 + 0xfefefeff & ~*puVar11;
      uVar3 = uVar4 & 0x80808080;
      puVar7 = puVar11 + 1;
    } while (uVar3 == 0);
    bVar16 = (uVar4 & 0x8080) == 0;
    if (bVar16) {
      uVar3 = uVar3 >> 0x10;
    }
    if (bVar16) {
      puVar7 = (uint *)((long)puVar11 + 6);
    }
    PutIsoField(0x37,IsoInfo,IsoOrigData,
                (((int)puVar7 + -3) - (uint)CARRY1((byte)uVar3,(byte)uVar3)) - (int)IsoOrigData);
  }
  else if (IsoInfo->nMsgType == 0x58c) {
    trace_event("FIELD 90  NOT RECEIVED",0);
    PutIsoField(0x26,IsoInfo,"606",3);
    return 0x59;
  }
  GetNpsField(0x39,NpsInfo,tmpField,&tmpFieldLen);
  GetNpsField(0x3a,NpsInfo,tmpField,&tmpFieldLen);
  iVar2 = GetNpsField(0x3b,NpsInfo,tmpField,&tmpFieldLen);
  if (iVar2 == 0) {
    PutIsoField(0x3b,IsoInfo,tmpField,tmpFieldLen);
  }
  GetNpsField(0x3c,NpsInfo,tmpField,&tmpFieldLen);
  GetNpsField(0x3e,NpsInfo,tmpField,&tmpFieldLen);
  GetNpsField(0x3e,NpsInfo,tmpField,&tmpFieldLen);
  GetNpsField(0x3f,NpsInfo,tmpField,&tmpFieldLen);
  iVar2 = GetNpsField(0x41,NpsInfo,tmpField,&tmpFieldLen);
  if (iVar2 == 0) {
    PutIsoField(0x41,IsoInfo,tmpField,tmpFieldLen);
  }
  GetNpsField(0x42,NpsInfo,tmpField,&tmpFieldLen);
  iVar2 = GetNpsField(0x43,NpsInfo,tmpField,&tmpFieldLen);
  if (iVar2 == 0) {
    PutIsoField(0x43,IsoInfo,tmpField,tmpFieldLen);
  }
  iVar2 = GetNpsField(0x44,NpsInfo,tmpField,&tmpFieldLen);
  if (iVar2 == 0) {
    PutIsoField(0x44,IsoInfo,tmpField,tmpFieldLen);
  }
  iVar2 = GetNpsField(0x45,NpsInfo,tmpField,&tmpFieldLen);
  if (iVar2 == 0) {
    PutIsoField(1,IsoInfo,tmpField,tmpFieldLen);
  }
  iVar2 = GetNpsField(0x47,NpsInfo,tmpField,&tmpFieldLen);
  if (iVar2 == 0) {
    PutIsoField(0x47,IsoInfo,tmpField,tmpFieldLen);
  }
  GetNpsField(0x48,NpsInfo,tmpField,&tmpFieldLen);
  iVar2 = GetNpsField(0x49,NpsInfo,tmpField,&tmpFieldLen);
  if (iVar2 == 0) {
    PutIsoField(0x49,IsoInfo,tmpField,tmpFieldLen);
  }
  iVar2 = GetNpsField(0x4a,NpsInfo,tmpField,&tmpFieldLen);
  if (iVar2 == 0) {
    PutIsoField(0x4a,IsoInfo,tmpField,tmpFieldLen);
  }
  iVar2 = GetNpsField(0x4b,NpsInfo,tmpField,&tmpFieldLen);
  if (iVar2 == 0) {
    PutIsoField(0x4b,IsoInfo,tmpField,tmpFieldLen);
  }
  iVar2 = GetNpsField(0x4c,NpsInfo,tmpField,&tmpFieldLen);
  if (iVar2 == 0) {
    PutIsoField(0x4c,IsoInfo,tmpField,tmpFieldLen);
  }
  iVar2 = GetNpsField(0x4d,NpsInfo,tmpField,&tmpFieldLen);
  if (iVar2 == 0) {
    PutIsoField(0x4d,IsoInfo,tmpField,tmpFieldLen);
  }
  iVar2 = GetNpsField(0x4e,NpsInfo,tmpField,&tmpFieldLen);
  if (iVar2 == 0) {
    PutIsoField(0x4e,IsoInfo,tmpField,tmpFieldLen);
  }
  iVar2 = GetNpsField(0x4f,NpsInfo,tmpField,&tmpFieldLen);
  if (iVar2 == 0) {
    PutIsoField(0x4f,IsoInfo,tmpField,tmpFieldLen);
  }
  iVar2 = GetNpsField(0x50,NpsInfo,tmpField,&tmpFieldLen);
  if (iVar2 == 0) {
    PutIsoField(0x50,IsoInfo,tmpField,tmpFieldLen);
  }
  iVar2 = GetNpsField(0x53,NpsInfo,tmpField,&tmpFieldLen);
  if (iVar2 == 0) {
    PutIsoField(0x52,IsoInfo,tmpField,tmpFieldLen);
  }
  iVar2 = GetNpsField(0x54,NpsInfo,tmpField,&tmpFieldLen);
  if (iVar2 == 0) {
    PutIsoField(0x53,IsoInfo,tmpField,tmpFieldLen);
  }
  iVar2 = GetNpsField(0x55,NpsInfo,tmpField,&tmpFieldLen);
  if (iVar2 == 0) {
    PutIsoField(0x55,IsoInfo,tmpField,tmpFieldLen);
  }
  iVar2 = GetNpsField(0x56,NpsInfo,tmpField,&tmpFieldLen);
  if (iVar2 == 0) {
    PutIsoField(0x56,IsoInfo,tmpField,tmpFieldLen);
  }
  iVar2 = GetNpsField(0x57,NpsInfo,tmpField,&tmpFieldLen);
  if (iVar2 == 0) {
    PutIsoField(0x57,IsoInfo,tmpField,tmpFieldLen);
  }
  iVar2 = GetNpsField(0x58,NpsInfo,tmpField,&tmpFieldLen);
  if (iVar2 == 0) {
    PutIsoField(0x58,IsoInfo,tmpField,tmpFieldLen);
  }
  iVar2 = GetNpsField(0x59,NpsInfo,tmpField,&tmpFieldLen);
  if (iVar2 == 0) {
    PutIsoField(0x59,IsoInfo,tmpField,tmpFieldLen);
  }
  GetNpsField(0x5a,NpsInfo,tmpField,&tmpFieldLen);
  GetNpsField(0x5d,NpsInfo,tmpField,&tmpFieldLen);
  GetNpsField(0x5f,NpsInfo,tmpField,&tmpFieldLen);
  iVar2 = GetNpsField(0x60,NpsInfo,tmpField,&tmpFieldLen);
  if (iVar2 == 0) {
    PutIsoField(0x60,IsoInfo,tmpField,tmpFieldLen);
  }
  GetNpsField(0x61,NpsInfo,tmpField,&tmpFieldLen);
  GetNpsField(0x62,NpsInfo,tmpField,&tmpFieldLen);
  iVar2 = GetNpsField(99,NpsInfo,tmpField,&tmpFieldLen);
  if (iVar2 == 0) {
    PutIsoField(99,IsoInfo,tmpField,tmpFieldLen);
  }
  iVar2 = GetNpsField(0x65,NpsInfo,tmpField,&tmpFieldLen);
  if (iVar2 == 0) {
    PutIsoField(0x65,IsoInfo,tmpField,tmpFieldLen);
  }
  iVar2 = GetNpsField(0x66,NpsInfo,tmpField,&tmpFieldLen);
  if (iVar2 == 0) {
    PutIsoField(0x66,IsoInfo,tmpField,tmpFieldLen);
    iVar2 = IsoInfo->nMsgType;
  }
  else {
    iVar2 = IsoInfo->nMsgType;
  }
  if ((iVar2 == 0x44c) && (iVar2 = GetNpsField(0x6f,NpsInfo,tmpField,&tmpFieldLen), iVar2 != 0)) {
    sprintf(sLine,"MEL25082015... NPS_ADTNL_INFO = [%s]/[%d] ",tmpField,(ulong)(uint)tmpFieldLen);
    trace_event(sLine,5);
    puVar7 = (uint *)tmpField;
    do {
      puVar11 = puVar7;
      uVar4 = *puVar11 + 0xfefefeff & ~*puVar11;
      uVar3 = uVar4 & 0x80808080;
      puVar7 = puVar11 + 1;
    } while (uVar3 == 0);
    bVar16 = (uVar4 & 0x8080) == 0;
    if (bVar16) {
      uVar3 = uVar3 >> 0x10;
    }
    if (bVar16) {
      puVar7 = (uint *)((long)puVar11 + 6);
    }
    AddIsoField(0x6f,IsoInfo,tmpField,
                (((int)puVar7 + -3) - (uint)CARRY1((byte)uVar3,(byte)uVar3)) - (int)tmpField);
  }
  GetNpsField(0x72,NpsInfo,tmpField,&tmpFieldLen);
  GetNpsField(0x75,NpsInfo,tmpField,&tmpFieldLen);
  GetNpsField(0x76,NpsInfo,tmpField,&tmpFieldLen);
  GetNpsField(0x7c,NpsInfo,tmpField,&tmpFieldLen);
  GetNpsField(0x7d,NpsInfo,tmpField,&tmpFieldLen);
  GetNpsField(0x7e,NpsInfo,tmpField,&tmpFieldLen);
  if ((IsoInfo->nMsgType == 0x4b0) && (iVar2 = memcmp(szProcCode,&DAT_004a7e3d,2), iVar2 == 0)) {
    InitTlvAutho(&sTlvInfo);
    IsoToTlv(nIndexCtx,IsoInfo,&sTlvInfo);
    PutTlvAutho("288",&sTlvInfo,"ASM",3);
    PutTlvAutho("201",&sTlvInfo,G_sNps.F_szRsrcId,6);
    AuthoBuildTlv(sTlvBuffer,&sTlvInfo);
    iVar2 = GetOrgnlData(nIndexCtx,sTlvBuffer,szRespCode,szOrgnlData,szOrgnlRefNbr,szOrgnlAuthId);
    if (iVar2 == 0) {
      iVar2 = PutIsoField(0x24,IsoInfo,szOrgnlRefNbr,0xc);
      if (iVar2 != 0) {
        InsertIsoField(0x24,IsoInfo,szOrgnlRefNbr,0xc);
      }
      iVar2 = PutIsoField(0x25,IsoInfo,szOrgnlAuthId,6);
      if (iVar2 != 0) {
        InsertIsoField(0x25,IsoInfo,szOrgnlAuthId,6);
      }
      iVar2 = PutIsoField(0x37,IsoInfo,szOrgnlData,0x21);
      if (iVar2 != 0) {
        InsertIsoField(0x37,IsoInfo,szOrgnlData,0x23);
      }
    }
  }
  trace_event("End   ConvNpsToISO(OK)",5);
  return 0;
}



// WARNING: Unknown calling convention

int ConvIsoRespCodeToNps(char *pIsoRespCode,char *pNpsRespCode)

{
  int iVar1;
  char vTmpRespCode [3];
  char sLine [512];
  
  sprintf(sLine,"START   ConvIsoRespCodeToNps( Input  : %.3s )",pIsoRespCode);
  trace_event(sLine,5);
  vTmpRespCode._0_2_ = *(undefined2 *)pIsoRespCode;
  vTmpRespCode[2] = pIsoRespCode[2];
  iVar1 = memcmp(vTmpRespCode,"000",3);
  if (iVar1 == 0) {
    pNpsRespCode[0] = '0';
    pNpsRespCode[1] = '0';
  }
  else {
    iVar1 = memcmp(vTmpRespCode,"001",3);
    if (iVar1 == 0) {
      pNpsRespCode[0] = '0';
      pNpsRespCode[1] = '7';
    }
    else {
      iVar1 = memcmp(vTmpRespCode,&DAT_004a315e,3);
      if (iVar1 == 0) {
        pNpsRespCode[0] = '9';
        pNpsRespCode[1] = '6';
      }
      else {
        pIsoRespCode[0] = '9';
        pIsoRespCode[1] = '6';
      }
    }
  }
  sprintf(sLine,"END     ConvIsoRespCodeToNps( Output : %.2s )",pNpsRespCode);
  trace_event(sLine,5);
  return 0;
}



// WARNING: Unknown calling convention

int FCT_AUT_REQ_TO_NW(int nIndexCtx,TSIsoInfo *IsoInfo)

{
  int *piVar1;
  char acVar2 [4];
  undefined8 uVar3;
  int iVar4;
  uint uVar5;
  uint uVar6;
  char *pcVar7;
  void *pvVar8;
  long lVar9;
  size_t sVar10;
  uint *puVar11;
  uint *puVar12;
  uint *puVar13;
  TSTlvPrivate *pTVar14;
  uchar *puVar15;
  bool bVar16;
  byte bVar17;
  char *local_d8b0;
  int nIsAtmTrx;
  char PinFormat [3];
  char security_format [3];
  char vNpsF22 [4];
  int vTempLen;
  char sFunctionCode [4];
  char sAutTabInd [4];
  int FieldLen;
  int tmpFieldLen;
  char panlength [4];
  char vField113 [4];
  int nLength;
  char sMerchType [5];
  char slProcCode [7];
  char slNPSProcCode [7];
  char sAuthCode [7];
  char sSource [9];
  char vCrncy [10];
  char sAcquirerBank [12];
  char vNpsF41 [17];
  char PinData [17];
  char sPan [20];
  char sSourceCard [20];
  char CardNumber [23];
  char sAccountID1 [24];
  char destAccount [30];
  char field02 [30];
  char sDE112 [47];
  char sDE112NpsFormat [47];
  char vFetchKey [56];
  char szTermAddr [56];
  char sPurgeTime [128];
  char vTmpField [256];
  char szBusinessDate [256];
  char TransKey [257];
  char Awk [257];
  char sLine [512];
  TSTagNps NpsIccInfo;
  TSTagIso IsoIccInfo;
  TSNpsInfo vNpsInfo;
  char sTlvBuffer [4096];
  char vTempField [4096];
  char tmpField1 [4096];
  char tmpField [4096];
  char FieldData [4096];
  char sBuffer [4096];
  char sIccBuffer [4096];
  TSNodeData Node;
  TSTlvPrivate TlvInfo;
  
  bVar17 = 0;
  trace_event("Start FCT_AUT_REQ_TO_NW(.)",5);
  slProcCode[0] = '\0';
  slProcCode[1] = '\0';
  slProcCode[2] = '\0';
  slProcCode[3] = '\0';
  slNPSProcCode[4] = '\0';
  slNPSProcCode[5] = '\0';
  pcVar7 = sTlvBuffer;
  for (lVar9 = 0x200; lVar9 != 0; lVar9 = lVar9 + -1) {
    pcVar7[0] = '\0';
    pcVar7[1] = '\0';
    pcVar7[2] = '\0';
    pcVar7[3] = '\0';
    pcVar7[4] = '\0';
    pcVar7[5] = '\0';
    pcVar7[6] = '\0';
    pcVar7[7] = '\0';
    pcVar7 = pcVar7 + (ulong)bVar17 * -0x10 + 8;
  }
  vCrncy[8] = '\0';
  vCrncy[9] = '\0';
  slProcCode[6] = '\0';
  slNPSProcCode[0] = '\0';
  slNPSProcCode[1] = '\0';
  slNPSProcCode[2] = '\0';
  slNPSProcCode[3] = '\0';
  slNPSProcCode[6] = '\0';
  CardNumber[0] = '\0';
  CardNumber[1] = '\0';
  CardNumber[2] = '\0';
  CardNumber[3] = '\0';
  CardNumber[4] = '\0';
  CardNumber[5] = '\0';
  CardNumber[6] = '\0';
  CardNumber[7] = '\0';
  CardNumber[8] = '\0';
  CardNumber[9] = '\0';
  CardNumber[10] = '\0';
  CardNumber[0xb] = '\0';
  CardNumber[0xc] = '\0';
  CardNumber[0xd] = '\0';
  CardNumber[0xe] = '\0';
  CardNumber[0xf] = '\0';
  CardNumber[0x10] = '\0';
  CardNumber[0x11] = '\0';
  CardNumber[0x12] = '\0';
  CardNumber[0x13] = '\0';
  CardNumber[0x16] = '\0';
  vNpsF22[0] = '\0';
  vNpsF22[1] = '\0';
  vNpsF22[2] = '\0';
  vNpsF22[3] = '\0';
  vNpsF41[0] = '\0';
  vNpsF41[1] = '\0';
  vNpsF41[2] = '\0';
  vNpsF41[3] = '\0';
  vNpsF41[4] = '\0';
  vNpsF41[5] = '\0';
  vNpsF41[6] = '\0';
  vNpsF41[7] = '\0';
  vNpsF41[8] = '\0';
  vNpsF41[9] = '\0';
  vNpsF41[10] = '\0';
  vNpsF41[0xb] = '\0';
  vNpsF41[0xc] = '\0';
  vNpsF41[0xd] = '\0';
  vNpsF41[0xe] = '\0';
  vNpsF41[0xf] = '\0';
  pcVar7 = sIccBuffer;
  for (lVar9 = 0x200; lVar9 != 0; lVar9 = lVar9 + -1) {
    pcVar7[0] = '\0';
    pcVar7[1] = '\0';
    pcVar7[2] = '\0';
    pcVar7[3] = '\0';
    pcVar7[4] = '\0';
    pcVar7[5] = '\0';
    pcVar7[6] = '\0';
    pcVar7[7] = '\0';
    pcVar7 = pcVar7 + (ulong)bVar17 * -0x10 + 8;
  }
  vNpsF41[0x10] = '\0';
  vCrncy[0] = '\0';
  vCrncy[1] = '\0';
  vCrncy[2] = '\0';
  vCrncy[3] = '\0';
  vCrncy[4] = '\0';
  vCrncy[5] = '\0';
  vCrncy[6] = '\0';
  vCrncy[7] = '\0';
  pcVar7 = tmpField;
  for (lVar9 = 0x200; lVar9 != 0; lVar9 = lVar9 + -1) {
    pcVar7[0] = '\0';
    pcVar7[1] = '\0';
    pcVar7[2] = '\0';
    pcVar7[3] = '\0';
    pcVar7[4] = '\0';
    pcVar7[5] = '\0';
    pcVar7[6] = '\0';
    pcVar7[7] = '\0';
    pcVar7 = pcVar7 + (ulong)bVar17 * -0x10 + 8;
  }
  slProcCode[4] = '\0';
  slProcCode[5] = '\0';
  pcVar7 = tmpField1;
  for (lVar9 = 0x200; lVar9 != 0; lVar9 = lVar9 + -1) {
    pcVar7[0] = '\0';
    pcVar7[1] = '\0';
    pcVar7[2] = '\0';
    pcVar7[3] = '\0';
    pcVar7[4] = '\0';
    pcVar7[5] = '\0';
    pcVar7[6] = '\0';
    pcVar7[7] = '\0';
    pcVar7 = pcVar7 + (ulong)bVar17 * -0x10 + 8;
  }
  pcVar7 = FieldData;
  for (lVar9 = 0x200; lVar9 != 0; lVar9 = lVar9 + -1) {
    pcVar7[0] = '\0';
    pcVar7[1] = '\0';
    pcVar7[2] = '\0';
    pcVar7[3] = '\0';
    pcVar7[4] = '\0';
    pcVar7[5] = '\0';
    pcVar7[6] = '\0';
    pcVar7[7] = '\0';
    pcVar7 = pcVar7 + (ulong)bVar17 * -0x10 + 8;
  }
  pcVar7 = sLine;
  for (lVar9 = 0x40; lVar9 != 0; lVar9 = lVar9 + -1) {
    pcVar7[0] = '\0';
    pcVar7[1] = '\0';
    pcVar7[2] = '\0';
    pcVar7[3] = '\0';
    pcVar7[4] = '\0';
    pcVar7[5] = '\0';
    pcVar7[6] = '\0';
    pcVar7[7] = '\0';
    pcVar7 = pcVar7 + (ulong)bVar17 * -0x10 + 8;
  }
  CardNumber[0x14] = '\0';
  CardNumber[0x15] = '\0';
  pcVar7 = vTempField;
  for (lVar9 = 0x200; lVar9 != 0; lVar9 = lVar9 + -1) {
    pcVar7[0] = '\0';
    pcVar7[1] = '\0';
    pcVar7[2] = '\0';
    pcVar7[3] = '\0';
    pcVar7[4] = '\0';
    pcVar7[5] = '\0';
    pcVar7[6] = '\0';
    pcVar7[7] = '\0';
    pcVar7 = pcVar7 + (ulong)bVar17 * -0x10 + 8;
  }
  pcVar7 = sBuffer;
  for (lVar9 = 0x200; lVar9 != 0; lVar9 = lVar9 + -1) {
    pcVar7[0] = '\0';
    pcVar7[1] = '\0';
    pcVar7[2] = '\0';
    pcVar7[3] = '\0';
    pcVar7[4] = '\0';
    pcVar7[5] = '\0';
    pcVar7[6] = '\0';
    pcVar7[7] = '\0';
    pcVar7 = pcVar7 + (ulong)bVar17 * -0x10 + 8;
  }
  pcVar7 = szTermAddr;
  for (lVar9 = 7; lVar9 != 0; lVar9 = lVar9 + -1) {
    pcVar7[0] = '\0';
    pcVar7[1] = '\0';
    pcVar7[2] = '\0';
    pcVar7[3] = '\0';
    pcVar7[4] = '\0';
    pcVar7[5] = '\0';
    pcVar7[6] = '\0';
    pcVar7[7] = '\0';
    pcVar7 = pcVar7 + (ulong)bVar17 * -0x10 + 8;
  }
  pcVar7 = vTmpField;
  for (lVar9 = 0x20; lVar9 != 0; lVar9 = lVar9 + -1) {
    pcVar7[0] = '\0';
    pcVar7[1] = '\0';
    pcVar7[2] = '\0';
    pcVar7[3] = '\0';
    pcVar7[4] = '\0';
    pcVar7[5] = '\0';
    pcVar7[6] = '\0';
    pcVar7[7] = '\0';
    pcVar7 = pcVar7 + (ulong)bVar17 * -0x10 + 8;
  }
  pcVar7 = TransKey;
  for (lVar9 = 0x20; lVar9 != 0; lVar9 = lVar9 + -1) {
    pcVar7[0] = '\0';
    pcVar7[1] = '\0';
    pcVar7[2] = '\0';
    pcVar7[3] = '\0';
    pcVar7[4] = '\0';
    pcVar7[5] = '\0';
    pcVar7[6] = '\0';
    pcVar7[7] = '\0';
    pcVar7 = pcVar7 + (ulong)bVar17 * -0x10 + 8;
  }
  *pcVar7 = '\0';
  PinFormat[0] = '\0';
  PinFormat[1] = '\0';
  security_format[0] = '\0';
  security_format[1] = '\0';
  sAuthCode[4] = '\0';
  sAuthCode[5] = '\0';
  pcVar7 = Awk;
  for (lVar9 = 0x20; lVar9 != 0; lVar9 = lVar9 + -1) {
    pcVar7[0] = '\0';
    pcVar7[1] = '\0';
    pcVar7[2] = '\0';
    pcVar7[3] = '\0';
    pcVar7[4] = '\0';
    pcVar7[5] = '\0';
    pcVar7[6] = '\0';
    pcVar7[7] = '\0';
    pcVar7 = pcVar7 + (ulong)bVar17 * -0x10 + 8;
  }
  PinData[0] = '\0';
  PinData[1] = '\0';
  PinData[2] = '\0';
  PinData[3] = '\0';
  PinData[4] = '\0';
  PinData[5] = '\0';
  PinData[6] = '\0';
  PinData[7] = '\0';
  PinData[8] = '\0';
  PinData[9] = '\0';
  PinData[10] = '\0';
  PinData[0xb] = '\0';
  PinData[0xc] = '\0';
  PinData[0xd] = '\0';
  PinData[0xe] = '\0';
  PinData[0xf] = '\0';
  PinData[0x10] = '\0';
  PinFormat[2] = '\0';
  security_format[2] = '\0';
  sMerchType[0] = '\0';
  sMerchType[1] = '\0';
  sMerchType[2] = '\0';
  sMerchType[3] = '\0';
  sMerchType[4] = '\0';
  sFunctionCode[0] = '\0';
  sFunctionCode[1] = '\0';
  sFunctionCode[2] = '\0';
  sFunctionCode[3] = '\0';
  sAuthCode[0] = '\0';
  sAuthCode[1] = '\0';
  sAuthCode[2] = '\0';
  sAuthCode[3] = '\0';
  sAuthCode[6] = '\0';
  *pcVar7 = '\0';
  sAcquirerBank[0] = '\0';
  sAcquirerBank[1] = '\0';
  sAcquirerBank[2] = '\0';
  sAcquirerBank[3] = '\0';
  sAcquirerBank[4] = '\0';
  sAcquirerBank[5] = '\0';
  sAcquirerBank[6] = '\0';
  sAcquirerBank[7] = '\0';
  sAcquirerBank[8] = '\0';
  sAcquirerBank[9] = '\0';
  sAcquirerBank[10] = '\0';
  sAcquirerBank[0xb] = '\0';
  pcVar7 = vFetchKey;
  for (lVar9 = 7; lVar9 != 0; lVar9 = lVar9 + -1) {
    pcVar7[0] = '\0';
    pcVar7[1] = '\0';
    pcVar7[2] = '\0';
    pcVar7[3] = '\0';
    pcVar7[4] = '\0';
    pcVar7[5] = '\0';
    pcVar7[6] = '\0';
    pcVar7[7] = '\0';
    pcVar7 = pcVar7 + (ulong)bVar17 * -0x10 + 8;
  }
  sSource[0] = '\0';
  sSource[1] = '\0';
  sSource[2] = '\0';
  sSource[3] = '\0';
  sSource[4] = '\0';
  sSource[5] = '\0';
  sSource[6] = '\0';
  sSource[7] = '\0';
  sSource[8] = '\0';
  sPan[0] = '\0';
  sPan[1] = '\0';
  sPan[2] = '\0';
  sPan[3] = '\0';
  sPan[4] = '\0';
  sPan[5] = '\0';
  sPan[6] = '\0';
  sPan[7] = '\0';
  sPan[8] = '\0';
  sPan[9] = '\0';
  sPan[10] = '\0';
  sPan[0xb] = '\0';
  sPan[0xc] = '\0';
  sPan[0xd] = '\0';
  sPan[0xe] = '\0';
  sPan[0xf] = '\0';
  sPan[0x10] = '\0';
  sPan[0x11] = '\0';
  sPan[0x12] = '\0';
  sPan[0x13] = '\0';
  pcVar7 = szBusinessDate;
  for (lVar9 = 0x20; lVar9 != 0; lVar9 = lVar9 + -1) {
    pcVar7[0] = '\0';
    pcVar7[1] = '\0';
    pcVar7[2] = '\0';
    pcVar7[3] = '\0';
    pcVar7[4] = '\0';
    pcVar7[5] = '\0';
    pcVar7[6] = '\0';
    pcVar7[7] = '\0';
    pcVar7 = pcVar7 + (ulong)bVar17 * -0x10 + 8;
  }
  puVar15 = (uchar *)sDE112;
  for (lVar9 = 5; lVar9 != 0; lVar9 = lVar9 + -1) {
    puVar15[0] = '\0';
    puVar15[1] = '\0';
    puVar15[2] = '\0';
    puVar15[3] = '\0';
    puVar15[4] = '\0';
    puVar15[5] = '\0';
    puVar15[6] = '\0';
    puVar15[7] = '\0';
    puVar15 = puVar15 + (ulong)bVar17 * -0x10 + 8;
  }
  puVar15[4] = '\0';
  puVar15[5] = '\0';
  puVar15[0] = '\0';
  puVar15[1] = '\0';
  puVar15[2] = '\0';
  puVar15[3] = '\0';
  puVar15[6] = '\0';
  sSourceCard[0] = '\0';
  sSourceCard[1] = '\0';
  sSourceCard[2] = '\0';
  sSourceCard[3] = '\0';
  sSourceCard[4] = '\0';
  sSourceCard[5] = '\0';
  sSourceCard[6] = '\0';
  sSourceCard[7] = '\0';
  destAccount[0x1c] = '\0';
  destAccount[0x1d] = '\0';
  sSourceCard[8] = '\0';
  sSourceCard[9] = '\0';
  sSourceCard[10] = '\0';
  sSourceCard[0xb] = '\0';
  sSourceCard[0xc] = '\0';
  sSourceCard[0xd] = '\0';
  sSourceCard[0xe] = '\0';
  sSourceCard[0xf] = '\0';
  sSourceCard[0x10] = '\0';
  sSourceCard[0x11] = '\0';
  sSourceCard[0x12] = '\0';
  sSourceCard[0x13] = '\0';
  puVar15 = (uchar *)sDE112NpsFormat;
  for (lVar9 = 5; lVar9 != 0; lVar9 = lVar9 + -1) {
    puVar15[0] = '\0';
    puVar15[1] = '\0';
    puVar15[2] = '\0';
    puVar15[3] = '\0';
    puVar15[4] = '\0';
    puVar15[5] = '\0';
    puVar15[6] = '\0';
    puVar15[7] = '\0';
    puVar15 = puVar15 + (ulong)bVar17 * -0x10 + 8;
  }
  destAccount[0] = '\0';
  destAccount[1] = '\0';
  destAccount[2] = '\0';
  destAccount[3] = '\0';
  destAccount[4] = '\0';
  destAccount[5] = '\0';
  destAccount[6] = '\0';
  destAccount[7] = '\0';
  destAccount[8] = '\0';
  destAccount[9] = '\0';
  destAccount[10] = '\0';
  destAccount[0xb] = '\0';
  destAccount[0xc] = '\0';
  destAccount[0xd] = '\0';
  destAccount[0xe] = '\0';
  destAccount[0xf] = '\0';
  destAccount[0x10] = '\0';
  destAccount[0x11] = '\0';
  destAccount[0x12] = '\0';
  destAccount[0x13] = '\0';
  destAccount[0x14] = '\0';
  destAccount[0x15] = '\0';
  destAccount[0x16] = '\0';
  destAccount[0x17] = '\0';
  destAccount[0x18] = '\0';
  destAccount[0x19] = '\0';
  destAccount[0x1a] = '\0';
  destAccount[0x1b] = '\0';
  panlength[0] = '\0';
  panlength[1] = '\0';
  panlength[2] = '\0';
  panlength[3] = '\0';
  vField113[0] = '\0';
  vField113[1] = '\0';
  vField113[2] = '\0';
  vField113[3] = '\0';
  sAccountID1[0] = '\0';
  sAccountID1[1] = '\0';
  sAccountID1[2] = '\0';
  sAccountID1[3] = '\0';
  sAccountID1[4] = '\0';
  sAccountID1[5] = '\0';
  sAccountID1[6] = '\0';
  sAccountID1[7] = '\0';
  sAccountID1[8] = '\0';
  sAccountID1[9] = '\0';
  sAccountID1[10] = '\0';
  sAccountID1[0xb] = '\0';
  sAccountID1[0xc] = '\0';
  sAccountID1[0xd] = '\0';
  sAccountID1[0xe] = '\0';
  sAccountID1[0xf] = '\0';
  sAccountID1[0x10] = '\0';
  sAccountID1[0x11] = '\0';
  sAccountID1[0x12] = '\0';
  sAccountID1[0x13] = '\0';
  sAccountID1[0x14] = '\0';
  sAccountID1[0x15] = '\0';
  sAccountID1[0x16] = '\0';
  sAccountID1[0x17] = '\0';
  puVar15[4] = '\0';
  puVar15[5] = '\0';
  puVar15[0] = '\0';
  puVar15[1] = '\0';
  puVar15[2] = '\0';
  puVar15[3] = '\0';
  puVar15[6] = '\0';
  pcVar7 = sPurgeTime;
  for (lVar9 = 0x10; lVar9 != 0; lVar9 = lVar9 + -1) {
    pcVar7[0] = '\0';
    pcVar7[1] = '\0';
    pcVar7[2] = '\0';
    pcVar7[3] = '\0';
    pcVar7[4] = '\0';
    pcVar7[5] = '\0';
    pcVar7[6] = '\0';
    pcVar7[7] = '\0';
    pcVar7 = pcVar7 + (ulong)bVar17 * -0x10 + 8;
  }
  dump_p7_struct(IsoInfo);
  iVar4 = GetIsoField(0x11,IsoInfo,sMerchType,&vTempLen);
  nIsAtmTrx = -1;
  if (iVar4 == 0) {
    iVar4 = memcmp(sMerchType,&DAT_004a4ee6,4);
    nIsAtmTrx = -(uint)(iVar4 != 0);
  }
  InitNpsInfo(&vNpsInfo);
  vNpsInfo.nMsgType = 100;
  iVar4 = GetIsoField(0x17,IsoInfo,vTempField,&vTempLen);
  if ((iVar4 == 0) && (iVar4 = memcmp(vTempField,&DAT_004a4df4,3), iVar4 == 0)) {
    vNpsInfo.nMsgType = 100;
  }
  iVar4 = GetIsoField(1,IsoInfo,vTempField,&vTempLen);
  if (iVar4 == 0) {
    sprintf(sLine,"PAN --> (%s) ",sPan);
    trace_event(sLine,5);
    memcpy(sPan,vTempField,(long)vTempLen);
  }
  iVar4 = GetIsoField(2,IsoInfo,slProcCode,&vTempLen);
  if (iVar4 == 0) {
    slNPSProcCode[0] = slProcCode[0];
    slNPSProcCode[1] = slProcCode[1];
    slNPSProcCode[2] = slProcCode[2];
    slNPSProcCode[3] = slProcCode[3];
    slNPSProcCode[4] = slProcCode[4];
    slNPSProcCode[5] = slProcCode[5];
    iVar4 = memcmp(slProcCode,&DAT_004c9c21,2);
    if (iVar4 == 0) {
      slNPSProcCode[0] = '3';
      slNPSProcCode[1] = '0';
    }
    iVar4 = memcmp(slProcCode,&DAT_004a7da4,2);
    if (iVar4 == 0) {
      slNPSProcCode[0] = '3';
      slNPSProcCode[1] = '2';
    }
    iVar4 = memcmp(slProcCode,&DAT_004a554a,2);
    if (iVar4 == 0) {
      slNPSProcCode[0] = '2';
      slNPSProcCode[1] = '8';
    }
    iVar4 = memcmp(slProcCode,&DAT_004a5543,2);
    if (iVar4 == 0) {
      slNPSProcCode[0] = '1';
      slNPSProcCode[1] = '0';
    }
    iVar4 = memcmp(slProcCode,&DAT_004a554a,2);
    if (iVar4 == 0) {
      iVar4 = GetIsoField(0x66,IsoInfo,vTempField,&FieldLen);
      if (iVar4 == 0) {
        memcpy(sSourceCard,vTempField,(long)FieldLen);
      }
      iVar4 = GetIsoField(0x70,IsoInfo,vTempField,&FieldLen);
      if ((iVar4 == 0) ||
         (iVar4 = memcmp(sMerchType,&DAT_004a4ef9,4), puVar11 = (uint *)sSourceCard, iVar4 == 0)) {
        pvVar8 = memcpy(vField113,vTempField,(long)FieldLen);
        sprintf(sLine,"ISO_RESERVED_ISO_4 --> (%s) ",pvVar8);
        trace_event(sLine,5);
        sVar10 = (size_t)FieldLen;
        iVar4 = memcmp(vTempField,&DAT_004a4f1b,sVar10);
        if (((iVar4 == 0) || (iVar4 = memcmp(vTempField,"ATA",sVar10), iVar4 == 0)) ||
           (((iVar4 = memcmp(sMerchType,&DAT_004a4ef9,4), puVar11 = (uint *)sSourceCard, iVar4 == 0
             && (iVar4 = memcmp(vTempField,&DAT_004a4f1f,sVar10), iVar4 != 0)) &&
            (iVar4 = memcmp(vTempField,&DAT_004a4f23,sVar10), iVar4 != 0)))) {
          uVar3 = sSourceCard._0_8_;
          puVar11 = (uint *)field02;
          builtin_strncpy(field02 + 6,"0000000000",0xb);
          field02[0x11] = '\0';
          field02[0x12] = '\0';
          field02[0x13] = '\0';
          field02[0x14] = '\0';
          field02[0x15] = '\0';
          field02[0x16] = '\0';
          field02[0x17] = '\0';
          field02[0x18] = '\0';
          field02[0x19] = '\0';
          field02[0x1a] = '\0';
          field02[0x1b] = '\0';
          field02[0x1c] = '\0';
          field02[0x1d] = '\0';
          field02[0] = sSourceCard[0];
          field02[1] = sSourceCard[1];
          field02[2] = sSourceCard[2];
          field02[3] = sSourceCard[3];
          sSourceCard._4_2_ = SUB82(uVar3,4);
          field02[4] = sSourceCard[4];
          field02[5] = sSourceCard[5];
          puVar13 = (uint *)sSourceCard;
          do {
            puVar12 = puVar13;
            uVar5 = *puVar12 + 0xfefefeff & ~*puVar12;
            uVar6 = uVar5 & 0x80808080;
            puVar13 = puVar12 + 1;
          } while (uVar6 == 0);
          bVar16 = (uVar5 & 0x8080) == 0;
          if (bVar16) {
            uVar6 = uVar6 >> 0x10;
          }
          if (bVar16) {
            puVar13 = (uint *)((long)puVar12 + 6);
          }
          sSourceCard._0_8_ = uVar3;
          memcpy(destAccount,sSourceCard + 6,
                 (size_t)((long)puVar13 +
                         (-(long)sSourceCard - (ulong)CARRY1((byte)uVar6,(byte)uVar6)) + -9));
          puVar13 = puVar11;
          do {
            uVar6 = *puVar13;
            puVar13 = puVar13 + 1;
            uVar6 = uVar6 + 0xfefefeff & ~uVar6 & 0x80808080;
          } while (uVar6 == 0);
          goto LAB_004118c2;
        }
        do {
          puVar13 = puVar11 + 1;
          uVar6 = *puVar11 + 0xfefefeff & ~*puVar11 & 0x80808080;
          puVar11 = puVar13;
        } while (uVar6 == 0);
      }
      else {
        do {
          puVar13 = puVar11 + 1;
          uVar6 = *puVar11 + 0xfefefeff & ~*puVar11 & 0x80808080;
          puVar11 = puVar13;
        } while (uVar6 == 0);
      }
      bVar16 = (uVar6 & 0x8080) == 0;
      if (bVar16) {
        uVar6 = uVar6 >> 0x10;
      }
      iVar4 = (int)puVar13;
      if (bVar16) {
        iVar4 = (int)puVar13 + 2;
      }
      AddNpsField(1,&vNpsInfo,sSourceCard,
                  ((iVar4 + -3) - (uint)CARRY1((byte)uVar6,(byte)uVar6)) - (int)sSourceCard);
    }
    else {
      puVar11 = (uint *)sPan;
      puVar13 = puVar11;
      do {
        uVar6 = *puVar13;
        puVar13 = puVar13 + 1;
        uVar6 = uVar6 + 0xfefefeff & ~uVar6 & 0x80808080;
      } while (uVar6 == 0);
LAB_004118c2:
      bVar16 = (uVar6 & 0x8080) == 0;
      if (bVar16) {
        uVar6 = uVar6 >> 0x10;
      }
      iVar4 = (int)puVar13;
      if (bVar16) {
        iVar4 = (int)puVar13 + 2;
      }
      AddNpsField(1,&vNpsInfo,(char *)puVar11,
                  ((iVar4 + -3) - (uint)CARRY1((byte)uVar6,(byte)uVar6)) - (int)puVar11);
    }
    AddNpsField(2,&vNpsInfo,slNPSProcCode,vTempLen);
  }
  local_d8b0 = slNPSProcCode;
  iVar4 = memcmp(local_d8b0,&DAT_004c759e,2);
  if ((iVar4 == 0) || (iVar4 = memcmp(local_d8b0,&DAT_004a9095,2), iVar4 == 0)) {
    AddNpsField(3,&vNpsInfo,"000000000000",0xc);
  }
  else {
    iVar4 = GetIsoField(3,IsoInfo,vTempField,&vTempLen);
    if (iVar4 == 0) {
      AddNpsField(3,&vNpsInfo,vTempField,vTempLen);
    }
  }
  iVar4 = memcmp(local_d8b0,&DAT_004c759e,2);
  if (iVar4 == 0) {
    AddNpsField(5,&vNpsInfo,"000000000000",0xc);
  }
  else {
    iVar4 = memcmp(local_d8b0,&DAT_004a9095,2);
    if ((iVar4 != 0) && (iVar4 = GetIsoField(5,IsoInfo,vTempField,&vTempLen), iVar4 == 0)) {
      AddNpsField(5,&vNpsInfo,vTempField,vTempLen);
    }
  }
  iVar4 = GetIsoField(6,IsoInfo,vTempField,&vTempLen);
  if (iVar4 == 0) {
    AddNpsField(6,&vNpsInfo,vTempField,vTempLen);
  }
  pcVar7 = vTempField;
  for (lVar9 = 0x200; lVar9 != 0; lVar9 = lVar9 + -1) {
    pcVar7[0] = '\0';
    pcVar7[1] = '\0';
    pcVar7[2] = '\0';
    pcVar7[3] = '\0';
    pcVar7[4] = '\0';
    pcVar7[5] = '\0';
    pcVar7[6] = '\0';
    pcVar7[7] = '\0';
    pcVar7 = pcVar7 + (ulong)bVar17 * -0x10 + 8;
  }
  iVar4 = memcmp(local_d8b0,&DAT_004c759e,2);
  if (iVar4 == 0) {
    AddNpsField(9,&vNpsInfo,"00000001",8);
  }
  else {
    iVar4 = GetIsoField(5,IsoInfo,vTempField,&vTempLen);
    if ((iVar4 == 0) && (iVar4 = GetIsoField(9,IsoInfo,vTempField,&vTempLen), iVar4 == 0)) {
      AddNpsField(9,&vNpsInfo,vTempField,vTempLen);
    }
  }
  iVar4 = GetIsoField(10,IsoInfo,vTempField,&vTempLen);
  if (iVar4 == 0) {
    AddNpsField(10,&vNpsInfo,vTempField,vTempLen);
  }
  iVar4 = GetIsoField(0xb,IsoInfo,vTempField,&vTempLen);
  if (iVar4 == 0) {
    AddNpsField(0xb,&vNpsInfo,vTempField + 6,6);
    AddNpsField(0xc,&vNpsInfo,vTempField + 2,4);
  }
  iVar4 = GetIsoField(0xd,IsoInfo,vTempField,&vTempLen);
  if (iVar4 == 0) {
    AddNpsField(0xd,&vNpsInfo,vTempField,vTempLen);
  }
  iVar4 = memcmp(sMerchType,&DAT_004a4ef9,4);
  if ((iVar4 == 0) && (iVar4 = memcmp(slProcCode,&DAT_004a554a,2), iVar4 == 0)) {
    AddNpsField(0x11,&vNpsInfo,"6013",4);
  }
  else {
    iVar4 = GetIsoField(0x11,IsoInfo,sMerchType,&vTempLen);
    if (iVar4 == 0) {
      AddNpsField(0x11,&vNpsInfo,sMerchType,vTempLen);
    }
  }
  iVar4 = GetIsoField(0x15,IsoInfo,vTempField,&vTempLen);
  if (iVar4 == 0) {
    sprintf(sLine,"==> ISO F22=[%s]",vTempField);
    trace_event(sLine,5);
    vNpsF22[0] = '\0';
    vNpsF22[1] = '\0';
    vNpsF22[2] = '1';
    vNpsF22[0] = '0';
    vNpsF22[1] = '0';
    if (vTempField[6] == '1') {
      vNpsF22[0] = '0';
      vNpsF22[1] = '1';
    }
    else if (vTempField[6] == '2') {
      vNpsF22[0] = '9';
      vNpsF22[1] = '0';
    }
    else if (vTempField[6] == '3') {
      vNpsF22[0] = '0';
      vNpsF22[1] = '7';
    }
    else if (vTempField[6] == '4') {
      vNpsF22[0] = '0';
      vNpsF22[1] = '4';
    }
    else if (vTempField[6] == '5') {
      vNpsF22[0] = '0';
      vNpsF22[1] = '5';
    }
    TlvInfo.nPresent._0_8_ = (ulong)(uint)TlvInfo.nPresent[1] << 0x20;
    iVar4 = GetIsoField(0x27,IsoInfo,(char *)&TlvInfo,&vTempLen);
    if (iVar4 != 0) {
      TlvInfo.nPresent[0]._0_3_ = 0x580000;
      TlvInfo.nPresent[0]._0_2_ = 0x5858;
    }
    sprintf(sLine,"Postion 1 = [%c], Posistion 7 = [%c], Service Code(1) = [%c]",
            (ulong)(uint)(int)vTempField[0],(ulong)(uint)(int)vTempField[6],
            (ulong)(uint)(int)(char)(byte)TlvInfo.nPresent[0]);
    trace_event(sLine,4);
    if (((vTempField[0] == '5') && (vTempField[6] != '5')) &&
       (((byte)TlvInfo.nPresent[0] & 0xfb) == 0x32)) {
      vNpsF22[0] = '8';
      vNpsF22[1] = '0';
    }
    if (vTempField[0xb] == '0') {
      vNpsF22[2] = '0';
    }
    iVar4 = memcmp(sMerchType,&DAT_004a4ef9,4);
    if ((iVar4 == 0) && (iVar4 = memcmp(slProcCode,&DAT_004a554a,2), iVar4 == 0)) {
      vNpsF22[0] = '\0';
      vNpsF22[1] = '\0';
      vNpsF22[2] = '0';
      vNpsF22[0] = '0';
      vNpsF22[1] = '0';
    }
    AddNpsField(0x15,&vNpsInfo,vNpsF22,3);
  }
  iVar4 = GetIsoField(0x16,IsoInfo,vTempField,&vTempLen);
  if (iVar4 == 0) {
    AddNpsField(0x16,&vNpsInfo,vTempField,vTempLen);
  }
  AddNpsField(0x1f,&vNpsInfo,"000095",6);
  iVar4 = GetIsoField(0x22,IsoInfo,vTempField,&vTempLen);
  if (iVar4 == 0) {
    pcVar7 = vTempField;
    do {
      while (*pcVar7 == '=') {
        *pcVar7 = 'D';
        pcVar7 = pcVar7 + 1;
        if (pcVar7 == vTempField + 0x17) goto LAB_0040feca;
      }
      pcVar7 = pcVar7 + 1;
    } while (pcVar7 != vTempField + 0x17);
LAB_0040feca:
    iVar4 = memcmp(local_d8b0,&DAT_004c9c1d,2);
    if (iVar4 != 0) {
      AddNpsField(0x22,&vNpsInfo,vTempField,vTempLen);
    }
  }
  iVar4 = GetIsoField(0x24,IsoInfo,vTempField,&vTempLen);
  if (iVar4 == 0) {
    AddNpsField(0x24,&vNpsInfo,vTempField,vTempLen);
  }
  iVar4 = GetIsoField(0x25,IsoInfo,vTempField,&vTempLen);
  if (iVar4 == 0) {
    AddNpsField(0x25,&vNpsInfo,vTempField,vTempLen);
  }
  iVar4 = GetIsoField(0x28,IsoInfo,vTempField,&vTempLen);
  if (iVar4 == 0) {
    builtin_strncpy(vNpsF41 + 8,"        ",8);
    vNpsF41[4] = vTempField[4];
    vNpsF41[5] = vTempField[5];
    vNpsF41[0] = vTempField[0];
    vNpsF41[1] = vTempField[1];
    vNpsF41[2] = vTempField[2];
    vNpsF41[3] = vTempField[3];
    vNpsF41[6] = vTempField[6];
    vNpsF41[7] = vTempField[7];
    AddNpsField(0x28,&vNpsInfo,vNpsF41,8);
  }
  iVar4 = GetIsoField(0x29,IsoInfo,vTempField,&vTempLen);
  if (iVar4 == 0) {
    AddNpsField(0x29,&vNpsInfo,vTempField,vTempLen);
  }
  iVar4 = GetIsoField(0x2a,IsoInfo,vTempField,&vTempLen);
  if (iVar4 == 0) {
    vTempLen = sprintf(szTermAddr,"%22.22s%s%13.13s%2.2s",vTempField,"   ",vTempField + 0x17,
                       &DAT_004a4f41);
    sprintf(sLine," szTermAddr [%s]",szTermAddr);
    trace_event(sLine,5);
    AddNpsField(0x2a,&vNpsInfo,szTermAddr,vTempLen);
  }
  iVar4 = memcmp(local_d8b0,&DAT_004c9c1d,2);
  if (iVar4 == 0) {
    sVar10 = (size_t)FieldLen;
    TlvInfo.nPresent[2] = 0;
    TlvInfo.nPresent[3] = 0;
    TlvInfo.nPresent[4] = 0;
    TlvInfo.nPresent[5]._0_2_ = 0;
    TlvInfo.nPresent[5]._2_1_ = 0;
    TlvInfo.nPresent[0] = 0x30373239;
    TlvInfo.nPresent[1] = 0;
    iVar4 = memcmp(vField113,"ATA",sVar10);
    if ((iVar4 == 0) || (iVar4 = memcmp(vField113,&DAT_004a4f23,sVar10), iVar4 == 0)) {
      GetIsoField(0x65,IsoInfo,sAccountID1,&vTempLen);
      puVar11 = (uint *)sAccountID1;
      do {
        puVar13 = puVar11;
        uVar5 = *puVar13 + 0xfefefeff & ~*puVar13;
        uVar6 = uVar5 & 0x80808080;
        puVar11 = puVar13 + 1;
      } while (uVar6 == 0);
      bVar16 = (uVar5 & 0x8080) == 0;
      if (bVar16) {
        uVar6 = uVar6 >> 0x10;
      }
      if (bVar16) {
        puVar11 = (uint *)((long)puVar13 + 6);
      }
      sprintf(sLine," Account_length [%d]",
              (char *)((long)puVar11 +
                      ((-3 - (ulong)CARRY1((byte)uVar6,(byte)uVar6)) - (long)sAccountID1)));
      trace_event(sLine,5);
      sprintf(sLine," Account_ [%s]",sAccountID1);
      trace_event(sLine,5);
      puVar11 = (uint *)sAccountID1;
      do {
        puVar13 = puVar11;
        uVar5 = *puVar13 + 0xfefefeff & ~*puVar13;
        uVar6 = uVar5 & 0x80808080;
        puVar11 = puVar13 + 1;
      } while (uVar6 == 0);
      bVar16 = (uVar5 & 0x8080) == 0;
      if (bVar16) {
        uVar6 = uVar6 >> 0x10;
      }
      if (bVar16) {
        puVar11 = (uint *)((long)puVar13 + 6);
      }
      sprintf(panlength,"%d",
              (char *)((long)puVar11 +
                      ((-3 - (ulong)CARRY1((byte)uVar6,(byte)uVar6)) - (long)sAccountID1)));
      acVar2 = panlength;
      TlvInfo.nPresent[1]._0_1_ = panlength[0];
      TlvInfo.nPresent[1]._1_1_ = panlength[1];
      puVar11 = (uint *)sAccountID1;
      do {
        puVar13 = puVar11;
        uVar5 = *puVar13 + 0xfefefeff & ~*puVar13;
        uVar6 = uVar5 & 0x80808080;
        puVar11 = puVar13 + 1;
      } while (uVar6 == 0);
      pTVar14 = &TlvInfo;
      bVar16 = (uVar5 & 0x8080) == 0;
      if (bVar16) {
        uVar6 = uVar6 >> 0x10;
      }
      if (bVar16) {
        puVar11 = (uint *)((long)puVar13 + 6);
      }
      panlength = acVar2;
      memcpy((void *)((long)TlvInfo.nPresent + 6),sAccountID1,
             (size_t)((long)puVar11 +
                     ((-3 - (ulong)CARRY1((byte)uVar6,(byte)uVar6)) - (long)sAccountID1)));
      do {
        piVar1 = pTVar14->nPresent;
        pTVar14 = (TSTlvPrivate *)(pTVar14->nPresent + 1);
        uVar6 = *piVar1 + 0xfefefeffU & ~*piVar1 & 0x80808080;
      } while (uVar6 == 0);
    }
    else {
      puVar11 = (uint *)sPan;
      do {
        puVar13 = puVar11;
        uVar5 = *puVar13 + 0xfefefeff & ~*puVar13;
        uVar6 = uVar5 & 0x80808080;
        puVar11 = puVar13 + 1;
      } while (uVar6 == 0);
      bVar16 = (uVar5 & 0x8080) == 0;
      if (bVar16) {
        uVar6 = uVar6 >> 0x10;
      }
      if (bVar16) {
        puVar11 = (uint *)((long)puVar13 + 6);
      }
      sprintf(sLine," Card [%d]",
              (long)puVar11 + ((-3 - (ulong)CARRY1((byte)uVar6,(byte)uVar6)) - (long)sPan));
      trace_event(sLine,5);
      puVar11 = (uint *)sPan;
      do {
        puVar13 = puVar11;
        uVar5 = *puVar13 + 0xfefefeff & ~*puVar13;
        uVar6 = uVar5 & 0x80808080;
        puVar11 = puVar13 + 1;
      } while (uVar6 == 0);
      bVar16 = (uVar5 & 0x8080) == 0;
      if (bVar16) {
        uVar6 = uVar6 >> 0x10;
      }
      if (bVar16) {
        puVar11 = (uint *)((long)puVar13 + 6);
      }
      sprintf(panlength,"%d",
              (long)puVar11 + ((-3 - (ulong)CARRY1((byte)uVar6,(byte)uVar6)) - (long)sPan));
      acVar2 = panlength;
      TlvInfo.nPresent[1]._0_1_ = panlength[0];
      TlvInfo.nPresent[1]._1_1_ = panlength[1];
      puVar11 = (uint *)sPan;
      do {
        puVar13 = puVar11;
        uVar5 = *puVar13 + 0xfefefeff & ~*puVar13;
        uVar6 = uVar5 & 0x80808080;
        puVar11 = puVar13 + 1;
      } while (uVar6 == 0);
      pTVar14 = &TlvInfo;
      bVar16 = (uVar5 & 0x8080) == 0;
      if (bVar16) {
        uVar6 = uVar6 >> 0x10;
      }
      if (bVar16) {
        puVar11 = (uint *)((long)puVar13 + 6);
      }
      panlength = acVar2;
      memcpy((void *)((long)TlvInfo.nPresent + 6),sPan,
             (long)puVar11 + ((-3 - (ulong)CARRY1((byte)uVar6,(byte)uVar6)) - (long)sPan));
      do {
        piVar1 = pTVar14->nPresent;
        pTVar14 = (TSTlvPrivate *)(pTVar14->nPresent + 1);
        uVar6 = *piVar1 + 0xfefefeffU & ~*piVar1 & 0x80808080;
      } while (uVar6 == 0);
    }
    bVar16 = (uVar6 & 0x8080) == 0;
    if (bVar16) {
      uVar6 = uVar6 >> 0x10;
    }
    iVar4 = (int)pTVar14;
    if (bVar16) {
      iVar4 = (int)pTVar14 + 2;
    }
    AddNpsField(0x2e,&vNpsInfo,(char *)&TlvInfo,
                ((iVar4 + -3) - (uint)CARRY1((byte)uVar6,(byte)uVar6)) - (int)&TlvInfo);
  }
  else {
    iVar4 = GetIsoField(0x2e,IsoInfo,vTempField,&vTempLen);
    if (iVar4 == 0) {
      AddNpsField(0x2e,&vNpsInfo,vTempField,vTempLen);
    }
  }
  iVar4 = GetIsoField(0x30,IsoInfo,vCrncy,&vTempLen);
  if (iVar4 == 0) {
    AddNpsField(0x30,&vNpsInfo,vCrncy,3);
LAB_00410228:
    iVar4 = memcmp(local_d8b0,&DAT_004a9095,2);
    if (iVar4 != 0) goto LAB_00410788;
  }
  else {
    iVar4 = memcmp(local_d8b0,&DAT_004c759e,2);
    if ((iVar4 == 0) || (iVar4 = memcmp(local_d8b0,&DAT_004a9095,2), iVar4 == 0)) {
      AddNpsField(0x30,&vNpsInfo,"050",3);
      goto LAB_00410228;
    }
LAB_00410788:
    iVar4 = GetIsoField(0x32,IsoInfo,vCrncy,&vTempLen);
    if (iVar4 == 0) {
      AddNpsField(0x32,&vNpsInfo,vCrncy,3);
    }
    else {
      iVar4 = memcmp(local_d8b0,&DAT_004c759e,2);
      if (iVar4 == 0) {
        AddNpsField(0x32,&vNpsInfo,"050",3);
      }
    }
  }
  iVar4 = memcmp(local_d8b0,&DAT_004c9c1d,2);
  if (iVar4 != 0) {
    iVar4 = GetIsoField(0x33,IsoInfo,PinData,&vTempLen);
    if (iVar4 == 0) {
      InitTlvPrivate(&TlvInfo);
      iVar4 = GetIsoField(0x2f,IsoInfo,vTempField,&vTempLen);
      if (iVar4 == 0) {
        AnalyseTlvPrivate(vTempField,vTempLen,&TlvInfo);
        pcVar7 = TransKey;
        for (lVar9 = 0x20; lVar9 != 0; lVar9 = lVar9 + -1) {
          pcVar7[0] = '\0';
          pcVar7[1] = '\0';
          pcVar7[2] = '\0';
          pcVar7[3] = '\0';
          pcVar7[4] = '\0';
          pcVar7[5] = '\0';
          pcVar7[6] = '\0';
          pcVar7[7] = '\0';
          pcVar7 = pcVar7 + (ulong)bVar17 * -0x10 + 8;
        }
        *pcVar7 = '\0';
        GetTlvPrivate("P10",&TlvInfo,TransKey,&vTempLen);
      }
      pcVar7 = Awk;
      for (lVar9 = 0x20; lVar9 != 0; lVar9 = lVar9 + -1) {
        pcVar7[0] = '\0';
        pcVar7[1] = '\0';
        pcVar7[2] = '\0';
        pcVar7[3] = '\0';
        pcVar7[4] = '\0';
        pcVar7[5] = '\0';
        pcVar7[6] = '\0';
        pcVar7[7] = '\0';
        pcVar7 = pcVar7 + (ulong)bVar17 * -0x10 + 8;
      }
      *pcVar7 = '\0';
      iVar4 = GetAWK(nIndexCtx,G_sNps.F_szRsrcId,Awk);
      if (iVar4 != 0) {
        trace_event("GetAWK Failed ",5);
        return -1;
      }
      iVar4 = GetIsoField(1,IsoInfo,CardNumber,&vTempLen);
      if (iVar4 != 0) {
        trace_event("Getting Card Number Failed ",5);
        return -1;
      }
      GetIsoField(0x34,IsoInfo,vTempField,&vTempLen);
      GetSecurityData(0,vTempField,security_format,&vTempLen);
      GetSecurityData(1,vTempField,PinFormat,&vTempLen);
      iVar4 = memcmp(security_format,"01",2);
      sprintf(sLine,"TransKey is |%s|",TransKey);
      trace_event(sLine,4);
      iVar4 = pin_translate(nIndexCtx,CardNumber,TransKey,Awk,PinData,PinFormat,"01",
                            ~-(iVar4 == 0) + 0x54);
      if (iVar4 != 0) {
        trace_event("pin_translate Failed",5);
        return -1;
      }
      AddNpsField(0x33,&vNpsInfo,PinData,0x10);
      AddNpsField(0x34,&vNpsInfo,"9801010000000000",0x10);
      trace_event("Pin BASED TRANSACTION",5);
    }
  }
  iVar4 = GetIsoField(0x36,IsoInfo,tmpField,&tmpFieldLen);
  if (iVar4 == 0) {
    sprintf(sLine,"ISO_ICC_DATA   = %s||Lenght = %d ",tmpField,(ulong)(uint)tmpFieldLen);
    trace_event(sLine,5);
    InitIsoIcTag(&IsoIccInfo);
    AnalyseIsoIc(tmpField,tmpFieldLen,&IsoIccInfo);
    InitNpsIcTag(&NpsIccInfo);
    pcVar7 = FieldData;
    for (lVar9 = 0x200; lVar9 != 0; lVar9 = lVar9 + -1) {
      pcVar7[0] = '\0';
      pcVar7[1] = '\0';
      pcVar7[2] = '\0';
      pcVar7[3] = '\0';
      pcVar7[4] = '\0';
      pcVar7[5] = '\0';
      pcVar7[6] = '\0';
      pcVar7[7] = '\0';
      pcVar7 = pcVar7 + (ulong)bVar17 * -0x10 + 8;
    }
    iVar4 = GetIsoIcTag("9F26",&IsoIccInfo,FieldData,&FieldLen);
    if (iVar4 == 0) {
      AddNpsIcTag("9F26",&NpsIccInfo,FieldData,FieldLen);
    }
    sprintf(sLine,"===>NPS_TAG_APP_CRYPTOGRAM   = %s ",FieldData);
    trace_event(sLine,5);
    trace_event("==<9F27>== ommit sur la demande de visa mais a valider",5);
    pcVar7 = FieldData;
    for (lVar9 = 0x200; lVar9 != 0; lVar9 = lVar9 + -1) {
      pcVar7[0] = '\0';
      pcVar7[1] = '\0';
      pcVar7[2] = '\0';
      pcVar7[3] = '\0';
      pcVar7[4] = '\0';
      pcVar7[5] = '\0';
      pcVar7[6] = '\0';
      pcVar7[7] = '\0';
      pcVar7 = pcVar7 + (ulong)bVar17 * -0x10 + 8;
    }
    iVar4 = GetIsoIcTag("9F27",&IsoIccInfo,FieldData,&FieldLen);
    if (iVar4 == 0) {
      AddNpsIcTag("9F27",&NpsIccInfo,FieldData,FieldLen);
    }
    sprintf(sLine," ===>ISO_TAG_CRYPTO_INFO_DATA   = %s ",FieldData);
    trace_event(sLine,5);
    pcVar7 = FieldData;
    for (lVar9 = 0x200; lVar9 != 0; lVar9 = lVar9 + -1) {
      pcVar7[0] = '\0';
      pcVar7[1] = '\0';
      pcVar7[2] = '\0';
      pcVar7[3] = '\0';
      pcVar7[4] = '\0';
      pcVar7[5] = '\0';
      pcVar7[6] = '\0';
      pcVar7[7] = '\0';
      pcVar7 = pcVar7 + (ulong)bVar17 * -0x10 + 8;
    }
    iVar4 = GetIsoIcTag("9F10",&IsoIccInfo,FieldData,&FieldLen);
    if (iVar4 == 0) {
      AddNpsIcTag("9F10",&NpsIccInfo,FieldData,FieldLen);
    }
    sprintf(sLine,"===>ISO_TAG_ISS_APP_DATA   = %s ",FieldData);
    trace_event(sLine,5);
    pcVar7 = FieldData;
    for (lVar9 = 0x200; lVar9 != 0; lVar9 = lVar9 + -1) {
      pcVar7[0] = '\0';
      pcVar7[1] = '\0';
      pcVar7[2] = '\0';
      pcVar7[3] = '\0';
      pcVar7[4] = '\0';
      pcVar7[5] = '\0';
      pcVar7[6] = '\0';
      pcVar7[7] = '\0';
      pcVar7 = pcVar7 + (ulong)bVar17 * -0x10 + 8;
    }
    iVar4 = GetIsoIcTag("9F37",&IsoIccInfo,FieldData,&FieldLen);
    if (iVar4 == 0) {
      AddNpsIcTag("9F37",&NpsIccInfo,FieldData,FieldLen);
    }
    sprintf(sLine,"====>ISO_TAG_UNPRED_NUMBER   = %s ",FieldData);
    trace_event(sLine,5);
    pcVar7 = FieldData;
    for (lVar9 = 0x200; lVar9 != 0; lVar9 = lVar9 + -1) {
      pcVar7[0] = '\0';
      pcVar7[1] = '\0';
      pcVar7[2] = '\0';
      pcVar7[3] = '\0';
      pcVar7[4] = '\0';
      pcVar7[5] = '\0';
      pcVar7[6] = '\0';
      pcVar7[7] = '\0';
      pcVar7 = pcVar7 + (ulong)bVar17 * -0x10 + 8;
    }
    iVar4 = GetIsoIcTag("9F36",&IsoIccInfo,FieldData,&FieldLen);
    if (iVar4 == 0) {
      AddNpsIcTag("9F36",&NpsIccInfo,FieldData,FieldLen);
    }
    sprintf(sLine,"===> ISO_TAG_ATC   = %s ",FieldData);
    trace_event(sLine,5);
    pcVar7 = FieldData;
    for (lVar9 = 0x200; lVar9 != 0; lVar9 = lVar9 + -1) {
      pcVar7[0] = '\0';
      pcVar7[1] = '\0';
      pcVar7[2] = '\0';
      pcVar7[3] = '\0';
      pcVar7[4] = '\0';
      pcVar7[5] = '\0';
      pcVar7[6] = '\0';
      pcVar7[7] = '\0';
      pcVar7 = pcVar7 + (ulong)bVar17 * -0x10 + 8;
    }
    iVar4 = GetIsoIcTag("9500",&IsoIccInfo,FieldData,&FieldLen);
    if (iVar4 == 0) {
      AddNpsIcTag("9500",&NpsIccInfo,FieldData,FieldLen);
    }
    sprintf(sLine,"===> ISO_TAG_TVR   = %s ",FieldData);
    trace_event(sLine,5);
    pcVar7 = FieldData;
    for (lVar9 = 0x200; lVar9 != 0; lVar9 = lVar9 + -1) {
      pcVar7[0] = '\0';
      pcVar7[1] = '\0';
      pcVar7[2] = '\0';
      pcVar7[3] = '\0';
      pcVar7[4] = '\0';
      pcVar7[5] = '\0';
      pcVar7[6] = '\0';
      pcVar7[7] = '\0';
      pcVar7 = pcVar7 + (ulong)bVar17 * -0x10 + 8;
    }
    iVar4 = GetIsoIcTag("9A00",&IsoIccInfo,FieldData,&FieldLen);
    if (iVar4 == 0) {
      AddNpsIcTag("9A00",&NpsIccInfo,FieldData,FieldLen);
    }
    sprintf(sLine,"===>ISO_TAG_TRANS_DATE    = %s ",FieldData);
    trace_event(sLine,5);
    pcVar7 = FieldData;
    for (lVar9 = 0x200; lVar9 != 0; lVar9 = lVar9 + -1) {
      pcVar7[0] = '\0';
      pcVar7[1] = '\0';
      pcVar7[2] = '\0';
      pcVar7[3] = '\0';
      pcVar7[4] = '\0';
      pcVar7[5] = '\0';
      pcVar7[6] = '\0';
      pcVar7[7] = '\0';
      pcVar7 = pcVar7 + (ulong)bVar17 * -0x10 + 8;
    }
    iVar4 = GetIsoIcTag("9C00",&IsoIccInfo,FieldData,&FieldLen);
    if (iVar4 == 0) {
      AddNpsIcTag("9C00",&NpsIccInfo,FieldData,FieldLen);
      sprintf(sLine,"===>ISO_TAG_TRANS_TYPE    = %s ",FieldData);
      trace_event(sLine,5);
    }
    pcVar7 = FieldData;
    for (lVar9 = 0x200; lVar9 != 0; lVar9 = lVar9 + -1) {
      pcVar7[0] = '\0';
      pcVar7[1] = '\0';
      pcVar7[2] = '\0';
      pcVar7[3] = '\0';
      pcVar7[4] = '\0';
      pcVar7[5] = '\0';
      pcVar7[6] = '\0';
      pcVar7[7] = '\0';
      pcVar7 = pcVar7 + (ulong)bVar17 * -0x10 + 8;
    }
    iVar4 = GetIsoIcTag("9F02",&IsoIccInfo,FieldData,&FieldLen);
    if (iVar4 == 0) {
      AddNpsIcTag("9F02",&NpsIccInfo,FieldData,FieldLen);
    }
    sprintf(sLine,"===>NPS_TAG_TRANS_AMOUNT    = %s ",FieldData);
    trace_event(sLine,5);
    pcVar7 = FieldData;
    for (lVar9 = 0x200; lVar9 != 0; lVar9 = lVar9 + -1) {
      pcVar7[0] = '\0';
      pcVar7[1] = '\0';
      pcVar7[2] = '\0';
      pcVar7[3] = '\0';
      pcVar7[4] = '\0';
      pcVar7[5] = '\0';
      pcVar7[6] = '\0';
      pcVar7[7] = '\0';
      pcVar7 = pcVar7 + (ulong)bVar17 * -0x10 + 8;
    }
    iVar4 = GetIsoIcTag("5F2A",&IsoIccInfo,FieldData,&FieldLen);
    if (iVar4 == 0) {
      AddNpsIcTag("5F2A",&NpsIccInfo,FieldData,FieldLen);
    }
    sprintf(sLine,"===>ISO_TAG_TRANS_CUR_CODE    = %s ",FieldData);
    trace_event(sLine,5);
    pcVar7 = FieldData;
    for (lVar9 = 0x200; lVar9 != 0; lVar9 = lVar9 + -1) {
      pcVar7[0] = '\0';
      pcVar7[1] = '\0';
      pcVar7[2] = '\0';
      pcVar7[3] = '\0';
      pcVar7[4] = '\0';
      pcVar7[5] = '\0';
      pcVar7[6] = '\0';
      pcVar7[7] = '\0';
      pcVar7 = pcVar7 + (ulong)bVar17 * -0x10 + 8;
    }
    iVar4 = GetIsoIcTag("8200",&IsoIccInfo,FieldData,&FieldLen);
    if (iVar4 == 0) {
      AddNpsIcTag("8200",&NpsIccInfo,FieldData,FieldLen);
    }
    sprintf(sLine,"===>ISO_TAG_APP_INTER_PROFILE    = %s ",FieldData);
    trace_event(sLine,5);
    pcVar7 = FieldData;
    for (lVar9 = 0x200; lVar9 != 0; lVar9 = lVar9 + -1) {
      pcVar7[0] = '\0';
      pcVar7[1] = '\0';
      pcVar7[2] = '\0';
      pcVar7[3] = '\0';
      pcVar7[4] = '\0';
      pcVar7[5] = '\0';
      pcVar7[6] = '\0';
      pcVar7[7] = '\0';
      pcVar7 = pcVar7 + (ulong)bVar17 * -0x10 + 8;
    }
    iVar4 = GetIsoIcTag("9F1A",&IsoIccInfo,FieldData,&FieldLen);
    if (iVar4 == 0) {
      AddNpsIcTag("9F1A",&NpsIccInfo,FieldData,FieldLen);
    }
    sprintf(sLine,"===>ISO_TAG_COUNTRY_CODE= %s ||LenFD=%d",FieldData,(ulong)(uint)FieldLen);
    trace_event(sLine,5);
    pcVar7 = FieldData;
    for (lVar9 = 0x200; lVar9 != 0; lVar9 = lVar9 + -1) {
      pcVar7[0] = '\0';
      pcVar7[1] = '\0';
      pcVar7[2] = '\0';
      pcVar7[3] = '\0';
      pcVar7[4] = '\0';
      pcVar7[5] = '\0';
      pcVar7[6] = '\0';
      pcVar7[7] = '\0';
      pcVar7 = pcVar7 + (ulong)bVar17 * -0x10 + 8;
    }
    iVar4 = GetIsoIcTag("9F03",&IsoIccInfo,FieldData,&FieldLen);
    if (iVar4 == 0) {
      AddNpsIcTag("9F03",&NpsIccInfo,FieldData,FieldLen);
    }
    sprintf(sLine,"===> ISO_TAG_OTHER_AMOUNT   = %s ",FieldData);
    trace_event(sLine,5);
    pcVar7 = FieldData;
    for (lVar9 = 0x200; lVar9 != 0; lVar9 = lVar9 + -1) {
      pcVar7[0] = '\0';
      pcVar7[1] = '\0';
      pcVar7[2] = '\0';
      pcVar7[3] = '\0';
      pcVar7[4] = '\0';
      pcVar7[5] = '\0';
      pcVar7[6] = '\0';
      pcVar7[7] = '\0';
      pcVar7 = pcVar7 + (ulong)bVar17 * -0x10 + 8;
    }
    iVar4 = GetIsoIcTag("9F33",&IsoIccInfo,FieldData,&FieldLen);
    if (iVar4 == 0) {
      AddNpsIcTag("9F33",&NpsIccInfo,FieldData,FieldLen);
    }
    sprintf(sLine,"===> ISO_TAG_TERM_CAP   = %s ",FieldData);
    trace_event(sLine,5);
    pcVar7 = FieldData;
    for (lVar9 = 0x200; lVar9 != 0; lVar9 = lVar9 + -1) {
      pcVar7[0] = '\0';
      pcVar7[1] = '\0';
      pcVar7[2] = '\0';
      pcVar7[3] = '\0';
      pcVar7[4] = '\0';
      pcVar7[5] = '\0';
      pcVar7[6] = '\0';
      pcVar7[7] = '\0';
      pcVar7 = pcVar7 + (ulong)bVar17 * -0x10 + 8;
    }
    iVar4 = GetIsoIcTag("9F34",&IsoIccInfo,FieldData,&FieldLen);
    if (iVar4 == 0) {
      AddNpsIcTag("9F34",&NpsIccInfo,FieldData,FieldLen);
    }
    sprintf(sLine,"===>ISO_TAG_CVM    = %s ",FieldData);
    trace_event(sLine,5);
    pcVar7 = FieldData;
    for (lVar9 = 0x200; lVar9 != 0; lVar9 = lVar9 + -1) {
      pcVar7[0] = '\0';
      pcVar7[1] = '\0';
      pcVar7[2] = '\0';
      pcVar7[3] = '\0';
      pcVar7[4] = '\0';
      pcVar7[5] = '\0';
      pcVar7[6] = '\0';
      pcVar7[7] = '\0';
      pcVar7 = pcVar7 + (ulong)bVar17 * -0x10 + 8;
    }
    iVar4 = GetIsoIcTag("9F53",&IsoIccInfo,FieldData,&FieldLen);
    if (iVar4 == 0) {
      AddNpsIcTag("9F53",&NpsIccInfo,FieldData,FieldLen);
    }
    sprintf(sLine,"===>ISO_TAG_TRANS_CATEG_CODE    = %s ",FieldData);
    trace_event(sLine,5);
    FieldLen = NpsBuildIcFld(sIccBuffer,&NpsIccInfo);
    if (0 < FieldLen) {
      AddNpsField(0x36,&vNpsInfo,sIccBuffer,FieldLen);
    }
    sprintf(sLine,"NPS_ICC_DATA   = %20s||Lenght = %d ",sIccBuffer,(ulong)(uint)FieldLen);
    trace_event(sLine,5);
  }
  iVar4 = memcmp(slProcCode,&DAT_004a554a,2);
  if ((iVar4 != 0) && (iVar4 = GetIsoField(0x65,IsoInfo,vTempField,&FieldLen), iVar4 == 0)) {
    AddNpsField(0x65,&vNpsInfo,vTempField,FieldLen);
  }
  if (destAccount[0] == '\0') {
    iVar4 = memcmp(slProcCode,&DAT_004a554a,2);
    if ((iVar4 != 0) && (iVar4 = GetIsoField(0x66,IsoInfo,vTempField,&FieldLen), iVar4 == 0)) {
      AddNpsField(0x66,&vNpsInfo,vTempField,FieldLen);
    }
  }
  else {
    puVar11 = (uint *)destAccount;
    do {
      puVar13 = puVar11;
      uVar5 = *puVar13 + 0xfefefeff & ~*puVar13;
      uVar6 = uVar5 & 0x80808080;
      puVar11 = puVar13 + 1;
    } while (uVar6 == 0);
    bVar16 = (uVar5 & 0x8080) == 0;
    if (bVar16) {
      uVar6 = uVar6 >> 0x10;
    }
    if (bVar16) {
      puVar11 = (uint *)((long)puVar13 + 6);
    }
    AddNpsField(0x66,&vNpsInfo,destAccount,
                (((int)puVar11 + -3) - (uint)CARRY1((byte)uVar6,(byte)uVar6)) - (int)destAccount);
  }
  builtin_strncpy(sLine,".... ISO_RESERVED_ISO_3 Preparat",0x20);
  builtin_strncpy(sLine + 0x20,"ion",4);
  trace_event(sLine,5);
  GetIsoField(0x17,IsoInfo,sFunctionCode,&vTempLen);
  GetIsoField(0x1f,IsoInfo,sAcquirerBank,&nLength);
  GetIsoField(0x34,IsoInfo,vTempField,&FieldLen);
  GetSecurityData(5,vTempField,sSource,&FieldLen);
  iVar4 = memcmp(slProcCode,"00",2);
  if (iVar4 == 0) {
    lVar9 = strtol(sFunctionCode,(char **)0x0,10);
    iVar4 = (int)lVar9;
    if (iVar4 == 0x65) {
      trace_event("MEL25082015... ISO_RESERVED_ISO_3 preauth",5);
      builtin_strncpy(sDE112 + 0x20,"504F535041",10);
      goto LAB_00411828;
    }
    if ((iVar4 != 200) && (iVar4 != 100)) goto LAB_00410448;
    iVar4 = GetIsoField(0x25,IsoInfo,sAuthCode,&nLength);
    if (iVar4 == 0) {
      pcVar7 = "MEL25082015... ISO_RESERVED_ISO_3 Completion ";
      if (sAuthCode[0] == '\0') goto LAB_00411036;
    }
    else {
LAB_00411036:
      pcVar7 = "MEL25082015... ISO_RESERVED_ISO_3 Retail Purchase";
    }
    trace_event(pcVar7,5);
    builtin_strncpy(sDE112 + 0x20,"504F535250",10);
LAB_00411828:
    builtin_strncpy(sDE112,"F013D20954574841545F545258D30654",0x20);
    AsciiToHex((uchar *)sDE112,(uchar *)sDE112NpsFormat,0x2a);
    AddNpsField(0x6f,&vNpsInfo,sDE112NpsFormat,0x15);
  }
  else {
    iVar4 = memcmp(slProcCode,&DAT_004a670e,2);
    if (iVar4 == 0) {
      trace_event("MEL25082015... ISO_RESERVED_ISO_3 Cash Advance",5);
      builtin_strncpy(sDE112 + 0x20,"504F534341",10);
      goto LAB_00411828;
    }
    iVar4 = memcmp(slProcCode,&DAT_004a5543,2);
    if ((iVar4 == 0) || (iVar4 = memcmp(slProcCode,&DAT_004a554a,2), iVar4 == 0)) {
      trace_event("SYO20180909... ISO_RESERVED_ISO_3 TRANSFER",5);
      GetIsoField(0x6f,IsoInfo,vTempField,&FieldLen);
      AddNpsField(0x6f,&vNpsInfo,vTempField,FieldLen);
    }
  }
LAB_00410448:
  iVar4 = memcmp(sSource,"600001",6);
  uVar3 = sLine._24_8_;
  if (iVar4 == 0) {
    builtin_strncpy(sLine,"MEL25082015... Inside ATMTrxOK",0x1f);
    sLine[0x1f] = SUB81(uVar3,7);
    trace_event(sLine,5);
    iVar4 = memcmp(local_d8b0,"01",2);
    if (iVar4 == 0) {
      trace_event("MEL25082015... In CW(01)",5);
      builtin_strncpy(sDE112 + 0x20,"41544D4357",10);
    }
    else {
      iVar4 = memcmp(local_d8b0,&DAT_004a9095,2);
      if (iVar4 == 0) {
        trace_event("MEL25082015... In MS(32)",5);
        builtin_strncpy(sDE112 + 0x20,"41544D4D53",10);
      }
      else {
        iVar4 = memcmp(local_d8b0,&DAT_004c759e,2);
        if (iVar4 != 0) {
          iVar4 = memcmp(slProcCode,&DAT_004a5543,2);
          if ((iVar4 == 0) || (iVar4 = memcmp(slProcCode,&DAT_004a554a,2), iVar4 == 0)) {
            trace_event("SYO20180909... ISO_RESERVED_ISO_3 TRANSFER",5);
            GetIsoField(0x6f,IsoInfo,vTempField,&FieldLen);
            AddNpsField(0x6f,&vNpsInfo,vTempField,FieldLen);
          }
          goto LAB_00410464;
        }
        trace_event("MEL25082015... In BI(30)",5);
        builtin_strncpy(sDE112 + 0x20,"41544D4249",10);
      }
    }
    builtin_strncpy(sDE112,"F013D20954574841545F545258D30654",0x20);
    AsciiToHex((uchar *)sDE112,(uchar *)sDE112NpsFormat,0x2a);
    AddNpsField(0x6f,&vNpsInfo,sDE112NpsFormat,0x15);
  }
LAB_00410464:
  pcVar7 = tmpField;
  for (lVar9 = 0x200; lVar9 != 0; lVar9 = lVar9 + -1) {
    pcVar7[0] = '\0';
    pcVar7[1] = '\0';
    pcVar7[2] = '\0';
    pcVar7[3] = '\0';
    pcVar7[4] = '\0';
    pcVar7[5] = '\0';
    pcVar7[6] = '\0';
    pcVar7[7] = '\0';
    pcVar7 = pcVar7 + (ulong)bVar17 * -0x10 + 8;
  }
  builtin_strncpy(tmpField,"ATMXX",5);
  if (nIsAtmTrx != 0) {
    tmpField[2] = 'S';
    tmpField[0] = 'P';
    tmpField[1] = 'O';
  }
  iVar4 = memcmp(slProcCode,"01",2);
  if (iVar4 == 0) {
    tmpField[3] = 'C';
    tmpField[4] = 'W';
  }
  iVar4 = memcmp(slProcCode,&DAT_004a7da4,2);
  if (iVar4 == 0) {
    tmpField[3] = 'M';
    tmpField[4] = 'S';
  }
  iVar4 = memcmp(slProcCode,&DAT_004c9c21,2);
  if (iVar4 == 0) {
    tmpField[3] = 'B';
    tmpField[4] = 'I';
  }
  InitNodeData(&Node);
  trace_event(".... SPY-1",5);
  pcVar7 = vTempField;
  for (lVar9 = 0x200; lVar9 != 0; lVar9 = lVar9 + -1) {
    pcVar7[0] = '\0';
    pcVar7[1] = '\0';
    pcVar7[2] = '\0';
    pcVar7[3] = '\0';
    pcVar7[4] = '\0';
    pcVar7[5] = '\0';
    pcVar7[6] = '\0';
    pcVar7[7] = '\0';
    pcVar7 = pcVar7 + (ulong)bVar17 * -0x10 + 8;
  }
  GetIsoField(0x34,IsoInfo,vTempField,&FieldLen);
  GetSecurityData(9,vTempField,sPurgeTime,&FieldLen);
  trace_event(".... SPY-2",5);
  Node.tPurgeTime = strtol(sPurgeTime,(char **)0x0,10);
  trace_event(".... SPY-3",5);
  sprintf(Node.szFstKey,"%04d",(ulong)(uint)vNpsInfo.nMsgType);
  GetNpsField(10,&vNpsInfo,vTempField,&vTempLen);
  Node.szFstKey[4] = vTempField[0];
  Node.szFstKey[5] = vTempField[1];
  Node.szFstKey[6] = vTempField[2];
  Node.szFstKey[7] = vTempField[3];
  Node.szFstKey[8] = vTempField[4];
  Node.szFstKey[9] = vTempField[5];
  trace_event(".... SPY-4",5);
  GetNpsField(0x24,&vNpsInfo,vTempField,&vTempLen);
  Node.szFstKey[0x12] = vTempField[8];
  Node.szFstKey[0x13] = vTempField[9];
  Node.szFstKey[0x14] = vTempField[10];
  Node.szFstKey[0x15] = vTempField[0xb];
  GetNpsField(1,&vNpsInfo,vTempField,&vTempLen);
  if (debug_option == 1) {
    sprintf(sLine,"==> InsertKey=[%s] ",Node.szFstKey);
    trace_event(sLine,5);
  }
  pcVar7 = sBuffer;
  for (lVar9 = 0x200; lVar9 != 0; lVar9 = lVar9 + -1) {
    pcVar7[0] = '\0';
    pcVar7[1] = '\0';
    pcVar7[2] = '\0';
    pcVar7[3] = '\0';
    pcVar7[4] = '\0';
    pcVar7[5] = '\0';
    pcVar7[6] = '\0';
    pcVar7[7] = '\0';
    pcVar7 = pcVar7 + (ulong)bVar17 * -0x10 + 8;
  }
  iVar4 = IsoBuildMsg(sBuffer,IsoInfo);
  vTempLen = iVar4;
  memcpy(Node.sFstBuf,sBuffer,(long)iVar4);
  Node.nFstBufLen = iVar4;
  iVar4 = InsertRequest('B',&Node);
  if (iVar4 == 0) {
    iVar4 = Buffer_To_Nps(nIndexCtx,&vNpsInfo);
    if (iVar4 == 0) {
      trace_event("END      FCT_AUT_REQ_TO_NW()",5);
      iVar4 = 0;
    }
    else {
      iVar4 = -1;
      trace_event("End  FCT_AUT_REQ_TO_NPS(Buffer_To_Nps Failed)",5);
    }
  }
  else {
    iVar4 = -1;
    trace_event("FCT_AUT_REQ_TO_NW(): InsertRequest() failed",5);
  }
  return iVar4;
}



// WARNING: Unknown calling convention

int FCT_AUT_REP_FROM_NW(int nIndexCtx,TSNpsInfo *NpsInfo)

{
  int iVar1;
  uint uVar2;
  uint uVar3;
  long lVar4;
  uint *puVar5;
  uint *puVar6;
  char *pcVar7;
  bool bVar8;
  byte bVar9;
  char PinFormat [3];
  char security_format [3];
  char sNpsRespCode [3];
  char vNpsF22 [4];
  int vTempLen;
  char sRespCode [4];
  int nIsoEmvLen;
  int nLen;
  char slProcCode [7];
  char sSource [7];
  char SourceId [9];
  char vNpsF41 [17];
  char TransKey [17];
  char Awk [17];
  char PinData [17];
  char CardNumber [23];
  char vFetchKey [56];
  char szAdtnlAmnts [57];
  char sPurgeTime [128];
  char sLine [512];
  char vTempField [1000];
  char statement [1000];
  char vIsoEmvData [1024];
  char szWork [1024];
  TSTagIso TagIso;
  TSIsoInfo IsoInfo;
  char sTlvBuffer [4096];
  char sSecurityData [4097];
  TSBalExchange BalMessage;
  TSNodeData Node;
  TSTlvPrivate tlvInfo;
  
  bVar9 = 0;
  trace_event("START    FCT_AUT_REP_FROM_NW()",5);
  slProcCode[0] = '\0';
  slProcCode[1] = '\0';
  slProcCode[2] = '\0';
  slProcCode[3] = '\0';
  sNpsRespCode[0] = '\0';
  sNpsRespCode[1] = '\0';
  pcVar7 = sTlvBuffer;
  for (lVar4 = 0x200; lVar4 != 0; lVar4 = lVar4 + -1) {
    pcVar7[0] = '\0';
    pcVar7[1] = '\0';
    pcVar7[2] = '\0';
    pcVar7[3] = '\0';
    pcVar7[4] = '\0';
    pcVar7[5] = '\0';
    pcVar7[6] = '\0';
    pcVar7[7] = '\0';
    pcVar7 = pcVar7 + (ulong)bVar9 * -0x10 + 8;
  }
  slProcCode[4] = '\0';
  slProcCode[5] = '\0';
  slProcCode[6] = '\0';
  sNpsRespCode[2] = '\0';
  sRespCode[0] = '\0';
  sRespCode[1] = '\0';
  sRespCode[2] = '\0';
  sRespCode[3] = '\0';
  pcVar7 = sLine;
  for (lVar4 = 0x40; lVar4 != 0; lVar4 = lVar4 + -1) {
    pcVar7[0] = '\0';
    pcVar7[1] = '\0';
    pcVar7[2] = '\0';
    pcVar7[3] = '\0';
    pcVar7[4] = '\0';
    pcVar7[5] = '\0';
    pcVar7[6] = '\0';
    pcVar7[7] = '\0';
    pcVar7 = pcVar7 + (ulong)bVar9 * -0x10 + 8;
  }
  SourceId[0] = '\0';
  SourceId[1] = '\0';
  SourceId[2] = '\0';
  SourceId[3] = '\0';
  SourceId[4] = '\0';
  SourceId[5] = '\0';
  SourceId[6] = '\0';
  SourceId[7] = '\0';
  SourceId[8] = '\0';
  pcVar7 = vFetchKey;
  for (lVar4 = 7; lVar4 != 0; lVar4 = lVar4 + -1) {
    pcVar7[0] = '\0';
    pcVar7[1] = '\0';
    pcVar7[2] = '\0';
    pcVar7[3] = '\0';
    pcVar7[4] = '\0';
    pcVar7[5] = '\0';
    pcVar7[6] = '\0';
    pcVar7[7] = '\0';
    pcVar7 = pcVar7 + (ulong)bVar9 * -0x10 + 8;
  }
  pcVar7 = sSecurityData;
  for (lVar4 = 0x200; lVar4 != 0; lVar4 = lVar4 + -1) {
    pcVar7[0] = '\0';
    pcVar7[1] = '\0';
    pcVar7[2] = '\0';
    pcVar7[3] = '\0';
    pcVar7[4] = '\0';
    pcVar7[5] = '\0';
    pcVar7[6] = '\0';
    pcVar7[7] = '\0';
    pcVar7 = pcVar7 + (ulong)bVar9 * -0x10 + 8;
  }
  *pcVar7 = '\0';
  pcVar7 = szAdtnlAmnts;
  for (lVar4 = 7; lVar4 != 0; lVar4 = lVar4 + -1) {
    pcVar7[0] = '\0';
    pcVar7[1] = '\0';
    pcVar7[2] = '\0';
    pcVar7[3] = '\0';
    pcVar7[4] = '\0';
    pcVar7[5] = '\0';
    pcVar7[6] = '\0';
    pcVar7[7] = '\0';
    pcVar7 = pcVar7 + (ulong)bVar9 * -0x10 + 8;
  }
  *pcVar7 = '\0';
  pcVar7 = vTempField;
  for (lVar4 = 0x7d; lVar4 != 0; lVar4 = lVar4 + -1) {
    pcVar7[0] = '\0';
    pcVar7[1] = '\0';
    pcVar7[2] = '\0';
    pcVar7[3] = '\0';
    pcVar7[4] = '\0';
    pcVar7[5] = '\0';
    pcVar7[6] = '\0';
    pcVar7[7] = '\0';
    pcVar7 = pcVar7 + (ulong)bVar9 * -0x10 + 8;
  }
  sSource[4] = '\0';
  sSource[5] = '\0';
  sSource[0] = '\0';
  sSource[1] = '\0';
  sSource[2] = '\0';
  sSource[3] = '\0';
  sSource[6] = '\0';
  pcVar7 = sPurgeTime;
  for (lVar4 = 0x10; lVar4 != 0; lVar4 = lVar4 + -1) {
    pcVar7[0] = '\0';
    pcVar7[1] = '\0';
    pcVar7[2] = '\0';
    pcVar7[3] = '\0';
    pcVar7[4] = '\0';
    pcVar7[5] = '\0';
    pcVar7[6] = '\0';
    pcVar7[7] = '\0';
    pcVar7 = pcVar7 + (ulong)bVar9 * -0x10 + 8;
  }
  puVar6 = (uint *)statement;
  for (lVar4 = 0x7d; lVar4 != 0; lVar4 = lVar4 + -1) {
    puVar6[0] = 0;
    puVar6[1] = 0;
    puVar6 = puVar6 + (ulong)bVar9 * -4 + 2;
  }
  DumpStructNps(NpsInfo);
  InitNodeData(&Node);
  sprintf(Node.szFstKey,"%04d",(ulong)(NpsInfo->nMsgType - 10));
  GetNpsField(10,NpsInfo,vTempField,&vTempLen);
  Node.szFstKey[8] = vTempField[4];
  Node.szFstKey[9] = vTempField[5];
  GetNpsField(0x24,NpsInfo,vTempField,&vTempLen);
  Node.szFstKey[0x12] = vTempField[8];
  Node.szFstKey[0x13] = vTempField[9];
  Node.szFstKey[0x14] = vTempField[10];
  Node.szFstKey[0x15] = vTempField[0xb];
  pcVar7 = vTempField;
  for (lVar4 = 0x7d; lVar4 != 0; lVar4 = lVar4 + -1) {
    pcVar7[0] = '\0';
    pcVar7[1] = '\0';
    pcVar7[2] = '\0';
    pcVar7[3] = '\0';
    pcVar7[4] = '\0';
    pcVar7[5] = '\0';
    pcVar7[6] = '\0';
    pcVar7[7] = '\0';
    pcVar7 = pcVar7 + (ulong)bVar9 * -0x10 + 8;
  }
  iVar1 = GetNpsField(1,NpsInfo,vTempField,&vTempLen);
  if (iVar1 != 0) {
    trace_event("Unable to get NPS_CARD_NBR",5);
  }
  if (debug_option == 1) {
    sprintf(sLine,"==> FetchKey=[%s] ",Node.szFstKey);
    trace_event(sLine,5);
  }
  iVar1 = FetchRequest('B',&Node);
  if (iVar1 == -0xb) {
    iVar1 = -1;
    trace_event("FetchRequest failed (ENOEXIST)",1);
    trace_event("End FCT_AUT_REP_FROM_NW (NOK)",1);
  }
  else {
    trace_event("FetchRequest SUCCESS",5);
    InitIsoInfo(&IsoInfo);
    AnalyseIso(Node.sFstBuf,&IsoInfo);
    IsoInfo.nMsgType = IsoInfo.nMsgType + 10;
    dump_p7_struct(&IsoInfo);
    GetIsoField(0x34,&IsoInfo,vTempField,&vTempLen);
    sSource[4] = '\0';
    sSource[5] = '\0';
    sSource[0] = '\0';
    sSource[1] = '\0';
    sSource[2] = '\0';
    sSource[3] = '\0';
    sSource[6] = '\0';
    GetSecurityData(5,vTempField,sSource,&vTempLen);
    iVar1 = memcmp(sSource,"210000",6);
    if (iVar1 == 0) {
      IsoInfo.nMsgType = 0x4ba;
    }
    GetIsoField(2,&IsoInfo,slProcCode,&vTempLen);
    GetIsoField(0xb,&IsoInfo,vTempField,&vTempLen);
    GetNpsField(0xe,NpsInfo,vTempField + 2,&vTempLen);
    iVar1 = InsertIsoField(0xe,&IsoInfo,vTempField,6);
    if (iVar1 != 0) {
      PutIsoField(0xe,&IsoInfo,vTempField,6);
    }
    iVar1 = GetNpsField(0x25,NpsInfo,vTempField,&vTempLen);
    if (iVar1 == 0) {
      iVar1 = InsertIsoField(0x25,&IsoInfo,vTempField,vTempLen);
      if (iVar1 != 0) {
        PutIsoField(0x25,&IsoInfo,vTempField,vTempLen);
      }
    }
    iVar1 = GetNpsField(0x26,NpsInfo,sNpsRespCode,&vTempLen);
    if (iVar1 == 0) {
      iVar1 = TranslateRespCode(nIndexCtx,G_sNps.F_szRsrcId,sNpsRespCode,"RP",sRespCode);
      if (iVar1 != 0) {
        sprintf(sLine,"=> Can not Translate the [%s] NPS response Code!!! ",sNpsRespCode);
        trace_event(sLine,0);
      }
      iVar1 = InsertIsoField(0x26,&IsoInfo,sRespCode,3);
      if (iVar1 != 0) {
        PutIsoField(0x26,&IsoInfo,sRespCode,3);
      }
      InitTlvPrivate(&tlvInfo);
      puVar6 = (uint *)sNpsRespCode;
      do {
        puVar5 = puVar6;
        uVar2 = *puVar5 + 0xfefefeff & ~*puVar5;
        uVar3 = uVar2 & 0x80808080;
        puVar6 = puVar5 + 1;
      } while (uVar3 == 0);
      bVar8 = (uVar2 & 0x8080) == 0;
      if (bVar8) {
        uVar3 = uVar3 >> 0x10;
      }
      if (bVar8) {
        puVar6 = (uint *)((long)puVar5 + 6);
      }
      PutTlvPrivate("039",&tlvInfo,sNpsRespCode,
                    (((int)puVar6 + -3) - (uint)CARRY1((byte)uVar3,(byte)uVar3)) - (int)sNpsRespCode
                   );
      vTempLen = PrivateBuildTlv(vTempField,&tlvInfo);
      if (0 < vTempLen) {
        PutIsoField(0x3c,&IsoInfo,vTempField,vTempLen);
      }
    }
    pcVar7 = vTempField;
    for (lVar4 = 0x7d; lVar4 != 0; lVar4 = lVar4 + -1) {
      pcVar7[0] = '\0';
      pcVar7[1] = '\0';
      pcVar7[2] = '\0';
      pcVar7[3] = '\0';
      pcVar7[4] = '\0';
      pcVar7[5] = '\0';
      pcVar7[6] = '\0';
      pcVar7[7] = '\0';
      pcVar7 = pcVar7 + (ulong)bVar9 * -0x10 + 8;
    }
    iVar1 = GetNpsField(0x35,NpsInfo,vTempField,&vTempLen);
    if (iVar1 == 0) {
      builtin_strncpy(sLine,"=> Inserting balance record!!! ",0x20);
      trace_event(sLine,0);
      vTempField[2] = '0';
      vTempField[3] = '1';
      iVar1 = InsertIsoField(0x35,&IsoInfo,vTempField,vTempLen);
      if (iVar1 != 0) {
        PutIsoField(0x35,&IsoInfo,vTempField,vTempLen);
      }
    }
    iVar1 = GetNpsField(0x36,NpsInfo,vTempField,&vTempLen);
    if (iVar1 == 0) {
      InitIsoIcTag(&TagIso);
      InitIsoIcTag((TSTagIso *)&BalMessage);
      pcVar7 = vIsoEmvData;
      for (lVar4 = 0x80; lVar4 != 0; lVar4 = lVar4 + -1) {
        pcVar7[0] = '\0';
        pcVar7[1] = '\0';
        pcVar7[2] = '\0';
        pcVar7[3] = '\0';
        pcVar7[4] = '\0';
        pcVar7[5] = '\0';
        pcVar7[6] = '\0';
        pcVar7[7] = '\0';
        pcVar7 = pcVar7 + (ulong)bVar9 * -0x10 + 8;
      }
      iVar1 = GetIsoField(0x36,&IsoInfo,vIsoEmvData,&nIsoEmvLen);
      if (iVar1 == 0) {
        if (5 < vTempLen) {
          AnalyseIsoIc(vIsoEmvData,nIsoEmvLen,&TagIso);
          AnalyseIsoIc(vTempField,nIsoEmvLen,(TSTagIso *)&BalMessage);
          pcVar7 = szWork;
          for (lVar4 = 0x80; lVar4 != 0; lVar4 = lVar4 + -1) {
            pcVar7[0] = '\0';
            pcVar7[1] = '\0';
            pcVar7[2] = '\0';
            pcVar7[3] = '\0';
            pcVar7[4] = '\0';
            pcVar7[5] = '\0';
            pcVar7[6] = '\0';
            pcVar7[7] = '\0';
            pcVar7 = pcVar7 + (ulong)bVar9 * -0x10 + 8;
          }
          iVar1 = GetIsoIcTag("9100",(TSTagIso *)&BalMessage,szWork,&nLen);
          if (iVar1 == 0) {
            if (nLen < 0x11) {
              PutIsoIcTag("9100",&TagIso,szWork,nLen);
            }
            else {
              PutIsoIcTag("9100",&TagIso,szWork,nLen);
              PutIsoIcTag("8A00",&TagIso,szWork + 0x10,4);
            }
          }
          iVar1 = GetIsoIcTag("7100",(TSTagIso *)&BalMessage,szWork,&nLen);
          if (iVar1 == 0) {
            PutIsoIcTag("7100",&TagIso,szWork,nLen);
          }
          iVar1 = GetIsoIcTag("7200",(TSTagIso *)&BalMessage,szWork,&nLen);
          if (iVar1 == 0) {
            PutIsoIcTag("7200",&TagIso,szWork,nLen);
          }
          pcVar7 = szWork;
          for (lVar4 = 0x80; lVar4 != 0; lVar4 = lVar4 + -1) {
            pcVar7[0] = '\0';
            pcVar7[1] = '\0';
            pcVar7[2] = '\0';
            pcVar7[3] = '\0';
            pcVar7[4] = '\0';
            pcVar7[5] = '\0';
            pcVar7[6] = '\0';
            pcVar7[7] = '\0';
            pcVar7 = pcVar7 + (ulong)bVar9 * -0x10 + 8;
          }
          nLen = IsoBuildIcFld(szWork,&TagIso);
          IsoDumpIccFields(szWork,nLen);
          PutIsoField(0x36,&IsoInfo,szWork,nLen);
        }
      }
      else {
        PutIsoField(0x36,&IsoInfo,vTempField,vTempLen);
      }
    }
    iVar1 = memcmp(slProcCode,&DAT_004a7da4,2);
    if (iVar1 == 0) {
      iVar1 = GetNpsField(0x7c,NpsInfo,vTempField,&vTempLen);
      if (iVar1 == 0) {
        FormatToStatement(nIndexCtx,vTempField,statement,'E');
        puVar6 = (uint *)statement;
        do {
          puVar5 = puVar6;
          uVar2 = *puVar5 + 0xfefefeff & ~*puVar5;
          uVar3 = uVar2 & 0x80808080;
          puVar6 = puVar5 + 1;
        } while (uVar3 == 0);
        bVar8 = (uVar2 & 0x8080) == 0;
        if (bVar8) {
          uVar3 = uVar3 >> 0x10;
        }
        if (bVar8) {
          puVar6 = (uint *)((long)puVar5 + 6);
        }
        PutIsoField(0x47,&IsoInfo,statement,
                    (((int)puVar6 + -3) - (uint)CARRY1((byte)uVar3,(byte)uVar3)) - (int)statement);
      }
    }
    iVar1 = GetNpsField(99,NpsInfo,vTempField,&vTempLen);
    if (iVar1 == 0) {
      iVar1 = InsertIsoField(99,&IsoInfo,vTempField,vTempLen);
      if (iVar1 != 0) {
        PutIsoField(99,&IsoInfo,vTempField,vTempLen);
      }
    }
    iVar1 = GetNpsField(0x6f,NpsInfo,vTempField,&vTempLen);
    if (iVar1 == 0) {
      PutIsoField(0x6f,&IsoInfo,vTempField,vTempLen);
    }
    SourceId[0] = '\0';
    SourceId[1] = '\0';
    SourceId[2] = '\0';
    SourceId[3] = '\0';
    SourceId[4] = '\0';
    SourceId[5] = '\0';
    SourceId[6] = '\0';
    SourceId[7] = '\0';
    SourceId[8] = '\0';
    pcVar7 = sSecurityData;
    for (lVar4 = 0x200; lVar4 != 0; lVar4 = lVar4 + -1) {
      pcVar7[0] = '\0';
      pcVar7[1] = '\0';
      pcVar7[2] = '\0';
      pcVar7[3] = '\0';
      pcVar7[4] = '\0';
      pcVar7[5] = '\0';
      pcVar7[6] = '\0';
      pcVar7[7] = '\0';
      pcVar7 = pcVar7 + (ulong)bVar9 * -0x10 + 8;
    }
    *pcVar7 = '\0';
    GetIsoField(0x34,&IsoInfo,sSecurityData,&vTempLen);
    GetSecurityData(4,sSecurityData,SourceId,&vTempLen);
    sprintf(sLine,"=> Source Id = [%s] ",SourceId);
    trace_event(sLine,0);
    builtin_strncpy(sLine,"Message ",8);
    builtin_strncpy(sLine + 8,"To Bal",7);
    trace_event(sLine,0);
    dump_p7_struct(&IsoInfo);
    lVar4 = strtol(SourceId,(char **)0x0,10);
    BalMessage.sHeader.nPartnerId = (pid_t)lVar4;
    BalMessage.sHeader.nSourceId = getpid();
    BalMessage.sHeader.nCommand = IsoInfo.nMsgType;
    vTempLen = IsoBuildMsg(BalMessage.sBody,&IsoInfo);
    BalMessage.sHeader.nLen = vTempLen;
    iVar1 = WriteBalMsg(nBalMsg,&BalMessage);
    if (iVar1 == 0) {
      trace_event("END      FCT_AUT_REP_FROM_NW(OK)",5);
      iVar1 = 0;
    }
    else {
      iVar1 = -1;
      trace_event("End FCT_AUT_REP_FROM_NW(NOK): WriteBal() failed.",1);
    }
  }
  return iVar1;
}



// WARNING: Unknown calling convention

int ForwardAutRequest(int nIndexCtx,TSIsoInfo *IsoInfo,TSNpsInfo *SNpsInfo,char *sTlvBuffer)

{
  int iVar1;
  uint uVar2;
  uint uVar3;
  size_t __n;
  long lVar4;
  uint *puVar5;
  uint *puVar6;
  TSIsoInfo *IsoInfo_00;
  char *pcVar7;
  bool bVar8;
  byte bVar9;
  int vTempLen;
  int nLength;
  char szTid [6];
  char sProcCode [7];
  time_t nPurgeTime;
  char sDestinationPid [9];
  char szUser [16];
  char sAccountID1 [24];
  char sAccountID2 [24];
  char vFetchKey [56];
  char sNPSBSettlementAcc [100];
  char sPurgeTime [128];
  char vTempField [256];
  char sLine [512];
  char sBuffer [1024];
  char sSecurityData [4096];
  TSBalExchange sBalMessage;
  TSNodeData Node;
  
  bVar9 = 0;
  sDestinationPid[0] = '\0';
  sDestinationPid[1] = '\0';
  sDestinationPid[2] = '\0';
  sDestinationPid[3] = '\0';
  sDestinationPid[4] = '\0';
  sDestinationPid[5] = '\0';
  sDestinationPid[6] = '\0';
  sDestinationPid[7] = '\0';
  pcVar7 = sLine;
  for (lVar4 = 0x40; lVar4 != 0; lVar4 = lVar4 + -1) {
    pcVar7[0] = '\0';
    pcVar7[1] = '\0';
    pcVar7[2] = '\0';
    pcVar7[3] = '\0';
    pcVar7[4] = '\0';
    pcVar7[5] = '\0';
    pcVar7[6] = '\0';
    pcVar7[7] = '\0';
    pcVar7 = pcVar7 + 8;
  }
  sDestinationPid[8] = '\0';
  szTid[0] = '\0';
  szTid[1] = '\0';
  szTid[2] = '\0';
  szTid[3] = '\0';
  szTid[4] = '\0';
  szTid[5] = '\0';
  puVar6 = (uint *)sSecurityData;
  for (lVar4 = 0x200; lVar4 != 0; lVar4 = lVar4 + -1) {
    puVar6[0] = 0;
    puVar6[1] = 0;
    puVar6 = puVar6 + 2;
  }
  pcVar7 = sPurgeTime;
  for (lVar4 = 0x10; lVar4 != 0; lVar4 = lVar4 + -1) {
    pcVar7[0] = '\0';
    pcVar7[1] = '\0';
    pcVar7[2] = '\0';
    pcVar7[3] = '\0';
    pcVar7[4] = '\0';
    pcVar7[5] = '\0';
    pcVar7[6] = '\0';
    pcVar7[7] = '\0';
    pcVar7 = pcVar7 + 8;
  }
  pcVar7 = vFetchKey;
  for (lVar4 = 7; lVar4 != 0; lVar4 = lVar4 + -1) {
    pcVar7[0] = '\0';
    pcVar7[1] = '\0';
    pcVar7[2] = '\0';
    pcVar7[3] = '\0';
    pcVar7[4] = '\0';
    pcVar7[5] = '\0';
    pcVar7[6] = '\0';
    pcVar7[7] = '\0';
    pcVar7 = pcVar7 + 8;
  }
  pcVar7 = vTempField;
  for (lVar4 = 0x20; lVar4 != 0; lVar4 = lVar4 + -1) {
    pcVar7[0] = '\0';
    pcVar7[1] = '\0';
    pcVar7[2] = '\0';
    pcVar7[3] = '\0';
    pcVar7[4] = '\0';
    pcVar7[5] = '\0';
    pcVar7[6] = '\0';
    pcVar7[7] = '\0';
    pcVar7 = pcVar7 + 8;
  }
  pcVar7 = sBuffer;
  for (lVar4 = 0x80; lVar4 != 0; lVar4 = lVar4 + -1) {
    pcVar7[0] = '\0';
    pcVar7[1] = '\0';
    pcVar7[2] = '\0';
    pcVar7[3] = '\0';
    pcVar7[4] = '\0';
    pcVar7[5] = '\0';
    pcVar7[6] = '\0';
    pcVar7[7] = '\0';
    pcVar7 = pcVar7 + 8;
  }
  pcVar7 = sNPSBSettlementAcc;
  for (lVar4 = 0xc; lVar4 != 0; lVar4 = lVar4 + -1) {
    pcVar7[0] = '\0';
    pcVar7[1] = '\0';
    pcVar7[2] = '\0';
    pcVar7[3] = '\0';
    pcVar7[4] = '\0';
    pcVar7[5] = '\0';
    pcVar7[6] = '\0';
    pcVar7[7] = '\0';
    pcVar7 = pcVar7 + 8;
  }
  pcVar7[0] = '\0';
  pcVar7[1] = '\0';
  pcVar7[2] = '\0';
  pcVar7[3] = '\0';
  trace_event(" Start ForwardAutRequest()",5);
  InitNodeData(&Node);
  GetAcquirerPurgeTime(&nPurgeTime);
  Node.tPurgeTime = nPurgeTime;
  GetNpsField(10,SNpsInfo,vTempField,&vTempLen);
  sprintf(Node.szFstKey,"%04d",(ulong)(uint)SNpsInfo->nMsgType);
  Node.szFstKey[4] = vTempField[0];
  Node.szFstKey[5] = vTempField[1];
  Node.szFstKey[6] = vTempField[2];
  Node.szFstKey[7] = vTempField[3];
  Node.szFstKey[8] = vTempField[4];
  Node.szFstKey[9] = vTempField[5];
  GetNpsField(6,SNpsInfo,vTempField,&vTempLen);
  Node.szFstKey[0x12] = vTempField[8];
  Node.szFstKey[0x13] = vTempField[9];
  sprintf(sLine,"key : %.36s - purge : %d",Node.szFstKey,Node.tPurgeTime);
  trace_event(sLine,4);
  pcVar7 = sBuffer;
  for (lVar4 = 0x80; lVar4 != 0; lVar4 = lVar4 + -1) {
    pcVar7[0] = '\0';
    pcVar7[1] = '\0';
    pcVar7[2] = '\0';
    pcVar7[3] = '\0';
    pcVar7[4] = '\0';
    pcVar7[5] = '\0';
    pcVar7[6] = '\0';
    pcVar7[7] = '\0';
    pcVar7 = pcVar7 + (ulong)bVar9 * -0x10 + 8;
  }
  iVar1 = NpsBuildMsg(sBuffer,SNpsInfo,IsoInfo_00);
  memcpy(Node.sFstBuf,sBuffer,(long)iVar1);
  Node.nFstBufLen = iVar1;
  __n = strlen(sTlvBuffer);
  memcpy(Node.sSndBuf,sTlvBuffer,__n);
  Node.nSndBufLen = (int)__n;
  iVar1 = InsertRequest('B',&Node);
  if (iVar1 != 0) {
    trace_event("End  ForwardAutRequest(NOK): InsertRequest() failed",5);
    return -1;
  }
  GetIssuerPurgeTime(&nPurgeTime);
  sprintf(sPurgeTime,"%09d",nPurgeTime);
  puVar6 = (uint *)sSecurityData;
  for (lVar4 = 0x200; lVar4 != 0; lVar4 = lVar4 + -1) {
    puVar6[0] = 0;
    puVar6[1] = 0;
    puVar6 = puVar6 + (ulong)bVar9 * -4 + 2;
  }
  GetIsoField(0x34,IsoInfo,sSecurityData,&nLength);
  sDestinationPid[0] = '\0';
  sDestinationPid[1] = '\0';
  sDestinationPid[2] = '\0';
  sDestinationPid[3] = '\0';
  sDestinationPid[4] = '\0';
  sDestinationPid[5] = '\0';
  sDestinationPid[6] = '\0';
  sDestinationPid[7] = '\0';
  sDestinationPid[8] = '\0';
  GetSecurityData(6,sSecurityData,sDestinationPid,&nLength);
  lVar4 = strtol(sDestinationPid,(char **)0x0,10);
  PutSecurityData(9,sSecurityData,sPurgeTime,9);
  puVar6 = (uint *)sSecurityData;
  do {
    puVar5 = puVar6;
    uVar2 = *puVar5 + 0xfefefeff & ~*puVar5;
    uVar3 = uVar2 & 0x80808080;
    puVar6 = puVar5 + 1;
  } while (uVar3 == 0);
  bVar8 = (uVar2 & 0x8080) == 0;
  if (bVar8) {
    uVar3 = uVar3 >> 0x10;
  }
  if (bVar8) {
    puVar6 = (uint *)((long)puVar5 + 6);
  }
  PutIsoField(0x34,IsoInfo,sSecurityData,
              (((int)puVar6 + -3) - (uint)CARRY1((byte)uVar3,(byte)uVar3)) - (int)sSecurityData);
  iVar1 = GetTlvBuffer("102",sTlvBuffer,vTempField,&vTempLen);
  if ((iVar1 == 0) && (iVar1 = InsertIsoField(0x65,IsoInfo,vTempField,vTempLen), iVar1 != 0)) {
    PutIsoField(0x65,IsoInfo,vTempField,vTempLen);
  }
  iVar1 = GetTlvBuffer("003",sTlvBuffer,vTempField,&vTempLen);
  if (iVar1 != 0) goto LAB_00413446;
  iVar1 = memcmp(vTempField + 6,&DAT_004a554a,2);
  if (iVar1 != 0) {
    iVar1 = memcmp(vTempField + 6,&DAT_004a5543,2);
    if (((iVar1 == 0) &&
        (iVar1 = GetGlobalsVar(nIndexCtx,"NPSB_FT_SETTLEMENT_CR_ACC",sNPSBSettlementAcc), iVar1 == 0
        )) && (iVar1 = InsertIsoField(0x66,IsoInfo,sNPSBSettlementAcc,0xd), iVar1 != 0)) {
      PutIsoField(0x66,IsoInfo,sNPSBSettlementAcc,0xd);
    }
    goto LAB_00413446;
  }
  iVar1 = GetGlobalsVar(nIndexCtx,"NPSB_FT_SETTLEMENT_DB_ACC",sNPSBSettlementAcc);
  if (iVar1 != 0) goto LAB_00413446;
  iVar1 = GetTlvBuffer("201",sTlvBuffer,vTempField,&vTempLen);
  if ((iVar1 == 0) && (iVar1 = memcmp(vTempField,"250001",2), iVar1 == 0)) {
    sprintf(sLine,"=> Capture = [%s] ",vTempField);
    trace_event(sLine,0);
    iVar1 = GetTlvBuffer("103",sTlvBuffer,vTempField,&vTempLen);
    pcVar7 = "=> AUTO_ACCOUNT_ID_2_103 = [%s] ";
    if (iVar1 != 0) {
      iVar1 = GetTlvBuffer("102",sTlvBuffer,vTempField,&vTempLen);
      if (iVar1 != 0) goto LAB_0041357f;
      pcVar7 = "=> AUTO_ACCOUNT_ID_2_102 = [%s] ";
    }
    sprintf(sLine,pcVar7,vTempField);
    trace_event(sLine,0);
LAB_0041370d:
    iVar1 = InsertIsoField(0x66,IsoInfo,vTempField,vTempLen);
    if (iVar1 != 0) {
      PutIsoField(0x66,IsoInfo,vTempField,vTempLen);
    }
  }
  else {
    iVar1 = GetTlvBuffer("102",sTlvBuffer,vTempField,&vTempLen);
    if (iVar1 == 0) goto LAB_0041370d;
  }
LAB_0041357f:
  iVar1 = InsertIsoField(0x65,IsoInfo,sNPSBSettlementAcc,0xd);
  if (iVar1 != 0) {
    PutIsoField(0x65,IsoInfo,sNPSBSettlementAcc,0xd);
  }
LAB_00413446:
  sBalMessage.sHeader.nPartnerId = (pid_t)lVar4;
  sBalMessage.sHeader.nSourceId = getpid();
  sBalMessage.sHeader.nCommand = IsoInfo->nMsgType;
  nLength = IsoBuildMsg(sBalMessage.sBody,IsoInfo);
  sBalMessage.sHeader.nLen = nLength;
  uVar3 = WriteBalMsg(nBalMsg,&sBalMessage);
  if (uVar3 == 0) {
    trace_event("End  ForwardAutRequest( OK )",5);
    iVar1 = 0;
  }
  else {
    iVar1 = -1;
    sprintf(sLine,"ForwardAutRequest()-WriteBalMsg() failed : %d",(ulong)uVar3);
    trace_event(sLine,1);
    trace_event("End   ForwardAutRequest(NOK)",5);
  }
  return iVar1;
}



// WARNING: Unknown calling convention

int AutReplyToNps(int nIndexCtx,TSIsoInfo *IsoInfo,TSNpsInfo *OrigNpsInfo)

{
  int iVar1;
  long lVar2;
  TSNpsInfo *pTVar3;
  char *pcVar4;
  TSNpsInfo *pTVar5;
  byte bVar6;
  char vNpsRspCodeTmp [3];
  int FieldLen;
  char FieldData [256];
  char vTempField [256];
  char sLine [512];
  char sBuffer [1024];
  TSNpsInfo NewNpsInfo;
  char sPufData [4096];
  
  bVar6 = 0;
  trace_event("Start  AutReplyToNps()",5);
  pcVar4 = FieldData;
  for (lVar2 = 0x20; lVar2 != 0; lVar2 = lVar2 + -1) {
    pcVar4[0] = '\0';
    pcVar4[1] = '\0';
    pcVar4[2] = '\0';
    pcVar4[3] = '\0';
    pcVar4[4] = '\0';
    pcVar4[5] = '\0';
    pcVar4[6] = '\0';
    pcVar4[7] = '\0';
    pcVar4 = pcVar4 + (ulong)bVar6 * -0x10 + 8;
  }
  vNpsRspCodeTmp[2] = '\0';
  pcVar4 = sPufData;
  for (lVar2 = 0x200; lVar2 != 0; lVar2 = lVar2 + -1) {
    pcVar4[0] = '\0';
    pcVar4[1] = '\0';
    pcVar4[2] = '\0';
    pcVar4[3] = '\0';
    pcVar4[4] = '\0';
    pcVar4[5] = '\0';
    pcVar4[6] = '\0';
    pcVar4[7] = '\0';
    pcVar4 = pcVar4 + (ulong)bVar6 * -0x10 + 8;
  }
  pcVar4 = sBuffer;
  for (lVar2 = 0x80; lVar2 != 0; lVar2 = lVar2 + -1) {
    pcVar4[0] = '\0';
    pcVar4[1] = '\0';
    pcVar4[2] = '\0';
    pcVar4[3] = '\0';
    pcVar4[4] = '\0';
    pcVar4[5] = '\0';
    pcVar4[6] = '\0';
    pcVar4[7] = '\0';
    pcVar4 = pcVar4 + (ulong)bVar6 * -0x10 + 8;
  }
  vNpsRspCodeTmp[0] = '\0';
  vNpsRspCodeTmp[1] = '\0';
  pcVar4 = vTempField;
  for (lVar2 = 0x20; lVar2 != 0; lVar2 = lVar2 + -1) {
    pcVar4[0] = '\0';
    pcVar4[1] = '\0';
    pcVar4[2] = '\0';
    pcVar4[3] = '\0';
    pcVar4[4] = '\0';
    pcVar4[5] = '\0';
    pcVar4[6] = '\0';
    pcVar4[7] = '\0';
    pcVar4 = pcVar4 + (ulong)bVar6 * -0x10 + 8;
  }
  pcVar4 = sLine;
  for (lVar2 = 0x40; lVar2 != 0; lVar2 = lVar2 + -1) {
    pcVar4[0] = '\0';
    pcVar4[1] = '\0';
    pcVar4[2] = '\0';
    pcVar4[3] = '\0';
    pcVar4[4] = '\0';
    pcVar4[5] = '\0';
    pcVar4[6] = '\0';
    pcVar4[7] = '\0';
    pcVar4 = pcVar4 + (ulong)bVar6 * -0x10 + 8;
  }
  InitNpsInfo(&NewNpsInfo);
  InitNpsInfo(&NewNpsInfo);
  pTVar3 = OrigNpsInfo;
  pTVar5 = &NewNpsInfo;
  for (lVar2 = 0x144; lVar2 != 0; lVar2 = lVar2 + -1) {
    *(undefined8 *)pTVar5->nFieldPos = *(undefined8 *)pTVar3->nFieldPos;
    pTVar3 = (TSNpsInfo *)((long)pTVar3 + (ulong)bVar6 * -0x10 + 8);
    pTVar5 = (TSNpsInfo *)((long)pTVar5 + (ulong)bVar6 * -0x10 + 8);
  }
  NewNpsInfo.nMsgType = OrigNpsInfo->nMsgType + 10;
  PutNpsField(99,&NewNpsInfo,"000095",6);
  iVar1 = GetIsoField(0x26,IsoInfo,FieldData,&FieldLen);
  if (iVar1 == 0) {
    sprintf(sLine,"ISO_RESPONSE_CODE: [%s]",FieldData);
    trace_event(sLine,5);
    vNpsRspCodeTmp[0] = '\0';
    vNpsRspCodeTmp[1] = '\0';
    vNpsRspCodeTmp[2] = '\0';
    TranslateRespCode(nIndexCtx,G_sNps.F_szRsrcId,FieldData,"PR",vNpsRspCodeTmp);
    PutNpsField(0x26,&NewNpsInfo,vNpsRspCodeTmp,2);
  }
  iVar1 = GetIsoField(0x25,IsoInfo,FieldData,&FieldLen);
  if (iVar1 == 0) {
    sprintf(sLine,"ISO_AUTHOR_ID: [%s]",FieldData);
    trace_event(sLine,5);
    PutNpsField(0x25,&NewNpsInfo,FieldData,FieldLen);
  }
  GetNpsField(0x10,&NewNpsInfo,FieldData,&FieldLen);
  PutNpsField(0xe,&NewNpsInfo,FieldData,FieldLen);
  iVar1 = Buffer_To_Nps(nIndexCtx,&NewNpsInfo);
  if (iVar1 == 0) {
    trace_event("End  AutReplyToNps(OK)",5);
    iVar1 = 0;
  }
  else {
    iVar1 = -1;
    trace_event("End  AutReplyToNps(Buffer_To_Nps Failed)",5);
  }
  return iVar1;
}



// WARNING: Unknown calling convention

int AutReqReplyToNps(int nIndexCtx,TSIsoInfo *IsoInfo,TSNpsInfo *OrigNpsInfo,char *sTlvBuffer,
                    int nFlag)

{
  undefined8 uVar1;
  undefined4 uVar2;
  int iVar3;
  uint uVar4;
  uint uVar5;
  int iVar6;
  long lVar7;
  long lVar8;
  uint *puVar9;
  uint *puVar10;
  int iVar11;
  char *pcVar12;
  bool bVar13;
  byte bVar14;
  char sCryptoResult [2];
  char sWorkCryptoResult [2];
  char sProductType [3];
  char sNetworkCode [3];
  char vNpsRspCode [4];
  char sAutTabInd [4];
  char sProductCode [4];
  int FieldLen;
  int nLen;
  char sActionCode [4];
  int nLength;
  char sHsmResultCode [5];
  char HexRespCode [5];
  char sDestResource [7];
  char sProcCode [7];
  char sAccAvailable [14];
  char szAvailBal [21];
  char szBusinessDate [256];
  char FieldData [256];
  char vTempField [256];
  char sLine [512];
  char szWork [512];
  char statement [1000];
  char sBuffer [1024];
  TSTagNps NpsIccInfo;
  TSTagIso IsoIccInfo;
  TSNpsInfo NewNpsInfo;
  char sPufData [4096];
  char sSecurityData [4096];
  char sTlvAdvice [4096];
  char sTlvPrivateBuffer [4096];
  char sIccBuffer [4096];
  TSTlvPrivate TlvInfo;
  TSTlvPrivate tlvInfo;
  TSTlvPrivate sTlvPrivateInfo;
  
  bVar14 = 0;
  trace_event("Start  AutReqReplyToNps()",5);
  pcVar12 = FieldData;
  for (lVar7 = 0x20; lVar7 != 0; lVar7 = lVar7 + -1) {
    pcVar12[0] = '\0';
    pcVar12[1] = '\0';
    pcVar12[2] = '\0';
    pcVar12[3] = '\0';
    pcVar12[4] = '\0';
    pcVar12[5] = '\0';
    pcVar12[6] = '\0';
    pcVar12[7] = '\0';
    pcVar12 = pcVar12 + (ulong)bVar14 * -0x10 + 8;
  }
  sDestResource[4] = '\0';
  sDestResource[5] = '\0';
  HexRespCode[0] = '\0';
  HexRespCode[1] = '\0';
  HexRespCode[2] = '\0';
  HexRespCode[3] = '\0';
  HexRespCode[4] = '\0';
  vNpsRspCode[0] = '\0';
  vNpsRspCode[1] = '\0';
  vNpsRspCode[2] = '\0';
  vNpsRspCode[3] = '\0';
  szAvailBal[0] = '\0';
  szAvailBal[1] = '\0';
  szAvailBal[2] = '\0';
  szAvailBal[3] = '\0';
  szAvailBal[4] = '\0';
  szAvailBal[5] = '\0';
  szAvailBal[6] = '\0';
  szAvailBal[7] = '\0';
  szAvailBal[8] = '\0';
  szAvailBal[9] = '\0';
  szAvailBal[10] = '\0';
  szAvailBal[0xb] = '\0';
  szAvailBal[0xc] = '\0';
  szAvailBal[0xd] = '\0';
  szAvailBal[0xe] = '\0';
  szAvailBal[0xf] = '\0';
  szAvailBal[0x10] = '\0';
  szAvailBal[0x11] = '\0';
  szAvailBal[0x12] = '\0';
  szAvailBal[0x13] = '\0';
  szAvailBal[0x14] = '\0';
  pcVar12 = sIccBuffer;
  for (lVar7 = 0x200; lVar7 != 0; lVar7 = lVar7 + -1) {
    pcVar12[0] = '\0';
    pcVar12[1] = '\0';
    pcVar12[2] = '\0';
    pcVar12[3] = '\0';
    pcVar12[4] = '\0';
    pcVar12[5] = '\0';
    pcVar12[6] = '\0';
    pcVar12[7] = '\0';
    pcVar12 = pcVar12 + (ulong)bVar14 * -0x10 + 8;
  }
  sDestResource[0] = '\0';
  sDestResource[1] = '\0';
  sDestResource[2] = '\0';
  sDestResource[3] = '\0';
  sDestResource[6] = '\0';
  sAutTabInd[0] = '\0';
  sAutTabInd[1] = '\0';
  sAutTabInd[2] = '\0';
  sAutTabInd[3] = '\0';
  sHsmResultCode[0] = '\0';
  sHsmResultCode[1] = '\0';
  sHsmResultCode[2] = '\0';
  sHsmResultCode[3] = '\0';
  sHsmResultCode[4] = '\0';
  sProcCode[0] = '\0';
  sProcCode[1] = '\0';
  sProcCode[2] = '\0';
  sProcCode[3] = '\0';
  pcVar12 = sBuffer;
  for (lVar7 = 0x80; lVar7 != 0; lVar7 = lVar7 + -1) {
    pcVar12[0] = '\0';
    pcVar12[1] = '\0';
    pcVar12[2] = '\0';
    pcVar12[3] = '\0';
    pcVar12[4] = '\0';
    pcVar12[5] = '\0';
    pcVar12[6] = '\0';
    pcVar12[7] = '\0';
    pcVar12 = pcVar12 + (ulong)bVar14 * -0x10 + 8;
  }
  pcVar12 = sPufData;
  for (lVar7 = 0x200; lVar7 != 0; lVar7 = lVar7 + -1) {
    pcVar12[0] = '\0';
    pcVar12[1] = '\0';
    pcVar12[2] = '\0';
    pcVar12[3] = '\0';
    pcVar12[4] = '\0';
    pcVar12[5] = '\0';
    pcVar12[6] = '\0';
    pcVar12[7] = '\0';
    pcVar12 = pcVar12 + (ulong)bVar14 * -0x10 + 8;
  }
  pcVar12 = vTempField;
  for (lVar7 = 0x20; lVar7 != 0; lVar7 = lVar7 + -1) {
    pcVar12[0] = '\0';
    pcVar12[1] = '\0';
    pcVar12[2] = '\0';
    pcVar12[3] = '\0';
    pcVar12[4] = '\0';
    pcVar12[5] = '\0';
    pcVar12[6] = '\0';
    pcVar12[7] = '\0';
    pcVar12 = pcVar12 + (ulong)bVar14 * -0x10 + 8;
  }
  pcVar12 = sSecurityData;
  for (lVar7 = 0x200; lVar7 != 0; lVar7 = lVar7 + -1) {
    pcVar12[0] = '\0';
    pcVar12[1] = '\0';
    pcVar12[2] = '\0';
    pcVar12[3] = '\0';
    pcVar12[4] = '\0';
    pcVar12[5] = '\0';
    pcVar12[6] = '\0';
    pcVar12[7] = '\0';
    pcVar12 = pcVar12 + (ulong)bVar14 * -0x10 + 8;
  }
  pcVar12 = sLine;
  for (lVar7 = 0x40; lVar7 != 0; lVar7 = lVar7 + -1) {
    pcVar12[0] = '\0';
    pcVar12[1] = '\0';
    pcVar12[2] = '\0';
    pcVar12[3] = '\0';
    pcVar12[4] = '\0';
    pcVar12[5] = '\0';
    pcVar12[6] = '\0';
    pcVar12[7] = '\0';
    pcVar12 = pcVar12 + (ulong)bVar14 * -0x10 + 8;
  }
  pcVar12 = szWork;
  for (lVar7 = 0x40; lVar7 != 0; lVar7 = lVar7 + -1) {
    pcVar12[0] = '\0';
    pcVar12[1] = '\0';
    pcVar12[2] = '\0';
    pcVar12[3] = '\0';
    pcVar12[4] = '\0';
    pcVar12[5] = '\0';
    pcVar12[6] = '\0';
    pcVar12[7] = '\0';
    pcVar12 = pcVar12 + (ulong)bVar14 * -0x10 + 8;
  }
  pcVar12 = sTlvAdvice;
  for (lVar7 = 0x200; lVar7 != 0; lVar7 = lVar7 + -1) {
    pcVar12[0] = '\0';
    pcVar12[1] = '\0';
    pcVar12[2] = '\0';
    pcVar12[3] = '\0';
    pcVar12[4] = '\0';
    pcVar12[5] = '\0';
    pcVar12[6] = '\0';
    pcVar12[7] = '\0';
    pcVar12 = pcVar12 + (ulong)bVar14 * -0x10 + 8;
  }
  pcVar12 = sTlvPrivateBuffer;
  for (lVar7 = 0x200; lVar7 != 0; lVar7 = lVar7 + -1) {
    pcVar12[0] = '\0';
    pcVar12[1] = '\0';
    pcVar12[2] = '\0';
    pcVar12[3] = '\0';
    pcVar12[4] = '\0';
    pcVar12[5] = '\0';
    pcVar12[6] = '\0';
    pcVar12[7] = '\0';
    pcVar12 = pcVar12 + (ulong)bVar14 * -0x10 + 8;
  }
  puVar10 = (uint *)statement;
  for (lVar7 = 0x7d; lVar7 != 0; lVar7 = lVar7 + -1) {
    puVar10[0] = 0;
    puVar10[1] = 0;
    puVar10 = puVar10 + (ulong)bVar14 * -4 + 2;
  }
  sProcCode[4] = '\0';
  sProcCode[5] = '\0';
  sNetworkCode[0] = '\0';
  sNetworkCode[1] = '\0';
  sProcCode[6] = '\0';
  sNetworkCode[2] = '\0';
  GetIsoField(0x34,IsoInfo,sSecurityData,&nLength);
  GetIsoField(2,IsoInfo,sProcCode,&nLength);
  GetSecurityData(7,sSecurityData,sDestResource,&nLength);
  GetTableInd(IsoInfo,sAutTabInd);
  if (nFlag == 3) {
    iVar11 = AuthorReplyProcessing(nIndexCtx,IsoInfo,sTlvBuffer);
    if (iVar11 != 0) {
      trace_event("Error In AuthorReplyProcessing ",0);
      InsertIsoField(0x26,IsoInfo,"909",3);
      InsertIsoField(0x2b,IsoInfo,"000",3);
    }
  }
  else if (nFlag == 2) {
    trace_event("NOT PROCESSED ",5);
    AuthorLog(nIndexCtx,IsoInfo,G_sNps.F_szRsrcId,sDestResource,sAutTabInd);
  }
  lVar7 = 0;
  iVar11 = 1;
  InitNpsInfo(&NewNpsInfo);
  NewNpsInfo.nMsgType = OrigNpsInfo->nMsgType + 10;
  do {
    iVar3 = (int)lVar7;
    if (sAutRepMsgBitMap[lVar7].nPresenceFlag - 1U < 4) {
      pcVar12 = szWork;
      for (lVar8 = 0x40; lVar8 != 0; lVar8 = lVar8 + -1) {
        pcVar12[0] = '\0';
        pcVar12[1] = '\0';
        pcVar12[2] = '\0';
        pcVar12[3] = '\0';
        pcVar12[4] = '\0';
        pcVar12[5] = '\0';
        pcVar12[6] = '\0';
        pcVar12[7] = '\0';
        pcVar12 = pcVar12 + (ulong)bVar14 * -0x10 + 8;
      }
      if (iVar3 == 0x2f) {
        iVar3 = GetIsoField(0x11,IsoInfo,szWork,&nLen);
        if (((iVar3 == 0) && (lVar8 = strtol(szWork,(char **)0x0,10), (int)lVar8 != 0x177b)) &&
           (iVar3 = GetNpsField(0x2f,OrigNpsInfo,szWork,&nLen), iVar3 == 0)) {
          sprintf(sLine," NPS_ADTNL_DATA_PRIV In Original Message = %s",szWork);
          trace_event(sLine,5);
          AddNpsField(0x2f,&NewNpsInfo,szWork,nLen);
        }
        sprintf(sLine," ISO_MERCHANT_TYPE = %s",szWork);
        trace_event(sLine,5);
      }
      else if (iVar3 < 0x30) {
        if (iVar3 == 0x25) {
          iVar3 = GetIsoField(0x25,IsoInfo,szWork,&nLen);
          if (iVar3 == 0) {
            AddNpsField(0x25,&NewNpsInfo,szWork,nLen);
          }
        }
        else if (iVar3 < 0x26) {
          if (iVar3 == 9) {
            iVar3 = memcmp(sProcCode,&DAT_004c9c21,2);
            if (iVar3 == 0) {
              sprintf(sLine,"MEL25082015 ... DE10 BI, sProcCode=[%s]",sProcCode);
              trace_event(sLine,5);
              pcVar12 = szWork;
              for (lVar8 = 0x40; lVar8 != 0; lVar8 = lVar8 + -1) {
                pcVar12[0] = '\0';
                pcVar12[1] = '\0';
                pcVar12[2] = '\0';
                pcVar12[3] = '\0';
                pcVar12[4] = '\0';
                pcVar12[5] = '\0';
                pcVar12[6] = '\0';
                pcVar12[7] = '\0';
                pcVar12 = pcVar12 + (ulong)bVar14 * -0x10 + 8;
              }
              builtin_strncpy(szWork,"00000001",8);
              AddNpsField(9,&NewNpsInfo,szWork,8);
            }
          }
          else if (iVar3 == 0xe) {
            pcVar12 = szBusinessDate;
            for (lVar8 = 0x20; lVar8 != 0; lVar8 = lVar8 + -1) {
              pcVar12[0] = '\0';
              pcVar12[1] = '\0';
              pcVar12[2] = '\0';
              pcVar12[3] = '\0';
              pcVar12[4] = '\0';
              pcVar12[5] = '\0';
              pcVar12[6] = '\0';
              pcVar12[7] = '\0';
              pcVar12 = pcVar12 + (ulong)bVar14 * -0x10 + 8;
            }
            pcVar12 = szWork;
            for (lVar8 = 0x40; lVar8 != 0; lVar8 = lVar8 + -1) {
              pcVar12[0] = '\0';
              pcVar12[1] = '\0';
              pcVar12[2] = '\0';
              pcVar12[3] = '\0';
              pcVar12[4] = '\0';
              pcVar12[5] = '\0';
              pcVar12[6] = '\0';
              pcVar12[7] = '\0';
              pcVar12 = pcVar12 + (ulong)bVar14 * -0x10 + 8;
            }
            iVar3 = GetIsoField(0xb,IsoInfo,szWork,&nLen);
            if (iVar3 == 0) {
              AddNpsField(0xe,&NewNpsInfo,szWork + 2,4);
            }
          }
          else {
LAB_004145a0:
            if (iVar3 != 0x2e) {
              iVar6 = GetNpsField(iVar3,OrigNpsInfo,szWork,&nLen);
              if (iVar6 == 0) {
                AddNpsField(iVar3,&NewNpsInfo,szWork,nLen);
              }
              goto joined_r0x00413cae;
            }
          }
        }
        else if (iVar3 == 0x26) {
          iVar3 = GetIsoField(0x26,IsoInfo,szWork,&nLen);
          if (iVar3 == 0) {
            iVar3 = TranslateRespCode(nIndexCtx,G_sNps.F_szRsrcId,szWork,"PR",vNpsRspCode);
            if (iVar3 == 0) {
              AddNpsField(0x26,&NewNpsInfo,vNpsRspCode,2);
              goto LAB_00413cb4;
            }
          }
          AddNpsField(0x26,&NewNpsInfo,"89",2);
        }
        else {
          if (iVar3 != 0x2b) goto LAB_004145a0;
          iVar3 = GetIsoField(0x11,IsoInfo,szWork,&nLen);
          if (iVar3 != 0) {
            builtin_strncpy(szWork,"6011",5);
          }
          lVar8 = strtol(szWork,(char **)0x0,10);
          if (((((int)lVar8 == 0x177b) &&
               (iVar3 = GetIsoField(0x26,IsoInfo,szWork,&nLen), iVar3 == 0)) &&
              ((iVar3 = memcmp(szWork,"000",3), iVar3 == 0 ||
               (iVar3 = memcmp(szWork,&DAT_004a5376,3), iVar3 == 0)))) &&
             (iVar3 = GetIsoField(0x35,IsoInfo,szWork,&nLen), iVar3 == 0)) {
            iVar3 = memcmp(szWork + 2,&DAT_004a7e3d,2);
            uVar2 = szWork._15_4_;
            uVar1 = szAvailBal._8_8_;
            if (iVar3 == 0) {
              szAvailBal[7] = szWork[0xf];
              szAvailBal[0] = szWork[8];
              szAvailBal[1] = szWork[9];
              szAvailBal[2] = szWork[10];
              szAvailBal[3] = szWork[0xb];
              szAvailBal[4] = szWork[0xc];
              szAvailBal[5] = szWork[0xd];
              szAvailBal[6] = szWork[0xe];
              szAvailBal[0xb] = szWork[0x13];
              szAvailBal[8] = szWork[0x10];
              szAvailBal[9] = szWork[0x11];
              szAvailBal[10] = szWork[0x12];
              szAvailBal._12_4_ = SUB84(uVar1,4);
              szWork._15_4_ = uVar2;
            }
            else {
              iVar3 = memcmp(szWork + 0x16,&DAT_004a7e3d,2);
              uVar2 = szWork._35_4_;
              uVar1 = szAvailBal._8_8_;
              if (iVar3 != 0) goto LAB_00413cb4;
              szAvailBal[7] = szWork[0x23];
              szAvailBal[0] = szWork[0x1c];
              szAvailBal[1] = szWork[0x1d];
              szAvailBal[2] = szWork[0x1e];
              szAvailBal[3] = szWork[0x1f];
              szAvailBal[4] = szWork[0x20];
              szAvailBal[5] = szWork[0x21];
              szAvailBal[6] = szWork[0x22];
              szAvailBal[0xb] = szWork[0x27];
              szAvailBal[8] = szWork[0x24];
              szAvailBal[9] = szWork[0x25];
              szAvailBal[10] = szWork[0x26];
              szAvailBal._12_4_ = SUB84(uVar1,4);
              szWork._35_4_ = uVar2;
            }
            nLen = sprintf(szWork,"%1s%012d%12.12s","2",0,szAvailBal);
            AddNpsField(0x2b,&NewNpsInfo,szWork,nLen);
          }
        }
      }
      else if (iVar3 == 0x38) {
        iVar3 = GetNpsField(0x38,OrigNpsInfo,szWork,&nLen);
        if (iVar3 == 0) {
          trace_event("NPS_AUTH_LIFE_CYCLE_CODE",5);
          pcVar12 = FieldData;
          for (lVar8 = 0x20; lVar8 != 0; lVar8 = lVar8 + -1) {
            pcVar12[0] = '\0';
            pcVar12[1] = '\0';
            pcVar12[2] = '\0';
            pcVar12[3] = '\0';
            pcVar12[4] = '\0';
            pcVar12[5] = '\0';
            pcVar12[6] = '\0';
            pcVar12[7] = '\0';
            pcVar12 = pcVar12 + (ulong)bVar14 * -0x10 + 8;
          }
          iVar3 = GetIsoField(0x2f,IsoInfo,FieldData,&FieldLen);
          if (iVar3 == 0) {
            InitTlvPrivate(&TlvInfo);
            AnalyseTlvPrivate(FieldData,FieldLen,&TlvInfo);
            pcVar12 = FieldData;
            for (lVar8 = 0x20; lVar8 != 0; lVar8 = lVar8 + -1) {
              pcVar12[0] = '\0';
              pcVar12[1] = '\0';
              pcVar12[2] = '\0';
              pcVar12[3] = '\0';
              pcVar12[4] = '\0';
              pcVar12[5] = '\0';
              pcVar12[6] = '\0';
              pcVar12[7] = '\0';
              pcVar12 = pcVar12 + (ulong)bVar14 * -0x10 + 8;
            }
            iVar3 = GetTlvPrivate("P44",&TlvInfo,FieldData,&FieldLen);
            if ((iVar3 != 0) || (2 < (byte)(FieldData[0] - 0x30U))) goto LAB_00414433;
            iVar3 = 0;
            pcVar12 = FieldData;
            for (lVar8 = 0x20; szWork[2] = FieldData[0], lVar8 != 0; lVar8 = lVar8 + -1) {
              pcVar12[0] = '\0';
              pcVar12[1] = '\0';
              pcVar12[2] = '\0';
              pcVar12[3] = '\0';
              pcVar12[4] = '\0';
              pcVar12[5] = '\0';
              pcVar12[6] = '\0';
              pcVar12[7] = '\0';
              pcVar12 = pcVar12 + (ulong)bVar14 * -0x10 + 8;
            }
          }
          else {
LAB_00414433:
            pcVar12 = FieldData;
            for (lVar8 = 0x20; lVar8 != 0; lVar8 = lVar8 + -1) {
              pcVar12[0] = '\0';
              pcVar12[1] = '\0';
              pcVar12[2] = '\0';
              pcVar12[3] = '\0';
              pcVar12[4] = '\0';
              pcVar12[5] = '\0';
              pcVar12[6] = '\0';
              pcVar12[7] = '\0';
              pcVar12 = pcVar12 + (ulong)bVar14 * -0x10 + 8;
            }
            iVar6 = GetIsoField(0x26,IsoInfo,FieldData,&FieldLen);
            iVar3 = -1;
            if (iVar6 == 0) {
              iVar3 = memcmp(FieldData,"000",3);
              if (iVar3 == 0) {
                szWork[2] = '2';
                iVar3 = 0;
              }
              else {
                iVar3 = memcmp(FieldData,&DAT_004a5429,3);
                if ((iVar3 == 0) || (iVar3 = memcmp(FieldData,"128",3), iVar3 == 0)) {
                  szWork[2] = '1';
                  iVar3 = 0;
                }
                else {
                  szWork[2] = '0';
                  iVar3 = 0;
                }
              }
            }
          }
          if (((szWork[0] != '3') && (szWork[0] != '5')) && (1 < (byte)(szWork[0] - 0x38U))) {
            szWork[0] = '5';
          }
          if (3 < (byte)(szWork[1] - 0x30U)) {
            szWork[1] = '1';
          }
          if (iVar3 != 0) {
            szWork[2] = '0';
            trace_event("external_result_found != OK",5);
          }
          AddNpsField(0x38,&NewNpsInfo,szWork,3);
        }
      }
      else if (iVar3 < 0x39) {
        if (iVar3 == 0x35) {
          iVar3 = GetIsoField(0x35,IsoInfo,szWork,&nLen);
          if ((iVar3 == 0) && (iVar3 = memcmp(sProcCode,&DAT_004c9c21,2), iVar3 == 0)) {
            iVar3 = memcmp(szWork,&DAT_004d4825,2);
            if (iVar3 == 0) {
              szWork[0] = '0';
              szWork[1] = '0';
            }
            iVar3 = memcmp(szWork + 0x14,&DAT_004d4825,2);
            if (iVar3 == 0) {
              szWork[0x14] = '0';
              szWork[0x15] = '0';
            }
            szWork[0x1b] = szWork[7];
            szWork[0x1c] = szWork[8];
            szWork[0x1d] = szWork[9];
            szWork[0x1e] = szWork[10];
            szWork[0x1f] = szWork[0xb];
            szWork[0x20] = szWork[0xc];
            szWork[0x21] = szWork[0xd];
            szWork[0x22] = szWork[0xe];
            szWork[0x23] = szWork[0xf];
            szWork[0x24] = szWork[0x10];
            szWork[0x25] = szWork[0x11];
            szWork[0x26] = szWork[0x12];
            szWork[0x27] = szWork[0x13];
            AddNpsField(0x35,&NewNpsInfo,szWork,nLen);
          }
        }
        else {
          if (iVar3 != 0x36) goto LAB_004145a0;
          iVar3 = GetIsoField(0x36,IsoInfo,szWork,&nLen);
          if (iVar3 == 0) {
            trace_event("ICC TRX NEED TO ADD FIELD 47",5);
            iVar3 = GetIsoField(0x2f,IsoInfo,FieldData,&FieldLen);
            if (iVar3 == 0) {
              sCryptoResult[0] = '\0';
              sCryptoResult[1] = '\0';
              sWorkCryptoResult[0] = '\0';
              sWorkCryptoResult[1] = '\0';
              sActionCode[0] = '\0';
              sActionCode[1] = '\0';
              sActionCode[2] = '\0';
              sActionCode[3] = '\0';
              pcVar12 = szWork;
              for (lVar8 = 0x40; lVar8 != 0; lVar8 = lVar8 + -1) {
                pcVar12[0] = '\0';
                pcVar12[1] = '\0';
                pcVar12[2] = '\0';
                pcVar12[3] = '\0';
                pcVar12[4] = '\0';
                pcVar12[5] = '\0';
                pcVar12[6] = '\0';
                pcVar12[7] = '\0';
                pcVar12 = pcVar12 + (ulong)bVar14 * -0x10 + 8;
              }
              InitTlvPrivate(&TlvInfo);
              InitTlvPrivate(&sTlvPrivateInfo);
              AnalyseTlvPrivate(FieldData,FieldLen,&TlvInfo);
              iVar3 = GetTlvPrivate("P44",&TlvInfo,sCryptoResult,&FieldLen);
              if ((iVar3 == 0) && (sCryptoResult[0] == '2')) {
                sWorkCryptoResult[0] = '2';
                trace_event("external_result_found = OK",5);
              }
              else {
                sWorkCryptoResult[0] = '1';
                trace_event("external_result_found = NOK",5);
              }
              PutTlvPrivate("910",&sTlvPrivateInfo,sWorkCryptoResult,1);
              nLen = PrivateBuildTlv(szWork,&sTlvPrivateInfo);
              if (0 < nLen) {
                PutNpsField(0x2e,&NewNpsInfo,szWork,nLen);
              }
            }
            InitIsoIcTag(&IsoIccInfo);
            AnalyseIsoIc(szWork,nLen,&IsoIccInfo);
            InitNpsIcTag(&NpsIccInfo);
            pcVar12 = FieldData;
            for (lVar8 = 0x20; lVar8 != 0; lVar8 = lVar8 + -1) {
              pcVar12[0] = '\0';
              pcVar12[1] = '\0';
              pcVar12[2] = '\0';
              pcVar12[3] = '\0';
              pcVar12[4] = '\0';
              pcVar12[5] = '\0';
              pcVar12[6] = '\0';
              pcVar12[7] = '\0';
              pcVar12 = pcVar12 + (ulong)bVar14 * -0x10 + 8;
            }
            iVar3 = GetIsoIcTag("7100",&IsoIccInfo,FieldData,&FieldLen);
            if (iVar3 == 0) {
              AddNpsIcTag("7100",&NpsIccInfo,FieldData,FieldLen);
            }
            sprintf(sLine,"===>ISO_TAG_ISS_SCRIPT1    = %s ",FieldData);
            trace_event(sLine,5);
            pcVar12 = FieldData;
            for (lVar8 = 0x20; lVar8 != 0; lVar8 = lVar8 + -1) {
              pcVar12[0] = '\0';
              pcVar12[1] = '\0';
              pcVar12[2] = '\0';
              pcVar12[3] = '\0';
              pcVar12[4] = '\0';
              pcVar12[5] = '\0';
              pcVar12[6] = '\0';
              pcVar12[7] = '\0';
              pcVar12 = pcVar12 + (ulong)bVar14 * -0x10 + 8;
            }
            iVar3 = GetIsoIcTag("7200",&IsoIccInfo,FieldData,&FieldLen);
            if (iVar3 == 0) {
              AddNpsIcTag("7200",&NpsIccInfo,FieldData,FieldLen);
            }
            sprintf(sLine,"===>ISO_TAG_ISS_SCRIPT2    = %s ",FieldData);
            trace_event(sLine,5);
            pcVar12 = FieldData;
            for (lVar8 = 0x20; lVar8 != 0; lVar8 = lVar8 + -1) {
              pcVar12[0] = '\0';
              pcVar12[1] = '\0';
              pcVar12[2] = '\0';
              pcVar12[3] = '\0';
              pcVar12[4] = '\0';
              pcVar12[5] = '\0';
              pcVar12[6] = '\0';
              pcVar12[7] = '\0';
              pcVar12 = pcVar12 + (ulong)bVar14 * -0x10 + 8;
            }
            iVar3 = GetIsoIcTag("9100",&IsoIccInfo,FieldData,&FieldLen);
            if (iVar3 == 0) {
              sprintf(HexRespCode,"%02x%02x",(ulong)(uint)(int)vNpsRspCode[0],
                      (ulong)(uint)(int)vNpsRspCode[1]);
              FieldData[0x10] = HexRespCode[0];
              FieldData[0x11] = HexRespCode[1];
              FieldData[0x12] = HexRespCode[2];
              FieldData[0x13] = HexRespCode[3];
              AddNpsIcTag("9100",&NpsIccInfo,FieldData,FieldLen);
            }
            else {
              check_crpt_data(nIndexCtx,sTlvBuffer,sHsmResultCode);
              pcVar12 = szWork;
              for (lVar8 = 0x40; lVar8 != 0; lVar8 = lVar8 + -1) {
                pcVar12[0] = '\0';
                pcVar12[1] = '\0';
                pcVar12[2] = '\0';
                pcVar12[3] = '\0';
                pcVar12[4] = '\0';
                pcVar12[5] = '\0';
                pcVar12[6] = '\0';
                pcVar12[7] = '\0';
                pcVar12 = pcVar12 + (ulong)bVar14 * -0x10 + 8;
              }
              iVar3 = GetTlvBuffer("055",sTlvBuffer,szWork,&nLen);
              if (iVar3 == 0) {
                InitTlvPrivate(&tlvInfo);
                AnalyseTlvPrivate(szWork,nLen,&tlvInfo);
                pcVar12 = FieldData;
                for (lVar8 = 0x20; lVar8 != 0; lVar8 = lVar8 + -1) {
                  pcVar12[0] = '\0';
                  pcVar12[1] = '\0';
                  pcVar12[2] = '\0';
                  pcVar12[3] = '\0';
                  pcVar12[4] = '\0';
                  pcVar12[5] = '\0';
                  pcVar12[6] = '\0';
                  pcVar12[7] = '\0';
                  pcVar12 = pcVar12 + (ulong)bVar14 * -0x10 + 8;
                }
                iVar3 = GetTlvPrivate("C23",&tlvInfo,FieldData,&FieldLen);
                if (iVar3 == 0) {
                  iVar3 = GetTlvBuffer("204",sTlvBuffer,sNetworkCode,&nLen);
                  if (iVar3 == 0) {
                    sprintf(sLine,"NETWORK CODE  =[%s] ",sNetworkCode);
                    trace_event(sLine,5);
                  }
                  iVar3 = memcmp(sNetworkCode,"01",2);
                  if (iVar3 == 0) {
                    sprintf(HexRespCode,"%02x%02x",(ulong)(uint)(int)vNpsRspCode[0],
                            (ulong)(uint)(int)vNpsRspCode[1]);
                    FieldData[0x10] = HexRespCode[0];
                    FieldData[0x11] = HexRespCode[1];
                    FieldData[0x12] = HexRespCode[2];
                    FieldData[0x13] = HexRespCode[3];
                  }
                  AddNpsIcTag("9100",&NpsIccInfo,FieldData,FieldLen);
                }
              }
            }
            sprintf(sLine,"===>ISO_TAG_ISS_AUTHEN_DATA    = %s ",FieldData);
            trace_event(sLine,5);
            FieldLen = NpsBuildIcFld(sIccBuffer,&NpsIccInfo);
            if (0 < FieldLen) {
              AddNpsField(0x36,&NewNpsInfo,sIccBuffer,FieldLen);
            }
          }
        }
      }
      else if (iVar3 == 99) {
        AddNpsField(99,&NewNpsInfo,"000095",6);
      }
      else {
        if (iVar3 != 0x7c) goto LAB_004145a0;
        iVar3 = GetIsoField(0x47,IsoInfo,FieldData,&FieldLen);
        if (((iVar3 == 0) && (iVar3 = memcmp(sProcCode,&DAT_004a7da4,2), iVar3 == 0)) &&
           (FieldData[0] != '\0')) {
          NwFormatToStatement(nIndexCtx,FieldData,statement);
          sprintf(sLine,"[%s]",statement);
          trace_event(sLine,5);
          puVar10 = (uint *)statement;
          if (statement[0] != '\0') {
            do {
              puVar9 = puVar10;
              uVar4 = *puVar9 + 0xfefefeff & ~*puVar9;
              uVar5 = uVar4 & 0x80808080;
              puVar10 = puVar9 + 1;
            } while (uVar5 == 0);
            bVar13 = (uVar4 & 0x8080) == 0;
            if (bVar13) {
              uVar5 = uVar5 >> 0x10;
            }
            if (bVar13) {
              puVar10 = (uint *)((long)puVar9 + 6);
            }
            sprintf(sLine," ******* strlen(statement) : %d",
                    (char *)((long)puVar10 +
                            ((-3 - (ulong)CARRY1((byte)uVar5,(byte)uVar5)) - (long)statement)));
            trace_event(sLine,5);
            puVar10 = (uint *)statement;
            do {
              puVar9 = puVar10;
              uVar4 = *puVar9 + 0xfefefeff & ~*puVar9;
              uVar5 = uVar4 & 0x80808080;
              puVar10 = puVar9 + 1;
            } while (uVar5 == 0);
            bVar13 = (uVar4 & 0x8080) == 0;
            if (bVar13) {
              uVar5 = uVar5 >> 0x10;
            }
            if (bVar13) {
              puVar10 = (uint *)((long)puVar9 + 6);
            }
            AddNpsField(0x7c,&NewNpsInfo,statement,
                        (((int)puVar10 + -3) - (uint)CARRY1((byte)uVar5,(byte)uVar5)) -
                        (int)statement);
          }
        }
      }
    }
    else {
joined_r0x00413cae:
      if (iVar11 == 0x80) {
        iVar11 = Buffer_To_Nps(nIndexCtx,&NewNpsInfo);
        if (iVar11 == 0) {
          trace_event("End  AutReqReplyToNps(OK)",5);
          iVar11 = 0;
        }
        else {
          trace_event("End  AutReqReplyToNps(Buffer_To_Nps Failed)",5);
          iVar11 = -1;
        }
        return iVar11;
      }
    }
LAB_00413cb4:
    lVar7 = lVar7 + 1;
    iVar11 = iVar11 + 1;
  } while( true );
}



// WARNING: Unknown calling convention

int FCT_AUT_REQ_FROM_NW(int nIndexCtx,TSNpsInfo *NpsInfo)

{
  char cVar1;
  int iVar2;
  int iVar3;
  int iVar4;
  uint uVar5;
  uint uVar6;
  long lVar7;
  uint *puVar8;
  uint *puVar9;
  uchar *puVar10;
  char *pcVar11;
  bool bVar12;
  byte bVar13;
  char sOutType [3];
  char sFunctionCode [4];
  char sAutTabInd [4];
  int nLength;
  int vTempLen;
  char sMcc [5];
  char sProcCode [7];
  char sAuthCode [7];
  char sRoutingCode [7];
  char IsoprocCode [7];
  char sAcquirerBank [12];
  char destAccount [23];
  char sourceAccount [23];
  char sPan [23];
  char sOutPan [23];
  char sDE112 [47];
  char sDE112NpsFormat [47];
  char sNPSBSettlementAcc [100];
  char vTempField [256];
  char sLine [512];
  TSIsoInfo IsoInfo;
  char sTlvBuffer [4096];
  
  bVar13 = 0;
  trace_event("Start   FCT_AUT_REQ_FROM_NW()",5);
  pcVar11 = sTlvBuffer;
  for (lVar7 = 0x200; lVar7 != 0; lVar7 = lVar7 + -1) {
    pcVar11[0] = '\0';
    pcVar11[1] = '\0';
    pcVar11[2] = '\0';
    pcVar11[3] = '\0';
    pcVar11[4] = '\0';
    pcVar11[5] = '\0';
    pcVar11[6] = '\0';
    pcVar11[7] = '\0';
    pcVar11 = pcVar11 + (ulong)bVar13 * -0x10 + 8;
  }
  sProcCode[4] = '\0';
  sProcCode[5] = '\0';
  sAuthCode[4] = '\0';
  sAuthCode[5] = '\0';
  destAccount[0x14] = '\0';
  destAccount[0x15] = '\0';
  sAcquirerBank[0] = '\0';
  sAcquirerBank[1] = '\0';
  sAcquirerBank[2] = '\0';
  sAcquirerBank[3] = '\0';
  sAcquirerBank[4] = '\0';
  sAcquirerBank[5] = '\0';
  sAcquirerBank[6] = '\0';
  sAcquirerBank[7] = '\0';
  sAcquirerBank[8] = '\0';
  sAcquirerBank[9] = '\0';
  sAcquirerBank[10] = '\0';
  sAcquirerBank[0xb] = '\0';
  sProcCode[0] = '\0';
  sProcCode[1] = '\0';
  sProcCode[2] = '\0';
  sProcCode[3] = '\0';
  puVar10 = (uchar *)sDE112;
  for (lVar7 = 5; lVar7 != 0; lVar7 = lVar7 + -1) {
    puVar10[0] = '\0';
    puVar10[1] = '\0';
    puVar10[2] = '\0';
    puVar10[3] = '\0';
    puVar10[4] = '\0';
    puVar10[5] = '\0';
    puVar10[6] = '\0';
    puVar10[7] = '\0';
    puVar10 = puVar10 + (ulong)bVar13 * -0x10 + 8;
  }
  sProcCode[6] = '\0';
  sFunctionCode[0] = '\0';
  sFunctionCode[1] = '\0';
  sFunctionCode[2] = '\0';
  sFunctionCode[3] = '\0';
  sMcc[0] = '\0';
  sMcc[1] = '\0';
  sMcc[2] = '\0';
  sMcc[3] = '\0';
  sMcc[4] = '\0';
  sAuthCode[0] = '\0';
  sAuthCode[1] = '\0';
  sAuthCode[2] = '\0';
  sAuthCode[3] = '\0';
  sAuthCode[6] = '\0';
  sAutTabInd[0] = '\0';
  sAutTabInd[1] = '\0';
  sAutTabInd[2] = '\0';
  sAutTabInd[3] = '\0';
  destAccount[0] = '\0';
  destAccount[1] = '\0';
  destAccount[2] = '\0';
  destAccount[3] = '\0';
  destAccount[4] = '\0';
  destAccount[5] = '\0';
  destAccount[6] = '\0';
  destAccount[7] = '\0';
  destAccount[8] = '\0';
  destAccount[9] = '\0';
  destAccount[10] = '\0';
  destAccount[0xb] = '\0';
  destAccount[0xc] = '\0';
  destAccount[0xd] = '\0';
  destAccount[0xe] = '\0';
  destAccount[0xf] = '\0';
  destAccount[0x10] = '\0';
  destAccount[0x11] = '\0';
  destAccount[0x12] = '\0';
  destAccount[0x13] = '\0';
  puVar10[4] = '\0';
  puVar10[5] = '\0';
  puVar10[0] = '\0';
  puVar10[1] = '\0';
  puVar10[2] = '\0';
  puVar10[3] = '\0';
  puVar10[6] = '\0';
  destAccount[0x16] = '\0';
  pcVar11 = sLine;
  for (lVar7 = 0x40; lVar7 != 0; lVar7 = lVar7 + -1) {
    pcVar11[0] = '\0';
    pcVar11[1] = '\0';
    pcVar11[2] = '\0';
    pcVar11[3] = '\0';
    pcVar11[4] = '\0';
    pcVar11[5] = '\0';
    pcVar11[6] = '\0';
    pcVar11[7] = '\0';
    pcVar11 = pcVar11 + (ulong)bVar13 * -0x10 + 8;
  }
  pcVar11 = vTempField;
  for (lVar7 = 0x20; lVar7 != 0; lVar7 = lVar7 + -1) {
    pcVar11[0] = '\0';
    pcVar11[1] = '\0';
    pcVar11[2] = '\0';
    pcVar11[3] = '\0';
    pcVar11[4] = '\0';
    pcVar11[5] = '\0';
    pcVar11[6] = '\0';
    pcVar11[7] = '\0';
    pcVar11 = pcVar11 + (ulong)bVar13 * -0x10 + 8;
  }
  sPan[0x14] = '\0';
  sPan[0x15] = '\0';
  sOutPan[0x14] = '\0';
  sOutPan[0x15] = '\0';
  puVar9 = (uint *)sDE112NpsFormat;
  for (lVar7 = 5; lVar7 != 0; lVar7 = lVar7 + -1) {
    puVar9[0] = 0;
    puVar9[1] = 0;
    puVar9 = puVar9 + (ulong)bVar13 * -4 + 2;
  }
  sPan[0] = '\0';
  sPan[1] = '\0';
  sPan[2] = '\0';
  sPan[3] = '\0';
  sPan[4] = '\0';
  sPan[5] = '\0';
  sPan[6] = '\0';
  sPan[7] = '\0';
  sPan[8] = '\0';
  sPan[9] = '\0';
  sPan[10] = '\0';
  sPan[0xb] = '\0';
  sPan[0xc] = '\0';
  sPan[0xd] = '\0';
  sPan[0xe] = '\0';
  sPan[0xf] = '\0';
  sPan[0x10] = '\0';
  sPan[0x11] = '\0';
  sPan[0x12] = '\0';
  sPan[0x13] = '\0';
  sPan[0x16] = '\0';
  sOutPan[0] = '\0';
  sOutPan[1] = '\0';
  sOutPan[2] = '\0';
  sOutPan[3] = '\0';
  sOutPan[4] = '\0';
  sOutPan[5] = '\0';
  sOutPan[6] = '\0';
  sOutPan[7] = '\0';
  sOutPan[8] = '\0';
  sOutPan[9] = '\0';
  sOutPan[10] = '\0';
  sOutPan[0xb] = '\0';
  sOutPan[0xc] = '\0';
  sOutPan[0xd] = '\0';
  sOutPan[0xe] = '\0';
  sOutPan[0xf] = '\0';
  *puVar9 = 0;
  *(undefined2 *)(puVar9 + 1) = 0;
  *(uchar *)((long)puVar9 + 6) = '\0';
  puVar9 = (uint *)sNPSBSettlementAcc;
  for (lVar7 = 0xc; lVar7 != 0; lVar7 = lVar7 + -1) {
    puVar9[0] = 0;
    puVar9[1] = 0;
    puVar9 = puVar9 + (ulong)bVar13 * -4 + 2;
  }
  sOutPan[0x10] = '\0';
  sOutPan[0x11] = '\0';
  sOutPan[0x12] = '\0';
  sOutPan[0x13] = '\0';
  sOutPan[0x16] = '\0';
  sOutType[2] = '\0';
  IsoprocCode[0] = '\0';
  IsoprocCode[1] = '\0';
  IsoprocCode[2] = '\0';
  IsoprocCode[3] = '\0';
  IsoprocCode[4] = '\0';
  IsoprocCode[5] = '\0';
  IsoprocCode[6] = '\0';
  *puVar9 = 0;
  sOutType[0] = '\0';
  sOutType[1] = '\0';
  iVar2 = ConvNpsToISO(nIndexCtx,NpsInfo,&IsoInfo);
  if (iVar2 != 0) {
    trace_event("ConvNpsToISO()  Error ...",1);
    InsertIsoField(0x26,&IsoInfo,"909",3);
    InsertIsoField(0x2b,&IsoInfo,"000",3);
    iVar2 = AutReplyToNps(nIndexCtx,&IsoInfo,NpsInfo);
    if (iVar2 == 0) {
      trace_event("End  FCT_AUT_REQ_FROM_NW( NOK --> Error ConvNpsToISO )",5);
      return -1;
    }
    trace_event("End  FCT_AUT_REQ_FROM_NW(NOK): AutReplyToNps(1) failed",5);
    return -1;
  }
  dump_p7_struct(&IsoInfo);
  GetIsoField(0x11,&IsoInfo,sMcc,&nLength);
  GetIsoField(0x17,&IsoInfo,sFunctionCode,&nLength);
  GetIsoField(2,&IsoInfo,sProcCode,&nLength);
  sAcquirerBank[4] = AcquirerBank[4];
  sAcquirerBank[5] = AcquirerBank[5];
  sAcquirerBank[0] = AcquirerBank[0];
  sAcquirerBank[1] = AcquirerBank[1];
  sAcquirerBank[2] = AcquirerBank[2];
  sAcquirerBank[3] = AcquirerBank[3];
  iVar3 = GetTableInd(&IsoInfo,sAutTabInd);
  sprintf(sLine,"... My Message Type : %d",(ulong)(uint)IsoInfo.nMsgType);
  trace_event(sLine,4);
  sprintf(sLine,"PROC CODE : %s",sProcCode);
  trace_event(sLine,4);
  iVar4 = memcmp(sProcCode,"00",2);
  iVar2 = (int)sDE112NpsFormat;
  if (iVar4 == 0) {
    lVar7 = strtol(sFunctionCode,(char **)0x0,10);
    iVar4 = (int)lVar7;
    if (iVar4 == 0x65) {
      builtin_strncpy(sDE112,"F013D20954574841545F545258D30654504F535041",0x2a);
      AsciiToHex((uchar *)sDE112,(uchar *)sDE112NpsFormat,0x2a);
      iVar4 = GetIsoField(0x6f,&IsoInfo,vTempField,&vTempLen);
      puVar9 = (uint *)sDE112NpsFormat;
      if (iVar4 != 0) {
        do {
          puVar8 = puVar9;
          uVar5 = *puVar8 + 0xfefefeff & ~*puVar8;
          uVar6 = uVar5 & 0x80808080;
          puVar9 = puVar8 + 1;
        } while (uVar6 == 0);
        bVar12 = (uVar5 & 0x8080) == 0;
        if (bVar12) {
          uVar6 = uVar6 >> 0x10;
        }
        if (bVar12) {
          puVar9 = (uint *)((long)puVar8 + 6);
        }
        PutIsoField(0x6f,&IsoInfo,sDE112NpsFormat,
                    (((int)puVar9 + -3) - (uint)CARRY1((byte)uVar6,(byte)uVar6)) - iVar2);
      }
      dump_p7_struct(&IsoInfo);
      iVar3 = PreauthProcessing(nIndexCtx,G_sNps.F_szRsrcId,"PRE",sAcquirerBank,"N","G","Y",
                                sTlvBuffer,&IsoInfo);
    }
    else if ((iVar4 == 200) || (iVar4 == 100)) {
      iVar4 = GetIsoField(0x25,&IsoInfo,sAuthCode,&nLength);
      if ((iVar4 == 0) && (sAuthCode[0] != '\0')) {
        builtin_strncpy(sDE112,"F013D20954574841545F545258D30654504F535250",0x2a);
        AsciiToHex((uchar *)sDE112,(uchar *)sDE112NpsFormat,0x2a);
        iVar4 = GetIsoField(0x6f,&IsoInfo,vTempField,&vTempLen);
        puVar9 = (uint *)sDE112NpsFormat;
        if (iVar4 != 0) {
          do {
            puVar8 = puVar9;
            uVar5 = *puVar8 + 0xfefefeff & ~*puVar8;
            uVar6 = uVar5 & 0x80808080;
            puVar9 = puVar8 + 1;
          } while (uVar6 == 0);
          bVar12 = (uVar5 & 0x8080) == 0;
          if (bVar12) {
            uVar6 = uVar6 >> 0x10;
          }
          if (bVar12) {
            puVar9 = (uint *)((long)puVar8 + 6);
          }
          PutIsoField(0x6f,&IsoInfo,sDE112NpsFormat,
                      (((int)puVar9 + -3) - (uint)CARRY1((byte)uVar6,(byte)uVar6)) - iVar2);
        }
        dump_p7_struct(&IsoInfo);
        iVar3 = CompletionProcessing
                          (nIndexCtx,G_sNps.F_szRsrcId,sAutTabInd,sAcquirerBank,"N","G","Y",
                           sTlvBuffer,&IsoInfo);
      }
      else {
        builtin_strncpy(sDE112,"F013D20954574841545F545258D30654504F535250",0x2a);
        AsciiToHex((uchar *)sDE112,(uchar *)sDE112NpsFormat,0x2a);
        iVar4 = GetIsoField(0x6f,&IsoInfo,vTempField,&vTempLen);
        puVar9 = (uint *)sDE112NpsFormat;
        if (iVar4 != 0) {
          do {
            puVar8 = puVar9;
            uVar5 = *puVar8 + 0xfefefeff & ~*puVar8;
            uVar6 = uVar5 & 0x80808080;
            puVar9 = puVar8 + 1;
          } while (uVar6 == 0);
          bVar12 = (uVar5 & 0x8080) == 0;
          if (bVar12) {
            uVar6 = uVar6 >> 0x10;
          }
          if (bVar12) {
            puVar9 = (uint *)((long)puVar8 + 6);
          }
          PutIsoField(0x6f,&IsoInfo,sDE112NpsFormat,
                      (((int)puVar9 + -3) - (uint)CARRY1((byte)uVar6,(byte)uVar6)) - iVar2);
        }
        dump_p7_struct(&IsoInfo);
        iVar3 = RetailPurchaseProcessing
                          (nIndexCtx,G_sNps.F_szRsrcId,sAutTabInd,sAcquirerBank,"N","G","Y",
                           sTlvBuffer,&IsoInfo);
      }
    }
  }
  else {
    iVar4 = memcmp(sProcCode,&DAT_004a670e,2);
    if (iVar4 == 0) {
      builtin_strncpy(sDE112,"F013D20954574841545F545258D30654504F534341",0x2a);
      AsciiToHex((uchar *)sDE112,(uchar *)sDE112NpsFormat,0x2a);
      iVar4 = GetIsoField(0x6f,&IsoInfo,vTempField,&vTempLen);
      puVar9 = (uint *)sDE112NpsFormat;
      if (iVar4 != 0) {
        do {
          puVar8 = puVar9;
          uVar5 = *puVar8 + 0xfefefeff & ~*puVar8;
          uVar6 = uVar5 & 0x80808080;
          puVar9 = puVar8 + 1;
        } while (uVar6 == 0);
        bVar12 = (uVar5 & 0x8080) == 0;
        if (bVar12) {
          uVar6 = uVar6 >> 0x10;
        }
        if (bVar12) {
          puVar9 = (uint *)((long)puVar8 + 6);
        }
        PutIsoField(0x6f,&IsoInfo,sDE112NpsFormat,
                    (((int)puVar9 + -3) - (uint)CARRY1((byte)uVar6,(byte)uVar6)) - iVar2);
      }
      dump_p7_struct(&IsoInfo);
      iVar3 = CashAdvanceProcessing
                        (nIndexCtx,G_sNps.F_szRsrcId,sAutTabInd,sAcquirerBank,"N","G","Y",sTlvBuffer
                         ,&IsoInfo);
    }
    else {
      iVar2 = memcmp(sProcCode,&DAT_004c9c21,2);
      if (iVar2 == 0) {
        iVar2 = memcmp(sProcCode,&DAT_004a7da4,2);
        if (iVar2 == 0) goto LAB_00415550;
        iVar3 = BalanceInquiryProcessing
                          (nIndexCtx,G_sNps.F_szRsrcId,sAutTabInd,sAcquirerBank,"N","G","Y",
                           sTlvBuffer,&IsoInfo);
      }
      else {
        iVar2 = memcmp(sProcCode,&DAT_004a7da4,2);
        if (iVar2 == 0) {
LAB_00415550:
          iVar3 = StatementReqProcessing
                            (nIndexCtx,G_sNps.F_szRsrcId,sAutTabInd,sAcquirerBank,"Y","S","N",
                             sTlvBuffer,&IsoInfo);
        }
        else {
          iVar2 = memcmp(sProcCode,&DAT_004c9c1d,2);
          if (iVar2 == 0) {
            sprintf(sLine,"IN  28  PROC CODE : %s",sProcCode);
            trace_event(sLine,4);
            GetIsoField(1,&IsoInfo,sPan,&nLength);
            GetIsoField(0x66,&IsoInfo,destAccount,&nLength);
            PutIsoField(2,&IsoInfo,"430000",6);
            puVar9 = (uint *)sPan;
            do {
              puVar8 = puVar9;
              uVar5 = *puVar8 + 0xfefefeff & ~*puVar8;
              uVar6 = uVar5 & 0x80808080;
              puVar9 = puVar8 + 1;
            } while (uVar6 == 0);
            bVar12 = (uVar5 & 0x8080) == 0;
            if (bVar12) {
              uVar6 = uVar6 >> 0x10;
            }
            if (bVar12) {
              puVar9 = (uint *)((long)puVar8 + 6);
            }
            iVar2 = memcmp(sPan,"0000950000000000",
                           (size_t)((long)puVar9 +
                                   ((-3 - (ulong)CARRY1((byte)uVar6,(byte)uVar6)) - (long)sPan)));
            if (iVar2 == 0) {
              iVar2 = get_card_number(nIndexCtx,destAccount,sOutPan);
              if (iVar2 == 0) {
                lVar7 = -1;
                pcVar11 = sOutPan;
                do {
                  if (lVar7 == 0) break;
                  lVar7 = lVar7 + -1;
                  cVar1 = *pcVar11;
                  pcVar11 = pcVar11 + (ulong)bVar13 * -2 + 1;
                } while (cVar1 != '\0');
                PutIsoField(1,&IsoInfo,sOutPan,~(uint)lVar7 - 1);
              }
              iVar2 = get_Account_type(nIndexCtx,destAccount,sOutType);
              if (iVar2 == 0) {
                sprintf(sLine,"Account type against destAccount : %s",sOutType);
                trace_event(sLine,4);
                builtin_strncpy(IsoprocCode,"4300",4);
                IsoprocCode[4] = sOutType[0];
                IsoprocCode[5] = sOutType[1];
                PutIsoField(2,&IsoInfo,IsoprocCode,6);
              }
            }
          }
          else {
            iVar2 = memcmp(sProcCode,&DAT_004d1ee1,2);
            if (iVar2 == 0) {
              PutIsoField(2,&IsoInfo,"440000",6);
            }
          }
          iVar3 = AuthorRequestProcessing
                            (nIndexCtx,G_sNps.F_szRsrcId,sAutTabInd,sAcquirerBank,"Y","G","Y",
                             sTlvBuffer,&IsoInfo);
          sprintf(sLine,"PROC CODE : %s",sProcCode);
          trace_event(sLine,4);
          iVar4 = memcmp(sProcCode,&DAT_004d1ee1,2);
          iVar2 = (int)sNPSBSettlementAcc;
          if (iVar4 == 0) {
            sprintf(sLine,"PROC CODE : %s",sProcCode);
            trace_event(sLine,4);
            iVar4 = GetGlobalsVar(nIndexCtx,"NPSB_FT_SETTLEMENT_CR_ACC",sNPSBSettlementAcc);
            puVar9 = (uint *)sNPSBSettlementAcc;
            if (iVar4 == 0) {
              do {
                puVar8 = puVar9;
                uVar5 = *puVar8 + 0xfefefeff & ~*puVar8;
                uVar6 = uVar5 & 0x80808080;
                puVar9 = puVar8 + 1;
              } while (uVar6 == 0);
              bVar12 = (uVar5 & 0x8080) == 0;
              if (bVar12) {
                uVar6 = uVar6 >> 0x10;
              }
              if (bVar12) {
                puVar9 = (uint *)((long)puVar8 + 6);
              }
              PutIsoField(0x66,&IsoInfo,sNPSBSettlementAcc,
                          (((int)puVar9 + -3) - (uint)CARRY1((byte)uVar6,(byte)uVar6)) - iVar2);
            }
          }
          iVar4 = memcmp(sProcCode,&DAT_004c9c1d,2);
          if (iVar4 == 0) {
            sprintf(sLine,"PROC CODE : %s",sProcCode);
            trace_event(sLine,4);
            puVar9 = (uint *)sPan;
            do {
              puVar8 = puVar9;
              uVar5 = *puVar8 + 0xfefefeff & ~*puVar8;
              uVar6 = uVar5 & 0x80808080;
              puVar9 = puVar8 + 1;
            } while (uVar6 == 0);
            bVar12 = (uVar5 & 0x8080) == 0;
            if (bVar12) {
              uVar6 = uVar6 >> 0x10;
            }
            if (bVar12) {
              puVar9 = (uint *)((long)puVar8 + 6);
            }
            iVar4 = memcmp(sPan,"0000950000000000",
                           (size_t)((long)puVar9 +
                                   ((-3 - (ulong)CARRY1((byte)uVar6,(byte)uVar6)) - (long)sPan)));
            if (iVar4 == 0) {
              puVar9 = (uint *)sOutPan;
              do {
                puVar8 = puVar9;
                uVar5 = *puVar8 + 0xfefefeff & ~*puVar8;
                uVar6 = uVar5 & 0x80808080;
                puVar9 = puVar8 + 1;
              } while (uVar6 == 0);
              bVar12 = (uVar5 & 0x8080) == 0;
              if (bVar12) {
                uVar6 = uVar6 >> 0x10;
              }
              if (bVar12) {
                puVar9 = (uint *)((long)puVar8 + 6);
              }
              PutIsoField(1,&IsoInfo,sOutPan,
                          (((int)puVar9 + -3) - (uint)CARRY1((byte)uVar6,(byte)uVar6)) -
                          (int)sOutPan);
            }
            iVar4 = GetGlobalsVar(nIndexCtx,"NPSB_FT_SETTLEMENT_DB_ACC",sNPSBSettlementAcc);
            puVar9 = (uint *)sNPSBSettlementAcc;
            if (iVar4 == 0) {
              do {
                puVar8 = puVar9;
                uVar5 = *puVar8 + 0xfefefeff & ~*puVar8;
                uVar6 = uVar5 & 0x80808080;
                puVar9 = puVar8 + 1;
              } while (uVar6 == 0);
              bVar12 = (uVar5 & 0x8080) == 0;
              if (bVar12) {
                uVar6 = uVar6 >> 0x10;
              }
              if (bVar12) {
                puVar9 = (uint *)((long)puVar8 + 6);
              }
              PutIsoField(0x65,&IsoInfo,sNPSBSettlementAcc,
                          (((int)puVar9 + -3) - (uint)CARRY1((byte)uVar6,(byte)uVar6)) - iVar2);
            }
          }
        }
      }
    }
  }
  if (iVar3 < 2) {
    if (-2 < iVar3) {
      iVar2 = AutReqReplyToNps(nIndexCtx,&IsoInfo,NpsInfo,sTlvBuffer,1);
      if (iVar2 != 0) {
LAB_00415651:
        trace_event("End  FCT_AUT_REQ_FROM_NW(NOK)",5);
        return -1;
      }
      goto LAB_0041542f;
    }
    if (iVar3 == -9) {
      trace_event("SEVERE_ERROR Returned",5);
      return -1;
    }
  }
  else if (iVar3 == 5) {
    iVar2 = memcmp(sProcCode,&DAT_004c9c1d,2);
    if ((iVar2 == 0) || (iVar2 = memcmp(sProcCode,&DAT_004d1ee1,2), iVar2 == 0)) {
      trace_event("Start  ForwardAutRequest Proc Code : 28 || 10 ",5);
      sRoutingCode[4] = '\0';
      sRoutingCode[5] = '\0';
      IsoInfo.nMsgType = 0x4b0;
      sRoutingCode[0] = '\0';
      sRoutingCode[1] = '\0';
      sRoutingCode[2] = '\0';
      sRoutingCode[3] = '\0';
      sRoutingCode[6] = '\0';
      GetTlvBuffer("200",sTlvBuffer,sRoutingCode,&nLength);
      sprintf(sLine,"ForwardAutRequest sRoutingCode %s",sRoutingCode);
      trace_event(sLine,5);
      iVar2 = memcmp(sRoutingCode,&DAT_004a7e3d,2);
      if (iVar2 == 0) {
        iVar2 = memcmp(sProcCode,&DAT_004d1ee1,2);
        if (iVar2 == 0) {
          PutIsoField(0x5e,&IsoInfo,"FT0044",6);
        }
        else {
          PutIsoField(0x5e,&IsoInfo,"FT0043",6);
        }
      }
    }
    dump_p7_struct(&IsoInfo);
    iVar2 = ForwardAutRequest(nIndexCtx,&IsoInfo,NpsInfo,sTlvBuffer);
    if (iVar2 != 0) {
      PutIsoField(0x26,&IsoInfo,"912",3);
      iVar2 = AutReqReplyToNps(nIndexCtx,&IsoInfo,NpsInfo,sTlvBuffer,3);
      if (iVar2 == -1) {
        trace_event("--> AutReqReplyToNps( NOK )",5);
        trace_event("End  FCT_AUT_REQ_FROM_NW(NOK)",5);
        return -1;
      }
      trace_event("--> ForwardAutrequest(NOK)",5);
      goto LAB_00415651;
    }
  }
  iVar2 = 0;
LAB_0041542f:
  trace_event("End  FCT_AUT_REQ_FROM_NW(OK)",5);
  return iVar2;
}



// WARNING: Unknown calling convention

int FCT_AUT_REP_TO_NW(int nIndexCtx,TSIsoInfo *IsoInfo)

{
  int iVar1;
  long lVar2;
  char *pcVar3;
  byte bVar4;
  int vTempLen;
  char slProcCode [7];
  char vTempField [256];
  char sLine [512];
  TSNpsInfo OrigNpsInfo;
  char sTlvBuffer [4096];
  TSNodeData Node;
  
  bVar4 = 0;
  trace_event("START    FCT_AUT_REP_TO_NW()",5);
  pcVar3 = sTlvBuffer;
  for (lVar2 = 0x200; lVar2 != 0; lVar2 = lVar2 + -1) {
    pcVar3[0] = '\0';
    pcVar3[1] = '\0';
    pcVar3[2] = '\0';
    pcVar3[3] = '\0';
    pcVar3[4] = '\0';
    pcVar3[5] = '\0';
    pcVar3[6] = '\0';
    pcVar3[7] = '\0';
    pcVar3 = pcVar3 + (ulong)bVar4 * -0x10 + 8;
  }
  slProcCode[0] = '\0';
  slProcCode[1] = '\0';
  slProcCode[2] = '\0';
  slProcCode[3] = '\0';
  slProcCode[4] = '\0';
  slProcCode[5] = '\0';
  slProcCode[6] = '\0';
  pcVar3 = sLine;
  for (lVar2 = 0x40; lVar2 != 0; lVar2 = lVar2 + -1) {
    pcVar3[0] = '\0';
    pcVar3[1] = '\0';
    pcVar3[2] = '\0';
    pcVar3[3] = '\0';
    pcVar3[4] = '\0';
    pcVar3[5] = '\0';
    pcVar3[6] = '\0';
    pcVar3[7] = '\0';
    pcVar3 = pcVar3 + (ulong)bVar4 * -0x10 + 8;
  }
  pcVar3 = vTempField;
  for (lVar2 = 0x20; lVar2 != 0; lVar2 = lVar2 + -1) {
    pcVar3[0] = '\0';
    pcVar3[1] = '\0';
    pcVar3[2] = '\0';
    pcVar3[3] = '\0';
    pcVar3[4] = '\0';
    pcVar3[5] = '\0';
    pcVar3[6] = '\0';
    pcVar3[7] = '\0';
    pcVar3 = pcVar3 + (ulong)bVar4 * -0x10 + 8;
  }
  dump_p7_struct(IsoInfo);
  InitNodeData(&Node);
  sprintf(Node.szFstKey,"%04d",100);
  GetIsoField(10,IsoInfo,vTempField,&vTempLen);
  Node.szFstKey[4] = vTempField[0];
  Node.szFstKey[5] = vTempField[1];
  Node.szFstKey[6] = vTempField[2];
  Node.szFstKey[7] = vTempField[3];
  Node.szFstKey[8] = vTempField[4];
  Node.szFstKey[9] = vTempField[5];
  GetIsoField(6,IsoInfo,vTempField,&vTempLen);
  Node.szFstKey[0x12] = vTempField[8];
  Node.szFstKey[0x13] = vTempField[9];
  sprintf(sLine,"key : %.36s",Node.szFstKey);
  trace_event(sLine,4);
  iVar1 = FetchRequest('B',&Node);
  if (iVar1 == -0xb) {
    iVar1 = -1;
    trace_event("FetchRequest failed (ENOEXIST)",1);
    trace_event("End FCT_AUT_REP_TO_NW (NOK)",1);
  }
  else {
    trace_event("FetchRequest SUCCESS",5);
    InitNpsInfo(&OrigNpsInfo);
    AnalyseNps(Node.sFstBuf,&OrigNpsInfo);
    pcVar3 = sTlvBuffer;
    for (lVar2 = 0x200; lVar2 != 0; lVar2 = lVar2 + -1) {
      pcVar3[0] = '\0';
      pcVar3[1] = '\0';
      pcVar3[2] = '\0';
      pcVar3[3] = '\0';
      pcVar3[4] = '\0';
      pcVar3[5] = '\0';
      pcVar3[6] = '\0';
      pcVar3[7] = '\0';
      pcVar3 = pcVar3 + (ulong)bVar4 * -0x10 + 8;
    }
    memcpy(sTlvBuffer,Node.sSndBuf,(long)Node.nSndBufLen);
    AuthorReplyProcessing(nIndexCtx,IsoInfo,sTlvBuffer);
    iVar1 = AutReqReplyToNps(nIndexCtx,IsoInfo,&OrigNpsInfo,sTlvBuffer,1);
    if (iVar1 == 0) {
      trace_event("END      FCT_AUT_REP_TO_NW()",5);
      iVar1 = 0;
    }
    else {
      iVar1 = -1;
      trace_event("End  FCT_AUT_REP_TO_NW(NOK)",5);
    }
  }
  return iVar1;
}



// WARNING: Unknown calling convention

int ForwardAdvRequest(int nIndexCtx,TSIsoInfo *IsoInfo,TSNpsInfo *SNpsInfo,char *sTlvBuffer)

{
  int iVar1;
  uint uVar2;
  uint uVar3;
  size_t __n;
  pthread_t pVar4;
  long lVar5;
  uint *puVar6;
  uint *puVar7;
  TSIsoInfo *IsoInfo_00;
  char *pcVar8;
  bool bVar9;
  byte bVar10;
  int nLength;
  int tmpFieldLen;
  char szTid [6];
  time_t nPurgeTime;
  char sSourcePid [9];
  char sDestinationPid [9];
  char szUser [16];
  char vFetchKey [56];
  char sPurgeTime [128];
  char tmpField [256];
  char sLine [512];
  char sBuffer [1024];
  char sSecurityData [4096];
  TSBalExchange sBalMessage;
  TSNodeData Node;
  
  bVar10 = 0;
  trace_event(" START ForwardAdvRequest()",5);
  sSourcePid[0] = '\0';
  sSourcePid[1] = '\0';
  sSourcePid[2] = '\0';
  sSourcePid[3] = '\0';
  sSourcePid[4] = '\0';
  sSourcePid[5] = '\0';
  sSourcePid[6] = '\0';
  sSourcePid[7] = '\0';
  pcVar8 = sLine;
  for (lVar5 = 0x40; lVar5 != 0; lVar5 = lVar5 + -1) {
    pcVar8[0] = '\0';
    pcVar8[1] = '\0';
    pcVar8[2] = '\0';
    pcVar8[3] = '\0';
    pcVar8[4] = '\0';
    pcVar8[5] = '\0';
    pcVar8[6] = '\0';
    pcVar8[7] = '\0';
    pcVar8 = pcVar8 + (ulong)bVar10 * -0x10 + 8;
  }
  szTid[4] = '\0';
  szTid[5] = '\0';
  sSourcePid[8] = '\0';
  sDestinationPid[0] = '\0';
  sDestinationPid[1] = '\0';
  sDestinationPid[2] = '\0';
  sDestinationPid[3] = '\0';
  sDestinationPid[4] = '\0';
  sDestinationPid[5] = '\0';
  sDestinationPid[6] = '\0';
  sDestinationPid[7] = '\0';
  sDestinationPid[8] = '\0';
  szUser[0] = '\0';
  szUser[1] = '\0';
  szUser[2] = '\0';
  szUser[3] = '\0';
  szUser[4] = '\0';
  szUser[5] = '\0';
  szUser[6] = '\0';
  szUser[7] = '\0';
  szUser[8] = '\0';
  szUser[9] = '\0';
  szUser[10] = '\0';
  szUser[0xb] = '\0';
  szUser[0xc] = '\0';
  szUser[0xd] = '\0';
  szUser[0xe] = '\0';
  szUser[0xf] = '\0';
  szTid[0] = '\0';
  szTid[1] = '\0';
  szTid[2] = '\0';
  szTid[3] = '\0';
  puVar7 = (uint *)sSecurityData;
  for (lVar5 = 0x200; lVar5 != 0; lVar5 = lVar5 + -1) {
    puVar7[0] = 0;
    puVar7[1] = 0;
    puVar7 = puVar7 + (ulong)bVar10 * -4 + 2;
  }
  pcVar8 = sPurgeTime;
  for (lVar5 = 0x10; lVar5 != 0; lVar5 = lVar5 + -1) {
    pcVar8[0] = '\0';
    pcVar8[1] = '\0';
    pcVar8[2] = '\0';
    pcVar8[3] = '\0';
    pcVar8[4] = '\0';
    pcVar8[5] = '\0';
    pcVar8[6] = '\0';
    pcVar8[7] = '\0';
    pcVar8 = pcVar8 + (ulong)bVar10 * -0x10 + 8;
  }
  pcVar8 = vFetchKey;
  for (lVar5 = 7; lVar5 != 0; lVar5 = lVar5 + -1) {
    pcVar8[0] = '\0';
    pcVar8[1] = '\0';
    pcVar8[2] = '\0';
    pcVar8[3] = '\0';
    pcVar8[4] = '\0';
    pcVar8[5] = '\0';
    pcVar8[6] = '\0';
    pcVar8[7] = '\0';
    pcVar8 = pcVar8 + (ulong)bVar10 * -0x10 + 8;
  }
  pcVar8 = tmpField;
  for (lVar5 = 0x20; lVar5 != 0; lVar5 = lVar5 + -1) {
    pcVar8[0] = '\0';
    pcVar8[1] = '\0';
    pcVar8[2] = '\0';
    pcVar8[3] = '\0';
    pcVar8[4] = '\0';
    pcVar8[5] = '\0';
    pcVar8[6] = '\0';
    pcVar8[7] = '\0';
    pcVar8 = pcVar8 + (ulong)bVar10 * -0x10 + 8;
  }
  pcVar8 = sBuffer;
  for (lVar5 = 0x80; lVar5 != 0; lVar5 = lVar5 + -1) {
    pcVar8[0] = '\0';
    pcVar8[1] = '\0';
    pcVar8[2] = '\0';
    pcVar8[3] = '\0';
    pcVar8[4] = '\0';
    pcVar8[5] = '\0';
    pcVar8[6] = '\0';
    pcVar8[7] = '\0';
    pcVar8 = pcVar8 + (ulong)bVar10 * -0x10 + 8;
  }
  InitNodeData(&Node);
  GetAcquirerPurgeTime(&nPurgeTime);
  Node.tPurgeTime = nPurgeTime;
  GetNpsField(10,SNpsInfo,tmpField,&tmpFieldLen);
  sprintf(Node.szFstKey,"%04d",(ulong)(uint)SNpsInfo->nMsgType);
  Node.szFstKey[4] = tmpField[0];
  Node.szFstKey[5] = tmpField[1];
  Node.szFstKey[6] = tmpField[2];
  Node.szFstKey[7] = tmpField[3];
  Node.szFstKey[8] = tmpField[4];
  Node.szFstKey[9] = tmpField[5];
  GetNpsField(6,SNpsInfo,tmpField,&tmpFieldLen);
  Node.szFstKey[0x12] = tmpField[8];
  Node.szFstKey[0x13] = tmpField[9];
  GetNpsField(1,SNpsInfo,tmpField,&tmpFieldLen);
  iVar1 = NpsBuildMsg(sBuffer,SNpsInfo,IsoInfo_00);
  memcpy(Node.sFstBuf,sBuffer,(long)iVar1);
  Node.nFstBufLen = iVar1;
  __n = strlen(sTlvBuffer);
  memcpy(Node.sSndBuf,sTlvBuffer,__n);
  Node.nSndBufLen = (int)__n;
  iVar1 = InsertRequest('L',&Node);
  if (iVar1 == 0) {
    GetIssuerPurgeTime(&nPurgeTime);
    sprintf(sPurgeTime,"%09d",nPurgeTime);
    GetIsoField(0x34,IsoInfo,sSecurityData,&nLength);
    sSecurityData[0x31] = sPurgeTime[0];
    sSecurityData[0x32] = sPurgeTime[1];
    sSecurityData[0x33] = sPurgeTime[2];
    sSecurityData[0x34] = sPurgeTime[3];
    sSecurityData[0x35] = sPurgeTime[4];
    sSecurityData[0x36] = sPurgeTime[5];
    sSecurityData[0x37] = sPurgeTime[6];
    sSecurityData[0x38] = sPurgeTime[7];
    sSecurityData[0x39] = sPurgeTime[8];
    GetSecurityData(6,sSecurityData,sDestinationPid,&nLength);
    lVar5 = strtol(sDestinationPid,(char **)0x0,10);
    sSourcePid[0] = '\0';
    sSourcePid[1] = '\0';
    sSourcePid[2] = '\0';
    sSourcePid[3] = '\0';
    sSourcePid[4] = '\0';
    sSourcePid[5] = '\0';
    sSourcePid[6] = '\0';
    sSourcePid[7] = '\0';
    sSourcePid[8] = '\0';
    uVar2 = getpid();
    sprintf(sSourcePid,"%08d",(ulong)uVar2);
    PutSecurityData(4,sSecurityData,sSourcePid,8);
    pVar4 = pthread_self();
    sprintf(szUser,"NW   %05d",pVar4);
    PutSecurityData(8,sSecurityData,szUser,0xf);
    puVar7 = (uint *)sSecurityData;
    do {
      puVar6 = puVar7;
      uVar3 = *puVar6 + 0xfefefeff & ~*puVar6;
      uVar2 = uVar3 & 0x80808080;
      puVar7 = puVar6 + 1;
    } while (uVar2 == 0);
    bVar9 = (uVar3 & 0x8080) == 0;
    if (bVar9) {
      uVar2 = uVar2 >> 0x10;
    }
    if (bVar9) {
      puVar7 = (uint *)((long)puVar6 + 6);
    }
    PutIsoField(0x34,IsoInfo,sSecurityData,
                (((int)puVar7 + -3) - (uint)CARRY1((byte)uVar2,(byte)uVar2)) - (int)sSecurityData);
    sBalMessage.sHeader.nPartnerId = (pid_t)lVar5;
    sBalMessage.sHeader.nSourceId = getpid();
    sBalMessage.sHeader.nCommand = IsoInfo->nMsgType;
    nLength = IsoBuildMsg(sBalMessage.sBody,IsoInfo);
    sBalMessage.sHeader.nLen = nLength;
    iVar1 = WriteBalMsg(nBalMsg,&sBalMessage);
    if (iVar1 == 0) {
      trace_event(" END   ForwardAdvRequest( OK )",5);
      iVar1 = 0;
    }
    else {
      iVar1 = -1;
      trace_event("Can Not Write Message To Queue",5);
    }
  }
  else {
    iVar1 = -1;
    trace_event("ForwardAdvRequest(): InsertRequest() failed",5);
  }
  return iVar1;
}



// WARNING: Unknown calling convention

int AdvReplyToNps(int nIndexCtx,TSIsoInfo *IsoInfo,TSNpsInfo *OrigNpsInfo)

{
  int iVar1;
  long lVar2;
  char *pcVar3;
  byte bVar4;
  int FieldLen;
  char FieldData [256];
  char tmpField [256];
  char sLine [512];
  char sBuffer [1024];
  TSNpsInfo NewNpsInfo;
  char sPufData [4096];
  
  bVar4 = 0;
  trace_event("Start  AdvReplyToNw()",5);
  pcVar3 = sBuffer;
  for (lVar2 = 0x80; lVar2 != 0; lVar2 = lVar2 + -1) {
    pcVar3[0] = '\0';
    pcVar3[1] = '\0';
    pcVar3[2] = '\0';
    pcVar3[3] = '\0';
    pcVar3[4] = '\0';
    pcVar3[5] = '\0';
    pcVar3[6] = '\0';
    pcVar3[7] = '\0';
    pcVar3 = pcVar3 + (ulong)bVar4 * -0x10 + 8;
  }
  pcVar3 = FieldData;
  for (lVar2 = 0x20; lVar2 != 0; lVar2 = lVar2 + -1) {
    pcVar3[0] = '\0';
    pcVar3[1] = '\0';
    pcVar3[2] = '\0';
    pcVar3[3] = '\0';
    pcVar3[4] = '\0';
    pcVar3[5] = '\0';
    pcVar3[6] = '\0';
    pcVar3[7] = '\0';
    pcVar3 = pcVar3 + (ulong)bVar4 * -0x10 + 8;
  }
  pcVar3 = sPufData;
  for (lVar2 = 0x200; lVar2 != 0; lVar2 = lVar2 + -1) {
    pcVar3[0] = '\0';
    pcVar3[1] = '\0';
    pcVar3[2] = '\0';
    pcVar3[3] = '\0';
    pcVar3[4] = '\0';
    pcVar3[5] = '\0';
    pcVar3[6] = '\0';
    pcVar3[7] = '\0';
    pcVar3 = pcVar3 + (ulong)bVar4 * -0x10 + 8;
  }
  pcVar3 = tmpField;
  for (lVar2 = 0x20; lVar2 != 0; lVar2 = lVar2 + -1) {
    pcVar3[0] = '\0';
    pcVar3[1] = '\0';
    pcVar3[2] = '\0';
    pcVar3[3] = '\0';
    pcVar3[4] = '\0';
    pcVar3[5] = '\0';
    pcVar3[6] = '\0';
    pcVar3[7] = '\0';
    pcVar3 = pcVar3 + (ulong)bVar4 * -0x10 + 8;
  }
  pcVar3 = sLine;
  for (lVar2 = 0x40; lVar2 != 0; lVar2 = lVar2 + -1) {
    pcVar3[0] = '\0';
    pcVar3[1] = '\0';
    pcVar3[2] = '\0';
    pcVar3[3] = '\0';
    pcVar3[4] = '\0';
    pcVar3[5] = '\0';
    pcVar3[6] = '\0';
    pcVar3[7] = '\0';
    pcVar3 = pcVar3 + (ulong)bVar4 * -0x10 + 8;
  }
  InitNpsInfo(&NewNpsInfo);
  iVar1 = OrigNpsInfo->nMsgType;
  if (iVar1 < 0x78) {
LAB_00416720:
    iVar1 = -1;
    sprintf(sLine,"==> NO PROCESSING FOR MESSAGE [%.4d] ");
    trace_event("End  AdvReplyToNw(Message Handling Failed)",5);
  }
  else {
    if (iVar1 < 0x7a) {
      NewNpsInfo.nMsgType = 0x82;
    }
    else {
      if (1 < iVar1 - 0xdcU) goto LAB_00416720;
      NewNpsInfo.nMsgType = 0xe6;
    }
    iVar1 = GetNpsField(2,OrigNpsInfo,FieldData,&FieldLen);
    if (iVar1 == 0) {
      AddNpsField(2,&NewNpsInfo,FieldData,FieldLen);
    }
    iVar1 = GetNpsField(3,OrigNpsInfo,FieldData,&FieldLen);
    if (iVar1 == 0) {
      AddNpsField(3,&NewNpsInfo,FieldData,FieldLen);
    }
    iVar1 = GetNpsField(4,OrigNpsInfo,FieldData,&FieldLen);
    if (iVar1 == 0) {
      AddNpsField(4,&NewNpsInfo,FieldData,FieldLen);
    }
    iVar1 = GetNpsField(8,OrigNpsInfo,FieldData,&FieldLen);
    if (iVar1 == 0) {
      AddNpsField(8,&NewNpsInfo,FieldData,FieldLen);
    }
    iVar1 = GetNpsField(0xf,OrigNpsInfo,FieldData,&FieldLen);
    if (iVar1 == 0) {
      AddNpsField(0xf,&NewNpsInfo,FieldData,FieldLen);
    }
    iVar1 = GetNpsField(0x1b,OrigNpsInfo,FieldData,&FieldLen);
    if (iVar1 == 0) {
      AddNpsField(0x1b,&NewNpsInfo,FieldData,FieldLen);
    }
    iVar1 = GetNpsField(0x1c,OrigNpsInfo,FieldData,&FieldLen);
    if (iVar1 == 0) {
      AddNpsField(0x1c,&NewNpsInfo,FieldData,FieldLen);
    }
    iVar1 = GetNpsField(0x1d,OrigNpsInfo,FieldData,&FieldLen);
    if (iVar1 == 0) {
      AddNpsField(0x1d,&NewNpsInfo,FieldData,FieldLen);
    }
    iVar1 = GetNpsField(0x1e,OrigNpsInfo,FieldData,&FieldLen);
    if (iVar1 == 0) {
      AddNpsField(0x1e,&NewNpsInfo,FieldData,FieldLen);
    }
    iVar1 = GetIsoField(0x25,IsoInfo,FieldData,&FieldLen);
    if (iVar1 == 0) {
      AddNpsField(0x25,&NewNpsInfo,FieldData,FieldLen);
    }
    iVar1 = GetIsoField(0x26,IsoInfo,FieldData,&FieldLen);
    if (iVar1 == 0) {
      AddNpsField(0x26,&NewNpsInfo,FieldData,3);
    }
    iVar1 = GetNpsField(0x2b,OrigNpsInfo,FieldData,&FieldLen);
    if (iVar1 == 0) {
      AddNpsField(0x2b,&NewNpsInfo,FieldData,FieldLen);
    }
    iVar1 = GetNpsField(0x35,OrigNpsInfo,FieldData,&FieldLen);
    if (iVar1 == 0) {
      AddNpsField(0x35,&NewNpsInfo,FieldData,FieldLen);
    }
    IsoToNps55Icc(&NewNpsInfo,IsoInfo);
    iVar1 = GetNpsField(0x39,OrigNpsInfo,FieldData,&FieldLen);
    if (iVar1 == 0) {
      AddNpsField(0x39,&NewNpsInfo,FieldData,FieldLen);
    }
    iVar1 = GetNpsField(0x3a,OrigNpsInfo,FieldData,&FieldLen);
    if (iVar1 == 0) {
      AddNpsField(0x3a,&NewNpsInfo,FieldData,FieldLen);
    }
    iVar1 = GetNpsField(0x65,OrigNpsInfo,FieldData,&FieldLen);
    if (iVar1 == 0) {
      AddNpsField(0x65,&NewNpsInfo,FieldData,FieldLen);
    }
    iVar1 = GetNpsField(0x66,OrigNpsInfo,FieldData,&FieldLen);
    if (iVar1 == 0) {
      AddNpsField(0x66,&NewNpsInfo,FieldData,FieldLen);
    }
    iVar1 = GetNpsField(0x79,OrigNpsInfo,FieldData,&FieldLen);
    if (iVar1 == 0) {
      AddNpsField(0x79,&NewNpsInfo,FieldData,FieldLen);
    }
    iVar1 = GetNpsField(0x7e,OrigNpsInfo,FieldData,&FieldLen);
    if (iVar1 == 0) {
      AddNpsField(0x7e,&NewNpsInfo,FieldData,FieldLen);
    }
    iVar1 = Buffer_To_Nps(nIndexCtx,&NewNpsInfo);
    if (iVar1 == 0) {
      trace_event("End  AdvReplyToNw(OK)",5);
      iVar1 = 0;
    }
    else {
      iVar1 = -1;
      trace_event("End  AdvReplyToNw(Buffer_To_Nps Failed)",5);
    }
  }
  return iVar1;
}



// WARNING: Unknown calling convention

int AdvReqReplyToNps(int nIndexCtx,TSIsoInfo *IsoInfo,TSNpsInfo *OrigNpsInfo,char *sTlvBuffer,
                    int nFlag)

{
  int iVar1;
  long lVar2;
  char *pcVar3;
  byte bVar4;
  char vNpsRspCodeTmp [3];
  int FieldLen;
  char sAutTabInd [4];
  int nLength;
  char sDestResource [7];
  char FieldData [256];
  char sLine [512];
  char sBuffer [1024];
  TSNpsInfo NewNpsInfo;
  char sSecurityData [4096];
  
  bVar4 = 0;
  trace_event("Start  AdvReqReplyToNps()",5);
  sAutTabInd[0] = '\0';
  sAutTabInd[1] = '\0';
  sAutTabInd[2] = '\0';
  sAutTabInd[3] = '\0';
  pcVar3 = sBuffer;
  for (lVar2 = 0x80; lVar2 != 0; lVar2 = lVar2 + -1) {
    pcVar3[0] = '\0';
    pcVar3[1] = '\0';
    pcVar3[2] = '\0';
    pcVar3[3] = '\0';
    pcVar3[4] = '\0';
    pcVar3[5] = '\0';
    pcVar3[6] = '\0';
    pcVar3[7] = '\0';
    pcVar3 = pcVar3 + (ulong)bVar4 * -0x10 + 8;
  }
  GetIsoField(0x34,IsoInfo,sSecurityData,&nLength);
  GetSecurityData(7,sSecurityData,sDestResource,&nLength);
  if (nFlag != 1) {
    trace_event("-> != PROCESSED ",0);
    InsertIsoField(0x26,IsoInfo,"909",3);
    InsertIsoField(0x2b,IsoInfo,"000",3);
    trace_event("NOT PROCESSED ",5);
    GetTableInd(IsoInfo,sAutTabInd);
    AuthorLog(nIndexCtx,IsoInfo,G_sNps.F_szRsrcId,sDestResource,sAutTabInd);
  }
  InitNpsInfo(&NewNpsInfo);
  iVar1 = OrigNpsInfo->nMsgType;
  if (iVar1 < 0x78) {
LAB_00416ce8:
    iVar1 = -1;
    sprintf(sLine,"==> NO PROCESSING FOR MESSAGE [%.4d] ");
    trace_event("End  AdvReplyToNw(Message Handling Failed)",5);
  }
  else {
    if (iVar1 < 0x7a) {
      NewNpsInfo.nMsgType = 0x82;
    }
    else {
      if (1 < iVar1 - 0xdcU) goto LAB_00416ce8;
      NewNpsInfo.nMsgType = 0xe6;
    }
    iVar1 = GetNpsField(2,OrigNpsInfo,FieldData,&FieldLen);
    if (iVar1 == 0) {
      AddNpsField(2,&NewNpsInfo,FieldData,FieldLen);
    }
    iVar1 = GetNpsField(3,OrigNpsInfo,FieldData,&FieldLen);
    if (iVar1 == 0) {
      AddNpsField(3,&NewNpsInfo,FieldData,FieldLen);
    }
    iVar1 = GetNpsField(6,OrigNpsInfo,FieldData,&FieldLen);
    if (iVar1 == 0) {
      AddNpsField(6,&NewNpsInfo,FieldData,FieldLen);
    }
    iVar1 = GetNpsField(10,OrigNpsInfo,FieldData,&FieldLen);
    if (iVar1 == 0) {
      AddNpsField(10,&NewNpsInfo,FieldData,FieldLen);
    }
    iVar1 = GetNpsField(0x15,OrigNpsInfo,FieldData,&FieldLen);
    if (iVar1 == 0) {
      AddNpsField(0x15,&NewNpsInfo,FieldData,FieldLen);
    }
    iVar1 = GetNpsField(0x1f,OrigNpsInfo,FieldData,&FieldLen);
    if (iVar1 == 0) {
      AddNpsField(0x1f,&NewNpsInfo,FieldData,FieldLen);
    }
    iVar1 = GetNpsField(0x22,OrigNpsInfo,FieldData,&FieldLen);
    if (iVar1 == 0) {
      AddNpsField(0x22,&NewNpsInfo,FieldData,FieldLen);
    }
    iVar1 = GetNpsField(0x24,OrigNpsInfo,FieldData,&FieldLen);
    if (iVar1 == 0) {
      AddNpsField(0x24,&NewNpsInfo,FieldData,FieldLen);
    }
    iVar1 = GetIsoField(0x26,IsoInfo,FieldData,&FieldLen);
    if (iVar1 == 0) {
      sprintf(sLine,"ISO_RESPONSE_CODE: [%s]",FieldData);
      trace_event(sLine,5);
      vNpsRspCodeTmp[0] = '\0';
      vNpsRspCodeTmp[1] = '\0';
      vNpsRspCodeTmp[2] = '\0';
      TranslateRespCode(nIndexCtx,G_sNps.F_szRsrcId,FieldData,"PR",vNpsRspCodeTmp);
      AddNpsField(0x26,&NewNpsInfo,vNpsRspCodeTmp,2);
    }
    iVar1 = GetNpsField(0x28,OrigNpsInfo,FieldData,&FieldLen);
    if (iVar1 == 0) {
      AddNpsField(0x28,&NewNpsInfo,FieldData,FieldLen);
    }
    iVar1 = GetNpsField(0x30,OrigNpsInfo,FieldData,&FieldLen);
    if (iVar1 == 0) {
      AddNpsField(0x30,&NewNpsInfo,FieldData,FieldLen);
    }
    IsoToNps55Icc(&NewNpsInfo,IsoInfo);
    iVar1 = GetNpsField(0x3c,OrigNpsInfo,FieldData,&FieldLen);
    if (iVar1 == 0) {
      AddNpsField(0x3c,&NewNpsInfo,FieldData,FieldLen);
    }
    iVar1 = Buffer_To_Nps(nIndexCtx,&NewNpsInfo);
    if (iVar1 == 0) {
      trace_event("End  AdvReplyToNw(OK)",5);
      iVar1 = 0;
    }
    else {
      iVar1 = -1;
      trace_event("End  AdvReplyToNw(Buffer_To_Nps Failed)",5);
    }
  }
  return iVar1;
}



// WARNING: Unknown calling convention

int FCT_ADV_REQ_FROM_NW(int nIndexCtx,TSNpsInfo *NpsInfo)

{
  int iVar1;
  long lVar2;
  char *pcVar3;
  byte bVar4;
  char sAutTabInd [4];
  char sMerchActvsMerchActv [5];
  char slProcCode [7];
  char sAcquirerBank [12];
  char tmpField [256];
  char sLine [512];
  TSIsoInfo IsoInfo;
  char sTlvBuffer [4096];
  
  bVar4 = 0;
  trace_event("START    FCT_ADV_REQ_FROM_NW()",5);
  pcVar3 = sTlvBuffer;
  for (lVar2 = 0x200; lVar2 != 0; lVar2 = lVar2 + -1) {
    pcVar3[0] = '\0';
    pcVar3[1] = '\0';
    pcVar3[2] = '\0';
    pcVar3[3] = '\0';
    pcVar3[4] = '\0';
    pcVar3[5] = '\0';
    pcVar3[6] = '\0';
    pcVar3[7] = '\0';
    pcVar3 = pcVar3 + (ulong)bVar4 * -0x10 + 8;
  }
  sAcquirerBank[0] = '\0';
  sAcquirerBank[1] = '\0';
  sAcquirerBank[2] = '\0';
  sAcquirerBank[3] = '\0';
  sAcquirerBank[4] = '\0';
  sAcquirerBank[5] = '\0';
  sAcquirerBank[6] = '\0';
  sAcquirerBank[7] = '\0';
  sAcquirerBank[8] = '\0';
  sAcquirerBank[9] = '\0';
  sAcquirerBank[10] = '\0';
  sAcquirerBank[0xb] = '\0';
  sAutTabInd[0] = '\0';
  sAutTabInd[1] = '\0';
  sAutTabInd[2] = '\0';
  sAutTabInd[3] = '\0';
  pcVar3 = sLine;
  for (lVar2 = 0x40; lVar2 != 0; lVar2 = lVar2 + -1) {
    pcVar3[0] = '\0';
    pcVar3[1] = '\0';
    pcVar3[2] = '\0';
    pcVar3[3] = '\0';
    pcVar3[4] = '\0';
    pcVar3[5] = '\0';
    pcVar3[6] = '\0';
    pcVar3[7] = '\0';
    pcVar3 = pcVar3 + (ulong)bVar4 * -0x10 + 8;
  }
  pcVar3 = tmpField;
  for (lVar2 = 0x20; lVar2 != 0; lVar2 = lVar2 + -1) {
    pcVar3[0] = '\0';
    pcVar3[1] = '\0';
    pcVar3[2] = '\0';
    pcVar3[3] = '\0';
    pcVar3[4] = '\0';
    pcVar3[5] = '\0';
    pcVar3[6] = '\0';
    pcVar3[7] = '\0';
    pcVar3 = pcVar3 + (ulong)bVar4 * -0x10 + 8;
  }
  iVar1 = ConvNpsToISO(nIndexCtx,NpsInfo,&IsoInfo);
  if (iVar1 != 0) {
    trace_event("ConvNpsToISO Error ...",1);
    InsertIsoField(0x26,&IsoInfo,"909",3);
    InsertIsoField(0x2b,&IsoInfo,"000",3);
    iVar1 = AdvReplyToNps(nIndexCtx,&IsoInfo,NpsInfo);
    if (iVar1 == 0) {
      trace_event("End FCT_ADV_REQ_FROM_NW( NOK --> Error ConvNpsToISO )",5);
      return -1;
    }
    trace_event("FCT_ADV_REQ_FROM_NW(): AdvReplyToNps() failed",5);
    return -1;
  }
  dump_p7_struct(&IsoInfo);
  sAutTabInd[0] = '\0';
  sAutTabInd[1] = '\0';
  sAutTabInd[2] = '\0';
  sAutTabInd[3] = '\0';
  sAcquirerBank[4] = AcquirerBank[4];
  sAcquirerBank[5] = AcquirerBank[5];
  sAcquirerBank[0] = AcquirerBank[0];
  sAcquirerBank[1] = AcquirerBank[1];
  sAcquirerBank[2] = AcquirerBank[2];
  sAcquirerBank[3] = AcquirerBank[3];
  GetTableInd(&IsoInfo,sAutTabInd);
  iVar1 = AuthorAdviceProcessing
                    (nIndexCtx,G_sNps.F_szRsrcId,sAutTabInd,sAcquirerBank,"G","N",sTlvBuffer,
                     &IsoInfo);
  if (iVar1 < 2) {
    if (-2 < iVar1) {
      trace_event("OK Returned",5);
      InsertIsoField(0x26,&IsoInfo,"000",3);
      InsertIsoField(0x2b,&IsoInfo,"000",3);
      iVar1 = AdvReqReplyToNps(nIndexCtx,&IsoInfo,NpsInfo,sTlvBuffer,1);
      if (iVar1 == 0) {
        trace_event("End  FCT_ADV_REQ_FROM_NW(OK)",5);
        return 0;
      }
      trace_event("End  FCT_ADV_REQ_FROM_NW(NOK)",5);
      return -1;
    }
    if (iVar1 == -9) {
      trace_event("SEVERE_ERROR Returned",5);
      return -1;
    }
  }
  else if (iVar1 == 5) {
    trace_event("ROUTAGE Returned",5);
    iVar1 = ForwardAdvRequest(nIndexCtx,&IsoInfo,NpsInfo,sTlvBuffer);
    if (iVar1 != 0) {
      PutIsoField(0x26,&IsoInfo,"912",3);
      iVar1 = AdvReqReplyToNps(nIndexCtx,&IsoInfo,NpsInfo,sTlvBuffer,3);
      if (iVar1 != -1) {
        trace_event("--> ForwardAdvRequest(NOK)",5);
        trace_event("END      FCT_ADV_REQ_FROM_NW(NOK)",5);
        return -1;
      }
      trace_event("--> AdvReqReplyToNps( NOK )",5);
      trace_event("END      FCT_ADV_REQ_FROM_NW(NOK)",5);
      return -1;
    }
  }
  trace_event("END      FCT_ADV_REQ_FROM_NW()",5);
  return 0;
}



// WARNING: Unknown calling convention

int FCT_ADV_REP_TO_NW(int nIndexCtx,TSIsoInfo *IsoInfo)

{
  int iVar1;
  long lVar2;
  char *pcVar3;
  byte bVar4;
  int tmpFieldLen;
  char slProcCode [7];
  char tmpField [256];
  char sLine [512];
  TSNpsInfo OrigNpsInfo;
  char sTlvBuffer [4096];
  TSNodeData Node;
  
  bVar4 = 0;
  trace_event("START    FCT_ADV_REP_TO_NW()",5);
  slProcCode[4] = '\0';
  slProcCode[5] = '\0';
  pcVar3 = sTlvBuffer;
  for (lVar2 = 0x200; lVar2 != 0; lVar2 = lVar2 + -1) {
    pcVar3[0] = '\0';
    pcVar3[1] = '\0';
    pcVar3[2] = '\0';
    pcVar3[3] = '\0';
    pcVar3[4] = '\0';
    pcVar3[5] = '\0';
    pcVar3[6] = '\0';
    pcVar3[7] = '\0';
    pcVar3 = pcVar3 + (ulong)bVar4 * -0x10 + 8;
  }
  slProcCode[0] = '\0';
  slProcCode[1] = '\0';
  slProcCode[2] = '\0';
  slProcCode[3] = '\0';
  slProcCode[6] = '\0';
  pcVar3 = sLine;
  for (lVar2 = 0x40; lVar2 != 0; lVar2 = lVar2 + -1) {
    pcVar3[0] = '\0';
    pcVar3[1] = '\0';
    pcVar3[2] = '\0';
    pcVar3[3] = '\0';
    pcVar3[4] = '\0';
    pcVar3[5] = '\0';
    pcVar3[6] = '\0';
    pcVar3[7] = '\0';
    pcVar3 = pcVar3 + (ulong)bVar4 * -0x10 + 8;
  }
  pcVar3 = tmpField;
  for (lVar2 = 0x20; lVar2 != 0; lVar2 = lVar2 + -1) {
    pcVar3[0] = '\0';
    pcVar3[1] = '\0';
    pcVar3[2] = '\0';
    pcVar3[3] = '\0';
    pcVar3[4] = '\0';
    pcVar3[5] = '\0';
    pcVar3[6] = '\0';
    pcVar3[7] = '\0';
    pcVar3 = pcVar3 + (ulong)bVar4 * -0x10 + 8;
  }
  dump_p7_struct(IsoInfo);
  InitNodeData(&Node);
  sprintf(Node.szFstKey,"%04d",(ulong)(IsoInfo->nMsgType - 0x3f2));
  GetIsoField(10,IsoInfo,tmpField,&tmpFieldLen);
  Node.szFstKey[4] = tmpField[0];
  Node.szFstKey[5] = tmpField[1];
  Node.szFstKey[6] = tmpField[2];
  Node.szFstKey[7] = tmpField[3];
  Node.szFstKey[8] = tmpField[4];
  Node.szFstKey[9] = tmpField[5];
  GetIsoField(6,IsoInfo,tmpField,&tmpFieldLen);
  Node.szFstKey[0x12] = tmpField[8];
  Node.szFstKey[0x13] = tmpField[9];
  GetIsoField(1,IsoInfo,tmpField,&tmpFieldLen);
  iVar1 = FetchRequest('B',&Node);
  if (iVar1 == -0xb) {
    iVar1 = -1;
    trace_event("FetchRequest failed (ENOEXIST)",1);
    trace_event("End FCT_AUT_REP_TO_NW (NOK)",1);
  }
  else {
    trace_event("FetchRequest SUCCESS",5);
    InitNpsInfo(&OrigNpsInfo);
    AnalyseNps(Node.sFstBuf,&OrigNpsInfo);
    pcVar3 = sTlvBuffer;
    for (lVar2 = 0x200; lVar2 != 0; lVar2 = lVar2 + -1) {
      pcVar3[0] = '\0';
      pcVar3[1] = '\0';
      pcVar3[2] = '\0';
      pcVar3[3] = '\0';
      pcVar3[4] = '\0';
      pcVar3[5] = '\0';
      pcVar3[6] = '\0';
      pcVar3[7] = '\0';
      pcVar3 = pcVar3 + (ulong)bVar4 * -0x10 + 8;
    }
    memcpy(sTlvBuffer,Node.sSndBuf,(long)Node.nSndBufLen);
    iVar1 = AdvReqReplyToNps(nIndexCtx,IsoInfo,&OrigNpsInfo,sTlvBuffer,1);
    if (iVar1 == 0) {
      trace_event("END      FCT_ADV_REP_TO_NW()",5);
      iVar1 = 0;
    }
    else {
      iVar1 = -1;
      trace_event("End  FCT_ADV_REP_TO_NW(NOK)",5);
    }
  }
  return iVar1;
}



// WARNING: Unknown calling convention

int FCT_REV_REQ_TO_NW(int nIndexCtx,TSIsoInfo *IsoInfo,char *pTlvBuffer)

{
  char acVar1 [4];
  int iVar2;
  size_t sVar3;
  long lVar4;
  char *pcVar5;
  byte bVar6;
  char vNpsF22 [4];
  int vTempLen;
  int FieldLen;
  char vNpsF18 [5];
  char slProcCode [7];
  char szBin [7];
  char szAuditNbr [7];
  time_t nPurgeTime;
  char vCrncy [10];
  char vNpsF7 [11];
  char vNpsF32 [12];
  char vNpsF37 [12];
  char vNpsF33 [12];
  char szRespCode [12];
  char szStlmntDate [13];
  char vRefNumber [13];
  char vNpsF41 [17];
  char CardNumber [23];
  char szTermAddr [56];
  char sLine [512];
  TSTagNps NpsIccInfo;
  TSTagIso IsoIccInfo;
  TSNpsInfo vNpsInfo;
  char sTlvBuffer [4096];
  char vTempField [4096];
  char TempField [4096];
  char sBuffer [4096];
  char vIsoF56 [4096];
  char FieldData [4096];
  char sIccBuffer [4096];
  TSNodeData Node;
  
  bVar6 = 0;
  trace_event("START    FCT_REV_REQ_TO_NW..()",5);
  slProcCode[0] = '\0';
  slProcCode[1] = '\0';
  slProcCode[2] = '\0';
  slProcCode[3] = '\0';
  pcVar5 = sTlvBuffer;
  for (lVar4 = 0x200; lVar4 != 0; lVar4 = lVar4 + -1) {
    pcVar5[0] = '\0';
    pcVar5[1] = '\0';
    pcVar5[2] = '\0';
    pcVar5[3] = '\0';
    pcVar5[4] = '\0';
    pcVar5[5] = '\0';
    pcVar5[6] = '\0';
    pcVar5[7] = '\0';
    pcVar5 = pcVar5 + (ulong)bVar6 * -0x10 + 8;
  }
  slProcCode[4] = '\0';
  slProcCode[5] = '\0';
  vCrncy[8] = '\0';
  vCrncy[9] = '\0';
  slProcCode[6] = '\0';
  vNpsF18[0] = '\0';
  vNpsF18[1] = '\0';
  vNpsF18[2] = '\0';
  vNpsF18[3] = '\0';
  vNpsF18[4] = '\0';
  vNpsF22[0] = '\0';
  vNpsF22[1] = '\0';
  vNpsF22[2] = '\0';
  vNpsF22[3] = '\0';
  pcVar5 = sLine;
  for (lVar4 = 0x40; lVar4 != 0; lVar4 = lVar4 + -1) {
    pcVar5[0] = '\0';
    pcVar5[1] = '\0';
    pcVar5[2] = '\0';
    pcVar5[3] = '\0';
    pcVar5[4] = '\0';
    pcVar5[5] = '\0';
    pcVar5[6] = '\0';
    pcVar5[7] = '\0';
    pcVar5 = pcVar5 + (ulong)bVar6 * -0x10 + 8;
  }
  vNpsF41[0] = '\0';
  vNpsF41[1] = '\0';
  vNpsF41[2] = '\0';
  vNpsF41[3] = '\0';
  vNpsF41[4] = '\0';
  vNpsF41[5] = '\0';
  vNpsF41[6] = '\0';
  vNpsF41[7] = '\0';
  vNpsF41[8] = '\0';
  vNpsF41[9] = '\0';
  vNpsF41[10] = '\0';
  vNpsF41[0xb] = '\0';
  vNpsF41[0xc] = '\0';
  vNpsF41[0xd] = '\0';
  vNpsF41[0xe] = '\0';
  vNpsF41[0xf] = '\0';
  vNpsF41[0x10] = '\0';
  vCrncy[0] = '\0';
  vCrncy[1] = '\0';
  vCrncy[2] = '\0';
  vCrncy[3] = '\0';
  vCrncy[4] = '\0';
  vCrncy[5] = '\0';
  vCrncy[6] = '\0';
  vCrncy[7] = '\0';
  vRefNumber[0] = '\0';
  vRefNumber[1] = '\0';
  vRefNumber[2] = '\0';
  vRefNumber[3] = '\0';
  vRefNumber[4] = '\0';
  vRefNumber[5] = '\0';
  vRefNumber[6] = '\0';
  vRefNumber[7] = '\0';
  pcVar5 = vTempField;
  for (lVar4 = 0x200; lVar4 != 0; lVar4 = lVar4 + -1) {
    pcVar5[0] = '\0';
    pcVar5[1] = '\0';
    pcVar5[2] = '\0';
    pcVar5[3] = '\0';
    pcVar5[4] = '\0';
    pcVar5[5] = '\0';
    pcVar5[6] = '\0';
    pcVar5[7] = '\0';
    pcVar5 = pcVar5 + (ulong)bVar6 * -0x10 + 8;
  }
  vRefNumber[8] = '\0';
  vRefNumber[9] = '\0';
  vRefNumber[10] = '\0';
  vRefNumber[0xb] = '\0';
  pcVar5 = sBuffer;
  for (lVar4 = 0x200; lVar4 != 0; lVar4 = lVar4 + -1) {
    pcVar5[0] = '\0';
    pcVar5[1] = '\0';
    pcVar5[2] = '\0';
    pcVar5[3] = '\0';
    pcVar5[4] = '\0';
    pcVar5[5] = '\0';
    pcVar5[6] = '\0';
    pcVar5[7] = '\0';
    pcVar5 = pcVar5 + (ulong)bVar6 * -0x10 + 8;
  }
  pcVar5 = TempField;
  for (lVar4 = 0x200; lVar4 != 0; lVar4 = lVar4 + -1) {
    pcVar5[0] = '\0';
    pcVar5[1] = '\0';
    pcVar5[2] = '\0';
    pcVar5[3] = '\0';
    pcVar5[4] = '\0';
    pcVar5[5] = '\0';
    pcVar5[6] = '\0';
    pcVar5[7] = '\0';
    pcVar5 = pcVar5 + (ulong)bVar6 * -0x10 + 8;
  }
  vRefNumber[0xc] = '\0';
  szAuditNbr[4] = '\0';
  szAuditNbr[5] = '\0';
  vNpsF7[8] = '\0';
  vNpsF7[9] = '\0';
  szAuditNbr[0] = '\0';
  szAuditNbr[1] = '\0';
  szAuditNbr[2] = '\0';
  szAuditNbr[3] = '\0';
  szAuditNbr[6] = '\0';
  vNpsF7[0] = '\0';
  vNpsF7[1] = '\0';
  vNpsF7[2] = '\0';
  vNpsF7[3] = '\0';
  vNpsF7[4] = '\0';
  vNpsF7[5] = '\0';
  vNpsF7[6] = '\0';
  vNpsF7[7] = '\0';
  vNpsF7[10] = '\0';
  pcVar5 = szTermAddr;
  for (lVar4 = 7; lVar4 != 0; lVar4 = lVar4 + -1) {
    pcVar5[0] = '\0';
    pcVar5[1] = '\0';
    pcVar5[2] = '\0';
    pcVar5[3] = '\0';
    pcVar5[4] = '\0';
    pcVar5[5] = '\0';
    pcVar5[6] = '\0';
    pcVar5[7] = '\0';
    pcVar5 = pcVar5 + (ulong)bVar6 * -0x10 + 8;
  }
  pcVar5 = FieldData;
  for (lVar4 = 0x200; lVar4 != 0; lVar4 = lVar4 + -1) {
    pcVar5[0] = '\0';
    pcVar5[1] = '\0';
    pcVar5[2] = '\0';
    pcVar5[3] = '\0';
    pcVar5[4] = '\0';
    pcVar5[5] = '\0';
    pcVar5[6] = '\0';
    pcVar5[7] = '\0';
    pcVar5 = pcVar5 + (ulong)bVar6 * -0x10 + 8;
  }
  pcVar5 = sIccBuffer;
  for (lVar4 = 0x200; lVar4 != 0; lVar4 = lVar4 + -1) {
    pcVar5[0] = '\0';
    pcVar5[1] = '\0';
    pcVar5[2] = '\0';
    pcVar5[3] = '\0';
    pcVar5[4] = '\0';
    pcVar5[5] = '\0';
    pcVar5[6] = '\0';
    pcVar5[7] = '\0';
    pcVar5 = pcVar5 + (ulong)bVar6 * -0x10 + 8;
  }
  dump_p7_struct(IsoInfo);
  iVar2 = GetIsoField(0x11,IsoInfo,vTempField,&vTempLen);
  if (iVar2 == 0) {
    iVar2 = memcmp(vTempField,&DAT_004a4ee6,4);
    if (iVar2 != 0) goto LAB_00417779;
    trace_event("ISO_MERCHANT_TYPE = OK",5);
  }
  else {
LAB_00417779:
    trace_event("ISO_MERCHANT_TYPE = NOK",5);
  }
  InitNpsInfo(&vNpsInfo);
  vNpsInfo.nMsgType = 0x1a4;
  iVar2 = GetIsoField(1,IsoInfo,vTempField,&vTempLen);
  if (iVar2 == 0) {
    AddNpsField(1,&vNpsInfo,vTempField,vTempLen);
  }
  iVar2 = GetIsoField(2,IsoInfo,slProcCode,&vTempLen);
  if (iVar2 == 0) {
    AddNpsField(2,&vNpsInfo,slProcCode,vTempLen);
  }
  iVar2 = GetIsoField(0x30,IsoInfo,vCrncy,&vTempLen);
  if (iVar2 == 0) {
    iVar2 = GetIsoField(3,IsoInfo,vTempField,&vTempLen);
    if (iVar2 != 0) goto LAB_00417822;
  }
  else {
LAB_00417822:
    iVar2 = GetIsoField(0x32,IsoInfo,vCrncy,&vTempLen);
    if (iVar2 == 0) {
      iVar2 = GetIsoField(5,IsoInfo,vTempField,&vTempLen);
      if (iVar2 == 0) goto LAB_00417cdb;
    }
    iVar2 = GetIsoField(0x32,IsoInfo,vCrncy,&vTempLen);
    if (iVar2 != 0) goto LAB_0041785c;
  }
LAB_00417cdb:
  AddNpsField(3,&vNpsInfo,vTempField,vTempLen);
LAB_0041785c:
  iVar2 = GetIsoField(5,IsoInfo,vNpsF7,&vTempLen);
  if (iVar2 == 0) {
    AddNpsField(5,&vNpsInfo,vNpsF7,vTempLen);
  }
  iVar2 = GetIsoField(6,IsoInfo,vNpsF7,&vTempLen);
  if (iVar2 == 0) {
    AddNpsField(6,&vNpsInfo,vNpsF7,vTempLen);
  }
  iVar2 = GetIsoField(9,IsoInfo,vTempField,&vTempLen);
  if (iVar2 == 0) {
    AddNpsField(9,&vNpsInfo,vTempField,vTempLen);
  }
  GetInternalStan(nIndexCtx,szAuditNbr);
  AddNpsField(10,&vNpsInfo,szAuditNbr,6);
  GetIsoField(10,IsoInfo,szAuditNbr,&vTempLen);
  pcVar5 = vTempField;
  for (lVar4 = 0x200; lVar4 != 0; lVar4 = lVar4 + -1) {
    pcVar5[0] = '\0';
    pcVar5[1] = '\0';
    pcVar5[2] = '\0';
    pcVar5[3] = '\0';
    pcVar5[4] = '\0';
    pcVar5[5] = '\0';
    pcVar5[6] = '\0';
    pcVar5[7] = '\0';
    pcVar5 = pcVar5 + (ulong)bVar6 * -0x10 + 8;
  }
  current_date_yymmddhhmmss(vTempField);
  AddNpsField(0xb,&vNpsInfo,vTempField + 6,6);
  AddNpsField(0xc,&vNpsInfo,vTempField + 2,4);
  iVar2 = GetIsoField(0xd,IsoInfo,vTempField,&vTempLen);
  if (iVar2 == 0) {
    AddNpsField(0xd,&vNpsInfo,vTempField,vTempLen);
  }
  iVar2 = GetIsoField(0x11,IsoInfo,vTempField,&vTempLen);
  if (iVar2 == 0) {
    AddNpsField(0x11,&vNpsInfo,vTempField,vTempLen);
  }
  iVar2 = GetIsoField(0x15,IsoInfo,vTempField,&vTempLen);
  if (iVar2 == 0) {
    sprintf(sLine,"==> ISO F22=[%s]",vTempField);
    trace_event(sLine,5);
    vNpsF22[0] = '\0';
    vNpsF22[1] = '\0';
    vNpsF22[2] = '1';
    vNpsF22[0] = '0';
    vNpsF22[1] = '0';
    acVar1 = vNpsF22;
    if (vTempField[6] == '1') {
      vNpsF22[0] = '0';
      vNpsF22[1] = '1';
    }
    else if (vTempField[6] == '2') {
      vNpsF22[0] = '9';
      vNpsF22[1] = '0';
      vNpsF22 = acVar1;
                    // WARNING: Ignoring partial resolution of indirect
    }
    else if (vTempField[6] == '3') {
      vNpsF22[0] = '0';
      vNpsF22[1] = '3';
      vNpsF22 = acVar1;
                    // WARNING: Ignoring partial resolution of indirect
    }
    else if (vTempField[6] == '4') {
      vNpsF22[0] = '0';
      vNpsF22[1] = '4';
      vNpsF22 = acVar1;
                    // WARNING: Ignoring partial resolution of indirect
    }
    else if (vTempField[6] == '5') {
      vNpsF22[0] = '0';
      vNpsF22[1] = '5';
      vNpsF22 = acVar1;
                    // WARNING: Ignoring partial resolution of indirect
    }
    Node.tPurgeTime = (ulong)Node.tPurgeTime._4_4_ << 0x20;
    iVar2 = GetIsoField(0x27,IsoInfo,(char *)&Node,&vTempLen);
    if (iVar2 != 0) {
      Node.tPurgeTime = CONCAT53(Node.tPurgeTime._3_5_,0x580000);
      Node.tPurgeTime = CONCAT62(Node.tPurgeTime._2_6_,0x5858);
    }
    sprintf(sLine,"Postion 1 = [%c], Posistion 7 = [%c], Service Code(1) = [%c]",
            (ulong)(uint)(int)vTempField[0],(ulong)(uint)(int)vTempField[6],
            (ulong)(uint)(int)(char)(byte)Node.tPurgeTime);
    trace_event(sLine,4);
    if (((vTempField[0] == '5') && (vTempField[6] != '5')) &&
       (((byte)Node.tPurgeTime & 0xfb) == 0x32)) {
      vNpsF22[0] = '8';
      vNpsF22[1] = '0';
    }
    if (vTempField[0xb] == '0') {
      vNpsF22[2] = '0';
    }
    AddNpsField(0x15,&vNpsInfo,vNpsF22,3);
  }
  iVar2 = GetIsoField(0x16,IsoInfo,vTempField,&vTempLen);
  if (iVar2 == 0) {
    AddNpsField(0x16,&vNpsInfo,vTempField,vTempLen);
  }
  AddNpsField(0x1f,&vNpsInfo,"000095",6);
  iVar2 = GetIsoField(0x24,IsoInfo,vRefNumber,&vTempLen);
  if (iVar2 == 0) {
    AddNpsField(0x24,&vNpsInfo,vRefNumber,vTempLen);
  }
  iVar2 = GetIsoField(0x25,IsoInfo,vTempField,&vTempLen);
  if (iVar2 == 0) {
    AddNpsField(0x25,&vNpsInfo,vTempField,vTempLen);
  }
  else {
    AddNpsField(0x25,&vNpsInfo,"      ",6);
  }
  iVar2 = GetIsoField(0x28,IsoInfo,vTempField,&vTempLen);
  if (iVar2 == 0) {
    builtin_strncpy(vNpsF41 + 8,"        ",8);
    vNpsF41[4] = vTempField[4];
    vNpsF41[5] = vTempField[5];
    vNpsF41[0] = vTempField[0];
    vNpsF41[1] = vTempField[1];
    vNpsF41[2] = vTempField[2];
    vNpsF41[3] = vTempField[3];
    vNpsF41[6] = vTempField[6];
    vNpsF41[7] = vTempField[7];
    AddNpsField(0x28,&vNpsInfo,vNpsF41,8);
  }
  iVar2 = GetIsoField(0x29,IsoInfo,vTempField,&vTempLen);
  if (iVar2 == 0) {
    AddNpsField(0x29,&vNpsInfo,vTempField,vTempLen);
  }
  iVar2 = GetIsoField(0x2a,IsoInfo,vTempField,&vTempLen);
  if (iVar2 == 0) {
    vTempLen = sprintf(szTermAddr,"%22.22s%s%13.13s%2.2s",vTempField,"   ",vTempField + 0x17,
                       &DAT_004a4f41);
    AddNpsField(0x2a,&vNpsInfo,szTermAddr,vTempLen);
  }
  AddNpsField(0x30,&vNpsInfo,vCrncy,3);
  iVar2 = GetIsoField(0x32,IsoInfo,vTempField,&vTempLen);
  if (iVar2 == 0) {
    AddNpsField(0x32,&vNpsInfo,vTempField,vTempLen);
  }
  iVar2 = GetIsoField(0x36,IsoInfo,vTempField,&vTempLen);
  if (iVar2 == 0) {
    sprintf(sLine,"ISO_ICC_DATA   = %s||Lenght = %d ",vTempField,(ulong)(uint)vTempLen);
    trace_event(sLine,5);
    InitIsoIcTag(&IsoIccInfo);
    AnalyseIsoIc(vTempField,vTempLen,&IsoIccInfo);
    InitNpsIcTag(&NpsIccInfo);
    pcVar5 = FieldData;
    for (lVar4 = 0x200; lVar4 != 0; lVar4 = lVar4 + -1) {
      pcVar5[0] = '\0';
      pcVar5[1] = '\0';
      pcVar5[2] = '\0';
      pcVar5[3] = '\0';
      pcVar5[4] = '\0';
      pcVar5[5] = '\0';
      pcVar5[6] = '\0';
      pcVar5[7] = '\0';
      pcVar5 = pcVar5 + (ulong)bVar6 * -0x10 + 8;
    }
    iVar2 = GetIsoIcTag("9F26",&IsoIccInfo,FieldData,&FieldLen);
    if (iVar2 == 0) {
      AddNpsIcTag("9F26",&NpsIccInfo,FieldData,FieldLen);
    }
    sprintf(sLine,"===>NPS_TAG_APP_CRYPTOGRAM   = %s ",FieldData);
    trace_event(sLine,5);
    trace_event("==<9F27>== ommit sur la demande de visa mais a valider",5);
    pcVar5 = FieldData;
    for (lVar4 = 0x200; lVar4 != 0; lVar4 = lVar4 + -1) {
      pcVar5[0] = '\0';
      pcVar5[1] = '\0';
      pcVar5[2] = '\0';
      pcVar5[3] = '\0';
      pcVar5[4] = '\0';
      pcVar5[5] = '\0';
      pcVar5[6] = '\0';
      pcVar5[7] = '\0';
      pcVar5 = pcVar5 + (ulong)bVar6 * -0x10 + 8;
    }
    iVar2 = GetIsoIcTag("9F27",&IsoIccInfo,FieldData,&FieldLen);
    if (iVar2 == 0) {
      AddNpsIcTag("9F27",&NpsIccInfo,FieldData,FieldLen);
    }
    sprintf(sLine," ===>ISO_TAG_CRYPTO_INFO_DATA   = %s ",FieldData);
    trace_event(sLine,5);
    pcVar5 = FieldData;
    for (lVar4 = 0x200; lVar4 != 0; lVar4 = lVar4 + -1) {
      pcVar5[0] = '\0';
      pcVar5[1] = '\0';
      pcVar5[2] = '\0';
      pcVar5[3] = '\0';
      pcVar5[4] = '\0';
      pcVar5[5] = '\0';
      pcVar5[6] = '\0';
      pcVar5[7] = '\0';
      pcVar5 = pcVar5 + (ulong)bVar6 * -0x10 + 8;
    }
    iVar2 = GetIsoIcTag("9F10",&IsoIccInfo,FieldData,&FieldLen);
    if (iVar2 == 0) {
      AddNpsIcTag("9F10",&NpsIccInfo,FieldData,FieldLen);
    }
    sprintf(sLine,"===>ISO_TAG_ISS_APP_DATA   = %s ",FieldData);
    trace_event(sLine,5);
    pcVar5 = FieldData;
    for (lVar4 = 0x200; lVar4 != 0; lVar4 = lVar4 + -1) {
      pcVar5[0] = '\0';
      pcVar5[1] = '\0';
      pcVar5[2] = '\0';
      pcVar5[3] = '\0';
      pcVar5[4] = '\0';
      pcVar5[5] = '\0';
      pcVar5[6] = '\0';
      pcVar5[7] = '\0';
      pcVar5 = pcVar5 + (ulong)bVar6 * -0x10 + 8;
    }
    iVar2 = GetIsoIcTag("9F37",&IsoIccInfo,FieldData,&FieldLen);
    if (iVar2 == 0) {
      AddNpsIcTag("9F37",&NpsIccInfo,FieldData,FieldLen);
    }
    sprintf(sLine,"====>ISO_TAG_UNPRED_NUMBER   = %s ",FieldData);
    trace_event(sLine,5);
    pcVar5 = FieldData;
    for (lVar4 = 0x200; lVar4 != 0; lVar4 = lVar4 + -1) {
      pcVar5[0] = '\0';
      pcVar5[1] = '\0';
      pcVar5[2] = '\0';
      pcVar5[3] = '\0';
      pcVar5[4] = '\0';
      pcVar5[5] = '\0';
      pcVar5[6] = '\0';
      pcVar5[7] = '\0';
      pcVar5 = pcVar5 + (ulong)bVar6 * -0x10 + 8;
    }
    iVar2 = GetIsoIcTag("9F36",&IsoIccInfo,FieldData,&FieldLen);
    if (iVar2 == 0) {
      AddNpsIcTag("9F36",&NpsIccInfo,FieldData,FieldLen);
    }
    sprintf(sLine,"===> ISO_TAG_ATC   = %s ",FieldData);
    trace_event(sLine,5);
    pcVar5 = FieldData;
    for (lVar4 = 0x200; lVar4 != 0; lVar4 = lVar4 + -1) {
      pcVar5[0] = '\0';
      pcVar5[1] = '\0';
      pcVar5[2] = '\0';
      pcVar5[3] = '\0';
      pcVar5[4] = '\0';
      pcVar5[5] = '\0';
      pcVar5[6] = '\0';
      pcVar5[7] = '\0';
      pcVar5 = pcVar5 + (ulong)bVar6 * -0x10 + 8;
    }
    iVar2 = GetIsoIcTag("9500",&IsoIccInfo,FieldData,&FieldLen);
    if (iVar2 == 0) {
      AddNpsIcTag("9500",&NpsIccInfo,FieldData,FieldLen);
    }
    sprintf(sLine,"===> ISO_TAG_TVR   = %s ",FieldData);
    trace_event(sLine,5);
    pcVar5 = FieldData;
    for (lVar4 = 0x200; lVar4 != 0; lVar4 = lVar4 + -1) {
      pcVar5[0] = '\0';
      pcVar5[1] = '\0';
      pcVar5[2] = '\0';
      pcVar5[3] = '\0';
      pcVar5[4] = '\0';
      pcVar5[5] = '\0';
      pcVar5[6] = '\0';
      pcVar5[7] = '\0';
      pcVar5 = pcVar5 + (ulong)bVar6 * -0x10 + 8;
    }
    iVar2 = GetIsoIcTag("9A00",&IsoIccInfo,FieldData,&FieldLen);
    if (iVar2 == 0) {
      AddNpsIcTag("9A00",&NpsIccInfo,FieldData,FieldLen);
    }
    sprintf(sLine,"===>ISO_TAG_TRANS_DATE    = %s ",FieldData);
    trace_event(sLine,5);
    pcVar5 = FieldData;
    for (lVar4 = 0x200; lVar4 != 0; lVar4 = lVar4 + -1) {
      pcVar5[0] = '\0';
      pcVar5[1] = '\0';
      pcVar5[2] = '\0';
      pcVar5[3] = '\0';
      pcVar5[4] = '\0';
      pcVar5[5] = '\0';
      pcVar5[6] = '\0';
      pcVar5[7] = '\0';
      pcVar5 = pcVar5 + (ulong)bVar6 * -0x10 + 8;
    }
    iVar2 = GetIsoIcTag("9C00",&IsoIccInfo,FieldData,&FieldLen);
    if (iVar2 == 0) {
      AddNpsIcTag("9C00",&NpsIccInfo,FieldData,FieldLen);
    }
    sprintf(sLine,"===>ISO_TAG_TRANS_TYPE    = %s ",FieldData);
    trace_event(sLine,5);
    pcVar5 = FieldData;
    for (lVar4 = 0x200; lVar4 != 0; lVar4 = lVar4 + -1) {
      pcVar5[0] = '\0';
      pcVar5[1] = '\0';
      pcVar5[2] = '\0';
      pcVar5[3] = '\0';
      pcVar5[4] = '\0';
      pcVar5[5] = '\0';
      pcVar5[6] = '\0';
      pcVar5[7] = '\0';
      pcVar5 = pcVar5 + (ulong)bVar6 * -0x10 + 8;
    }
    iVar2 = GetIsoIcTag("9F02",&IsoIccInfo,FieldData,&FieldLen);
    if (iVar2 == 0) {
      AddNpsIcTag("9F02",&NpsIccInfo,FieldData,FieldLen);
    }
    sprintf(sLine,"===>NPS_TAG_TRANS_AMOUNT    = %s ",FieldData);
    trace_event(sLine,5);
    pcVar5 = FieldData;
    for (lVar4 = 0x200; lVar4 != 0; lVar4 = lVar4 + -1) {
      pcVar5[0] = '\0';
      pcVar5[1] = '\0';
      pcVar5[2] = '\0';
      pcVar5[3] = '\0';
      pcVar5[4] = '\0';
      pcVar5[5] = '\0';
      pcVar5[6] = '\0';
      pcVar5[7] = '\0';
      pcVar5 = pcVar5 + (ulong)bVar6 * -0x10 + 8;
    }
    iVar2 = GetIsoIcTag("5F2A",&IsoIccInfo,FieldData,&FieldLen);
    if (iVar2 == 0) {
      AddNpsIcTag("5F2A",&NpsIccInfo,FieldData,FieldLen);
    }
    sprintf(sLine,"===>ISO_TAG_TRANS_CUR_CODE    = %s ",FieldData);
    trace_event(sLine,5);
    pcVar5 = FieldData;
    for (lVar4 = 0x200; lVar4 != 0; lVar4 = lVar4 + -1) {
      pcVar5[0] = '\0';
      pcVar5[1] = '\0';
      pcVar5[2] = '\0';
      pcVar5[3] = '\0';
      pcVar5[4] = '\0';
      pcVar5[5] = '\0';
      pcVar5[6] = '\0';
      pcVar5[7] = '\0';
      pcVar5 = pcVar5 + (ulong)bVar6 * -0x10 + 8;
    }
    iVar2 = GetIsoIcTag("8200",&IsoIccInfo,FieldData,&FieldLen);
    if (iVar2 == 0) {
      AddNpsIcTag("8200",&NpsIccInfo,FieldData,FieldLen);
    }
    sprintf(sLine,"===>ISO_TAG_APP_INTER_PROFILE    = %s ",FieldData);
    trace_event(sLine,5);
    pcVar5 = FieldData;
    for (lVar4 = 0x200; lVar4 != 0; lVar4 = lVar4 + -1) {
      pcVar5[0] = '\0';
      pcVar5[1] = '\0';
      pcVar5[2] = '\0';
      pcVar5[3] = '\0';
      pcVar5[4] = '\0';
      pcVar5[5] = '\0';
      pcVar5[6] = '\0';
      pcVar5[7] = '\0';
      pcVar5 = pcVar5 + (ulong)bVar6 * -0x10 + 8;
    }
    iVar2 = GetIsoIcTag("9F1A",&IsoIccInfo,FieldData,&FieldLen);
    if (iVar2 == 0) {
      AddNpsIcTag("9F1A",&NpsIccInfo,FieldData,FieldLen);
    }
    sprintf(sLine,"===>ISO_TAG_COUNTRY_CODE= %s ||LenFD=%d",FieldData,(ulong)(uint)FieldLen);
    trace_event(sLine,5);
    pcVar5 = FieldData;
    for (lVar4 = 0x200; lVar4 != 0; lVar4 = lVar4 + -1) {
      pcVar5[0] = '\0';
      pcVar5[1] = '\0';
      pcVar5[2] = '\0';
      pcVar5[3] = '\0';
      pcVar5[4] = '\0';
      pcVar5[5] = '\0';
      pcVar5[6] = '\0';
      pcVar5[7] = '\0';
      pcVar5 = pcVar5 + (ulong)bVar6 * -0x10 + 8;
    }
    iVar2 = GetIsoIcTag("9F03",&IsoIccInfo,FieldData,&FieldLen);
    if (iVar2 == 0) {
      AddNpsIcTag("9F03",&NpsIccInfo,FieldData,FieldLen);
    }
    sprintf(sLine,"===> ISO_TAG_OTHER_AMOUNT   = %s ",FieldData);
    trace_event(sLine,5);
    pcVar5 = FieldData;
    for (lVar4 = 0x200; lVar4 != 0; lVar4 = lVar4 + -1) {
      pcVar5[0] = '\0';
      pcVar5[1] = '\0';
      pcVar5[2] = '\0';
      pcVar5[3] = '\0';
      pcVar5[4] = '\0';
      pcVar5[5] = '\0';
      pcVar5[6] = '\0';
      pcVar5[7] = '\0';
      pcVar5 = pcVar5 + (ulong)bVar6 * -0x10 + 8;
    }
    iVar2 = GetIsoIcTag("9F33",&IsoIccInfo,FieldData,&FieldLen);
    if (iVar2 == 0) {
      AddNpsIcTag("9F33",&NpsIccInfo,FieldData,FieldLen);
    }
    sprintf(sLine,"===> ISO_TAG_TERM_CAP   = %s ",FieldData);
    trace_event(sLine,5);
    pcVar5 = FieldData;
    for (lVar4 = 0x200; lVar4 != 0; lVar4 = lVar4 + -1) {
      pcVar5[0] = '\0';
      pcVar5[1] = '\0';
      pcVar5[2] = '\0';
      pcVar5[3] = '\0';
      pcVar5[4] = '\0';
      pcVar5[5] = '\0';
      pcVar5[6] = '\0';
      pcVar5[7] = '\0';
      pcVar5 = pcVar5 + (ulong)bVar6 * -0x10 + 8;
    }
    iVar2 = GetIsoIcTag("9F34",&IsoIccInfo,FieldData,&FieldLen);
    if (iVar2 == 0) {
      AddNpsIcTag("9F34",&NpsIccInfo,FieldData,FieldLen);
    }
    sprintf(sLine,"===>ISO_TAG_CVM    = %s ",FieldData);
    trace_event(sLine,5);
    pcVar5 = FieldData;
    for (lVar4 = 0x200; lVar4 != 0; lVar4 = lVar4 + -1) {
      pcVar5[0] = '\0';
      pcVar5[1] = '\0';
      pcVar5[2] = '\0';
      pcVar5[3] = '\0';
      pcVar5[4] = '\0';
      pcVar5[5] = '\0';
      pcVar5[6] = '\0';
      pcVar5[7] = '\0';
      pcVar5 = pcVar5 + (ulong)bVar6 * -0x10 + 8;
    }
    iVar2 = GetIsoIcTag("9F53",&IsoIccInfo,FieldData,&FieldLen);
    if (iVar2 == 0) {
      AddNpsIcTag("9F53",&NpsIccInfo,FieldData,FieldLen);
    }
    sprintf(sLine,"===>ISO_TAG_TRANS_CATEG_CODE    = %s ",FieldData);
    trace_event(sLine,5);
    FieldLen = NpsBuildIcFld(sIccBuffer,&NpsIccInfo);
    if (0 < FieldLen) {
      AddNpsField(0x36,&vNpsInfo,sIccBuffer,FieldLen);
    }
    sprintf(sLine,"NPS_ICC_DATA   = %20s||Lenght = %d ",sIccBuffer,(ulong)(uint)FieldLen);
    trace_event(sLine,5);
  }
  iVar2 = GetIsoField(0x37,IsoInfo,vIsoF56,&vTempLen);
  if (iVar2 == 0) {
    pcVar5 = vTempField;
    for (lVar4 = 0x200; lVar4 != 0; lVar4 = lVar4 + -1) {
      pcVar5[0] = '\0';
      pcVar5[1] = '\0';
      pcVar5[2] = '\0';
      pcVar5[3] = '\0';
      pcVar5[4] = '\0';
      pcVar5[5] = '\0';
      pcVar5[6] = '\0';
      pcVar5[7] = '\0';
      pcVar5 = pcVar5 + (ulong)bVar6 * -0x10 + 8;
    }
    builtin_strncpy(vTempField + 0x14,"0000000009500000000000",0x16);
    builtin_strncpy(vTempField,"0100",4);
    vTempField._4_2_ = (undefined2)vIsoF56._4_4_;
    vTempField[6] = SUB41(vIsoF56._4_4_,2);
    vTempField[7] = SUB41(vIsoF56._4_4_,3);
    vTempField[8] = vIsoF56[8];
    vTempField[9] = vIsoF56[9];
    vTempField[10] = (char)vIsoF56._12_8_;
    vTempField[0xb] = SUB81(vIsoF56._12_8_,1);
    vTempField._12_4_ = SUB84(vIsoF56._12_8_,2);
    vTempField._16_2_ = SUB82(vIsoF56._12_8_,6);
    vTempField[0x12] = vIsoF56[0x14];
    vTempField[0x13] = vIsoF56[0x15];
    AddNpsField(0x59,&vNpsInfo,vTempField,0x2a);
  }
  InitNodeData(&Node);
  GetAcquirerPurgeTime(&nPurgeTime);
  Node.tPurgeTime = nPurgeTime;
  GetNpsField(10,&vNpsInfo,vTempField,&vTempLen);
  sprintf(Node.szFstKey,"%04d",(ulong)(uint)vNpsInfo.nMsgType);
  Node.szFstKey[4] = vTempField[0];
  Node.szFstKey[5] = vTempField[1];
  Node.szFstKey[6] = vTempField[2];
  Node.szFstKey[7] = vTempField[3];
  Node.szFstKey[8] = vTempField[4];
  Node.szFstKey[9] = vTempField[5];
  GetNpsField(0x59,&vNpsInfo,vTempField,&vTempLen);
  Node.szFstKey[0xc] = vTempField[6];
  Node.szFstKey[10] = vTempField[4];
  Node.szFstKey[0xb] = vTempField[5];
  Node.szFstKey[0xd] = vTempField[7];
  Node.szFstKey[0xe] = vTempField[8];
  Node.szFstKey[0xf] = vTempField[9];
  Node.szFstKey[0x10] = vTempField[10];
  Node.szFstKey[0x11] = vTempField[0xb];
  Node.szFstKey[0x16] = vTempField[0x10];
  Node.szFstKey[0x17] = vTempField[0x11];
  Node.szFstKey[0x12] = vTempField[0xc];
  Node.szFstKey[0x13] = vTempField[0xd];
  Node.szFstKey[0x14] = vTempField[0xe];
  Node.szFstKey[0x15] = vTempField[0xf];
  Node.szFstKey[0x18] = vTempField[0x12];
  Node.szFstKey[0x19] = vTempField[0x13];
  GetNpsField(1,&vNpsInfo,vTempField,&vTempLen);
  Node.szFstKey[0x1e] = vTempField[4];
  Node.szFstKey[0x1f] = vTempField[5];
  Node.szFstKey[0x1a] = vTempField[0];
  Node.szFstKey[0x1b] = vTempField[1];
  Node.szFstKey[0x1c] = vTempField[2];
  Node.szFstKey[0x1d] = vTempField[3];
  Node.szFstKey[0x20] = vTempField[6];
  Node.szFstKey[0x21] = vTempField[7];
  Node.szFstKey[0x24] = vTempField[10];
  Node.szFstKey[0x22] = vTempField[8];
  Node.szFstKey[0x23] = vTempField[9];
  Node.szFstKey[0x25] = vTempField[0xb];
  Node.szFstKey[0x26] = vTempField[0xc];
  Node.szFstKey[0x27] = vTempField[0xd];
  Node.szFstKey[0x28] = vTempField[0xe];
  Node.szFstKey[0x29] = vTempField[0xf];
  if (debug_option == 1) {
    sprintf(sLine,"==> InsertKey=[%s] ",Node.szFstKey);
    trace_event(sLine,5);
  }
  pcVar5 = sBuffer;
  for (lVar4 = 0x200; lVar4 != 0; lVar4 = lVar4 + -1) {
    pcVar5[0] = '\0';
    pcVar5[1] = '\0';
    pcVar5[2] = '\0';
    pcVar5[3] = '\0';
    pcVar5[4] = '\0';
    pcVar5[5] = '\0';
    pcVar5[6] = '\0';
    pcVar5[7] = '\0';
    pcVar5 = pcVar5 + (ulong)bVar6 * -0x10 + 8;
  }
  iVar2 = IsoBuildMsg(sBuffer,IsoInfo);
  vTempLen = iVar2;
  memcpy(Node.sFstBuf,sBuffer,(long)iVar2);
  Node.nFstBufLen = iVar2;
  sVar3 = strlen(pTlvBuffer);
  Node.nSndBufLen = (int)sVar3;
  memcpy(Node.sSndBuf,pTlvBuffer,(long)Node.nSndBufLen);
  Node.sFstPrvtData[0] = 'S';
  Node.sFstPrvtData[1] = 'A';
  Node.sFstPrvtData[2] = 'F';
  Node.nFstPrvtDataLen = 3;
  iVar2 = InsertRequest('B',&Node);
  if (iVar2 != 0) {
    trace_event("FCT_REV_REQ_TO_NW(): InsertRequest() failed",5);
  }
  iVar2 = Buffer_To_Nps(nIndexCtx,&vNpsInfo);
  if (iVar2 == 0) {
    trace_event("END      FCT_REV_REQ_TO_NW()",5);
    iVar2 = 0;
  }
  else {
    iVar2 = -1;
    trace_event("End  FCT_REV_REQ_TO_NPS(Buffer_To_Nps Failed)",5);
  }
  return iVar2;
}



// WARNING: Unknown calling convention

int FCT_REV_REP_FROM_NW(int nIndexCtx,TSNpsInfo *NpsInfo)

{
  int iVar1;
  long lVar2;
  char *pcVar3;
  byte bVar4;
  char sNpsRespCode [3];
  char vNpsF22 [4];
  char sRespCode [4];
  int vTempLen;
  char vNpsF18 [5];
  char slProcCode [7];
  char SourceId [7];
  char vNpsF41 [17];
  char CardNumber [23];
  char vFetchKey [56];
  char vTempField [256];
  char sLine [512];
  TSIsoInfo IsoInfo;
  char sTlvBuffer [4096];
  char sSecurityData [4097];
  TSNodeData Node;
  
  bVar4 = 0;
  trace_event("START    FCT_REV_REP_FROM_NW()",5);
  pcVar3 = sLine;
  for (lVar2 = 0x40; lVar2 != 0; lVar2 = lVar2 + -1) {
    pcVar3[0] = '\0';
    pcVar3[1] = '\0';
    pcVar3[2] = '\0';
    pcVar3[3] = '\0';
    pcVar3[4] = '\0';
    pcVar3[5] = '\0';
    pcVar3[6] = '\0';
    pcVar3[7] = '\0';
    pcVar3 = pcVar3 + (ulong)bVar4 * -0x10 + 8;
  }
  vNpsF18[0] = '\0';
  vNpsF18[1] = '\0';
  vNpsF18[2] = '\0';
  vNpsF18[3] = '\0';
  vNpsF18[4] = '\0';
  pcVar3 = vFetchKey;
  for (lVar2 = 7; lVar2 != 0; lVar2 = lVar2 + -1) {
    pcVar3[0] = '\0';
    pcVar3[1] = '\0';
    pcVar3[2] = '\0';
    pcVar3[3] = '\0';
    pcVar3[4] = '\0';
    pcVar3[5] = '\0';
    pcVar3[6] = '\0';
    pcVar3[7] = '\0';
    pcVar3 = pcVar3 + (ulong)bVar4 * -0x10 + 8;
  }
  sNpsRespCode[0] = '\0';
  sNpsRespCode[1] = '\0';
  sNpsRespCode[2] = '\0';
  sRespCode[0] = '\0';
  sRespCode[1] = '\0';
  sRespCode[2] = '\0';
  sRespCode[3] = '\0';
  pcVar3 = sSecurityData;
  for (lVar2 = 0x200; lVar2 != 0; lVar2 = lVar2 + -1) {
    pcVar3[0] = '\0';
    pcVar3[1] = '\0';
    pcVar3[2] = '\0';
    pcVar3[3] = '\0';
    pcVar3[4] = '\0';
    pcVar3[5] = '\0';
    pcVar3[6] = '\0';
    pcVar3[7] = '\0';
    pcVar3 = pcVar3 + (ulong)bVar4 * -0x10 + 8;
  }
  *pcVar3 = '\0';
  pcVar3 = sTlvBuffer;
  for (lVar2 = 0x200; lVar2 != 0; lVar2 = lVar2 + -1) {
    pcVar3[0] = '\0';
    pcVar3[1] = '\0';
    pcVar3[2] = '\0';
    pcVar3[3] = '\0';
    pcVar3[4] = '\0';
    pcVar3[5] = '\0';
    pcVar3[6] = '\0';
    pcVar3[7] = '\0';
    pcVar3 = pcVar3 + (ulong)bVar4 * -0x10 + 8;
  }
  DumpStructNps(NpsInfo);
  InitNodeData(&Node);
  sprintf(Node.szFstKey,"%04d",(ulong)(NpsInfo->nMsgType - 10));
  GetNpsField(10,NpsInfo,vTempField,&vTempLen);
  Node.szFstKey[4] = vTempField[0];
  Node.szFstKey[5] = vTempField[1];
  Node.szFstKey[6] = vTempField[2];
  Node.szFstKey[7] = vTempField[3];
  Node.szFstKey[8] = vTempField[4];
  Node.szFstKey[9] = vTempField[5];
  GetNpsField(0x59,NpsInfo,vTempField,&vTempLen);
  GetNpsField(1,NpsInfo,vTempField,&vTempLen);
  if (debug_option == 1) {
    sprintf(sLine,"==> FetchKey=[%s] ",Node.szFstKey);
    trace_event(sLine,5);
  }
  iVar1 = FetchRequest('B',&Node);
  if (iVar1 == -0xb) {
    trace_event("FetchRequest failed (ENOEXIST)",1);
    trace_event("End FCT_REV_REP_TO_NW (NOK)",1);
  }
  trace_event("FetchRequest SUCCESS",5);
  InitIsoInfo(&IsoInfo);
  AnalyseIso(Node.sFstBuf,&IsoInfo);
  pcVar3 = sTlvBuffer;
  for (lVar2 = 0x200; lVar2 != 0; lVar2 = lVar2 + -1) {
    pcVar3[0] = '\0';
    pcVar3[1] = '\0';
    pcVar3[2] = '\0';
    pcVar3[3] = '\0';
    pcVar3[4] = '\0';
    pcVar3[5] = '\0';
    pcVar3[6] = '\0';
    pcVar3[7] = '\0';
    pcVar3 = pcVar3 + (ulong)bVar4 * -0x10 + 8;
  }
  memcpy(sTlvBuffer,Node.sSndBuf,(long)Node.nSndBufLen);
  dump_p7_struct(&IsoInfo);
  PrintTlvBuffer(sTlvBuffer);
  IsoInfo.nMsgType = IsoInfo.nMsgType + 10;
  iVar1 = GetNpsField(0x26,NpsInfo,sNpsRespCode,&vTempLen);
  if (iVar1 == 0) {
    iVar1 = TranslateRespCode(nIndexCtx,G_sNps.F_szRsrcId,sNpsRespCode,"RP",sRespCode);
    if (iVar1 != 0) {
      sprintf(sLine,"=> Can not Translate the [%s] NPS response Code!!! ",sNpsRespCode);
      trace_event(sLine,0);
    }
    PutIsoField(0x26,&IsoInfo,sRespCode,3);
  }
  dump_p7_struct(&IsoInfo);
  SafResponseTraitement(nIndexCtx,sTlvBuffer,"1430",sNpsRespCode,sRespCode);
  trace_event("END      FCT_REV_REP_FROM_NW(OK)",5);
  return 0;
}



// WARNING: Unknown calling convention

int RevReqReplyToNps(int nIndexCtx,TSIsoInfo *IsoInfo,TSNpsInfo *OrigNpsInfo,char *sTlvBuffer,
                    int nFlag)

{
  int iVar1;
  long lVar2;
  char *pcVar3;
  byte bVar4;
  char vNpsRspCodeTmp [3];
  int FieldLen;
  int nLength;
  char sDestResource [7];
  char FieldData [256];
  char sLine [512];
  char sBuffer [1024];
  TSNpsInfo NewNpsInfo;
  char sSecurityData [4096];
  
  bVar4 = 0;
  trace_event("Start  RevReqReplyToNps()",5);
  pcVar3 = sBuffer;
  for (lVar2 = 0x80; lVar2 != 0; lVar2 = lVar2 + -1) {
    pcVar3[0] = '\0';
    pcVar3[1] = '\0';
    pcVar3[2] = '\0';
    pcVar3[3] = '\0';
    pcVar3[4] = '\0';
    pcVar3[5] = '\0';
    pcVar3[6] = '\0';
    pcVar3[7] = '\0';
    pcVar3 = pcVar3 + (ulong)bVar4 * -0x10 + 8;
  }
  GetIsoField(0x34,IsoInfo,sSecurityData,&nLength);
  GetSecurityData(7,sSecurityData,sDestResource,&nLength);
  InitNpsInfo(&NewNpsInfo);
  if (OrigNpsInfo->nMsgType - 0x1a4U < 2) {
    NewNpsInfo.nMsgType = OrigNpsInfo->nMsgType + 10;
    iVar1 = GetNpsField(1,OrigNpsInfo,FieldData,&FieldLen);
    if (iVar1 == 0) {
      AddNpsField(1,&NewNpsInfo,FieldData,FieldLen);
    }
    iVar1 = GetNpsField(2,OrigNpsInfo,FieldData,&FieldLen);
    if (iVar1 == 0) {
      AddNpsField(2,&NewNpsInfo,FieldData,FieldLen);
    }
    iVar1 = GetNpsField(3,OrigNpsInfo,FieldData,&FieldLen);
    if (iVar1 == 0) {
      AddNpsField(3,&NewNpsInfo,FieldData,FieldLen);
    }
    iVar1 = GetNpsField(5,OrigNpsInfo,FieldData,&FieldLen);
    if (iVar1 == 0) {
      AddNpsField(5,&NewNpsInfo,FieldData,FieldLen);
    }
    iVar1 = GetNpsField(6,OrigNpsInfo,FieldData,&FieldLen);
    if (iVar1 == 0) {
      AddNpsField(6,&NewNpsInfo,FieldData,FieldLen);
    }
    iVar1 = GetNpsField(10,OrigNpsInfo,FieldData,&FieldLen);
    if (iVar1 == 0) {
      AddNpsField(10,&NewNpsInfo,FieldData,FieldLen);
    }
    iVar1 = GetNpsField(0x1f,OrigNpsInfo,FieldData,&FieldLen);
    if (iVar1 == 0) {
      AddNpsField(0x1f,&NewNpsInfo,FieldData,FieldLen);
    }
    iVar1 = GetNpsField(0x22,OrigNpsInfo,FieldData,&FieldLen);
    if (iVar1 == 0) {
      AddNpsField(0x22,&NewNpsInfo,FieldData,FieldLen);
    }
    iVar1 = GetNpsField(0x24,OrigNpsInfo,FieldData,&FieldLen);
    if (iVar1 == 0) {
      AddNpsField(0x24,&NewNpsInfo,FieldData,FieldLen);
    }
    iVar1 = GetIsoField(0x26,IsoInfo,FieldData,&FieldLen);
    if (iVar1 == 0) {
      sprintf(sLine,"ISO_RESPONSE_CODE: [%s]",FieldData);
      trace_event(sLine,5);
      vNpsRspCodeTmp[0] = '\0';
      vNpsRspCodeTmp[1] = '\0';
      vNpsRspCodeTmp[2] = '\0';
      TranslateRespCode(nIndexCtx,G_sNps.F_szRsrcId,FieldData,"PR",vNpsRspCodeTmp);
      AddNpsField(0x26,&NewNpsInfo,vNpsRspCodeTmp,2);
    }
    iVar1 = GetNpsField(0x28,OrigNpsInfo,FieldData,&FieldLen);
    if (iVar1 == 0) {
      AddNpsField(0x28,&NewNpsInfo,FieldData,FieldLen);
    }
    iVar1 = GetNpsField(0x29,OrigNpsInfo,FieldData,&FieldLen);
    if (iVar1 == 0) {
      AddNpsField(0x29,&NewNpsInfo,FieldData,FieldLen);
    }
    iVar1 = GetNpsField(0x30,OrigNpsInfo,FieldData,&FieldLen);
    if (iVar1 == 0) {
      AddNpsField(0x30,&NewNpsInfo,FieldData,FieldLen);
    }
    iVar1 = GetNpsField(0x32,OrigNpsInfo,FieldData,&FieldLen);
    if (iVar1 == 0) {
      AddNpsField(0x32,&NewNpsInfo,FieldData,FieldLen);
    }
    iVar1 = GetNpsField(0x3c,OrigNpsInfo,FieldData,&FieldLen);
    if (iVar1 == 0) {
      AddNpsField(0x3c,&NewNpsInfo,FieldData,FieldLen);
    }
    iVar1 = GetNpsField(0x59,OrigNpsInfo,FieldData,&FieldLen);
    if (iVar1 == 0) {
      AddNpsField(0x59,&NewNpsInfo,FieldData,FieldLen);
    }
    iVar1 = GetNpsField(0x5e,OrigNpsInfo,FieldData,&FieldLen);
    if (iVar1 == 0) {
      AddNpsField(0x5e,&NewNpsInfo,FieldData,FieldLen);
    }
    iVar1 = Buffer_To_Nps(nIndexCtx,&NewNpsInfo);
    if (iVar1 == 0) {
      trace_event("End  RevReqReplyToNps(OK)",5);
      iVar1 = 0;
    }
    else {
      iVar1 = -1;
      trace_event("End  RevReqReplyToNps(Buffer_To_Nps Failed)",5);
    }
  }
  else {
    iVar1 = -1;
    sprintf(sLine,"==> NO PROCESSING FOR MESSAGE [%.4d] ");
    trace_event("End  RevReqReplyToNps(Message Handling Failed)",5);
  }
  return iVar1;
}



// WARNING: Unknown calling convention

int FCT_REV_REQ_FROM_NW(int nIndexCtx,TSNpsInfo *NpsInfo)

{
  int iVar1;
  long lVar2;
  char *pcVar3;
  byte bVar4;
  char sAutTabInd [4];
  TSIsoInfo IsoInfo;
  char sTlvBuffer [4096];
  
  bVar4 = 0;
  trace_event("START    FCT_REV_REQ_FROM_NW()",5);
  pcVar3 = sTlvBuffer;
  for (lVar2 = 0x200; lVar2 != 0; lVar2 = lVar2 + -1) {
    pcVar3[0] = '\0';
    pcVar3[1] = '\0';
    pcVar3[2] = '\0';
    pcVar3[3] = '\0';
    pcVar3[4] = '\0';
    pcVar3[5] = '\0';
    pcVar3[6] = '\0';
    pcVar3[7] = '\0';
    pcVar3 = pcVar3 + (ulong)bVar4 * -0x10 + 8;
  }
  iVar1 = ConvNpsToISO(nIndexCtx,NpsInfo,&IsoInfo);
  if (iVar1 == 0) {
    dump_p7_struct(&IsoInfo);
    GetTableInd(&IsoInfo,sAutTabInd);
    iVar1 = ReversalProcessing(nIndexCtx,G_sNps.F_szRsrcId,sAutTabInd,&IsoInfo,"N");
    if (iVar1 == -9) {
      trace_event("End  FCT_REV_REQ_FROM_NW( -->ReversalProcessing::SEVERE_ERROR)",5);
      shutdown_resource(nIndexCtx,G_sNps.F_szRsrcId);
    }
    else if (((-10 < iVar1) && (iVar1 + 1U < 2)) &&
            (iVar1 = RevReqReplyToNps(nIndexCtx,&IsoInfo,NpsInfo,sTlvBuffer,1), iVar1 != 0)) {
      trace_event("End  FCT_REV_REQ_FROM_NW(NOK)",5);
      return -1;
    }
    IsoInfo.nMsgType = IsoInfo.nMsgType + 10;
    dump_p7_struct(&IsoInfo);
    trace_event("END      FCT_REV_REQ_FROM_NW()",5);
    iVar1 = 0;
  }
  else {
    trace_event("ConvNpsToISO Error ...",1);
    InsertIsoField(0x26,&IsoInfo,"909",3);
    InsertIsoField(0x2b,&IsoInfo,"000",3);
    iVar1 = AutReplyToNps(nIndexCtx,&IsoInfo,NpsInfo);
    if (iVar1 == 0) {
      iVar1 = -1;
      trace_event("End FCT_REV_REQ_FROM_NW( NOK --> Error ConvNpsToISO )",5);
    }
    else {
      iVar1 = -1;
      trace_event("FCT_REV_REQ_FROM_NW(): AutReplyToNps() failed",5);
    }
  }
  return iVar1;
}



// WARNING: Unknown calling convention

int RecReplyToNps(int nIndexCtx,TSIsoInfo *IsoInfo,TSNpsInfo *OrigNpsInfo,char *sTlvBuffer,int nFlag
                 )

{
  int iVar1;
  long lVar2;
  char *pcVar3;
  byte bVar4;
  int FieldLen;
  char sAutTabInd [4];
  char FieldData [256];
  char sBuffer [1024];
  TSNpsInfo NewNpsInfo;
  
  bVar4 = 0;
  trace_event("Start  RecReplyToNps()",5);
  sAutTabInd[0] = '\0';
  sAutTabInd[1] = '\0';
  sAutTabInd[2] = '\0';
  sAutTabInd[3] = '\0';
  pcVar3 = sBuffer;
  for (lVar2 = 0x80; lVar2 != 0; lVar2 = lVar2 + -1) {
    pcVar3[0] = '\0';
    pcVar3[1] = '\0';
    pcVar3[2] = '\0';
    pcVar3[3] = '\0';
    pcVar3[4] = '\0';
    pcVar3[5] = '\0';
    pcVar3[6] = '\0';
    pcVar3[7] = '\0';
    pcVar3 = pcVar3 + (ulong)bVar4 * -0x10 + 8;
  }
  InitNpsInfo(&NewNpsInfo);
  switch(OrigNpsInfo->nMsgType) {
  case 500:
    NewNpsInfo.nMsgType = 0x1fe;
    break;
  default:
    sprintf(FieldData,"==> NO PROCESSING FOR MESSAGE [%.4d] ");
    trace_event(FieldData,1);
    trace_event("End  AdvReplyToNw(Message Handling Failed)",5);
    return -1;
  case 0x1f6:
    NewNpsInfo.nMsgType = 0x200;
    break;
  case 0x208:
  case 0x209:
    NewNpsInfo.nMsgType = 0x212;
    break;
  case 0x20a:
  case 0x20b:
    NewNpsInfo.nMsgType = 0x214;
  }
  iVar1 = GetNpsField(6,OrigNpsInfo,FieldData,&FieldLen);
  if (iVar1 == 0) {
    AddNpsField(6,&NewNpsInfo,FieldData,FieldLen);
  }
  iVar1 = GetNpsField(10,OrigNpsInfo,FieldData,&FieldLen);
  if (iVar1 == 0) {
    AddNpsField(10,&NewNpsInfo,FieldData,FieldLen);
  }
  iVar1 = GetNpsField(0xe,OrigNpsInfo,FieldData,&FieldLen);
  if (iVar1 == 0) {
    AddNpsField(0xe,&NewNpsInfo,FieldData,FieldLen);
  }
  iVar1 = GetNpsField(0x31,OrigNpsInfo,FieldData,&FieldLen);
  if (iVar1 == 0) {
    AddNpsField(0x31,&NewNpsInfo,FieldData,FieldLen);
  }
  AddNpsField(0x41,&NewNpsInfo,"9",1);
  iVar1 = GetNpsField(0x62,OrigNpsInfo,FieldData,&FieldLen);
  if (iVar1 == 0) {
    AddNpsField(0x62,&NewNpsInfo,FieldData,FieldLen);
  }
  iVar1 = Buffer_To_Nps(nIndexCtx,&NewNpsInfo);
  if (iVar1 == 0) {
    trace_event("End  RecReplyToNps(OK)",5);
    iVar1 = 0;
  }
  else {
    iVar1 = -1;
    trace_event("End  RecReplyToNps(Buffer_To_Nps Failed)",5);
  }
  return iVar1;
}



// WARNING: Unknown calling convention

int FCT_RECONC_ADV(int nIndexCtx,TSNpsInfo *NpsInfo,char *ReconcType)

{
  int iVar1;
  long lVar2;
  char *pcVar3;
  byte bVar4;
  TSIsoInfo IsoInfo;
  char sTlvBuffer [4096];
  
  bVar4 = 0;
  trace_event("START    FCT_RECONC_ADV()",5);
  pcVar3 = sTlvBuffer;
  for (lVar2 = 0x200; lVar2 != 0; lVar2 = lVar2 + -1) {
    pcVar3[0] = '\0';
    pcVar3[1] = '\0';
    pcVar3[2] = '\0';
    pcVar3[3] = '\0';
    pcVar3[4] = '\0';
    pcVar3[5] = '\0';
    pcVar3[6] = '\0';
    pcVar3[7] = '\0';
    pcVar3 = pcVar3 + (ulong)bVar4 * -0x10 + 8;
  }
  iVar1 = ConvNpsToISO(nIndexCtx,NpsInfo,&IsoInfo);
  if (iVar1 == 0) {
    dump_p7_struct(&IsoInfo);
    InsertReconcNPS(nIndexCtx,ReconcType,&IsoInfo);
    iVar1 = RecReplyToNps(nIndexCtx,&IsoInfo,NpsInfo,sTlvBuffer,1);
    if (iVar1 == 0) {
      iVar1 = -1;
      trace_event("End  FCT_RECONC_ADV(NOK)",5);
    }
    else {
      trace_event("END      FCT_RECONC_ADV(OK)",5);
      iVar1 = 0;
    }
  }
  else {
    trace_event("ConvNpsToISO Error ...",1);
    InsertIsoField(0x26,&IsoInfo,"909",3);
    InsertIsoField(0x2b,&IsoInfo,"000",3);
    iVar1 = AdvReplyToNps(nIndexCtx,&IsoInfo,NpsInfo);
    if (iVar1 == 0) {
      iVar1 = -1;
      trace_event("End FCT_RECONC_ADV( NOK --> Error ConvNpsToISO )",5);
    }
    else {
      iVar1 = -1;
      trace_event("FCT_RECONC_ADV(): AdvReplyToNps() failed",5);
    }
  }
  return iVar1;
}



// WARNING: Unknown calling convention

int GetQpayTrack2Data(int nIndexCtx,char *sTrack2,char *sQTrack2)

{
  size_t sVar1;
  long lVar2;
  ulong uVar3;
  uint uVar4;
  char *pcVar5;
  uchar *puVar6;
  bool bVar7;
  byte bVar8;
  uchar auStack_2454 [48];
  uchar auStack_2424 [8088];
  int T_RetVal;
  anon_struct_44_2_43c7b5cf T_Q_Track_2;
  anon_struct_44_2_43c7b5cf T_Track_2;
  sqlca sqlca;
  sqlexd_conflict sqlstm;
  char sLine [512];
  
  bVar8 = 0;
  pcVar5 = sLine;
  for (lVar2 = 0x40; lVar2 != 0; lVar2 = lVar2 + -1) {
    pcVar5[0] = '\0';
    pcVar5[1] = '\0';
    pcVar5[2] = '\0';
    pcVar5[3] = '\0';
    pcVar5[4] = '\0';
    pcVar5[5] = '\0';
    pcVar5[6] = '\0';
    pcVar5[7] = '\0';
    pcVar5 = pcVar5 + 8;
  }
  sprintf(sLine,"Start GetQpayTrack2Data(%15s)",sTrack2);
  trace_event(sLine,5);
  puVar6 = T_Q_Track_2.arr + 2;
  uVar4 = 0x27;
  T_Q_Track_2.arr[0] = '\0';
  T_Q_Track_2.arr[1] = '\0';
  bVar7 = ((ulong)puVar6 & 4) != 0;
  if (bVar7) {
    T_Q_Track_2.arr[2] = '\0';
    T_Q_Track_2.arr[3] = '\0';
    T_Q_Track_2.arr[4] = '\0';
    T_Q_Track_2.arr[5] = '\0';
    uVar4 = 0x23;
    puVar6 = T_Q_Track_2.arr + 6;
  }
  for (uVar3 = (ulong)(uVar4 >> 3); uVar3 != 0; uVar3 = uVar3 - 1) {
    puVar6[0] = '\0';
    puVar6[1] = '\0';
    puVar6[2] = '\0';
    puVar6[3] = '\0';
    puVar6[4] = '\0';
    puVar6[5] = '\0';
    puVar6[6] = '\0';
    puVar6[7] = '\0';
    puVar6 = puVar6 + (ulong)bVar8 * -0x10 + 8;
  }
  if (!bVar7) {
    puVar6[0] = '\0';
    puVar6[1] = '\0';
    puVar6[2] = '\0';
    puVar6[3] = '\0';
    puVar6 = puVar6 + 4;
  }
  puVar6[0] = '\0';
  puVar6[1] = '\0';
  puVar6[2] = '\0';
  uVar4 = 0x27;
  T_Q_Track_2.len = 0;
  puVar6 = T_Track_2.arr + 2;
  T_Track_2.arr[0] = '\0';
  T_Track_2.arr[1] = '\0';
  bVar7 = ((ulong)puVar6 & 4) != 0;
  if (bVar7) {
    T_Track_2.arr[2] = '\0';
    T_Track_2.arr[3] = '\0';
    T_Track_2.arr[4] = '\0';
    T_Track_2.arr[5] = '\0';
    uVar4 = 0x23;
    puVar6 = T_Track_2.arr + 6;
  }
  for (uVar3 = (ulong)(uVar4 >> 3); uVar3 != 0; uVar3 = uVar3 - 1) {
    puVar6[0] = '\0';
    puVar6[1] = '\0';
    puVar6[2] = '\0';
    puVar6[3] = '\0';
    puVar6[4] = '\0';
    puVar6[5] = '\0';
    puVar6[6] = '\0';
    puVar6[7] = '\0';
    puVar6 = puVar6 + (ulong)bVar8 * -0x10 + 8;
  }
  if (!bVar7) {
    puVar6[0] = '\0';
    puVar6[1] = '\0';
    puVar6[2] = '\0';
    puVar6[3] = '\0';
    puVar6 = puVar6 + 4;
  }
  puVar6[0] = '\0';
  puVar6[1] = '\0';
  puVar6[2] = '\0';
  T_Track_2.len = 0;
  sVar1 = strlen(sTrack2);
  memcpy(T_Q_Track_2.arr,sTrack2,sVar1);
  sqlstm.sqlety = 0x1100;
  sqlstm.sqphsv = sqlstm.sqhstv;
  sqlstm.sqladtp = &sqladt;
  sqlstm.sqadto[0] = 0;
  sqlstm.sqtdso[0] = 0;
  sqlstm.sqltdsp = &sqltds;
  sqlstm.sqadto[1] = 0;
  sqlstm.sqtdso[1] = 0;
  T_Q_Track_2.len = (ushort)sVar1;
  sqlstm.stmt = 
  "begin :T_RetVal := PCRD_NPS_TOOLS . FORMAT_TRACK_2 ( :T_Q_Track_2 , :T_Track_2 ) ; END ;";
  T_RetVal = 999;
  sqlstm.sqlvsn = 0xc;
  sqlstm.arrsiz = 3;
  sqlstm.cud = sqlcud0;
  sqlstm.sqhstv[0] = (uchar *)&T_RetVal;
  sqlstm.iters = 1;
  sqlstm.offset = 5;
  sqlstm.occurs = 0;
  sqlstm.sqhstl[0] = 4;
  sqlstm.sqhsts[0] = 0;
  sqlstm.sqindv[0] = (short *)0x0;
  sqlstm.sqinds[0] = 0;
  sqlstm.sqharm[0] = 0;
  sqlstm.sqhstl[1] = 0x2b;
  sqlstm.sqhsts[1] = 0;
  sqlstm.sqindv[1] = (short *)0x0;
  sqlstm.sqinds[1] = 0;
  sqlstm.sqharm[1] = 0;
  sqlstm.sqhstl[2] = 0x2b;
  sqlstm.sqhsts[2] = 0;
  sqlstm.sqindv[2] = (short *)0x0;
  sqlstm.sqinds[2] = 0;
  sqlstm.sqphsl = sqlstm.sqhstl;
  sqlstm.sqharm[2] = 0;
  sqlstm.sqadto[2] = 0;
  sqlstm.sqphss = sqlstm.sqhsts;
  sqlstm.sqtdso[2] = 0;
  sqlstm.sqpind = sqlstm.sqindv;
  sqlstm.sqpins = sqlstm.sqinds;
  sqlstm.sqparm = sqlstm.sqharm;
  sqlstm.sqparc = sqlstm.sqharc;
  sqlstm.sqpadto = sqlstm.sqadto;
  sqlstm.sqptdso = sqlstm.sqtdso;
  sqlstm.sqlest = (uchar *)&sqlca;
  sqlstm.sqhstv[1] = (uchar *)&T_Q_Track_2;
  sqlstm.sqhstv[2] = (uchar *)&T_Track_2;
  sqlcxt((long)nIndexCtx * 0x10 + 0x713948,&sqlctx,&sqlstm,&sqlfpn);
  if (sqlca.sqlcode < 0) {
    sprintf(sLine,"%.80s",sqlca.sqlerrm.sqlerrmc);
    trace_event(sLine,0);
    trace_event("End   GetQpayTrack2Data(MALFUNCTION)",0);
    T_RetVal = -2;
  }
  else {
    sprintf(sLine,"End   GetQpayTrack2Data(%d)",(ulong)(uint)T_RetVal);
    trace_event(sLine,0);
    sVar1 = strlen((char *)T_Track_2.arr);
    memcpy(sQTrack2,T_Track_2.arr,sVar1);
  }
  return T_RetVal;
}



// WARNING: Unknown calling convention

int NwToIsoReason(char *sSrc,char *sTar)

{
  int iVar1;
  char *pcVar2;
  int iVar3;
  char **ppcVar4;
  char sLine [512];
  
  iVar3 = 0;
  sprintf(sLine,"Start NwToIsoReason(%.2s)",sSrc);
  trace_event(sLine,4);
  ppcVar4 = &aAction[0].sNwRsp;
  do {
    iVar1 = memcmp(*ppcVar4,sSrc,2);
    if (iVar1 == 0) {
      pcVar2 = aAction[iVar3].sIsoReasonCode;
      break;
    }
    iVar3 = iVar3 + 1;
    ppcVar4 = ppcVar4 + 3;
    pcVar2 = aAction[1].sIsoReasonCode;
  } while (iVar3 != 0x20);
  *(undefined4 *)sTar = *(undefined4 *)pcVar2;
  sprintf(sLine,"End   NwToIsoReason(%.4s)",sTar);
  trace_event(sLine,4);
  return 0;
}



// WARNING: Unknown calling convention

int IsoToNwRsp(char *sSrc,char *sTar)

{
  int iVar1;
  int iVar2;
  ACTION *pAVar3;
  char *__format;
  char sLine [512];
  
  iVar2 = 0;
  sprintf(sLine,"Start IsoToNwRsp(%.4s)",sSrc);
  trace_event(sLine,4);
  pAVar3 = aAction;
  do {
    iVar1 = memcmp(pAVar3->sIsoReasonCode,sSrc,4);
    if (iVar1 == 0) {
      __format = "End   IsoToNwRsp(%.2s)";
      *(undefined2 *)sTar = *(undefined2 *)aAction[iVar2].sNwRsp;
      goto LAB_00419ede;
    }
    iVar2 = iVar2 + 1;
    pAVar3 = pAVar3 + 1;
  } while (iVar2 != 0x20);
  __format = "End   IsoToPosREason(%.2s)";
  *(undefined2 *)sTar = *(undefined2 *)aAction[2].sNwRsp;
LAB_00419ede:
  sprintf(sLine,__format,sTar);
  trace_event(sLine,4);
  return 0;
}



// WARNING: Unknown calling convention

int IsoToNwTxt(char *sSrc,char *sTar)

{
  char *__s;
  int iVar1;
  size_t __n;
  int iVar2;
  ACTION *pAVar3;
  char sLine [512];
  
  iVar2 = 0;
  sprintf(sLine,"Start IsoToNwTxt(%.4s)",sSrc);
  trace_event(sLine,4);
  trace_event("End   IsoToNwTxt()",4);
  pAVar3 = aAction;
  do {
    iVar1 = memcmp(pAVar3->sIsoReasonCode,sSrc,4);
    if (iVar1 == 0) {
      __s = aAction[iVar2].texte;
      __n = strlen(__s);
      memcpy(sTar,__s,__n);
      return 0;
    }
    iVar2 = iVar2 + 1;
    pAVar3 = pAVar3 + 1;
  } while (iVar2 != 0x20);
  builtin_strncpy(sTar,"NOT SPECIFIED ",0xf);
  return 0;
}



// WARNING: Unknown calling convention

int InitCltCom(char *sServerName,char *sPort)

{
  int iVar1;
  uint __fd;
  hostent *phVar2;
  uint *puVar3;
  char *pcVar4;
  char szFuncName [11];
  sockaddr_in sAddrServ;
  char sLine [134];
  
  builtin_strncpy(szFuncName,"InitCltCom",0xb);
  iVar1 = atoi(sPort);
  trace_event("cou",5);
  sprintf((char *)&sAddrServ,"Start %%s(%s)","%.64s, %.64s");
  sprintf(sLine,(char *)&sAddrServ,szFuncName,sServerName,sPort);
  trace_event(sLine,5);
  __fd = socket(2,1,0);
  if (__fd == 0xffffffff) {
    puVar3 = (uint *)__errno_location();
    pcVar4 = strerror(*puVar3);
    sprintf(sLine,"%s()-%s() failed : %d->%s",szFuncName,"socket",(ulong)*puVar3,pcVar4);
    trace_event(sLine,1);
  }
  else {
    phVar2 = gethostbyname(sServerName);
    if (phVar2 == (hostent *)0x0) {
      sprintf(sLine,"%s()-%s() failed : %.60s [%.20s]",szFuncName,"gethostbyname",
              "unknown machine (check /etc/hosts)",sServerName);
      trace_event(sLine,1);
      sprintf(sLine,"End   %s(%d)",szFuncName,0xffffffff);
      trace_event(sLine,5);
      return -1;
    }
    sAddrServ.sin_family = 2;
    sAddrServ.sin_port = (ushort)iVar1 >> 8 | (ushort)iVar1 << 8;
    memcpy(&sAddrServ.sin_addr,*phVar2->h_addr_list,(long)phVar2->h_length);
    iVar1 = connect(__fd,(sockaddr *)&sAddrServ,0x10);
    if (iVar1 == -1) {
      puVar3 = (uint *)__errno_location();
      pcVar4 = strerror(*puVar3);
      sprintf(sLine,"%s()-%s() failed : %d->%s",szFuncName,"connect",(ulong)*puVar3,pcVar4);
      trace_event(sLine,1);
      sprintf(sLine,"End   %s(%d)",szFuncName,0xffffffff);
      trace_event(sLine,5);
      return -1;
    }
  }
  sprintf(sLine,"End   %s(%d)",szFuncName,(ulong)__fd);
  trace_event(sLine,5);
  return __fd;
}



// WARNING: Unknown calling convention

int InitSrvComms(int nPort)

{
  uint uVar1;
  int iVar2;
  uint *puVar3;
  char *pcVar4;
  char *pcVar5;
  ulong uVar6;
  int Longueur;
  int on;
  linger sLinger;
  char szFuncName [13];
  sockaddr_in adr_local;
  char local_fmt [128];
  char sLine [512];
  
  builtin_strncpy(szFuncName,"InitSrvComms",0xd);
  Longueur = 0x10;
  sprintf(local_fmt,"Start %%s(%s)","%d");
  sprintf(sLine,local_fmt,szFuncName,(ulong)(uint)nPort);
  trace_event(sLine,5);
  uVar1 = socket(2,1,0);
  if (uVar1 == 0xffffffff) {
    puVar3 = (uint *)__errno_location();
    pcVar4 = strerror(*puVar3);
    sprintf(sLine,"%s()-%s() failed : %d->%s",szFuncName,"socket",(ulong)*puVar3,pcVar4);
    trace_event(sLine,1);
  }
  else {
    adr_local.sin_port = (ushort)nPort >> 8 | (ushort)nPort << 8;
    adr_local.sin_family = 2;
    adr_local.sin_addr.s_addr = 0;
    on = 1;
    iVar2 = setsockopt(uVar1,1,2,&on,4);
    if (iVar2 == 0) {
      iVar2 = setsockopt(uVar1,1,2,&on,4);
      if (iVar2 == 0) {
        sLinger.l_onoff = 0;
        sLinger.l_linger = 5;
        iVar2 = setsockopt(uVar1,1,0xd,&sLinger,8);
        if (iVar2 == 0) {
          iVar2 = bind(uVar1,(sockaddr *)&adr_local,Longueur);
          if (iVar2 == -1) {
            close(uVar1);
            puVar3 = (uint *)__errno_location();
            pcVar4 = strerror(*puVar3);
            uVar1 = *puVar3;
            pcVar5 = "bind";
          }
          else {
            getsockname(uVar1,(sockaddr *)&adr_local,(socklen_t *)&Longueur);
            iVar2 = listen(uVar1,1);
            if (iVar2 != -1) {
              nFdLocal = uVar1;
              sprintf(local_fmt,"End   %%s(%%d, %s)","%d, %d");
              sprintf(sLine,local_fmt,szFuncName,0,(ulong)(uint)nFdLocal,(ulong)uVar1);
              trace_event(sLine,5);
              return 0;
            }
            close(uVar1);
            puVar3 = (uint *)__errno_location();
            pcVar4 = strerror(*puVar3);
            uVar1 = *puVar3;
            pcVar5 = "listen";
          }
          sprintf(sLine,"%s()-%s() failed : %d->%s",szFuncName,pcVar5,(ulong)uVar1,pcVar4);
          trace_event(sLine,1);
          sprintf(sLine,"End   %s(%d)",szFuncName,0xffffffff);
          trace_event(sLine,5);
          return -1;
        }
        close(uVar1);
        puVar3 = (uint *)__errno_location();
        pcVar4 = strerror(*puVar3);
        pcVar5 = "Can not Use Socket Option SO_LINGER";
        uVar6 = (ulong)*puVar3;
      }
      else {
        close(uVar1);
        puVar3 = (uint *)__errno_location();
        pcVar4 = strerror(*puVar3);
        pcVar5 = "Can not Use Socket Option SO_REUSEPORT";
        uVar6 = (ulong)*puVar3;
      }
    }
    else {
      close(uVar1);
      puVar3 = (uint *)__errno_location();
      pcVar4 = strerror(*puVar3);
      uVar6 = (ulong)*puVar3;
      pcVar5 = "Can not Use Socket Option SO_REUSEADDR";
    }
    sprintf(sLine,"%s()-%s() failed : %.60s [%d->%.20s]",szFuncName,"setsockopt",pcVar5,uVar6,pcVar4
           );
    trace_event(sLine,1);
  }
  sprintf(sLine,"End   %s(%d)",szFuncName,0xffffffff);
  trace_event(sLine,5);
  return -1;
}



// WARNING: Unknown calling convention

int AcceptCallSrv(char *calling_address)

{
  uint uVar1;
  uint *puVar2;
  char *pcVar3;
  int long_inet;
  uchar adr [4];
  char szFuncName [14];
  sockaddr_in adr_client;
  char local_fmt [128];
  char sLine [134];
  
  builtin_strncpy(szFuncName,"AcceptCallSrv",0xe);
  sprintf(sLine,"Start %s()",szFuncName);
  trace_event(sLine,5);
  adr[0] = '\0';
  adr[1] = '\0';
  adr[2] = '\0';
  adr[3] = '\0';
  long_inet = 0x10;
  uVar1 = accept(nFdLocal,(sockaddr *)&adr_client,(socklen_t *)&long_inet);
  if ((int)uVar1 < 0) {
    puVar2 = (uint *)__errno_location();
    pcVar3 = strerror(*puVar2);
    sprintf(sLine,"%s()-%s() failed : %d->%s",szFuncName,"accept",(ulong)*puVar2,pcVar3);
    trace_event(sLine,1);
    sprintf(sLine,"End   %s(%d)",szFuncName,0xffffffff);
    trace_event(sLine,5);
    uVar1 = 0xffffffff;
  }
  else {
    sprintf(calling_address,"%.03u.%.03u.%.03u.%.03u",(ulong)(adr_client.sin_addr.s_addr >> 0x18),
            (ulong)(adr_client.sin_addr.s_addr >> 0x10 & 0xff),
            (ulong)(adr_client.sin_addr.s_addr >> 8 & 0xff),
            (ulong)(adr_client.sin_addr.s_addr & 0xff));
    sprintf(local_fmt,"End   %%s(%%d, %s)","%d, %.20s");
    sprintf(sLine,local_fmt,szFuncName,(ulong)uVar1,(ulong)uVar1,calling_address);
    trace_event(sLine,5);
  }
  return uVar1;
}



// WARNING: Unknown calling convention

int AcceptCall(char *calling_address)

{
  uint uVar1;
  int iVar2;
  char szFuncName [11];
  char local_fmt [128];
  char sLine [134];
  
  builtin_strncpy(szFuncName,"AcceptCall",0xb);
  sprintf(local_fmt,"Start %%s(%s)","%d");
  sprintf(sLine,local_fmt,szFuncName,(ulong)(uint)nFdLocal);
  trace_event(sLine,5);
  uVar1 = AcceptCallSrv(calling_address);
  if ((int)uVar1 < 0) {
    sprintf(sLine,"%s()-%s() failed : %d",szFuncName,"AcceptCallSrv",(ulong)uVar1);
    trace_event(sLine,1);
    sprintf(sLine,"End   %s(%d)",szFuncName,0xffffffff);
    trace_event(sLine,5);
    iVar2 = -1;
  }
  else {
    sprintf(local_fmt,"End   %%s(%%d, %s)","%d, %.20s");
    sprintf(sLine,local_fmt,szFuncName,0,(ulong)uVar1,calling_address);
    trace_event(sLine,5);
    iVar2 = 0;
  }
  return iVar2;
}



// WARNING: Unknown calling convention

void StopCltCom(int nFd)

{
  uint uVar1;
  uint *puVar2;
  char *pcVar3;
  char szFuncName [11];
  char local_fmt [128];
  char sLine [512];
  
  builtin_strncpy(szFuncName,"StopCltCom",0xb);
  sprintf(local_fmt,"Start %%s(%s)","%d");
  sprintf(sLine,local_fmt,szFuncName,nFd);
  trace_event(sLine,5);
  uVar1 = shutdown(nFd,2);
  if ((int)uVar1 < 0) {
    puVar2 = (uint *)__errno_location();
    pcVar3 = strerror(*puVar2);
    sprintf(sLine,"Shutdown Ret : %d, Errno : %d->%s",(ulong)uVar1,(ulong)*puVar2,pcVar3);
    trace_event(sLine,4);
  }
  uVar1 = close(nFd);
  if ((int)uVar1 < 0) {
    puVar2 = (uint *)__errno_location();
    pcVar3 = strerror(*puVar2);
    sprintf(sLine,"Close    Ret : %d, Errno : %d->%s",(ulong)uVar1,(ulong)*puVar2,pcVar3);
    trace_event(sLine,4);
  }
  sprintf(sLine,"End   %s(VOID)",szFuncName);
  trace_event(sLine,5);
  return;
}



// WARNING: Unknown calling convention

int ReadLineMsg(int nFd,char *sBuffer,int *nLength)

{
  int iVar1;
  ssize_t sVar2;
  uint *puVar3;
  char *pcVar4;
  long lVar5;
  int SizeBuffer;
  uchar *puVar6;
  char *pcVar7;
  ulong uVar8;
  int iVar9;
  byte bVar10;
  char szFuncName [12];
  char sLine [512];
  char sBuffRcv [4096];
  char sDest [4096];
  
  bVar10 = 0;
  builtin_strncpy(szFuncName,"ReadLineMsg",0xc);
  sprintf(sDest,"Start %%s(%s)","%d");
  sprintf(sLine,sDest,szFuncName,nFd);
  trace_event(sLine,5);
  puVar6 = (uchar *)sBuffRcv;
  for (lVar5 = 0x200; lVar5 != 0; lVar5 = lVar5 + -1) {
    puVar6[0] = '\0';
    puVar6[1] = '\0';
    puVar6[2] = '\0';
    puVar6[3] = '\0';
    puVar6[4] = '\0';
    puVar6[5] = '\0';
    puVar6[6] = '\0';
    puVar6[7] = '\0';
    puVar6 = puVar6 + (ulong)bVar10 * -0x10 + 8;
  }
  trace_event("ReadLineMsg ReadLineMsg ReadLineMsg ReadLineMsg",5);
  do {
    sVar2 = recv(nFd,sBuffRcv,2,0);
    iVar9 = (int)sVar2;
    if (iVar9 < 1) break;
  } while (iVar9 != 2);
  if (iVar9 < 0) {
    puVar3 = (uint *)__errno_location();
    pcVar4 = strerror(*puVar3);
    pcVar7 = "while reading message length";
    uVar8 = (ulong)*puVar3;
  }
  else {
    if (iVar9 == 0) {
      puVar3 = (uint *)__errno_location();
      pcVar4 = strerror(*puVar3);
      sprintf(sLine,"%s()-%s() failed : %.60s [%d->%.20s]",szFuncName,&DAT_004a6d01,
              "disconnected while reading message length",(ulong)*puVar3,pcVar4);
      trace_event(sLine,1);
      sprintf(sLine,"End   %s(%d)",szFuncName,99);
      trace_event(sLine,5);
      return 99;
    }
    puVar6 = (uchar *)sBuffRcv;
    for (lVar5 = 0x200; lVar5 != 0; lVar5 = lVar5 + -1) {
      puVar6[0] = '\0';
      puVar6[1] = '\0';
      puVar6[2] = '\0';
      puVar6[3] = '\0';
      puVar6[4] = '\0';
      puVar6[5] = '\0';
      puVar6[6] = '\0';
      puVar6[7] = '\0';
      puVar6 = puVar6 + (ulong)bVar10 * -0x10 + 8;
    }
    SizeBuffer = (uint)(byte)sBuffRcv[0] * 0x100 + (uint)(byte)sBuffRcv[1];
    puVar6 = (uchar *)sBuffRcv;
    iVar9 = SizeBuffer;
    if (SizeBuffer != 0) {
      do {
        sVar2 = recv(nFd,puVar6,(long)iVar9,0);
        iVar1 = (int)sVar2;
        if (iVar1 < 1) {
          if (iVar1 == 0) goto LAB_0041ac2a;
          puVar3 = (uint *)__errno_location();
          pcVar4 = strerror(*puVar3);
          pcVar7 = "while reading message data";
          uVar8 = (ulong)*puVar3;
          goto LAB_0041ac4d;
        }
        iVar9 = iVar9 - iVar1;
        puVar6 = puVar6 + iVar1;
      } while (iVar9 != 0);
      if (iVar1 != 0) {
        memcpy(sBuffer,sBuffRcv,(long)SizeBuffer);
        *nLength = SizeBuffer;
        if (debug_option == 1) {
          dump_buffer((uchar *)sBuffRcv,SizeBuffer,'A','L','I');
        }
        else {
          EncryptBuff(sBuffRcv,SizeBuffer,sDest,'A','L','I');
        }
        sprintf(sLine,"End   %s(%d)",szFuncName,0);
        trace_event(sLine,5);
        return 0;
      }
    }
LAB_0041ac2a:
    puVar3 = (uint *)__errno_location();
    pcVar4 = strerror(*puVar3);
    uVar8 = (ulong)*puVar3;
    pcVar7 = "disconnect while reading message data";
  }
LAB_0041ac4d:
  sprintf(sLine,"%s()-%s() failed : %.60s [%d->%.20s]",szFuncName,&DAT_004a6d01,pcVar7,uVar8,pcVar4)
  ;
  trace_event(sLine,1);
  sprintf(sLine,"End   %s(%d)",szFuncName,0xffffffff);
  trace_event(sLine,5);
  return -1;
}



// WARNING: Unknown calling convention

int WriteLineMsg(int nFd,char *sBuffer,int nLength)

{
  int iVar1;
  ssize_t sVar2;
  uint *puVar3;
  char *pcVar4;
  long lVar5;
  uint SizeBuffer;
  uchar *puVar6;
  byte bVar7;
  char szFuncName [13];
  char sLine [512];
  char sBuffSnd [4096];
  char sDest [4096];
  
  bVar7 = 0;
  builtin_strncpy(szFuncName,"WriteLineMsg",0xd);
  sprintf(sDest,"Start %%s(%s)","%d, %d, %.24s");
  sprintf(sLine,sDest,szFuncName,(ulong)(uint)nFd,(ulong)(uint)nLength,sBuffer);
  trace_event(sLine,5);
  puVar6 = (uchar *)sBuffSnd;
  for (lVar5 = 0x200; lVar5 != 0; lVar5 = lVar5 + -1) {
    puVar6[0] = '\0';
    puVar6[1] = '\0';
    puVar6[2] = '\0';
    puVar6[3] = '\0';
    puVar6[4] = '\0';
    puVar6[5] = '\0';
    puVar6[6] = '\0';
    puVar6[7] = '\0';
    puVar6 = puVar6 + (ulong)bVar7 * -0x10 + 8;
  }
  iVar1 = nLength + 0xff;
  if (-1 < nLength) {
    iVar1 = nLength;
  }
  sBuffSnd[0] = (char)((uint)iVar1 >> 8);
  sBuffSnd[1] = (char)nLength;
  SizeBuffer = nLength + 2;
  memcpy(sBuffSnd + 2,sBuffer,(long)nLength);
  sVar2 = write(nFd,sBuffSnd,(ulong)SizeBuffer);
  if (debug_option == 1) {
    dump_buffer((uchar *)sBuffSnd,SizeBuffer,'A','L','O');
  }
  else {
    EncryptBuff(sBuffSnd,SizeBuffer,sDest,'A','L','O');
  }
  if ((int)sVar2 < 1) {
    puVar3 = (uint *)__errno_location();
    pcVar4 = strerror(*puVar3);
    sprintf(sLine,"%s()-%s() failed : %d->%s",szFuncName,"write",(ulong)*puVar3,pcVar4);
    trace_event(sLine,1);
    sprintf(sLine,"End   %s(%d)",szFuncName,0xffffffff);
    trace_event(sLine,5);
    iVar1 = -1;
  }
  else {
    sprintf(sLine,"End   %s(%d)",szFuncName,0);
    trace_event(sLine,5);
    iVar1 = 0;
  }
  return iVar1;
}



// WARNING: Type propagation algorithm not settling
// WARNING: Unknown calling convention

void InitNpsIcTag(TSTagNps *msgInfo)

{
  ulong uVar1;
  int *piVar2;
  int *piVar3;
  TSTagNps *pTVar4;
  TSTagNps *pTVar5;
  char *pcVar6;
  char *pcVar7;
  int iVar8;
  uint uVar9;
  bool bVar11;
  ulong uVar10;
  
  piVar2 = msgInfo->nPosTag;
  uVar10 = 400;
  iVar8 = 400;
  bVar11 = ((ulong)piVar2 & 1) != 0;
  if (bVar11) {
    piVar2 = (int *)((long)msgInfo->nPosTag + 1);
    *(undefined1 *)msgInfo->nPosTag = 0;
    uVar10 = 399;
    iVar8 = 399;
  }
  if (((ulong)piVar2 & 2) == 0) {
    uVar9 = (uint)uVar10;
  }
  else {
    uVar9 = iVar8 - 2;
    uVar10 = (ulong)uVar9;
    *(undefined2 *)piVar2 = 0;
    piVar2 = (int *)((long)piVar2 + 2);
  }
  if (((ulong)piVar2 & 4) != 0) {
    *piVar2 = 0;
    uVar10 = (ulong)(uVar9 - 4);
    piVar2 = piVar2 + 1;
  }
  for (uVar1 = uVar10 >> 3; uVar1 != 0; uVar1 = uVar1 - 1) {
    piVar2[0] = 0;
    piVar2[1] = 0;
    piVar2 = piVar2 + 2;
  }
  if ((uVar10 & 4) != 0) {
    *piVar2 = 0;
    piVar2 = piVar2 + 1;
  }
  piVar3 = piVar2;
  if ((uVar10 & 2) != 0) {
    piVar3 = (int *)((long)piVar2 + 2);
    *(undefined2 *)piVar2 = 0;
  }
  if (bVar11) {
    *(undefined1 *)piVar3 = 0;
  }
  bVar11 = ((ulong)msgInfo & 1) != 0;
  uVar10 = 400;
  iVar8 = 400;
  if (bVar11) {
    pTVar4 = (TSTagNps *)((long)msgInfo->nPresent + 1);
    *(undefined1 *)msgInfo->nPresent = 0xff;
    uVar10 = 399;
    iVar8 = 399;
    uVar1 = (ulong)pTVar4 & 2;
  }
  else {
    uVar1 = (ulong)msgInfo & 2;
    pTVar4 = msgInfo;
  }
  if (uVar1 == 0) {
    uVar9 = (uint)uVar10;
  }
  else {
    uVar9 = iVar8 - 2;
    uVar10 = (ulong)uVar9;
    *(undefined2 *)pTVar4->nPresent = 0xffff;
    pTVar4 = (TSTagNps *)((long)pTVar4->nPresent + 2);
  }
  if (((ulong)pTVar4 & 4) != 0) {
    pTVar4->nPresent[0] = -1;
    uVar10 = (ulong)(uVar9 - 4);
    pTVar4 = (TSTagNps *)(pTVar4->nPresent + 1);
  }
  for (uVar1 = uVar10 >> 3; uVar1 != 0; uVar1 = uVar1 - 1) {
    pTVar4->nPresent[0] = -1;
    pTVar4->nPresent[1] = -1;
    pTVar4 = (TSTagNps *)(pTVar4->nPresent + 2);
  }
  if ((uVar10 & 4) != 0) {
    pTVar4->nPresent[0] = -1;
    pTVar4 = (TSTagNps *)(pTVar4->nPresent + 1);
  }
  pTVar5 = pTVar4;
  if ((uVar10 & 2) != 0) {
    pTVar5 = (TSTagNps *)((long)pTVar4->nPresent + 2);
    *(undefined2 *)pTVar4->nPresent = 0xffff;
  }
  if (bVar11) {
    *(undefined1 *)pTVar5->nPresent = 0xff;
  }
  pcVar7 = msgInfo->sChipData;
  msgInfo->nLength = 0;
  uVar10 = 0x102;
  iVar8 = 0x102;
  bVar11 = ((ulong)pcVar7 & 1) != 0;
  if (bVar11) {
    pcVar7 = msgInfo->sChipData + 1;
    msgInfo->sChipData[0] = '\0';
    uVar10 = 0x101;
    iVar8 = 0x101;
  }
  if (((ulong)pcVar7 & 2) == 0) {
    uVar9 = (uint)uVar10;
    pcVar6 = pcVar7;
  }
  else {
    pcVar6 = pcVar7 + 2;
    uVar9 = iVar8 - 2;
    uVar10 = (ulong)uVar9;
    pcVar7[0] = '\0';
    pcVar7[1] = '\0';
  }
  if (((ulong)pcVar6 & 4) != 0) {
    pcVar6[0] = '\0';
    pcVar6[1] = '\0';
    pcVar6[2] = '\0';
    pcVar6[3] = '\0';
    uVar10 = (ulong)(uVar9 - 4);
    pcVar6 = pcVar6 + 4;
  }
  for (uVar1 = uVar10 >> 3; uVar1 != 0; uVar1 = uVar1 - 1) {
    pcVar6[0] = '\0';
    pcVar6[1] = '\0';
    pcVar6[2] = '\0';
    pcVar6[3] = '\0';
    pcVar6[4] = '\0';
    pcVar6[5] = '\0';
    pcVar6[6] = '\0';
    pcVar6[7] = '\0';
    pcVar6 = pcVar6 + 8;
  }
  if ((uVar10 & 4) != 0) {
    pcVar6[0] = '\0';
    pcVar6[1] = '\0';
    pcVar6[2] = '\0';
    pcVar6[3] = '\0';
    pcVar6 = pcVar6 + 4;
  }
  pcVar7 = pcVar6;
  if ((uVar10 & 2) != 0) {
    pcVar7 = pcVar6 + 2;
    pcVar6[0] = '\0';
    pcVar6[1] = '\0';
  }
  if (bVar11) {
    *pcVar7 = '\0';
  }
  return;
}



// WARNING: Unknown calling convention

int GetNpsTagIndice(char *szTagName)

{
  int iVar1;
  int iVar2;
  tag_info_t *__s2;
  
  __s2 = tab_NpsTagInfo;
  iVar2 = 0;
  do {
    iVar1 = memcmp(szTagName,__s2,4);
    if (iVar1 == 0) {
      return iVar2;
    }
    iVar2 = iVar2 + 1;
    __s2 = __s2 + 1;
  } while (iVar2 != 0x1a);
  return -1;
}



// WARNING: Unknown calling convention

int GetNpsTagType(int nIndice)

{
  return tab_NpsTagInfo[nIndice].nType;
}



// WARNING: Unknown calling convention

int GetNpsTagLength(int nIndice)

{
  return tab_NpsTagInfo[nIndice].nLength;
}



// WARNING: Type propagation algorithm not settling
// WARNING: Unknown calling convention

void InitNpsSubFldInfo(TSSubTagNps *msgInfo)

{
  ulong uVar1;
  int *piVar2;
  int *piVar3;
  TSSubTagNps *pTVar4;
  TSSubTagNps *pTVar5;
  char *pcVar6;
  char *pcVar7;
  int iVar8;
  uint uVar9;
  bool bVar11;
  ulong uVar10;
  
  piVar2 = msgInfo->nPosTag;
  uVar10 = 0xf9c;
  iVar8 = 0xf9c;
  bVar11 = ((ulong)piVar2 & 1) != 0;
  if (bVar11) {
    piVar2 = (int *)((long)msgInfo->nPosTag + 1);
    *(undefined1 *)msgInfo->nPosTag = 0;
    uVar10 = 0xf9b;
    iVar8 = 0xf9b;
  }
  if (((ulong)piVar2 & 2) == 0) {
    uVar9 = (uint)uVar10;
  }
  else {
    uVar9 = iVar8 - 2;
    uVar10 = (ulong)uVar9;
    *(undefined2 *)piVar2 = 0;
    piVar2 = (int *)((long)piVar2 + 2);
  }
  if (((ulong)piVar2 & 4) != 0) {
    *piVar2 = 0;
    uVar10 = (ulong)(uVar9 - 4);
    piVar2 = piVar2 + 1;
  }
  for (uVar1 = uVar10 >> 3; uVar1 != 0; uVar1 = uVar1 - 1) {
    piVar2[0] = 0;
    piVar2[1] = 0;
    piVar2 = piVar2 + 2;
  }
  if ((uVar10 & 4) != 0) {
    *piVar2 = 0;
    piVar2 = piVar2 + 1;
  }
  piVar3 = piVar2;
  if ((uVar10 & 2) != 0) {
    piVar3 = (int *)((long)piVar2 + 2);
    *(undefined2 *)piVar2 = 0;
  }
  if (bVar11) {
    *(undefined1 *)piVar3 = 0;
  }
  bVar11 = ((ulong)msgInfo & 1) != 0;
  uVar10 = 0xf9c;
  iVar8 = 0xf9c;
  if (bVar11) {
    pTVar4 = (TSSubTagNps *)((long)msgInfo->nPresent + 1);
    *(undefined1 *)msgInfo->nPresent = 0xff;
    uVar10 = 0xf9b;
    iVar8 = 0xf9b;
    uVar1 = (ulong)pTVar4 & 2;
  }
  else {
    uVar1 = (ulong)msgInfo & 2;
    pTVar4 = msgInfo;
  }
  if (uVar1 == 0) {
    uVar9 = (uint)uVar10;
  }
  else {
    uVar9 = iVar8 - 2;
    uVar10 = (ulong)uVar9;
    *(undefined2 *)pTVar4->nPresent = 0xffff;
    pTVar4 = (TSSubTagNps *)((long)pTVar4->nPresent + 2);
  }
  if (((ulong)pTVar4 & 4) != 0) {
    pTVar4->nPresent[0] = -1;
    uVar10 = (ulong)(uVar9 - 4);
    pTVar4 = (TSSubTagNps *)(pTVar4->nPresent + 1);
  }
  for (uVar1 = uVar10 >> 3; uVar1 != 0; uVar1 = uVar1 - 1) {
    pTVar4->nPresent[0] = -1;
    pTVar4->nPresent[1] = -1;
    pTVar4 = (TSSubTagNps *)(pTVar4->nPresent + 2);
  }
  if ((uVar10 & 4) != 0) {
    pTVar4->nPresent[0] = -1;
    pTVar4 = (TSSubTagNps *)(pTVar4->nPresent + 1);
  }
  pTVar5 = pTVar4;
  if ((uVar10 & 2) != 0) {
    pTVar5 = (TSSubTagNps *)((long)pTVar4->nPresent + 2);
    *(undefined2 *)pTVar4->nPresent = 0xffff;
  }
  if (bVar11) {
    *(undefined1 *)pTVar5->nPresent = 0xff;
  }
  pcVar7 = msgInfo->sSubData;
  msgInfo->nLength = 0;
  uVar10 = 999;
  iVar8 = 999;
  bVar11 = ((ulong)pcVar7 & 1) != 0;
  if (bVar11) {
    pcVar7 = msgInfo->sSubData + 1;
    msgInfo->sSubData[0] = '\0';
    uVar10 = 0x3e6;
    iVar8 = 0x3e6;
  }
  if (((ulong)pcVar7 & 2) == 0) {
    uVar9 = (uint)uVar10;
    pcVar6 = pcVar7;
  }
  else {
    pcVar6 = pcVar7 + 2;
    uVar9 = iVar8 - 2;
    uVar10 = (ulong)uVar9;
    pcVar7[0] = '\0';
    pcVar7[1] = '\0';
  }
  if (((ulong)pcVar6 & 4) != 0) {
    pcVar6[0] = '\0';
    pcVar6[1] = '\0';
    pcVar6[2] = '\0';
    pcVar6[3] = '\0';
    uVar10 = (ulong)(uVar9 - 4);
    pcVar6 = pcVar6 + 4;
  }
  for (uVar1 = uVar10 >> 3; uVar1 != 0; uVar1 = uVar1 - 1) {
    pcVar6[0] = '\0';
    pcVar6[1] = '\0';
    pcVar6[2] = '\0';
    pcVar6[3] = '\0';
    pcVar6[4] = '\0';
    pcVar6[5] = '\0';
    pcVar6[6] = '\0';
    pcVar6[7] = '\0';
    pcVar6 = pcVar6 + 8;
  }
  if ((uVar10 & 4) != 0) {
    pcVar6[0] = '\0';
    pcVar6[1] = '\0';
    pcVar6[2] = '\0';
    pcVar6[3] = '\0';
    pcVar6 = pcVar6 + 4;
  }
  pcVar7 = pcVar6;
  if ((uVar10 & 2) != 0) {
    pcVar7 = pcVar6 + 2;
    pcVar6[0] = '\0';
    pcVar6[1] = '\0';
  }
  if (!bVar11) {
    *pcVar7 = '\0';
  }
  return;
}



// WARNING: Unknown calling convention

int GetNpsSubTagIndice(char *szTagName)

{
  int iVar1;
  int iVar2;
  
  iVar1 = memcmp(szTagName,tab_NpsSFldInfo,3);
  if (iVar1 == 0) {
    iVar1 = 0;
  }
  else {
    iVar1 = memcmp(szTagName,tab_NpsSFldInfo + 1,3);
    if (iVar1 == 0) {
      iVar1 = 1;
    }
    else {
      iVar1 = memcmp(szTagName,tab_NpsSFldInfo + 2,3);
      if (iVar1 == 0) {
        iVar1 = 2;
      }
      else {
        iVar1 = memcmp(szTagName,tab_NpsSFldInfo + 3,3);
        if (iVar1 == 0) {
          iVar1 = 3;
        }
        else {
          iVar1 = memcmp(szTagName,tab_NpsSFldInfo + 4,3);
          if (iVar1 == 0) {
            iVar1 = 4;
          }
          else {
            iVar1 = memcmp(szTagName,tab_NpsSFldInfo + 5,3);
            if (iVar1 == 0) {
              iVar1 = 5;
            }
            else {
              iVar1 = memcmp(szTagName,tab_NpsSFldInfo + 6,3);
              if (iVar1 == 0) {
                iVar1 = 6;
              }
              else {
                iVar1 = memcmp(szTagName,tab_NpsSFldInfo + 7,3);
                if (iVar1 == 0) {
                  iVar1 = 7;
                }
                else {
                  iVar2 = memcmp(szTagName,tab_NpsSFldInfo + 8,3);
                  iVar1 = -1;
                  if (iVar2 == 0) {
                    iVar1 = 8;
                  }
                }
              }
            }
          }
        }
      }
    }
  }
  return iVar1;
}



// WARNING: Unknown calling convention

int GetNps46SubTagIndice(char *szTagName)

{
  int iVar1;
  int iVar2;
  
  iVar1 = memcmp(szTagName,tab_NpsF46SFldInfo,3);
  if (iVar1 == 0) {
    iVar1 = 0;
  }
  else {
    iVar1 = memcmp(szTagName,tab_NpsF46SFldInfo + 1,3);
    if (iVar1 == 0) {
      iVar1 = 1;
    }
    else {
      iVar2 = memcmp(szTagName,tab_NpsF46SFldInfo + 2,3);
      iVar1 = -1;
      if (iVar2 == 0) {
        iVar1 = 2;
      }
    }
  }
  return iVar1;
}



// WARNING: Unknown calling convention

int GetNpsSubTagType(int nIndice)

{
  return tab_NpsSFldInfo[nIndice].nType;
}



// WARNING: Unknown calling convention

int GetNpsSubTagName(int nIndice,char *szTagName)

{
  *(undefined2 *)szTagName = *(undefined2 *)tab_NpsSFldInfo[nIndice].sTagName;
  szTagName[2] = tab_NpsSFldInfo[nIndice].sTagName[2];
  return 0;
}



// WARNING: Unknown calling convention

int GetNpsSubTagLength(int nIndice)

{
  return tab_NpsSFldInfo[nIndice].nLength;
}



// WARNING: Unknown calling convention

int GetNps46SubTagType(int nIndice)

{
  return tab_NpsF46SFldInfo[nIndice].nType;
}



// WARNING: Unknown calling convention

int GetNps46SubTagName(int nIndice,char *szTagName)

{
  *(undefined2 *)szTagName = *(undefined2 *)tab_NpsF46SFldInfo[nIndice].sTagName;
  szTagName[2] = tab_NpsF46SFldInfo[nIndice].sTagName[2];
  return 0;
}



// WARNING: Unknown calling convention

int GetNps46SubTagLength(int nIndice)

{
  return tab_NpsF46SFldInfo[nIndice].nLength;
}



// WARNING: Type propagation algorithm not settling
// WARNING: Unknown calling convention

void InitNpsInfo(TSNpsInfo *msgInfo)

{
  ulong uVar1;
  TSNpsInfo *pTVar2;
  TSNpsInfo *pTVar3;
  char *pcVar4;
  char *pcVar5;
  int iVar6;
  uint uVar7;
  bool bVar9;
  ulong uVar8;
  
  uVar8 = 0x204;
  iVar6 = 0x204;
  bVar9 = ((ulong)msgInfo & 1) != 0;
  if (bVar9) {
    pTVar3 = (TSNpsInfo *)((long)msgInfo->nFieldPos + 1);
    *(undefined1 *)msgInfo->nFieldPos = 0;
    uVar8 = 0x203;
    iVar6 = 0x203;
    uVar1 = (ulong)pTVar3 & 2;
  }
  else {
    uVar1 = (ulong)msgInfo & 2;
    pTVar3 = msgInfo;
  }
  if (uVar1 == 0) {
    uVar7 = (uint)uVar8;
    pTVar2 = pTVar3;
  }
  else {
    pTVar2 = (TSNpsInfo *)((long)pTVar3->nFieldPos + 2);
    uVar7 = iVar6 - 2;
    uVar8 = (ulong)uVar7;
    *(undefined2 *)pTVar3->nFieldPos = 0;
  }
  if (((ulong)pTVar2 & 4) != 0) {
    pTVar2->nFieldPos[0] = 0;
    uVar8 = (ulong)(uVar7 - 4);
    pTVar2 = (TSNpsInfo *)(pTVar2->nFieldPos + 1);
  }
  for (uVar1 = uVar8 >> 3; uVar1 != 0; uVar1 = uVar1 - 1) {
    pTVar2->nFieldPos[0] = 0;
    pTVar2->nFieldPos[1] = 0;
    pTVar2 = (TSNpsInfo *)(pTVar2->nFieldPos + 2);
  }
  if ((uVar8 & 4) != 0) {
    pTVar2->nFieldPos[0] = 0;
    pTVar2 = (TSNpsInfo *)(pTVar2->nFieldPos + 1);
  }
  pTVar3 = pTVar2;
  if ((uVar8 & 2) != 0) {
    pTVar3 = (TSNpsInfo *)((long)pTVar2->nFieldPos + 2);
    *(undefined2 *)pTVar2->nFieldPos = 0;
  }
  if (bVar9) {
    *(undefined1 *)pTVar3->nFieldPos = 0;
  }
  pcVar4 = msgInfo->sData;
  msgInfo->sBitMap[0] = '\0';
  msgInfo->sBitMap[1] = '\0';
  msgInfo->sBitMap[2] = '\0';
  msgInfo->sBitMap[3] = '\0';
  msgInfo->sBitMap[4] = '\0';
  msgInfo->sBitMap[5] = '\0';
  msgInfo->sBitMap[6] = '\0';
  msgInfo->sBitMap[7] = '\0';
  msgInfo->sBitMap[8] = '\0';
  msgInfo->sBitMap[9] = '\0';
  msgInfo->sBitMap[10] = '\0';
  msgInfo->sBitMap[0xb] = '\0';
  msgInfo->sBitMap[0xc] = '\0';
  msgInfo->sBitMap[0xd] = '\0';
  msgInfo->sBitMap[0xe] = '\0';
  msgInfo->sBitMap[0xf] = '\0';
  msgInfo->nLength = 0;
  msgInfo->nMsgType = 0;
  uVar8 = 0x800;
  iVar6 = 0x800;
  bVar9 = ((ulong)pcVar4 & 1) != 0;
  if (bVar9) {
    pcVar4 = msgInfo->sData + 1;
    msgInfo->sData[0] = '\0';
    uVar8 = 0x7ff;
    iVar6 = 0x7ff;
  }
  if (((ulong)pcVar4 & 2) == 0) {
    uVar7 = (uint)uVar8;
  }
  else {
    uVar7 = iVar6 - 2;
    uVar8 = (ulong)uVar7;
    pcVar4[0] = '\0';
    pcVar4[1] = '\0';
    pcVar4 = pcVar4 + 2;
  }
  if (((ulong)pcVar4 & 4) != 0) {
    pcVar4[0] = '\0';
    pcVar4[1] = '\0';
    pcVar4[2] = '\0';
    pcVar4[3] = '\0';
    uVar8 = (ulong)(uVar7 - 4);
    pcVar4 = pcVar4 + 4;
  }
  for (uVar1 = uVar8 >> 3; uVar1 != 0; uVar1 = uVar1 - 1) {
    pcVar4[0] = '\0';
    pcVar4[1] = '\0';
    pcVar4[2] = '\0';
    pcVar4[3] = '\0';
    pcVar4[4] = '\0';
    pcVar4[5] = '\0';
    pcVar4[6] = '\0';
    pcVar4[7] = '\0';
    pcVar4 = pcVar4 + 8;
  }
  if ((uVar8 & 4) != 0) {
    pcVar4[0] = '\0';
    pcVar4[1] = '\0';
    pcVar4[2] = '\0';
    pcVar4[3] = '\0';
    pcVar4 = pcVar4 + 4;
  }
  pcVar5 = pcVar4;
  if ((uVar8 & 2) != 0) {
    pcVar5 = pcVar4 + 2;
    pcVar4[0] = '\0';
    pcVar4[1] = '\0';
  }
  if (bVar9) {
    *pcVar5 = '\0';
  }
  msgInfo->sHeader[0] = '\0';
  return;
}



// WARNING: Unknown calling convention

int GetNpsFieldType(int field_no)

{
  return tab_NpsFldInfo[field_no].type;
}



// WARNING: Unknown calling convention

int GetNpsFieldLength(int field_no)

{
  return tab_NpsFldInfo[field_no].length;
}



// WARNING: Type propagation algorithm not settling
// WARNING: Unknown calling convention

void InitNpsF127Info(TSNpsF127Info *msgInfo)

{
  ulong uVar1;
  int iVar2;
  TSNpsF127Info *pTVar4;
  TSNpsF127Info *pTVar5;
  char *pcVar6;
  char *pcVar7;
  uint uVar8;
  bool bVar9;
  ulong uVar3;
  
  uVar3 = 0x54;
  iVar2 = 0x54;
  bVar9 = ((ulong)msgInfo & 1) != 0;
  if (bVar9) {
    pTVar4 = (TSNpsF127Info *)((long)msgInfo->nFieldPos + 1);
    *(undefined1 *)msgInfo->nFieldPos = 0;
    uVar3 = 0x53;
    iVar2 = 0x53;
    uVar1 = (ulong)pTVar4 & 2;
  }
  else {
    uVar1 = (ulong)msgInfo & 2;
    pTVar4 = msgInfo;
  }
  if (uVar1 == 0) {
    uVar8 = (uint)uVar3;
  }
  else {
    uVar8 = iVar2 - 2;
    uVar3 = (ulong)uVar8;
    *(undefined2 *)pTVar4->nFieldPos = 0;
    pTVar4 = (TSNpsF127Info *)((long)pTVar4->nFieldPos + 2);
  }
  if (((ulong)pTVar4 & 4) != 0) {
    pTVar4->nFieldPos[0] = 0;
    uVar3 = (ulong)(uVar8 - 4);
    pTVar4 = (TSNpsF127Info *)(pTVar4->nFieldPos + 1);
  }
  for (uVar1 = uVar3 >> 3; uVar1 != 0; uVar1 = uVar1 - 1) {
    pTVar4->nFieldPos[0] = 0;
    pTVar4->nFieldPos[1] = 0;
    pTVar4 = (TSNpsF127Info *)(pTVar4->nFieldPos + 2);
  }
  if ((uVar3 & 4) != 0) {
    pTVar4->nFieldPos[0] = 0;
    pTVar4 = (TSNpsF127Info *)(pTVar4->nFieldPos + 1);
  }
  pTVar5 = pTVar4;
  if ((uVar3 & 2) != 0) {
    pTVar5 = (TSNpsF127Info *)((long)pTVar4->nFieldPos + 2);
    *(undefined2 *)pTVar4->nFieldPos = 0;
  }
  if (bVar9) {
    *(undefined1 *)pTVar5->nFieldPos = 0;
  }
  pcVar6 = msgInfo->sData;
  msgInfo->sBitMap[0] = '\0';
  msgInfo->sBitMap[1] = '\0';
  msgInfo->sBitMap[2] = '\0';
  msgInfo->sBitMap[3] = '\0';
  msgInfo->sBitMap[4] = '\0';
  msgInfo->sBitMap[5] = '\0';
  msgInfo->sBitMap[6] = '\0';
  msgInfo->sBitMap[7] = '\0';
  msgInfo->sBitMap[8] = '\0';
  msgInfo->sBitMap[9] = '\0';
  msgInfo->sBitMap[10] = '\0';
  msgInfo->sBitMap[0xb] = '\0';
  msgInfo->sBitMap[0xc] = '\0';
  msgInfo->sBitMap[0xd] = '\0';
  msgInfo->sBitMap[0xe] = '\0';
  msgInfo->sBitMap[0xf] = '\0';
  msgInfo->sBitMap[0x10] = '\0';
  msgInfo->sBitMap[0x11] = '\0';
  msgInfo->sBitMap[0x12] = '\0';
  msgInfo->sBitMap[0x13] = '\0';
  msgInfo->sBitMap[0x14] = '\0';
  msgInfo->sBitMap[0x15] = '\0';
  msgInfo->sBitMap[0x16] = '\0';
  msgInfo->sBitMap[0x17] = '\0';
  msgInfo->nLength = 0;
  uVar3 = 0x800;
  iVar2 = 0x800;
  bVar9 = ((ulong)pcVar6 & 1) != 0;
  msgInfo->nMsgType = 0;
  if (bVar9) {
    pcVar6 = msgInfo->sData + 1;
    msgInfo->sData[0] = '\0';
    uVar3 = 0x7ff;
    iVar2 = 0x7ff;
  }
  if (((ulong)pcVar6 & 2) == 0) {
    uVar8 = (uint)uVar3;
  }
  else {
    uVar8 = iVar2 - 2;
    uVar3 = (ulong)uVar8;
    pcVar6[0] = '\0';
    pcVar6[1] = '\0';
    pcVar6 = pcVar6 + 2;
  }
  if (((ulong)pcVar6 & 4) != 0) {
    pcVar6[0] = '\0';
    pcVar6[1] = '\0';
    pcVar6[2] = '\0';
    pcVar6[3] = '\0';
    uVar3 = (ulong)(uVar8 - 4);
    pcVar6 = pcVar6 + 4;
  }
  for (uVar1 = uVar3 >> 3; uVar1 != 0; uVar1 = uVar1 - 1) {
    pcVar6[0] = '\0';
    pcVar6[1] = '\0';
    pcVar6[2] = '\0';
    pcVar6[3] = '\0';
    pcVar6[4] = '\0';
    pcVar6[5] = '\0';
    pcVar6[6] = '\0';
    pcVar6[7] = '\0';
    pcVar6 = pcVar6 + 8;
  }
  if ((uVar3 & 4) != 0) {
    pcVar6[0] = '\0';
    pcVar6[1] = '\0';
    pcVar6[2] = '\0';
    pcVar6[3] = '\0';
    pcVar6 = pcVar6 + 4;
  }
  pcVar7 = pcVar6;
  if ((uVar3 & 2) != 0) {
    pcVar7 = pcVar6 + 2;
    pcVar6[0] = '\0';
    pcVar6[1] = '\0';
  }
  if (bVar9) {
    *pcVar7 = '\0';
  }
  msgInfo->sHeader[0] = '\0';
  msgInfo->sHeader[1] = '\0';
  msgInfo->sHeader[2] = '\0';
  msgInfo->sHeader[3] = '\0';
  msgInfo->sHeader[4] = '\0';
  msgInfo->sHeader[5] = '\0';
  msgInfo->sHeader[6] = '\0';
  msgInfo->sHeader[7] = '\0';
  msgInfo->sHeader[8] = '\0';
  msgInfo->sHeader[9] = '\0';
  msgInfo->sHeader[10] = '\0';
  msgInfo->sHeader[0xb] = '\0';
  msgInfo->sHeader[0xc] = '\0';
  msgInfo->sHeader[0xd] = '\0';
  msgInfo->sHeader[0xe] = '\0';
  msgInfo->sHeader[0xf] = '\0';
  return;
}



// WARNING: Unknown calling convention

int GetNpsF127FieldType(int field_no)

{
  return tab_NpsF127FldInfo[field_no].type;
}



// WARNING: Unknown calling convention

int GetNpsF127FieldLength(int field_no)

{
  return tab_NpsF127FldInfo[field_no].length;
}



// WARNING: Unknown calling convention

int AnalyseNps(char *buffer_rec,TSNpsInfo *msgInfo)

{
  int *piVar1;
  uint uVar2;
  undefined4 uVar3;
  uint3 uVar4;
  undefined2 uVar5;
  undefined2 uVar6;
  int iVar7;
  uint uVar8;
  uint uVar9;
  long lVar10;
  ulong uVar11;
  int *piVar12;
  uint3 *puVar13;
  uint uVar14;
  char *pcVar15;
  char *pcVar16;
  int nBitNbr;
  uint3 *puVar17;
  bool bVar18;
  byte bVar19;
  int local_39c;
  char szNpsFldLen [4];
  char szBcdFldLen [4];
  char szNpsMsgType [5];
  char Binary_bit_map [17];
  char sWork [256];
  char sLine [512];
  
  bVar19 = 0;
  InitNpsInfo(msgInfo);
  pcVar15 = sWork;
  for (lVar10 = 0x20; lVar10 != 0; lVar10 = lVar10 + -1) {
    pcVar15[0] = '\0';
    pcVar15[1] = '\0';
    pcVar15[2] = '\0';
    pcVar15[3] = '\0';
    pcVar15[4] = '\0';
    pcVar15[5] = '\0';
    pcVar15[6] = '\0';
    pcVar15[7] = '\0';
    pcVar15 = pcVar15 + (ulong)bVar19 * -0x10 + 8;
  }
  szNpsMsgType[0] = '\0';
  szNpsMsgType[1] = '\0';
  szNpsMsgType[2] = '\0';
  szNpsMsgType[3] = '\0';
  szNpsMsgType[4] = '\0';
  szNpsFldLen[0] = '\0';
  szNpsFldLen[1] = '\0';
  szNpsFldLen[2] = '\0';
  szNpsFldLen[3] = '\0';
  szBcdFldLen[0] = '\0';
  szBcdFldLen[1] = '\0';
  szBcdFldLen[2] = '\0';
  szBcdFldLen[3] = '\0';
  pcVar15 = sLine;
  for (lVar10 = 0x40; lVar10 != 0; lVar10 = lVar10 + -1) {
    pcVar15[0] = '\0';
    pcVar15[1] = '\0';
    pcVar15[2] = '\0';
    pcVar15[3] = '\0';
    pcVar15[4] = '\0';
    pcVar15[5] = '\0';
    pcVar15[6] = '\0';
    pcVar15[7] = '\0';
    pcVar15 = pcVar15 + (ulong)bVar19 * -0x10 + 8;
  }
  sprintf(sLine,"Start AnalyseNps ()",8);
  trace_event(sLine,0);
  szNpsMsgType._0_4_ = *(undefined4 *)buffer_rec;
  szNpsMsgType[4] = '\0';
  lVar10 = strtol(szNpsMsgType,(char **)0x0,10);
  msgInfo->nMsgType = (int)lVar10;
  local_39c = ((int)buffer_rec[4] >> 0x1f & 0x40U) + 0x40;
  uVar2 = ~((int)buffer_rec[4] >> 0x1f) + 2;
  memcpy(msgInfo->sBitMap,buffer_rec + 4,8);
  puVar17 = (uint3 *)(buffer_rec + 0xc);
  sprintf(sLine,"iMapCtr=[%d]",(ulong)uVar2);
  trace_event(sLine,0);
  pcVar15 = msgInfo->sData;
  uVar9 = 0x800;
  iVar7 = 0x800;
  bVar18 = ((ulong)pcVar15 & 1) != 0;
  puVar13 = puVar17;
  if (bVar18) {
    pcVar15 = msgInfo->sData + 1;
    msgInfo->sData[0] = (char)*puVar17;
    uVar9 = 0x7ff;
    iVar7 = 0x7ff;
    puVar13 = (uint3 *)(buffer_rec + 0xd);
  }
  if (((ulong)pcVar15 & 2) != 0) {
    uVar4 = *puVar13;
    puVar13 = (uint3 *)((long)puVar13 + 2);
    uVar9 = iVar7 - 2;
    *(short *)pcVar15 = (short)uVar4;
    pcVar15 = pcVar15 + 2;
  }
  pcVar16 = pcVar15;
  if (((ulong)pcVar15 & 4) != 0) {
    uVar3 = *(undefined4 *)puVar13;
    pcVar16 = pcVar15 + 4;
    puVar13 = puVar13 + 1;
    uVar9 = uVar9 - 4;
    *(undefined4 *)pcVar15 = uVar3;
  }
  lVar10 = 0;
  for (uVar11 = (ulong)(uVar9 >> 3); uVar11 != 0; uVar11 = uVar11 - 1) {
    *(undefined8 *)pcVar16 = *(undefined8 *)puVar13;
    puVar13 = puVar13 + (ulong)bVar19 * -4 + 2;
    pcVar16 = pcVar16 + (ulong)bVar19 * -0x10 + 8;
  }
  if ((uVar9 & 4) != 0) {
    *(undefined4 *)pcVar16 = *(undefined4 *)puVar13;
    lVar10 = 4;
  }
  if ((uVar9 & 2) != 0) {
    *(undefined2 *)(pcVar16 + lVar10) = *(undefined2 *)((long)puVar13 + lVar10);
    lVar10 = lVar10 + 2;
  }
  if (bVar18) {
    pcVar16[lVar10] = *(char *)((long)puVar13 + lVar10);
  }
  iVar7 = 0;
LAB_0041bcb0:
  do {
    nBitNbr = iVar7;
    szNpsFldLen[0] = '\0';
    szNpsFldLen[1] = '\0';
    szNpsFldLen[2] = '\0';
    szNpsFldLen[3] = '\0';
    szBcdFldLen[0] = '\0';
    szBcdFldLen[1] = '\0';
    szBcdFldLen[2] = '\0';
    szBcdFldLen[3] = '\0';
    iVar7 = CheckBit(msgInfo->sBitMap,nBitNbr);
    if (iVar7 == 0) goto LAB_0041bc90;
    iVar7 = GetNpsFieldType(nBitNbr);
    uVar6 = szBcdFldLen._2_2_;
    uVar5 = szNpsFldLen._2_2_;
    switch(iVar7) {
    case 0:
    case 0xc:
      iVar7 = GetNpsFieldLength(nBitNbr);
      iVar7 = (iVar7 + 1) / 2;
      break;
    case 1:
    case 2:
      iVar7 = GetNpsFieldLength(nBitNbr);
      break;
    case 3:
      szNpsFldLen[0] = (char)(short)*puVar17;
      szNpsFldLen[1] = (char)((ushort)(short)*puVar17 >> 8);
      szNpsFldLen = (char  [4])CONCAT22(uVar5,szNpsFldLen._0_2_);
      goto LAB_0041beb8;
    case 4:
    case 5:
      szNpsFldLen = (char  [4])((uint)(byte)szNpsFldLen[3] << 0x18);
      szNpsFldLen[0] = (char)(short)*puVar17;
      szNpsFldLen[1] = (char)((ushort)(short)*puVar17 >> 8);
      goto LAB_0041bd11;
    case 6:
      szNpsFldLen._0_3_ = *puVar17;
      lVar10 = strtol(szNpsFldLen,(char **)0x0,10);
      iVar7 = ((int)lVar10 + 1) / 2 + 3;
      break;
    case 7:
    case 8:
      szNpsFldLen[3] = '\0';
      szNpsFldLen._0_3_ = *puVar17;
      lVar10 = strtol(szNpsFldLen,(char **)0x0,10);
      iVar7 = (int)lVar10 + 3;
      break;
    default:
      msgInfo->nFieldPos[nBitNbr + 1] = msgInfo->nFieldPos[nBitNbr];
      lVar10 = 0;
      goto LAB_0041bd37;
    case 0xb:
      szBcdFldLen[0] = (char)*puVar17;
      iVar7 = BcdToAscii((uchar *)szBcdFldLen,(uchar *)szNpsFldLen,2);
      lVar10 = strtol(szNpsFldLen,(char **)0x0,10);
      iVar7 = ((int)lVar10 + 1) / 2 + iVar7;
      break;
    case 0xd:
      szBcdFldLen[0] = (char)(short)*puVar17;
      szBcdFldLen[1] = (char)((ushort)(short)*puVar17 >> 8);
      szBcdFldLen = (char  [4])CONCAT22(uVar6,szBcdFldLen._0_2_);
      BcdToAscii((uchar *)szBcdFldLen,(uchar *)szNpsFldLen,3);
LAB_0041beb8:
      lVar10 = strtol(szNpsFldLen,(char **)0x0,10);
      iVar7 = ((int)lVar10 + 1) / 2 + 2;
      break;
    case 0xe:
      szBcdFldLen[0] = (char)*puVar17;
      BcdToAscii((uchar *)szBcdFldLen,(uchar *)szNpsFldLen,2);
      lVar10 = strtol(szNpsFldLen,(char **)0x0,10);
      iVar7 = (int)lVar10 + 1;
      break;
    case 0xf:
    case 0x10:
      szBcdFldLen[0] = (char)(short)*puVar17;
      szBcdFldLen[1] = (char)((ushort)(short)*puVar17 >> 8);
      szBcdFldLen = (char  [4])CONCAT22(uVar6,szBcdFldLen._0_2_);
      BcdToAscii((uchar *)szBcdFldLen,(uchar *)szNpsFldLen,3);
LAB_0041bd11:
      lVar10 = strtol(szNpsFldLen,(char **)0x0,10);
      iVar7 = (int)lVar10 + 2;
    }
    lVar10 = (long)iVar7;
    msgInfo->nFieldPos[nBitNbr + 1] = msgInfo->nFieldPos[nBitNbr] + iVar7;
LAB_0041bd37:
    puVar17 = (uint3 *)((long)puVar17 + lVar10);
    iVar7 = nBitNbr + 1;
  } while (nBitNbr + 1 != 0x80);
  goto LAB_0041bd4a;
LAB_0041bc90:
  iVar7 = nBitNbr + 1;
  msgInfo->nFieldPos[iVar7] = msgInfo->nFieldPos[nBitNbr];
  if (iVar7 == 0x80) goto LAB_0041bd4a;
  goto LAB_0041bcb0;
LAB_0041bd4a:
  piVar1 = msgInfo->nFieldPos + local_39c;
  msgInfo->nLength = *piVar1;
  if (local_39c != 0x80) {
    uVar9 = (nBitNbr + 1) - local_39c;
    if (uVar9 < 0xc) {
      do {
        local_39c = local_39c + 1;
        msgInfo->nFieldPos[local_39c] = *piVar1;
      } while (local_39c != 0x80);
    }
    else {
      uVar14 = uVar9 >> 2;
      if (uVar14 != 0) {
        uVar8 = 0;
        piVar12 = msgInfo->nFieldPos + (long)local_39c + 1;
        do {
          iVar7 = *piVar1;
          uVar8 = uVar8 + 1;
          *piVar12 = iVar7;
          piVar12[1] = iVar7;
          piVar12[2] = iVar7;
          piVar12[3] = iVar7;
          piVar12 = piVar12 + 4;
        } while (uVar8 < uVar14);
        local_39c = local_39c + uVar14 * 4;
        if (uVar9 == uVar14 * 4) goto LAB_0041be09;
      }
      msgInfo->nFieldPos[local_39c + 1] = *piVar1;
      if ((local_39c != 0x7f) && (msgInfo->nFieldPos[local_39c + 2] = *piVar1, local_39c != 0x7e)) {
        msgInfo->nFieldPos[local_39c + 3] = *piVar1;
      }
    }
  }
LAB_0041be09:
  sprintf(sLine,"End AnalyseNps (%d)",(ulong)uVar2);
  trace_event(sLine,0);
  return 0;
}



// WARNING: Unknown calling convention

int AnalyseNpsF127(char *buffer_rec,TSNpsF127Info *msgInfo)

{
  char *cPtr;
  undefined2 uVar1;
  undefined4 uVar2;
  char *pcVar3;
  int *piVar4;
  int iVar5;
  int iVar6;
  ulong uVar7;
  long lVar8;
  uint uVar9;
  ulong uVar10;
  int iVar11;
  char *pcVar12;
  char *pcVar13;
  char *pcVar14;
  bool bVar15;
  byte bVar16;
  char szNpsF127FldLen [4];
  
  bVar16 = 0;
  pcVar14 = buffer_rec + 8;
  cPtr = msgInfo->sBitMap;
  InitNpsF127Info(msgInfo);
  pcVar3 = msgInfo->sData;
  uVar10 = 0x800;
  iVar11 = 0x800;
  bVar15 = ((ulong)pcVar3 & 1) != 0;
  *(undefined8 *)msgInfo->sBitMap = *(undefined8 *)buffer_rec;
  pcVar12 = pcVar14;
  if (bVar15) {
    pcVar3 = msgInfo->sData + 1;
    uVar10 = 0x7ff;
    iVar11 = 0x7ff;
    msgInfo->sData[0] = buffer_rec[8];
    pcVar12 = buffer_rec + 9;
  }
  if (((ulong)pcVar3 & 2) == 0) {
    uVar9 = (uint)uVar10;
  }
  else {
    uVar1 = *(undefined2 *)pcVar12;
    pcVar12 = pcVar12 + 2;
    uVar9 = iVar11 - 2;
    uVar10 = (ulong)uVar9;
    *(undefined2 *)pcVar3 = uVar1;
    pcVar3 = pcVar3 + 2;
  }
  pcVar13 = pcVar3;
  if (((ulong)pcVar3 & 4) != 0) {
    uVar2 = *(undefined4 *)pcVar12;
    pcVar13 = pcVar3 + 4;
    pcVar12 = pcVar12 + 4;
    uVar10 = (ulong)(uVar9 - 4);
    *(undefined4 *)pcVar3 = uVar2;
  }
  for (uVar7 = uVar10 >> 3; uVar7 != 0; uVar7 = uVar7 - 1) {
    *(undefined8 *)pcVar13 = *(undefined8 *)pcVar12;
    pcVar12 = pcVar12 + (ulong)bVar16 * -0x10 + 8;
    pcVar13 = pcVar13 + (ulong)bVar16 * -0x10 + 8;
  }
  lVar8 = 0;
  if ((uVar10 & 4) != 0) {
    *(undefined4 *)pcVar13 = *(undefined4 *)pcVar12;
    lVar8 = 4;
  }
  if ((uVar10 & 2) != 0) {
    *(undefined2 *)(pcVar13 + lVar8) = *(undefined2 *)(pcVar12 + lVar8);
    lVar8 = lVar8 + 2;
  }
  if (bVar15) {
    pcVar13[lVar8] = pcVar12[lVar8];
  }
  iVar11 = 1;
  do {
    while( true ) {
      iVar6 = iVar11 + -1;
      iVar5 = CheckBit(cPtr,iVar6);
      if (iVar5 != 0) break;
      piVar4 = msgInfo->nFieldPos;
      iVar11 = iVar11 + 1;
      msgInfo = (TSNpsF127Info *)(msgInfo->nFieldPos + 1);
      msgInfo->nFieldPos[0] = *piVar4;
      if (iVar11 == 0x15) {
        return 0;
      }
    }
    iVar5 = GetNpsF127FieldType(iVar6);
    switch(iVar5) {
    case 0:
      iVar6 = GetNpsF127FieldLength(iVar6);
      iVar6 = (iVar6 + 1) / 2;
      lVar8 = (long)iVar6;
      msgInfo->nFieldPos[1] = msgInfo->nFieldPos[0] + iVar6;
      break;
    case 1:
    case 2:
      iVar6 = GetNpsF127FieldLength(iVar6);
      lVar8 = (long)iVar6;
      msgInfo->nFieldPos[1] = msgInfo->nFieldPos[0] + iVar6;
      break;
    case 3:
      szNpsF127FldLen._0_2_ = *(undefined2 *)pcVar14;
      lVar8 = strtol(szNpsF127FldLen,(char **)0x0,10);
      iVar6 = ((int)lVar8 + 1) / 2;
      goto LAB_0041c1f1;
    case 4:
      szNpsF127FldLen._0_2_ = *(undefined2 *)pcVar14;
      goto LAB_0041c1ec;
    case 5:
      szNpsF127FldLen._0_2_ = *(undefined2 *)pcVar14;
LAB_0041c1ec:
      szNpsF127FldLen[2] = '\0';
      lVar8 = strtol(szNpsF127FldLen,(char **)0x0,10);
      iVar6 = (int)lVar8;
LAB_0041c1f1:
      lVar8 = (long)(iVar6 + 2);
      msgInfo->nFieldPos[1] = msgInfo->nFieldPos[0] + iVar6 + 2;
      break;
    case 6:
      szNpsF127FldLen._0_2_ = *(undefined2 *)pcVar14;
      szNpsF127FldLen[2] = pcVar14[2];
      lVar8 = strtol(szNpsF127FldLen,(char **)0x0,10);
      iVar6 = ((int)lVar8 + 1) / 2;
      goto LAB_0041c166;
    case 7:
      szNpsF127FldLen._0_2_ = *(undefined2 *)pcVar14;
      szNpsF127FldLen[2] = pcVar14[2];
      goto LAB_0041c161;
    case 8:
      szNpsF127FldLen._0_2_ = *(undefined2 *)pcVar14;
      szNpsF127FldLen[2] = pcVar14[2];
LAB_0041c161:
      szNpsF127FldLen[3] = '\0';
      lVar8 = strtol(szNpsF127FldLen,(char **)0x0,10);
      iVar6 = (int)lVar8;
LAB_0041c166:
      lVar8 = (long)(iVar6 + 3);
      msgInfo->nFieldPos[1] = msgInfo->nFieldPos[0] + iVar6 + 3;
      break;
    default:
      msgInfo->nFieldPos[1] = msgInfo->nFieldPos[0];
      lVar8 = 0;
    }
    iVar11 = iVar11 + 1;
    pcVar14 = pcVar14 + lVar8;
    msgInfo = (TSNpsF127Info *)(msgInfo->nFieldPos + 1);
    if (iVar11 == 0x15) {
      return 0;
    }
  } while( true );
}



// WARNING: Unknown calling convention

int AnalyseNpsIc(char *buffer,int nLength,TSTagNps *tagInfo)

{
  int iVar1;
  int iVar2;
  int iVar3;
  long lVar4;
  char szTagName [5];
  
  InitNpsIcTag(tagInfo);
  tagInfo->nLength = nLength;
  iVar2 = 0;
  memcpy(tagInfo->sChipData,buffer,(long)nLength);
  if (0 < nLength) {
    do {
      builtin_strncpy(szTagName,"0000",4);
      if ((*buffer & 0x1fU) == 0x1f) {
        HexToAscii((uchar *)buffer,(uchar *)szTagName,4);
        lVar4 = 2;
        iVar3 = 3;
      }
      else {
        lVar4 = 1;
        iVar3 = 2;
        HexToAscii((uchar *)buffer,(uchar *)szTagName,2);
      }
      iVar1 = GetNpsTagIndice(szTagName);
      if (-1 < iVar1) {
        (tagInfo->nPresent + iVar1)[100] = iVar2;
        tagInfo->nPresent[iVar1] = 0;
      }
      iVar2 = iVar2 + iVar3 + (char)((byte *)buffer)[lVar4];
      buffer = (char *)((byte *)buffer + (iVar3 + (char)((byte *)buffer)[lVar4]));
    } while (iVar2 < nLength);
  }
  return 0;
}



// WARNING: Unknown calling convention

int AnalyseNpsSubFld(char *buffer_rec,int nLength,TSSubTagNps *msgInfo)

{
  int iVar1;
  long lVar2;
  char *pcVar3;
  int iVar4;
  char szNpsSubFldLen [4];
  char szTagName [4];
  char sLine [512];
  
  iVar4 = 0;
  szNpsSubFldLen[0] = '\0';
  szNpsSubFldLen[1] = '\0';
  szNpsSubFldLen[2] = '\0';
  szNpsSubFldLen[3] = '\0';
  szTagName[0] = '\0';
  szTagName[1] = '\0';
  szTagName[2] = '\0';
  szTagName[3] = '\0';
  pcVar3 = sLine;
  for (lVar2 = 0x40; lVar2 != 0; lVar2 = lVar2 + -1) {
    pcVar3[0] = '\0';
    pcVar3[1] = '\0';
    pcVar3[2] = '\0';
    pcVar3[3] = '\0';
    pcVar3[4] = '\0';
    pcVar3[5] = '\0';
    pcVar3[6] = '\0';
    pcVar3[7] = '\0';
    pcVar3 = pcVar3 + 8;
  }
  InitNpsSubFldInfo(msgInfo);
  memcpy(msgInfo->sSubData,buffer_rec,(long)nLength);
  msgInfo->nLength = nLength;
  do {
    szNpsSubFldLen[0] = '\0';
    szNpsSubFldLen[1] = '\0';
    szNpsSubFldLen[2] = '0';
    szNpsSubFldLen[0] = '0';
    szNpsSubFldLen[1] = '0';
    szTagName._0_3_ = *(undefined3 *)buffer_rec;
    iVar1 = GetNpsSubTagIndice(szTagName);
    if (-1 < iVar1) {
      (msgInfo->nPresent + iVar1)[300] = iVar4;
      msgInfo->nPresent[iVar1] = 0;
      szNpsSubFldLen._0_3_ = *(undefined3 *)(buffer_rec + 3);
    }
    lVar2 = strtol(szNpsSubFldLen,(char **)0x0,10);
    iVar4 = iVar4 + 1;
    buffer_rec = buffer_rec + ((int)lVar2 + 6);
  } while (iVar4 != 300);
  return 0;
}



// WARNING: Unknown calling convention

int AnalyseNpsF46SubFld(char *buffer_rec,int nLength,TSSubTagNps *msgInfo)

{
  int iVar1;
  long lVar2;
  char *pcVar3;
  int iVar4;
  int iVar5;
  char szNpsSubFldLen [4];
  char szTagName [4];
  char sLine [512];
  
  iVar5 = 0;
  iVar4 = 300;
  szNpsSubFldLen[0] = '\0';
  szNpsSubFldLen[1] = '\0';
  szNpsSubFldLen[2] = '\0';
  szNpsSubFldLen[3] = '\0';
  szTagName[0] = '\0';
  szTagName[1] = '\0';
  szTagName[2] = '\0';
  szTagName[3] = '\0';
  pcVar3 = sLine;
  for (lVar2 = 0x40; lVar2 != 0; lVar2 = lVar2 + -1) {
    pcVar3[0] = '\0';
    pcVar3[1] = '\0';
    pcVar3[2] = '\0';
    pcVar3[3] = '\0';
    pcVar3[4] = '\0';
    pcVar3[5] = '\0';
    pcVar3[6] = '\0';
    pcVar3[7] = '\0';
    pcVar3 = pcVar3 + 8;
  }
  InitNpsSubFldInfo(msgInfo);
  memcpy(msgInfo->sSubData,buffer_rec,(long)nLength);
  msgInfo->nLength = nLength;
  do {
    szNpsSubFldLen[0] = '\0';
    szNpsSubFldLen[1] = '\0';
    szNpsSubFldLen[2] = '0';
    szNpsSubFldLen[0] = '0';
    szNpsSubFldLen[1] = '0';
    szTagName._0_3_ = *(undefined3 *)buffer_rec;
    iVar1 = GetNps46SubTagIndice(szTagName);
    if (-1 < iVar1) {
      (msgInfo->nPresent + iVar1)[300] = iVar5;
      msgInfo->nPresent[iVar1] = 0;
      szNpsSubFldLen._0_3_ = *(undefined3 *)(buffer_rec + 3);
    }
    lVar2 = strtol(szNpsSubFldLen,(char **)0x0,10);
    iVar5 = iVar5 + 6 + (int)lVar2;
    lVar2 = strtol(szNpsSubFldLen,(char **)0x0,10);
    buffer_rec = buffer_rec + ((int)lVar2 + 6);
    iVar4 = iVar4 + -1;
  } while (iVar4 != 0);
  return 0;
}



// WARNING: Unknown calling convention

int GetNpsField(int field_no,TSNpsInfo *msgInfo,char *data,int *nLength)

{
  undefined2 uVar1;
  undefined2 uVar2;
  int iVar3;
  int nLng;
  long lVar4;
  char *pcVar5;
  size_t __n;
  int *piVar6;
  char szNpsFldLen [4];
  char szBcdFldLen [4];
  
  szNpsFldLen[0] = '\0';
  szNpsFldLen[1] = '\0';
  szNpsFldLen[2] = '\0';
  szNpsFldLen[3] = '\0';
  szBcdFldLen[0] = '\0';
  szBcdFldLen[1] = '\0';
  szBcdFldLen[2] = '\0';
  szBcdFldLen[3] = '\0';
  iVar3 = CheckBit(msgInfo->sBitMap,field_no);
  if (iVar3 == 0) {
    return -1;
  }
  iVar3 = GetNpsFieldType(field_no);
  uVar2 = szBcdFldLen._2_2_;
  uVar1 = szNpsFldLen._2_2_;
  switch(iVar3) {
  case 0:
    nLng = GetNpsFieldLength(field_no);
    HexToAscii((uchar *)(msgInfo->sData + msgInfo->nFieldPos[field_no]),(uchar *)data,nLng);
    data[nLng] = '\0';
    *nLength = nLng;
    break;
  case 1:
  case 2:
    iVar3 = GetNpsFieldLength(field_no);
    memcpy(data,msgInfo->sData + msgInfo->nFieldPos[field_no],(long)iVar3);
    data[iVar3] = '\0';
    *nLength = iVar3;
    iVar3 = 0;
    break;
  case 3:
    szNpsFldLen._0_2_ = *(undefined2 *)(msgInfo->sData + msgInfo->nFieldPos[field_no]);
    szNpsFldLen = (char  [4])CONCAT22(uVar1,szNpsFldLen._0_2_);
    lVar4 = strtol(szNpsFldLen,(char **)0x0,10);
    iVar3 = (int)lVar4;
    pcVar5 = msgInfo->sData + (long)msgInfo->nFieldPos[field_no] + 2;
    goto LAB_0041c7d3;
  case 4:
    piVar6 = msgInfo->nFieldPos + field_no;
    szNpsFldLen._0_2_ = *(undefined2 *)(msgInfo->sData + *piVar6);
    szNpsFldLen = (char  [4])CONCAT22(uVar1,szNpsFldLen._0_2_);
    goto LAB_0041c6f1;
  case 5:
    szNpsFldLen._0_2_ = *(undefined2 *)(msgInfo->sData + msgInfo->nFieldPos[field_no]);
    szNpsFldLen = (char  [4])CONCAT22(uVar1,szNpsFldLen._0_2_);
    lVar4 = strtol(szNpsFldLen,(char **)0x0,10);
    memcpy(data,msgInfo->sData + (long)msgInfo->nFieldPos[field_no] + 2,(long)(int)lVar4);
    *nLength = (int)lVar4;
    iVar3 = 0;
    break;
  case 6:
    szNpsFldLen._0_3_ = *(undefined3 *)(msgInfo->sData + msgInfo->nFieldPos[field_no]);
    lVar4 = strtol(szNpsFldLen,(char **)0x0,10);
    iVar3 = (int)lVar4;
    pcVar5 = msgInfo->sData + (long)msgInfo->nFieldPos[field_no] + 3;
LAB_0041c7d3:
    HexToAscii((uchar *)pcVar5,(uchar *)data,iVar3);
    data[iVar3] = '\0';
    *nLength = iVar3;
    iVar3 = 0;
    break;
  case 7:
    szNpsFldLen._0_3_ = *(undefined3 *)(msgInfo->sData + msgInfo->nFieldPos[field_no]);
    lVar4 = strtol(szNpsFldLen,(char **)0x0,10);
    iVar3 = (int)lVar4;
    __n = (size_t)iVar3;
    pcVar5 = msgInfo->sData + (long)msgInfo->nFieldPos[field_no] + 3;
    goto LAB_0041c707;
  case 8:
    szNpsFldLen._0_3_ = *(undefined3 *)(msgInfo->sData + msgInfo->nFieldPos[field_no]);
    lVar4 = strtol(szNpsFldLen,(char **)0x0,10);
    memcpy(data,msgInfo->sData + (long)msgInfo->nFieldPos[field_no] + 3,(long)(int)lVar4);
    *nLength = (int)lVar4;
    iVar3 = 0;
    break;
  default:
    iVar3 = -1;
    break;
  case 0xb:
    szBcdFldLen[0] = msgInfo->sData[msgInfo->nFieldPos[field_no]];
    BcdToAscii((uchar *)szBcdFldLen,(uchar *)szNpsFldLen,2);
    lVar4 = strtol(szNpsFldLen,(char **)0x0,10);
    iVar3 = (int)lVar4;
    pcVar5 = msgInfo->sData + (long)msgInfo->nFieldPos[field_no] + 1;
    goto LAB_0041c98d;
  case 0xc:
    iVar3 = GetNpsFieldLength(field_no);
    pcVar5 = msgInfo->sData + msgInfo->nFieldPos[field_no];
    goto LAB_0041c98d;
  case 0xd:
    szBcdFldLen._0_2_ = *(undefined2 *)(msgInfo->sData + msgInfo->nFieldPos[field_no]);
    szBcdFldLen = (char  [4])CONCAT22(uVar2,szBcdFldLen._0_2_);
    BcdToAscii((uchar *)szBcdFldLen,(uchar *)szNpsFldLen,3);
    lVar4 = strtol(szNpsFldLen,(char **)0x0,10);
    iVar3 = (int)lVar4;
    pcVar5 = msgInfo->sData + (long)msgInfo->nFieldPos[field_no] + 2;
LAB_0041c98d:
    BcdToAscii((uchar *)pcVar5,(uchar *)data,iVar3);
    data[iVar3] = '\0';
    *nLength = iVar3;
    iVar3 = 0;
    break;
  case 0xe:
    szBcdFldLen[0] = msgInfo->sData[msgInfo->nFieldPos[field_no]];
    BcdToAscii((uchar *)szBcdFldLen,(uchar *)szNpsFldLen,2);
    lVar4 = strtol(szNpsFldLen,(char **)0x0,10);
    iVar3 = (int)lVar4;
    __n = (size_t)iVar3;
    pcVar5 = msgInfo->sData + (long)msgInfo->nFieldPos[field_no] + 1;
    goto LAB_0041c707;
  case 0xf:
  case 0x10:
    piVar6 = msgInfo->nFieldPos + field_no;
    szBcdFldLen._0_2_ = *(undefined2 *)(msgInfo->sData + *piVar6);
    szBcdFldLen = (char  [4])CONCAT22(uVar2,szBcdFldLen._0_2_);
    BcdToAscii((uchar *)szBcdFldLen,(uchar *)szNpsFldLen,3);
LAB_0041c6f1:
    lVar4 = strtol(szNpsFldLen,(char **)0x0,10);
    iVar3 = (int)lVar4;
    __n = (size_t)iVar3;
    pcVar5 = msgInfo->sData + (long)*piVar6 + 2;
LAB_0041c707:
    memcpy(data,pcVar5,__n);
    data[__n] = '\0';
    *nLength = iVar3;
    iVar3 = 0;
  }
  return iVar3;
}



// WARNING: Unknown calling convention

int AddNpsField(int field_no,TSNpsInfo *msgInfo,char *data,int nLength)

{
  int *piVar1;
  int iVar2;
  int iVar3;
  uint uVar4;
  long lVar5;
  int *piVar6;
  int iVar7;
  uint uVar8;
  uint uVar9;
  char *pcVar10;
  char szNpsFldLen [4];
  char szBcdFldLen [4];
  char sLine [512];
  
  szNpsFldLen[0] = '\0';
  szNpsFldLen[1] = '\0';
  szNpsFldLen[2] = '\0';
  szNpsFldLen[3] = '\0';
  szBcdFldLen[0] = '\0';
  szBcdFldLen[1] = '\0';
  szBcdFldLen[2] = '\0';
  szBcdFldLen[3] = '\0';
  pcVar10 = sLine;
  for (lVar5 = 0x40; lVar5 != 0; lVar5 = lVar5 + -1) {
    pcVar10[0] = '\0';
    pcVar10[1] = '\0';
    pcVar10[2] = '\0';
    pcVar10[3] = '\0';
    pcVar10[4] = '\0';
    pcVar10[5] = '\0';
    pcVar10[6] = '\0';
    pcVar10[7] = '\0';
    pcVar10 = pcVar10 + 8;
  }
  pcVar10 = msgInfo->sBitMap;
  iVar3 = CheckBit(pcVar10,field_no);
  if (iVar3 != 0) {
    sprintf(sLine,"AddNpsField(%d) failed",field_no);
    trace_event(sLine,5);
    return -1;
  }
  piVar1 = msgInfo->nFieldPos + field_no;
  *piVar1 = msgInfo->nLength;
  iVar3 = GetNpsFieldType(field_no);
  switch(iVar3) {
  case 0:
    iVar3 = GetNpsFieldLength(field_no);
    if (iVar3 != nLength) {
      return -1;
    }
    nLength = AsciiToHex((uchar *)data,(uchar *)(msgInfo->sData + msgInfo->nLength),nLength);
    iVar3 = nLength;
    break;
  case 1:
  case 2:
    iVar3 = GetNpsFieldLength(field_no);
    if (iVar3 != nLength) {
      return -1;
    }
    memcpy(msgInfo->sData + msgInfo->nLength,data,(long)nLength);
    break;
  case 3:
    sprintf(szNpsFldLen,"%.2d",(ulong)(uint)nLength);
    *(undefined2 *)(msgInfo->sData + msgInfo->nLength) = szNpsFldLen._0_2_;
    iVar3 = msgInfo->nLength + 2;
    msgInfo->nLength = iVar3;
    nLength = AsciiToHex((uchar *)data,(uchar *)(msgInfo->sData + iVar3),nLength);
    iVar3 = nLength + 2;
    break;
  case 4:
  case 5:
    sprintf(szNpsFldLen,"%.2d",(ulong)(uint)nLength);
    *(undefined2 *)(msgInfo->sData + msgInfo->nLength) = szNpsFldLen._0_2_;
    iVar3 = msgInfo->nLength + 2;
    msgInfo->nLength = iVar3;
    memcpy(msgInfo->sData + iVar3,data,(long)nLength);
    iVar3 = nLength + 2;
    break;
  case 6:
    sprintf(szNpsFldLen,"%.3d",(ulong)(uint)nLength);
    iVar3 = msgInfo->nLength;
    *(undefined2 *)(msgInfo->sData + iVar3) = szNpsFldLen._0_2_;
    msgInfo->sData[(long)iVar3 + 2] = szNpsFldLen[2];
    iVar3 = msgInfo->nLength + 3;
    msgInfo->nLength = iVar3;
    nLength = AsciiToHex((uchar *)data,(uchar *)(msgInfo->sData + iVar3),nLength);
    iVar3 = nLength + 3;
    break;
  case 7:
  case 8:
    sprintf(szNpsFldLen,"%.3d",(ulong)(uint)nLength);
    iVar3 = msgInfo->nLength;
    *(undefined2 *)(msgInfo->sData + iVar3) = szNpsFldLen._0_2_;
    msgInfo->sData[(long)iVar3 + 2] = szNpsFldLen[2];
    iVar3 = msgInfo->nLength + 3;
    msgInfo->nLength = iVar3;
    memcpy(msgInfo->sData + iVar3,data,(long)nLength);
    iVar3 = nLength + 3;
    break;
  default:
    return -1;
  case 0xb:
    sprintf(szNpsFldLen,"%.2d",(ulong)(uint)nLength);
    AsciiToBcd((uchar *)szNpsFldLen,(uchar *)szBcdFldLen,2);
    iVar3 = msgInfo->nLength + 1;
    msgInfo->sData[msgInfo->nLength] = szBcdFldLen[0];
    goto LAB_0041cd9c;
  case 0xc:
    iVar3 = GetNpsFieldLength(field_no);
    if (iVar3 != nLength) {
      return -1;
    }
    iVar3 = msgInfo->nLength;
    goto LAB_0041cda5;
  case 0xd:
    sprintf(szNpsFldLen,"%.3d",(ulong)(uint)nLength);
    AsciiToBcd((uchar *)szNpsFldLen,(uchar *)szBcdFldLen,3);
    *(undefined2 *)(msgInfo->sData + msgInfo->nLength) = szBcdFldLen._0_2_;
    iVar3 = msgInfo->nLength + 2;
LAB_0041cd9c:
    msgInfo->nLength = iVar3;
LAB_0041cda5:
    nLength = AsciiToBcd((uchar *)data,(uchar *)(msgInfo->sData + iVar3),nLength);
    iVar3 = nLength;
    break;
  case 0xe:
    sprintf(szNpsFldLen,"%.2d",(ulong)(uint)nLength);
    iVar7 = AsciiToBcd((uchar *)szNpsFldLen,(uchar *)szBcdFldLen,2);
    iVar3 = msgInfo->nLength + 1;
    msgInfo->sData[msgInfo->nLength] = szBcdFldLen[0];
    goto LAB_0041cea6;
  case 0xf:
    sprintf(szNpsFldLen,"%.3d",(ulong)(uint)nLength);
    iVar7 = AsciiToBcd((uchar *)szNpsFldLen,(uchar *)szBcdFldLen,3);
    *(undefined2 *)(msgInfo->sData + msgInfo->nLength) = szBcdFldLen._0_2_;
    iVar3 = msgInfo->nLength + 2;
LAB_0041cea6:
    msgInfo->nLength = iVar3;
    memcpy(msgInfo->sData + iVar3,data,(long)nLength);
    iVar3 = iVar7 + nLength;
    break;
  case 0x10:
    sprintf(szNpsFldLen,"%.3d",(ulong)(uint)nLength);
    AsciiToBcd((uchar *)szNpsFldLen,(uchar *)szBcdFldLen,3);
    *(undefined2 *)(msgInfo->sData + msgInfo->nLength) = szBcdFldLen._0_2_;
    iVar3 = msgInfo->nLength + 2;
    msgInfo->nLength = iVar3;
    memcpy(msgInfo->sData + iVar3,data,(long)nLength);
    dump_buffer((uchar *)szBcdFldLen,2,'A','X','X');
    dump_buffer((uchar *)data,nLength,'A','X','X');
    iVar3 = 0;
  }
  msgInfo->nLength = msgInfo->nLength + nLength;
  iVar7 = field_no + 1;
  SetBit(pcVar10,iVar7);
  if (field_no - 0x41U < 0x3f) {
    SetBit(pcVar10,1);
  }
  else if (0x7f < field_no) {
    SetBit(pcVar10,0x41);
  }
  if (iVar7 < 0x81) {
    uVar9 = 0x80 - field_no;
    piVar6 = msgInfo->nFieldPos + (long)field_no + 1;
    if ((piVar1 < piVar6 + uVar9 && piVar6 < piVar1 + 1) || (uVar9 < 8)) {
      do {
        lVar5 = (long)iVar7;
        iVar7 = iVar7 + 1;
        msgInfo->nFieldPos[lVar5] = *piVar1 + iVar3;
      } while (iVar7 != 0x81);
    }
    else {
      uVar8 = uVar9 >> 2;
      if (uVar8 != 0) {
        uVar4 = 0;
        do {
          iVar2 = *piVar1;
          uVar4 = uVar4 + 1;
          *piVar6 = iVar2 + iVar3;
          piVar6[1] = iVar2 + iVar3;
          piVar6[2] = iVar2 + iVar3;
          piVar6[3] = iVar2 + iVar3;
          piVar6 = piVar6 + 4;
        } while (uVar4 < uVar8);
        iVar7 = iVar7 + uVar8 * 4;
        if (uVar9 == uVar8 * 4) {
          return 0;
        }
      }
      msgInfo->nFieldPos[iVar7] = *piVar1 + iVar3;
      if (iVar7 + 1 < 0x81) {
        msgInfo->nFieldPos[iVar7 + 1] = *piVar1 + iVar3;
        if (iVar7 + 2 != 0x81) {
          msgInfo->nFieldPos[iVar7 + 2] = *piVar1 + iVar3;
        }
      }
    }
  }
  return 0;
}



// WARNING: Unknown calling convention

int InsertNpsField(int field_no,TSNpsInfo *msgInfo,char *data,int nLength)

{
  int iVar1;
  int iVar2;
  char acVar3 [4];
  int iVar4;
  long lVar5;
  uchar *puVar6;
  char *pcVar7;
  char *pcVar8;
  int *piVar9;
  byte bVar10;
  size_t local_a68;
  int local_a60;
  char szNpsFldLen [4];
  char szBcdFldLen [4];
  char sLine [512];
  char szNpsData [999];
  char vStrTmp [1024];
  
  bVar10 = 0;
  szBcdFldLen[0] = '\0';
  szBcdFldLen[1] = '\0';
  szBcdFldLen[2] = '\0';
  szBcdFldLen[3] = '\0';
  szNpsFldLen[0] = '\0';
  szNpsFldLen[1] = '\0';
  szNpsFldLen[2] = '\0';
  szNpsFldLen[3] = '\0';
  puVar6 = (uchar *)szNpsData;
  for (lVar5 = 0x7c; lVar5 != 0; lVar5 = lVar5 + -1) {
    puVar6[0] = '\0';
    puVar6[1] = '\0';
    puVar6[2] = '\0';
    puVar6[3] = '\0';
    puVar6[4] = '\0';
    puVar6[5] = '\0';
    puVar6[6] = '\0';
    puVar6[7] = '\0';
    puVar6 = puVar6 + 8;
  }
  puVar6[4] = '\0';
  puVar6[5] = '\0';
  puVar6[0] = '\0';
  puVar6[1] = '\0';
  puVar6[2] = '\0';
  puVar6[3] = '\0';
  puVar6[6] = '\0';
  pcVar7 = vStrTmp;
  for (lVar5 = 0x80; lVar5 != 0; lVar5 = lVar5 + -1) {
    pcVar7[0] = '\0';
    pcVar7[1] = '\0';
    pcVar7[2] = '\0';
    pcVar7[3] = '\0';
    pcVar7[4] = '\0';
    pcVar7[5] = '\0';
    pcVar7[6] = '\0';
    pcVar7[7] = '\0';
    pcVar7 = pcVar7 + 8;
  }
  pcVar7 = sLine;
  for (lVar5 = 0x40; lVar5 != 0; lVar5 = lVar5 + -1) {
    pcVar7[0] = '\0';
    pcVar7[1] = '\0';
    pcVar7[2] = '\0';
    pcVar7[3] = '\0';
    pcVar7[4] = '\0';
    pcVar7[5] = '\0';
    pcVar7[6] = '\0';
    pcVar7[7] = '\0';
    pcVar7 = pcVar7 + 8;
  }
  pcVar7 = msgInfo->sBitMap;
  iVar4 = CheckBit(pcVar7,field_no);
  if (iVar4 != 0) {
LAB_0041d2ce:
    return -1;
  }
  iVar4 = GetNpsFieldType(field_no);
  switch(iVar4) {
  case 0:
    iVar4 = GetNpsFieldLength(field_no);
    puVar6 = (uchar *)szNpsData;
    if (iVar4 != nLength) {
      return -1;
    }
    goto LAB_0041d407;
  case 1:
  case 2:
    local_a60 = GetNpsFieldLength(field_no);
    if (local_a60 != nLength) {
      return -1;
    }
    local_a68 = (size_t)nLength;
    memcpy(szNpsData,data,local_a68);
    break;
  case 3:
    sprintf(szNpsFldLen,"%.2d",(ulong)(uint)nLength);
    acVar3 = szNpsFldLen;
    szNpsData[0] = szNpsFldLen[0];
    szNpsData[1] = szNpsFldLen[1];
    puVar6 = (uchar *)(szNpsData + 2);
    szNpsFldLen = acVar3;
    goto LAB_0041d407;
  case 4:
  case 5:
    sprintf(szNpsFldLen,"%.2d",(ulong)(uint)nLength);
    acVar3 = szNpsFldLen;
    szNpsData[0] = szNpsFldLen[0];
    szNpsData[1] = szNpsFldLen[1];
    szNpsFldLen = acVar3;
    memcpy(szNpsData + 2,data,(long)nLength);
    local_a68 = 2;
    local_a60 = 2;
    break;
  case 6:
    sprintf(szNpsFldLen,"%.3d",(ulong)(uint)nLength);
    acVar3 = szNpsFldLen;
    szNpsData[0] = szNpsFldLen[0];
    szNpsData[1] = szNpsFldLen[1];
    szNpsFldLen[2] = acVar3[2];
    szNpsData[2] = szNpsFldLen[2];
    puVar6 = (uchar *)(szNpsData + 3);
    szNpsFldLen = acVar3;
LAB_0041d407:
    local_a60 = AsciiToHex((uchar *)data,puVar6,nLength);
    local_a68 = (size_t)local_a60;
    break;
  case 7:
    sprintf(szNpsFldLen,"%.3d",(ulong)(uint)nLength);
    acVar3 = szNpsFldLen;
    szNpsData[0] = szNpsFldLen[0];
    szNpsData[1] = szNpsFldLen[1];
    szNpsFldLen[2] = acVar3[2];
    szNpsData[2] = szNpsFldLen[2];
    szNpsFldLen = acVar3;
    memcpy(szNpsData + 3,data,(long)nLength);
    local_a68 = 3;
    local_a60 = 3;
    break;
  case 8:
    sprintf(szNpsFldLen,"%.3d",(ulong)(uint)nLength);
    acVar3 = szNpsFldLen;
    szNpsData[0] = szNpsFldLen[0];
    szNpsData[1] = szNpsFldLen[1];
    szNpsFldLen[2] = acVar3[2];
    szNpsData[2] = szNpsFldLen[2];
    szNpsFldLen = acVar3;
    memcpy(szNpsData + 3,data,(long)nLength);
    local_a60 = nLength + 3;
    local_a68 = (size_t)local_a60;
    break;
  default:
    goto LAB_0041d2ce;
  case 0xb:
    sprintf(szNpsFldLen,"%.2d",(ulong)(uint)nLength);
    AsciiToBcd((uchar *)szNpsFldLen,(uchar *)szBcdFldLen,2);
    szNpsData[0] = szBcdFldLen[0];
    local_a60 = AsciiToBcd((uchar *)data,(uchar *)(szNpsData + 1),nLength);
    local_a60 = local_a60 + 1;
    local_a68 = (size_t)local_a60;
    break;
  case 0xc:
    iVar4 = GetNpsFieldLength(field_no);
    if (iVar4 != nLength) {
      return -1;
    }
    local_a60 = AsciiToBcd((uchar *)data,(uchar *)(msgInfo->sData + msgInfo->nLength),nLength);
    local_a68 = (size_t)local_a60;
    break;
  case 0xd:
    sprintf(szNpsFldLen,"%.3d",(ulong)(uint)nLength);
    AsciiToBcd((uchar *)szNpsFldLen,(uchar *)szBcdFldLen,3);
    acVar3 = szBcdFldLen;
    szNpsData[0] = szBcdFldLen[0];
    szNpsData[1] = szBcdFldLen[1];
    szBcdFldLen = acVar3;
    local_a60 = AsciiToBcd((uchar *)data,(uchar *)(szNpsData + 2),nLength);
    local_a60 = local_a60 + 2;
    local_a68 = (size_t)local_a60;
    break;
  case 0xe:
    sprintf(szNpsFldLen,"%.2d",(ulong)(uint)nLength);
    AsciiToBcd((uchar *)szNpsFldLen,(uchar *)szBcdFldLen,2);
    szNpsData[0] = szBcdFldLen[0];
    memcpy(szNpsData + 1,data,(long)nLength);
    local_a60 = nLength + 1;
    local_a68 = (size_t)local_a60;
    break;
  case 0xf:
  case 0x10:
    sprintf(szNpsFldLen,"%.3d",(ulong)(uint)nLength);
    AsciiToBcd((uchar *)szNpsFldLen,(uchar *)szBcdFldLen,3);
    acVar3 = szBcdFldLen;
    szNpsData[0] = szBcdFldLen[0];
    szNpsData[1] = szBcdFldLen[1];
    szBcdFldLen = acVar3;
    memcpy(szNpsData + 2,data,(long)nLength);
    local_a60 = nLength + 2;
    local_a68 = (size_t)local_a60;
  }
  if (field_no < 0x80) {
    piVar9 = msgInfo->nFieldPos + 0x80;
    iVar4 = 0x7f;
    do {
      iVar1 = piVar9[-1];
      iVar2 = *piVar9;
      iVar4 = iVar4 + -1;
      pcVar8 = vStrTmp;
      for (lVar5 = 0x80; lVar5 != 0; lVar5 = lVar5 + -1) {
        pcVar8[0] = '\0';
        pcVar8[1] = '\0';
        pcVar8[2] = '\0';
        pcVar8[3] = '\0';
        pcVar8[4] = '\0';
        pcVar8[5] = '\0';
        pcVar8[6] = '\0';
        pcVar8[7] = '\0';
        pcVar8 = pcVar8 + (ulong)bVar10 * -0x10 + 8;
      }
      memcpy(vStrTmp,msgInfo->sData + iVar1,(long)(iVar2 - iVar1));
      memcpy(msgInfo->sData + (long)iVar1 + local_a68,vStrTmp,(long)(iVar2 - iVar1));
      *piVar9 = *piVar9 + local_a60;
      piVar9 = piVar9 + -1;
    } while (field_no <= iVar4);
    memcpy(msgInfo->sData + msgInfo->nFieldPos[field_no],szNpsData,local_a68);
    msgInfo->nLength = msgInfo->nLength + local_a60;
    SetBit(pcVar7,field_no + 1);
    if (field_no - 0x41U < 0x3f) {
      SetBit(pcVar7,1);
    }
  }
  else {
    memcpy(msgInfo->sData + msgInfo->nFieldPos[field_no],szNpsData,local_a68);
    msgInfo->nLength = msgInfo->nLength + local_a60;
    SetBit(pcVar7,field_no + 1);
    SetBit(pcVar7,0x41);
  }
  return 0;
}



// WARNING: Unknown calling convention

int PutNpsField(int field_no,TSNpsInfo *msgInfo,char *data,int nLength)

{
  int *piVar1;
  int iVar2;
  char acVar3 [4];
  int iVar4;
  long lVar5;
  int iVar6;
  char *pcVar7;
  uchar *puVar8;
  int *piVar9;
  size_t local_388;
  char szNpsFldLen [4];
  char szBcdFldLen [4];
  char szNpsData [260];
  char sLine [512];
  
  local_388 = (size_t)nLength;
  szBcdFldLen[0] = '\0';
  szBcdFldLen[1] = '\0';
  szBcdFldLen[2] = '\0';
  szBcdFldLen[3] = '\0';
  szNpsFldLen[0] = '\0';
  szNpsFldLen[1] = '\0';
  szNpsFldLen[2] = '\0';
  szNpsFldLen[3] = '\0';
  pcVar7 = sLine;
  for (lVar5 = 0x40; lVar5 != 0; lVar5 = lVar5 + -1) {
    pcVar7[0] = '\0';
    pcVar7[1] = '\0';
    pcVar7[2] = '\0';
    pcVar7[3] = '\0';
    pcVar7[4] = '\0';
    pcVar7[5] = '\0';
    pcVar7[6] = '\0';
    pcVar7[7] = '\0';
    pcVar7 = pcVar7 + 8;
  }
  puVar8 = (uchar *)szNpsData;
  for (lVar5 = 0x20; lVar5 != 0; lVar5 = lVar5 + -1) {
    puVar8[0] = '\0';
    puVar8[1] = '\0';
    puVar8[2] = '\0';
    puVar8[3] = '\0';
    puVar8[4] = '\0';
    puVar8[5] = '\0';
    puVar8[6] = '\0';
    puVar8[7] = '\0';
    puVar8 = puVar8 + 8;
  }
  pcVar7 = msgInfo->sBitMap;
  puVar8[0] = '\0';
  puVar8[1] = '\0';
  puVar8[2] = '\0';
  puVar8[3] = '\0';
  iVar4 = CheckBit(pcVar7,field_no);
  if (iVar4 == 0) {
    iVar4 = InsertNpsField(field_no,msgInfo,data,nLength);
    return iVar4;
  }
  iVar4 = GetNpsFieldType(field_no);
  switch(iVar4) {
  case 0:
    iVar4 = GetNpsFieldLength(field_no);
    if (iVar4 != nLength) {
      return -1;
    }
    iVar4 = AsciiToHex((uchar *)data,(uchar *)szNpsData,nLength);
    local_388 = (size_t)iVar4;
    break;
  case 1:
  case 2:
    iVar4 = GetNpsFieldLength(field_no);
    if (iVar4 != nLength) {
      return -1;
    }
    memcpy(szNpsData,data,local_388);
    break;
  case 3:
    sprintf(szNpsFldLen,"%.2d",(ulong)(uint)nLength);
    acVar3 = szNpsFldLen;
    szNpsData[0] = szNpsFldLen[0];
    szNpsData[1] = szNpsFldLen[1];
    szNpsFldLen = acVar3;
    iVar4 = AsciiToHex((uchar *)data,(uchar *)(szNpsData + 2),nLength);
    iVar4 = iVar4 + 2;
    local_388 = (size_t)iVar4;
    break;
  case 4:
  case 5:
    sprintf(szNpsFldLen,"%.2d",(ulong)(uint)nLength);
    szNpsData._0_2_ = szNpsFldLen._0_2_;
    goto LAB_0041d8cb;
  case 6:
    sprintf(szNpsFldLen,"%.3d",(ulong)(uint)nLength);
    acVar3 = szNpsFldLen;
    szNpsData[0] = szNpsFldLen[0];
    szNpsData[1] = szNpsFldLen[1];
    szNpsFldLen[2] = acVar3[2];
    szNpsData[2] = szNpsFldLen[2];
    szNpsFldLen = acVar3;
    iVar4 = AsciiToHex((uchar *)data,(uchar *)(szNpsData + 3),nLength);
    iVar4 = iVar4 + 3;
    local_388 = (size_t)iVar4;
    break;
  case 7:
  case 8:
    iVar4 = nLength + 3;
    sprintf(szNpsFldLen,"%.3d",(ulong)(uint)nLength);
    acVar3 = szNpsFldLen;
    szNpsData[0] = szNpsFldLen[0];
    szNpsData[1] = szNpsFldLen[1];
    szNpsFldLen[2] = acVar3[2];
    szNpsData[2] = szNpsFldLen[2];
    szNpsFldLen = acVar3;
    memcpy(szNpsData + 3,data,(long)nLength);
    local_388 = (size_t)iVar4;
    break;
  default:
    return -1;
  case 0xb:
    sprintf(szNpsFldLen,"%.2d",(ulong)(uint)nLength);
    AsciiToBcd((uchar *)szNpsFldLen,(uchar *)szBcdFldLen,nLength);
    szNpsData[0] = szBcdFldLen[0];
    iVar4 = AsciiToBcd((uchar *)data,(uchar *)(szNpsData + 1),nLength);
    iVar4 = iVar4 + 1;
    local_388 = (size_t)iVar4;
    break;
  case 0xc:
    iVar4 = GetNpsFieldLength(field_no);
    if (iVar4 != nLength) {
      return -1;
    }
    iVar4 = AsciiToBcd((uchar *)data,(uchar *)szNpsData,nLength);
    local_388 = (size_t)iVar4;
    break;
  case 0xd:
    sprintf(szNpsFldLen,"%.3d",(ulong)(uint)nLength);
    AsciiToBcd((uchar *)szNpsFldLen,(uchar *)szBcdFldLen,nLength);
    acVar3 = szBcdFldLen;
    szNpsData[0] = szBcdFldLen[0];
    szNpsData[1] = szBcdFldLen[1];
    szBcdFldLen = acVar3;
    iVar4 = AsciiToBcd((uchar *)data,(uchar *)(szNpsData + 2),nLength);
    iVar4 = iVar4 + 2;
    local_388 = (size_t)iVar4;
    break;
  case 0xe:
    sprintf(szNpsFldLen,"%.2d",(ulong)(uint)nLength);
    iVar4 = nLength + 1;
    AsciiToBcd((uchar *)szNpsFldLen,(uchar *)szBcdFldLen,2);
    szNpsData[0] = szBcdFldLen[0];
    memcpy(szNpsData + 1,data,(long)nLength);
    local_388 = (size_t)iVar4;
    break;
  case 0xf:
    sprintf(szNpsFldLen,"%.3d",(ulong)(uint)nLength);
    AsciiToBcd((uchar *)szNpsFldLen,(uchar *)szBcdFldLen,3);
    goto LAB_0041d8cb;
  case 0x10:
    sprintf(szNpsFldLen,"%.3d",(ulong)(uint)nLength);
    AsciiToBcd((uchar *)szNpsFldLen,(uchar *)szBcdFldLen,3);
    szNpsData._0_2_ = szBcdFldLen._0_2_;
LAB_0041d8cb:
    iVar4 = nLength + 2;
    memcpy(szNpsData + 2,data,(long)nLength);
    local_388 = (size_t)iVar4;
  }
  piVar1 = msgInfo->nFieldPos + (field_no + 1);
  iVar2 = msgInfo->nFieldPos[field_no];
  iVar6 = *piVar1 - iVar2;
  if (field_no < 0x7f) {
    piVar9 = msgInfo->nFieldPos + 0x80;
    iVar4 = iVar4 - iVar6;
    do {
      iVar2 = piVar9[-1];
      memcpy((void *)((long)msgInfo + (long)iVar2 + 0x21e + (local_388 - (long)iVar6)),
             msgInfo->sData + iVar2,(long)(*piVar9 - iVar2));
      *piVar9 = *piVar9 + iVar4;
      piVar9 = piVar9 + -1;
    } while (piVar9 != (int *)((long)msgInfo + (ulong)(0x7e - field_no) * -4 + 0x1fc));
    iVar2 = msgInfo->nFieldPos[field_no];
  }
  else {
    iVar4 = iVar4 - iVar6;
  }
  memcpy(msgInfo->sData + iVar2,szNpsData,local_388);
  *piVar1 = *piVar1 + iVar4;
  msgInfo->nLength = msgInfo->nLength + iVar4;
  SetBit(pcVar7,field_no + 1);
  if (field_no - 0x41U < 0x3f) {
    SetBit(pcVar7,1);
  }
  else if (0x7f < field_no) {
    SetBit(pcVar7,0x41);
  }
  return 0;
}



// WARNING: Unknown calling convention

int NpsBuildMsg(char *buffer_snd,TSNpsInfo *msgInfo,TSIsoInfo *IsoInfo)

{
  char cVar1;
  uint uVar2;
  long lVar3;
  char *pcVar4;
  byte bVar5;
  char szMsgType [5];
  char sDest [17];
  char sSecDest [17];
  char sSecBitMap [17];
  char sLine [512];
  char sData [4096];
  
  bVar5 = 0;
  trace_event("START   NpsBuildMsg()",5);
  sDest[0] = '\0';
  sDest[1] = '\0';
  sDest[2] = '\0';
  sDest[3] = '\0';
  sDest[4] = '\0';
  sDest[5] = '\0';
  sDest[6] = '\0';
  sDest[7] = '\0';
  sDest[8] = '\0';
  sDest[9] = '\0';
  sDest[10] = '\0';
  sDest[0xb] = '\0';
  sDest[0xc] = '\0';
  sDest[0xd] = '\0';
  sDest[0xe] = '\0';
  sDest[0xf] = '\0';
  sDest[0x10] = '\0';
  pcVar4 = sLine;
  for (lVar3 = 0x40; lVar3 != 0; lVar3 = lVar3 + -1) {
    pcVar4[0] = '\0';
    pcVar4[1] = '\0';
    pcVar4[2] = '\0';
    pcVar4[3] = '\0';
    pcVar4[4] = '\0';
    pcVar4[5] = '\0';
    pcVar4[6] = '\0';
    pcVar4[7] = '\0';
    pcVar4 = pcVar4 + (ulong)bVar5 * -0x10 + 8;
  }
  uVar2 = msgInfo->nMsgType;
  szMsgType[0] = '\0';
  szMsgType[1] = '\0';
  szMsgType[2] = '\0';
  szMsgType[3] = '\0';
  szMsgType[4] = '\0';
  pcVar4 = sData;
  for (lVar3 = 0x200; lVar3 != 0; lVar3 = lVar3 + -1) {
    pcVar4[0] = '\0';
    pcVar4[1] = '\0';
    pcVar4[2] = '\0';
    pcVar4[3] = '\0';
    pcVar4[4] = '\0';
    pcVar4[5] = '\0';
    pcVar4[6] = '\0';
    pcVar4[7] = '\0';
    pcVar4 = pcVar4 + (ulong)bVar5 * -0x10 + 8;
  }
  sprintf(szMsgType,"%.4d",(ulong)uVar2);
  sDest[0] = '\0';
  sDest[1] = '\0';
  sDest[2] = '\0';
  sDest[3] = '\0';
  sDest[4] = '\0';
  sDest[5] = '\0';
  sDest[6] = '\0';
  sDest[7] = '\0';
  sDest[8] = '\0';
  sDest[9] = '\0';
  sDest[10] = '\0';
  sDest[0xb] = '\0';
  sDest[0xc] = '\0';
  sDest[0xd] = '\0';
  sDest[0xe] = '\0';
  sDest[0xf] = '\0';
  sDest[0x10] = '\0';
  *(undefined4 *)buffer_snd = szMsgType._0_4_;
  HexToAscii((uchar *)msgInfo->sBitMap,(uchar *)sDest,0x10);
  *(undefined8 *)(buffer_snd + 4) = sDest._0_8_;
  *(undefined8 *)(buffer_snd + 0xc) = sDest._8_8_;
  cVar1 = msgInfo->sBitMap[0];
  memcpy(buffer_snd + 4,msgInfo->sBitMap,8);
  memcpy(buffer_snd + 0xc,msgInfo->sData,(long)msgInfo->nLength);
  return msgInfo->nLength + ((int)cVar1 >> 0x1f & 8U) + 0xc;
}



// WARNING: Unknown calling convention

int NpsBuildHeader(char *pNewHeader,int sLen,TSNpsInfo *NpsInfo)

{
  pNewHeader[0] = '0';
  pNewHeader[1] = '0';
  return 0;
}



// WARNING: Unknown calling convention

int GetTableInd(TSIsoInfo *IsoInfo,char *sAutTabInd)

{
  int iVar1;
  int nLength;
  char sMerchActv [5];
  char slProcCode [7];
  char sLine [512];
  
  trace_event(" START     GetTableInd()",5);
  slProcCode[4] = '\0';
  slProcCode[5] = '\0';
  sAutTabInd[0] = '\0';
  sAutTabInd[1] = '\0';
  sAutTabInd[2] = '\0';
  sAutTabInd[3] = '\0';
  sAutTabInd[4] = '\0';
  sAutTabInd[5] = '\0';
  sAutTabInd[6] = '\0';
  sAutTabInd[7] = '\0';
  slProcCode[0] = '\0';
  slProcCode[1] = '\0';
  slProcCode[2] = '\0';
  slProcCode[3] = '\0';
  slProcCode[6] = '\0';
  sMerchActv[0] = '\0';
  sMerchActv[1] = '\0';
  sMerchActv[2] = '\0';
  sMerchActv[3] = '\0';
  sMerchActv[4] = '\0';
  GetIsoField(2,IsoInfo,slProcCode,&nLength);
  sprintf(sLine,"   slProcCode  = [%s]",slProcCode);
  trace_event(sLine,5);
  GetIsoField(0x11,IsoInfo,sMerchActv,&nLength);
  sprintf(sLine,"   sMerchActv  = [%s]",sMerchActv);
  trace_event(sLine,5);
  sAutTabInd[2] = 'M';
  sAutTabInd[0] = 'A';
  sAutTabInd[1] = 'S';
  iVar1 = memcmp(sMerchActv,&DAT_004a4ee6,4);
  if ((iVar1 == 0) || (sMerchActv[0] == '\0')) {
    sAutTabInd[2] = 'M';
    sAutTabInd[0] = 'A';
    sAutTabInd[1] = 'S';
    iVar1 = memcmp(slProcCode,&DAT_004a670e,2);
    if (iVar1 != 0) {
      iVar1 = memcmp(slProcCode,"01",2);
      if (iVar1 != 0) {
        iVar1 = memcmp(slProcCode,&DAT_004d1ee1,2);
        if (iVar1 != 0) {
          iVar1 = memcmp(slProcCode,&DAT_004c9c1d,2);
          if (iVar1 != 0) {
            iVar1 = memcmp(slProcCode,&DAT_004a5543,2);
            if (iVar1 != 0) {
              iVar1 = memcmp(slProcCode,&DAT_004a554a,2);
              if (iVar1 != 0) {
                sAutTabInd[2] = 'C';
                sAutTabInd[0] = 'M';
                sAutTabInd[1] = 'S';
              }
            }
          }
        }
      }
    }
  }
  sprintf(sLine," END       GetTableInd(%s)",sAutTabInd);
  trace_event(sLine,5);
  return 0;
}



// WARNING: Unknown calling convention

int load_nps_add_data(char *pTarget,char *pMCC)

{
  int iVar1;
  undefined8 uVar2;
  char sLine [512];
  
  sprintf(sLine,"Start load_nps_add_data(%s)",pMCC);
  trace_event(sLine,5);
  iVar1 = memcmp(pMCC,&DAT_004a4ee6,4);
  if (iVar1 == 0) {
    builtin_strncpy(pTarget,"00000000000000000000000000000000000000000000",0x2c);
    uVar2 = 0x2c;
  }
  else if (*pMCC == '\0') {
    builtin_strncpy(pTarget,"0111002112S00000",0x10);
    uVar2 = 0x10;
  }
  else {
    builtin_strncpy(pTarget,"000000000000000000000000000",0x1b);
    uVar2 = 0x1b;
  }
  sprintf(sLine,"End   load_nps_add_data(%d)",uVar2);
  trace_event(sLine,5);
  return (int)uVar2;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address
// WARNING: Unknown calling convention

void expand_data(uchar *crypt_data,uchar *data_block,int data_len)

{
  undefined1 auVar1 [16];
  byte bVar2;
  undefined1 auVar3 [15];
  undefined1 auVar4 [15];
  undefined1 auVar5 [15];
  undefined1 auVar6 [15];
  undefined1 auVar7 [15];
  undefined1 auVar8 [15];
  byte bVar9;
  byte bVar10;
  byte bVar11;
  undefined1 auVar12 [15];
  undefined1 auVar13 [15];
  unkuint9 Var14;
  undefined1 auVar15 [11];
  undefined1 auVar16 [16];
  undefined1 auVar17 [16];
  undefined1 auVar18 [16];
  undefined1 auVar19 [16];
  undefined1 auVar20 [15];
  undefined1 auVar21 [15];
  undefined1 auVar22 [12];
  undefined1 auVar23 [12];
  undefined1 auVar24 [16];
  byte bVar25;
  long lVar26;
  uint uVar27;
  byte *pbVar28;
  uint uVar29;
  int iVar30;
  undefined1 auVar31 [16];
  undefined1 auVar32 [16];
  undefined1 auVar33 [16];
  undefined1 auVar34 [16];
  undefined1 auVar35 [16];
  undefined1 auVar36 [16];
  undefined1 auVar37 [16];
  undefined1 auVar38 [16];
  undefined1 auVar39 [16];
  
  auVar24 = _DAT_004a7340;
  if (0 < data_len) {
    if ((data_block < crypt_data + (long)data_len * 2 && crypt_data < data_block + data_len) ||
       ((uint)data_len < 0x10)) {
      lVar26 = 0;
      do {
        bVar2 = data_block[lVar26];
        crypt_data[lVar26 * 2 + 1] = bVar2 & 0xf;
        crypt_data[lVar26 * 2] = bVar2 >> 4;
        lVar26 = lVar26 + 1;
      } while ((int)lVar26 < data_len);
    }
    else {
      uVar27 = (uint)data_len >> 4;
      lVar26 = 0;
      uVar29 = 0;
      iVar30 = uVar27 * 0x10;
      do {
        auVar1 = *(undefined1 (*) [16])(data_block + lVar26);
        uVar29 = uVar29 + 1;
        auVar32 = auVar1 & auVar24;
        auVar3[0xd] = 0;
        auVar3._0_13_ = auVar1._0_13_;
        auVar3[0xe] = auVar1[7];
        auVar4[0xc] = auVar1[6];
        auVar4._0_12_ = auVar1._0_12_;
        auVar4._13_2_ = auVar3._13_2_;
        auVar5[0xb] = 0;
        auVar5._0_11_ = auVar1._0_11_;
        auVar5._12_3_ = auVar4._12_3_;
        auVar6[10] = auVar1[5];
        auVar6._0_10_ = auVar1._0_10_;
        auVar6._11_4_ = auVar5._11_4_;
        auVar7[9] = 0;
        auVar7._0_9_ = auVar1._0_9_;
        auVar7._10_5_ = auVar6._10_5_;
        auVar8[8] = auVar1[4];
        auVar8._0_8_ = auVar1._0_8_;
        auVar8._9_6_ = auVar7._9_6_;
        auVar13._7_8_ = 0;
        auVar13._0_7_ = auVar8._8_7_;
        Var14 = CONCAT81(SUB158(auVar13 << 0x40,7),auVar1[3]);
        auVar20._9_6_ = 0;
        auVar20._0_9_ = Var14;
        auVar15._1_10_ = SUB1510(auVar20 << 0x30,5);
        auVar15[0] = auVar1[2];
        auVar21._11_4_ = 0;
        auVar21._0_11_ = auVar15;
        auVar12[2] = auVar1[1];
        auVar12._0_2_ = auVar1._0_2_;
        auVar12._3_12_ = SUB1512(auVar21 << 0x20,3);
        bVar2 = auVar1[7] >> 4;
        bVar25 = auVar1[8] >> 4;
        bVar9 = auVar1[9] >> 4;
        bVar11 = auVar1[10] >> 4;
        bVar10 = auVar1[0xb] >> 4;
        auVar22[10] = bVar11;
        auVar22._0_10_ = (unkuint10)0;
        auVar22[0xb] = bVar10;
        auVar23[9] = bVar9;
        auVar23._0_9_ = (unkuint9)0;
        auVar23._10_2_ = auVar22._10_2_;
        auVar19._10_6_ = 0;
        auVar19._0_10_ = SUB1610(ZEXT516(CONCAT41(CONCAT31(auVar23._9_3_,bVar25),bVar2)) << 0x38,6);
        auVar18._11_5_ = 0;
        auVar18._0_11_ = SUB1611(auVar19 << 0x30,5);
        auVar17._12_4_ = 0;
        auVar17._0_12_ = SUB1612(auVar18 << 0x28,4);
        auVar16._13_3_ = 0;
        auVar16._0_13_ = SUB1613(auVar17 << 0x20,3);
        auVar31._14_2_ = 0;
        auVar31._0_14_ = SUB1614(auVar16 << 0x18,2);
        auVar31 = auVar31 << 0x10;
        auVar39._0_14_ = auVar31._0_14_;
        auVar39[0xe] = bVar2;
        auVar39[0xf] = auVar32[7];
        auVar38._14_2_ = auVar39._14_2_;
        auVar38._0_13_ = auVar31._0_13_;
        auVar38[0xd] = auVar32[6];
        auVar37._13_3_ = auVar38._13_3_;
        auVar37._0_12_ = auVar31._0_12_;
        auVar37[0xc] = (char)(auVar4._12_2_ >> 4);
        auVar36._12_4_ = auVar37._12_4_;
        auVar36._0_11_ = auVar31._0_11_;
        auVar36[0xb] = auVar32[5];
        auVar35._11_5_ = auVar36._11_5_;
        auVar35._0_10_ = auVar31._0_10_;
        auVar35[10] = (char)(auVar6._10_2_ >> 4);
        auVar34._10_6_ = auVar35._10_6_;
        auVar34._0_9_ = auVar31._0_9_;
        auVar34[9] = auVar32[4];
        auVar33._9_7_ = auVar34._9_7_;
        auVar33[8] = (char)(auVar8._8_2_ >> 4);
        auVar33[7] = auVar32[3];
        auVar33[6] = (char)((ushort)Var14 >> 4);
        auVar33[5] = auVar32[2];
        auVar33[4] = (char)(auVar15._0_2_ >> 4);
        auVar33[3] = auVar32[1];
        auVar33[2] = (char)(auVar12._2_2_ >> 4);
        auVar33[1] = auVar32[0];
        auVar33[0] = (char)((auVar1._0_2_ & 0xff) >> 4);
        pbVar28 = crypt_data + lVar26 * 2 + 0x10;
        *pbVar28 = bVar25;
        pbVar28[1] = auVar32[8];
        pbVar28[2] = bVar9;
        pbVar28[3] = auVar32[9];
        pbVar28[4] = bVar11;
        pbVar28[5] = auVar32[10];
        pbVar28[6] = bVar10;
        pbVar28[7] = auVar32[0xb];
        pbVar28[8] = auVar1[0xc] >> 4;
        pbVar28[9] = auVar32[0xc];
        pbVar28[10] = auVar1[0xd] >> 4;
        pbVar28[0xb] = auVar32[0xd];
        pbVar28[0xc] = auVar1[0xe] >> 4;
        pbVar28[0xd] = auVar32[0xe];
        pbVar28[0xe] = auVar1[0xf] >> 4;
        pbVar28[0xf] = auVar32[0xf];
        *(undefined1 (*) [16])(crypt_data + lVar26 * 2) = auVar33;
        lVar26 = lVar26 + 0x10;
      } while (uVar29 < uVar27);
      if (data_len != iVar30) {
        lVar26 = 0;
        pbVar28 = crypt_data + (int)(uVar27 * 0x20);
        do {
          bVar2 = data_block[lVar26 + iVar30];
          lVar26 = lVar26 + 1;
          pbVar28[1] = bVar2 & 0xf;
          *pbVar28 = bVar2 >> 4;
          pbVar28 = pbVar28 + 2;
        } while (iVar30 + (int)lVar26 < data_len);
      }
    }
  }
  if (0 < data_len * 2) {
    pbVar28 = crypt_data + (ulong)(data_len * 2 - 1) + 1;
    do {
      bVar2 = *crypt_data;
      if (bVar2 < 10) {
        *crypt_data = bVar2 + 0x30;
      }
      else if (bVar2 == 10) {
        *crypt_data = 0x41;
      }
      else if (bVar2 == 0xb) {
        *crypt_data = 0x42;
      }
      else if (bVar2 == 0xc) {
        *crypt_data = 0x43;
      }
      else if (bVar2 == 0xd) {
        *crypt_data = 0x44;
      }
      else if (bVar2 == 0xe) {
        *crypt_data = 0x45;
      }
      else {
        bVar25 = 0x46;
        if (bVar2 != 0xf) {
          bVar25 = 0;
        }
        *crypt_data = bVar25;
      }
      crypt_data = crypt_data + 1;
    } while (crypt_data != pbVar28);
                    // WARNING: Read-only address (ram,0x004a7340) is written
    return;
  }
  return;
}



// WARNING: Unknown calling convention

void compress_data(uchar *target,uchar *source,int src_len)

{
  uchar uVar1;
  byte bVar2;
  long lVar3;
  byte bVar4;
  byte bVar5;
  
  lVar3 = 0;
  if (0 < src_len / 2) {
    do {
      uVar1 = source[lVar3 * 2];
      bVar2 = source[lVar3 * 2 + 1];
      bVar4 = 0xa0;
      if ((((uVar1 != 'A') && (bVar4 = 0xb0, uVar1 != 'B')) && (bVar4 = 0xc0, uVar1 != 'C')) &&
         ((bVar4 = 0xd0, uVar1 != 'D' && (bVar4 = 0xe0, uVar1 != 'E')))) {
        bVar4 = 0xf0;
        if (uVar1 != 'F') {
          bVar4 = uVar1 << 4;
        }
      }
      bVar5 = 10;
      if (((bVar2 != 0x41) && (bVar5 = 0xb, bVar2 != 0x42)) &&
         ((bVar5 = 0xc, bVar2 != 0x43 &&
          (((bVar5 = 0xd, bVar2 != 0x44 && (bVar5 = 0xe, bVar2 != 0x45)) &&
           (bVar5 = bVar2 & 0xf, bVar2 == 0x46)))))) {
        bVar5 = 0xf;
      }
      target[lVar3] = bVar4 | bVar5;
      lVar3 = lVar3 + 1;
    } while ((int)lVar3 < src_len / 2);
  }
  return;
}



// WARNING: Unknown calling convention

int GetNpsIcTag(char *tag_name,TSTagNps *tagInfo,char *data,int *length)

{
  int *piVar1;
  int nIndice;
  int iVar2;
  ulong uVar3;
  
  nIndice = GetNpsTagIndice(tag_name);
  iVar2 = nIndice;
  if (nIndice != -1) {
    piVar1 = tagInfo->nPresent + nIndice;
    iVar2 = *piVar1;
    if (iVar2 != -1) {
      uVar3 = (ulong)((tagInfo->sChipData[piVar1[100]] & 0x1fU) == 0x1f);
      *length = (int)tagInfo->sChipData[uVar3 + (long)piVar1[100] + 1];
      iVar2 = GetNpsTagType(nIndice);
      switch(iVar2) {
      case 0:
      case 1:
      case 4:
      case 5:
        memcpy(data,tagInfo->sChipData + uVar3 + (long)piVar1[100] + 2,(long)*length);
        return 0;
      default:
        iVar2 = 0;
        break;
      case 6:
        HexToAscii((uchar *)(tagInfo->sChipData + uVar3 + (long)piVar1[100] + 2),(uchar *)data,
                   *length * 2);
        *length = *length << 1;
        return 0;
      case 0xb:
      case 0xc:
        BcdToAscii((uchar *)(tagInfo->sChipData + uVar3 + (long)piVar1[100] + 2),(uchar *)data,
                   *length * 2);
        *length = *length << 1;
        return 0;
      }
    }
  }
  return iVar2;
}



// WARNING: Unknown calling convention

int AddNpsIcTag(char *tag_name,TSTagNps *tagInfo,char *data,int length)

{
  int *piVar1;
  int iVar2;
  int iVar3;
  uint uVar4;
  ulong uVar5;
  bool bVar6;
  int local_23c;
  char sLine [512];
  
  iVar2 = GetNpsTagIndice(tag_name);
  if ((iVar2 == -1) || (piVar1 = tagInfo->nPresent + iVar2, *piVar1 == 0)) {
LAB_0041e6d0:
    iVar2 = -1;
  }
  else {
    AsciiToHex((uchar *)tag_name,(uchar *)(tagInfo->sChipData + tagInfo->nLength),4);
    bVar6 = (tagInfo->sChipData[tagInfo->nLength] & 0x1fU) == 0x1f;
    uVar5 = (ulong)bVar6;
    uVar4 = (uint)bVar6;
    sprintf(sLine,"TAG IS %s|%02X|%d",tag_name,
            (ulong)(uint)(int)tagInfo->sChipData[tagInfo->nLength],(ulong)(uVar4 + 1));
    trace_event(sLine,4);
    iVar3 = GetNpsTagType(iVar2);
    switch(iVar3) {
    case 0:
    case 4:
      local_23c = GetNpsTagLength(iVar2);
      if (local_23c != length) goto LAB_0041e6d0;
      memcpy(tagInfo->sChipData + uVar5 + (long)tagInfo->nLength + 2,data,(long)length);
      break;
    case 1:
    case 5:
      memcpy(tagInfo->sChipData + uVar5 + (long)tagInfo->nLength + 2,data,(long)length);
      local_23c = length;
      break;
    case 6:
      local_23c = AsciiToHex((uchar *)data,
                             (uchar *)(tagInfo->sChipData + uVar5 + (long)tagInfo->nLength + 2),
                             length);
      break;
    case 0xb:
      local_23c = AsciiToBcd((uchar *)data,
                             (uchar *)(tagInfo->sChipData + uVar5 + (long)tagInfo->nLength + 2),
                             length);
      break;
    case 0xc:
      iVar2 = GetNpsTagLength(iVar2);
      if (iVar2 != length) goto LAB_0041e6d0;
      local_23c = AsciiToBcd((uchar *)data,
                             (uchar *)(tagInfo->sChipData + uVar5 + (long)tagInfo->nLength + 2),
                             length);
    }
    iVar2 = tagInfo->nLength;
    tagInfo->sChipData[(long)iVar2 + uVar5 + 1] = (char)local_23c;
    piVar1[100] = iVar2;
    *piVar1 = 0;
    tagInfo->nLength = iVar2 + uVar4 + 2 + local_23c;
    iVar2 = 0;
  }
  return iVar2;
}



// WARNING: Unknown calling convention

int PutNpsIcTag(char *tag_name,TSTagNps *tagInfo,char *data,int length)

{
  int *piVar1;
  char cVar2;
  int iVar3;
  byte bVar4;
  int iVar5;
  int iVar6;
  long lVar7;
  long lVar8;
  char *pcVar9;
  int iVar10;
  int local_16c;
  int local_168;
  int local_150;
  int local_14c;
  char szLastPart [258];
  
  pcVar9 = szLastPart;
  for (lVar7 = 0x20; lVar7 != 0; lVar7 = lVar7 + -1) {
    pcVar9[0] = '\0';
    pcVar9[1] = '\0';
    pcVar9[2] = '\0';
    pcVar9[3] = '\0';
    pcVar9[4] = '\0';
    pcVar9[5] = '\0';
    pcVar9[6] = '\0';
    pcVar9[7] = '\0';
    pcVar9 = pcVar9 + 8;
  }
  pcVar9[0] = '\0';
  pcVar9[1] = '\0';
  iVar5 = GetNpsTagIndice(tag_name);
  if (iVar5 == -1) {
LAB_0041e9c1:
    iVar5 = -1;
  }
  else {
    piVar1 = tagInfo->nPresent + iVar5;
    if (*piVar1 == 0) {
      local_150 = piVar1[100];
      local_16c = 0;
      lVar7 = (long)local_150;
    }
    else {
      local_150 = tagInfo->nLength;
      lVar7 = (long)local_150;
      AsciiToHex((uchar *)tag_name,(uchar *)(tagInfo->sChipData + lVar7),4);
      local_16c = -1;
    }
    bVar4 = tagInfo->sChipData[lVar7] & 1;
    lVar8 = 2 - (ulong)(bVar4 == 0);
    iVar3 = -(uint)(bVar4 == 0);
    iVar10 = iVar3 + 2;
    if (local_16c == 0) {
      cVar2 = *(char *)((long)tagInfo + lVar8 + lVar7 + 0x324);
      local_14c = (int)cVar2;
      memcpy(szLastPart,(void *)((long)tagInfo + lVar8 + lVar7 + 0x325 + (long)cVar2),
             (long)((((tagInfo->nLength - local_150) - iVar10) - local_14c) + -1));
    }
    iVar6 = GetNpsTagType(iVar5);
    switch(iVar6) {
    case 0:
    case 4:
      local_168 = GetNpsTagLength(iVar5);
      if (local_168 != length) goto LAB_0041e9c1;
      memcpy((void *)((long)tagInfo + lVar7 + 0x325 + lVar8),data,(long)length);
      break;
    case 1:
    case 5:
      memcpy((void *)((long)tagInfo + lVar7 + 0x325 + lVar8),data,(long)length);
      local_168 = length;
      break;
    case 6:
      local_168 = AsciiToHex((uchar *)data,(uchar *)((long)tagInfo + lVar7 + 0x325 + lVar8),length);
      break;
    case 0xb:
      local_168 = AsciiToBcd((uchar *)data,(uchar *)((long)tagInfo + lVar7 + 0x325 + lVar8),length);
      break;
    case 0xc:
      iVar6 = GetNpsTagLength(iVar5);
      if (iVar6 != length) goto LAB_0041e9c1;
      local_168 = AsciiToBcd((uchar *)data,(uchar *)((long)tagInfo + lVar7 + 0x325 + lVar8),length);
    }
    *(char *)((long)tagInfo + lVar8 + lVar7 + 0x324) = (char)local_168;
    if (local_16c == 0) {
      iVar5 = iVar5 + 1;
      memcpy((void *)((long)tagInfo + lVar8 + lVar7 + 0x325 + (long)local_168),szLastPart,
             (long)((((tagInfo->nLength - local_150) - iVar10) - local_14c) + -1));
      tagInfo->nLength = tagInfo->nLength + (local_168 - local_14c);
      if (iVar5 < 100) {
        do {
          piVar1 = tagInfo->nPresent + iVar5;
          if (*piVar1 == 0) {
            piVar1[100] = piVar1[100] + (local_168 - local_14c);
          }
          iVar5 = iVar5 + 1;
        } while (iVar5 != 100);
      }
      iVar5 = 0;
    }
    else {
      iVar5 = tagInfo->nLength;
      *piVar1 = 0;
      piVar1[100] = iVar5;
      tagInfo->nLength = iVar5 + iVar3 + 3 + local_168;
      iVar5 = 0;
    }
  }
  return iVar5;
}



// WARNING: Unknown calling convention

int NpsBuildIcFld(char *buffer_snd,TSTagNps *tagInfo)

{
  memcpy(buffer_snd,tagInfo->sChipData,(long)tagInfo->nLength);
  return tagInfo->nLength;
}



// WARNING: Unknown calling convention

int GetNpsSubFldTag(char *tag_name,TSSubTagNps *tagInfo,char *data,int *length)

{
  int *piVar1;
  int nIndice;
  int iVar2;
  ulong uVar3;
  
  nIndice = GetNpsSubTagIndice(tag_name);
  iVar2 = nIndice;
  if (nIndice != -1) {
    piVar1 = tagInfo->nPresent + nIndice;
    iVar2 = *piVar1;
    if (iVar2 != -1) {
      uVar3 = (ulong)((tagInfo->sSubData[piVar1[300]] & 0x1fU) == 0x1f);
      *length = (int)tagInfo->sSubData[uVar3 + (long)piVar1[300] + 1];
      iVar2 = GetNpsSubTagType(nIndice);
      switch(iVar2) {
      case 0:
      case 4:
        memcpy(data,tagInfo->sSubData + (long)piVar1[300] + 6,(long)*length);
        iVar2 = 0;
        break;
      case 1:
      case 5:
        memcpy(data,tagInfo->sSubData + uVar3 + (long)piVar1[300] + 2,(long)*length);
        return 0;
      default:
        iVar2 = 0;
        break;
      case 6:
        HexToAscii((uchar *)(tagInfo->sSubData + uVar3 + (long)piVar1[300] + 2),(uchar *)data,
                   *length * 2);
        *length = *length << 1;
        return 0;
      case 0xb:
      case 0xc:
        BcdToAscii((uchar *)(tagInfo->sSubData + uVar3 + (long)piVar1[300] + 2),(uchar *)data,
                   *length * 2);
        *length = *length << 1;
        return 0;
      }
    }
  }
  return iVar2;
}



// WARNING: Unknown calling convention

int AddNpsSubTag(char *tag_name,TSSubTagNps *tagInfo,char *data,int length)

{
  int *piVar1;
  int iVar2;
  int iVar3;
  long lVar4;
  uint uVar5;
  char *pcVar6;
  ulong uVar7;
  bool bVar8;
  int local_23c;
  char sLine [512];
  
  pcVar6 = sLine;
  for (lVar4 = 0x40; lVar4 != 0; lVar4 = lVar4 + -1) {
    pcVar6[0] = '\0';
    pcVar6[1] = '\0';
    pcVar6[2] = '\0';
    pcVar6[3] = '\0';
    pcVar6[4] = '\0';
    pcVar6[5] = '\0';
    pcVar6[6] = '\0';
    pcVar6[7] = '\0';
    pcVar6 = pcVar6 + 8;
  }
  iVar2 = GetNpsSubTagIndice(tag_name);
  if ((iVar2 == -1) || (piVar1 = tagInfo->nPresent + iVar2, *piVar1 == 0)) {
LAB_0041eda0:
    iVar2 = -1;
  }
  else {
    AsciiToHex((uchar *)tag_name,(uchar *)(tagInfo->sSubData + tagInfo->nLength),3);
    bVar8 = (tagInfo->sSubData[tagInfo->nLength] & 0x1fU) == 0x1f;
    uVar7 = (ulong)bVar8;
    uVar5 = (uint)bVar8;
    sprintf(sLine,"TAG IS %s|%02X|%d",tag_name,(ulong)(uint)(int)tagInfo->sSubData[tagInfo->nLength]
            ,(ulong)(uVar5 + 1));
    trace_event(sLine,4);
    iVar3 = GetNpsSubTagType(iVar2);
    switch(iVar3) {
    case 0:
    case 4:
      local_23c = GetNpsTagLength(iVar2);
      if (local_23c != length) goto LAB_0041eda0;
      memcpy(tagInfo->sSubData + uVar7 + (long)tagInfo->nLength + 2,data,(long)length);
      break;
    case 1:
    case 5:
      memcpy(tagInfo->sSubData + uVar7 + (long)tagInfo->nLength + 2,data,(long)length);
      local_23c = length;
      break;
    case 6:
      local_23c = AsciiToHex((uchar *)data,
                             (uchar *)(tagInfo->sSubData + uVar7 + (long)tagInfo->nLength + 2),
                             length);
      break;
    case 0xb:
      local_23c = AsciiToBcd((uchar *)data,
                             (uchar *)(tagInfo->sSubData + uVar7 + (long)tagInfo->nLength + 2),
                             length);
      break;
    case 0xc:
      iVar2 = GetNpsTagLength(iVar2);
      if (iVar2 != length) goto LAB_0041eda0;
      local_23c = AsciiToBcd((uchar *)data,
                             (uchar *)(tagInfo->sSubData + uVar7 + (long)tagInfo->nLength + 2),
                             length);
    }
    iVar2 = tagInfo->nLength;
    tagInfo->sSubData[(long)iVar2 + uVar7 + 1] = (char)local_23c;
    piVar1[300] = iVar2;
    *piVar1 = 0;
    tagInfo->nLength = iVar2 + uVar5 + 2 + local_23c;
    iVar2 = 0;
  }
  return iVar2;
}



// WARNING: Unknown calling convention

int PutNpsSubTag(char *tag_name,TSSubTagNps *tagInfo,char *data,int length)

{
  int *piVar1;
  char cVar2;
  int iVar3;
  byte bVar4;
  int iVar5;
  int iVar6;
  long lVar7;
  long lVar8;
  char *pcVar9;
  int iVar10;
  int local_44c;
  int local_448;
  int local_430;
  int local_42c;
  char szLastPart [999];
  
  pcVar9 = szLastPart;
  for (lVar7 = 0x7c; lVar7 != 0; lVar7 = lVar7 + -1) {
    pcVar9[0] = '\0';
    pcVar9[1] = '\0';
    pcVar9[2] = '\0';
    pcVar9[3] = '\0';
    pcVar9[4] = '\0';
    pcVar9[5] = '\0';
    pcVar9[6] = '\0';
    pcVar9[7] = '\0';
    pcVar9 = pcVar9 + 8;
  }
  pcVar9[0] = '\0';
  pcVar9[1] = '\0';
  pcVar9[2] = '\0';
  pcVar9[3] = '\0';
  pcVar9[4] = '\0';
  pcVar9[5] = '\0';
  pcVar9[6] = '\0';
  iVar5 = GetNpsSubTagIndice(tag_name);
  if (iVar5 == -1) {
LAB_0041f091:
    iVar5 = -1;
  }
  else {
    piVar1 = tagInfo->nPresent + iVar5;
    if (*piVar1 == 0) {
      local_430 = piVar1[300];
      local_44c = 0;
      lVar7 = (long)local_430;
    }
    else {
      local_430 = tagInfo->nLength;
      lVar7 = (long)local_430;
      AsciiToHex((uchar *)tag_name,(uchar *)(tagInfo->sSubData + lVar7),3);
      local_44c = -1;
    }
    bVar4 = tagInfo->sSubData[lVar7] & 1;
    lVar8 = 2 - (ulong)(bVar4 == 0);
    iVar3 = -(uint)(bVar4 == 0);
    iVar10 = iVar3 + 2;
    if (local_44c == 0) {
      cVar2 = *(char *)((long)tagInfo + lVar8 + lVar7 + 0x964);
      local_42c = (int)cVar2;
      memcpy(szLastPart,(void *)((long)tagInfo + lVar8 + lVar7 + 0x965 + (long)cVar2),
             (long)((((tagInfo->nLength - local_430) - iVar10) - local_42c) + -1));
    }
    iVar6 = GetNpsSubTagType(iVar5);
    switch(iVar6) {
    case 0:
    case 4:
      local_448 = GetNpsTagLength(iVar5);
      if (local_448 != length) goto LAB_0041f091;
      memcpy((void *)((long)tagInfo + lVar7 + 0x965 + lVar8),data,(long)length);
      break;
    case 1:
    case 5:
      memcpy((void *)((long)tagInfo + lVar7 + 0x965 + lVar8),data,(long)length);
      local_448 = length;
      break;
    case 6:
      local_448 = AsciiToHex((uchar *)data,(uchar *)((long)tagInfo + lVar7 + 0x965 + lVar8),length);
      break;
    case 0xb:
      local_448 = AsciiToBcd((uchar *)data,(uchar *)((long)tagInfo + lVar7 + 0x965 + lVar8),length);
      break;
    case 0xc:
      iVar6 = GetNpsTagLength(iVar5);
      if (iVar6 != length) goto LAB_0041f091;
      local_448 = AsciiToBcd((uchar *)data,(uchar *)((long)tagInfo + lVar7 + 0x965 + lVar8),length);
    }
    *(char *)((long)tagInfo + lVar8 + lVar7 + 0x964) = (char)local_448;
    if (local_44c == 0) {
      iVar5 = iVar5 + 1;
      memcpy((void *)((long)tagInfo + lVar8 + lVar7 + 0x965 + (long)local_448),szLastPart,
             (long)((((tagInfo->nLength - local_430) - iVar10) - local_42c) + -1));
      tagInfo->nLength = tagInfo->nLength + (local_448 - local_42c);
      if (iVar5 < 100) {
        do {
          piVar1 = tagInfo->nPresent + iVar5;
          if (*piVar1 == 0) {
            piVar1[300] = piVar1[300] + (local_448 - local_42c);
          }
          iVar5 = iVar5 + 1;
        } while (iVar5 != 100);
      }
      iVar5 = 0;
    }
    else {
      iVar5 = tagInfo->nLength;
      *piVar1 = 0;
      piVar1[300] = iVar5;
      tagInfo->nLength = iVar5 + iVar3 + 3 + local_448;
      iVar5 = 0;
    }
  }
  return iVar5;
}



// WARNING: Unknown calling convention

int NpsBuildSubFld(char *buffer_snd,TSSubTagNps *tagInfo)

{
  memcpy(buffer_snd,tagInfo->sSubData,(long)tagInfo->nLength);
  return tagInfo->nLength;
}



// WARNING: Unknown calling convention

int GetNpsF46SubFldTag(char *tag_name,TSSubTagNps *tagInfo,char *data,int *length)

{
  int *piVar1;
  uint nIndice;
  int iVar2;
  uint uVar3;
  ulong uVar4;
  char sLength [3];
  
  sLength[0] = '\0';
  sLength[1] = '\0';
  sLength[2] = '\0';
  nIndice = GetNps46SubTagIndice(tag_name);
  uVar3 = nIndice;
  if (nIndice != 0xffffffff) {
    piVar1 = tagInfo->nPresent + (int)nIndice;
    uVar3 = *piVar1;
    if (uVar3 != 0xffffffff) {
      sLength._0_2_ = *(undefined2 *)(tagInfo->sSubData + (long)piVar1[300] + 3);
      sLength[2] = tagInfo->sSubData[(long)piVar1[300] + 5];
      uVar4 = strtol(sLength,(char **)0x0,10);
      *length = (int)uVar4;
      printf("indice (%d) tagname (%s) offset  (%d) length (%d)",(ulong)nIndice,tag_name,
             (ulong)(uint)piVar1[300],uVar4 & 0xffffffff);
      iVar2 = GetNps46SubTagType(nIndice);
      switch(iVar2) {
      case 0:
      case 4:
        memcpy(data,tagInfo->sSubData + (long)piVar1[300] + 6,(long)*length);
        uVar3 = 0;
        break;
      case 1:
      case 5:
        memcpy(data,tagInfo->sSubData + (long)piVar1[300] + 4,(long)*length);
        return 0;
      default:
        uVar3 = 0;
        break;
      case 6:
        HexToAscii((uchar *)(tagInfo->sSubData + (long)piVar1[300] + 4),(uchar *)data,*length * 2);
        *length = *length << 1;
        return 0;
      case 0xb:
      case 0xc:
        BcdToAscii((uchar *)(tagInfo->sSubData + (long)piVar1[300] + 4),(uchar *)data,*length * 2);
        *length = *length << 1;
        return 0;
      }
    }
  }
  return uVar3;
}



// WARNING: Unknown calling convention

int GetNpsF127Field(int field_no,TSNpsF127Info *msgInfo,char *data,int *nLength)

{
  undefined2 uVar1;
  int iVar2;
  int nLng;
  long lVar3;
  char *pcVar4;
  char szNpsF127FldLen [4];
  
  szNpsF127FldLen[0] = '\0';
  szNpsF127FldLen[1] = '\0';
  szNpsF127FldLen[2] = '\0';
  szNpsF127FldLen[3] = '\0';
  iVar2 = CheckBit(msgInfo->sBitMap,field_no);
  if (iVar2 == 0) {
    return -1;
  }
  iVar2 = GetNpsF127FieldType(field_no);
  uVar1 = szNpsF127FldLen._2_2_;
  switch(iVar2) {
  case 0:
    nLng = GetNpsF127FieldLength(field_no);
    HexToAscii((uchar *)(msgInfo->sData + msgInfo->nFieldPos[field_no]),(uchar *)data,nLng);
    data[nLng] = '\0';
    *nLength = nLng;
    break;
  case 1:
  case 2:
    iVar2 = GetNpsF127FieldLength(field_no);
    memcpy(data,msgInfo->sData + msgInfo->nFieldPos[field_no],(long)iVar2);
    data[iVar2] = '\0';
    *nLength = iVar2;
    iVar2 = 0;
    break;
  case 3:
    szNpsF127FldLen._0_2_ = *(undefined2 *)(msgInfo->sData + msgInfo->nFieldPos[field_no]);
    szNpsF127FldLen = (char  [4])CONCAT22(uVar1,szNpsF127FldLen._0_2_);
    lVar3 = strtol(szNpsF127FldLen,(char **)0x0,10);
    iVar2 = (int)lVar3;
    pcVar4 = msgInfo->sData + (long)msgInfo->nFieldPos[field_no] + 2;
    goto LAB_0041f443;
  case 4:
    szNpsF127FldLen._0_2_ = *(undefined2 *)(msgInfo->sData + msgInfo->nFieldPos[field_no]);
    szNpsF127FldLen = (char  [4])CONCAT22(uVar1,szNpsF127FldLen._0_2_);
    lVar3 = strtol(szNpsF127FldLen,(char **)0x0,10);
    iVar2 = (int)lVar3;
    pcVar4 = msgInfo->sData + (long)msgInfo->nFieldPos[field_no] + 2;
    goto LAB_0041f318;
  case 5:
    szNpsF127FldLen._0_2_ = *(undefined2 *)(msgInfo->sData + msgInfo->nFieldPos[field_no]);
    szNpsF127FldLen = (char  [4])CONCAT22(uVar1,szNpsF127FldLen._0_2_);
    lVar3 = strtol(szNpsF127FldLen,(char **)0x0,10);
    memcpy(data,msgInfo->sData + (long)msgInfo->nFieldPos[field_no] + 2,(long)(int)lVar3);
    *nLength = (int)lVar3;
    iVar2 = 0;
    break;
  case 6:
    szNpsF127FldLen._0_3_ = *(undefined3 *)(msgInfo->sData + msgInfo->nFieldPos[field_no]);
    lVar3 = strtol(szNpsF127FldLen,(char **)0x0,10);
    iVar2 = (int)lVar3;
    pcVar4 = msgInfo->sData + (long)msgInfo->nFieldPos[field_no] + 3;
LAB_0041f443:
    HexToAscii((uchar *)pcVar4,(uchar *)data,iVar2);
    data[iVar2] = '\0';
    *nLength = iVar2;
    iVar2 = 0;
    break;
  case 7:
    szNpsF127FldLen._0_3_ = *(undefined3 *)(msgInfo->sData + msgInfo->nFieldPos[field_no]);
    lVar3 = strtol(szNpsF127FldLen,(char **)0x0,10);
    iVar2 = (int)lVar3;
    pcVar4 = msgInfo->sData + (long)msgInfo->nFieldPos[field_no] + 3;
LAB_0041f318:
    memcpy(data,pcVar4,(long)iVar2);
    data[iVar2] = '\0';
    *nLength = iVar2;
    iVar2 = 0;
    break;
  case 8:
    szNpsF127FldLen._0_3_ = *(undefined3 *)(msgInfo->sData + msgInfo->nFieldPos[field_no]);
    lVar3 = strtol(szNpsF127FldLen,(char **)0x0,10);
    memcpy(data,msgInfo->sData + (long)msgInfo->nFieldPos[field_no] + 3,(long)(int)lVar3);
    *nLength = (int)lVar3;
    iVar2 = 0;
    break;
  default:
    iVar2 = -1;
  }
  return iVar2;
}



// WARNING: Unknown calling convention

int AddNpsF127Field(int field_no,TSNpsF127Info *msgInfo,char *data,int nLength)

{
  char *cPtr;
  int iVar1;
  char szNpsF127FldLen [4];
  
  cPtr = msgInfo->sBitMap;
  iVar1 = CheckBit(cPtr,field_no);
  if (iVar1 != 0) {
LAB_0041f5fa:
    return -1;
  }
  msgInfo->nFieldPos[field_no] = msgInfo->nLength;
  iVar1 = GetNpsF127FieldType(field_no);
  switch(iVar1) {
  case 0:
    iVar1 = GetNpsF127FieldLength(field_no);
    if (iVar1 != nLength) {
      return -1;
    }
    iVar1 = msgInfo->nLength;
    goto LAB_0041f696;
  case 1:
  case 2:
    iVar1 = GetNpsF127FieldLength(field_no);
    if (iVar1 != nLength) {
      return -1;
    }
    memcpy(msgInfo->sData + msgInfo->nLength,data,(long)nLength);
    goto LAB_0041f5e2;
  case 3:
    sprintf(szNpsF127FldLen,"%.2d",(ulong)(uint)nLength);
    *(undefined2 *)(msgInfo->sData + msgInfo->nLength) = szNpsF127FldLen._0_2_;
    iVar1 = msgInfo->nLength + 2;
    break;
  case 4:
  case 5:
    sprintf(szNpsF127FldLen,"%.2d",(ulong)(uint)nLength);
    *(undefined2 *)(msgInfo->sData + msgInfo->nLength) = szNpsF127FldLen._0_2_;
    iVar1 = msgInfo->nLength + 2;
    goto LAB_0041f5ca;
  case 6:
    sprintf(szNpsF127FldLen,"%.3d",(ulong)(uint)nLength);
    iVar1 = msgInfo->nLength;
    *(undefined2 *)(msgInfo->sData + iVar1) = szNpsF127FldLen._0_2_;
    msgInfo->sData[(long)iVar1 + 2] = szNpsF127FldLen[2];
    iVar1 = msgInfo->nLength + 3;
    break;
  case 7:
  case 8:
    sprintf(szNpsF127FldLen,"%.3d",(ulong)(uint)nLength);
    iVar1 = msgInfo->nLength;
    *(undefined2 *)(msgInfo->sData + iVar1) = szNpsF127FldLen._0_2_;
    msgInfo->sData[(long)iVar1 + 2] = szNpsF127FldLen[2];
    iVar1 = msgInfo->nLength + 3;
LAB_0041f5ca:
    msgInfo->nLength = iVar1;
    memcpy(msgInfo->sData + iVar1,data,(long)nLength);
    goto LAB_0041f5e2;
  default:
    goto LAB_0041f5fa;
  }
  msgInfo->nLength = iVar1;
LAB_0041f696:
  nLength = AsciiToHex((uchar *)data,(uchar *)(msgInfo->sData + iVar1),nLength);
LAB_0041f5e2:
  msgInfo->nLength = msgInfo->nLength + nLength;
  SetBit(cPtr,field_no + 1);
  if ((0x40 < field_no) && (SetBit(cPtr,1), 0x7f < field_no)) {
    SetBit(cPtr,0x41);
  }
  return 0;
}



// WARNING: Unknown calling convention

int InsertNpsF127Field(int field_no,TSNpsF127Info *msgInfo,char *data,int nLength)

{
  char *cPtr;
  int iVar1;
  int iVar2;
  size_t __n;
  int *piVar3;
  char *local_160;
  char szNpsF127FldLen [4];
  char szNpsF127Data [260];
  
  cPtr = msgInfo->sBitMap;
  __n = (size_t)nLength;
  iVar2 = CheckBit(cPtr,field_no);
  if (iVar2 != 0) {
    return -1;
  }
  iVar2 = GetNpsF127FieldType(field_no);
  switch(iVar2) {
  case 0:
    iVar2 = GetNpsF127FieldLength(field_no);
    if (iVar2 != nLength) {
      return -1;
    }
    iVar2 = AsciiToHex((uchar *)data,(uchar *)szNpsF127Data,nLength);
    __n = (size_t)iVar2;
    break;
  case 1:
  case 2:
    iVar2 = GetNpsF127FieldLength(field_no);
    if (iVar2 != nLength) {
      return -1;
    }
    memcpy(szNpsF127Data,data,__n);
    break;
  case 3:
    sprintf(szNpsF127FldLen,"%.2d",(ulong)(uint)nLength);
    szNpsF127Data[0] = szNpsF127FldLen[0];
    szNpsF127Data[1] = szNpsF127FldLen[1];
    iVar2 = AsciiToHex((uchar *)data,(uchar *)(szNpsF127Data + 2),nLength);
    iVar2 = iVar2 + 2;
    __n = (size_t)iVar2;
    break;
  case 4:
  case 5:
    iVar2 = nLength + 2;
    sprintf(szNpsF127FldLen,"%.2d",(ulong)(uint)nLength);
    __n = (size_t)iVar2;
    szNpsF127Data[0] = szNpsF127FldLen[0];
    szNpsF127Data[1] = szNpsF127FldLen[1];
    memcpy(szNpsF127Data + 2,data,(long)nLength);
    break;
  case 6:
    sprintf(szNpsF127FldLen,"%.3d",(ulong)(uint)nLength);
    szNpsF127Data[0] = szNpsF127FldLen[0];
    szNpsF127Data[1] = szNpsF127FldLen[1];
    szNpsF127Data[2] = szNpsF127FldLen[2];
    iVar2 = AsciiToHex((uchar *)data,(uchar *)(szNpsF127Data + 3),nLength);
    iVar2 = iVar2 + 3;
    __n = (size_t)iVar2;
    break;
  case 7:
  case 8:
    iVar2 = nLength + 3;
    sprintf(szNpsF127FldLen,"%.3d",(ulong)(uint)nLength);
    __n = (size_t)iVar2;
    szNpsF127Data[0] = szNpsF127FldLen[0];
    szNpsF127Data[1] = szNpsF127FldLen[1];
    szNpsF127Data[2] = szNpsF127FldLen[2];
    memcpy(szNpsF127Data + 3,data,(long)nLength);
    break;
  default:
    return -1;
  }
  local_160 = szNpsF127Data;
  if (field_no < 0x13) {
    piVar3 = msgInfo->nFieldPos + 0x14;
    do {
      iVar1 = piVar3[-1];
      memcpy(msgInfo->sData + (long)iVar1 + __n,msgInfo->sData + iVar1,(long)(*piVar3 - iVar1));
      *piVar3 = *piVar3 + iVar2;
      piVar3 = piVar3 + -1;
    } while (piVar3 != (int *)((long)msgInfo + (ulong)(0x12 - field_no) * -4 + 0x4c));
  }
  memcpy(msgInfo->sData + msgInfo->nFieldPos[field_no],local_160,__n);
  msgInfo->nLength = msgInfo->nLength + iVar2;
  SetBit(cPtr,field_no + 1);
  if (field_no - 0x41U < 0x3f) {
    SetBit(cPtr,1);
  }
  else if (0x7f < field_no) {
    SetBit(cPtr,0x41);
  }
  return 0;
}



// WARNING: Unknown calling convention

int PutNpsF127Field(int field_no,TSNpsF127Info *msgInfo,char *data,int nLength)

{
  char *cPtr;
  int *piVar1;
  int iVar2;
  int iVar3;
  int iVar4;
  int *piVar5;
  size_t local_180;
  char *local_160;
  char szNpsF127FldLen [4];
  char szNpsF127Data [260];
  
  cPtr = msgInfo->sBitMap;
  local_180 = (size_t)nLength;
  iVar2 = CheckBit(cPtr,field_no);
  if (iVar2 == 0) {
    iVar2 = InsertNpsF127Field(field_no,msgInfo,data,nLength);
    return iVar2;
  }
  iVar4 = -1;
  iVar2 = GetNpsF127FieldType(field_no);
  switch(iVar2) {
  case 0:
    iVar2 = GetNpsF127FieldLength(field_no);
    if (iVar2 != nLength) {
      return -1;
    }
    iVar2 = AsciiToHex((uchar *)data,(uchar *)szNpsF127Data,nLength);
    local_180 = (size_t)iVar2;
    break;
  case 1:
  case 2:
    iVar2 = GetNpsF127FieldLength(field_no);
    if (iVar2 != nLength) {
      return -1;
    }
    memcpy(szNpsF127Data,data,local_180);
    break;
  case 3:
    sprintf(szNpsF127FldLen,"%.2d",(ulong)(uint)nLength);
    szNpsF127Data[0] = szNpsF127FldLen[0];
    szNpsF127Data[1] = szNpsF127FldLen[1];
    iVar2 = AsciiToHex((uchar *)data,(uchar *)(szNpsF127Data + 2),nLength);
    iVar2 = iVar2 + 2;
    local_180 = (size_t)iVar2;
    break;
  case 4:
  case 5:
    sprintf(szNpsF127FldLen,"%.2d",(ulong)(uint)nLength);
    iVar2 = nLength + 2;
    szNpsF127Data[0] = szNpsF127FldLen[0];
    szNpsF127Data[1] = szNpsF127FldLen[1];
    memcpy(szNpsF127Data + 2,data,(long)nLength);
    local_180 = (size_t)iVar2;
    break;
  case 6:
    sprintf(szNpsF127FldLen,"%.3d",(ulong)(uint)nLength);
    szNpsF127Data[0] = szNpsF127FldLen[0];
    szNpsF127Data[1] = szNpsF127FldLen[1];
    szNpsF127Data[2] = szNpsF127FldLen[2];
    iVar2 = AsciiToHex((uchar *)data,(uchar *)(szNpsF127Data + 3),nLength);
    iVar2 = iVar2 + 3;
    local_180 = (size_t)iVar2;
    break;
  case 7:
  case 8:
    sprintf(szNpsF127FldLen,"%.3d",(ulong)(uint)nLength);
    iVar2 = nLength + 3;
    szNpsF127Data[0] = szNpsF127FldLen[0];
    szNpsF127Data[1] = szNpsF127FldLen[1];
    szNpsF127Data[2] = szNpsF127FldLen[2];
    memcpy(szNpsF127Data + 3,data,(long)nLength);
    local_180 = (size_t)iVar2;
    break;
  default:
    goto switchD_0041fabf_default;
  }
  local_160 = szNpsF127Data;
  piVar1 = msgInfo->nFieldPos + (field_no + 1);
  iVar4 = msgInfo->nFieldPos[field_no];
  iVar3 = *piVar1 - iVar4;
  if (field_no < 0x13) {
    piVar5 = msgInfo->nFieldPos + 0x14;
    iVar2 = iVar2 - iVar3;
    do {
      iVar4 = piVar5[-1];
      memcpy((void *)((long)msgInfo + (long)iVar4 + 0x84 + (local_180 - (long)iVar3)),
             msgInfo->sData + iVar4,(long)(*piVar5 - iVar4));
      *piVar5 = *piVar5 + iVar2;
      piVar5 = piVar5 + -1;
    } while (piVar5 != (int *)((long)msgInfo + (ulong)(0x12 - field_no) * -4 + 0x4c));
    iVar4 = msgInfo->nFieldPos[field_no];
  }
  else {
    iVar2 = iVar2 - iVar3;
  }
  memcpy(msgInfo->sData + iVar4,local_160,local_180);
  *piVar1 = *piVar1 + iVar2;
  msgInfo->nLength = msgInfo->nLength + iVar2;
  SetBit(cPtr,field_no + 1);
  if (field_no - 0x41U < 0x3f) {
    iVar4 = 0;
    SetBit(cPtr,1);
  }
  else {
    iVar4 = 0;
    if (0x7f < field_no) {
      SetBit(cPtr,0x41);
    }
  }
switchD_0041fabf_default:
  return iVar4;
}



// WARNING: Unknown calling convention

int NpsF127BuildBuff(char *buffer_snd,TSNpsF127Info *msgInfo)

{
  *(undefined8 *)buffer_snd = *(undefined8 *)msgInfo->sBitMap;
  memcpy(buffer_snd + 8,msgInfo->sData,(long)msgInfo->nLength);
  return msgInfo->nLength + 8;
}



// WARNING: Unknown calling convention

int NpsF127BuildHeader(char *pNewHeader,int sLen,TSNpsF127Info *NpsF127Info)

{
  sprintf(pNewHeader,"%04d",(ulong)(sLen + 0xf));
  builtin_strncpy(pNewHeader + 4,"ISO60000",8);
  return 0;
}



// WARNING: Unknown calling convention

void DumpNpsData(char *data)

{
  char *pcVar1;
  bool bVar2;
  int iVar3;
  ulong uVar4;
  long lVar5;
  uint uVar6;
  char *pcVar7;
  uint uVar8;
  long lVar9;
  byte bVar10;
  int nLength;
  char CardTrunc [23];
  TSNpsInfo msgInfo;
  TSSubTagNps msgSubFldInfo;
  char sWork [4096];
  char sTempField [4096];
  char sLine [4096];
  
  bVar10 = 0;
  lVar9 = 0;
  CardTrunc[0] = '\0';
  CardTrunc[1] = '\0';
  CardTrunc[2] = '\0';
  CardTrunc[3] = '\0';
  CardTrunc[4] = '\0';
  CardTrunc[5] = '\0';
  CardTrunc[6] = '\0';
  CardTrunc[7] = '\0';
  CardTrunc[8] = '\0';
  CardTrunc[9] = '\0';
  CardTrunc[10] = '\0';
  CardTrunc[0xb] = '\0';
  CardTrunc[0xc] = '\0';
  CardTrunc[0xd] = '\0';
  CardTrunc[0xe] = '\0';
  CardTrunc[0xf] = '\0';
  CardTrunc[0x10] = '\0';
  CardTrunc[0x11] = '\0';
  CardTrunc[0x12] = '\0';
  CardTrunc[0x13] = '\0';
  CardTrunc[0x16] = '\0';
  pcVar7 = sWork;
  for (lVar5 = 0x200; lVar5 != 0; lVar5 = lVar5 + -1) {
    pcVar7[0] = '\0';
    pcVar7[1] = '\0';
    pcVar7[2] = '\0';
    pcVar7[3] = '\0';
    pcVar7[4] = '\0';
    pcVar7[5] = '\0';
    pcVar7[6] = '\0';
    pcVar7[7] = '\0';
    pcVar7 = pcVar7 + 8;
  }
  pcVar7 = sTempField;
  for (lVar5 = 0x200; lVar5 != 0; lVar5 = lVar5 + -1) {
    pcVar7[0] = '\0';
    pcVar7[1] = '\0';
    pcVar7[2] = '\0';
    pcVar7[3] = '\0';
    pcVar7[4] = '\0';
    pcVar7[5] = '\0';
    pcVar7[6] = '\0';
    pcVar7[7] = '\0';
    pcVar7 = pcVar7 + 8;
  }
  pcVar7 = sLine;
  for (lVar5 = 0x200; lVar5 != 0; lVar5 = lVar5 + -1) {
    pcVar7[0] = '\0';
    pcVar7[1] = '\0';
    pcVar7[2] = '\0';
    pcVar7[3] = '\0';
    pcVar7[4] = '\0';
    pcVar7[5] = '\0';
    pcVar7[6] = '\0';
    pcVar7[7] = '\0';
    pcVar7 = pcVar7 + 8;
  }
  CardTrunc[0x14] = '\0';
  CardTrunc[0x15] = '\0';
  InitNpsInfo(&msgInfo);
  InitNpsSubFldInfo(&msgSubFldInfo);
  AnalyseNps(data,&msgInfo);
  builtin_strncpy(sLine + 0x20,"---",4);
  builtin_strncpy(sLine,"- BIT MAP    -------------------",0x20);
  pcVar7 = sLine + 0xd;
  do {
    pcVar1 = msgInfo.sBitMap + lVar9;
    lVar9 = lVar9 + 1;
    sprintf(pcVar7," %02X",(ulong)(uint)(int)*pcVar1);
    pcVar7 = pcVar7 + 3;
  } while ((int)lVar9 < (int)(((int)msgInfo.sBitMap[0] >> 0x1f & 8U) + 8));
  trace_event(sLine,4);
  builtin_strncpy(sLine,"-----------------------------------",0x24);
  uVar6 = 0;
  trace_event(sLine,4);
  sprintf(sLine,"- M.T.I      : [%04d]",(ulong)(uint)msgInfo.nMsgType);
  trace_event(sLine,4);
  builtin_strncpy(sLine,"- FLD (FIELD): LENGTH : DATA        ",0x25);
  trace_event(sLine,4);
  builtin_strncpy(sLine,"-----------------------------------",0x24);
  trace_event(sLine,4);
  uVar8 = 2;
  do {
    pcVar7 = sWork;
    for (lVar5 = 0x200; lVar5 != 0; lVar5 = lVar5 + -1) {
      pcVar7[0] = '\0';
      pcVar7[1] = '\0';
      pcVar7[2] = '\0';
      pcVar7[3] = '\0';
      pcVar7[4] = '\0';
      pcVar7[5] = '\0';
      pcVar7[6] = '\0';
      pcVar7[7] = '\0';
      pcVar7 = pcVar7 + (ulong)bVar10 * -0x10 + 8;
    }
    iVar3 = GetNpsField(uVar6 + 1,&msgInfo,sWork,&nLength);
    if (iVar3 == 0) {
      pcVar7 = sWork;
      if (uVar6 < 0x33) {
        uVar4 = 1L << ((byte)uVar6 & 0x3f);
        if ((uVar4 & 0x4280200000000) == 0) {
          if (((uVar4 & 1) != 0) && (debug_option != 1)) {
            TrunCard(sWork,CardTrunc);
            pcVar7 = CardTrunc;
          }
          goto LAB_00420126;
        }
        if (debug_option == 1) goto LAB_00420126;
        sprintf(sLine,"- FLD (%03d)     (%03d)    [**********************]",(ulong)uVar8,
                (ulong)(uint)nLength);
      }
      else {
LAB_00420126:
        sprintf(sLine,"- FLD (%03d)     (%03d)    [%s]",(ulong)uVar8,(ulong)(uint)nLength,pcVar7);
      }
      trace_event(sLine,4);
    }
    uVar6 = uVar6 + 1;
    bVar2 = (int)(((int)msgInfo.sBitMap[0] >> 0x1f & 0x40U) + 0x40) < (int)uVar8;
    uVar8 = uVar8 + 1;
    if (bVar2) {
      trace_event("DumpNpsData ended.",4);
      return;
    }
  } while( true );
}



// WARNING: Unknown calling convention

void DumpNps(char *data)

{
  char sLine [4096];
  
  trace_event("Start NEW DumpNps()",5);
  builtin_strncpy(sLine,"-----------------------------------",0x24);
  trace_event(sLine,4);
  DumpNpsData(data);
  trace_event("End   DumpNps()",5);
  return;
}



// WARNING: Unknown calling convention

void DumpStructNps(TSNpsInfo *NpsInfo)

{
  long lVar1;
  TSIsoInfo *in_RDX;
  char *pcVar2;
  char vBuffer [4096];
  
  pcVar2 = vBuffer;
  for (lVar1 = 0x200; lVar1 != 0; lVar1 = lVar1 + -1) {
    *(undefined8 *)pcVar2 = 0;
    pcVar2 = (char *)((long)pcVar2 + 8);
  }
  NpsBuildMsg(vBuffer,NpsInfo,in_RDX);
  DumpNps(vBuffer);
  return;
}



// WARNING: Unknown calling convention

void NpsDumpIccFields(char *sIccData,int nIccLen)

{
  int iVar1;
  long lVar2;
  char *pcVar3;
  undefined **ppuVar4;
  char *__format;
  NPSTAG *pNVar5;
  char *pcVar6;
  char **ppcVar7;
  byte bVar8;
  int nLen;
  NPSTAG aIccNpsTag [26];
  TSTagNps lTagNps;
  char sWork [4096];
  char sLine [4096];
  
  bVar8 = 0;
  nLen = 0;
  ppuVar4 = &PTR_s_NPS_TAG_ISS_SCRIPT1_006fe9c0;
  pNVar5 = aIccNpsTag;
  for (lVar2 = 0x34; lVar2 != 0; lVar2 = lVar2 + -1) {
    pNVar5->sTagDesc = *ppuVar4;
    ppuVar4 = ppuVar4 + 1;
    pNVar5 = (NPSTAG *)&pNVar5->sTagValue;
  }
  trace_event("Start NpsDumpIccFields()",5);
  pcVar6 = sWork;
  for (lVar2 = 0x200; lVar2 != 0; lVar2 = lVar2 + -1) {
    pcVar6[0] = '\0';
    pcVar6[1] = '\0';
    pcVar6[2] = '\0';
    pcVar6[3] = '\0';
    pcVar6[4] = '\0';
    pcVar6[5] = '\0';
    pcVar6[6] = '\0';
    pcVar6[7] = '\0';
    pcVar6 = pcVar6 + (ulong)bVar8 * -0x10 + 8;
  }
  pcVar6 = sLine;
  for (lVar2 = 0x200; lVar2 != 0; lVar2 = lVar2 + -1) {
    pcVar6[0] = '\0';
    pcVar6[1] = '\0';
    pcVar6[2] = '\0';
    pcVar6[3] = '\0';
    pcVar6[4] = '\0';
    pcVar6[5] = '\0';
    pcVar6[6] = '\0';
    pcVar6[7] = '\0';
    pcVar6 = pcVar6 + (ulong)bVar8 * -0x10 + 8;
  }
  InitNpsIcTag(&lTagNps);
  AnalyseNpsIc(sIccData,nIccLen,&lTagNps);
  ppcVar7 = &aIccNpsTag[0].sTagValue;
  trace_event("         Field                         | Len  |              Value",4);
  do {
    pcVar6 = sWork;
    for (lVar2 = 0x200; lVar2 != 0; lVar2 = lVar2 + -1) {
      pcVar6[0] = '\0';
      pcVar6[1] = '\0';
      pcVar6[2] = '\0';
      pcVar6[3] = '\0';
      pcVar6[4] = '\0';
      pcVar6[5] = '\0';
      pcVar6[6] = '\0';
      pcVar6[7] = '\0';
      pcVar6 = pcVar6 + (ulong)bVar8 * -0x10 + 8;
    }
    pcVar6 = *ppcVar7;
    iVar1 = GetNpsIcTag(pcVar6,&lTagNps,sWork,&nLen);
    if (iVar1 == 0) {
      if (debug_option == 0) {
        iVar1 = memcmp(pcVar6,&DAT_004d6e34,2);
        if (iVar1 != 0) {
          iVar1 = memcmp(pcVar6,&DAT_004a744c,2);
          if (iVar1 != 0) goto LAB_00420410;
        }
        pcVar3 = ((NPSTAG *)(ppcVar7 + -1))->sTagDesc;
        __format = " >> %s|%s : [%03d] : [.....................]";
      }
      else {
LAB_00420410:
        pcVar3 = ((NPSTAG *)(ppcVar7 + -1))->sTagDesc;
        __format = " >> %s|%s : [%03d] : [%s]";
      }
      sprintf(sLine,__format,pcVar6,pcVar3,(ulong)(uint)nLen,sWork);
      trace_event(sLine,4);
    }
    ppcVar7 = ppcVar7 + 2;
    if (ppcVar7 == (char **)(lTagNps.nPresent + 2)) {
      return;
    }
  } while( true );
}



// WARNING: Unknown calling convention

int IsoToNps55Icc(TSNpsInfo *NpsInfo,TSIsoInfo *IsoInfo)

{
  int iVar1;
  long lVar2;
  char *pcVar3;
  byte bVar4;
  int tmpFieldLen;
  char tmpField [256];
  TSTagNps NpsIccInfo;
  TSTagIso TagIso;
  char sIccBuffer [4096];
  
  bVar4 = 0;
  trace_event("Start IsoToNps55Icc()",5);
  pcVar3 = tmpField;
  for (lVar2 = 0x20; lVar2 != 0; lVar2 = lVar2 + -1) {
    pcVar3[0] = '\0';
    pcVar3[1] = '\0';
    pcVar3[2] = '\0';
    pcVar3[3] = '\0';
    pcVar3[4] = '\0';
    pcVar3[5] = '\0';
    pcVar3[6] = '\0';
    pcVar3[7] = '\0';
    pcVar3 = pcVar3 + (ulong)bVar4 * -0x10 + 8;
  }
  pcVar3 = sIccBuffer;
  for (lVar2 = 0x200; lVar2 != 0; lVar2 = lVar2 + -1) {
    pcVar3[0] = '\0';
    pcVar3[1] = '\0';
    pcVar3[2] = '\0';
    pcVar3[3] = '\0';
    pcVar3[4] = '\0';
    pcVar3[5] = '\0';
    pcVar3[6] = '\0';
    pcVar3[7] = '\0';
    pcVar3 = pcVar3 + (ulong)bVar4 * -0x10 + 8;
  }
  InitIsoIcTag(&TagIso);
  InitNpsIcTag(&NpsIccInfo);
  DumpStructNps(NpsInfo);
  iVar1 = GetIsoField(0x36,IsoInfo,tmpField,&tmpFieldLen);
  if (iVar1 == 0) {
    trace_event("Processing Iso Field 55",5);
    IsoDumpIccFields(tmpField,tmpFieldLen);
    AnalyseIsoIc(tmpField,tmpFieldLen,&TagIso);
    iVar1 = GetIsoIcTag("7100",&TagIso,tmpField,&tmpFieldLen);
    if (iVar1 == 0) {
      AddNpsIcTag("7100",&NpsIccInfo,tmpField,tmpFieldLen);
    }
    iVar1 = GetIsoIcTag("7200",&TagIso,tmpField,&tmpFieldLen);
    if (iVar1 == 0) {
      AddNpsIcTag("7200",&NpsIccInfo,tmpField,tmpFieldLen);
    }
    iVar1 = GetIsoIcTag("8200",&TagIso,tmpField,&tmpFieldLen);
    if (iVar1 == 0) {
      AddNpsIcTag("8200",&NpsIccInfo,tmpField,tmpFieldLen);
    }
    iVar1 = GetIsoIcTag("8400",&TagIso,tmpField,&tmpFieldLen);
    if (iVar1 == 0) {
      AddNpsIcTag("8400",&NpsIccInfo,tmpField,tmpFieldLen);
    }
    iVar1 = GetIsoIcTag("8A00",&TagIso,tmpField,&tmpFieldLen);
    if (iVar1 == 0) {
      AddNpsIcTag("8A00",&NpsIccInfo,tmpField,tmpFieldLen);
    }
    iVar1 = GetIsoIcTag("9100",&TagIso,tmpField,&tmpFieldLen);
    if (iVar1 == 0) {
      AddNpsIcTag("9100",&NpsIccInfo,tmpField,tmpFieldLen);
    }
    iVar1 = GetIsoIcTag("9500",&TagIso,tmpField,&tmpFieldLen);
    if (iVar1 == 0) {
      AddNpsIcTag("9500",&NpsIccInfo,tmpField,tmpFieldLen);
    }
    iVar1 = GetIsoIcTag("9A00",&TagIso,tmpField,&tmpFieldLen);
    if (iVar1 == 0) {
      AddNpsIcTag("9A00",&NpsIccInfo,tmpField,tmpFieldLen);
    }
    iVar1 = GetIsoIcTag("9C00",&TagIso,tmpField,&tmpFieldLen);
    if (iVar1 == 0) {
      AddNpsIcTag("9C00",&NpsIccInfo,tmpField,tmpFieldLen);
    }
    iVar1 = GetIsoIcTag("5F2A",&TagIso,tmpField,&tmpFieldLen);
    if (iVar1 == 0) {
      AddNpsIcTag("5F2A",&NpsIccInfo,tmpField,tmpFieldLen);
    }
    iVar1 = GetIsoIcTag("9F02",&TagIso,tmpField,&tmpFieldLen);
    if (iVar1 == 0) {
      AddNpsIcTag("9F02",&NpsIccInfo,tmpField,tmpFieldLen);
    }
    iVar1 = GetIsoIcTag("9F03",&TagIso,tmpField,&tmpFieldLen);
    if (iVar1 == 0) {
      AddNpsIcTag("9F03",&NpsIccInfo,tmpField,tmpFieldLen);
    }
    iVar1 = GetIsoIcTag("9F09",&TagIso,tmpField,&tmpFieldLen);
    if (iVar1 == 0) {
      AddNpsIcTag("9F09",&NpsIccInfo,tmpField,tmpFieldLen);
    }
    iVar1 = GetIsoIcTag("9F10",&TagIso,tmpField,&tmpFieldLen);
    if (iVar1 == 0) {
      AddNpsIcTag("9F10",&NpsIccInfo,tmpField,tmpFieldLen);
    }
    iVar1 = GetIsoIcTag("9F1A",&TagIso,tmpField,&tmpFieldLen);
    if (iVar1 == 0) {
      AddNpsIcTag("9F1A",&NpsIccInfo,tmpField,tmpFieldLen);
    }
    iVar1 = GetIsoIcTag("9F1E",&TagIso,tmpField,&tmpFieldLen);
    if (iVar1 == 0) {
      AddNpsIcTag("9F1E",&NpsIccInfo,tmpField,tmpFieldLen);
    }
    iVar1 = GetIsoIcTag("9F26",&TagIso,tmpField,&tmpFieldLen);
    if (iVar1 == 0) {
      AddNpsIcTag("9F26",&NpsIccInfo,tmpField,tmpFieldLen);
    }
    iVar1 = GetIsoIcTag("9F27",&TagIso,tmpField,&tmpFieldLen);
    if (iVar1 == 0) {
      AddNpsIcTag("9F27",&NpsIccInfo,tmpField,tmpFieldLen);
    }
    iVar1 = GetIsoIcTag("9F33",&TagIso,tmpField,&tmpFieldLen);
    if (iVar1 == 0) {
      AddNpsIcTag("9F33",&NpsIccInfo,tmpField,tmpFieldLen);
    }
    iVar1 = GetIsoIcTag("9F34",&TagIso,tmpField,&tmpFieldLen);
    if (iVar1 == 0) {
      AddNpsIcTag("9F34",&NpsIccInfo,tmpField,tmpFieldLen);
    }
    iVar1 = GetIsoIcTag("9F35",&TagIso,tmpField,&tmpFieldLen);
    if (iVar1 == 0) {
      AddNpsIcTag("9F35",&NpsIccInfo,tmpField,tmpFieldLen);
    }
    iVar1 = GetIsoIcTag("9F36",&TagIso,tmpField,&tmpFieldLen);
    if (iVar1 == 0) {
      AddNpsIcTag("9F36",&NpsIccInfo,tmpField,tmpFieldLen);
    }
    iVar1 = GetIsoIcTag("9F37",&TagIso,tmpField,&tmpFieldLen);
    if (iVar1 == 0) {
      AddNpsIcTag("9F37",&NpsIccInfo,tmpField,tmpFieldLen);
    }
    iVar1 = GetIsoIcTag("9F41",&TagIso,tmpField,&tmpFieldLen);
    if (iVar1 == 0) {
      AddNpsIcTag("9F41",&NpsIccInfo,tmpField,tmpFieldLen);
    }
    iVar1 = GetIsoIcTag("9F53",&TagIso,tmpField,&tmpFieldLen);
    if (iVar1 == 0) {
      AddNpsIcTag("9F53",&NpsIccInfo,tmpField,tmpFieldLen);
    }
    tmpFieldLen = 0;
    tmpFieldLen = NpsBuildIcFld(sIccBuffer,&NpsIccInfo);
    if (0 < tmpFieldLen) {
      PutNpsField(0x36,NpsInfo,sIccBuffer,tmpFieldLen);
    }
  }
  else {
    trace_event("----->NO ISO_ICC_DATA<-----",5);
  }
  trace_event("End   IsoToNps55Icc(OK)",5);
  return 0;
}



// WARNING: Unknown calling convention

int NpsToIso55Icc(TSNpsInfo *p_NpsInfo,TSIsoInfo *p_IsoInfo)

{
  int iVar1;
  long lVar2;
  char *pcVar3;
  byte bVar4;
  int tmpFieldLen;
  TSTagNps NPSIccInfo;
  TSTagIso v_TagIso;
  char tmpField [4096];
  char sIccBuffer [4096];
  
  bVar4 = 0;
  trace_event("Start NpsToIso55Icc()",5);
  pcVar3 = tmpField;
  for (lVar2 = 0x200; lVar2 != 0; lVar2 = lVar2 + -1) {
    pcVar3[0] = '\0';
    pcVar3[1] = '\0';
    pcVar3[2] = '\0';
    pcVar3[3] = '\0';
    pcVar3[4] = '\0';
    pcVar3[5] = '\0';
    pcVar3[6] = '\0';
    pcVar3[7] = '\0';
    pcVar3 = pcVar3 + (ulong)bVar4 * -0x10 + 8;
  }
  pcVar3 = sIccBuffer;
  for (lVar2 = 0x200; lVar2 != 0; lVar2 = lVar2 + -1) {
    pcVar3[0] = '\0';
    pcVar3[1] = '\0';
    pcVar3[2] = '\0';
    pcVar3[3] = '\0';
    pcVar3[4] = '\0';
    pcVar3[5] = '\0';
    pcVar3[6] = '\0';
    pcVar3[7] = '\0';
    pcVar3 = pcVar3 + (ulong)bVar4 * -0x10 + 8;
  }
  InitNpsIcTag(&NPSIccInfo);
  InitIsoIcTag(&v_TagIso);
  iVar1 = GetNpsField(0x36,p_NpsInfo,tmpField,&tmpFieldLen);
  if (iVar1 == 0) {
    NpsDumpIccFields(tmpField,tmpFieldLen);
    AnalyseNpsIc(tmpField,tmpFieldLen,&NPSIccInfo);
    trace_event("Processing Nps Field 55",5);
    iVar1 = GetNpsIcTag("8400",&NPSIccInfo,tmpField,&tmpFieldLen);
    if (iVar1 == 0) {
      AddIsoIcTag("8400",&v_TagIso,tmpField,tmpFieldLen);
    }
    iVar1 = GetNpsIcTag("8200",&NPSIccInfo,tmpField,&tmpFieldLen);
    if (iVar1 == 0) {
      AddIsoIcTag("8200",&v_TagIso,tmpField,tmpFieldLen);
    }
    iVar1 = GetNpsIcTag("8A00",&NPSIccInfo,tmpField,&tmpFieldLen);
    if (iVar1 == 0) {
      AddIsoIcTag("8A00",&v_TagIso,tmpField,tmpFieldLen);
    }
    iVar1 = GetNpsIcTag("9100",&NPSIccInfo,tmpField,&tmpFieldLen);
    if (iVar1 == 0) {
      AddIsoIcTag("9100",&v_TagIso,tmpField,tmpFieldLen);
    }
    iVar1 = GetNpsIcTag("7100",&NPSIccInfo,tmpField,&tmpFieldLen);
    if (iVar1 == 0) {
      AddIsoIcTag("7100",&v_TagIso,tmpField,tmpFieldLen);
    }
    iVar1 = GetNpsIcTag("7200",&NPSIccInfo,tmpField,&tmpFieldLen);
    if (iVar1 == 0) {
      AddIsoIcTag("7200",&v_TagIso,tmpField,tmpFieldLen);
    }
    iVar1 = GetNpsIcTag("8600",&NPSIccInfo,tmpField,&tmpFieldLen);
    if (iVar1 == 0) {
      AddIsoIcTag("8600",&v_TagIso,tmpField,tmpFieldLen);
    }
    iVar1 = GetNpsIcTag("9F26",&NPSIccInfo,tmpField,&tmpFieldLen);
    if (iVar1 == 0) {
      AddIsoIcTag("9F26",&v_TagIso,tmpField,tmpFieldLen);
    }
    iVar1 = GetNpsIcTag("9F27",&NPSIccInfo,tmpField,&tmpFieldLen);
    if (iVar1 == 0) {
      AddIsoIcTag("9F27",&v_TagIso,tmpField,tmpFieldLen);
    }
    iVar1 = GetNpsIcTag("9F10",&NPSIccInfo,tmpField,&tmpFieldLen);
    if (iVar1 == 0) {
      AddIsoIcTag("9F10",&v_TagIso,tmpField,tmpFieldLen);
    }
    iVar1 = GetNpsIcTag("9F37",&NPSIccInfo,tmpField,&tmpFieldLen);
    if (iVar1 == 0) {
      AddIsoIcTag("9F37",&v_TagIso,tmpField,tmpFieldLen);
    }
    iVar1 = GetNpsIcTag("9F36",&NPSIccInfo,tmpField,&tmpFieldLen);
    if (iVar1 == 0) {
      AddIsoIcTag("9F36",&v_TagIso,tmpField,tmpFieldLen);
    }
    iVar1 = GetNpsIcTag("9500",&NPSIccInfo,tmpField,&tmpFieldLen);
    if (iVar1 == 0) {
      AddIsoIcTag("9500",&v_TagIso,tmpField,tmpFieldLen);
    }
    iVar1 = GetNpsIcTag("9A00",&NPSIccInfo,tmpField,&tmpFieldLen);
    if (iVar1 == 0) {
      AddIsoIcTag("9A00",&v_TagIso,tmpField,tmpFieldLen);
    }
    iVar1 = GetNpsIcTag("9C00",&NPSIccInfo,tmpField,&tmpFieldLen);
    if (iVar1 == 0) {
      AddIsoIcTag("9C00",&v_TagIso,tmpField,tmpFieldLen);
    }
    iVar1 = GetNpsIcTag("9F02",&NPSIccInfo,tmpField,&tmpFieldLen);
    if (iVar1 == 0) {
      AddIsoIcTag("9F02",&v_TagIso,tmpField,tmpFieldLen);
    }
    iVar1 = GetNpsIcTag("5F2A",&NPSIccInfo,tmpField,&tmpFieldLen);
    if (iVar1 == 0) {
      AddIsoIcTag("5F2A",&v_TagIso,tmpField,tmpFieldLen);
    }
    iVar1 = GetNpsIcTag("9F1A",&NPSIccInfo,tmpField,&tmpFieldLen);
    if (iVar1 == 0) {
      AddIsoIcTag("9F1A",&v_TagIso,tmpField,tmpFieldLen);
    }
    iVar1 = GetNpsIcTag("9F03",&NPSIccInfo,tmpField,&tmpFieldLen);
    if (iVar1 == 0) {
      AddIsoIcTag("9F03",&v_TagIso,tmpField,tmpFieldLen);
    }
    iVar1 = GetNpsIcTag("9F33",&NPSIccInfo,tmpField,&tmpFieldLen);
    if (iVar1 == 0) {
      AddIsoIcTag("9F33",&v_TagIso,tmpField,tmpFieldLen);
    }
    iVar1 = GetNpsIcTag("9F34",&NPSIccInfo,tmpField,&tmpFieldLen);
    if (iVar1 == 0) {
      AddIsoIcTag("9F34",&v_TagIso,tmpField,tmpFieldLen);
    }
    iVar1 = GetNpsIcTag("9F35",&NPSIccInfo,tmpField,&tmpFieldLen);
    if (iVar1 == 0) {
      AddIsoIcTag("9F35",&v_TagIso,tmpField,tmpFieldLen);
    }
    iVar1 = GetNpsIcTag("9F1E",&NPSIccInfo,tmpField,&tmpFieldLen);
    if (iVar1 == 0) {
      AddIsoIcTag("9F1E",&v_TagIso,tmpField,tmpFieldLen);
    }
    iVar1 = GetNpsIcTag("9F53",&NPSIccInfo,tmpField,&tmpFieldLen);
    if (iVar1 == 0) {
      AddIsoIcTag("9F53",&v_TagIso,tmpField,tmpFieldLen);
    }
    iVar1 = GetNpsIcTag("9F09",&NPSIccInfo,tmpField,&tmpFieldLen);
    if (iVar1 == 0) {
      AddIsoIcTag("9F09",&v_TagIso,tmpField,tmpFieldLen);
    }
    iVar1 = GetNpsIcTag("9F41",&NPSIccInfo,tmpField,&tmpFieldLen);
    if (iVar1 == 0) {
      AddIsoIcTag("9F41",&v_TagIso,tmpField,tmpFieldLen);
    }
    tmpFieldLen = IsoBuildIcFld(sIccBuffer,&v_TagIso);
    if (0 < tmpFieldLen) {
      PutIsoField(0x36,p_IsoInfo,sIccBuffer,tmpFieldLen);
      trace_event("----->ISO_ICC_DATA<------",5);
      IsoDumpIccFields(sIccBuffer,tmpFieldLen);
    }
  }
  else {
    trace_event("----->NO NPS_ICC_DATA<------",5);
  }
  trace_event("End   NpsToIso55Icc(OK)",5);
  return 0;
}



// WARNING: Unknown calling convention

int NwFormatToStatement(int nIndexCtx,char *record_data,char *statement)

{
  undefined8 uVar1;
  undefined8 uVar2;
  undefined4 uVar3;
  int iVar4;
  size_t sVar5;
  long lVar6;
  char *pcVar7;
  char *pcVar8;
  byte bVar9;
  char trxCrcy [4];
  int trans_nbr;
  char amount [21];
  char transaction [256];
  char detail [512];
  
  bVar9 = 0;
  statement[0] = '\0';
  statement[1] = '\0';
  statement[2] = '\0';
  statement[3] = '\0';
  statement[4] = '\0';
  statement[5] = '\0';
  statement[6] = '\0';
  statement[7] = '\0';
  amount[0] = '\0';
  amount[1] = '\0';
  amount[2] = '\0';
  amount[3] = '\0';
  amount[4] = '\0';
  amount[5] = '\0';
  amount[6] = '\0';
  amount[7] = '\0';
  amount[8] = '\0';
  amount[9] = '\0';
  amount[10] = '\0';
  amount[0xb] = '\0';
  amount[0xc] = '\0';
  amount[0xd] = '\0';
  amount[0xe] = '\0';
  amount[0xf] = '\0';
  amount[0x10] = '\0';
  amount[0x11] = '\0';
  amount[0x12] = '\0';
  amount[0x13] = '\0';
  amount[0x14] = '\0';
  pcVar7 = detail;
  for (lVar6 = 0x40; lVar6 != 0; lVar6 = lVar6 + -1) {
    pcVar7[0] = '\0';
    pcVar7[1] = '\0';
    pcVar7[2] = '\0';
    pcVar7[3] = '\0';
    pcVar7[4] = '\0';
    pcVar7[5] = '\0';
    pcVar7[6] = '\0';
    pcVar7[7] = '\0';
    pcVar7 = pcVar7 + 8;
  }
  builtin_strncpy(detail + 0x18,"t()",4);
  pcVar7 = transaction;
  for (lVar6 = 0x20; lVar6 != 0; lVar6 = lVar6 + -1) {
    pcVar7[0] = '\0';
    pcVar7[1] = '\0';
    pcVar7[2] = '\0';
    pcVar7[3] = '\0';
    pcVar7[4] = '\0';
    pcVar7[5] = '\0';
    pcVar7[6] = '\0';
    pcVar7[7] = '\0';
    pcVar7 = pcVar7 + 8;
  }
  builtin_strncpy(detail,"Start NwFormatToStatemen",0x18);
  trace_event(detail,5);
  __isoc99_sscanf(record_data,&DAT_004a7931,&trans_nbr);
  sVar5 = strlen(record_data);
  if (sVar5 < (ulong)(long)(trans_nbr * 0x2d + 2)) {
    trace_event("End   NwFormatToStatement(LENGTH ERROR)",5);
    iVar4 = -1;
  }
  else {
    if (5 < trans_nbr) {
      trans_nbr = 5;
      __isoc99_sscanf(record_data,&DAT_004a7931,&trans_nbr);
    }
    if (0 < trans_nbr) {
      pcVar7 = record_data + 2;
      do {
        transaction._0_8_ = *(undefined8 *)pcVar7;
        pcVar8 = transaction;
        for (lVar6 = 0x20; lVar6 != 0; lVar6 = lVar6 + -1) {
          pcVar8[0] = '\0';
          pcVar8[1] = '\0';
          pcVar8[2] = '\0';
          pcVar8[3] = '\0';
          pcVar8[4] = '\0';
          pcVar8[5] = '\0';
          pcVar8[6] = '\0';
          pcVar8[7] = '\0';
          pcVar8 = pcVar8 + (ulong)bVar9 * -0x10 + 8;
        }
        transaction._8_8_ = *(undefined8 *)(pcVar7 + 8);
        transaction._40_4_ = *(undefined4 *)(pcVar7 + 0x28);
        pcVar8 = pcVar7 + 0x2d;
        amount[0xf] = '\0';
        amount[0x10] = '\0';
        amount[0x11] = '\0';
        amount[0x12] = '\0';
        amount[0x13] = '\0';
        transaction._16_8_ = *(undefined8 *)(pcVar7 + 0x10);
        amount[0x14] = '\0';
        uVar1 = *(undefined8 *)(pcVar7 + 0x18);
        transaction._24_2_ = (undefined2)uVar1;
        transaction._26_6_ = (undefined6)((ulong)uVar1 >> 0x10);
        uVar2 = *(undefined8 *)(pcVar7 + 0x20);
        transaction._32_2_ = (undefined2)uVar2;
        transaction._34_4_ = (undefined4)((ulong)uVar2 >> 0x10);
        transaction._38_2_ = (undefined2)((ulong)uVar2 >> 0x30);
        transaction[0x2c] = pcVar7[0x2c];
        *(int *)statement = (int)transaction._0_8_;
        statement[6] = 'F';
        *(short *)(statement + 4) = SUB82(transaction._0_8_,4);
        *(short *)(statement + 7) = SUB42(transaction._40_4_,2);
        statement[9] = transaction[0x2c];
        statement[10] = SUB41(transaction._40_4_,1);
        amount._0_3_ = (undefined3)((ulong)uVar1 >> 0x10);
        amount._3_5_ = (undefined5)(CONCAT26(transaction._32_2_,transaction._26_6_) >> 0x18);
        amount[8] = transaction[0x22];
        amount[9] = transaction[0x23];
        amount[10] = transaction[0x24];
        amount[0xb] = transaction[0x25];
        uVar3 = amount._8_4_;
        amount[0xc] = transaction[0x26];
        amount[0xd] = transaction[0x27];
        amount[0xe] = (char)transaction._40_4_;
        amount._8_3_ = (undefined3)((ulong)uVar2 >> 0x10);
        *(ulong *)(statement + 0xb) = CONCAT35(amount._8_3_,amount._3_5_);
        *(uint *)(statement + 0x13) = CONCAT13(amount[0xe],(int3)((ulong)uVar2 >> 0x28));
        statement = statement + 0x17;
        pcVar7 = pcVar8;
        amount._8_4_ = uVar3;
      } while (pcVar8 != record_data + (ulong)(trans_nbr - 1) * 0x2d + 0x2f);
    }
    trace_event("End   NwFormatToStatement(OK)",5);
    iVar4 = 0;
  }
  return iVar4;
}



// WARNING: Unknown calling convention

int FormatToStatement(int nIndexCtx,char *record_data,char *statement,char lang)

{
  undefined8 uVar1;
  uint uVar2;
  int iVar3;
  size_t sVar4;
  long lVar5;
  char *pcVar6;
  char *pcVar7;
  uint uVar8;
  byte bVar9;
  char date [21];
  char trx_a_label [24];
  char amount [41];
  char trxCrcy [41];
  char transaction [256];
  char detail [512];
  
  bVar9 = 0;
  sprintf(detail,"Start FormatToStatement(%c)",(ulong)(uint)(int)lang);
  trace_event(detail,5);
  statement[0] = '\0';
  statement[1] = '\0';
  statement[2] = '\0';
  statement[3] = '\0';
  statement[4] = '\0';
  statement[5] = '\0';
  statement[6] = '\0';
  statement[7] = '\0';
  trx_a_label[0] = '\0';
  trx_a_label[1] = '\0';
  trx_a_label[2] = '\0';
  trx_a_label[3] = '\0';
  trx_a_label[4] = '\0';
  trx_a_label[5] = '\0';
  trx_a_label[6] = '\0';
  trx_a_label[7] = '\0';
  trx_a_label[8] = '\0';
  trx_a_label[9] = '\0';
  trx_a_label[10] = '\0';
  trx_a_label[0xb] = '\0';
  trx_a_label[0xc] = '\0';
  trx_a_label[0xd] = '\0';
  trx_a_label[0xe] = '\0';
  trx_a_label[0xf] = '\0';
  trx_a_label[0x10] = '\0';
  trx_a_label[0x11] = '\0';
  trx_a_label[0x12] = '\0';
  trx_a_label[0x13] = '\0';
  trx_a_label[0x14] = '\0';
  trx_a_label[0x15] = '\0';
  trx_a_label[0x16] = '\0';
  trx_a_label[0x17] = '\0';
  sVar4 = strlen(record_data);
  uVar2 = (uint)(sVar4 / 0x17);
  if (uVar2 == 0) {
    statement[0] = '0';
    statement[1] = '0';
    trace_event("End   FormatToStatement(LENGTH ERROR)",5);
    iVar3 = -1;
  }
  else {
    if (5 < (int)uVar2) {
      uVar2 = 5;
    }
    sprintf(trx_a_label,"%d",(ulong)uVar2);
    *statement = '0';
    statement[1] = trx_a_label[0];
    sprintf(detail,"trans_nbr(%d, %s)",(ulong)uVar2,statement);
    trace_event(detail,5);
    if (0 < (int)uVar2) {
      uVar8 = 0;
      pcVar6 = statement + 0x2b;
      do {
        pcVar7 = transaction;
        for (lVar5 = 0x20; lVar5 != 0; lVar5 = lVar5 + -1) {
          pcVar7[0] = '\0';
          pcVar7[1] = '\0';
          pcVar7[2] = '\0';
          pcVar7[3] = '\0';
          pcVar7[4] = '\0';
          pcVar7[5] = '\0';
          pcVar7[6] = '\0';
          pcVar7[7] = '\0';
          pcVar7 = pcVar7 + (ulong)bVar9 * -0x10 + 8;
        }
        pcVar7 = amount;
        for (lVar5 = 5; lVar5 != 0; lVar5 = lVar5 + -1) {
          pcVar7[0] = '\0';
          pcVar7[1] = '\0';
          pcVar7[2] = '\0';
          pcVar7[3] = '\0';
          pcVar7[4] = '\0';
          pcVar7[5] = '\0';
          pcVar7[6] = '\0';
          pcVar7[7] = '\0';
          pcVar7 = pcVar7 + (ulong)bVar9 * -0x10 + 8;
        }
        *pcVar7 = '\0';
        pcVar7 = trxCrcy;
        for (lVar5 = 5; lVar5 != 0; lVar5 = lVar5 + -1) {
          pcVar7[0] = '\0';
          pcVar7[1] = '\0';
          pcVar7[2] = '\0';
          pcVar7[3] = '\0';
          pcVar7[4] = '\0';
          pcVar7[5] = '\0';
          pcVar7[6] = '\0';
          pcVar7[7] = '\0';
          pcVar7 = pcVar7 + (ulong)bVar9 * -0x10 + 8;
        }
        uVar1 = *(undefined8 *)record_data;
        transaction._0_4_ = (undefined4)uVar1;
        transaction._4_2_ = (undefined2)((ulong)uVar1 >> 0x20);
        transaction[6] = (char)((ulong)uVar1 >> 0x30);
        transaction[7] = (char)((ulong)uVar1 >> 0x38);
        uVar1 = *(undefined8 *)(record_data + 8);
        *pcVar7 = '\0';
        transaction[8] = (char)uVar1;
        transaction[9] = (char)((ulong)uVar1 >> 8);
        transaction[10] = (char)((ulong)uVar1 >> 0x10);
        transaction._11_5_ = (undefined5)((ulong)uVar1 >> 0x18);
        transaction._16_4_ = *(undefined4 *)(record_data + 0x10);
        transaction._20_2_ = *(undefined2 *)(record_data + 0x14);
        transaction[0x16] = record_data[0x16];
        sprintf(detail,"<--transaction(cpt = %d)--> %s",(ulong)uVar8,transaction);
        trace_event(detail,5);
        pcVar6[-0x10] = ' ';
        pcVar6[-0xf] = ' ';
        pcVar6[-0xe] = ' ';
        pcVar6[-0xd] = ' ';
        *(undefined4 *)(pcVar6 + -0x29) = transaction._0_4_;
        *(undefined2 *)(pcVar6 + -0x25) = transaction._4_2_;
        pcVar6[-0x23] = transaction[6];
        pcVar6[-0x22] = ' ';
        pcVar6[-0x21] = ' ';
        pcVar6[-0x20] = ' ';
        pcVar6[-0x1f] = ' ';
        pcVar6[-0x1e] = ' ';
        pcVar6[-0x1d] = ' ';
        pcVar6[-0x1c] = ' ';
        pcVar6[-0x1b] = ' ';
        pcVar6[-0x1a] = ' ';
        pcVar6[-0x19] = ' ';
        pcVar6[-0x18] = ' ';
        pcVar6[-0x17] = ' ';
        pcVar6[-0x16] = ' ';
        pcVar6[-0x15] = ' ';
        pcVar6[-0x14] = ' ';
        pcVar6[-0x13] = ' ';
        pcVar6[-0x12] = ' ';
        pcVar6[-0x11] = ' ';
        *(ulong *)(pcVar6 + -0xc) = CONCAT35(transaction._16_3_,transaction._11_5_);
        *(uint *)(pcVar6 + -4) =
             CONCAT13(transaction[0x16],CONCAT21(transaction._20_2_,transaction[0x13]));
        if (transaction[10] == '-') {
          *pcVar6 = 'D';
        }
        else {
          *pcVar6 = 'C';
        }
        uVar8 = uVar8 + 1;
        record_data = record_data + 0x17;
        *(ushort *)(pcVar6 + 1) = CONCAT11(transaction[8],transaction[7]);
        pcVar6[3] = transaction[9];
        pcVar6 = pcVar6 + 0x2d;
      } while (uVar8 != uVar2);
    }
    trace_event("End   FormatToStatement(OK)",5);
    iVar3 = 0;
  }
  return iVar3;
}



// WARNING: Unknown calling convention

int FormatToDateTime(char *date,char lang)

{
  char target [36];
  
  *(ulong *)date =
       CONCAT26(*(undefined2 *)date,
                CONCAT15(0x2f,CONCAT23(*(undefined2 *)(date + 2),
                                       CONCAT12(0x2f,*(undefined2 *)(date + 4)))));
  *(undefined2 *)(date + 0x10) = *(undefined2 *)(date + 10);
  *(ulong *)(date + 8) =
       CONCAT17(0x3a,CONCAT25(*(undefined2 *)(date + 8),
                              CONCAT14(0x3a,CONCAT22(*(undefined2 *)(date + 6),0x2020))));
  return 0x12;
}



// WARNING: Unknown calling convention

int FormatToDate(char *date,char lang)

{
  undefined2 uVar1;
  undefined4 uVar2;
  char target [24];
  
  target[8] = '\0';
  target[9] = '\0';
  target[10] = '\0';
  target[0xb] = '\0';
  target[0xc] = '\0';
  target[0xd] = '\0';
  target[0xe] = '\0';
  target[0xf] = '\0';
  target[0x10] = '\0';
  target[0x11] = '\0';
  target[0x12] = '\0';
  target[0x13] = '\0';
  target[0x14] = '\0';
  target[0x15] = '\0';
  target[0x16] = '\0';
  target[0x17] = '\0';
  uVar1 = *(undefined2 *)(date + 4);
  if (lang != 'A') {
    target[2] = '/';
    target[0] = (char)uVar1;
    target[1] = (char)((ushort)uVar1 >> 8);
    target._3_2_ = *(undefined2 *)(date + 2);
    target[5] = 0x2f;
    target._6_2_ = *(undefined2 *)date;
    memcpy(date,target,8);
    return 8;
  }
  target._12_2_ = *(undefined2 *)(date + 2);
  target._21_2_ = *(undefined2 *)date;
  target[8] = '/';
  target[2] = (char)target._12_2_;
  target[3] = SUB21(target._12_2_,1);
  target[0] = (char)uVar1;
  target[1] = (char)((ushort)uVar1 >> 8);
  uVar2 = target._0_4_;
  *(undefined2 *)(date + 4) = target._21_2_;
  target[3] = (char)uVar1;
  target[4] = (char)((ushort)uVar1 >> 8);
  target[0] = '\x1b';
  target[1] = '(';
  target[2] = '7';
  target[5] = '\x1b';
  target[6] = '(';
  target[7] = '1';
  *(undefined4 *)date = uVar2;
  target[9] = '\x1b';
  target[10] = '(';
  target[0xb] = '7';
  builtin_strncpy(target + 0xe,"\x1b(1/\x1b(7",7);
  memcpy(date,target,0x17);
  return 0x17;
}



// WARNING: Unknown calling convention

int GetIntegerPart(char *pAmount,char *pIntegerPart)

{
  size_t sVar1;
  size_t sVar2;
  size_t __n;
  
  sVar2 = strlen(pAmount);
  sVar1 = 0;
  do {
    __n = sVar1;
    if (__n == sVar2) break;
    sVar1 = __n + 1;
  } while (pAmount[__n] != '.');
  memcpy(pIntegerPart,pAmount,__n);
  return 0;
}



// WARNING: Unknown calling convention

int GetDecimalPart(char *pAmount,char *pDecimalPart)

{
  char cVar1;
  size_t sVar2;
  int iVar3;
  long lVar4;
  
  sVar2 = strlen(pAmount);
  iVar3 = (int)sVar2 + -1;
  lVar4 = (long)iVar3;
  if (0 < iVar3) {
    cVar1 = pAmount[lVar4];
    while (cVar1 != '.') {
      lVar4 = lVar4 + -1;
      iVar3 = iVar3 + -1;
      if (iVar3 == 0) {
        lVar4 = 0;
        break;
      }
      cVar1 = pAmount[lVar4];
    }
  }
  memcpy(pDecimalPart,pAmount + lVar4 + 1,sVar2 - lVar4);
  return 0;
}



// WARNING: Unknown calling convention

int Format2ToAmount(int nIndexCtx,char *amount,char *currency,int currency_flag,int alignement,
                   char lang)

{
  int iVar1;
  uint uVar2;
  uint uVar3;
  uint extraout_EAX;
  uint *puVar4;
  long lVar5;
  char *pcVar6;
  size_t sVar7;
  size_t __n;
  uint *puVar8;
  uint *puVar9;
  bool bVar10;
  char cur_alpha [4];
  char lIntegerPart [13];
  char lDecimalPart [13];
  char target [99];
  
  lIntegerPart[0] = '\0';
  lIntegerPart[1] = '\0';
  lIntegerPart[2] = '\0';
  lIntegerPart[3] = '\0';
  lIntegerPart[4] = '\0';
  lIntegerPart[5] = '\0';
  lIntegerPart[6] = '\0';
  lIntegerPart[7] = '\0';
  lIntegerPart[8] = '\0';
  lIntegerPart[9] = '\0';
  lIntegerPart[10] = '\0';
  lIntegerPart[0xb] = '\0';
  lIntegerPart[0xc] = '\0';
  lDecimalPart[0] = '\0';
  lDecimalPart[1] = '\0';
  lDecimalPart[2] = '\0';
  lDecimalPart[3] = '\0';
  lDecimalPart[4] = '\0';
  lDecimalPart[5] = '\0';
  lDecimalPart[6] = '\0';
  lDecimalPart[7] = '\0';
  lDecimalPart[8] = '\0';
  lDecimalPart[9] = '\0';
  lDecimalPart[10] = '\0';
  lDecimalPart[0xb] = '\0';
  puVar4 = (uint *)target;
  for (lVar5 = 0xc; lVar5 != 0; lVar5 = lVar5 + -1) {
    puVar4[0] = 0;
    puVar4[1] = 0;
    puVar4 = puVar4 + 2;
  }
  lDecimalPart[0xc] = '\0';
  *(undefined2 *)puVar4 = 0;
  *(char *)((long)puVar4 + 2) = '\0';
  iVar1 = adjust_amount_float(nIndexCtx,amount,currency);
  if (iVar1 == 0) {
    iVar1 = 0;
    puVar4 = (uint *)target;
    if (currency_flag == 0) {
      iVar1 = GetCurrencyAlpha(nIndexCtx,currency,cur_alpha);
      if (iVar1 == 0) {
        if (lang == 'A') {
          iVar1 = memcmp(cur_alpha,&DAT_004a799d,3);
          if (iVar1 == 0) {
            target[2] = '>';
            lVar5 = 4;
            target[0] = ' ';
            target[1] = 'P';
            iVar1 = 4;
            puVar4 = (uint *)(target + 3);
          }
          else {
            iVar1 = memcmp(cur_alpha,&DAT_004a79a1,3);
            if (iVar1 == 0) {
              target[2] = '>';
              iVar1 = 4;
              target[0] = ' ';
              target[1] = '(';
              puVar4 = (uint *)(target + 3);
              lVar5 = 4;
            }
            else {
              iVar1 = memcmp(cur_alpha,&DAT_004a79a5,3);
              if (iVar1 == 0) {
                target[2] = '>';
                lVar5 = 4;
                target[0] = ' ';
                target[1] = '\"';
                iVar1 = 4;
                puVar4 = (uint *)(target + 3);
              }
              else {
                lVar5 = 1;
                iVar1 = 1;
              }
            }
          }
        }
        else {
          target[0] = cur_alpha[0];
          target[1] = cur_alpha[1];
          iVar1 = 4;
          target[2] = cur_alpha[2];
          lVar5 = 4;
          puVar4 = (uint *)(target + 3);
        }
      }
      else {
        target._0_2_ = *(undefined2 *)currency;
        lVar5 = 4;
        iVar1 = 4;
        target[2] = currency[2];
        puVar4 = (uint *)(target + 3);
      }
      *(char *)puVar4 = ' ';
      puVar4 = (uint *)(lVar5 + (long)target);
    }
    if (lang == 'A') {
      GetIntegerPart(amount,lIntegerPart);
      GetDecimalPart(amount,lDecimalPart);
      puVar9 = (uint *)lIntegerPart;
      do {
        puVar8 = puVar9;
        uVar2 = *puVar8 + 0xfefefeff & ~*puVar8;
        uVar3 = uVar2 & 0x80808080;
        puVar9 = puVar8 + 1;
      } while (uVar3 == 0);
      bVar10 = (uVar2 & 0x8080) == 0;
      if (bVar10) {
        uVar3 = uVar3 >> 0x10;
      }
      if (bVar10) {
        puVar9 = (uint *)((long)puVar8 + 6);
      }
      pcVar6 = (char *)((long)puVar9 +
                       ((-3 - (ulong)CARRY1((byte)uVar3,(byte)uVar3)) - (long)lIntegerPart));
      memcpy(puVar4,lIntegerPart,(size_t)pcVar6);
      iVar1 = (int)pcVar6 + iVar1;
      target[iVar1] = '\x1b';
      target[iVar1 + 1] = '(';
      target[iVar1 + 2] = '1';
      target[iVar1 + 3] = ',';
      target[iVar1 + 4] = '\x1b';
      target[iVar1 + 5] = '(';
      target[iVar1 + 6] = '7';
      puVar4 = (uint *)lDecimalPart;
      do {
        puVar9 = puVar4;
        uVar2 = *puVar9 + 0xfefefeff & ~*puVar9;
        uVar3 = uVar2 & 0x80808080;
        puVar4 = puVar9 + 1;
      } while (uVar3 == 0);
      bVar10 = (uVar2 & 0x8080) == 0;
      __n = 0x16;
      if (bVar10) {
        uVar3 = uVar3 >> 0x10;
      }
      if (bVar10) {
        puVar4 = (uint *)((long)puVar9 + 6);
      }
      sVar7 = 0x12;
      memcpy((char *)((long)(iVar1 + 7) + (long)target),lDecimalPart,
             (size_t)((long)puVar4 +
                     ((-3 - (ulong)CARRY1((byte)uVar3,(byte)uVar3)) - (long)lDecimalPart)));
    }
    else {
      sVar7 = 0xc;
      __n = 0x10;
      sprintf((char *)puVar4,"%.16s",amount);
    }
  }
  else {
    sVar7 = 0xc;
    atof(amount);
    __n = 0x10;
    sprintf(target,"%012d",(ulong)extraout_EAX);
  }
  amount[0] = '\0';
  amount[1] = '\0';
  amount[2] = '\0';
  amount[3] = '\0';
  amount[4] = '\0';
  amount[5] = '\0';
  amount[6] = '\0';
  amount[7] = '\0';
  amount[8] = '\0';
  amount[9] = '\0';
  amount[10] = '\0';
  amount[0xb] = '\0';
  amount[0xc] = '\0';
  amount[0xd] = '\0';
  amount[0xe] = '\0';
  amount[0xf] = '\0';
  amount[0x10] = '\0';
  amount[0x11] = '\0';
  amount[0x12] = '\0';
  amount[0x13] = '\0';
  amount[0x14] = '\0';
  if ((alignement & 0xffffffdfU) == 0x52) {
    if (currency_flag == 0) {
      memset(amount,0x20,__n);
      puVar4 = (uint *)target;
      do {
        puVar9 = puVar4;
        uVar2 = *puVar9 + 0xfefefeff & ~*puVar9;
        uVar3 = uVar2 & 0x80808080;
        puVar4 = puVar9 + 1;
      } while (uVar3 == 0);
      bVar10 = (uVar2 & 0x8080) == 0;
      if (bVar10) {
        uVar3 = uVar3 >> 0x10;
      }
      if (bVar10) {
        puVar4 = (uint *)((long)puVar9 + 6);
      }
      pcVar6 = (char *)((long)puVar4 +
                       ((-3 - (ulong)CARRY1((byte)uVar3,(byte)uVar3)) - (long)target));
      memcpy(amount + (__n - (long)pcVar6),target,(size_t)pcVar6);
    }
    else {
      memset(amount,0x20,sVar7);
      puVar4 = (uint *)target;
      do {
        puVar9 = puVar4;
        uVar2 = *puVar9 + 0xfefefeff & ~*puVar9;
        uVar3 = uVar2 & 0x80808080;
        puVar4 = puVar9 + 1;
      } while (uVar3 == 0);
      bVar10 = (uVar2 & 0x8080) == 0;
      if (bVar10) {
        uVar3 = uVar3 >> 0x10;
      }
      if (bVar10) {
        puVar4 = (uint *)((long)puVar9 + 6);
      }
      pcVar6 = (char *)((long)puVar4 +
                       ((-3 - (ulong)CARRY1((byte)uVar3,(byte)uVar3)) - (long)target));
      memcpy(amount + (sVar7 - (long)pcVar6),target,(size_t)pcVar6);
    }
  }
  else {
    puVar4 = (uint *)target;
    if ((alignement & 0xffffffdfU) == 0x43) {
      if (currency_flag == 0) {
        builtin_strncpy(amount,"        ",8);
        do {
          puVar9 = puVar4;
          uVar2 = *puVar9 + 0xfefefeff & ~*puVar9;
          uVar3 = uVar2 & 0x80808080;
          puVar4 = puVar9 + 1;
        } while (uVar3 == 0);
        bVar10 = (uVar2 & 0x8080) == 0;
        if (bVar10) {
          uVar3 = uVar3 >> 0x10;
        }
        if (bVar10) {
          puVar4 = (uint *)((long)puVar9 + 6);
        }
        pcVar6 = (char *)((long)puVar4 +
                         ((-3 - (ulong)CARRY1((byte)uVar3,(byte)uVar3)) - (long)target));
        memcpy(amount + (8 - ((ulong)pcVar6 >> 1)),target,(size_t)pcVar6);
      }
      else {
        builtin_strncpy(amount,"      ",6);
        do {
          puVar9 = puVar4;
          uVar2 = *puVar9 + 0xfefefeff & ~*puVar9;
          uVar3 = uVar2 & 0x80808080;
          puVar4 = puVar9 + 1;
        } while (uVar3 == 0);
        bVar10 = (uVar2 & 0x8080) == 0;
        if (bVar10) {
          uVar3 = uVar3 >> 0x10;
        }
        if (bVar10) {
          puVar4 = (uint *)((long)puVar9 + 6);
        }
        pcVar6 = (char *)((long)puVar4 +
                         ((-3 - (ulong)CARRY1((byte)uVar3,(byte)uVar3)) - (long)target));
        memcpy(amount + (6 - ((ulong)pcVar6 >> 1)),target,(size_t)pcVar6);
      }
    }
    else {
      do {
        puVar9 = puVar4;
        uVar2 = *puVar9 + 0xfefefeff & ~*puVar9;
        uVar3 = uVar2 & 0x80808080;
        puVar4 = puVar9 + 1;
      } while (uVar3 == 0);
      bVar10 = (uVar2 & 0x8080) == 0;
      if (bVar10) {
        uVar3 = uVar3 >> 0x10;
      }
      if (bVar10) {
        puVar4 = (uint *)((long)puVar9 + 6);
      }
      memcpy(amount,target,
             (size_t)((long)puVar4 + ((-3 - (ulong)CARRY1((byte)uVar3,(byte)uVar3)) - (long)target))
            );
    }
  }
  sVar7 = strlen(amount);
  return (int)sVar7;
}



// WARNING: Removing unreachable block (ram,0x00422165)
// WARNING: Unknown calling convention

int GetStatementLabel(int nIndexCtx,char *trx_sign,char *e_text,char *a_text)

{
  size_t __n;
  long lVar1;
  ulong uVar2;
  char *pcVar3;
  uint uVar4;
  uchar *puVar5;
  int iVar6;
  bool bVar7;
  byte bVar8;
  char T_TRX_SIGN [2];
  int nStatus;
  char szFuncName [18];
  anon_struct_32_2_43c7b5cf T_E_TEXT;
  anon_struct_32_2_43c7b5cf T_A_TEXT;
  sqlca sqlca;
  char local_fmt_1 [128];
  int *local_b58;
  char *local_b50;
  anon_struct_32_2_43c7b5cf *local_b48;
  anon_struct_32_2_43c7b5cf *local_b40;
  anon_struct_2050_2_43c7b5cf *local_b38;
  undefined8 local_b30;
  undefined8 local_b28;
  undefined8 local_b20;
  undefined8 local_b18;
  undefined8 local_b10;
  undefined4 local_b08;
  undefined4 local_b04;
  undefined4 local_b00;
  undefined4 local_afc;
  undefined4 local_af8;
  undefined8 local_af0;
  undefined8 local_ae8;
  undefined8 local_ae0;
  undefined8 local_ad8;
  undefined8 local_ad0;
  undefined4 local_ac8;
  undefined4 local_ac4;
  undefined4 local_ac0;
  undefined4 local_abc;
  undefined4 local_ab8;
  undefined8 local_ab0;
  undefined8 local_aa8;
  undefined8 local_aa0;
  undefined8 local_a98;
  undefined8 local_a90;
  undefined1 local_a88 [40];
  undefined2 local_a60;
  undefined2 local_a5e;
  undefined2 local_a5c;
  undefined2 local_a5a;
  undefined2 local_a58;
  undefined2 local_a56;
  undefined2 local_a54;
  undefined2 local_a52;
  undefined2 local_a50;
  undefined2 local_a4e;
  char sLine [512];
  anon_struct_2050_2_43c7b5cf T_ERR_MSG;
  
  bVar8 = 0;
  builtin_strncpy(szFuncName,"GetStatementLabel",0x12);
  pcVar3 = sLine;
  for (lVar1 = 0x40; lVar1 != 0; lVar1 = lVar1 + -1) {
    pcVar3[0] = '\0';
    pcVar3[1] = '\0';
    pcVar3[2] = '\0';
    pcVar3[3] = '\0';
    pcVar3[4] = '\0';
    pcVar3[5] = '\0';
    pcVar3[6] = '\0';
    pcVar3[7] = '\0';
    pcVar3 = pcVar3 + 8;
  }
  sprintf((char *)&T_ERR_MSG,"Start %%s(%s)","%d, %.1s, %.20s");
  sprintf(sLine,(char *)&T_ERR_MSG,szFuncName,(ulong)(uint)nIndexCtx,trx_sign);
  trace_event(sLine,5);
  T_E_TEXT.arr[0] = '\0';
  T_E_TEXT.arr[1] = '\0';
  T_E_TEXT.arr[2] = '\0';
  T_E_TEXT.arr[3] = '\0';
  T_E_TEXT.arr[4] = '\0';
  T_E_TEXT.arr[5] = '\0';
  T_E_TEXT.arr[6] = '\0';
  T_E_TEXT.arr[7] = '\0';
  T_E_TEXT.arr[8] = '\0';
  T_E_TEXT.arr[9] = '\0';
  T_E_TEXT.arr[10] = '\0';
  T_E_TEXT.arr[0xb] = '\0';
  T_E_TEXT.arr[0xc] = '\0';
  T_E_TEXT.arr[0xd] = '\0';
  T_E_TEXT.arr[0xe] = '\0';
  T_E_TEXT.arr[0xf] = '\0';
  T_E_TEXT.arr[0x10] = '\0';
  T_E_TEXT.arr[0x11] = '\0';
  T_E_TEXT.arr[0x12] = '\0';
  T_E_TEXT.arr[0x13] = '\0';
  T_E_TEXT.arr[0x14] = '\0';
  T_E_TEXT.arr[0x15] = '\0';
  T_E_TEXT.arr[0x16] = '\0';
  T_E_TEXT.arr[0x17] = '\0';
  local_b40 = &T_A_TEXT;
  T_E_TEXT.arr[0x18] = '\0';
  T_E_TEXT.arr[0x19] = '\0';
  T_E_TEXT.arr[0x1a] = '\0';
  T_E_TEXT.arr[0x1b] = '\0';
  T_E_TEXT.arr[0x1c] = '\0';
  T_E_TEXT.arr[0x1d] = '\0';
  T_ERR_MSG.arr[0] = '\0';
  T_ERR_MSG.arr[1] = '\0';
  puVar5 = T_ERR_MSG.arr + 2;
  T_TRX_SIGN[1] = '\0';
  uVar4 = 0x7fe;
  bVar7 = ((ulong)puVar5 & 4) != 0;
  T_A_TEXT.arr[0] = '\0';
  T_A_TEXT.arr[1] = '\0';
  T_A_TEXT.arr[2] = '\0';
  T_A_TEXT.arr[3] = '\0';
  T_A_TEXT.arr[4] = '\0';
  T_A_TEXT.arr[5] = '\0';
  T_A_TEXT.arr[6] = '\0';
  T_A_TEXT.arr[7] = '\0';
  T_A_TEXT.arr[8] = '\0';
  T_A_TEXT.arr[9] = '\0';
  T_A_TEXT.arr[10] = '\0';
  T_A_TEXT.arr[0xb] = '\0';
  T_A_TEXT.arr[0xc] = '\0';
  T_A_TEXT.arr[0xd] = '\0';
  T_A_TEXT.arr[0xe] = '\0';
  T_A_TEXT.arr[0xf] = '\0';
  T_A_TEXT.arr[0x10] = '\0';
  T_A_TEXT.arr[0x11] = '\0';
  T_A_TEXT.arr[0x12] = '\0';
  T_A_TEXT.arr[0x13] = '\0';
  T_A_TEXT.arr[0x14] = '\0';
  T_A_TEXT.arr[0x15] = '\0';
  T_A_TEXT.arr[0x16] = '\0';
  T_A_TEXT.arr[0x17] = '\0';
  T_A_TEXT.arr[0x18] = '\0';
  T_A_TEXT.arr[0x19] = '\0';
  T_A_TEXT.arr[0x1a] = '\0';
  T_A_TEXT.arr[0x1b] = '\0';
  T_A_TEXT.arr[0x1c] = '\0';
  T_A_TEXT.arr[0x1d] = '\0';
  if (bVar7) {
    T_ERR_MSG.arr[2] = '\0';
    T_ERR_MSG.arr[3] = '\0';
    T_ERR_MSG.arr[4] = '\0';
    T_ERR_MSG.arr[5] = '\0';
    uVar4 = 0x7fa;
    puVar5 = T_ERR_MSG.arr + 6;
  }
  for (uVar2 = (ulong)(uVar4 >> 3); uVar2 != 0; uVar2 = uVar2 - 1) {
    puVar5[0] = '\0';
    puVar5[1] = '\0';
    puVar5[2] = '\0';
    puVar5[3] = '\0';
    puVar5[4] = '\0';
    puVar5[5] = '\0';
    puVar5[6] = '\0';
    puVar5[7] = '\0';
    puVar5 = puVar5 + (ulong)bVar8 * -0x10 + 8;
  }
  if (!bVar7) {
    puVar5[0] = '\0';
    puVar5[1] = '\0';
    puVar5[2] = '\0';
    puVar5[3] = '\0';
    puVar5 = puVar5 + 4;
  }
  puVar5[0] = '\0';
  puVar5[1] = '\0';
  T_E_TEXT.len = 0x1e;
  T_ERR_MSG.len = 0x800;
  T_A_TEXT.len = 0x1e;
  T_TRX_SIGN[0] = *trx_sign;
  __n = strlen(e_text);
  memcpy(T_E_TEXT.arr,e_text,__n);
  T_E_TEXT.len = (ushort)__n;
  sprintf(sLine,"%s(): Start Call of PL/SQL %s()",szFuncName,"PCRD_ATM_TOOLS_2.GET_STATEMENT_LABELS"
         );
  trace_event(sLine,5);
  sprintf(local_fmt_1,"%%s %%-20.20s : [%s]",&DAT_004a7a39);
  sprintf(sLine,local_fmt_1,&DAT_004a31ee,"T_TRX_SIGN",T_TRX_SIGN);
  trace_event(sLine,4);
  sprintf(local_fmt_1,"%%s %%-20.20s : [%s]","%.20s");
  sprintf(sLine,local_fmt_1,&DAT_004a31ee,"T_E_TEXT",T_E_TEXT.arr);
  trace_event(sLine,4);
  local_fmt_1._40_8_ = &sqlca;
  local_fmt_1._56_8_ = &sqladt;
  local_fmt_1[0x16] = '\0';
  local_fmt_1[0x17] = '\x11';
  local_fmt_1._64_8_ = &sqltds;
  local_a56 = 0;
  local_a60 = 0;
  local_fmt_1._48_8_ = s_declare_v_a_text_atm_statement_l_004a7af8;
  local_a5e = 0;
  local_a54 = 0;
  local_fmt_1._32_8_ = sqlcud0;
  local_b58 = &nStatus;
  local_fmt_1[0] = '\f';
  local_fmt_1[1] = '\0';
  local_fmt_1[2] = '\0';
  local_fmt_1[3] = '\0';
  local_fmt_1[4] = '\0';
  local_fmt_1[5] = '\0';
  local_fmt_1[6] = '\0';
  local_fmt_1[7] = '\0';
  local_fmt_1[8] = '\x05';
  local_fmt_1[9] = '\0';
  local_fmt_1[10] = '\0';
  local_fmt_1[0xb] = '\0';
  local_fmt_1[0xc] = '\x01';
  local_fmt_1[0xd] = '\0';
  local_fmt_1[0xe] = '\0';
  local_fmt_1[0xf] = '\0';
  local_fmt_1[0x10] = '\x05';
  local_fmt_1[0x11] = '\0';
  local_fmt_1[0x12] = '\0';
  local_fmt_1[0x13] = '\0';
  local_fmt_1[0x18] = '\0';
  local_fmt_1[0x19] = '\0';
  local_fmt_1[0x1a] = '\0';
  local_fmt_1[0x1b] = '\0';
  local_b30 = 4;
  local_b08 = 0;
  local_af0 = 0;
  local_ac8 = 0;
  local_ab0 = 0;
  local_b28 = 2;
  local_b04 = 0;
  local_ae8 = 0;
  local_ac4 = 0;
  local_aa8 = 0;
  local_b20 = 0x20;
  local_b00 = 0;
  local_ae0 = 0;
  local_ac0 = 0;
  local_aa0 = 0;
  local_a5c = 0;
  local_a52 = 0;
  local_b18 = 0x20;
  local_afc = 0;
  local_ad8 = 0;
  local_a50 = 0;
  local_a58 = 0;
  local_a4e = 0;
  local_fmt_1._72_8_ = &local_b58;
  local_abc = 0;
  local_a98 = 0;
  local_a5a = 0;
  local_fmt_1._80_8_ = &local_b30;
  local_b10 = 0x802;
  local_af8 = 0;
  local_fmt_1._88_8_ = &local_b08;
  local_ad0 = 0;
  local_ab8 = 0;
  local_a90 = 0;
  local_fmt_1._96_8_ = &local_af0;
  local_fmt_1._104_8_ = &local_ac8;
  local_fmt_1._112_8_ = &local_ab0;
  local_fmt_1._120_8_ = local_a88;
  local_b50 = T_TRX_SIGN;
  local_b48 = &T_E_TEXT;
  local_b38 = &T_ERR_MSG;
  sqlcxt((long)nIndexCtx * 0x10 + 0x713948,&sqlctx,local_fmt_1,&sqlfpn);
  if (sqlca.sqlcode < 0) {
    sprintf(sLine,"%s() failed : %.60s",szFuncName,sqlca.sqlerrm.sqlerrmc);
    trace_event(sLine,1);
    sprintf(sLine,"End   %s(%d)",szFuncName,1);
    trace_event(sLine,5);
    iVar6 = 1;
  }
  else {
    sprintf(local_fmt_1,"%%s %%-20.20s : [%s]","%d");
    sprintf(sLine,local_fmt_1,&DAT_004a31fa,"nStatus",(ulong)(uint)nStatus);
    trace_event(sLine,4);
    if (nStatus == -1) {
      puVar5 = T_ERR_MSG.arr;
      iVar6 = 0;
      if (T_ERR_MSG.len != 0) {
        do {
          pcVar3 = "T_ERR_MSG";
          if (iVar6 != 0) {
            pcVar3 = " ";
          }
          iVar6 = iVar6 + 0x37;
          sprintf(sLine,"%s %-20.20s : [%.55s]",&DAT_004a323a,pcVar3,puVar5);
          trace_event(sLine,4);
          puVar5 = puVar5 + 0x37;
        } while (iVar6 < (int)(uint)T_ERR_MSG.len);
      }
      sprintf(sLine,"%s(): End   Call of PL/SQL %s()",szFuncName,
              "PCRD_ATM_TOOLS_2.GET_STATEMENT_LABELS");
      trace_event(sLine,5);
      sprintf(sLine,"End   %s(%d)",szFuncName,0xffffffff);
      trace_event(sLine,5);
      iVar6 = -1;
    }
    else {
      sprintf(local_fmt_1,"%%s %%-20.20s : [%s]","%.20s");
      sprintf(sLine,local_fmt_1,&DAT_004a31fa,"T_A_TEXT",T_A_TEXT.arr);
      trace_event(sLine,4);
      sprintf(sLine,"%s(): End   Call of PL/SQL %s()",szFuncName,
              "PCRD_ATM_TOOLS_2.GET_STATEMENT_LABELS");
      trace_event(sLine,5);
      memcpy(a_text,T_A_TEXT.arr,(ulong)T_A_TEXT.len);
      sprintf(local_fmt_1,"End   %%s(%%d, %s)","%.20s");
      sprintf(sLine,local_fmt_1,szFuncName,0,a_text);
      trace_event(sLine,5);
      iVar6 = 0;
    }
  }
  return iVar6;
}



// WARNING: Unknown calling convention

int GetCurrencyAlpha(int nIndexCtx,char *code,char *alpha)

{
  int iVar1;
  long lVar2;
  char *pcVar3;
  char h_code [4];
  char h_alpha [4];
  int hResponseCode;
  char detail [80];
  sqlca sqlca;
  sqlexd_conflict1 sqlstm;
  
  pcVar3 = detail;
  for (lVar2 = 10; lVar2 != 0; lVar2 = lVar2 + -1) {
    pcVar3[0] = '\0';
    pcVar3[1] = '\0';
    pcVar3[2] = '\0';
    pcVar3[3] = '\0';
    pcVar3[4] = '\0';
    pcVar3[5] = '\0';
    pcVar3[6] = '\0';
    pcVar3[7] = '\0';
    pcVar3 = pcVar3 + 8;
  }
  sprintf(detail,"Start GetCurrencyAlpha(%.3s)",code);
  trace_event(detail,5);
  alpha[0] = '\0';
  alpha[1] = '\0';
  alpha[2] = '\0';
  alpha[3] = '\0';
  alpha[4] = '\0';
  alpha[5] = '\0';
  alpha[6] = '\0';
  alpha[7] = '\0';
  sqlstm.sqladtp = &sqladt;
  sqlstm.stmt = 
  "declare enr_currency_table CURRENCY_TABLE % ROWTYPE ; BEGIN :hResponseCode := PCRD_GET_PARAM_GENERAL_ROWS . GET_CURRENCY_TABLE ( :h_code , enr_currency_table ) ; IF :hResponseCode = declaration_cst . OK THEN :h_alpha := enr_currency_table . currency_code_alpha ; END IF ; END ;"
  ;
  sqlstm.sqadto[1] = 0;
  sqlstm.sqlest = (uchar *)&sqlca;
  sqlstm.sqltdsp = &sqltds;
  sqlstm.sqtdso[0] = 0;
  h_alpha[0] = '\0';
  h_alpha[1] = '\0';
  h_alpha[2] = '\0';
  h_alpha[3] = '\0';
  sqlstm.sqlvsn = 0xc;
  sqlstm.cud = sqlcud0;
  sqlstm.arrsiz = 5;
  h_code[3] = '\0';
  h_code._0_3_ = *(uint3 *)code;
  sqlstm.sqadto[0] = 0;
  sqlstm.sqlety = 0x1100;
  sqlstm.sqhstv[0] = (uchar *)&hResponseCode;
  sqlstm.iters = 1;
  sqlstm.offset = 0x28;
  sqlstm.sqphsv = sqlstm.sqhstv;
  sqlstm.occurs = 0;
  sqlstm.sqhstl[0] = 4;
  sqlstm.sqhsts[0] = 0;
  sqlstm.sqindv[0] = (short *)0x0;
  sqlstm.sqinds[0] = 0;
  sqlstm.sqharm[0] = 0;
  sqlstm.sqhstl[1] = 4;
  sqlstm.sqhsts[1] = 0;
  sqlstm.sqindv[1] = (short *)0x0;
  sqlstm.sqinds[1] = 0;
  sqlstm.sqharm[1] = 0;
  sqlstm.sqtdso[1] = 0;
  sqlstm.sqphsl = sqlstm.sqhstl;
  sqlstm.sqhstl[2] = 4;
  sqlstm.sqphss = sqlstm.sqhsts;
  sqlstm.sqhsts[2] = 0;
  sqlstm.sqindv[2] = (short *)0x0;
  sqlstm.sqinds[2] = 0;
  sqlstm.sqpind = sqlstm.sqindv;
  sqlstm.sqharm[2] = 0;
  sqlstm.sqadto[2] = 0;
  sqlstm.sqpins = sqlstm.sqinds;
  sqlstm.sqtdso[2] = 0;
  sqlstm.sqparm = sqlstm.sqharm;
  sqlstm.sqparc = sqlstm.sqharc;
  sqlstm.sqpadto = sqlstm.sqadto;
  sqlstm.sqptdso = sqlstm.sqtdso;
  sqlstm.sqhstv[1] = (uchar *)h_code;
  sqlstm.sqhstv[2] = (uchar *)h_alpha;
  sqlcxt((long)nIndexCtx * 0x10 + 0x713948,&sqlctx,&sqlstm,&sqlfpn);
  if (sqlca.sqlcode < 0) {
    sprintf(detail,"%.60s",sqlca.sqlerrm.sqlerrmc);
    trace_event(detail,1);
    trace_event("End   GetCurrencyAlpha(ERROR)",1);
    iVar1 = 1;
  }
  else {
    if (hResponseCode != 0) {
      trace_event("End   GetConfigFlags(NOK)",5);
      return hResponseCode;
    }
    *(undefined2 *)alpha = h_alpha._0_2_;
    alpha[2] = h_alpha[2];
    sprintf(detail,"End   GetCurrencyAlpha(%.3s)",alpha);
    trace_event(detail,5);
    iVar1 = 0;
  }
  return iVar1;
}



// WARNING: Unknown calling convention

int CashAdvanceProcessing
              (int nIndiceCtx,char *sMyResource,char *sAuthoTable,char *sAcquirerBank,
              char *InternationalRoutCheck,char *sServGatewayFlag,char *sBillCalculFlag,
              char *sTlvBuffer,TSIsoInfo *IsoInfo)

{
  char acVar1 [4];
  undefined4 uVar2;
  int iVar3;
  uint uVar4;
  long lVar5;
  char *pcVar6;
  char *tlv_name;
  char SafIndicator;
  byte bVar7;
  int local_9c00;
  char PosCond [3];
  char slFuncCode [4];
  char sEventCode [4];
  pid_t nPid;
  int nLength;
  char slProcCode [7];
  char sPrimResource [7];
  char sSecResource [7];
  char sInternalStan [7];
  char sCaptureCode [7];
  char sPid [9];
  char sSecurityResults [11];
  TSService rService;
  char slCardNumber [23];
  char sLine [512];
  char tmpField [513];
  char sSecurData [4096];
  char sAlternAmount [4097];
  char sTlvProcCode [4097];
  char sIsoProcCode [4097];
  TSTlvPrivate TlvInfo;
  TSTlvAutho sTlvInfo;
  
  bVar7 = 0;
  trace_event("Start CashAdvanceProcessing()",5);
  pcVar6 = sSecurData;
  for (lVar5 = 0x200; lVar5 != 0; lVar5 = lVar5 + -1) {
    pcVar6[0] = '\0';
    pcVar6[1] = '\0';
    pcVar6[2] = '\0';
    pcVar6[3] = '\0';
    pcVar6[4] = '\0';
    pcVar6[5] = '\0';
    pcVar6[6] = '\0';
    pcVar6[7] = '\0';
    pcVar6 = pcVar6 + (ulong)bVar7 * -0x10 + 8;
  }
  rService.szDestAcc[1] = '\0';
  rService.szDestAcc[2] = '\0';
  slCardNumber[0x14] = '\0';
  slCardNumber[0x15] = '\0';
  slProcCode[4] = '\0';
  slProcCode[5] = '\0';
  sPrimResource[4] = '\0';
  sPrimResource[5] = '\0';
  sSecResource[4] = '\0';
  sSecResource[5] = '\0';
  sCaptureCode[4] = '\0';
  sCaptureCode[5] = '\0';
  slCardNumber[0] = '\0';
  slCardNumber[1] = '\0';
  slCardNumber[2] = '\0';
  slCardNumber[3] = '\0';
  slCardNumber[4] = '\0';
  slCardNumber[5] = '\0';
  slCardNumber[6] = '\0';
  slCardNumber[7] = '\0';
  slCardNumber[8] = '\0';
  slCardNumber[9] = '\0';
  slCardNumber[10] = '\0';
  slCardNumber[0xb] = '\0';
  slCardNumber[0xc] = '\0';
  slCardNumber[0xd] = '\0';
  slCardNumber[0xe] = '\0';
  slCardNumber[0xf] = '\0';
  slCardNumber[0x10] = '\0';
  slCardNumber[0x11] = '\0';
  slCardNumber[0x12] = '\0';
  slCardNumber[0x13] = '\0';
  slCardNumber[0x16] = '\0';
  slProcCode[0] = '\0';
  slProcCode[1] = '\0';
  slProcCode[2] = '\0';
  slProcCode[3] = '\0';
  slProcCode[6] = '\0';
  slFuncCode[0] = '\0';
  slFuncCode[1] = '\0';
  slFuncCode[2] = '\0';
  slFuncCode[3] = '\0';
  rService.szMti[0] = '\0';
  rService.szMti[1] = '\0';
  rService.szMti[2] = '\0';
  rService.szMti[3] = '\0';
  rService.szMti[4] = '\0';
  rService.szProcCode[0] = '\0';
  rService.szProcCode[1] = '\0';
  rService.szProcCode[2] = '\0';
  rService.szFctCode[0] = '\0';
  rService.szFctCode[1] = '\0';
  rService.szFctCode[2] = '\0';
  rService.szFctCode[3] = '\0';
  rService.szSrcAcc[0] = '\0';
  rService.szSrcAcc[1] = '\0';
  rService.szSrcAcc[2] = '\0';
  rService.szDestAcc[0] = '\0';
  sEventCode[0] = '\0';
  sEventCode[1] = '\0';
  sEventCode[2] = '\0';
  sEventCode[3] = '\0';
  sPrimResource[0] = '\0';
  sPrimResource[1] = '\0';
  sPrimResource[2] = '\0';
  sPrimResource[3] = '\0';
  sPrimResource[6] = '\0';
  sSecResource[0] = '\0';
  sSecResource[1] = '\0';
  sSecResource[2] = '\0';
  sSecResource[3] = '\0';
  sSecResource[6] = '\0';
  sCaptureCode[0] = '\0';
  sCaptureCode[1] = '\0';
  sCaptureCode[2] = '\0';
  sCaptureCode[3] = '\0';
  sCaptureCode[6] = '\0';
  pcVar6 = sAlternAmount;
  for (lVar5 = 0x200; lVar5 != 0; lVar5 = lVar5 + -1) {
    pcVar6[0] = '\0';
    pcVar6[1] = '\0';
    pcVar6[2] = '\0';
    pcVar6[3] = '\0';
    pcVar6[4] = '\0';
    pcVar6[5] = '\0';
    pcVar6[6] = '\0';
    pcVar6[7] = '\0';
    pcVar6 = pcVar6 + (ulong)bVar7 * -0x10 + 8;
  }
  *pcVar6 = '\0';
  InitTlvAutho(&sTlvInfo);
  iVar3 = IsoToTlv(nIndiceCtx,IsoInfo,&sTlvInfo);
  if (iVar3 != 0) {
    trace_event("IsoToTlv Error ...",1);
    InsertIsoField(0x26,IsoInfo,"909",3);
    return -1;
  }
  PutTlvAutho("288",&sTlvInfo,sAuthoTable,3);
  PutTlvAutho("201",&sTlvInfo,sMyResource,6);
  PutTlvAutho("253",&sTlvInfo,sAcquirerBank,6);
  PutTlvAutho("131",&sTlvInfo,InternationalRoutCheck,1);
  PutTlvAutho("200",&sTlvInfo,"000001",6);
  AuthoBuildTlv(sTlvBuffer,&sTlvInfo);
  PrintTlvBuffer(sTlvBuffer);
  iVar3 = GetOriginalDataElements(nIndiceCtx,"C",sTlvBuffer,sPrimResource);
  if (iVar3 == 0) {
    trace_event("Found a Duplicate Request. ",5);
    GetTlvBuffer("201",sTlvBuffer,sCaptureCode,&nLength);
    iVar3 = memcmp(sCaptureCode,"110000",6);
    if (iVar3 != 0) {
      PutTlvBuffer("039",sTlvBuffer,"308",3);
      PutTlvBuffer("038",sTlvBuffer,"      ",6);
    }
    InitTlvAutho(&sTlvInfo);
    AnalyseTlvAutho(sTlvBuffer,&sTlvInfo);
    TlvToIso(nIndiceCtx,&sTlvInfo,IsoInfo,'\x01');
    return 0;
  }
  iVar3 = CheckReqTlvFields(nIndiceCtx,sTlvBuffer);
  if (iVar3 != 0) {
LAB_00423480:
    SafIndicator = 'S';
    goto LAB_004232c2;
  }
  PutTlvBuffer("203",sTlvBuffer,"902",3);
  PrintTlvBuffer(sTlvBuffer);
  iVar3 = LoadIssuerData(nIndiceCtx,sTlvBuffer,InternationalRoutCheck,sPrimResource,sSecResource);
  PrintTlvBuffer(sTlvBuffer);
  sprintf(sLine,"Primary Resource    ...%.6s ",sPrimResource);
  trace_event(sLine,5);
  sprintf(sLine,"Secondarry Resource ...%.6s ",sSecResource);
  trace_event(sLine,5);
  if (iVar3 != 0) goto LAB_004232bc;
  PutTlvBuffer("200",sTlvBuffer,sPrimResource,6);
  pcVar6 = sTlvProcCode;
  for (lVar5 = 0x200; lVar5 != 0; lVar5 = lVar5 + -1) {
    pcVar6[0] = '\0';
    pcVar6[1] = '\0';
    pcVar6[2] = '\0';
    pcVar6[3] = '\0';
    pcVar6[4] = '\0';
    pcVar6[5] = '\0';
    pcVar6[6] = '\0';
    pcVar6[7] = '\0';
    pcVar6 = pcVar6 + (ulong)bVar7 * -0x10 + 8;
  }
  *pcVar6 = '\0';
  pcVar6 = sIsoProcCode;
  for (lVar5 = 0x200; lVar5 != 0; lVar5 = lVar5 + -1) {
    pcVar6[0] = '\0';
    pcVar6[1] = '\0';
    pcVar6[2] = '\0';
    pcVar6[3] = '\0';
    pcVar6[4] = '\0';
    pcVar6[5] = '\0';
    pcVar6[6] = '\0';
    pcVar6[7] = '\0';
    pcVar6 = pcVar6 + (ulong)bVar7 * -0x10 + 8;
  }
  *pcVar6 = '\0';
  iVar3 = GetTlvBuffer("003",sTlvBuffer,sTlvProcCode,&nLength);
  if ((iVar3 == 0) && (iVar3 = GetIsoField(2,IsoInfo,sIsoProcCode,&nLength), iVar3 == 0)) {
    sprintf(sLine," PROCESSING CODE TLV %s",sTlvProcCode);
    trace_event(sLine,4);
    sprintf(sLine," PROCESSING CODE ISO %s",sIsoProcCode);
    trace_event(sLine,4);
    sIsoProcCode[0] = sTlvProcCode[6];
    sIsoProcCode[1] = sTlvProcCode[7];
    sprintf(sLine," PROCESSING CODE ISO %s",sIsoProcCode);
    trace_event(sLine,4);
    PutIsoField(2,IsoInfo,sIsoProcCode,6);
  }
  GetIsoField(1,IsoInfo,slCardNumber,&nLength);
  GetIsoField(2,IsoInfo,slProcCode,&nLength);
  GetIsoField(0x17,IsoInfo,slFuncCode,&nLength);
  sprintf(rService.szMti,"%04d",(ulong)(uint)IsoInfo->nMsgType);
  uVar2 = slProcCode._0_4_;
  acVar1 = slFuncCode;
  nLength = 4;
  rService.szProcCode[0] = slProcCode[0];
  rService.szProcCode[1] = slProcCode[1];
  slProcCode._2_2_ = SUB42(uVar2,2);
  rService.szSrcAcc[0] = slProcCode[2];
  rService.szSrcAcc[1] = slProcCode[3];
  rService.szDestAcc[0] = (char)slProcCode._4_2_;
  rService.szDestAcc[1] = SUB21(slProcCode._4_2_,1);
  rService.szFctCode[0] = slFuncCode[0];
  rService.szFctCode[1] = slFuncCode[1];
  slFuncCode[2] = acVar1[2];
  rService.szFctCode[2] = slFuncCode[2];
  slFuncCode = acVar1;
  slProcCode._0_4_ = uVar2;
  uVar4 = CheckResourceServices(nIndiceCtx,sMyResource,&rService);
  if (uVar4 == 0) {
    PosCond[2] = '\0';
    PosCond[0] = '\0';
    PosCond[1] = '\0';
    iVar3 = GetIsoField(0x3c,IsoInfo,tmpField,&nLength);
    if (iVar3 == 0) {
      InitTlvPrivate(&TlvInfo);
      AnalyseTlvPrivate(tmpField,nLength,&TlvInfo);
      iVar3 = GetTlvPrivate("025",&TlvInfo,PosCond,&nLength);
      if (iVar3 != 0) goto LAB_0042317b;
      iVar3 = memcmp(PosCond,&DAT_004a908d,2);
      uVar4 = -(uint)(iVar3 != 0);
      sprintf(sLine,"ACCOUNT VERIFICATION1 ENH8.2 ...%d ",(ulong)uVar4);
      trace_event(sLine,5);
    }
    else {
LAB_0042317b:
      uVar4 = 0xffffffff;
    }
    iVar3 = memcmp(sPrimResource,"000001",6);
    if (iVar3 == 0) {
      trace_event("Prm : STAND_IN AUTHORISATION PROCESSING",5);
      iVar3 = GetSecurityFlags(nIndiceCtx,sTlvBuffer,"OFF");
      if (((iVar3 == 0) && (iVar3 = PreControl(nIndiceCtx,sTlvBuffer), iVar3 == 0)) &&
         (iVar3 = CheckSecurity(nIndiceCtx,sTlvBuffer), iVar3 == 0)) {
        if (uVar4 != 0) {
          iVar3 = AmountMng(nIndiceCtx,sServGatewayFlag,sBillCalculFlag,sTlvBuffer);
          if (iVar3 != 0) {
LAB_004239a2:
            trace_event("Retour AmountMng NOK ",5);
            goto LAB_004232bc;
          }
          PrintTlvBuffer(sTlvBuffer);
          iVar3 = CheckLimits(nIndiceCtx,"OFF",sTlvBuffer,sAlternAmount);
          if (iVar3 != 0) goto LAB_004232bc;
        }
        iVar3 = memcmp(sMyResource,&DAT_004a7e39,6);
        if (((iVar3 == 0) || (iVar3 = CheckFallBack(nIndiceCtx,"OFF",sTlvBuffer), iVar3 == 0)) &&
           (iVar3 = CheckAccAvailable(nIndiceCtx,sTlvBuffer), iVar3 == 0)) {
          pcVar6 = "000";
          goto LAB_004232ad;
        }
      }
    }
    else {
      iVar3 = GetTlvBuffer("203",sTlvBuffer,sEventCode,&nLength);
      if (iVar3 == 0) {
        iVar3 = CheckResource(nIndiceCtx,sPrimResource,&nPid);
        if ((iVar3 != 0) ||
           ((iVar3 = kill(nPid,0), iVar3 != 0 && (iVar3 = memcmp(ResourceId,"050000",6), iVar3 != 0)
            ))) {
          iVar3 = memcmp(sEventCode,&DAT_004caed9,3);
          if (iVar3 == 0) {
            local_9c00 = -1;
            goto LAB_00423625;
          }
          iVar3 = memcmp(sEventCode,&DAT_004caed9,3);
          if (iVar3 == 0) goto LAB_0042367a;
LAB_00423366:
          trace_event("PrimResUp is NOK",4);
LAB_00423379:
          PutTlvBuffer("025",sTlvBuffer,"1004",4);
          trace_event("Primary Ressource Down ",5);
LAB_004233a7:
          iVar3 = memcmp(sSecResource,"000000",6);
          if (iVar3 != 0) {
            iVar3 = memcmp(sSecResource,"000001",6);
            if (iVar3 == 0) {
              trace_event("Sec : STAND_IN AUTHORISATION PROCESSING",5);
              iVar3 = GetSecurityFlags(nIndiceCtx,sTlvBuffer,"OFF");
              if (((((iVar3 == 0) && (iVar3 = PreControl(nIndiceCtx,sTlvBuffer), iVar3 == 0)) &&
                   (iVar3 = CheckSecurity(nIndiceCtx,sTlvBuffer), iVar3 == 0)) &&
                  ((uVar4 == 0 ||
                   (iVar3 = CheckLimits(nIndiceCtx,"OFF",sTlvBuffer,sAlternAmount), iVar3 == 0))))
                 && (iVar3 = CheckAccAvailable(nIndiceCtx,sTlvBuffer), iVar3 == 0)) {
                PutTlvBuffer("203",sTlvBuffer,"000",3);
              }
              goto LAB_00423480;
            }
            iVar3 = CheckResource(nIndiceCtx,sSecResource,&nPid);
            if (iVar3 == 0) {
              PutTlvBuffer("203",sTlvBuffer,"000",3);
              iVar3 = AuthorRouting(nIndiceCtx,sTlvBuffer,sSecResource,nPid,IsoInfo);
              return iVar3;
            }
          }
          pcVar6 = "801";
          goto LAB_004232ad;
        }
        iVar3 = memcmp(sEventCode,&DAT_004caed9,3);
        if (iVar3 == 0) {
          local_9c00 = 0;
LAB_00423625:
          if ((uVar4 != 0) &&
             (iVar3 = AmountMng(nIndiceCtx,sServGatewayFlag,sBillCalculFlag,sTlvBuffer), iVar3 != 0)
             ) goto LAB_004239a2;
          PrintTlvBuffer(sTlvBuffer);
          iVar3 = memcmp(sEventCode,&DAT_004caed9,3);
          if ((iVar3 != 0) && (local_9c00 == -1)) goto LAB_00423366;
LAB_0042367a:
          iVar3 = CheckResource(nIndiceCtx,sPrimResource,&nPid);
          if ((iVar3 != 0) ||
             ((iVar3 = kill(nPid,0), iVar3 != 0 &&
              (iVar3 = memcmp(ResourceId,"050000",6), iVar3 != 0)))) goto LAB_00423379;
          trace_event("Primary Ressource Up ",5);
          iVar3 = CardInSaf(nIndiceCtx,slCardNumber);
          if (iVar3 != 0) {
            PutTlvBuffer("203",sTlvBuffer,"000",3);
            iVar3 = AuthorRouting(nIndiceCtx,sTlvBuffer,sPrimResource,nPid,IsoInfo);
            return iVar3;
          }
          PutTlvBuffer("025",sTlvBuffer,"1005",4);
          if (debug_option == 1) {
            sprintf(sLine,"Card [%s] Found In Saf File ",slCardNumber);
            trace_event(sLine,5);
          }
          goto LAB_004233a7;
        }
        iVar3 = GetSecurityFlags(nIndiceCtx,sTlvBuffer,"ON");
        if (((iVar3 != 0) || (iVar3 = PreControl(nIndiceCtx,sTlvBuffer), iVar3 != 0)) ||
           (iVar3 = CheckSecurity(nIndiceCtx,sTlvBuffer), iVar3 != 0)) {
LAB_0042397c:
          PutTlvBuffer("025",sTlvBuffer,"1006",4);
          SafIndicator = 'S';
          goto LAB_004232c2;
        }
        if (uVar4 != 0) {
          iVar3 = AmountMng(nIndiceCtx,sServGatewayFlag,sBillCalculFlag,sTlvBuffer);
          if (iVar3 != 0) {
            PutTlvBuffer("025",sTlvBuffer,"1006",4);
            trace_event("Retour AmountMng NOK ",5);
            SafIndicator = 'S';
            goto LAB_004232c2;
          }
          PrintTlvBuffer(sTlvBuffer);
          iVar3 = CheckLimits(nIndiceCtx,"ON",sTlvBuffer,sAlternAmount);
          if (iVar3 != 0) goto LAB_0042397c;
        }
        iVar3 = memcmp(sMyResource,&DAT_004a7e39,6);
        if ((iVar3 == 0) || (iVar3 = CheckFallBack(nIndiceCtx,"OFF",sTlvBuffer), iVar3 == 0))
        goto LAB_0042367a;
        iVar3 = 4;
        pcVar6 = "1006";
        tlv_name = "025";
        goto LAB_004232b7;
      }
    }
  }
  else {
    pcVar6 = sEventCode;
    sprintf(sLine,"Err CheckResourceServices, EventCode= [%d] ",(ulong)uVar4);
    trace_event(sLine,5);
    sprintf(pcVar6,"%03d",(ulong)uVar4);
    PutTlvBuffer("025",sTlvBuffer,"1006",4);
LAB_004232ad:
    iVar3 = 3;
    tlv_name = "203";
LAB_004232b7:
    PutTlvBuffer(tlv_name,sTlvBuffer,pcVar6,iVar3);
  }
LAB_004232bc:
  SafIndicator = 'N';
LAB_004232c2:
  iVar3 = AuthorLocal(nIndiceCtx,sTlvBuffer,IsoInfo,sMyResource,sPrimResource,SafIndicator);
  return iVar3;
}



// WARNING: Unknown calling convention

int PreauthProcessing(int nIndiceCtx,char *sMyResource,char *sAuthoTable,char *sAcquirerBank,
                     char *InternationalRoutCheck,char *sServGatewayFlag,char *sBillCalculFlag,
                     char *sTlvBuffer,TSIsoInfo *IsoInfo)

{
  char acVar1 [4];
  undefined4 uVar2;
  int iVar3;
  uint uVar4;
  long lVar5;
  char *pcVar6;
  char *tlv_name;
  char SafIndicator;
  byte bVar7;
  int local_9c00;
  char PosCond [3];
  char slFuncCode [4];
  char sEventCode [4];
  pid_t nPid;
  int nLength;
  char slProcCode [7];
  char sPrimResource [7];
  char sSecResource [7];
  char sInternalStan [7];
  char sCaptureCode [7];
  char sPid [9];
  char sSecurityResults [11];
  TSService rService;
  char slCardNumber [23];
  char sLine [512];
  char tmpField [513];
  char sSecurData [4096];
  char sAlternAmount [4097];
  char sTlvProcCode [4097];
  char sIsoProcCode [4097];
  TSTlvPrivate TlvInfo;
  TSTlvAutho sTlvInfo;
  
  bVar7 = 0;
  trace_event("Start PreauthProcessing()",5);
  pcVar6 = sSecurData;
  for (lVar5 = 0x200; lVar5 != 0; lVar5 = lVar5 + -1) {
    pcVar6[0] = '\0';
    pcVar6[1] = '\0';
    pcVar6[2] = '\0';
    pcVar6[3] = '\0';
    pcVar6[4] = '\0';
    pcVar6[5] = '\0';
    pcVar6[6] = '\0';
    pcVar6[7] = '\0';
    pcVar6 = pcVar6 + (ulong)bVar7 * -0x10 + 8;
  }
  rService.szDestAcc[1] = '\0';
  rService.szDestAcc[2] = '\0';
  slCardNumber[0x14] = '\0';
  slCardNumber[0x15] = '\0';
  slProcCode[4] = '\0';
  slProcCode[5] = '\0';
  sPrimResource[4] = '\0';
  sPrimResource[5] = '\0';
  sSecResource[4] = '\0';
  sSecResource[5] = '\0';
  sCaptureCode[4] = '\0';
  sCaptureCode[5] = '\0';
  slCardNumber[0] = '\0';
  slCardNumber[1] = '\0';
  slCardNumber[2] = '\0';
  slCardNumber[3] = '\0';
  slCardNumber[4] = '\0';
  slCardNumber[5] = '\0';
  slCardNumber[6] = '\0';
  slCardNumber[7] = '\0';
  slCardNumber[8] = '\0';
  slCardNumber[9] = '\0';
  slCardNumber[10] = '\0';
  slCardNumber[0xb] = '\0';
  slCardNumber[0xc] = '\0';
  slCardNumber[0xd] = '\0';
  slCardNumber[0xe] = '\0';
  slCardNumber[0xf] = '\0';
  slCardNumber[0x10] = '\0';
  slCardNumber[0x11] = '\0';
  slCardNumber[0x12] = '\0';
  slCardNumber[0x13] = '\0';
  slCardNumber[0x16] = '\0';
  slProcCode[0] = '\0';
  slProcCode[1] = '\0';
  slProcCode[2] = '\0';
  slProcCode[3] = '\0';
  slProcCode[6] = '\0';
  slFuncCode[0] = '\0';
  slFuncCode[1] = '\0';
  slFuncCode[2] = '\0';
  slFuncCode[3] = '\0';
  rService.szMti[0] = '\0';
  rService.szMti[1] = '\0';
  rService.szMti[2] = '\0';
  rService.szMti[3] = '\0';
  rService.szMti[4] = '\0';
  rService.szProcCode[0] = '\0';
  rService.szProcCode[1] = '\0';
  rService.szProcCode[2] = '\0';
  rService.szFctCode[0] = '\0';
  rService.szFctCode[1] = '\0';
  rService.szFctCode[2] = '\0';
  rService.szFctCode[3] = '\0';
  rService.szSrcAcc[0] = '\0';
  rService.szSrcAcc[1] = '\0';
  rService.szSrcAcc[2] = '\0';
  rService.szDestAcc[0] = '\0';
  sEventCode[0] = '\0';
  sEventCode[1] = '\0';
  sEventCode[2] = '\0';
  sEventCode[3] = '\0';
  sPrimResource[0] = '\0';
  sPrimResource[1] = '\0';
  sPrimResource[2] = '\0';
  sPrimResource[3] = '\0';
  sPrimResource[6] = '\0';
  sSecResource[0] = '\0';
  sSecResource[1] = '\0';
  sSecResource[2] = '\0';
  sSecResource[3] = '\0';
  sSecResource[6] = '\0';
  sCaptureCode[0] = '\0';
  sCaptureCode[1] = '\0';
  sCaptureCode[2] = '\0';
  sCaptureCode[3] = '\0';
  sCaptureCode[6] = '\0';
  pcVar6 = sAlternAmount;
  for (lVar5 = 0x200; lVar5 != 0; lVar5 = lVar5 + -1) {
    pcVar6[0] = '\0';
    pcVar6[1] = '\0';
    pcVar6[2] = '\0';
    pcVar6[3] = '\0';
    pcVar6[4] = '\0';
    pcVar6[5] = '\0';
    pcVar6[6] = '\0';
    pcVar6[7] = '\0';
    pcVar6 = pcVar6 + (ulong)bVar7 * -0x10 + 8;
  }
  *pcVar6 = '\0';
  InitTlvAutho(&sTlvInfo);
  iVar3 = IsoToTlv(nIndiceCtx,IsoInfo,&sTlvInfo);
  if (iVar3 != 0) {
    trace_event("IsoToTlv Error ...",1);
    InsertIsoField(0x26,IsoInfo,"909",3);
    return -1;
  }
  PutTlvAutho("288",&sTlvInfo,sAuthoTable,3);
  PutTlvAutho("201",&sTlvInfo,sMyResource,6);
  PutTlvAutho("253",&sTlvInfo,sAcquirerBank,6);
  PutTlvAutho("131",&sTlvInfo,InternationalRoutCheck,1);
  PutTlvAutho("200",&sTlvInfo,"000001",6);
  AuthoBuildTlv(sTlvBuffer,&sTlvInfo);
  PrintTlvBuffer(sTlvBuffer);
  iVar3 = GetOriginalDataElements(nIndiceCtx,"C",sTlvBuffer,sPrimResource);
  if (iVar3 == 0) {
    trace_event("Found a Duplicate Request. ",5);
    GetTlvBuffer("201",sTlvBuffer,sCaptureCode,&nLength);
    iVar3 = memcmp(sCaptureCode,"110000",6);
    if (iVar3 != 0) {
      PutTlvBuffer("039",sTlvBuffer,"308",3);
      PutTlvBuffer("038",sTlvBuffer,"      ",6);
    }
    InitTlvAutho(&sTlvInfo);
    AnalyseTlvAutho(sTlvBuffer,&sTlvInfo);
    TlvToIso(nIndiceCtx,&sTlvInfo,IsoInfo,'\x01');
    return 0;
  }
  iVar3 = CheckReqTlvFields(nIndiceCtx,sTlvBuffer);
  if (iVar3 != 0) {
LAB_004242c0:
    SafIndicator = 'S';
    goto LAB_00424102;
  }
  PutTlvBuffer("203",sTlvBuffer,"902",3);
  PrintTlvBuffer(sTlvBuffer);
  iVar3 = LoadIssuerData(nIndiceCtx,sTlvBuffer,InternationalRoutCheck,sPrimResource,sSecResource);
  PrintTlvBuffer(sTlvBuffer);
  sprintf(sLine,"Primary Resource    ...%.6s ",sPrimResource);
  trace_event(sLine,5);
  sprintf(sLine,"Secondarry Resource ...%.6s ",sSecResource);
  trace_event(sLine,5);
  if (iVar3 != 0) goto LAB_004240fc;
  PutTlvBuffer("200",sTlvBuffer,sPrimResource,6);
  pcVar6 = sTlvProcCode;
  for (lVar5 = 0x200; lVar5 != 0; lVar5 = lVar5 + -1) {
    pcVar6[0] = '\0';
    pcVar6[1] = '\0';
    pcVar6[2] = '\0';
    pcVar6[3] = '\0';
    pcVar6[4] = '\0';
    pcVar6[5] = '\0';
    pcVar6[6] = '\0';
    pcVar6[7] = '\0';
    pcVar6 = pcVar6 + (ulong)bVar7 * -0x10 + 8;
  }
  *pcVar6 = '\0';
  pcVar6 = sIsoProcCode;
  for (lVar5 = 0x200; lVar5 != 0; lVar5 = lVar5 + -1) {
    pcVar6[0] = '\0';
    pcVar6[1] = '\0';
    pcVar6[2] = '\0';
    pcVar6[3] = '\0';
    pcVar6[4] = '\0';
    pcVar6[5] = '\0';
    pcVar6[6] = '\0';
    pcVar6[7] = '\0';
    pcVar6 = pcVar6 + (ulong)bVar7 * -0x10 + 8;
  }
  *pcVar6 = '\0';
  iVar3 = GetTlvBuffer("003",sTlvBuffer,sTlvProcCode,&nLength);
  if ((iVar3 == 0) && (iVar3 = GetIsoField(2,IsoInfo,sIsoProcCode,&nLength), iVar3 == 0)) {
    sprintf(sLine," PROCESSING CODE TLV %s",sTlvProcCode);
    trace_event(sLine,4);
    sprintf(sLine," PROCESSING CODE ISO %s",sIsoProcCode);
    trace_event(sLine,4);
    sIsoProcCode[0] = sTlvProcCode[6];
    sIsoProcCode[1] = sTlvProcCode[7];
    sprintf(sLine," PROCESSING CODE ISO %s",sIsoProcCode);
    trace_event(sLine,4);
    PutIsoField(2,IsoInfo,sIsoProcCode,6);
  }
  GetIsoField(1,IsoInfo,slCardNumber,&nLength);
  GetIsoField(2,IsoInfo,slProcCode,&nLength);
  GetIsoField(0x17,IsoInfo,slFuncCode,&nLength);
  sprintf(rService.szMti,"%04d",(ulong)(uint)IsoInfo->nMsgType);
  uVar2 = slProcCode._0_4_;
  acVar1 = slFuncCode;
  nLength = 4;
  rService.szProcCode[0] = slProcCode[0];
  rService.szProcCode[1] = slProcCode[1];
  slProcCode._2_2_ = SUB42(uVar2,2);
  rService.szSrcAcc[0] = slProcCode[2];
  rService.szSrcAcc[1] = slProcCode[3];
  rService.szDestAcc[0] = (char)slProcCode._4_2_;
  rService.szDestAcc[1] = SUB21(slProcCode._4_2_,1);
  rService.szFctCode[0] = slFuncCode[0];
  rService.szFctCode[1] = slFuncCode[1];
  slFuncCode[2] = acVar1[2];
  rService.szFctCode[2] = slFuncCode[2];
  slFuncCode = acVar1;
  slProcCode._0_4_ = uVar2;
  uVar4 = CheckResourceServices(nIndiceCtx,sMyResource,&rService);
  if (uVar4 == 0) {
    PosCond[2] = '\0';
    PosCond[0] = '\0';
    PosCond[1] = '\0';
    iVar3 = GetIsoField(0x3c,IsoInfo,tmpField,&nLength);
    if (iVar3 == 0) {
      InitTlvPrivate(&TlvInfo);
      AnalyseTlvPrivate(tmpField,nLength,&TlvInfo);
      iVar3 = GetTlvPrivate("025",&TlvInfo,PosCond,&nLength);
      if (iVar3 != 0) goto LAB_00423fbb;
      iVar3 = memcmp(PosCond,&DAT_004a908d,2);
      uVar4 = -(uint)(iVar3 != 0);
      sprintf(sLine,"ACCOUNT VERIFICATION1 ENH8.2 ...%d ",(ulong)uVar4);
      trace_event(sLine,5);
    }
    else {
LAB_00423fbb:
      uVar4 = 0xffffffff;
    }
    iVar3 = memcmp(sPrimResource,"000001",6);
    if (iVar3 == 0) {
      trace_event("Prm : STAND_IN AUTHORISATION PROCESSING",5);
      iVar3 = GetSecurityFlags(nIndiceCtx,sTlvBuffer,"OFF");
      if (((iVar3 == 0) && (iVar3 = PreControl(nIndiceCtx,sTlvBuffer), iVar3 == 0)) &&
         (iVar3 = CheckSecurity(nIndiceCtx,sTlvBuffer), iVar3 == 0)) {
        if (uVar4 != 0) {
          iVar3 = AmountMng(nIndiceCtx,sServGatewayFlag,sBillCalculFlag,sTlvBuffer);
          if (iVar3 != 0) {
LAB_004247e2:
            trace_event("Retour AmountMng NOK ",5);
            goto LAB_004240fc;
          }
          PrintTlvBuffer(sTlvBuffer);
          iVar3 = CheckLimits(nIndiceCtx,"OFF",sTlvBuffer,sAlternAmount);
          if (iVar3 != 0) goto LAB_004240fc;
        }
        iVar3 = memcmp(sMyResource,&DAT_004a7e39,6);
        if (((iVar3 == 0) || (iVar3 = CheckFallBack(nIndiceCtx,"OFF",sTlvBuffer), iVar3 == 0)) &&
           (iVar3 = CheckAccAvailable(nIndiceCtx,sTlvBuffer), iVar3 == 0)) {
          pcVar6 = "000";
          goto LAB_004240ed;
        }
      }
    }
    else {
      iVar3 = GetTlvBuffer("203",sTlvBuffer,sEventCode,&nLength);
      if (iVar3 == 0) {
        iVar3 = CheckResource(nIndiceCtx,sPrimResource,&nPid);
        if ((iVar3 != 0) ||
           ((iVar3 = kill(nPid,0), iVar3 != 0 && (iVar3 = memcmp(ResourceId,"050000",6), iVar3 != 0)
            ))) {
          iVar3 = memcmp(sEventCode,&DAT_004caed9,3);
          if (iVar3 == 0) {
            local_9c00 = -1;
            goto LAB_00424465;
          }
          iVar3 = memcmp(sEventCode,&DAT_004caed9,3);
          if (iVar3 == 0) goto LAB_004244ba;
LAB_004241a6:
          trace_event("PrimResUp is NOK",4);
LAB_004241b9:
          PutTlvBuffer("025",sTlvBuffer,"1004",4);
          trace_event("Primary Ressource Down ",5);
LAB_004241e7:
          iVar3 = memcmp(sSecResource,"000000",6);
          if (iVar3 != 0) {
            iVar3 = memcmp(sSecResource,"000001",6);
            if (iVar3 == 0) {
              trace_event("Sec : STAND_IN AUTHORISATION PROCESSING",5);
              iVar3 = GetSecurityFlags(nIndiceCtx,sTlvBuffer,"OFF");
              if (((((iVar3 == 0) && (iVar3 = PreControl(nIndiceCtx,sTlvBuffer), iVar3 == 0)) &&
                   (iVar3 = CheckSecurity(nIndiceCtx,sTlvBuffer), iVar3 == 0)) &&
                  ((uVar4 == 0 ||
                   (iVar3 = CheckLimits(nIndiceCtx,"OFF",sTlvBuffer,sAlternAmount), iVar3 == 0))))
                 && (iVar3 = CheckAccAvailable(nIndiceCtx,sTlvBuffer), iVar3 == 0)) {
                PutTlvBuffer("203",sTlvBuffer,"000",3);
              }
              goto LAB_004242c0;
            }
            iVar3 = CheckResource(nIndiceCtx,sSecResource,&nPid);
            if (iVar3 == 0) {
              PutTlvBuffer("203",sTlvBuffer,"000",3);
              iVar3 = AuthorRouting(nIndiceCtx,sTlvBuffer,sSecResource,nPid,IsoInfo);
              return iVar3;
            }
          }
          pcVar6 = "801";
          goto LAB_004240ed;
        }
        iVar3 = memcmp(sEventCode,&DAT_004caed9,3);
        if (iVar3 == 0) {
          local_9c00 = 0;
LAB_00424465:
          if ((uVar4 != 0) &&
             (iVar3 = AmountMng(nIndiceCtx,sServGatewayFlag,sBillCalculFlag,sTlvBuffer), iVar3 != 0)
             ) goto LAB_004247e2;
          PrintTlvBuffer(sTlvBuffer);
          iVar3 = memcmp(sEventCode,&DAT_004caed9,3);
          if ((iVar3 != 0) && (local_9c00 == -1)) goto LAB_004241a6;
LAB_004244ba:
          iVar3 = CheckResource(nIndiceCtx,sPrimResource,&nPid);
          if ((iVar3 != 0) ||
             ((iVar3 = kill(nPid,0), iVar3 != 0 &&
              (iVar3 = memcmp(ResourceId,"050000",6), iVar3 != 0)))) goto LAB_004241b9;
          trace_event("Primary Ressource Up ",5);
          iVar3 = CardInSaf(nIndiceCtx,slCardNumber);
          if (iVar3 != 0) {
            PutTlvBuffer("203",sTlvBuffer,"000",3);
            iVar3 = AuthorRouting(nIndiceCtx,sTlvBuffer,sPrimResource,nPid,IsoInfo);
            return iVar3;
          }
          PutTlvBuffer("025",sTlvBuffer,"1005",4);
          if (debug_option == 1) {
            sprintf(sLine,"Card [%s] Found In Saf File ",slCardNumber);
            trace_event(sLine,5);
          }
          goto LAB_004241e7;
        }
        iVar3 = GetSecurityFlags(nIndiceCtx,sTlvBuffer,"ON");
        if (((iVar3 != 0) || (iVar3 = PreControl(nIndiceCtx,sTlvBuffer), iVar3 != 0)) ||
           (iVar3 = CheckSecurity(nIndiceCtx,sTlvBuffer), iVar3 != 0)) {
LAB_004247bc:
          PutTlvBuffer("025",sTlvBuffer,"1006",4);
          SafIndicator = 'S';
          goto LAB_00424102;
        }
        if (uVar4 != 0) {
          iVar3 = AmountMng(nIndiceCtx,sServGatewayFlag,sBillCalculFlag,sTlvBuffer);
          if (iVar3 != 0) {
            PutTlvBuffer("025",sTlvBuffer,"1006",4);
            trace_event("Retour AmountMng NOK ",5);
            SafIndicator = 'S';
            goto LAB_00424102;
          }
          PrintTlvBuffer(sTlvBuffer);
          iVar3 = CheckLimits(nIndiceCtx,"ON",sTlvBuffer,sAlternAmount);
          if (iVar3 != 0) goto LAB_004247bc;
        }
        iVar3 = memcmp(sMyResource,&DAT_004a7e39,6);
        if ((iVar3 == 0) || (iVar3 = CheckFallBack(nIndiceCtx,"OFF",sTlvBuffer), iVar3 == 0))
        goto LAB_004244ba;
        iVar3 = 4;
        pcVar6 = "1006";
        tlv_name = "025";
        goto LAB_004240f7;
      }
    }
  }
  else {
    pcVar6 = sEventCode;
    sprintf(sLine,"Err CheckResourceServices, EventCode= [%d] ",(ulong)uVar4);
    trace_event(sLine,5);
    sprintf(pcVar6,"%03d",(ulong)uVar4);
    PutTlvBuffer("025",sTlvBuffer,"1006",4);
LAB_004240ed:
    iVar3 = 3;
    tlv_name = "203";
LAB_004240f7:
    PutTlvBuffer(tlv_name,sTlvBuffer,pcVar6,iVar3);
  }
LAB_004240fc:
  SafIndicator = 'N';
LAB_00424102:
  iVar3 = AuthorLocal(nIndiceCtx,sTlvBuffer,IsoInfo,sMyResource,sPrimResource,SafIndicator);
  return iVar3;
}



// WARNING: Unknown calling convention

int CompletionProcessing
              (int nIndiceCtx,char *sMyResource,char *sAuthoTable,char *sAcquirerBank,
              char *InternationalRoutCheck,char *sServGatewayFlag,char *sBillCalculFlag,
              char *sTlvBuffer,TSIsoInfo *IsoInfo)

{
  char acVar1 [4];
  undefined4 uVar2;
  int iVar3;
  uint uVar4;
  long lVar5;
  char *pcVar6;
  char *tlv_name;
  char SafIndicator;
  byte bVar7;
  int local_9c48;
  int local_9c18;
  char PosCond [3];
  char slFuncCode [4];
  char sEventCode [4];
  pid_t nPid;
  int nLength;
  char slProcCode [7];
  char sPrimResource [7];
  char sSecResource [7];
  char sInternalStan [7];
  char sCaptureCode [7];
  char sAuthCode [7];
  char sPid [9];
  char sSecurityResults [11];
  char sReferenceNbr [13];
  TSService rService;
  char slCardNumber [23];
  char sLine [512];
  char tmpField [513];
  char sSecurData [4096];
  char sAlternAmount [4097];
  char sTlvProcCode [4097];
  char sIsoProcCode [4097];
  TSTlvPrivate TlvInfo;
  TSTlvAutho sTlvInfo;
  
  bVar7 = 0;
  trace_event("Start CompletionProcessing()",5);
  slCardNumber[0x14] = '\0';
  slCardNumber[0x15] = '\0';
  pcVar6 = sSecurData;
  for (lVar5 = 0x200; lVar5 != 0; lVar5 = lVar5 + -1) {
    pcVar6[0] = '\0';
    pcVar6[1] = '\0';
    pcVar6[2] = '\0';
    pcVar6[3] = '\0';
    pcVar6[4] = '\0';
    pcVar6[5] = '\0';
    pcVar6[6] = '\0';
    pcVar6[7] = '\0';
    pcVar6 = pcVar6 + (ulong)bVar7 * -0x10 + 8;
  }
  slProcCode[4] = '\0';
  slProcCode[5] = '\0';
  rService.szDestAcc[1] = '\0';
  rService.szDestAcc[2] = '\0';
  sPrimResource[4] = '\0';
  sPrimResource[5] = '\0';
  sSecResource[4] = '\0';
  sSecResource[5] = '\0';
  slCardNumber[0] = '\0';
  slCardNumber[1] = '\0';
  slCardNumber[2] = '\0';
  slCardNumber[3] = '\0';
  slCardNumber[4] = '\0';
  slCardNumber[5] = '\0';
  slCardNumber[6] = '\0';
  slCardNumber[7] = '\0';
  slCardNumber[8] = '\0';
  slCardNumber[9] = '\0';
  slCardNumber[10] = '\0';
  slCardNumber[0xb] = '\0';
  slCardNumber[0xc] = '\0';
  slCardNumber[0xd] = '\0';
  slCardNumber[0xe] = '\0';
  slCardNumber[0xf] = '\0';
  slCardNumber[0x10] = '\0';
  slCardNumber[0x11] = '\0';
  slCardNumber[0x12] = '\0';
  slCardNumber[0x13] = '\0';
  slCardNumber[0x16] = '\0';
  slProcCode[0] = '\0';
  slProcCode[1] = '\0';
  slProcCode[2] = '\0';
  slProcCode[3] = '\0';
  sCaptureCode[4] = '\0';
  sCaptureCode[5] = '\0';
  slProcCode[6] = '\0';
  slFuncCode[0] = '\0';
  slFuncCode[1] = '\0';
  slFuncCode[2] = '\0';
  slFuncCode[3] = '\0';
  rService.szMti[0] = '\0';
  rService.szMti[1] = '\0';
  rService.szMti[2] = '\0';
  rService.szMti[3] = '\0';
  rService.szMti[4] = '\0';
  rService.szProcCode[0] = '\0';
  rService.szProcCode[1] = '\0';
  rService.szProcCode[2] = '\0';
  rService.szFctCode[0] = '\0';
  rService.szFctCode[1] = '\0';
  rService.szFctCode[2] = '\0';
  rService.szFctCode[3] = '\0';
  rService.szSrcAcc[0] = '\0';
  rService.szSrcAcc[1] = '\0';
  rService.szSrcAcc[2] = '\0';
  rService.szDestAcc[0] = '\0';
  sEventCode[0] = '\0';
  sEventCode[1] = '\0';
  sEventCode[2] = '\0';
  sEventCode[3] = '\0';
  sPrimResource[0] = '\0';
  sPrimResource[1] = '\0';
  sPrimResource[2] = '\0';
  sPrimResource[3] = '\0';
  sPrimResource[6] = '\0';
  sSecResource[0] = '\0';
  sSecResource[1] = '\0';
  sSecResource[2] = '\0';
  sSecResource[3] = '\0';
  sSecResource[6] = '\0';
  sCaptureCode[0] = '\0';
  sCaptureCode[1] = '\0';
  sCaptureCode[2] = '\0';
  sCaptureCode[3] = '\0';
  sCaptureCode[6] = '\0';
  sReferenceNbr[0] = '\0';
  sReferenceNbr[1] = '\0';
  sReferenceNbr[2] = '\0';
  sReferenceNbr[3] = '\0';
  sReferenceNbr[4] = '\0';
  sReferenceNbr[5] = '\0';
  sReferenceNbr[6] = '\0';
  sReferenceNbr[7] = '\0';
  pcVar6 = sAlternAmount;
  for (lVar5 = 0x200; lVar5 != 0; lVar5 = lVar5 + -1) {
    pcVar6[0] = '\0';
    pcVar6[1] = '\0';
    pcVar6[2] = '\0';
    pcVar6[3] = '\0';
    pcVar6[4] = '\0';
    pcVar6[5] = '\0';
    pcVar6[6] = '\0';
    pcVar6[7] = '\0';
    pcVar6 = pcVar6 + (ulong)bVar7 * -0x10 + 8;
  }
  sReferenceNbr[8] = '\0';
  sReferenceNbr[9] = '\0';
  sReferenceNbr[10] = '\0';
  sReferenceNbr[0xb] = '\0';
  sReferenceNbr[0xc] = '\0';
  sAuthCode[4] = '\0';
  sAuthCode[5] = '\0';
  sAuthCode[0] = '\0';
  sAuthCode[1] = '\0';
  sAuthCode[2] = '\0';
  sAuthCode[3] = '\0';
  sAuthCode[6] = '\0';
  *pcVar6 = '\0';
  InitTlvAutho(&sTlvInfo);
  iVar3 = IsoToTlv(nIndiceCtx,IsoInfo,&sTlvInfo);
  if (iVar3 != 0) {
    trace_event("IsoToTlv Error ...",1);
    InsertIsoField(0x26,IsoInfo,"909",3);
    return -1;
  }
  PutTlvAutho("288",&sTlvInfo,sAuthoTable,3);
  PutTlvAutho("201",&sTlvInfo,sMyResource,6);
  PutTlvAutho("253",&sTlvInfo,sAcquirerBank,6);
  PutTlvAutho("131",&sTlvInfo,InternationalRoutCheck,1);
  PutTlvAutho("200",&sTlvInfo,"000001",6);
  AuthoBuildTlv(sTlvBuffer,&sTlvInfo);
  PrintTlvBuffer(sTlvBuffer);
  iVar3 = GetOriginalDataElements(nIndiceCtx,"C",sTlvBuffer,sPrimResource);
  if (iVar3 == 0) {
    trace_event("Found a Duplicate Request. ",5);
    GetTlvBuffer("201",sTlvBuffer,sCaptureCode,&nLength);
    iVar3 = memcmp(sCaptureCode,"110000",6);
    if (iVar3 != 0) {
      PutTlvBuffer("039",sTlvBuffer,"308",3);
      PutTlvBuffer("038",sTlvBuffer,"      ",6);
    }
    InitTlvAutho(&sTlvInfo);
    AnalyseTlvAutho(sTlvBuffer,&sTlvInfo);
    TlvToIso(nIndiceCtx,&sTlvInfo,IsoInfo,'\x01');
    return 0;
  }
  iVar3 = CheckReqTlvFields(nIndiceCtx,sTlvBuffer);
  if (iVar3 != 0) {
LAB_004251c0:
    SafIndicator = 'S';
    goto LAB_00425002;
  }
  PutTlvBuffer("203",sTlvBuffer,"902",3);
  PrintTlvBuffer(sTlvBuffer);
  iVar3 = LoadIssuerData(nIndiceCtx,sTlvBuffer,InternationalRoutCheck,sPrimResource,sSecResource);
  PrintTlvBuffer(sTlvBuffer);
  sprintf(sLine,"Primary Resource    ...%.6s ",sPrimResource);
  trace_event(sLine,5);
  sprintf(sLine,"Secondarry Resource ...%.6s ",sSecResource);
  trace_event(sLine,5);
  if (iVar3 != 0) goto LAB_00424ffc;
  PutTlvBuffer("200",sTlvBuffer,sPrimResource,6);
  pcVar6 = sTlvProcCode;
  for (lVar5 = 0x200; lVar5 != 0; lVar5 = lVar5 + -1) {
    pcVar6[0] = '\0';
    pcVar6[1] = '\0';
    pcVar6[2] = '\0';
    pcVar6[3] = '\0';
    pcVar6[4] = '\0';
    pcVar6[5] = '\0';
    pcVar6[6] = '\0';
    pcVar6[7] = '\0';
    pcVar6 = pcVar6 + (ulong)bVar7 * -0x10 + 8;
  }
  *pcVar6 = '\0';
  pcVar6 = sIsoProcCode;
  for (lVar5 = 0x200; lVar5 != 0; lVar5 = lVar5 + -1) {
    pcVar6[0] = '\0';
    pcVar6[1] = '\0';
    pcVar6[2] = '\0';
    pcVar6[3] = '\0';
    pcVar6[4] = '\0';
    pcVar6[5] = '\0';
    pcVar6[6] = '\0';
    pcVar6[7] = '\0';
    pcVar6 = pcVar6 + (ulong)bVar7 * -0x10 + 8;
  }
  *pcVar6 = '\0';
  iVar3 = GetTlvBuffer("003",sTlvBuffer,sTlvProcCode,&nLength);
  if ((iVar3 == 0) && (iVar3 = GetIsoField(2,IsoInfo,sIsoProcCode,&nLength), iVar3 == 0)) {
    sprintf(sLine," PROCESSING CODE TLV %s",sTlvProcCode);
    trace_event(sLine,4);
    sprintf(sLine," PROCESSING CODE ISO %s",sIsoProcCode);
    trace_event(sLine,4);
    sIsoProcCode[0] = sTlvProcCode[6];
    sIsoProcCode[1] = sTlvProcCode[7];
    sprintf(sLine," PROCESSING CODE ISO %s",sIsoProcCode);
    trace_event(sLine,4);
    PutIsoField(2,IsoInfo,sIsoProcCode,6);
  }
  GetIsoField(1,IsoInfo,slCardNumber,&nLength);
  GetIsoField(2,IsoInfo,slProcCode,&nLength);
  GetIsoField(0x17,IsoInfo,slFuncCode,&nLength);
  sprintf(rService.szMti,"%04d",(ulong)(uint)IsoInfo->nMsgType);
  GetIsoField(0x24,IsoInfo,sReferenceNbr,&nLength);
  GetIsoField(0x25,IsoInfo,sAuthCode,&nLength);
  uVar2 = slProcCode._0_4_;
  acVar1 = slFuncCode;
  nLength = 4;
  rService.szProcCode[0] = slProcCode[0];
  rService.szProcCode[1] = slProcCode[1];
  slProcCode._2_2_ = SUB42(uVar2,2);
  rService.szSrcAcc[0] = slProcCode[2];
  rService.szSrcAcc[1] = slProcCode[3];
  rService.szDestAcc[0] = (char)slProcCode._4_2_;
  rService.szDestAcc[1] = SUB21(slProcCode._4_2_,1);
  rService.szFctCode[0] = slFuncCode[0];
  rService.szFctCode[1] = slFuncCode[1];
  slFuncCode[2] = acVar1[2];
  rService.szFctCode[2] = slFuncCode[2];
  slFuncCode = acVar1;
  slProcCode._0_4_ = uVar2;
  uVar4 = CheckResourceServices(nIndiceCtx,sMyResource,&rService);
  if (uVar4 == 0) {
    PosCond[0] = '\0';
    PosCond[1] = '\0';
    PosCond[2] = '\0';
    iVar3 = GetIsoField(0x3c,IsoInfo,tmpField,&nLength);
    if (iVar3 == 0) {
      InitTlvPrivate(&TlvInfo);
      AnalyseTlvPrivate(tmpField,nLength,&TlvInfo);
      iVar3 = GetTlvPrivate("025",&TlvInfo,PosCond,&nLength);
      if (iVar3 != 0) goto LAB_00424e8b;
      iVar3 = memcmp(PosCond,&DAT_004a908d,2);
      local_9c18 = -(uint)(iVar3 != 0);
      sprintf(sLine,"ACCOUNT VERIFICATION1 ENH8.2 ...%d ",local_9c18);
      trace_event(sLine,5);
    }
    else {
LAB_00424e8b:
      local_9c18 = -1;
    }
    iVar3 = memcmp(sPrimResource,"000001",6);
    if (iVar3 == 0) {
      trace_event("Prm : STAND_IN AUTHORISATION PROCESSING",5);
      iVar3 = GetSecurityFlags(nIndiceCtx,sTlvBuffer,"OFF");
      if (((iVar3 == 0) && (iVar3 = PreControl(nIndiceCtx,sTlvBuffer), iVar3 == 0)) &&
         (iVar3 = CheckSecurity(nIndiceCtx,sTlvBuffer), iVar3 == 0)) {
        if (local_9c18 != 0) {
          iVar3 = AmountMng(nIndiceCtx,sServGatewayFlag,sBillCalculFlag,sTlvBuffer);
          if (iVar3 != 0) {
LAB_00425715:
            trace_event("Retour AmountMng NOK ",5);
            goto LAB_00424ffc;
          }
          PrintTlvBuffer(sTlvBuffer);
          iVar3 = CheckLimits(nIndiceCtx,"OFF",sTlvBuffer,sAlternAmount);
          if (iVar3 != 0) goto LAB_00424ffc;
        }
        iVar3 = memcmp(sMyResource,&DAT_004a7e39,6);
        if ((iVar3 == 0) || (iVar3 = CheckFallBack(nIndiceCtx,"OFF",sTlvBuffer), iVar3 == 0)) {
          iVar3 = Completion(nIndiceCtx,sReferenceNbr,sAuthCode,sTlvBuffer);
          if (iVar3 != 0) goto LAB_004251c0;
          iVar3 = CheckAccAvailable(nIndiceCtx,sTlvBuffer);
          if (iVar3 == 0) {
            pcVar6 = "000";
            goto LAB_00424fed;
          }
        }
      }
    }
    else {
      iVar3 = GetTlvBuffer("203",sTlvBuffer,sEventCode,&nLength);
      if (iVar3 == 0) {
        iVar3 = CheckResource(nIndiceCtx,sPrimResource,&nPid);
        if ((iVar3 != 0) ||
           ((iVar3 = kill(nPid,0), iVar3 != 0 && (iVar3 = memcmp(ResourceId,"050000",6), iVar3 != 0)
            ))) {
          iVar3 = memcmp(sEventCode,&DAT_004caed9,3);
          if (iVar3 == 0) {
            local_9c48 = -1;
            goto LAB_00425371;
          }
          iVar3 = memcmp(sEventCode,&DAT_004caed9,3);
          if (iVar3 == 0) goto LAB_004253c8;
LAB_004250a0:
          trace_event("PrimResUp is NOK",4);
LAB_004250b3:
          PutTlvBuffer("025",sTlvBuffer,"1004",4);
          trace_event("Primary Ressource Down ",5);
LAB_004250e1:
          iVar3 = memcmp(sSecResource,"000000",6);
          if (iVar3 != 0) {
            iVar3 = memcmp(sSecResource,"000001",6);
            if (iVar3 == 0) {
              trace_event("Sec : STAND_IN AUTHORISATION PROCESSING",5);
              iVar3 = GetSecurityFlags(nIndiceCtx,sTlvBuffer,"OFF");
              if (((((iVar3 == 0) && (iVar3 = PreControl(nIndiceCtx,sTlvBuffer), iVar3 == 0)) &&
                   (iVar3 = CheckSecurity(nIndiceCtx,sTlvBuffer), iVar3 == 0)) &&
                  ((local_9c18 == 0 ||
                   (iVar3 = CheckLimits(nIndiceCtx,"OFF",sTlvBuffer,sAlternAmount), iVar3 == 0))))
                 && (iVar3 = CheckAccAvailable(nIndiceCtx,sTlvBuffer), iVar3 == 0)) {
                PutTlvBuffer("203",sTlvBuffer,"000",3);
              }
              goto LAB_004251c0;
            }
            iVar3 = CheckResource(nIndiceCtx,sSecResource,&nPid);
            if (iVar3 == 0) {
              PutTlvBuffer("203",sTlvBuffer,"000",3);
              iVar3 = AuthorRouting(nIndiceCtx,sTlvBuffer,sSecResource,nPid,IsoInfo);
              return iVar3;
            }
          }
          pcVar6 = "801";
          goto LAB_00424fed;
        }
        iVar3 = memcmp(sEventCode,&DAT_004caed9,3);
        if (iVar3 == 0) {
          local_9c48 = 0;
LAB_00425371:
          if ((local_9c18 != 0) &&
             (iVar3 = AmountMng(nIndiceCtx,sServGatewayFlag,sBillCalculFlag,sTlvBuffer), iVar3 != 0)
             ) goto LAB_00425715;
          PrintTlvBuffer(sTlvBuffer);
          iVar3 = memcmp(sEventCode,&DAT_004caed9,3);
          if ((iVar3 != 0) && (local_9c48 == -1)) goto LAB_004250a0;
LAB_004253c8:
          iVar3 = CheckResource(nIndiceCtx,sPrimResource,&nPid);
          if ((iVar3 != 0) ||
             ((iVar3 = kill(nPid,0), iVar3 != 0 &&
              (iVar3 = memcmp(ResourceId,"050000",6), iVar3 != 0)))) goto LAB_004250b3;
          trace_event("Primary Ressource Up ",5);
          iVar3 = CardInSaf(nIndiceCtx,slCardNumber);
          if (iVar3 != 0) {
            PutTlvBuffer("203",sTlvBuffer,"000",3);
            iVar3 = AuthorRouting(nIndiceCtx,sTlvBuffer,sPrimResource,nPid,IsoInfo);
            return iVar3;
          }
          PutTlvBuffer("025",sTlvBuffer,"1005",4);
          if (debug_option == 1) {
            sprintf(sLine,"Card [%s] Found In Saf File ",slCardNumber);
            trace_event(sLine,5);
          }
          goto LAB_004250e1;
        }
        iVar3 = GetSecurityFlags(nIndiceCtx,sTlvBuffer,"ON");
        if (((iVar3 != 0) || (iVar3 = PreControl(nIndiceCtx,sTlvBuffer), iVar3 != 0)) ||
           (iVar3 = CheckSecurity(nIndiceCtx,sTlvBuffer), iVar3 != 0)) {
LAB_004256ef:
          PutTlvBuffer("025",sTlvBuffer,"1006",4);
          SafIndicator = 'S';
          goto LAB_00425002;
        }
        if (local_9c18 != 0) {
          iVar3 = AmountMng(nIndiceCtx,sServGatewayFlag,sBillCalculFlag,sTlvBuffer);
          if (iVar3 != 0) {
            PutTlvBuffer("025",sTlvBuffer,"1006",4);
            trace_event("Retour AmountMng NOK ",5);
            SafIndicator = 'S';
            goto LAB_00425002;
          }
          PrintTlvBuffer(sTlvBuffer);
          iVar3 = CheckLimits(nIndiceCtx,"ON",sTlvBuffer,sAlternAmount);
          if (iVar3 != 0) goto LAB_004256ef;
        }
        iVar3 = memcmp(sMyResource,&DAT_004a7e39,6);
        if ((iVar3 == 0) || (iVar3 = CheckFallBack(nIndiceCtx,"OFF",sTlvBuffer), iVar3 == 0)) {
          iVar3 = Completion(nIndiceCtx,sReferenceNbr,sAuthCode,sTlvBuffer);
          if (iVar3 != 0) goto LAB_004251c0;
          goto LAB_004253c8;
        }
        iVar3 = 4;
        pcVar6 = "1006";
        tlv_name = "025";
        goto LAB_00424ff7;
      }
    }
  }
  else {
    pcVar6 = sEventCode;
    sprintf(sLine,"Err CheckResourceServices, EventCode= [%d] ",(ulong)uVar4);
    trace_event(sLine,5);
    sprintf(pcVar6,"%03d",(ulong)uVar4);
    PutTlvBuffer("025",sTlvBuffer,"1006",4);
LAB_00424fed:
    iVar3 = 3;
    tlv_name = "203";
LAB_00424ff7:
    PutTlvBuffer(tlv_name,sTlvBuffer,pcVar6,iVar3);
  }
LAB_00424ffc:
  SafIndicator = 'N';
LAB_00425002:
  iVar3 = AuthorLocal(nIndiceCtx,sTlvBuffer,IsoInfo,sMyResource,sPrimResource,SafIndicator);
  return iVar3;
}



// WARNING: Unknown calling convention

int RetailPurchaseProcessing
              (int nIndiceCtx,char *sMyResource,char *sAuthoTable,char *sAcquirerBank,
              char *InternationalRoutCheck,char *sServGatewayFlag,char *sBillCalculFlag,
              char *sTlvBuffer,TSIsoInfo *IsoInfo)

{
  char acVar1 [4];
  undefined4 uVar2;
  int iVar3;
  uint uVar4;
  long lVar5;
  char *pcVar6;
  char *tlv_name;
  char SafIndicator;
  byte bVar7;
  int local_9c00;
  char PosCond [3];
  char slFuncCode [4];
  char sEventCode [4];
  pid_t nPid;
  int nLength;
  char slProcCode [7];
  char sPrimResource [7];
  char sSecResource [7];
  char sInternalStan [7];
  char sCaptureCode [7];
  char sPid [9];
  char sSecurityResults [11];
  TSService rService;
  char slCardNumber [23];
  char sLine [512];
  char tmpField [513];
  char sSecurData [4096];
  char sAlternAmount [4097];
  char sTlvProcCode [4097];
  char sIsoProcCode [4097];
  TSTlvPrivate TlvInfo;
  TSTlvAutho sTlvInfo;
  
  bVar7 = 0;
  trace_event("Start RetailPurchaseProcessing()",5);
  pcVar6 = sSecurData;
  for (lVar5 = 0x200; lVar5 != 0; lVar5 = lVar5 + -1) {
    pcVar6[0] = '\0';
    pcVar6[1] = '\0';
    pcVar6[2] = '\0';
    pcVar6[3] = '\0';
    pcVar6[4] = '\0';
    pcVar6[5] = '\0';
    pcVar6[6] = '\0';
    pcVar6[7] = '\0';
    pcVar6 = pcVar6 + (ulong)bVar7 * -0x10 + 8;
  }
  rService.szDestAcc[1] = '\0';
  rService.szDestAcc[2] = '\0';
  slCardNumber[0x14] = '\0';
  slCardNumber[0x15] = '\0';
  slProcCode[4] = '\0';
  slProcCode[5] = '\0';
  sPrimResource[4] = '\0';
  sPrimResource[5] = '\0';
  sSecResource[4] = '\0';
  sSecResource[5] = '\0';
  sCaptureCode[4] = '\0';
  sCaptureCode[5] = '\0';
  slCardNumber[0] = '\0';
  slCardNumber[1] = '\0';
  slCardNumber[2] = '\0';
  slCardNumber[3] = '\0';
  slCardNumber[4] = '\0';
  slCardNumber[5] = '\0';
  slCardNumber[6] = '\0';
  slCardNumber[7] = '\0';
  slCardNumber[8] = '\0';
  slCardNumber[9] = '\0';
  slCardNumber[10] = '\0';
  slCardNumber[0xb] = '\0';
  slCardNumber[0xc] = '\0';
  slCardNumber[0xd] = '\0';
  slCardNumber[0xe] = '\0';
  slCardNumber[0xf] = '\0';
  slCardNumber[0x10] = '\0';
  slCardNumber[0x11] = '\0';
  slCardNumber[0x12] = '\0';
  slCardNumber[0x13] = '\0';
  slCardNumber[0x16] = '\0';
  slProcCode[0] = '\0';
  slProcCode[1] = '\0';
  slProcCode[2] = '\0';
  slProcCode[3] = '\0';
  slProcCode[6] = '\0';
  slFuncCode[0] = '\0';
  slFuncCode[1] = '\0';
  slFuncCode[2] = '\0';
  slFuncCode[3] = '\0';
  rService.szMti[0] = '\0';
  rService.szMti[1] = '\0';
  rService.szMti[2] = '\0';
  rService.szMti[3] = '\0';
  rService.szMti[4] = '\0';
  rService.szProcCode[0] = '\0';
  rService.szProcCode[1] = '\0';
  rService.szProcCode[2] = '\0';
  rService.szFctCode[0] = '\0';
  rService.szFctCode[1] = '\0';
  rService.szFctCode[2] = '\0';
  rService.szFctCode[3] = '\0';
  rService.szSrcAcc[0] = '\0';
  rService.szSrcAcc[1] = '\0';
  rService.szSrcAcc[2] = '\0';
  rService.szDestAcc[0] = '\0';
  sEventCode[0] = '\0';
  sEventCode[1] = '\0';
  sEventCode[2] = '\0';
  sEventCode[3] = '\0';
  sPrimResource[0] = '\0';
  sPrimResource[1] = '\0';
  sPrimResource[2] = '\0';
  sPrimResource[3] = '\0';
  sPrimResource[6] = '\0';
  sSecResource[0] = '\0';
  sSecResource[1] = '\0';
  sSecResource[2] = '\0';
  sSecResource[3] = '\0';
  sSecResource[6] = '\0';
  sCaptureCode[0] = '\0';
  sCaptureCode[1] = '\0';
  sCaptureCode[2] = '\0';
  sCaptureCode[3] = '\0';
  sCaptureCode[6] = '\0';
  pcVar6 = sAlternAmount;
  for (lVar5 = 0x200; lVar5 != 0; lVar5 = lVar5 + -1) {
    pcVar6[0] = '\0';
    pcVar6[1] = '\0';
    pcVar6[2] = '\0';
    pcVar6[3] = '\0';
    pcVar6[4] = '\0';
    pcVar6[5] = '\0';
    pcVar6[6] = '\0';
    pcVar6[7] = '\0';
    pcVar6 = pcVar6 + (ulong)bVar7 * -0x10 + 8;
  }
  *pcVar6 = '\0';
  InitTlvAutho(&sTlvInfo);
  iVar3 = IsoToTlv(nIndiceCtx,IsoInfo,&sTlvInfo);
  if (iVar3 != 0) {
    trace_event("IsoToTlv Error ...",1);
    InsertIsoField(0x26,IsoInfo,"909",3);
    return -1;
  }
  PutTlvAutho("288",&sTlvInfo,sAuthoTable,3);
  PutTlvAutho("201",&sTlvInfo,sMyResource,6);
  PutTlvAutho("253",&sTlvInfo,sAcquirerBank,6);
  PutTlvAutho("131",&sTlvInfo,InternationalRoutCheck,1);
  PutTlvAutho("200",&sTlvInfo,"000001",6);
  AuthoBuildTlv(sTlvBuffer,&sTlvInfo);
  PrintTlvBuffer(sTlvBuffer);
  iVar3 = GetOriginalDataElements(nIndiceCtx,"C",sTlvBuffer,sPrimResource);
  if (iVar3 == 0) {
    trace_event("Found a Duplicate Request. ",5);
    GetTlvBuffer("201",sTlvBuffer,sCaptureCode,&nLength);
    iVar3 = memcmp(sCaptureCode,"110000",6);
    if (iVar3 != 0) {
      PutTlvBuffer("039",sTlvBuffer,"308",3);
      PutTlvBuffer("038",sTlvBuffer,"      ",6);
    }
    InitTlvAutho(&sTlvInfo);
    AnalyseTlvAutho(sTlvBuffer,&sTlvInfo);
    TlvToIso(nIndiceCtx,&sTlvInfo,IsoInfo,'\x01');
    return 0;
  }
  iVar3 = CheckReqTlvFields(nIndiceCtx,sTlvBuffer);
  if (iVar3 != 0) {
LAB_00426050:
    SafIndicator = 'S';
    goto LAB_00425e92;
  }
  PutTlvBuffer("203",sTlvBuffer,"902",3);
  PrintTlvBuffer(sTlvBuffer);
  iVar3 = LoadIssuerData(nIndiceCtx,sTlvBuffer,InternationalRoutCheck,sPrimResource,sSecResource);
  PrintTlvBuffer(sTlvBuffer);
  sprintf(sLine,"Primary Resource    ...%.6s ",sPrimResource);
  trace_event(sLine,5);
  sprintf(sLine,"Secondarry Resource ...%.6s ",sSecResource);
  trace_event(sLine,5);
  if (iVar3 != 0) goto LAB_00425e8c;
  PutTlvBuffer("200",sTlvBuffer,sPrimResource,6);
  pcVar6 = sTlvProcCode;
  for (lVar5 = 0x200; lVar5 != 0; lVar5 = lVar5 + -1) {
    pcVar6[0] = '\0';
    pcVar6[1] = '\0';
    pcVar6[2] = '\0';
    pcVar6[3] = '\0';
    pcVar6[4] = '\0';
    pcVar6[5] = '\0';
    pcVar6[6] = '\0';
    pcVar6[7] = '\0';
    pcVar6 = pcVar6 + (ulong)bVar7 * -0x10 + 8;
  }
  *pcVar6 = '\0';
  pcVar6 = sIsoProcCode;
  for (lVar5 = 0x200; lVar5 != 0; lVar5 = lVar5 + -1) {
    pcVar6[0] = '\0';
    pcVar6[1] = '\0';
    pcVar6[2] = '\0';
    pcVar6[3] = '\0';
    pcVar6[4] = '\0';
    pcVar6[5] = '\0';
    pcVar6[6] = '\0';
    pcVar6[7] = '\0';
    pcVar6 = pcVar6 + (ulong)bVar7 * -0x10 + 8;
  }
  *pcVar6 = '\0';
  iVar3 = GetTlvBuffer("003",sTlvBuffer,sTlvProcCode,&nLength);
  if ((iVar3 == 0) && (iVar3 = GetIsoField(2,IsoInfo,sIsoProcCode,&nLength), iVar3 == 0)) {
    sprintf(sLine," PROCESSING CODE TLV %s",sTlvProcCode);
    trace_event(sLine,4);
    sprintf(sLine," PROCESSING CODE ISO %s",sIsoProcCode);
    trace_event(sLine,4);
    sIsoProcCode[0] = sTlvProcCode[6];
    sIsoProcCode[1] = sTlvProcCode[7];
    sprintf(sLine," PROCESSING CODE ISO %s",sIsoProcCode);
    trace_event(sLine,4);
    PutIsoField(2,IsoInfo,sIsoProcCode,6);
  }
  GetIsoField(1,IsoInfo,slCardNumber,&nLength);
  GetIsoField(2,IsoInfo,slProcCode,&nLength);
  GetIsoField(0x17,IsoInfo,slFuncCode,&nLength);
  sprintf(rService.szMti,"%04d",(ulong)(uint)IsoInfo->nMsgType);
  uVar2 = slProcCode._0_4_;
  acVar1 = slFuncCode;
  nLength = 4;
  rService.szProcCode[0] = slProcCode[0];
  rService.szProcCode[1] = slProcCode[1];
  slProcCode._2_2_ = SUB42(uVar2,2);
  rService.szSrcAcc[0] = slProcCode[2];
  rService.szSrcAcc[1] = slProcCode[3];
  rService.szDestAcc[0] = (char)slProcCode._4_2_;
  rService.szDestAcc[1] = SUB21(slProcCode._4_2_,1);
  rService.szFctCode[0] = slFuncCode[0];
  rService.szFctCode[1] = slFuncCode[1];
  slFuncCode[2] = acVar1[2];
  rService.szFctCode[2] = slFuncCode[2];
  slFuncCode = acVar1;
  slProcCode._0_4_ = uVar2;
  uVar4 = CheckResourceServices(nIndiceCtx,sMyResource,&rService);
  if (uVar4 == 0) {
    PosCond[2] = '\0';
    PosCond[0] = '\0';
    PosCond[1] = '\0';
    iVar3 = GetIsoField(0x3c,IsoInfo,tmpField,&nLength);
    if (iVar3 == 0) {
      InitTlvPrivate(&TlvInfo);
      AnalyseTlvPrivate(tmpField,nLength,&TlvInfo);
      iVar3 = GetTlvPrivate("025",&TlvInfo,PosCond,&nLength);
      if (iVar3 != 0) goto LAB_00425d4b;
      iVar3 = memcmp(PosCond,&DAT_004a908d,2);
      uVar4 = -(uint)(iVar3 != 0);
      sprintf(sLine,"ACCOUNT VERIFICATION1 ENH8.2 ...%d ",(ulong)uVar4);
      trace_event(sLine,5);
    }
    else {
LAB_00425d4b:
      uVar4 = 0xffffffff;
    }
    iVar3 = memcmp(sPrimResource,"000001",6);
    if (iVar3 == 0) {
      trace_event("Prm : STAND_IN AUTHORISATION PROCESSING",5);
      iVar3 = GetSecurityFlags(nIndiceCtx,sTlvBuffer,"OFF");
      if (((iVar3 == 0) && (iVar3 = PreControl(nIndiceCtx,sTlvBuffer), iVar3 == 0)) &&
         (iVar3 = CheckSecurity(nIndiceCtx,sTlvBuffer), iVar3 == 0)) {
        if (uVar4 != 0) {
          iVar3 = AmountMng(nIndiceCtx,sServGatewayFlag,sBillCalculFlag,sTlvBuffer);
          if (iVar3 != 0) {
LAB_00426572:
            trace_event("Retour AmountMng NOK ",5);
            goto LAB_00425e8c;
          }
          PrintTlvBuffer(sTlvBuffer);
          iVar3 = CheckLimits(nIndiceCtx,"OFF",sTlvBuffer,sAlternAmount);
          if (iVar3 != 0) goto LAB_00425e8c;
        }
        iVar3 = memcmp(sMyResource,&DAT_004a7e39,6);
        if (((iVar3 == 0) || (iVar3 = CheckFallBack(nIndiceCtx,"OFF",sTlvBuffer), iVar3 == 0)) &&
           (iVar3 = CheckAccAvailable(nIndiceCtx,sTlvBuffer), iVar3 == 0)) {
          pcVar6 = "000";
          goto LAB_00425e7d;
        }
      }
    }
    else {
      iVar3 = GetTlvBuffer("203",sTlvBuffer,sEventCode,&nLength);
      if (iVar3 == 0) {
        iVar3 = CheckResource(nIndiceCtx,sPrimResource,&nPid);
        if ((iVar3 != 0) ||
           ((iVar3 = kill(nPid,0), iVar3 != 0 && (iVar3 = memcmp(ResourceId,"050000",6), iVar3 != 0)
            ))) {
          iVar3 = memcmp(sEventCode,&DAT_004caed9,3);
          if (iVar3 == 0) {
            local_9c00 = -1;
            goto LAB_004261f5;
          }
          iVar3 = memcmp(sEventCode,&DAT_004caed9,3);
          if (iVar3 == 0) goto LAB_0042624a;
LAB_00425f36:
          trace_event("PrimResUp is NOK",4);
LAB_00425f49:
          PutTlvBuffer("025",sTlvBuffer,"1004",4);
          trace_event("Primary Ressource Down ",5);
LAB_00425f77:
          iVar3 = memcmp(sSecResource,"000000",6);
          if (iVar3 != 0) {
            iVar3 = memcmp(sSecResource,"000001",6);
            if (iVar3 == 0) {
              trace_event("Sec : STAND_IN AUTHORISATION PROCESSING",5);
              iVar3 = GetSecurityFlags(nIndiceCtx,sTlvBuffer,"OFF");
              if (((((iVar3 == 0) && (iVar3 = PreControl(nIndiceCtx,sTlvBuffer), iVar3 == 0)) &&
                   (iVar3 = CheckSecurity(nIndiceCtx,sTlvBuffer), iVar3 == 0)) &&
                  ((uVar4 == 0 ||
                   (iVar3 = CheckLimits(nIndiceCtx,"OFF",sTlvBuffer,sAlternAmount), iVar3 == 0))))
                 && (iVar3 = CheckAccAvailable(nIndiceCtx,sTlvBuffer), iVar3 == 0)) {
                PutTlvBuffer("203",sTlvBuffer,"000",3);
              }
              goto LAB_00426050;
            }
            iVar3 = CheckResource(nIndiceCtx,sSecResource,&nPid);
            if (iVar3 == 0) {
              PutTlvBuffer("203",sTlvBuffer,"000",3);
              iVar3 = AuthorRouting(nIndiceCtx,sTlvBuffer,sSecResource,nPid,IsoInfo);
              return iVar3;
            }
          }
          pcVar6 = "801";
          goto LAB_00425e7d;
        }
        iVar3 = memcmp(sEventCode,&DAT_004caed9,3);
        if (iVar3 == 0) {
          local_9c00 = 0;
LAB_004261f5:
          if ((uVar4 != 0) &&
             (iVar3 = AmountMng(nIndiceCtx,sServGatewayFlag,sBillCalculFlag,sTlvBuffer), iVar3 != 0)
             ) goto LAB_00426572;
          PrintTlvBuffer(sTlvBuffer);
          iVar3 = memcmp(sEventCode,&DAT_004caed9,3);
          if ((iVar3 != 0) && (local_9c00 == -1)) goto LAB_00425f36;
LAB_0042624a:
          iVar3 = CheckResource(nIndiceCtx,sPrimResource,&nPid);
          if ((iVar3 != 0) ||
             ((iVar3 = kill(nPid,0), iVar3 != 0 &&
              (iVar3 = memcmp(ResourceId,"050000",6), iVar3 != 0)))) goto LAB_00425f49;
          trace_event("Primary Ressource Up ",5);
          iVar3 = CardInSaf(nIndiceCtx,slCardNumber);
          if (iVar3 != 0) {
            PutTlvBuffer("203",sTlvBuffer,"000",3);
            iVar3 = AuthorRouting(nIndiceCtx,sTlvBuffer,sPrimResource,nPid,IsoInfo);
            return iVar3;
          }
          PutTlvBuffer("025",sTlvBuffer,"1005",4);
          if (debug_option == 1) {
            sprintf(sLine,"Card [%s] Found In Saf File ",slCardNumber);
            trace_event(sLine,5);
          }
          goto LAB_00425f77;
        }
        iVar3 = GetSecurityFlags(nIndiceCtx,sTlvBuffer,"ON");
        if (((iVar3 != 0) || (iVar3 = PreControl(nIndiceCtx,sTlvBuffer), iVar3 != 0)) ||
           (iVar3 = CheckSecurity(nIndiceCtx,sTlvBuffer), iVar3 != 0)) {
LAB_0042654c:
          PutTlvBuffer("025",sTlvBuffer,"1006",4);
          SafIndicator = 'S';
          goto LAB_00425e92;
        }
        if (uVar4 != 0) {
          iVar3 = AmountMng(nIndiceCtx,sServGatewayFlag,sBillCalculFlag,sTlvBuffer);
          if (iVar3 != 0) {
            PutTlvBuffer("025",sTlvBuffer,"1006",4);
            trace_event("Retour AmountMng NOK ",5);
            SafIndicator = 'S';
            goto LAB_00425e92;
          }
          PrintTlvBuffer(sTlvBuffer);
          iVar3 = CheckLimits(nIndiceCtx,"ON",sTlvBuffer,sAlternAmount);
          if (iVar3 != 0) goto LAB_0042654c;
        }
        iVar3 = memcmp(sMyResource,&DAT_004a7e39,6);
        if ((iVar3 == 0) || (iVar3 = CheckFallBack(nIndiceCtx,"OFF",sTlvBuffer), iVar3 == 0))
        goto LAB_0042624a;
        iVar3 = 4;
        pcVar6 = "1006";
        tlv_name = "025";
        goto LAB_00425e87;
      }
    }
  }
  else {
    pcVar6 = sEventCode;
    sprintf(sLine,"Err CheckResourceServices, EventCode= [%d] ",(ulong)uVar4);
    trace_event(sLine,5);
    sprintf(pcVar6,"%03d",(ulong)uVar4);
    PutTlvBuffer("025",sTlvBuffer,"1006",4);
LAB_00425e7d:
    iVar3 = 3;
    tlv_name = "203";
LAB_00425e87:
    PutTlvBuffer(tlv_name,sTlvBuffer,pcVar6,iVar3);
  }
LAB_00425e8c:
  SafIndicator = 'N';
LAB_00425e92:
  iVar3 = AuthorLocal(nIndiceCtx,sTlvBuffer,IsoInfo,sMyResource,sPrimResource,SafIndicator);
  return iVar3;
}



// WARNING: Unknown calling convention

int CheckPreauth(int nIndiceCtx,char *sTlvBuffer)

{
  size_t __n;
  ulong uVar1;
  uchar *puVar2;
  uint uVar3;
  bool bVar4;
  byte bVar5;
  uchar auStack_3004 [7480];
  int response_code;
  sqlca sqlca;
  char sLine [512];
  anon_struct_4100_2_43c7b5cf T_tlv_bal;
  
  bVar5 = 0;
  trace_event("Start Check_Preauth () ",5);
  puVar2 = T_tlv_bal.arr + 2;
  uVar3 = 0xfff;
  T_tlv_bal.arr[0] = '\0';
  T_tlv_bal.arr[1] = '\0';
  bVar4 = ((ulong)puVar2 & 4) != 0;
  if (bVar4) {
    T_tlv_bal.arr[2] = '\0';
    T_tlv_bal.arr[3] = '\0';
    T_tlv_bal.arr[4] = '\0';
    T_tlv_bal.arr[5] = '\0';
    uVar3 = 0xffb;
    puVar2 = T_tlv_bal.arr + 6;
  }
  for (uVar1 = (ulong)(uVar3 >> 3); uVar1 != 0; uVar1 = uVar1 - 1) {
    puVar2[0] = '\0';
    puVar2[1] = '\0';
    puVar2[2] = '\0';
    puVar2[3] = '\0';
    puVar2[4] = '\0';
    puVar2[5] = '\0';
    puVar2[6] = '\0';
    puVar2[7] = '\0';
    puVar2 = puVar2 + (ulong)bVar5 * -0x10 + 8;
  }
  if (!bVar4) {
    puVar2[0] = '\0';
    puVar2[1] = '\0';
    puVar2[2] = '\0';
    puVar2[3] = '\0';
    puVar2 = puVar2 + 4;
  }
  puVar2[0] = '\0';
  puVar2[1] = '\0';
  puVar2[2] = '\0';
  puVar2 = T_tlv_bal.arr;
  T_tlv_bal.len = 0;
  __n = strlen(sTlvBuffer);
  memcpy(puVar2,sTlvBuffer,__n);
  T_tlv_bal.len = (ushort)__n;
  sLine._40_8_ = &sqlca;
  sLine._56_8_ = &sqladt;
  sLine._64_8_ = &sqltds;
  sLine[0x16] = '\0';
  sLine[0x17] = '\x11';
  sLine[0x170] = '\0';
  sLine[0x171] = '\0';
  sLine[0x178] = '\0';
  sLine[0x179] = '\0';
  sLine._48_8_ = s_begin__response_code____PCRD_P7__004a8048;
  sLine[0x172] = '\0';
  sLine[0x173] = '\0';
  sLine[0x17a] = '\0';
  sLine[0x17b] = '\0';
  response_code = 0x38d;
  sLine._32_8_ = sqlcud0;
  sLine._176_8_ = &response_code;
  sLine[0] = '\f';
  sLine[1] = '\0';
  sLine[2] = '\0';
  sLine[3] = '\0';
  sLine[4] = '\0';
  sLine[5] = '\0';
  sLine[6] = '\0';
  sLine[7] = '\0';
  sLine[8] = '\x02';
  sLine[9] = '\0';
  sLine[10] = '\0';
  sLine[0xb] = '\0';
  sLine[0xc] = '\x01';
  sLine[0xd] = '\0';
  sLine[0xe] = '\0';
  sLine[0xf] = '\0';
  sLine._72_8_ = sLine + 0xb0;
  sLine[0x10] = '\x05';
  sLine[0x11] = '\0';
  sLine[0x12] = '\0';
  sLine[0x13] = '\0';
  sLine[0x18] = '\0';
  sLine[0x19] = '\0';
  sLine[0x1a] = '\0';
  sLine[0x1b] = '\0';
  sLine._80_8_ = sLine + 0xd0;
  sLine[0xd0] = '\x04';
  sLine[0xd1] = '\0';
  sLine[0xd2] = '\0';
  sLine[0xd3] = '\0';
  sLine[0xd4] = '\0';
  sLine[0xd5] = '\0';
  sLine[0xd6] = '\0';
  sLine[0xd7] = '\0';
  sLine[0xf0] = '\0';
  sLine[0xf1] = '\0';
  sLine[0xf2] = '\0';
  sLine[0xf3] = '\0';
  sLine[0x100] = '\0';
  sLine[0x101] = '\0';
  sLine[0x102] = '\0';
  sLine[0x103] = '\0';
  sLine[0x104] = '\0';
  sLine[0x105] = '\0';
  sLine[0x106] = '\0';
  sLine[0x107] = '\0';
  sLine._88_8_ = sLine + 0xf0;
  sLine[0x120] = '\0';
  sLine[0x121] = '\0';
  sLine[0x122] = '\0';
  sLine[0x123] = '\0';
  sLine[0x130] = '\0';
  sLine[0x131] = '\0';
  sLine[0x132] = '\0';
  sLine[0x133] = '\0';
  sLine[0x134] = '\0';
  sLine[0x135] = '\0';
  sLine[0x136] = '\0';
  sLine[0x137] = '\0';
  sLine[0xd8] = '\x03';
  sLine[0xd9] = '\x10';
  sLine[0xda] = '\0';
  sLine[0xdb] = '\0';
  sLine[0xdc] = '\0';
  sLine[0xdd] = '\0';
  sLine[0xde] = '\0';
  sLine[0xdf] = '\0';
  sLine._96_8_ = sLine + 0x100;
  sLine[0xf4] = '\0';
  sLine[0xf5] = '\0';
  sLine[0xf6] = '\0';
  sLine[0xf7] = '\0';
  sLine[0x108] = '\0';
  sLine[0x109] = '\0';
  sLine[0x10a] = '\0';
  sLine[0x10b] = '\0';
  sLine[0x10c] = '\0';
  sLine[0x10d] = '\0';
  sLine[0x10e] = '\0';
  sLine[0x10f] = '\0';
  sLine[0x124] = '\0';
  sLine[0x125] = '\0';
  sLine[0x126] = '\0';
  sLine[0x127] = '\0';
  sLine._104_8_ = sLine + 0x120;
  sLine[0x138] = '\0';
  sLine[0x139] = '\0';
  sLine[0x13a] = '\0';
  sLine[0x13b] = '\0';
  sLine[0x13c] = '\0';
  sLine[0x13d] = '\0';
  sLine[0x13e] = '\0';
  sLine[0x13f] = '\0';
  sLine._112_8_ = sLine + 0x130;
  sLine._120_8_ = sLine + 0x150;
  sLine._128_8_ = sLine + 0x170;
  sLine._136_8_ = sLine + 0x178;
  sLine._184_8_ = &T_tlv_bal;
  sqlcxt((long)nIndiceCtx * 0x10 + 0x713948,&sqlctx,sLine,&sqlfpn);
  if (-1 < sqlca.sqlcode) {
    tlvcpy(sTlvBuffer,(char *)puVar2,(uint)T_tlv_bal.len);
    sprintf(sLine,"End Check_Preauth (%d)",(ulong)(uint)response_code);
    trace_event(sLine,5);
    return response_code;
  }
  tlvcpy(sTlvBuffer,(char *)puVar2,(uint)T_tlv_bal.len);
  sprintf(sLine,"%.40s",sqlca.sqlerrm.sqlerrmc);
  trace_event(sLine,1);
  trace_event("End Check_Preauth (SYSTEM_MALFUNCTION)",5);
  return 0x38d;
}



// WARNING: Unknown calling convention

int Completion(int nIndiceCtx,char *refNbr,char *authCode,char *sTlvBuffer)

{
  size_t sVar1;
  ulong uVar2;
  uint uVar3;
  uchar *puVar4;
  bool bVar5;
  byte bVar6;
  uchar auStack_3014 [7448];
  int response_code;
  anon_struct_10_2_43c7b5cf T_auth_code;
  anon_struct_16_2_43c7b5cf T_ref_nbr;
  sqlca sqlca;
  char sLine [512];
  anon_struct_4100_2_43c7b5cf T_tlv_bal;
  
  bVar6 = 0;
  trace_event("Start Completion () ",5);
  puVar4 = T_tlv_bal.arr + 2;
  T_auth_code.arr[0] = '\0';
  T_auth_code.arr[1] = '\0';
  T_auth_code.arr[2] = '\0';
  T_auth_code.arr[3] = '\0';
  T_ref_nbr.len = 0;
  T_ref_nbr.arr[0] = '\0';
  T_ref_nbr.arr[1] = '\0';
  T_ref_nbr.arr[2] = '\0';
  T_ref_nbr.arr[3] = '\0';
  T_ref_nbr.arr[4] = '\0';
  T_ref_nbr.arr[5] = '\0';
  T_ref_nbr.arr[6] = '\0';
  T_ref_nbr.arr[7] = '\0';
  T_auth_code.arr[4] = '\0';
  T_auth_code.arr[5] = '\0';
  T_ref_nbr.arr[8] = '\0';
  T_ref_nbr.arr[9] = '\0';
  T_ref_nbr.arr[10] = '\0';
  T_ref_nbr.arr[0xb] = '\0';
  T_auth_code.len = 0;
  bVar5 = ((ulong)puVar4 & 4) != 0;
  T_ref_nbr.arr[0xc] = '\0';
  T_auth_code.arr[6] = '\0';
  uVar3 = 0xfff;
  T_tlv_bal.arr[0] = '\0';
  T_tlv_bal.arr[1] = '\0';
  if (bVar5) {
    T_tlv_bal.arr[2] = '\0';
    T_tlv_bal.arr[3] = '\0';
    T_tlv_bal.arr[4] = '\0';
    T_tlv_bal.arr[5] = '\0';
    uVar3 = 0xffb;
    puVar4 = T_tlv_bal.arr + 6;
  }
  for (uVar2 = (ulong)(uVar3 >> 3); uVar2 != 0; uVar2 = uVar2 - 1) {
    puVar4[0] = '\0';
    puVar4[1] = '\0';
    puVar4[2] = '\0';
    puVar4[3] = '\0';
    puVar4[4] = '\0';
    puVar4[5] = '\0';
    puVar4[6] = '\0';
    puVar4[7] = '\0';
    puVar4 = puVar4 + (ulong)bVar6 * -0x10 + 8;
  }
  if (!bVar5) {
    puVar4[0] = '\0';
    puVar4[1] = '\0';
    puVar4[2] = '\0';
    puVar4[3] = '\0';
    puVar4 = puVar4 + 4;
  }
  puVar4[0] = '\0';
  puVar4[1] = '\0';
  puVar4[2] = '\0';
  T_tlv_bal.len = 0;
  sVar1 = strlen(sTlvBuffer);
  memcpy(T_tlv_bal.arr,sTlvBuffer,sVar1);
  T_tlv_bal.len = (ushort)sVar1;
  sVar1 = strlen(refNbr);
  memcpy(T_ref_nbr.arr,refNbr,sVar1);
  T_ref_nbr.len = (ushort)sVar1;
  sVar1 = strlen(authCode);
  memcpy(T_auth_code.arr,authCode,sVar1);
  sLine._40_8_ = &sqlca;
  sLine._56_8_ = &sqladt;
  T_auth_code.len = (ushort)sVar1;
  sLine._64_8_ = &sqltds;
  sLine[0x16] = '\0';
  sLine[0x17] = '\x11';
  sLine[0x170] = '\0';
  sLine[0x171] = '\0';
  sLine._48_8_ = s_begin__response_code____PCRD_P7__004a80c8;
  sLine[0x178] = '\0';
  sLine[0x179] = '\0';
  sLine[0x172] = '\0';
  sLine[0x173] = '\0';
  sLine._32_8_ = sqlcud0;
  sLine._176_8_ = &response_code;
  sLine[0x17a] = '\0';
  sLine[0x17b] = '\0';
  response_code = 0x38d;
  sLine[0] = '\f';
  sLine[1] = '\0';
  sLine[2] = '\0';
  sLine[3] = '\0';
  sLine[4] = '\0';
  sLine[5] = '\0';
  sLine[6] = '\0';
  sLine[7] = '\0';
  sLine[8] = '\x04';
  sLine[9] = '\0';
  sLine[10] = '\0';
  sLine[0xb] = '\0';
  sLine[0xc] = '\x01';
  sLine[0xd] = '\0';
  sLine[0xe] = '\0';
  sLine[0xf] = '\0';
  sLine[0x10] = '\x1c';
  sLine[0x11] = '\0';
  sLine[0x12] = '\0';
  sLine[0x13] = '\0';
  sLine[0x18] = '\0';
  sLine[0x19] = '\0';
  sLine[0x1a] = '\0';
  sLine[0x1b] = '\0';
  sLine[0xd0] = '\x04';
  sLine[0xd1] = '\0';
  sLine[0xd2] = '\0';
  sLine[0xd3] = '\0';
  sLine[0xd4] = '\0';
  sLine[0xd5] = '\0';
  sLine[0xd6] = '\0';
  sLine[0xd7] = '\0';
  sLine[0xf0] = '\0';
  sLine[0xf1] = '\0';
  sLine[0xf2] = '\0';
  sLine[0xf3] = '\0';
  sLine[0x100] = '\0';
  sLine[0x101] = '\0';
  sLine[0x102] = '\0';
  sLine[0x103] = '\0';
  sLine[0x104] = '\0';
  sLine[0x105] = '\0';
  sLine[0x106] = '\0';
  sLine[0x107] = '\0';
  sLine[0x120] = '\0';
  sLine[0x121] = '\0';
  sLine[0x122] = '\0';
  sLine[0x123] = '\0';
  sLine[0x130] = '\0';
  sLine[0x131] = '\0';
  sLine[0x132] = '\0';
  sLine[0x133] = '\0';
  sLine[0x134] = '\0';
  sLine[0x135] = '\0';
  sLine[0x136] = '\0';
  sLine[0x137] = '\0';
  sLine[0xd8] = '\x0f';
  sLine[0xd9] = '\0';
  sLine[0xda] = '\0';
  sLine[0xdb] = '\0';
  sLine[0xdc] = '\0';
  sLine[0xdd] = '\0';
  sLine[0xde] = '\0';
  sLine[0xdf] = '\0';
  sLine[0xf4] = '\0';
  sLine[0xf5] = '\0';
  sLine[0xf6] = '\0';
  sLine[0xf7] = '\0';
  sLine[0x108] = '\0';
  sLine[0x109] = '\0';
  sLine[0x10a] = '\0';
  sLine[0x10b] = '\0';
  sLine[0x10c] = '\0';
  sLine[0x10d] = '\0';
  sLine[0x10e] = '\0';
  sLine[0x10f] = '\0';
  sLine[0x124] = '\0';
  sLine[0x125] = '\0';
  sLine[0x126] = '\0';
  sLine[0x127] = '\0';
  sLine[0x138] = '\0';
  sLine[0x139] = '\0';
  sLine[0x13a] = '\0';
  sLine[0x13b] = '\0';
  sLine[0x13c] = '\0';
  sLine[0x13d] = '\0';
  sLine[0x13e] = '\0';
  sLine[0x13f] = '\0';
  sLine[0xe0] = '\t';
  sLine[0xe1] = '\0';
  sLine[0xe2] = '\0';
  sLine[0xe3] = '\0';
  sLine[0xe4] = '\0';
  sLine[0xe5] = '\0';
  sLine[0xe6] = '\0';
  sLine[0xe7] = '\0';
  sLine[0xf8] = '\0';
  sLine[0xf9] = '\0';
  sLine[0xfa] = '\0';
  sLine[0xfb] = '\0';
  sLine[0x17e] = '\0';
  sLine[0x17f] = '\0';
  sLine[0x17c] = '\0';
  sLine[0x17d] = '\0';
  sLine[0x110] = '\0';
  sLine[0x111] = '\0';
  sLine[0x112] = '\0';
  sLine[0x113] = '\0';
  sLine[0x114] = '\0';
  sLine[0x115] = '\0';
  sLine[0x116] = '\0';
  sLine[0x117] = '\0';
  sLine[0x128] = '\0';
  sLine[0x129] = '\0';
  sLine[0x12a] = '\0';
  sLine[299] = '\0';
  sLine._72_8_ = sLine + 0xb0;
  sLine[0x140] = '\0';
  sLine[0x141] = '\0';
  sLine[0x142] = '\0';
  sLine[0x143] = '\0';
  sLine[0x144] = '\0';
  sLine[0x145] = '\0';
  sLine[0x146] = '\0';
  sLine[0x147] = '\0';
  sLine[0x174] = '\0';
  sLine[0x175] = '\0';
  sLine._80_8_ = sLine + 0xd0;
  sLine[0xe8] = '\x03';
  sLine[0xe9] = '\x10';
  sLine[0xea] = '\0';
  sLine[0xeb] = '\0';
  sLine[0xec] = '\0';
  sLine[0xed] = '\0';
  sLine[0xee] = '\0';
  sLine[0xef] = '\0';
  sLine[0xfc] = '\0';
  sLine[0xfd] = '\0';
  sLine[0xfe] = '\0';
  sLine[0xff] = '\0';
  sLine[0x118] = '\0';
  sLine[0x119] = '\0';
  sLine[0x11a] = '\0';
  sLine[0x11b] = '\0';
  sLine[0x11c] = '\0';
  sLine[0x11d] = '\0';
  sLine[0x11e] = '\0';
  sLine[0x11f] = '\0';
  sLine._88_8_ = sLine + 0xf0;
  sLine[300] = '\0';
  sLine[0x12d] = '\0';
  sLine[0x12e] = '\0';
  sLine[0x12f] = '\0';
  sLine[0x148] = '\0';
  sLine[0x149] = '\0';
  sLine[0x14a] = '\0';
  sLine[0x14b] = '\0';
  sLine[0x14c] = '\0';
  sLine[0x14d] = '\0';
  sLine[0x14e] = '\0';
  sLine[0x14f] = '\0';
  sLine[0x176] = '\0';
  sLine[0x177] = '\0';
  sLine._96_8_ = sLine + 0x100;
  sLine._104_8_ = sLine + 0x120;
  sLine._112_8_ = sLine + 0x130;
  sLine._120_8_ = sLine + 0x150;
  sLine._128_8_ = sLine + 0x170;
  sLine._136_8_ = sLine + 0x178;
  sLine._184_8_ = &T_ref_nbr;
  sLine._192_8_ = &T_auth_code;
  sLine._200_8_ = &T_tlv_bal;
  sqlcxt((long)nIndiceCtx * 0x10 + 0x713948,&sqlctx,sLine,&sqlfpn);
  if (sqlca.sqlcode < 0) {
    sprintf(sLine,"%.40s",sqlca.sqlerrm.sqlerrmc);
    trace_event(sLine,1);
    trace_event("End Completion(SYSTEM_MALFUNCTION)",5);
    response_code = 0x38d;
  }
  else {
    memcpy(refNbr,T_ref_nbr.arr,(ulong)T_ref_nbr.len);
    memcpy(authCode,T_auth_code.arr,(ulong)T_auth_code.len);
    sprintf(sLine,"--- Reference Nbr = [%s]",refNbr);
    trace_event(sLine,5);
    sprintf(sLine,"--- Authorization Code = [%s]",authCode);
    trace_event(sLine,5);
    sprintf(sLine,"End Completion (%d)",(ulong)(uint)response_code);
    trace_event(sLine,5);
  }
  return response_code;
}



// WARNING: Unknown calling convention

int InsertRequest(char sens,TSNodeData *data)

{
  TSNodeStruct *pTVar1;
  int iVar2;
  SNodeStruct *pSVar3;
  TSNodeStruct *pTVar4;
  TSNodeStruct *pTVar5;
  pthread_mutex_t *__mutex;
  pthread_mutex_t *__mutex_00;
  pthread_mutexattr_t mattr;
  time_t TimeSys;
  
  if (sens == 'B') {
    trace_event("Start InsertRequest (ACQ)",5);
    pTVar4 = &ListHeadAcq;
  }
  else {
    trace_event("Start InsertRequest (ISS)",5);
    pTVar4 = &ListHeadIss;
  }
  __mutex = (pthread_mutex_t *)&pTVar4->lock;
  pthread_mutex_lock(__mutex);
  if (pTVar4->Next != (TSNodeStruct *)0x0) {
    pTVar1 = pTVar4->Next;
    pTVar5 = pTVar4;
    __mutex_00 = __mutex;
    do {
      pTVar4 = pTVar1;
      __mutex = (pthread_mutex_t *)&pTVar4->lock;
      pthread_mutex_lock(__mutex);
      iVar2 = memcmp((pTVar5->data).szFstKey,data->szFstKey,0x38);
      if ((((iVar2 == 0) &&
           (iVar2 = memcmp((pTVar5->data).szSndKey,data->szSndKey,0x38), iVar2 == 0)) &&
          (iVar2 = memcmp((pTVar5->data).szTrdKey,data->szTrdKey,0x38), iVar2 == 0)) &&
         ((iVar2 = memcmp((pTVar5->data).szFrtKey,data->szFrtKey,0x38), iVar2 == 0 &&
          (iVar2 = memcmp((pTVar5->data).szFftKey,data->szFftKey,0x38), iVar2 == 0)))) {
        pthread_mutex_unlock(__mutex);
        pthread_mutex_unlock(__mutex_00);
        trace_event("End   InsertRequest (EEXIST)",5);
        return 0x11;
      }
      pthread_mutex_unlock(__mutex_00);
      pTVar1 = pTVar4->Next;
      pTVar5 = pTVar4;
      __mutex_00 = __mutex;
    } while (pTVar4->Next != (SNodeStruct *)0x0);
  }
  pSVar3 = (SNodeStruct *)malloc(0x2218);
  if (pSVar3 != (SNodeStruct *)0x0) {
    InitNodeData(&pSVar3->data);
    time(&TimeSys);
    pSVar3->tCreationTime = TimeSys;
    (pSVar3->data).tPurgeTime = data->tPurgeTime;
    *(undefined8 *)(pSVar3->data).szFstKey = *(undefined8 *)data->szFstKey;
    *(undefined8 *)((pSVar3->data).szFstKey + 8) = *(undefined8 *)(data->szFstKey + 8);
    *(undefined8 *)((pSVar3->data).szFstKey + 0x10) = *(undefined8 *)(data->szFstKey + 0x10);
    *(undefined8 *)((pSVar3->data).szFstKey + 0x18) = *(undefined8 *)(data->szFstKey + 0x18);
    *(undefined8 *)((pSVar3->data).szFstKey + 0x20) = *(undefined8 *)(data->szFstKey + 0x20);
    *(undefined8 *)((pSVar3->data).szFstKey + 0x28) = *(undefined8 *)(data->szFstKey + 0x28);
    *(undefined8 *)((pSVar3->data).szFstKey + 0x30) = *(undefined8 *)(data->szFstKey + 0x30);
    *(undefined8 *)(pSVar3->data).szSndKey = *(undefined8 *)data->szSndKey;
    *(undefined8 *)((pSVar3->data).szSndKey + 8) = *(undefined8 *)(data->szSndKey + 8);
    *(undefined8 *)((pSVar3->data).szSndKey + 0x10) = *(undefined8 *)(data->szSndKey + 0x10);
    *(undefined8 *)((pSVar3->data).szSndKey + 0x18) = *(undefined8 *)(data->szSndKey + 0x18);
    *(undefined8 *)((pSVar3->data).szSndKey + 0x20) = *(undefined8 *)(data->szSndKey + 0x20);
    *(undefined8 *)((pSVar3->data).szSndKey + 0x28) = *(undefined8 *)(data->szSndKey + 0x28);
    *(undefined8 *)((pSVar3->data).szSndKey + 0x30) = *(undefined8 *)(data->szSndKey + 0x30);
    *(undefined8 *)(pSVar3->data).szTrdKey = *(undefined8 *)data->szTrdKey;
    *(undefined8 *)((pSVar3->data).szTrdKey + 8) = *(undefined8 *)(data->szTrdKey + 8);
    *(undefined8 *)((pSVar3->data).szTrdKey + 0x10) = *(undefined8 *)(data->szTrdKey + 0x10);
    *(undefined8 *)((pSVar3->data).szTrdKey + 0x18) = *(undefined8 *)(data->szTrdKey + 0x18);
    *(undefined8 *)((pSVar3->data).szTrdKey + 0x20) = *(undefined8 *)(data->szTrdKey + 0x20);
    *(undefined8 *)((pSVar3->data).szTrdKey + 0x28) = *(undefined8 *)(data->szTrdKey + 0x28);
    *(undefined8 *)((pSVar3->data).szTrdKey + 0x30) = *(undefined8 *)(data->szTrdKey + 0x30);
    *(undefined8 *)(pSVar3->data).szFrtKey = *(undefined8 *)data->szFrtKey;
    *(undefined8 *)((pSVar3->data).szFrtKey + 8) = *(undefined8 *)(data->szFrtKey + 8);
    *(undefined8 *)((pSVar3->data).szFrtKey + 0x10) = *(undefined8 *)(data->szFrtKey + 0x10);
    *(undefined8 *)((pSVar3->data).szFrtKey + 0x18) = *(undefined8 *)(data->szFrtKey + 0x18);
    *(undefined8 *)((pSVar3->data).szFrtKey + 0x20) = *(undefined8 *)(data->szFrtKey + 0x20);
    *(undefined8 *)((pSVar3->data).szFrtKey + 0x28) = *(undefined8 *)(data->szFrtKey + 0x28);
    *(undefined8 *)((pSVar3->data).szFrtKey + 0x30) = *(undefined8 *)(data->szFrtKey + 0x30);
    *(undefined8 *)(pSVar3->data).szFftKey = *(undefined8 *)data->szFftKey;
    *(undefined8 *)((pSVar3->data).szFftKey + 8) = *(undefined8 *)(data->szFftKey + 8);
    *(undefined8 *)((pSVar3->data).szFftKey + 0x10) = *(undefined8 *)(data->szFftKey + 0x10);
    *(undefined8 *)((pSVar3->data).szFftKey + 0x18) = *(undefined8 *)(data->szFftKey + 0x18);
    *(undefined8 *)((pSVar3->data).szFftKey + 0x20) = *(undefined8 *)(data->szFftKey + 0x20);
    *(undefined8 *)((pSVar3->data).szFftKey + 0x28) = *(undefined8 *)(data->szFftKey + 0x28);
    *(undefined8 *)((pSVar3->data).szFftKey + 0x30) = *(undefined8 *)(data->szFftKey + 0x30);
    (pSVar3->data).nFstBufLen = data->nFstBufLen;
    memcpy((pSVar3->data).sFstBuf,data->sFstBuf,(long)data->nFstBufLen);
    (pSVar3->data).nSndBufLen = data->nSndBufLen;
    memcpy((pSVar3->data).sSndBuf,data->sSndBuf,(long)data->nSndBufLen);
    (pSVar3->data).nFstPrvtDataLen = data->nFstPrvtDataLen;
    if (data->nFstPrvtDataLen != 0) {
      memcpy((pSVar3->data).sFstPrvtData,data->sFstPrvtData,(long)data->nFstPrvtDataLen);
    }
    (pSVar3->data).nSndPrvtDataLen = data->nSndPrvtDataLen;
    if (data->nSndPrvtDataLen != 0) {
      memcpy((pSVar3->data).sSndPrvtData,data->sSndPrvtData,(long)data->nSndPrvtDataLen);
    }
    (pSVar3->data).nTrdPrvtDataLen = data->nTrdPrvtDataLen;
    if (data->nTrdPrvtDataLen != 0) {
      memcpy((pSVar3->data).sTrdPrvtData,data->sTrdPrvtData,(long)data->nTrdPrvtDataLen);
    }
    iVar2 = data->nLineIndexOracleCtx;
    pSVar3->Next = (SNodeStruct *)0x0;
    (pSVar3->data).nLineIndexOracleCtx = iVar2;
    pthread_mutexattr_init((pthread_mutexattr_t *)&mattr);
    pthread_mutex_init((pthread_mutex_t *)&pSVar3->lock,(pthread_mutexattr_t *)&mattr);
    pthread_mutexattr_destroy((pthread_mutexattr_t *)&mattr);
    pTVar4->Next = pSVar3;
    pthread_mutex_unlock(__mutex);
    trace_event("End   InsertRequest (OK)",5);
    return 0;
  }
  pthread_mutex_unlock(__mutex);
  trace_event("End   InsertRequest (ENOMEM)",5);
  return 0xc;
}



// WARNING: Unknown calling convention

int FetchRequest(char sens,TSNodeData *data)

{
  TSNodeStruct *pTVar1;
  int iVar2;
  TSNodeStruct *__ptr;
  pthread_mutex_t *__mutex;
  pthread_mutex_t *__mutex_00;
  TSNodeStruct *pTVar3;
  time_t TimeSys;
  
  if (sens == 'B') {
    trace_event("Start FetchRequest (ACQ)",5);
    pTVar3 = &ListHeadAcq;
  }
  else {
    trace_event("Start FetchRequest (ISS)",5);
    pTVar3 = &ListHeadIss;
  }
  __mutex = (pthread_mutex_t *)&pTVar3->lock;
  pthread_mutex_lock(__mutex);
  if (pTVar3->Next != (TSNodeStruct *)0x0) {
    pTVar1 = pTVar3->Next;
    __mutex_00 = __mutex;
    do {
      __ptr = pTVar1;
      __mutex = (pthread_mutex_t *)&__ptr->lock;
      pthread_mutex_lock(__mutex);
      iVar2 = memcmp((__ptr->data).szFstKey,data->szFstKey,0x38);
      if ((((iVar2 == 0) && (iVar2 = memcmp((__ptr->data).szSndKey,data->szSndKey,0x38), iVar2 == 0)
           ) && (iVar2 = memcmp((__ptr->data).szTrdKey,data->szTrdKey,0x38), iVar2 == 0)) &&
         ((iVar2 = memcmp((__ptr->data).szFrtKey,data->szFrtKey,0x38), iVar2 == 0 &&
          (iVar2 = memcmp((__ptr->data).szFftKey,data->szFftKey,0x38), iVar2 == 0)))) {
        pTVar3->Next = __ptr->Next;
        pthread_mutex_unlock(__mutex);
        pthread_mutex_destroy(__mutex);
        pthread_mutex_unlock(__mutex_00);
        data->nFstBufLen = (__ptr->data).nFstBufLen;
        memcpy(data->sFstBuf,(__ptr->data).sFstBuf,(long)(__ptr->data).nFstBufLen);
        data->nSndBufLen = (__ptr->data).nSndBufLen;
        memcpy(data->sSndBuf,(__ptr->data).sSndBuf,(long)(__ptr->data).nSndBufLen);
        data->tPurgeTime = (__ptr->data).tPurgeTime;
        iVar2 = (__ptr->data).nFstPrvtDataLen;
        data->nFstPrvtDataLen = iVar2;
        if (iVar2 != 0) {
          memcpy(data->sFstPrvtData,(__ptr->data).sFstPrvtData,(long)iVar2);
        }
        iVar2 = (__ptr->data).nSndPrvtDataLen;
        data->nSndPrvtDataLen = iVar2;
        if (iVar2 != 0) {
          memcpy(data->sSndPrvtData,(__ptr->data).sSndPrvtData,(long)iVar2);
        }
        iVar2 = (__ptr->data).nTrdPrvtDataLen;
        data->nTrdPrvtDataLen = iVar2;
        if (iVar2 != 0) {
          memcpy(data->sTrdPrvtData,(__ptr->data).sTrdPrvtData,(long)iVar2);
        }
        data->nLineIndexOracleCtx = (__ptr->data).nLineIndexOracleCtx;
        free(__ptr);
        time(&TimeSys);
        if (TimeSys + -1000000000 <= data->tPurgeTime) {
          trace_event("End   FetchRequest (OK)",5);
          return 0;
        }
        trace_event("End   FetchRequest (ELATE)",5);
        return -0xc;
      }
      pthread_mutex_unlock(__mutex_00);
      pTVar1 = __ptr->Next;
      __mutex_00 = __mutex;
      pTVar3 = __ptr;
    } while (__ptr->Next != (SNodeStruct *)0x0);
  }
  pthread_mutex_unlock(__mutex);
  trace_event("End   FetchRequest (ENOEXIST)",5);
  return -0xb;
}



// WARNING: Unknown calling convention

int FreeTimeOutRequest(char sens)

{
  pthread_mutex_t *__mutex;
  pthread_mutex_t *__mutex_00;
  TSNodeStruct *pTVar1;
  SNodeStruct *__ptr;
  time_t TimeSys;
  char sLine [512];
  TSTimeExchange sTimeMsg;
  
  if (sens == 'B') {
    pTVar1 = &ListHeadAcq;
  }
  else {
    pTVar1 = &ListHeadIss;
  }
  __mutex_00 = (pthread_mutex_t *)&pTVar1->lock;
  time(&TimeSys);
  pthread_mutex_lock(__mutex_00);
  __ptr = pTVar1->Next;
  if (__ptr != (SNodeStruct *)0x0) {
    do {
      __mutex = (pthread_mutex_t *)&__ptr->lock;
      pthread_mutex_lock(__mutex);
      if ((__ptr->data).tPurgeTime < TimeSys + -1000000000) {
        sprintf(sLine,"PurgeTime : %ld, SysTime : %ld");
        trace_event(sLine,4);
        pTVar1->Next = __ptr->Next;
        pthread_mutex_unlock(__mutex);
        pthread_mutex_destroy(__mutex);
        sTimeMsg.sens = sens;
        memcpy(&sTimeMsg.sData,&__ptr->data,0x21e0);
        PTimeWaitEntry();
        PTimePutMsg(&sTimeMsg);
        PTimeConsoInfo();
        free(__ptr);
        __ptr = pTVar1->Next;
        if (__ptr == (SNodeStruct *)0x0) break;
        __mutex = (pthread_mutex_t *)&__ptr->lock;
      }
      pTVar1 = __ptr;
      pthread_mutex_unlock(__mutex_00);
      __ptr = pTVar1->Next;
      __mutex_00 = __mutex;
    } while (__ptr != (SNodeStruct *)0x0);
  }
  pthread_mutex_unlock(__mutex_00);
  return 0;
}



// WARNING: Type propagation algorithm not settling
// WARNING: Unknown calling convention

void InitNodeData(TSNodeData *data)

{
  ulong uVar1;
  int iVar2;
  uint uVar3;
  char *pcVar5;
  char *pcVar6;
  bool bVar7;
  ulong uVar4;
  
  data->tPurgeTime = 0;
  data->nFstBufLen = 0;
  data->nSndBufLen = 0;
  data->nFstPrvtDataLen = 0;
  pcVar5 = data->szFstKey;
  data->nSndPrvtDataLen = 0;
  data->nTrdPrvtDataLen = 0;
  uVar4 = 0x38;
  iVar2 = 0x38;
  data->nLineIndexOracleCtx = -1;
  bVar7 = ((ulong)pcVar5 & 1) != 0;
  if (bVar7) {
    pcVar5 = data->szFstKey + 1;
    data->szFstKey[0] = '\0';
    uVar4 = 0x37;
    iVar2 = 0x37;
  }
  if (((ulong)pcVar5 & 2) == 0) {
    uVar3 = (uint)uVar4;
  }
  else {
    uVar3 = iVar2 - 2;
    uVar4 = (ulong)uVar3;
    *(undefined2 *)pcVar5 = 0;
    pcVar5 = (char *)((long)pcVar5 + 2);
  }
  if (((ulong)pcVar5 & 4) != 0) {
    pcVar5[0] = '\0';
    pcVar5[1] = '\0';
    pcVar5[2] = '\0';
    pcVar5[3] = '\0';
    uVar4 = (ulong)(uVar3 - 4);
    pcVar5 = pcVar5 + 4;
  }
  for (uVar1 = uVar4 >> 3; uVar1 != 0; uVar1 = uVar1 - 1) {
    pcVar5[0] = '\0';
    pcVar5[1] = '\0';
    pcVar5[2] = '\0';
    pcVar5[3] = '\0';
    pcVar5[4] = '\0';
    pcVar5[5] = '\0';
    pcVar5[6] = '\0';
    pcVar5[7] = '\0';
    pcVar5 = pcVar5 + 8;
  }
  if ((uVar4 & 4) != 0) {
    pcVar5[0] = '\0';
    pcVar5[1] = '\0';
    pcVar5[2] = '\0';
    pcVar5[3] = '\0';
    pcVar5 = pcVar5 + 4;
  }
  pcVar6 = pcVar5;
  if ((uVar4 & 2) != 0) {
    pcVar6 = pcVar5 + 2;
    pcVar5[0] = '\0';
    pcVar5[1] = '\0';
  }
  if (bVar7) {
    *pcVar6 = '\0';
  }
  pcVar5 = data->szSndKey;
  uVar4 = 0x38;
  iVar2 = 0x38;
  bVar7 = ((ulong)pcVar5 & 1) != 0;
  if (bVar7) {
    pcVar5 = data->szSndKey + 1;
    data->szSndKey[0] = '\0';
    uVar4 = 0x37;
    iVar2 = 0x37;
  }
  if (((ulong)pcVar5 & 2) == 0) {
    uVar3 = (uint)uVar4;
    pcVar6 = pcVar5;
  }
  else {
    pcVar6 = (char *)((long)pcVar5 + 2);
    uVar3 = iVar2 - 2;
    uVar4 = (ulong)uVar3;
    *(undefined2 *)pcVar5 = 0;
  }
  if (((ulong)pcVar6 & 4) != 0) {
    pcVar6[0] = '\0';
    pcVar6[1] = '\0';
    pcVar6[2] = '\0';
    pcVar6[3] = '\0';
    uVar4 = (ulong)(uVar3 - 4);
    pcVar6 = pcVar6 + 4;
  }
  for (uVar1 = uVar4 >> 3; uVar1 != 0; uVar1 = uVar1 - 1) {
    pcVar6[0] = '\0';
    pcVar6[1] = '\0';
    pcVar6[2] = '\0';
    pcVar6[3] = '\0';
    pcVar6[4] = '\0';
    pcVar6[5] = '\0';
    pcVar6[6] = '\0';
    pcVar6[7] = '\0';
    pcVar6 = pcVar6 + 8;
  }
  if ((uVar4 & 4) != 0) {
    pcVar6[0] = '\0';
    pcVar6[1] = '\0';
    pcVar6[2] = '\0';
    pcVar6[3] = '\0';
    pcVar6 = pcVar6 + 4;
  }
  pcVar5 = pcVar6;
  if ((uVar4 & 2) != 0) {
    pcVar5 = pcVar6 + 2;
    pcVar6[0] = '\0';
    pcVar6[1] = '\0';
  }
  if (bVar7) {
    *pcVar5 = '\0';
  }
  pcVar5 = data->szTrdKey;
  uVar4 = 0x38;
  iVar2 = 0x38;
  bVar7 = ((ulong)pcVar5 & 1) != 0;
  if (bVar7) {
    pcVar5 = data->szTrdKey + 1;
    data->szTrdKey[0] = '\0';
    uVar4 = 0x37;
    iVar2 = 0x37;
  }
  if (((ulong)pcVar5 & 2) == 0) {
    uVar3 = (uint)uVar4;
    pcVar6 = pcVar5;
  }
  else {
    pcVar6 = (char *)((long)pcVar5 + 2);
    uVar3 = iVar2 - 2;
    uVar4 = (ulong)uVar3;
    *(undefined2 *)pcVar5 = 0;
  }
  if (((ulong)pcVar6 & 4) != 0) {
    pcVar6[0] = '\0';
    pcVar6[1] = '\0';
    pcVar6[2] = '\0';
    pcVar6[3] = '\0';
    uVar4 = (ulong)(uVar3 - 4);
    pcVar6 = pcVar6 + 4;
  }
  for (uVar1 = uVar4 >> 3; uVar1 != 0; uVar1 = uVar1 - 1) {
    pcVar6[0] = '\0';
    pcVar6[1] = '\0';
    pcVar6[2] = '\0';
    pcVar6[3] = '\0';
    pcVar6[4] = '\0';
    pcVar6[5] = '\0';
    pcVar6[6] = '\0';
    pcVar6[7] = '\0';
    pcVar6 = pcVar6 + 8;
  }
  if ((uVar4 & 4) != 0) {
    pcVar6[0] = '\0';
    pcVar6[1] = '\0';
    pcVar6[2] = '\0';
    pcVar6[3] = '\0';
    pcVar6 = pcVar6 + 4;
  }
  pcVar5 = pcVar6;
  if ((uVar4 & 2) != 0) {
    pcVar5 = pcVar6 + 2;
    pcVar6[0] = '\0';
    pcVar6[1] = '\0';
  }
  if (bVar7) {
    *pcVar5 = '\0';
  }
  pcVar5 = data->szFrtKey;
  uVar4 = 0x38;
  iVar2 = 0x38;
  bVar7 = ((ulong)pcVar5 & 1) != 0;
  if (bVar7) {
    pcVar5 = data->szFrtKey + 1;
    data->szFrtKey[0] = '\0';
    uVar4 = 0x37;
    iVar2 = 0x37;
  }
  if (((ulong)pcVar5 & 2) == 0) {
    uVar3 = (uint)uVar4;
    pcVar6 = pcVar5;
  }
  else {
    pcVar6 = (char *)((long)pcVar5 + 2);
    uVar3 = iVar2 - 2;
    uVar4 = (ulong)uVar3;
    *(undefined2 *)pcVar5 = 0;
  }
  if (((ulong)pcVar6 & 4) != 0) {
    pcVar6[0] = '\0';
    pcVar6[1] = '\0';
    pcVar6[2] = '\0';
    pcVar6[3] = '\0';
    uVar4 = (ulong)(uVar3 - 4);
    pcVar6 = pcVar6 + 4;
  }
  for (uVar1 = uVar4 >> 3; uVar1 != 0; uVar1 = uVar1 - 1) {
    pcVar6[0] = '\0';
    pcVar6[1] = '\0';
    pcVar6[2] = '\0';
    pcVar6[3] = '\0';
    pcVar6[4] = '\0';
    pcVar6[5] = '\0';
    pcVar6[6] = '\0';
    pcVar6[7] = '\0';
    pcVar6 = pcVar6 + 8;
  }
  if ((uVar4 & 4) != 0) {
    pcVar6[0] = '\0';
    pcVar6[1] = '\0';
    pcVar6[2] = '\0';
    pcVar6[3] = '\0';
    pcVar6 = pcVar6 + 4;
  }
  pcVar5 = pcVar6;
  if ((uVar4 & 2) != 0) {
    pcVar5 = pcVar6 + 2;
    pcVar6[0] = '\0';
    pcVar6[1] = '\0';
  }
  if (bVar7) {
    *pcVar5 = '\0';
  }
  pcVar5 = data->szFftKey;
  uVar4 = 0x38;
  iVar2 = 0x38;
  bVar7 = ((ulong)pcVar5 & 1) != 0;
  if (bVar7) {
    pcVar5 = data->szFftKey + 1;
    data->szFftKey[0] = '\0';
    uVar4 = 0x37;
    iVar2 = 0x37;
  }
  if (((ulong)pcVar5 & 2) == 0) {
    uVar3 = (uint)uVar4;
    pcVar6 = pcVar5;
  }
  else {
    pcVar6 = (char *)((long)pcVar5 + 2);
    uVar3 = iVar2 - 2;
    uVar4 = (ulong)uVar3;
    *(undefined2 *)pcVar5 = 0;
  }
  if (((ulong)pcVar6 & 4) != 0) {
    pcVar6[0] = '\0';
    pcVar6[1] = '\0';
    pcVar6[2] = '\0';
    pcVar6[3] = '\0';
    uVar4 = (ulong)(uVar3 - 4);
    pcVar6 = pcVar6 + 4;
  }
  for (uVar1 = uVar4 >> 3; uVar1 != 0; uVar1 = uVar1 - 1) {
    pcVar6[0] = '\0';
    pcVar6[1] = '\0';
    pcVar6[2] = '\0';
    pcVar6[3] = '\0';
    pcVar6[4] = '\0';
    pcVar6[5] = '\0';
    pcVar6[6] = '\0';
    pcVar6[7] = '\0';
    pcVar6 = pcVar6 + 8;
  }
  if ((uVar4 & 4) != 0) {
    pcVar6[0] = '\0';
    pcVar6[1] = '\0';
    pcVar6[2] = '\0';
    pcVar6[3] = '\0';
    pcVar6 = pcVar6 + 4;
  }
  pcVar5 = pcVar6;
  if ((uVar4 & 2) != 0) {
    pcVar5 = pcVar6 + 2;
    pcVar6[0] = '\0';
    pcVar6[1] = '\0';
  }
  if (bVar7) {
    *pcVar5 = '\0';
  }
  pcVar5 = data->sFstBuf;
  uVar4 = 0x1000;
  iVar2 = 0x1000;
  bVar7 = ((ulong)pcVar5 & 1) != 0;
  if (bVar7) {
    pcVar5 = data->sFstBuf + 1;
    data->sFstBuf[0] = '\0';
    uVar4 = 0xfff;
    iVar2 = 0xfff;
  }
  if (((ulong)pcVar5 & 2) == 0) {
    uVar3 = (uint)uVar4;
    pcVar6 = pcVar5;
  }
  else {
    pcVar6 = (char *)((long)pcVar5 + 2);
    uVar3 = iVar2 - 2;
    uVar4 = (ulong)uVar3;
    *(undefined2 *)pcVar5 = 0;
  }
  if (((ulong)pcVar6 & 4) != 0) {
    pcVar6[0] = '\0';
    pcVar6[1] = '\0';
    pcVar6[2] = '\0';
    pcVar6[3] = '\0';
    uVar4 = (ulong)(uVar3 - 4);
    pcVar6 = pcVar6 + 4;
  }
  for (uVar1 = uVar4 >> 3; uVar1 != 0; uVar1 = uVar1 - 1) {
    pcVar6[0] = '\0';
    pcVar6[1] = '\0';
    pcVar6[2] = '\0';
    pcVar6[3] = '\0';
    pcVar6[4] = '\0';
    pcVar6[5] = '\0';
    pcVar6[6] = '\0';
    pcVar6[7] = '\0';
    pcVar6 = pcVar6 + 8;
  }
  if ((uVar4 & 4) != 0) {
    pcVar6[0] = '\0';
    pcVar6[1] = '\0';
    pcVar6[2] = '\0';
    pcVar6[3] = '\0';
    pcVar6 = pcVar6 + 4;
  }
  pcVar5 = pcVar6;
  if ((uVar4 & 2) != 0) {
    pcVar5 = pcVar6 + 2;
    pcVar6[0] = '\0';
    pcVar6[1] = '\0';
  }
  if (bVar7) {
    *pcVar5 = '\0';
  }
  pcVar5 = data->sSndBuf;
  uVar4 = 0x1000;
  iVar2 = 0x1000;
  bVar7 = ((ulong)pcVar5 & 1) != 0;
  if (bVar7) {
    pcVar5 = data->sSndBuf + 1;
    data->sSndBuf[0] = '\0';
    uVar4 = 0xfff;
    iVar2 = 0xfff;
  }
  if (((ulong)pcVar5 & 2) == 0) {
    uVar3 = (uint)uVar4;
    pcVar6 = pcVar5;
  }
  else {
    pcVar6 = (char *)((long)pcVar5 + 2);
    uVar3 = iVar2 - 2;
    uVar4 = (ulong)uVar3;
    *(undefined2 *)pcVar5 = 0;
  }
  if (((ulong)pcVar6 & 4) != 0) {
    pcVar6[0] = '\0';
    pcVar6[1] = '\0';
    pcVar6[2] = '\0';
    pcVar6[3] = '\0';
    uVar4 = (ulong)(uVar3 - 4);
    pcVar6 = pcVar6 + 4;
  }
  for (uVar1 = uVar4 >> 3; uVar1 != 0; uVar1 = uVar1 - 1) {
    pcVar6[0] = '\0';
    pcVar6[1] = '\0';
    pcVar6[2] = '\0';
    pcVar6[3] = '\0';
    pcVar6[4] = '\0';
    pcVar6[5] = '\0';
    pcVar6[6] = '\0';
    pcVar6[7] = '\0';
    pcVar6 = pcVar6 + 8;
  }
  if ((uVar4 & 4) != 0) {
    pcVar6[0] = '\0';
    pcVar6[1] = '\0';
    pcVar6[2] = '\0';
    pcVar6[3] = '\0';
    pcVar6 = pcVar6 + 4;
  }
  pcVar5 = pcVar6;
  if ((uVar4 & 2) != 0) {
    pcVar5 = pcVar6 + 2;
    pcVar6[0] = '\0';
    pcVar6[1] = '\0';
  }
  if (bVar7) {
    *pcVar5 = '\0';
  }
  pcVar5 = data->sFstPrvtData;
  uVar4 = 0x38;
  iVar2 = 0x38;
  bVar7 = ((ulong)pcVar5 & 1) != 0;
  if (bVar7) {
    pcVar5 = data->sFstPrvtData + 1;
    data->sFstPrvtData[0] = '\0';
    uVar4 = 0x37;
    iVar2 = 0x37;
  }
  if (((ulong)pcVar5 & 2) == 0) {
    uVar3 = (uint)uVar4;
    pcVar6 = pcVar5;
  }
  else {
    pcVar6 = pcVar5 + 2;
    uVar3 = iVar2 - 2;
    uVar4 = (ulong)uVar3;
    pcVar5[0] = '\0';
    pcVar5[1] = '\0';
  }
  if (((ulong)pcVar6 & 4) != 0) {
    pcVar6[0] = '\0';
    pcVar6[1] = '\0';
    pcVar6[2] = '\0';
    pcVar6[3] = '\0';
    uVar4 = (ulong)(uVar3 - 4);
    pcVar6 = pcVar6 + 4;
  }
  for (uVar1 = uVar4 >> 3; uVar1 != 0; uVar1 = uVar1 - 1) {
    pcVar6[0] = '\0';
    pcVar6[1] = '\0';
    pcVar6[2] = '\0';
    pcVar6[3] = '\0';
    pcVar6[4] = '\0';
    pcVar6[5] = '\0';
    pcVar6[6] = '\0';
    pcVar6[7] = '\0';
    pcVar6 = pcVar6 + 8;
  }
  if ((uVar4 & 4) != 0) {
    pcVar6[0] = '\0';
    pcVar6[1] = '\0';
    pcVar6[2] = '\0';
    pcVar6[3] = '\0';
    pcVar6 = pcVar6 + 4;
  }
  pcVar5 = pcVar6;
  if ((uVar4 & 2) != 0) {
    pcVar5 = pcVar6 + 2;
    pcVar6[0] = '\0';
    pcVar6[1] = '\0';
  }
  if (bVar7) {
    *pcVar5 = '\0';
  }
  pcVar5 = data->sSndPrvtData;
  uVar4 = 0x38;
  iVar2 = 0x38;
  bVar7 = ((ulong)pcVar5 & 1) != 0;
  if (bVar7) {
    pcVar5 = data->sSndPrvtData + 1;
    data->sSndPrvtData[0] = '\0';
    uVar4 = 0x37;
    iVar2 = 0x37;
  }
  if (((ulong)pcVar5 & 2) == 0) {
    uVar3 = (uint)uVar4;
    pcVar6 = pcVar5;
  }
  else {
    pcVar6 = pcVar5 + 2;
    uVar3 = iVar2 - 2;
    uVar4 = (ulong)uVar3;
    pcVar5[0] = '\0';
    pcVar5[1] = '\0';
  }
  if (((ulong)pcVar6 & 4) != 0) {
    pcVar6[0] = '\0';
    pcVar6[1] = '\0';
    pcVar6[2] = '\0';
    pcVar6[3] = '\0';
    uVar4 = (ulong)(uVar3 - 4);
    pcVar6 = pcVar6 + 4;
  }
  for (uVar1 = uVar4 >> 3; uVar1 != 0; uVar1 = uVar1 - 1) {
    pcVar6[0] = '\0';
    pcVar6[1] = '\0';
    pcVar6[2] = '\0';
    pcVar6[3] = '\0';
    pcVar6[4] = '\0';
    pcVar6[5] = '\0';
    pcVar6[6] = '\0';
    pcVar6[7] = '\0';
    pcVar6 = pcVar6 + 8;
  }
  if ((uVar4 & 4) != 0) {
    pcVar6[0] = '\0';
    pcVar6[1] = '\0';
    pcVar6[2] = '\0';
    pcVar6[3] = '\0';
    pcVar6 = pcVar6 + 4;
  }
  pcVar5 = pcVar6;
  if ((uVar4 & 2) != 0) {
    pcVar5 = pcVar6 + 2;
    pcVar6[0] = '\0';
    pcVar6[1] = '\0';
  }
  if (bVar7) {
    *pcVar5 = '\0';
  }
  pcVar5 = data->sTrdPrvtData;
  uVar4 = 0x38;
  iVar2 = 0x38;
  bVar7 = ((ulong)pcVar5 & 1) != 0;
  if (bVar7) {
    pcVar5 = data->sTrdPrvtData + 1;
    data->sTrdPrvtData[0] = '\0';
    uVar4 = 0x37;
    iVar2 = 0x37;
  }
  if (((ulong)pcVar5 & 2) == 0) {
    uVar3 = (uint)uVar4;
    pcVar6 = pcVar5;
  }
  else {
    pcVar6 = pcVar5 + 2;
    uVar3 = iVar2 - 2;
    uVar4 = (ulong)uVar3;
    pcVar5[0] = '\0';
    pcVar5[1] = '\0';
  }
  if (((ulong)pcVar6 & 4) != 0) {
    pcVar6[0] = '\0';
    pcVar6[1] = '\0';
    pcVar6[2] = '\0';
    pcVar6[3] = '\0';
    uVar4 = (ulong)(uVar3 - 4);
    pcVar6 = pcVar6 + 4;
  }
  for (uVar1 = uVar4 >> 3; uVar1 != 0; uVar1 = uVar1 - 1) {
    pcVar6[0] = '\0';
    pcVar6[1] = '\0';
    pcVar6[2] = '\0';
    pcVar6[3] = '\0';
    pcVar6[4] = '\0';
    pcVar6[5] = '\0';
    pcVar6[6] = '\0';
    pcVar6[7] = '\0';
    pcVar6 = pcVar6 + 8;
  }
  if ((uVar4 & 4) != 0) {
    pcVar6[0] = '\0';
    pcVar6[1] = '\0';
    pcVar6[2] = '\0';
    pcVar6[3] = '\0';
    pcVar6 = pcVar6 + 4;
  }
  pcVar5 = pcVar6;
  if ((uVar4 & 2) != 0) {
    pcVar5 = pcVar6 + 2;
    pcVar6[0] = '\0';
    pcVar6[1] = '\0';
  }
  if (bVar7) {
    *pcVar5 = '\0';
  }
  return;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

void InitList(void)

{
  pthread_mutexattr_t mattr;
  
  ListHeadAcq.Next = (SNodeStruct *)0x0;
  ListHeadIss.Next = (SNodeStruct *)0x0;
  pthread_mutexattr_init((pthread_mutexattr_t *)&mattr);
  pthread_mutex_init((pthread_mutex_t *)&ListHeadAcq.lock,(pthread_mutexattr_t *)&mattr);
  pthread_mutex_init((pthread_mutex_t *)&ListHeadIss.lock,(pthread_mutexattr_t *)&mattr);
  pthread_mutexattr_destroy((pthread_mutexattr_t *)&mattr);
  InitNodeData(&ListHeadAcq.data);
  InitNodeData(&ListHeadIss.data);
  return;
}



// WARNING: Unknown calling convention

void * thread_wait_TIME(void *arg)

{
  pthread_mutex_t *__mutex;
  int iVar1;
  int iVar2;
  int iVar3;
  uint uVar4;
  ulong uVar5;
  pthread_t pVar6;
  uint *puVar7;
  timeval tv;
  timespec ts;
  sigset_t set;
  char sLine [512];
  
  uVar5 = syscall(0xba);
  pVar6 = pthread_self();
  pthread_detach(pVar6);
                    // WARNING: Load size is inaccurate
  iVar1 = *arg;
  iVar2 = *(int *)((long)arg + 4);
  free(arg);
  sprintf(sLine,"Setting TimeOut on Working Thread [%d] with TimeOut Thread [%d]",
          (ulong)(uint)tab_alrm[iVar1].tid_spec,uVar5 & 0xffffffff);
  trace_event(sLine,5);
  sigemptyset((sigset_t *)&set);
  sigaddset((sigset_t *)&set,0xd);
  sigaddset((sigset_t *)&set,0x11);
  sigaddset((sigset_t *)&set,0xc);
  pthread_sigmask(0,(sigset_t *)&set,(__sigset_t *)0x0);
  iVar3 = gettimeofday((timeval *)&tv,(__timezone_ptr_t)0x0);
  if (-1 < iVar3) {
    ts.tv_sec = iVar2 + tv.tv_sec;
    ts.tv_nsec = tv.tv_usec * 1000;
    __mutex = &tab_alrm[iVar1].lock;
    pthread_mutex_lock((pthread_mutex_t *)__mutex);
    if (tab_alrm[iVar1].done == -1) {
      uVar4 = pthread_cond_timedwait
                        ((pthread_cond_t *)&tab_alrm[iVar1].cond,(pthread_mutex_t *)__mutex,
                         (timespec *)&ts);
      if ((int)uVar4 < 0) {
        puVar7 = (uint *)__errno_location();
        sprintf(sLine,">> thread_wait_TIME() 000. ret=[%d]. errno=[%d]",(ulong)uVar4,(ulong)*puVar7)
        ;
        trace_event(sLine,5);
        fprintf(stderr,"Error Waiting Time Out : %d\n",(ulong)*puVar7);
      }
      else if (uVar4 == 0x6e) {
        pVar6 = tab_alrm[iVar1].tid;
        tab_alrm[iVar1].flag = 0;
        pthread_kill(pVar6,0xe);
      }
    }
    else {
      trace_event(">> thread_wait_TIME() 005 <TimeOut Thread Already in Use>",0);
      tab_alrm[iVar1].tid = 0xffffffffffffffff;
      tab_alrm[iVar1].tid_spec = -1;
    }
    pthread_mutex_unlock((pthread_mutex_t *)__mutex);
                    // WARNING: Subroutine does not return
    pthread_exit((void *)0x0);
  }
  puVar7 = (uint *)__errno_location();
  fprintf(stderr,"gettimeofday Error : %d\n",(ulong)*puVar7);
                    // WARNING: Subroutine does not return
  pthread_exit((void *)0x0);
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

void InitTabAlarm(void)

{
  pthread_cond_t *__cond;
  pthread_mutex_t *__mutex;
  pthread_mutexattr_t mattr;
  pthread_condattr_t cattr;
  
  pthread_mutexattr_init((pthread_mutexattr_t *)&mattr);
  pthread_condattr_init((pthread_condattr_t *)&cattr);
  __mutex = (pthread_mutex_t *)&tab_alrm[0].lock;
  do {
    *(undefined8 *)((long)__mutex + -0x40) = 0xffffffffffffffff;
    *(undefined4 *)((long)__mutex + -0x38) = 0xffffffff;
    pthread_mutex_init(__mutex,(pthread_mutexattr_t *)&mattr);
    __cond = (pthread_cond_t *)((long)__mutex + -0x30);
    __mutex = (pthread_mutex_t *)((long)__mutex + 0x70);
    pthread_cond_init(__cond,(pthread_condattr_t *)&cattr);
  } while (__mutex != (pthread_mutex_t *)(tab_BalDemande[0].sBody + 0x28));
  pthread_mutexattr_destroy((pthread_mutexattr_t *)&mattr);
  pthread_condattr_destroy((pthread_condattr_t *)&cattr);
  return;
}



// WARNING: Unknown calling convention

void THR_Alarm(int delta,int *flag)

{
  int iVar1;
  long lVar2;
  pthread_t pVar3;
  int *piVar4;
  uint *puVar5;
  int iVar6;
  pthread_t tid_time;
  pthread_attr_t pattr;
  char sLine [512];
  
  if (-1 < delta) {
    if (delta == 0) {
      iVar6 = 0;
      piVar4 = &tab_alrm[0].tid_spec;
      do {
        iVar1 = *piVar4;
        lVar2 = syscall(0xba);
        if (iVar1 == (int)lVar2) {
          pthread_mutex_lock((pthread_mutex_t *)&flag_mutex);
          pthread_mutex_lock((pthread_mutex_t *)&tab_alrm[iVar6].lock);
          pthread_cond_signal((pthread_cond_t *)&tab_alrm[iVar6].cond);
          iVar1 = tab_alrm[iVar6].flag;
          tab_alrm[iVar6].done = 0;
          tab_alrm[iVar6].tid = 0xffffffffffffffff;
          tab_alrm[iVar6].tid_spec = -1;
          *flag = iVar1;
          pthread_mutex_unlock((pthread_mutex_t *)&tab_alrm[iVar6].lock);
          pthread_mutex_unlock((pthread_mutex_t *)&flag_mutex);
          return;
        }
        iVar6 = iVar6 + 1;
        piVar4 = piVar4 + 0x1c;
      } while (iVar6 != 0x100);
    }
    else {
      iVar6 = 0;
      pthread_mutex_lock((pthread_mutex_t *)&flag_mutex);
      piVar4 = &tab_alrm[0].tid_spec;
      do {
        if (*piVar4 == -1) break;
        iVar6 = iVar6 + 1;
        piVar4 = piVar4 + 0x1c;
      } while (iVar6 != 0x100);
      lVar2 = syscall(0xba);
      tab_alrm[iVar6].tid_spec = (int)lVar2;
      pVar3 = pthread_self();
      tab_alrm[iVar6].tid = pVar3;
      tab_alrm[iVar6].done = -1;
      tab_alrm[iVar6].flag = -1;
      pthread_mutex_unlock((pthread_mutex_t *)&flag_mutex);
      *flag = -1;
      piVar4 = (int *)malloc(8);
      *piVar4 = iVar6;
      piVar4[1] = delta;
      pthread_attr_init((pthread_attr_t *)&pattr);
      pthread_attr_setscope((pthread_attr_t *)&pattr,0);
      iVar1 = pthread_create(&tid_time,(pthread_attr_t *)0x0,thread_wait_TIME,piVar4);
      if (iVar1 < 0) {
        puVar5 = (uint *)__errno_location();
        fprintf(stderr,"pthread_create Error %d\n",(ulong)*puVar5);
        free(piVar4);
                    // WARNING: Subroutine does not return
        pthread_exit((void *)0x0);
      }
      sprintf(sLine,"THR_Alarm() thread_wait_TIME(TID=[%d]) waits for [%d]",
              (ulong)(uint)tab_alrm[iVar6].tid_spec,delta);
      trace_event(sLine,5);
    }
  }
  return;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

void InitBalProdConso(void)

{
  if (500 < max_request) {
    max_request = 500;
  }
  iBalGet = 0;
  iBalPut = 0;
  nBalSlots = max_request;
  nBalItem = 0;
  return;
}



// WARNING: Unknown calling convention

int PBalWaitEntry(void)

{
  pthread_mutex_lock((pthread_mutex_t *)&BalWriteMutex);
  while (nBalSlots < 1) {
    pthread_cond_wait((pthread_cond_t *)&BalWriteCond,(pthread_mutex_t *)&BalWriteMutex);
  }
  nBalSlots = nBalSlots + -1;
  pthread_mutex_unlock((pthread_mutex_t *)&BalWriteMutex);
  return 0;
}



// WARNING: Unknown calling convention

int PBalPutMsg(TSBalExchange *sBalMsg)

{
  char cVar1;
  char cVar2;
  char cVar3;
  pid_t pVar4;
  long lVar5;
  TSBalExchange *pTVar6;
  byte bVar7;
  
  bVar7 = 0;
  pthread_mutex_lock((pthread_mutex_t *)&BalTabMutex);
  pTVar6 = tab_BalDemande + iBalPut;
  for (lVar5 = 0x204; lVar5 != 0; lVar5 = lVar5 + -1) {
    cVar1 = (sBalMsg->sHeader).sPartner[1];
    cVar2 = (sBalMsg->sHeader).sSource[0];
    cVar3 = (sBalMsg->sHeader).sSource[1];
    pVar4 = (sBalMsg->sHeader).nPartnerId;
    (pTVar6->sHeader).sPartner[0] = (sBalMsg->sHeader).sPartner[0];
    (pTVar6->sHeader).sPartner[1] = cVar1;
    (pTVar6->sHeader).sSource[0] = cVar2;
    (pTVar6->sHeader).sSource[1] = cVar3;
    (pTVar6->sHeader).nPartnerId = pVar4;
    sBalMsg = (TSBalExchange *)((long)sBalMsg + (ulong)bVar7 * -0x10 + 8);
    pTVar6 = (TSBalExchange *)((long)pTVar6 + ((ulong)bVar7 * -2 + 1) * 8);
  }
  iBalPut = (iBalPut + 1) % max_request;
  pthread_mutex_unlock((pthread_mutex_t *)&BalTabMutex);
  return 0;
}



// WARNING: Unknown calling convention

int PBalConsoInfo(void)

{
  pthread_mutex_lock((pthread_mutex_t *)&BalReadMutex);
  nBalItem = nBalItem + 1;
  pthread_cond_signal((pthread_cond_t *)&BalReadCond);
  pthread_mutex_unlock((pthread_mutex_t *)&BalReadMutex);
  return 0;
}



// WARNING: Unknown calling convention

int CBalWaitMsg(void)

{
  pthread_mutex_lock((pthread_mutex_t *)&BalReadMutex);
  while (nBalItem < 1) {
    pthread_cond_wait((pthread_cond_t *)&BalReadCond,(pthread_mutex_t *)&BalReadMutex);
  }
  nBalItem = nBalItem + -1;
  pthread_mutex_unlock((pthread_mutex_t *)&BalReadMutex);
  return 0;
}



// WARNING: Unknown calling convention

int CBalGetMsg(TSBalExchange *sBalMsg)

{
  TSBalHeader *pTVar1;
  char cVar2;
  char cVar3;
  char cVar4;
  pid_t pVar5;
  ulong uVar6;
  long lVar7;
  uint uVar8;
  TSBalExchange *pTVar9;
  TSBalExchange *pTVar10;
  bool bVar11;
  byte bVar12;
  
  bVar12 = 0;
  pthread_mutex_lock((pthread_mutex_t *)&BalTabMutex);
  pTVar9 = tab_BalDemande + iBalGet;
  bVar11 = ((ulong)sBalMsg & 1) != 0;
  uVar8 = 0x1020;
  if (bVar11) {
    pTVar1 = &pTVar9->sHeader;
    pTVar10 = (TSBalExchange *)((sBalMsg->sHeader).sPartner + 1);
    pTVar9 = (TSBalExchange *)(tab_BalDemande[iBalGet].sHeader.sPartner + 1);
    uVar6 = (ulong)pTVar10 & 2;
    (sBalMsg->sHeader).sPartner[0] = pTVar1->sPartner[0];
    uVar8 = 0x101f;
    sBalMsg = pTVar10;
  }
  else {
    uVar6 = (ulong)sBalMsg & 2;
  }
  if (uVar6 != 0) {
    pTVar1 = &pTVar9->sHeader;
    pTVar9 = (TSBalExchange *)(pTVar9->sHeader).sSource;
    uVar8 = uVar8 - 2;
    *(undefined2 *)(sBalMsg->sHeader).sPartner = *(undefined2 *)pTVar1->sPartner;
    sBalMsg = (TSBalExchange *)(sBalMsg->sHeader).sSource;
  }
  pTVar10 = sBalMsg;
  if (((ulong)sBalMsg & 4) != 0) {
    pTVar1 = &pTVar9->sHeader;
    cVar2 = (pTVar9->sHeader).sPartner[1];
    cVar3 = (pTVar9->sHeader).sSource[0];
    cVar4 = (pTVar9->sHeader).sSource[1];
    pTVar10 = (TSBalExchange *)&(sBalMsg->sHeader).nPartnerId;
    pTVar9 = (TSBalExchange *)&(pTVar9->sHeader).nPartnerId;
    uVar8 = uVar8 - 4;
    (sBalMsg->sHeader).sPartner[0] = pTVar1->sPartner[0];
    (sBalMsg->sHeader).sPartner[1] = cVar2;
    (sBalMsg->sHeader).sSource[0] = cVar3;
    (sBalMsg->sHeader).sSource[1] = cVar4;
  }
  for (uVar6 = (ulong)(uVar8 >> 3); uVar6 != 0; uVar6 = uVar6 - 1) {
    cVar2 = (pTVar9->sHeader).sPartner[1];
    cVar3 = (pTVar9->sHeader).sSource[0];
    cVar4 = (pTVar9->sHeader).sSource[1];
    pVar5 = (pTVar9->sHeader).nPartnerId;
    (pTVar10->sHeader).sPartner[0] = (pTVar9->sHeader).sPartner[0];
    (pTVar10->sHeader).sPartner[1] = cVar2;
    (pTVar10->sHeader).sSource[0] = cVar3;
    (pTVar10->sHeader).sSource[1] = cVar4;
    (pTVar10->sHeader).nPartnerId = pVar5;
    pTVar9 = (TSBalExchange *)((long)pTVar9 + ((ulong)bVar12 * -2 + 1) * 8);
    pTVar10 = (TSBalExchange *)((long)pTVar10 + (ulong)bVar12 * -0x10 + 8);
  }
  lVar7 = 0;
  if ((uVar8 & 4) != 0) {
    cVar2 = (pTVar9->sHeader).sPartner[1];
    cVar3 = (pTVar9->sHeader).sSource[0];
    cVar4 = (pTVar9->sHeader).sSource[1];
    (pTVar10->sHeader).sPartner[0] = (pTVar9->sHeader).sPartner[0];
    (pTVar10->sHeader).sPartner[1] = cVar2;
    (pTVar10->sHeader).sSource[0] = cVar3;
    (pTVar10->sHeader).sSource[1] = cVar4;
    lVar7 = 4;
  }
  if ((uVar8 & 2) != 0) {
    *(undefined2 *)((pTVar10->sHeader).sPartner + lVar7) =
         *(undefined2 *)((pTVar9->sHeader).sPartner + lVar7);
    lVar7 = lVar7 + 2;
  }
  if (bVar11) {
    (pTVar10->sHeader).sPartner[lVar7] = (pTVar9->sHeader).sPartner[lVar7];
  }
  iBalGet = (iBalGet + 1) % max_request;
  pthread_mutex_unlock((pthread_mutex_t *)&BalTabMutex);
  return 0;
}



// WARNING: Unknown calling convention

int CBalFreeEntry(void)

{
  pthread_mutex_lock((pthread_mutex_t *)&BalWriteMutex);
  nBalSlots = nBalSlots + 1;
  pthread_cond_signal((pthread_cond_t *)&BalWriteCond);
  pthread_mutex_unlock((pthread_mutex_t *)&BalWriteMutex);
  return 0;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

void InitLineProdConso(void)

{
  if (500 < max_request) {
    max_request = 500;
  }
  iLineGet = 0;
  iLinePut = 0;
  nLineSlots = max_request;
  nLineItem = 0;
  return;
}



// WARNING: Unknown calling convention

int PLineWaitEntry(void)

{
  pthread_mutex_lock((pthread_mutex_t *)&LineWriteMutex);
  while (nLineSlots < 1) {
    pthread_cond_wait((pthread_cond_t *)&LineWriteCond,(pthread_mutex_t *)&LineWriteMutex);
  }
  nLineSlots = nLineSlots + -1;
  pthread_mutex_unlock((pthread_mutex_t *)&LineWriteMutex);
  return 0;
}



// WARNING: Unknown calling convention

int PLinePutMsg(TSLineExchange *sLineMsg)

{
  char cVar1;
  char cVar2;
  char cVar3;
  char cVar4;
  long lVar5;
  TSLineExchange *pTVar6;
  byte bVar7;
  
  bVar7 = 0;
  pthread_mutex_lock((pthread_mutex_t *)&LineTabMutex);
  pTVar6 = tab_LineDemande + iLinePut;
  for (lVar5 = 0x203; lVar5 != 0; lVar5 = lVar5 + -1) {
    cVar1 = sLineMsg->sBuffer[0];
    cVar2 = sLineMsg->sBuffer[1];
    cVar3 = sLineMsg->sBuffer[2];
    cVar4 = sLineMsg->sBuffer[3];
    pTVar6->nLength = sLineMsg->nLength;
    pTVar6->sBuffer[0] = cVar1;
    pTVar6->sBuffer[1] = cVar2;
    pTVar6->sBuffer[2] = cVar3;
    pTVar6->sBuffer[3] = cVar4;
    sLineMsg = (TSLineExchange *)((long)sLineMsg + (ulong)bVar7 * -0x10 + 8);
    pTVar6 = (TSLineExchange *)((long)pTVar6 + ((ulong)bVar7 * -2 + 1) * 8);
  }
  iLinePut = (iLinePut + 1) % max_request;
  pthread_mutex_unlock((pthread_mutex_t *)&LineTabMutex);
  return 0;
}



// WARNING: Unknown calling convention

int PLineConsoInfo(void)

{
  pthread_mutex_lock((pthread_mutex_t *)&LineReadMutex);
  nLineItem = nLineItem + 1;
  pthread_cond_signal((pthread_cond_t *)&LineReadCond);
  pthread_mutex_unlock((pthread_mutex_t *)&LineReadMutex);
  return 0;
}



// WARNING: Unknown calling convention

int CLineWaitMsg(void)

{
  pthread_mutex_lock((pthread_mutex_t *)&LineReadMutex);
  while (nLineItem < 1) {
    pthread_cond_wait((pthread_cond_t *)&LineReadCond,(pthread_mutex_t *)&LineReadMutex);
  }
  nLineItem = nLineItem + -1;
  pthread_mutex_unlock((pthread_mutex_t *)&LineReadMutex);
  return 0;
}



// WARNING: Unknown calling convention

int CLineGetMsg(TSLineExchange *sLineMsg)

{
  int *piVar1;
  char cVar2;
  char cVar3;
  char cVar4;
  char cVar5;
  ulong uVar6;
  long lVar7;
  uint uVar8;
  TSLineExchange *pTVar9;
  TSLineExchange *pTVar10;
  bool bVar11;
  byte bVar12;
  
  bVar12 = 0;
  pthread_mutex_lock((pthread_mutex_t *)&LineTabMutex);
  uVar8 = 0x1018;
  pTVar9 = tab_LineDemande + iLineGet;
  bVar11 = ((ulong)sLineMsg & 1) != 0;
  if (bVar11) {
    piVar1 = &pTVar9->nLength;
    pTVar10 = (TSLineExchange *)((long)&sLineMsg->nLength + 1);
    pTVar9 = (TSLineExchange *)((long)&tab_LineDemande[iLineGet].nLength + 1);
    uVar6 = (ulong)pTVar10 & 2;
    *(char *)&sLineMsg->nLength = (char)*piVar1;
    uVar8 = 0x1017;
    sLineMsg = pTVar10;
  }
  else {
    uVar6 = (ulong)sLineMsg & 2;
  }
  if (uVar6 != 0) {
    piVar1 = &pTVar9->nLength;
    pTVar9 = (TSLineExchange *)((long)&pTVar9->nLength + 2);
    uVar8 = uVar8 - 2;
    *(short *)&sLineMsg->nLength = (short)*piVar1;
    sLineMsg = (TSLineExchange *)((long)&sLineMsg->nLength + 2);
  }
  pTVar10 = sLineMsg;
  if (((ulong)sLineMsg & 4) != 0) {
    piVar1 = &pTVar9->nLength;
    pTVar10 = (TSLineExchange *)sLineMsg->sBuffer;
    pTVar9 = (TSLineExchange *)pTVar9->sBuffer;
    uVar8 = uVar8 - 4;
    sLineMsg->nLength = *piVar1;
  }
  for (uVar6 = (ulong)(uVar8 >> 3); uVar6 != 0; uVar6 = uVar6 - 1) {
    cVar2 = pTVar9->sBuffer[0];
    cVar3 = pTVar9->sBuffer[1];
    cVar4 = pTVar9->sBuffer[2];
    cVar5 = pTVar9->sBuffer[3];
    pTVar10->nLength = pTVar9->nLength;
    pTVar10->sBuffer[0] = cVar2;
    pTVar10->sBuffer[1] = cVar3;
    pTVar10->sBuffer[2] = cVar4;
    pTVar10->sBuffer[3] = cVar5;
    pTVar9 = (TSLineExchange *)((long)pTVar9 + ((ulong)bVar12 * -2 + 1) * 8);
    pTVar10 = (TSLineExchange *)((long)pTVar10 + (ulong)bVar12 * -0x10 + 8);
  }
  lVar7 = 0;
  if ((uVar8 & 4) != 0) {
    pTVar10->nLength = pTVar9->nLength;
    lVar7 = 4;
  }
  if ((uVar8 & 2) != 0) {
    *(undefined2 *)(pTVar10->sBuffer + lVar7 + -4) = *(undefined2 *)(pTVar9->sBuffer + lVar7 + -4);
    lVar7 = lVar7 + 2;
  }
  if (bVar11) {
    pTVar10->sBuffer[lVar7 + -4] = pTVar9->sBuffer[lVar7 + -4];
  }
  iLineGet = (iLineGet + 1) % max_request;
  pthread_mutex_unlock((pthread_mutex_t *)&LineTabMutex);
  return 0;
}



// WARNING: Unknown calling convention

int CLineFreeEntry(void)

{
  pthread_mutex_lock((pthread_mutex_t *)&LineWriteMutex);
  nLineSlots = nLineSlots + 1;
  pthread_cond_signal((pthread_cond_t *)&LineWriteCond);
  pthread_mutex_unlock((pthread_mutex_t *)&LineWriteMutex);
  return 0;
}



// WARNING: Unknown calling convention

void FCT_SHUTDOWN_BAL(int nIndiceCtx)

{
  pthread_t pVar1;
  char sLine [512];
  
  pVar1 = pthread_self();
  sprintf(sLine,"==> ShutDown of Queue Thread %d In Progress ...",pVar1);
  trace_event(sLine,0);
  DeconnectOracle(nIndiceCtx);
  FreeOracleCtx(nIndiceCtx);
  sprintf(sLine,"==> ShutDown of Queue Thread %d Done ...",pVar1);
  trace_event(sLine,0);
                    // WARNING: Subroutine does not return
  pthread_exit((void *)0x0);
}



// WARNING: Unknown calling convention

void FCT_SHUTDOWN_TIME(int nIndiceCtx)

{
  pthread_t pVar1;
  char sLine [512];
  
  pVar1 = pthread_self();
  sprintf(sLine,"==> ShutDown of Time Thread %d In Progress ...",pVar1);
  trace_event(sLine,0);
  DeconnectOracle(nIndiceCtx);
  FreeOracleCtx(nIndiceCtx);
  sprintf(sLine,"==> ShutDown of Time Thread %d Done ...",pVar1);
  trace_event(sLine,0);
                    // WARNING: Subroutine does not return
  pthread_exit((void *)0x0);
}



// WARNING: Unknown calling convention

int SendShutDownSignalsToBalThreads(void)

{
  int iVar1;
  char sentRefNbr [13];
  char FieldData [256];
  char sBuffer [1024];
  TSIsoInfo IsoInfo;
  TSBalExchange sBalMsg;
  
  InitIsoInfo(&IsoInfo);
  IsoInfo.nMsgType = 0x6a4;
  current_gmt_date(FieldData);
  AddIsoField(6,&IsoInfo,FieldData,10);
  current_julian_date_qjjj(sentRefNbr);
  current_hour(sentRefNbr + 4);
  sentRefNbr[6] = FieldData[0];
  sentRefNbr[7] = FieldData[1];
  sentRefNbr[8] = FieldData[2];
  sentRefNbr[9] = FieldData[3];
  sentRefNbr[10] = FieldData[4];
  sentRefNbr[0xb] = FieldData[5];
  AddIsoField(0x24,&IsoInfo,sentRefNbr,0xc);
  AddIsoField(0x45,&IsoInfo,"002",3);
  dump_p7_struct(&IsoInfo);
  iVar1 = 0;
  sBalMsg.sHeader.nLen = IsoBuildMsg(sBuffer,&IsoInfo);
  memcpy(sBalMsg.sBody,sBuffer,(long)sBalMsg.sHeader.nLen);
  if (0 < max_thread) {
    do {
      iVar1 = iVar1 + 1;
      PBalWaitEntry();
      PBalPutMsg(&sBalMsg);
      PBalConsoInfo();
    } while (iVar1 < max_thread);
  }
  return 0;
}



// WARNING: Unknown calling convention

int SendShutDownSignalsToTimeThreads(void)

{
  int iVar1;
  TSTimeExchange sTimeMsg;
  
  iVar1 = 5;
  sTimeMsg.sens = 'S';
  do {
    PTimeWaitEntry();
    PTimePutMsg(&sTimeMsg);
    PTimeConsoInfo();
    iVar1 = iVar1 + -1;
  } while (iVar1 != 0);
  return 0;
}



// WARNING: Unknown calling convention

void FCT_SHUTDOWN_LINE(int nIndiceCtx)

{
  pthread_t pVar1;
  char sLine [512];
  
  pVar1 = pthread_self();
  sprintf(sLine,"ShutDown of Thread %d In Progress ...",pVar1);
  trace_event(sLine,0);
  DeconnectOracle(nIndiceCtx);
  FreeOracleCtx(nIndiceCtx);
  sprintf(sLine,"ShutDown of Thread %d Done ...",pVar1);
  trace_event(sLine,0);
                    // WARNING: Subroutine does not return
  pthread_exit((void *)0x0);
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

void InitTimeProdConso(void)

{
  iTimeGet = 0;
  iTimePut = 0;
  nTimeSlots = 100;
  nTimeItem = 0;
  return;
}



// WARNING: Unknown calling convention

int PTimeWaitEntry(void)

{
  pthread_mutex_lock((pthread_mutex_t *)&TimeWriteMutex);
  while (nTimeSlots < 1) {
    pthread_cond_wait((pthread_cond_t *)&TimeWriteCond,(pthread_mutex_t *)&TimeWriteMutex);
  }
  nTimeSlots = nTimeSlots + -1;
  pthread_mutex_unlock((pthread_mutex_t *)&TimeWriteMutex);
  return 0;
}



// WARNING: Unknown calling convention

int PTimePutMsg(TSTimeExchange *sTimeMsg)

{
  int iVar1;
  
  pthread_mutex_lock((pthread_mutex_t *)&TimeTabMutex);
  iVar1 = iTimePut;
  memcpy(tab_TimeDemande + iTimePut,sTimeMsg,0x21e8);
  iTimePut = (iVar1 + 1) % 100;
  pthread_mutex_unlock((pthread_mutex_t *)&TimeTabMutex);
  return 0;
}



// WARNING: Unknown calling convention

int PTimeConsoInfo(void)

{
  pthread_mutex_lock((pthread_mutex_t *)&TimeReadMutex);
  nTimeItem = nTimeItem + 1;
  pthread_cond_signal((pthread_cond_t *)&TimeReadCond);
  pthread_mutex_unlock((pthread_mutex_t *)&TimeReadMutex);
  return 0;
}



// WARNING: Unknown calling convention

int CTimeWaitMsg(void)

{
  pthread_mutex_lock((pthread_mutex_t *)&TimeReadMutex);
  while (nTimeItem < 1) {
    pthread_cond_wait((pthread_cond_t *)&TimeReadCond,(pthread_mutex_t *)&TimeReadMutex);
  }
  nTimeItem = nTimeItem + -1;
  pthread_mutex_unlock((pthread_mutex_t *)&TimeReadMutex);
  return 0;
}



// WARNING: Unknown calling convention

int CTimeGetMsg(TSTimeExchange *sTimeMsg)

{
  pthread_mutex_lock((pthread_mutex_t *)&TimeTabMutex);
  memcpy(sTimeMsg,tab_TimeDemande + iTimeGet,0x21e8);
  iTimeGet = (iTimeGet + 1) % 100;
  pthread_mutex_unlock((pthread_mutex_t *)&TimeTabMutex);
  return 0;
}



// WARNING: Unknown calling convention

int CTimeFreeEntry(void)

{
  pthread_mutex_lock((pthread_mutex_t *)&TimeWriteMutex);
  nTimeSlots = nTimeSlots + 1;
  pthread_cond_signal((pthread_cond_t *)&TimeWriteCond);
  pthread_mutex_unlock((pthread_mutex_t *)&TimeWriteMutex);
  return 0;
}



// WARNING: Unknown calling convention

int OpenBalCom(key_t nBalName)

{
  int iVar1;
  uint *puVar2;
  
  iVar1 = msgget(nBalName,0x3b6);
  if (iVar1 < 0) {
    puVar2 = (uint *)__errno_location();
    fprintf(stderr,"Error Openning MSG Message Queue : %d\n",(ulong)*puVar2);
    iVar1 = -1;
  }
  return iVar1;
}



// WARNING: Unknown calling convention

void EmptyQueue(int nBalId,long MsgType)

{
  ssize_t sVar1;
  TSBalMessage msg_buffer;
  
  do {
    sVar1 = msgrcv(nBalId,&msg_buffer,0x1000,MsgType,0x800);
  } while (sVar1 != -1);
  return;
}



// WARNING: Type propagation algorithm not settling
// WARNING: Unknown calling convention

int ReadBalMsg(int nBalId,long MsgType,int mode,TSBalExchange *struct_bal)

{
  TSBalHeader *pTVar1;
  char cVar2;
  char cVar3;
  char cVar4;
  pid_t pVar5;
  uint uVar6;
  uint *puVar7;
  ulong uVar8;
  long lVar9;
  TSBalExchange *pTVar10;
  TSBalMessage *pTVar11;
  TSBalExchange *pTVar12;
  TSBalExchange *pTVar13;
  bool bVar14;
  byte bVar15;
  char ligne [512];
  TSBalMessage msg_buffer;
  
  bVar15 = 0;
  puVar7 = (uint *)__errno_location();
  sprintf(ligne,"Start ReadBalMsg[21012017][%d] errno[%d]",(ulong)(uint)nBalId,(ulong)*puVar7);
  trace_event(ligne,4);
  pTVar11 = &msg_buffer;
  for (lVar9 = 0x205; lVar9 != 0; lVar9 = lVar9 + -1) {
    pTVar11->lType = 0;
    pTVar11 = (TSBalMessage *)((long)pTVar11 + (ulong)bVar15 * -0x10 + 8);
  }
  *puVar7 = 0;
  do {
    uVar8 = msgrcv(nBalId,&msg_buffer,0x1000,MsgType,mode);
    if (-1 < (int)uVar8) {
      sprintf(ligne,"Errno Before msgrcv [%d]");
      trace_event(ligne,0);
      pTVar10 = &msg_buffer.sText;
      uVar6 = 0x1020;
      bVar14 = ((ulong)struct_bal & 1) != 0;
      pTVar13 = struct_bal;
      if (bVar14) {
        pTVar13 = (TSBalExchange *)((struct_bal->sHeader).sPartner + 1);
        pTVar10 = (TSBalExchange *)(msg_buffer.sText.sHeader.sPartner + 1);
        (struct_bal->sHeader).sPartner[0] = msg_buffer.sText.sHeader.sPartner[0];
        uVar6 = 0x101f;
      }
      pTVar12 = pTVar13;
      if (((ulong)pTVar13 & 2) != 0) {
        pTVar1 = &pTVar10->sHeader;
        pTVar12 = (TSBalExchange *)(pTVar13->sHeader).sSource;
        pTVar10 = (TSBalExchange *)(pTVar10->sHeader).sSource;
        uVar6 = uVar6 - 2;
        *(undefined2 *)(pTVar13->sHeader).sPartner = *(undefined2 *)pTVar1->sPartner;
      }
      pTVar13 = pTVar12;
      if (((ulong)pTVar12 & 4) != 0) {
        pTVar1 = &pTVar10->sHeader;
        cVar2 = (pTVar10->sHeader).sPartner[1];
        cVar3 = (pTVar10->sHeader).sSource[0];
        cVar4 = (pTVar10->sHeader).sSource[1];
        pTVar13 = (TSBalExchange *)&(pTVar12->sHeader).nPartnerId;
        pTVar10 = (TSBalExchange *)&(pTVar10->sHeader).nPartnerId;
        uVar6 = uVar6 - 4;
        (pTVar12->sHeader).sPartner[0] = pTVar1->sPartner[0];
        (pTVar12->sHeader).sPartner[1] = cVar2;
        (pTVar12->sHeader).sSource[0] = cVar3;
        (pTVar12->sHeader).sSource[1] = cVar4;
      }
      lVar9 = 0;
      for (uVar8 = (ulong)(uVar6 >> 3); uVar8 != 0; uVar8 = uVar8 - 1) {
        cVar2 = (pTVar10->sHeader).sPartner[1];
        cVar3 = (pTVar10->sHeader).sSource[0];
        cVar4 = (pTVar10->sHeader).sSource[1];
        pVar5 = (pTVar10->sHeader).nPartnerId;
        (pTVar13->sHeader).sPartner[0] = (pTVar10->sHeader).sPartner[0];
        (pTVar13->sHeader).sPartner[1] = cVar2;
        (pTVar13->sHeader).sSource[0] = cVar3;
        (pTVar13->sHeader).sSource[1] = cVar4;
        (pTVar13->sHeader).nPartnerId = pVar5;
        pTVar10 = (TSBalExchange *)((long)pTVar10 + (ulong)bVar15 * -0x10 + 8);
        pTVar13 = (TSBalExchange *)((long)pTVar13 + (ulong)bVar15 * -0x10 + 8);
      }
      if ((uVar6 & 4) != 0) {
        cVar2 = (pTVar10->sHeader).sPartner[1];
        cVar3 = (pTVar10->sHeader).sSource[0];
        cVar4 = (pTVar10->sHeader).sSource[1];
        (pTVar13->sHeader).sPartner[0] = (pTVar10->sHeader).sPartner[0];
        (pTVar13->sHeader).sPartner[1] = cVar2;
        (pTVar13->sHeader).sSource[0] = cVar3;
        (pTVar13->sHeader).sSource[1] = cVar4;
        lVar9 = 4;
      }
      if ((uVar6 & 2) != 0) {
        *(undefined2 *)((pTVar13->sHeader).sPartner + lVar9) =
             *(undefined2 *)((pTVar10->sHeader).sPartner + lVar9);
        lVar9 = lVar9 + 2;
      }
      if (bVar14) {
        (pTVar13->sHeader).sPartner[lVar9] = (pTVar10->sHeader).sPartner[lVar9];
      }
      if ((nBalId == nBalMsg) || (nBalId == nBalAdm)) {
        dump_buffer((uchar *)struct_bal->sBody,(struct_bal->sHeader).nLen,'A','B','I');
      }
      trace_event("End   ReadBalMsg(OK)",4);
      return 0;
    }
  } while (*puVar7 == 4);
  sprintf(ligne,"Errno Before msgrcv [%d]");
  trace_event(ligne,0);
  sprintf(ligne,"End   ReadBalMsg(NOK) : [%d][%d]",uVar8 & 0xffffffff,(ulong)*puVar7);
  trace_event(ligne,4);
  return -1;
}



// WARNING: Unknown calling convention

int WriteBalMsg(int nBalId,TSBalExchange *struct_bal)

{
  char cVar1;
  char cVar2;
  char cVar3;
  pid_t pVar4;
  uint uVar5;
  int iVar6;
  int iVar7;
  int *piVar8;
  uint *puVar9;
  long lVar10;
  TSBalExchange *pTVar11;
  TSBalExchange *pTVar12;
  byte bVar13;
  char ligne [512];
  char sLine [512];
  TSBalMessage msg_buffer;
  
  bVar13 = 0;
  builtin_strncpy(sLine,"Start WriteBalMsg()",0x14);
  trace_event(sLine,4);
  iVar7 = (struct_bal->sHeader).nLen;
  msg_buffer.lType = (long)(struct_bal->sHeader).nPartnerId;
  time(&(struct_bal->sHeader).nTimeStamp);
  pTVar11 = struct_bal;
  pTVar12 = &msg_buffer.sText;
  for (lVar10 = 0x204; lVar10 != 0; lVar10 = lVar10 + -1) {
    cVar1 = (pTVar11->sHeader).sPartner[1];
    cVar2 = (pTVar11->sHeader).sSource[0];
    cVar3 = (pTVar11->sHeader).sSource[1];
    pVar4 = (pTVar11->sHeader).nPartnerId;
    (pTVar12->sHeader).sPartner[0] = (pTVar11->sHeader).sPartner[0];
    (pTVar12->sHeader).sPartner[1] = cVar1;
    (pTVar12->sHeader).sSource[0] = cVar2;
    (pTVar12->sHeader).sSource[1] = cVar3;
    (pTVar12->sHeader).nPartnerId = pVar4;
    pTVar11 = (TSBalExchange *)((long)pTVar11 + (ulong)bVar13 * -0x10 + 8);
    pTVar12 = (TSBalExchange *)((long)pTVar12 + (ulong)bVar13 * -0x10 + 8);
  }
  if ((nBalId == nBalMsg) || (nBalId == nBalAdm)) {
    dump_buffer((uchar *)struct_bal->sBody,(struct_bal->sHeader).nLen,'A','B','O');
  }
  trace_event("================",4);
  sprintf(ligne,"Partner Id %d",(ulong)(uint)(struct_bal->sHeader).nPartnerId);
  trace_event(ligne,4);
  sprintf(ligne,"Source  Id %d",(ulong)(uint)(struct_bal->sHeader).nSourceId);
  trace_event(ligne,4);
  sprintf(ligne,"Type    Id %d",msg_buffer.lType & 0xffffffff);
  trace_event(ligne,4);
  sprintf(ligne,"Command    %d",(ulong)(uint)(struct_bal->sHeader).nCommand);
  trace_event(ligne,4);
  sprintf(ligne,"Length     %d",(ulong)(uint)(struct_bal->sHeader).nLen);
  trace_event(ligne,4);
  trace_event("================",4);
  uVar5 = kill((__pid_t)msg_buffer.lType,0);
  if ((int)uVar5 < 0) {
    fwrite("Partner Not Available \n",1,0x17,stderr);
    puVar9 = (uint *)__errno_location();
    sprintf(ligne,"Partner [%d] Not Available,errno [%d] , retour [%d]",msg_buffer.lType,
            (ulong)*puVar9,(ulong)uVar5);
    trace_event(ligne,4);
    trace_event("WriteBalMsg(NOT_AVAILABLE)",4);
    iVar7 = 0x3ef;
  }
  else {
    do {
      iVar6 = msgsnd(nBalId,&msg_buffer,(long)(iVar7 + 0x20),0x800);
      if (-1 < iVar6) {
        trace_event("WriteBalMsg(OK)",4);
        return 0;
      }
      piVar8 = __errno_location();
    } while (*piVar8 == 4);
    sprintf(sLine,"Error writing Bal Msg : %d\n");
    trace_event(sLine,0);
    trace_event("WriteBalMsg(NOK)",4);
    iVar7 = -1;
  }
  return iVar7;
}



// WARNING: Type propagation algorithm not settling
// WARNING: Unknown calling convention

int ReadBalHsm(int nBalId,long MsgType,int mode,TSHsmExchange *struct_bal)

{
  TSHsmHeader *pTVar1;
  char cVar2;
  char cVar3;
  char cVar4;
  pid_t pVar5;
  uint uVar6;
  uint *puVar7;
  ulong uVar8;
  long lVar9;
  TSHsmExchange *pTVar10;
  TSHsmMessage *pTVar11;
  TSHsmExchange *pTVar12;
  TSHsmExchange *pTVar13;
  bool bVar14;
  byte bVar15;
  char sLine [512];
  TSHsmMessage msg_buffer;
  
  bVar15 = 0;
  sprintf(sLine,"Start ReadBalHsm(nBalId=[%d])",nBalId);
  trace_event(sLine,4);
  pTVar11 = &msg_buffer;
  for (lVar9 = 0x206; lVar9 != 0; lVar9 = lVar9 + -1) {
    pTVar11->lType = 0;
    pTVar11 = (TSHsmMessage *)((long)pTVar11 + (ulong)bVar15 * -0x10 + 8);
  }
  do {
    uVar8 = msgrcv(nBalId,&msg_buffer,0x1000,MsgType,mode);
    if (-1 < (int)uVar8) {
      pTVar10 = &msg_buffer.sText;
      uVar6 = 0x1020;
      bVar14 = ((ulong)struct_bal & 1) != 0;
      pTVar13 = struct_bal;
      if (bVar14) {
        pTVar13 = (TSHsmExchange *)((struct_bal->sHeader).sPartner + 1);
        pTVar10 = (TSHsmExchange *)(msg_buffer.sText.sHeader.sPartner + 1);
        (struct_bal->sHeader).sPartner[0] = msg_buffer.sText.sHeader.sPartner[0];
        uVar6 = 0x101f;
      }
      pTVar12 = pTVar13;
      if (((ulong)pTVar13 & 2) != 0) {
        pTVar1 = &pTVar10->sHeader;
        pTVar12 = (TSHsmExchange *)(pTVar13->sHeader).sSource;
        pTVar10 = (TSHsmExchange *)(pTVar10->sHeader).sSource;
        uVar6 = uVar6 - 2;
        *(undefined2 *)(pTVar13->sHeader).sPartner = *(undefined2 *)pTVar1->sPartner;
      }
      pTVar13 = pTVar12;
      if (((ulong)pTVar12 & 4) != 0) {
        pTVar1 = &pTVar10->sHeader;
        cVar2 = (pTVar10->sHeader).sPartner[1];
        cVar3 = (pTVar10->sHeader).sSource[0];
        cVar4 = (pTVar10->sHeader).sSource[1];
        pTVar13 = (TSHsmExchange *)&(pTVar12->sHeader).nPartnerId;
        pTVar10 = (TSHsmExchange *)&(pTVar10->sHeader).nPartnerId;
        uVar6 = uVar6 - 4;
        (pTVar12->sHeader).sPartner[0] = pTVar1->sPartner[0];
        (pTVar12->sHeader).sPartner[1] = cVar2;
        (pTVar12->sHeader).sSource[0] = cVar3;
        (pTVar12->sHeader).sSource[1] = cVar4;
      }
      lVar9 = 0;
      for (uVar8 = (ulong)(uVar6 >> 3); uVar8 != 0; uVar8 = uVar8 - 1) {
        cVar2 = (pTVar10->sHeader).sPartner[1];
        cVar3 = (pTVar10->sHeader).sSource[0];
        cVar4 = (pTVar10->sHeader).sSource[1];
        pVar5 = (pTVar10->sHeader).nPartnerId;
        (pTVar13->sHeader).sPartner[0] = (pTVar10->sHeader).sPartner[0];
        (pTVar13->sHeader).sPartner[1] = cVar2;
        (pTVar13->sHeader).sSource[0] = cVar3;
        (pTVar13->sHeader).sSource[1] = cVar4;
        (pTVar13->sHeader).nPartnerId = pVar5;
        pTVar10 = (TSHsmExchange *)((long)pTVar10 + (ulong)bVar15 * -0x10 + 8);
        pTVar13 = (TSHsmExchange *)((long)pTVar13 + (ulong)bVar15 * -0x10 + 8);
      }
      if ((uVar6 & 4) != 0) {
        cVar2 = (pTVar10->sHeader).sPartner[1];
        cVar3 = (pTVar10->sHeader).sSource[0];
        cVar4 = (pTVar10->sHeader).sSource[1];
        (pTVar13->sHeader).sPartner[0] = (pTVar10->sHeader).sPartner[0];
        (pTVar13->sHeader).sPartner[1] = cVar2;
        (pTVar13->sHeader).sSource[0] = cVar3;
        (pTVar13->sHeader).sSource[1] = cVar4;
        lVar9 = 4;
      }
      if ((uVar6 & 2) != 0) {
        *(undefined2 *)((pTVar13->sHeader).sPartner + lVar9) =
             *(undefined2 *)((pTVar10->sHeader).sPartner + lVar9);
        lVar9 = lVar9 + 2;
      }
      if (bVar14) {
        (pTVar13->sHeader).sPartner[lVar9] = (pTVar10->sHeader).sPartner[lVar9];
      }
      trace_event("End   ReadBalHsm(OK)",4);
      return 0;
    }
    puVar7 = (uint *)__errno_location();
  } while (*puVar7 == 4);
  trace_event("End   ReadBalHsm(NOK)",4);
  sprintf(sLine,"End   ReadBalHsm(NOK) : [%d][%d]",uVar8 & 0xffffffff,(ulong)*puVar7);
  trace_event(sLine,4);
  return -1;
}



// WARNING: Unknown calling convention

int WriteBalHsm(int nBalId,TSHsmExchange *struct_bal)

{
  int iVar1;
  char cVar2;
  char cVar3;
  char cVar4;
  pid_t pVar5;
  uint uVar6;
  int *piVar7;
  long lVar8;
  TSHsmExchange *pTVar9;
  byte bVar10;
  char ligne [512];
  TSHsmMessage msg_buffer;
  
  bVar10 = 0;
  sprintf(ligne,"Start WriteBalHsm(nBalId=[%d],PId[%d],SId[%d],TypeId[%d],Com[%d],Len[%d])",nBalId,
          (ulong)(uint)(struct_bal->sHeader).nPartnerId,(ulong)(uint)(struct_bal->sHeader).nSourceId
          ,msg_buffer.lType,(struct_bal->sHeader).nCommand,(struct_bal->sHeader).nLen);
  trace_event(ligne,4);
  iVar1 = (struct_bal->sHeader).nLen;
  msg_buffer.lType = (long)(struct_bal->sHeader).nPartnerId;
  time(&(struct_bal->sHeader).nTimeStamp);
  pTVar9 = &msg_buffer.sText;
  for (lVar8 = 0x205; lVar8 != 0; lVar8 = lVar8 + -1) {
    cVar2 = (struct_bal->sHeader).sPartner[1];
    cVar3 = (struct_bal->sHeader).sSource[0];
    cVar4 = (struct_bal->sHeader).sSource[1];
    pVar5 = (struct_bal->sHeader).nPartnerId;
    (pTVar9->sHeader).sPartner[0] = (struct_bal->sHeader).sPartner[0];
    (pTVar9->sHeader).sPartner[1] = cVar2;
    (pTVar9->sHeader).sSource[0] = cVar3;
    (pTVar9->sHeader).sSource[1] = cVar4;
    (pTVar9->sHeader).nPartnerId = pVar5;
    struct_bal = (TSHsmExchange *)((long)struct_bal + (ulong)bVar10 * -0x10 + 8);
    pTVar9 = (TSHsmExchange *)((long)pTVar9 + (ulong)bVar10 * -0x10 + 8);
  }
  do {
    uVar6 = msgsnd(nBalId,&msg_buffer,(long)(iVar1 + 0x28),0x800);
    if (-1 < (int)uVar6) {
      trace_event("End   WriteBalHsm(OK)",4);
      return 0;
    }
    piVar7 = __errno_location();
  } while (*piVar7 == 4);
  sprintf(ligne,"Enable to write in the HSM queue retour %d|errno %d",(ulong)uVar6);
  trace_event(ligne,4);
  trace_event("End   WriteBalHsm(NOK)",4);
  return -1;
}



// WARNING: Unknown calling convention

uchar Ascii_To_Hex(char c)

{
  byte bVar1;
  
  bVar1 = c - 0x30U;
  if (9 < (byte)(c - 0x30U)) {
    if ((byte)(c + 0xbfU) < 6) {
      return c + 0xc9;
    }
    bVar1 = 0;
    if ((byte)(c + 0x9fU) < 6) {
      bVar1 = c + 0xa9;
    }
  }
  return bVar1;
}



// WARNING: Unknown calling convention

uchar Hex_To_Ascii(char c)

{
  uchar uVar1;
  
  if ('\t' < c) {
    uVar1 = 'A';
    if ((((c != '\n') && (uVar1 = 'B', c != '\v')) && (uVar1 = 'C', c != '\f')) &&
       (((uVar1 = 'D', c != '\r' && (uVar1 = 'E', c != '\x0e')) && (uVar1 = 'F', c != '\x0f')))) {
      uVar1 = '\0';
    }
    return uVar1;
  }
  return c + '0';
}



// WARNING: Unknown calling convention

int HexToAscii(uchar *sSrc,uchar *sDst,int nLng)

{
  byte bVar1;
  uchar uVar2;
  long lVar3;
  size_t __n;
  char *pcVar4;
  int iVar5;
  char sWork [256];
  
  pcVar4 = sWork;
  for (lVar3 = 0x20; lVar3 != 0; lVar3 = lVar3 + -1) {
    pcVar4[0] = '\0';
    pcVar4[1] = '\0';
    pcVar4[2] = '\0';
    pcVar4[3] = '\0';
    pcVar4[4] = '\0';
    pcVar4[5] = '\0';
    pcVar4[6] = '\0';
    pcVar4[7] = '\0';
    pcVar4 = pcVar4 + 8;
  }
  iVar5 = (nLng + 1) / 2;
  if ((nLng + 1) / 2 < 1) {
    __n = 0;
  }
  else {
    lVar3 = 0;
    do {
      uVar2 = Hex_To_Ascii(sSrc[lVar3] >> 4);
      bVar1 = sSrc[lVar3];
      sWork[lVar3 * 2] = uVar2;
      uVar2 = Hex_To_Ascii(bVar1 & 0xf);
      sWork[lVar3 * 2 + 1] = uVar2;
      lVar3 = lVar3 + 1;
    } while (lVar3 != (ulong)(iVar5 - 1) + 1);
    __n = (size_t)(iVar5 * 2);
  }
  memcpy(sDst,sWork,__n);
  return nLng * 2;
}



// WARNING: Unknown calling convention

int AsciiToHex(uchar *sSrc,uchar *sDst,int nLng)

{
  uchar uVar1;
  byte bVar2;
  long lVar3;
  size_t sVar4;
  char *pcVar5;
  int iVar6;
  char sWorkSrc [4096];
  char sWorkDst [4096];
  
  lVar3 = 0x200;
  pcVar5 = sWorkSrc;
  while (lVar3 != 0) {
    lVar3 = lVar3 + -1;
    builtin_strncpy(pcVar5,"00000000",8);
    pcVar5 = pcVar5 + 8;
  }
  pcVar5 = sWorkDst;
  for (lVar3 = 0x200; lVar3 != 0; lVar3 = lVar3 + -1) {
    pcVar5[0] = '\0';
    pcVar5[1] = '\0';
    pcVar5[2] = '\0';
    pcVar5[3] = '\0';
    pcVar5[4] = '\0';
    pcVar5[5] = '\0';
    pcVar5[6] = '\0';
    pcVar5[7] = '\0';
    pcVar5 = pcVar5 + 8;
  }
  if ((nLng & 1U) == 0) {
    memcpy(sWorkSrc,sSrc,(long)nLng);
  }
  else {
    sVar4 = (size_t)nLng;
    nLng = nLng + 1;
    memcpy(sWorkSrc + 1,sSrc,sVar4);
  }
  if (nLng < 1) {
    sVar4 = 0;
    iVar6 = 0;
  }
  else {
    lVar3 = 0;
    do {
      uVar1 = Ascii_To_Hex(sWorkSrc[lVar3 * 2]);
      bVar2 = Ascii_To_Hex(sWorkSrc[lVar3 * 2 + 1]);
      sWorkDst[lVar3] = uVar1 << 4 | bVar2 & 0xf;
      lVar3 = lVar3 + 1;
    } while (lVar3 != (ulong)(nLng - 1) + 1);
    iVar6 = nLng >> 1;
    sVar4 = (size_t)iVar6;
  }
  memcpy(sDst,sWorkDst,sVar4);
  return iVar6;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address
// WARNING: Unknown calling convention

int BcdToAscii(uchar *sSrc,uchar *sDst,int nLng)

{
  int iVar1;
  undefined1 auVar2 [16];
  byte bVar3;
  undefined1 auVar4 [15];
  undefined1 auVar5 [15];
  undefined1 auVar6 [15];
  undefined1 auVar7 [15];
  undefined1 auVar8 [15];
  undefined1 auVar9 [15];
  undefined1 auVar10 [15];
  undefined1 auVar11 [15];
  undefined1 auVar12 [15];
  undefined1 auVar13 [15];
  undefined1 auVar14 [15];
  undefined1 auVar15 [15];
  undefined1 auVar16 [15];
  undefined1 auVar17 [15];
  undefined1 auVar18 [15];
  undefined1 auVar19 [15];
  undefined1 auVar20 [15];
  undefined1 auVar21 [15];
  undefined1 auVar22 [15];
  undefined1 auVar23 [15];
  undefined1 auVar24 [15];
  undefined1 auVar25 [15];
  undefined1 auVar26 [15];
  undefined1 auVar27 [15];
  undefined1 auVar28 [15];
  undefined1 auVar29 [15];
  undefined1 auVar30 [15];
  undefined1 auVar31 [15];
  undefined1 auVar32 [15];
  undefined1 auVar33 [15];
  undefined1 auVar34 [15];
  undefined1 auVar35 [15];
  undefined1 auVar36 [15];
  undefined1 auVar37 [15];
  undefined1 auVar38 [15];
  undefined1 auVar39 [15];
  undefined1 auVar40 [15];
  undefined1 auVar41 [15];
  undefined1 auVar42 [15];
  undefined1 auVar43 [15];
  undefined1 auVar44 [15];
  undefined1 auVar45 [15];
  undefined1 auVar46 [15];
  undefined1 auVar47 [15];
  undefined1 auVar48 [15];
  undefined1 auVar49 [15];
  undefined1 auVar50 [15];
  undefined1 auVar51 [15];
  undefined1 auVar52 [15];
  undefined1 auVar53 [15];
  undefined1 auVar54 [15];
  undefined1 auVar55 [15];
  undefined1 auVar56 [15];
  undefined1 auVar57 [15];
  undefined1 auVar58 [15];
  undefined1 auVar59 [15];
  undefined1 auVar60 [15];
  unkuint9 Var61;
  undefined1 auVar62 [11];
  undefined1 auVar63 [15];
  undefined1 auVar64 [11];
  undefined1 auVar65 [15];
  undefined1 auVar66 [11];
  undefined1 auVar67 [15];
  undefined1 auVar68 [11];
  undefined1 auVar69 [15];
  undefined1 auVar70 [11];
  undefined1 auVar71 [15];
  undefined1 auVar72 [11];
  undefined1 auVar73 [15];
  undefined1 auVar74 [11];
  undefined1 auVar75 [15];
  undefined1 auVar76 [11];
  undefined1 auVar77 [15];
  undefined1 auVar78 [15];
  undefined1 auVar79 [15];
  undefined1 auVar80 [15];
  undefined1 auVar81 [15];
  undefined1 auVar82 [15];
  undefined1 auVar83 [15];
  undefined1 auVar84 [15];
  undefined1 auVar85 [15];
  undefined1 auVar86 [15];
  undefined1 auVar87 [15];
  undefined1 auVar88 [15];
  undefined1 auVar89 [15];
  undefined1 auVar90 [15];
  undefined1 auVar91 [15];
  undefined1 auVar92 [15];
  uint uVar93;
  long lVar94;
  long lVar95;
  int iVar96;
  size_t __n;
  uint uVar97;
  char *pcVar98;
  uint uVar99;
  bool bVar100;
  undefined1 auVar101 [16];
  char sWork [256];
  
  bVar100 = (nLng & 1U) != 0;
  pcVar98 = sWork;
  for (lVar95 = 0x20; lVar95 != 0; lVar95 = lVar95 + -1) {
    *(undefined8 *)pcVar98 = 0;
    pcVar98 = (char *)((long)pcVar98 + 8);
  }
  if (bVar100) {
    nLng = nLng + 1;
  }
  uVar97 = nLng / 2;
  if ((int)uVar97 < 1) {
    __n = 0;
    goto LAB_00429f40;
  }
  uVar93 = uVar97 >> 4;
  uVar99 = uVar93 * 0x10;
  if ((uVar93 == 0) || (uVar97 < 0x10)) {
    iVar96 = 0;
    uVar99 = 0;
LAB_00429ef3:
    lVar95 = 0;
    do {
      bVar3 = sSrc[lVar95 + (int)uVar99];
      iVar1 = iVar96 + 1;
      lVar94 = (long)iVar96;
      lVar95 = lVar95 + 1;
      iVar96 = iVar96 + 2;
      sWork[lVar94] = (bVar3 >> 4) + 0x30;
      sWork[iVar1] = (bVar3 & 0xf) + 0x30;
    } while ((int)(uVar99 + (int)lVar95) < (int)uVar97);
  }
  else {
    auVar2 = *(undefined1 (*) [16])sSrc;
    auVar4[0xd] = 0;
    auVar4._0_13_ = auVar2._0_13_;
    auVar4[0xe] = auVar2[7];
    auVar12[0xc] = auVar2[6];
    auVar12._0_12_ = auVar2._0_12_;
    auVar12._13_2_ = auVar4._13_2_;
    auVar20[0xb] = 0;
    auVar20._0_11_ = auVar2._0_11_;
    auVar20._12_3_ = auVar12._12_3_;
    auVar28[10] = auVar2[5];
    auVar28._0_10_ = auVar2._0_10_;
    auVar28._11_4_ = auVar20._11_4_;
    auVar36[9] = 0;
    auVar36._0_9_ = auVar2._0_9_;
    auVar36._10_5_ = auVar28._10_5_;
    auVar44[8] = auVar2[4];
    auVar44._0_8_ = auVar2._0_8_;
    auVar44._9_6_ = auVar36._9_6_;
    auVar60._7_8_ = 0;
    auVar60._0_7_ = auVar44._8_7_;
    Var61 = CONCAT81(SUB158(auVar60 << 0x40,7),auVar2[3]);
    auVar77._9_6_ = 0;
    auVar77._0_9_ = Var61;
    auVar62._1_10_ = SUB1510(auVar77 << 0x30,5);
    auVar62[0] = auVar2[2];
    auVar78._11_4_ = 0;
    auVar78._0_11_ = auVar62;
    auVar52[2] = auVar2[1];
    auVar52._0_2_ = auVar2._0_2_;
    auVar52._3_12_ = SUB1512(auVar78 << 0x20,3);
    auVar101 = auVar2 & _DAT_004a7340;
    sWork[0] = (char)((auVar2._0_2_ & 0xff) >> 4) + '0';
    sWork[2] = (char)(auVar52._2_2_ >> 4) + '0';
    sWork[4] = (char)(auVar62._0_2_ >> 4) + '0';
    sWork[6] = (char)((ushort)Var61 >> 4) + '0';
    sWork[8] = (char)(auVar44._8_2_ >> 4) + '0';
    sWork[10] = (char)(auVar28._10_2_ >> 4) + '0';
    sWork[0xc] = (char)(auVar12._12_2_ >> 4) + '0';
    sWork[0xe] = (auVar2[7] >> 4) + 0x30;
    sWork[0x10] = (auVar2[8] >> 4) + 0x30;
    sWork[0x12] = (auVar2[9] >> 4) + 0x30;
    sWork[0x14] = (auVar2[10] >> 4) + 0x30;
    sWork[0x16] = (auVar2[0xb] >> 4) + 0x30;
    sWork[0x18] = (auVar2[0xc] >> 4) + 0x30;
    sWork[0x1a] = (auVar2[0xd] >> 4) + 0x30;
    sWork[0x1c] = (auVar2[0xe] >> 4) + 0x30;
    sWork[0x1e] = (auVar2[0xf] >> 4) + 0x30;
    sWork[1] = auVar101[0] + '0';
    sWork[3] = auVar101[1] + '0';
    sWork[5] = auVar101[2] + '0';
    sWork[7] = auVar101[3] + '0';
    sWork[9] = auVar101[4] + '0';
    sWork[0xb] = auVar101[5] + '0';
    sWork[0xd] = auVar101[6] + '0';
    sWork[0xf] = auVar101[7] + '0';
    sWork[0x11] = auVar101[8] + '0';
    sWork[0x13] = auVar101[9] + '0';
    sWork[0x15] = auVar101[10] + '0';
    sWork[0x17] = auVar101[0xb] + '0';
    sWork[0x19] = auVar101[0xc] + '0';
    sWork[0x1b] = auVar101[0xd] + '0';
    sWork[0x1d] = auVar101[0xe] + '0';
    sWork[0x1f] = auVar101[0xf] + '0';
    if (1 < uVar93) {
      auVar2 = *(undefined1 (*) [16])(sSrc + 0x10);
      auVar5[0xd] = 0;
      auVar5._0_13_ = auVar2._0_13_;
      auVar5[0xe] = auVar2[7];
      auVar13[0xc] = auVar2[6];
      auVar13._0_12_ = auVar2._0_12_;
      auVar13._13_2_ = auVar5._13_2_;
      auVar21[0xb] = 0;
      auVar21._0_11_ = auVar2._0_11_;
      auVar21._12_3_ = auVar13._12_3_;
      auVar29[10] = auVar2[5];
      auVar29._0_10_ = auVar2._0_10_;
      auVar29._11_4_ = auVar21._11_4_;
      auVar37[9] = 0;
      auVar37._0_9_ = auVar2._0_9_;
      auVar37._10_5_ = auVar29._10_5_;
      auVar45[8] = auVar2[4];
      auVar45._0_8_ = auVar2._0_8_;
      auVar45._9_6_ = auVar37._9_6_;
      auVar63._7_8_ = 0;
      auVar63._0_7_ = auVar45._8_7_;
      Var61 = CONCAT81(SUB158(auVar63 << 0x40,7),auVar2[3]);
      auVar79._9_6_ = 0;
      auVar79._0_9_ = Var61;
      auVar64._1_10_ = SUB1510(auVar79 << 0x30,5);
      auVar64[0] = auVar2[2];
      auVar80._11_4_ = 0;
      auVar80._0_11_ = auVar64;
      auVar53[2] = auVar2[1];
      auVar53._0_2_ = auVar2._0_2_;
      auVar53._3_12_ = SUB1512(auVar80 << 0x20,3);
      auVar101 = auVar2 & _DAT_004a7340;
      sWork[0x21] = auVar101[0] + '0';
      sWork[0x23] = auVar101[1] + '0';
      sWork[0x25] = auVar101[2] + '0';
      sWork[0x27] = auVar101[3] + '0';
      sWork[0x29] = auVar101[4] + '0';
      sWork[0x2b] = auVar101[5] + '0';
      sWork[0x2d] = auVar101[6] + '0';
      sWork[0x2f] = auVar101[7] + '0';
      sWork[0x31] = auVar101[8] + '0';
      sWork[0x33] = auVar101[9] + '0';
      sWork[0x35] = auVar101[10] + '0';
      sWork[0x37] = auVar101[0xb] + '0';
      sWork[0x39] = auVar101[0xc] + '0';
      sWork[0x3b] = auVar101[0xd] + '0';
      sWork[0x3d] = auVar101[0xe] + '0';
      sWork[0x3f] = auVar101[0xf] + '0';
      sWork[0x20] = (char)((auVar2._0_2_ & 0xff) >> 4) + '0';
      sWork[0x22] = (char)(auVar53._2_2_ >> 4) + '0';
      sWork[0x24] = (char)(auVar64._0_2_ >> 4) + '0';
      sWork[0x26] = (char)((ushort)Var61 >> 4) + '0';
      sWork[0x28] = (char)(auVar45._8_2_ >> 4) + '0';
      sWork[0x2a] = (char)(auVar29._10_2_ >> 4) + '0';
      sWork[0x2c] = (char)(auVar13._12_2_ >> 4) + '0';
      sWork[0x2e] = (auVar2[7] >> 4) + 0x30;
      sWork[0x30] = (auVar2[8] >> 4) + 0x30;
      sWork[0x32] = (auVar2[9] >> 4) + 0x30;
      sWork[0x34] = (auVar2[10] >> 4) + 0x30;
      sWork[0x36] = (auVar2[0xb] >> 4) + 0x30;
      sWork[0x38] = (auVar2[0xc] >> 4) + 0x30;
      sWork[0x3a] = (auVar2[0xd] >> 4) + 0x30;
      sWork[0x3c] = (auVar2[0xe] >> 4) + 0x30;
      sWork[0x3e] = (auVar2[0xf] >> 4) + 0x30;
      if (2 < uVar93) {
        auVar2 = *(undefined1 (*) [16])(sSrc + 0x20);
        auVar6[0xd] = 0;
        auVar6._0_13_ = auVar2._0_13_;
        auVar6[0xe] = auVar2[7];
        auVar14[0xc] = auVar2[6];
        auVar14._0_12_ = auVar2._0_12_;
        auVar14._13_2_ = auVar6._13_2_;
        auVar22[0xb] = 0;
        auVar22._0_11_ = auVar2._0_11_;
        auVar22._12_3_ = auVar14._12_3_;
        auVar30[10] = auVar2[5];
        auVar30._0_10_ = auVar2._0_10_;
        auVar30._11_4_ = auVar22._11_4_;
        auVar38[9] = 0;
        auVar38._0_9_ = auVar2._0_9_;
        auVar38._10_5_ = auVar30._10_5_;
        auVar46[8] = auVar2[4];
        auVar46._0_8_ = auVar2._0_8_;
        auVar46._9_6_ = auVar38._9_6_;
        auVar65._7_8_ = 0;
        auVar65._0_7_ = auVar46._8_7_;
        Var61 = CONCAT81(SUB158(auVar65 << 0x40,7),auVar2[3]);
        auVar81._9_6_ = 0;
        auVar81._0_9_ = Var61;
        auVar66._1_10_ = SUB1510(auVar81 << 0x30,5);
        auVar66[0] = auVar2[2];
        auVar82._11_4_ = 0;
        auVar82._0_11_ = auVar66;
        auVar54[2] = auVar2[1];
        auVar54._0_2_ = auVar2._0_2_;
        auVar54._3_12_ = SUB1512(auVar82 << 0x20,3);
        auVar101 = auVar2 & _DAT_004a7340;
        sWork[0x41] = auVar101[0] + '0';
        sWork[0x43] = auVar101[1] + '0';
        sWork[0x45] = auVar101[2] + '0';
        sWork[0x47] = auVar101[3] + '0';
        sWork[0x49] = auVar101[4] + '0';
        sWork[0x4b] = auVar101[5] + '0';
        sWork[0x4d] = auVar101[6] + '0';
        sWork[0x4f] = auVar101[7] + '0';
        sWork[0x51] = auVar101[8] + '0';
        sWork[0x53] = auVar101[9] + '0';
        sWork[0x55] = auVar101[10] + '0';
        sWork[0x57] = auVar101[0xb] + '0';
        sWork[0x59] = auVar101[0xc] + '0';
        sWork[0x5b] = auVar101[0xd] + '0';
        sWork[0x5d] = auVar101[0xe] + '0';
        sWork[0x5f] = auVar101[0xf] + '0';
        sWork[0x40] = (char)((auVar2._0_2_ & 0xff) >> 4) + '0';
        sWork[0x42] = (char)(auVar54._2_2_ >> 4) + '0';
        sWork[0x44] = (char)(auVar66._0_2_ >> 4) + '0';
        sWork[0x46] = (char)((ushort)Var61 >> 4) + '0';
        sWork[0x48] = (char)(auVar46._8_2_ >> 4) + '0';
        sWork[0x4a] = (char)(auVar30._10_2_ >> 4) + '0';
        sWork[0x4c] = (char)(auVar14._12_2_ >> 4) + '0';
        sWork[0x4e] = (auVar2[7] >> 4) + 0x30;
        sWork[0x50] = (auVar2[8] >> 4) + 0x30;
        sWork[0x52] = (auVar2[9] >> 4) + 0x30;
        sWork[0x54] = (auVar2[10] >> 4) + 0x30;
        sWork[0x56] = (auVar2[0xb] >> 4) + 0x30;
        sWork[0x58] = (auVar2[0xc] >> 4) + 0x30;
        sWork[0x5a] = (auVar2[0xd] >> 4) + 0x30;
        sWork[0x5c] = (auVar2[0xe] >> 4) + 0x30;
        sWork[0x5e] = (auVar2[0xf] >> 4) + 0x30;
        if (3 < uVar93) {
          auVar2 = *(undefined1 (*) [16])(sSrc + 0x30);
          auVar7[0xd] = 0;
          auVar7._0_13_ = auVar2._0_13_;
          auVar7[0xe] = auVar2[7];
          auVar15[0xc] = auVar2[6];
          auVar15._0_12_ = auVar2._0_12_;
          auVar15._13_2_ = auVar7._13_2_;
          auVar23[0xb] = 0;
          auVar23._0_11_ = auVar2._0_11_;
          auVar23._12_3_ = auVar15._12_3_;
          auVar31[10] = auVar2[5];
          auVar31._0_10_ = auVar2._0_10_;
          auVar31._11_4_ = auVar23._11_4_;
          auVar39[9] = 0;
          auVar39._0_9_ = auVar2._0_9_;
          auVar39._10_5_ = auVar31._10_5_;
          auVar47[8] = auVar2[4];
          auVar47._0_8_ = auVar2._0_8_;
          auVar47._9_6_ = auVar39._9_6_;
          auVar67._7_8_ = 0;
          auVar67._0_7_ = auVar47._8_7_;
          Var61 = CONCAT81(SUB158(auVar67 << 0x40,7),auVar2[3]);
          auVar83._9_6_ = 0;
          auVar83._0_9_ = Var61;
          auVar68._1_10_ = SUB1510(auVar83 << 0x30,5);
          auVar68[0] = auVar2[2];
          auVar84._11_4_ = 0;
          auVar84._0_11_ = auVar68;
          auVar55[2] = auVar2[1];
          auVar55._0_2_ = auVar2._0_2_;
          auVar55._3_12_ = SUB1512(auVar84 << 0x20,3);
          auVar101 = auVar2 & _DAT_004a7340;
          sWork[0x61] = auVar101[0] + '0';
          sWork[99] = auVar101[1] + '0';
          sWork[0x65] = auVar101[2] + '0';
          sWork[0x67] = auVar101[3] + '0';
          sWork[0x69] = auVar101[4] + '0';
          sWork[0x6b] = auVar101[5] + '0';
          sWork[0x6d] = auVar101[6] + '0';
          sWork[0x6f] = auVar101[7] + '0';
          sWork[0x71] = auVar101[8] + '0';
          sWork[0x73] = auVar101[9] + '0';
          sWork[0x75] = auVar101[10] + '0';
          sWork[0x77] = auVar101[0xb] + '0';
          sWork[0x79] = auVar101[0xc] + '0';
          sWork[0x7b] = auVar101[0xd] + '0';
          sWork[0x7d] = auVar101[0xe] + '0';
          sWork[0x7f] = auVar101[0xf] + '0';
          sWork[0x60] = (char)((auVar2._0_2_ & 0xff) >> 4) + '0';
          sWork[0x62] = (char)(auVar55._2_2_ >> 4) + '0';
          sWork[100] = (char)(auVar68._0_2_ >> 4) + '0';
          sWork[0x66] = (char)((ushort)Var61 >> 4) + '0';
          sWork[0x68] = (char)(auVar47._8_2_ >> 4) + '0';
          sWork[0x6a] = (char)(auVar31._10_2_ >> 4) + '0';
          sWork[0x6c] = (char)(auVar15._12_2_ >> 4) + '0';
          sWork[0x6e] = (auVar2[7] >> 4) + 0x30;
          sWork[0x70] = (auVar2[8] >> 4) + 0x30;
          sWork[0x72] = (auVar2[9] >> 4) + 0x30;
          sWork[0x74] = (auVar2[10] >> 4) + 0x30;
          sWork[0x76] = (auVar2[0xb] >> 4) + 0x30;
          sWork[0x78] = (auVar2[0xc] >> 4) + 0x30;
          sWork[0x7a] = (auVar2[0xd] >> 4) + 0x30;
          sWork[0x7c] = (auVar2[0xe] >> 4) + 0x30;
          sWork[0x7e] = (auVar2[0xf] >> 4) + 0x30;
          if (4 < uVar93) {
            auVar2 = *(undefined1 (*) [16])(sSrc + 0x40);
            auVar8[0xd] = 0;
            auVar8._0_13_ = auVar2._0_13_;
            auVar8[0xe] = auVar2[7];
            auVar16[0xc] = auVar2[6];
            auVar16._0_12_ = auVar2._0_12_;
            auVar16._13_2_ = auVar8._13_2_;
            auVar24[0xb] = 0;
            auVar24._0_11_ = auVar2._0_11_;
            auVar24._12_3_ = auVar16._12_3_;
            auVar32[10] = auVar2[5];
            auVar32._0_10_ = auVar2._0_10_;
            auVar32._11_4_ = auVar24._11_4_;
            auVar40[9] = 0;
            auVar40._0_9_ = auVar2._0_9_;
            auVar40._10_5_ = auVar32._10_5_;
            auVar48[8] = auVar2[4];
            auVar48._0_8_ = auVar2._0_8_;
            auVar48._9_6_ = auVar40._9_6_;
            auVar69._7_8_ = 0;
            auVar69._0_7_ = auVar48._8_7_;
            Var61 = CONCAT81(SUB158(auVar69 << 0x40,7),auVar2[3]);
            auVar85._9_6_ = 0;
            auVar85._0_9_ = Var61;
            auVar70._1_10_ = SUB1510(auVar85 << 0x30,5);
            auVar70[0] = auVar2[2];
            auVar86._11_4_ = 0;
            auVar86._0_11_ = auVar70;
            auVar56[2] = auVar2[1];
            auVar56._0_2_ = auVar2._0_2_;
            auVar56._3_12_ = SUB1512(auVar86 << 0x20,3);
            auVar101 = auVar2 & _DAT_004a7340;
            sWork[0x81] = auVar101[0] + '0';
            sWork[0x83] = auVar101[1] + '0';
            sWork[0x85] = auVar101[2] + '0';
            sWork[0x87] = auVar101[3] + '0';
            sWork[0x89] = auVar101[4] + '0';
            sWork[0x8b] = auVar101[5] + '0';
            sWork[0x8d] = auVar101[6] + '0';
            sWork[0x8f] = auVar101[7] + '0';
            sWork[0x91] = auVar101[8] + '0';
            sWork[0x93] = auVar101[9] + '0';
            sWork[0x95] = auVar101[10] + '0';
            sWork[0x97] = auVar101[0xb] + '0';
            sWork[0x99] = auVar101[0xc] + '0';
            sWork[0x9b] = auVar101[0xd] + '0';
            sWork[0x9d] = auVar101[0xe] + '0';
            sWork[0x9f] = auVar101[0xf] + '0';
            sWork[0x80] = (char)((auVar2._0_2_ & 0xff) >> 4) + '0';
            sWork[0x82] = (char)(auVar56._2_2_ >> 4) + '0';
            sWork[0x84] = (char)(auVar70._0_2_ >> 4) + '0';
            sWork[0x86] = (char)((ushort)Var61 >> 4) + '0';
            sWork[0x88] = (char)(auVar48._8_2_ >> 4) + '0';
            sWork[0x8a] = (char)(auVar32._10_2_ >> 4) + '0';
            sWork[0x8c] = (char)(auVar16._12_2_ >> 4) + '0';
            sWork[0x8e] = (auVar2[7] >> 4) + 0x30;
            sWork[0x90] = (auVar2[8] >> 4) + 0x30;
            sWork[0x92] = (auVar2[9] >> 4) + 0x30;
            sWork[0x94] = (auVar2[10] >> 4) + 0x30;
            sWork[0x96] = (auVar2[0xb] >> 4) + 0x30;
            sWork[0x98] = (auVar2[0xc] >> 4) + 0x30;
            sWork[0x9a] = (auVar2[0xd] >> 4) + 0x30;
            sWork[0x9c] = (auVar2[0xe] >> 4) + 0x30;
            sWork[0x9e] = (auVar2[0xf] >> 4) + 0x30;
            if (5 < uVar93) {
              auVar2 = *(undefined1 (*) [16])(sSrc + 0x50);
              auVar9[0xd] = 0;
              auVar9._0_13_ = auVar2._0_13_;
              auVar9[0xe] = auVar2[7];
              auVar17[0xc] = auVar2[6];
              auVar17._0_12_ = auVar2._0_12_;
              auVar17._13_2_ = auVar9._13_2_;
              auVar25[0xb] = 0;
              auVar25._0_11_ = auVar2._0_11_;
              auVar25._12_3_ = auVar17._12_3_;
              auVar33[10] = auVar2[5];
              auVar33._0_10_ = auVar2._0_10_;
              auVar33._11_4_ = auVar25._11_4_;
              auVar41[9] = 0;
              auVar41._0_9_ = auVar2._0_9_;
              auVar41._10_5_ = auVar33._10_5_;
              auVar49[8] = auVar2[4];
              auVar49._0_8_ = auVar2._0_8_;
              auVar49._9_6_ = auVar41._9_6_;
              auVar71._7_8_ = 0;
              auVar71._0_7_ = auVar49._8_7_;
              Var61 = CONCAT81(SUB158(auVar71 << 0x40,7),auVar2[3]);
              auVar87._9_6_ = 0;
              auVar87._0_9_ = Var61;
              auVar72._1_10_ = SUB1510(auVar87 << 0x30,5);
              auVar72[0] = auVar2[2];
              auVar88._11_4_ = 0;
              auVar88._0_11_ = auVar72;
              auVar57[2] = auVar2[1];
              auVar57._0_2_ = auVar2._0_2_;
              auVar57._3_12_ = SUB1512(auVar88 << 0x20,3);
              auVar101 = auVar2 & _DAT_004a7340;
              sWork[0xa1] = auVar101[0] + '0';
              sWork[0xa3] = auVar101[1] + '0';
              sWork[0xa5] = auVar101[2] + '0';
              sWork[0xa7] = auVar101[3] + '0';
              sWork[0xa9] = auVar101[4] + '0';
              sWork[0xab] = auVar101[5] + '0';
              sWork[0xad] = auVar101[6] + '0';
              sWork[0xaf] = auVar101[7] + '0';
              sWork[0xb1] = auVar101[8] + '0';
              sWork[0xb3] = auVar101[9] + '0';
              sWork[0xb5] = auVar101[10] + '0';
              sWork[0xb7] = auVar101[0xb] + '0';
              sWork[0xb9] = auVar101[0xc] + '0';
              sWork[0xbb] = auVar101[0xd] + '0';
              sWork[0xbd] = auVar101[0xe] + '0';
              sWork[0xbf] = auVar101[0xf] + '0';
              sWork[0xa0] = (char)((auVar2._0_2_ & 0xff) >> 4) + '0';
              sWork[0xa2] = (char)(auVar57._2_2_ >> 4) + '0';
              sWork[0xa4] = (char)(auVar72._0_2_ >> 4) + '0';
              sWork[0xa6] = (char)((ushort)Var61 >> 4) + '0';
              sWork[0xa8] = (char)(auVar49._8_2_ >> 4) + '0';
              sWork[0xaa] = (char)(auVar33._10_2_ >> 4) + '0';
              sWork[0xac] = (char)(auVar17._12_2_ >> 4) + '0';
              sWork[0xae] = (auVar2[7] >> 4) + 0x30;
              sWork[0xb0] = (auVar2[8] >> 4) + 0x30;
              sWork[0xb2] = (auVar2[9] >> 4) + 0x30;
              sWork[0xb4] = (auVar2[10] >> 4) + 0x30;
              sWork[0xb6] = (auVar2[0xb] >> 4) + 0x30;
              sWork[0xb8] = (auVar2[0xc] >> 4) + 0x30;
              sWork[0xba] = (auVar2[0xd] >> 4) + 0x30;
              sWork[0xbc] = (auVar2[0xe] >> 4) + 0x30;
              sWork[0xbe] = (auVar2[0xf] >> 4) + 0x30;
              if (6 < uVar93) {
                auVar2 = *(undefined1 (*) [16])(sSrc + 0x60);
                auVar10[0xd] = 0;
                auVar10._0_13_ = auVar2._0_13_;
                auVar10[0xe] = auVar2[7];
                auVar18[0xc] = auVar2[6];
                auVar18._0_12_ = auVar2._0_12_;
                auVar18._13_2_ = auVar10._13_2_;
                auVar26[0xb] = 0;
                auVar26._0_11_ = auVar2._0_11_;
                auVar26._12_3_ = auVar18._12_3_;
                auVar34[10] = auVar2[5];
                auVar34._0_10_ = auVar2._0_10_;
                auVar34._11_4_ = auVar26._11_4_;
                auVar42[9] = 0;
                auVar42._0_9_ = auVar2._0_9_;
                auVar42._10_5_ = auVar34._10_5_;
                auVar50[8] = auVar2[4];
                auVar50._0_8_ = auVar2._0_8_;
                auVar50._9_6_ = auVar42._9_6_;
                auVar73._7_8_ = 0;
                auVar73._0_7_ = auVar50._8_7_;
                Var61 = CONCAT81(SUB158(auVar73 << 0x40,7),auVar2[3]);
                auVar89._9_6_ = 0;
                auVar89._0_9_ = Var61;
                auVar74._1_10_ = SUB1510(auVar89 << 0x30,5);
                auVar74[0] = auVar2[2];
                auVar90._11_4_ = 0;
                auVar90._0_11_ = auVar74;
                auVar58[2] = auVar2[1];
                auVar58._0_2_ = auVar2._0_2_;
                auVar58._3_12_ = SUB1512(auVar90 << 0x20,3);
                auVar101 = auVar2 & _DAT_004a7340;
                sWork[0xc1] = auVar101[0] + '0';
                sWork[0xc3] = auVar101[1] + '0';
                sWork[0xc5] = auVar101[2] + '0';
                sWork[199] = auVar101[3] + '0';
                sWork[0xc9] = auVar101[4] + '0';
                sWork[0xcb] = auVar101[5] + '0';
                sWork[0xcd] = auVar101[6] + '0';
                sWork[0xcf] = auVar101[7] + '0';
                sWork[0xd1] = auVar101[8] + '0';
                sWork[0xd3] = auVar101[9] + '0';
                sWork[0xd5] = auVar101[10] + '0';
                sWork[0xd7] = auVar101[0xb] + '0';
                sWork[0xd9] = auVar101[0xc] + '0';
                sWork[0xdb] = auVar101[0xd] + '0';
                sWork[0xdd] = auVar101[0xe] + '0';
                sWork[0xdf] = auVar101[0xf] + '0';
                sWork[0xc0] = (char)((auVar2._0_2_ & 0xff) >> 4) + '0';
                sWork[0xc2] = (char)(auVar58._2_2_ >> 4) + '0';
                sWork[0xc4] = (char)(auVar74._0_2_ >> 4) + '0';
                sWork[0xc6] = (char)((ushort)Var61 >> 4) + '0';
                sWork[200] = (char)(auVar50._8_2_ >> 4) + '0';
                sWork[0xca] = (char)(auVar34._10_2_ >> 4) + '0';
                sWork[0xcc] = (char)(auVar18._12_2_ >> 4) + '0';
                sWork[0xce] = (auVar2[7] >> 4) + 0x30;
                sWork[0xd0] = (auVar2[8] >> 4) + 0x30;
                sWork[0xd2] = (auVar2[9] >> 4) + 0x30;
                sWork[0xd4] = (auVar2[10] >> 4) + 0x30;
                sWork[0xd6] = (auVar2[0xb] >> 4) + 0x30;
                sWork[0xd8] = (auVar2[0xc] >> 4) + 0x30;
                sWork[0xda] = (auVar2[0xd] >> 4) + 0x30;
                sWork[0xdc] = (auVar2[0xe] >> 4) + 0x30;
                sWork[0xde] = (auVar2[0xf] >> 4) + 0x30;
                if (7 < uVar93) {
                  auVar2 = *(undefined1 (*) [16])(sSrc + 0x70);
                  auVar101 = _DAT_004a7340 & auVar2;
                  auVar11[0xd] = 0;
                  auVar11._0_13_ = auVar2._0_13_;
                  auVar11[0xe] = auVar2[7];
                  auVar19[0xc] = auVar2[6];
                  auVar19._0_12_ = auVar2._0_12_;
                  auVar19._13_2_ = auVar11._13_2_;
                  auVar27[0xb] = 0;
                  auVar27._0_11_ = auVar2._0_11_;
                  auVar27._12_3_ = auVar19._12_3_;
                  auVar35[10] = auVar2[5];
                  auVar35._0_10_ = auVar2._0_10_;
                  auVar35._11_4_ = auVar27._11_4_;
                  auVar43[9] = 0;
                  auVar43._0_9_ = auVar2._0_9_;
                  auVar43._10_5_ = auVar35._10_5_;
                  auVar51[8] = auVar2[4];
                  auVar51._0_8_ = auVar2._0_8_;
                  auVar51._9_6_ = auVar43._9_6_;
                  auVar75._7_8_ = 0;
                  auVar75._0_7_ = auVar51._8_7_;
                  Var61 = CONCAT81(SUB158(auVar75 << 0x40,7),auVar2[3]);
                  auVar91._9_6_ = 0;
                  auVar91._0_9_ = Var61;
                  auVar76._1_10_ = SUB1510(auVar91 << 0x30,5);
                  auVar76[0] = auVar2[2];
                  auVar92._11_4_ = 0;
                  auVar92._0_11_ = auVar76;
                  auVar59[2] = auVar2[1];
                  auVar59._0_2_ = auVar2._0_2_;
                  auVar59._3_12_ = SUB1512(auVar92 << 0x20,3);
                  sWork[0xe1] = auVar101[0] + '0';
                  sWork[0xe3] = auVar101[1] + '0';
                  sWork[0xe5] = auVar101[2] + '0';
                  sWork[0xe7] = auVar101[3] + '0';
                  sWork[0xe9] = auVar101[4] + '0';
                  sWork[0xeb] = auVar101[5] + '0';
                  sWork[0xed] = auVar101[6] + '0';
                  sWork[0xef] = auVar101[7] + '0';
                  sWork[0xf1] = auVar101[8] + '0';
                  sWork[0xf3] = auVar101[9] + '0';
                  sWork[0xf5] = auVar101[10] + '0';
                  sWork[0xf7] = auVar101[0xb] + '0';
                  sWork[0xf9] = auVar101[0xc] + '0';
                  sWork[0xfb] = auVar101[0xd] + '0';
                  sWork[0xfd] = auVar101[0xe] + '0';
                  sWork[0xff] = auVar101[0xf] + '0';
                  sWork[0xe0] = (char)((auVar2._0_2_ & 0xff) >> 4) + '0';
                  sWork[0xe2] = (char)(auVar59._2_2_ >> 4) + '0';
                  sWork[0xe4] = (char)(auVar76._0_2_ >> 4) + '0';
                  sWork[0xe6] = (char)((ushort)Var61 >> 4) + '0';
                  sWork[0xe8] = (char)(auVar51._8_2_ >> 4) + '0';
                  sWork[0xea] = (char)(auVar35._10_2_ >> 4) + '0';
                  sWork[0xec] = (char)(auVar19._12_2_ >> 4) + '0';
                  sWork[0xee] = (auVar2[7] >> 4) + 0x30;
                  sWork[0xf0] = (auVar2[8] >> 4) + 0x30;
                  sWork[0xf2] = (auVar2[9] >> 4) + 0x30;
                  sWork[0xf4] = (auVar2[10] >> 4) + 0x30;
                  sWork[0xf6] = (auVar2[0xb] >> 4) + 0x30;
                  sWork[0xf8] = (auVar2[0xc] >> 4) + 0x30;
                  sWork[0xfa] = (auVar2[0xd] >> 4) + 0x30;
                  sWork[0xfc] = (auVar2[0xe] >> 4) + 0x30;
                  sWork[0xfe] = (auVar2[0xf] >> 4) + 0x30;
                }
              }
            }
          }
        }
      }
    }
    iVar96 = uVar93 * 0x20;
    if (uVar99 != uVar97) goto LAB_00429ef3;
  }
  __n = (size_t)(int)(uVar97 * 2);
LAB_00429f40:
  if (!bVar100) {
    memcpy(sDst,sWork,__n);
    return uVar97;
  }
  memcpy(sDst,sWork + 1,__n);
  return uVar97;
}



// WARNING: Unknown calling convention

int AsciiToBcd(uchar *sSrc,uchar *sDst,int nLng)

{
  char cVar1;
  char cVar2;
  long lVar3;
  size_t sVar4;
  byte unaff_BL;
  byte bVar5;
  char *pcVar6;
  byte unaff_R13B;
  int iVar7;
  char sWorkSrc [256];
  char sWorkDst [256];
  
  pcVar6 = sWorkSrc;
  for (lVar3 = 0x20; lVar3 != 0; lVar3 = lVar3 + -1) {
    *(undefined8 *)pcVar6 = 0x3030303030303030;
    pcVar6 = (char *)((long)pcVar6 + 8);
  }
  pcVar6 = sWorkDst;
  for (lVar3 = 0x20; lVar3 != 0; lVar3 = lVar3 + -1) {
    pcVar6[0] = '\0';
    pcVar6[1] = '\0';
    pcVar6[2] = '\0';
    pcVar6[3] = '\0';
    pcVar6[4] = '\0';
    pcVar6[5] = '\0';
    pcVar6[6] = '\0';
    pcVar6[7] = '\0';
    pcVar6 = pcVar6 + 8;
  }
  if ((nLng & 1U) == 0) {
    memcpy(sWorkSrc,sSrc,(long)nLng);
  }
  else {
    sVar4 = (size_t)nLng;
    nLng = nLng + 1;
    memcpy(sWorkSrc + 1,sSrc,sVar4);
  }
  if (nLng < 1) {
    sVar4 = 0;
    iVar7 = 0;
  }
  else {
    lVar3 = 0;
    do {
      cVar1 = sWorkSrc[lVar3 * 2];
      if ((byte)(cVar1 - 0x30U) < 10) {
        unaff_R13B = cVar1 << 4;
LAB_0042a017:
        cVar2 = sWorkSrc[lVar3 * 2 + 1];
      }
      else {
        if (5 < (byte)(cVar1 + 0xbfU)) goto LAB_0042a017;
        cVar2 = sWorkSrc[lVar3 * 2 + 1];
        unaff_R13B = cVar1 * '\x10' + 0x90;
      }
      bVar5 = cVar2 - 0x30U;
      if ((9 < (byte)(cVar2 - 0x30U)) && (bVar5 = unaff_BL, (byte)(cVar2 + 0xbfU) < 6)) {
        bVar5 = cVar2 - 0x37;
      }
      sWorkDst[lVar3] = bVar5 | unaff_R13B;
      lVar3 = lVar3 + 1;
      unaff_BL = bVar5;
    } while (lVar3 != (ulong)(nLng - 1) + 1);
    iVar7 = nLng >> 1;
    sVar4 = (size_t)iVar7;
  }
  memcpy(sDst,sWorkDst,sVar4);
  return iVar7;
}



// WARNING: Unknown calling convention

void AsciiToEbcdic(uchar *sSrc,uchar *sDst,int nLng)

{
  long lVar1;
  
  if (0 < nLng) {
    lVar1 = 0;
    do {
      sDst[lVar1] = abAsciiEbcdic[sSrc[lVar1]];
      lVar1 = lVar1 + 1;
    } while ((int)lVar1 < nLng);
  }
  return;
}



// WARNING: Unknown calling convention

void EbcdicToAscii(uchar *sSrc,uchar *sDst,int nLng)

{
  long lVar1;
  
  if (0 < nLng) {
    lVar1 = 0;
    do {
      sDst[lVar1] = abEbcdicAscii[sSrc[lVar1]];
      lVar1 = lVar1 + 1;
    } while ((int)lVar1 < nLng);
  }
  return;
}



int SetBit(char *sBitMap,int nBitNbr)

{
  byte bVar1;
  int iVar2;
  int iVar3;
  
  iVar3 = nBitNbr + -1;
  iVar2 = nBitNbr + 6;
  if (-1 < iVar3) {
    iVar2 = iVar3;
  }
  bVar1 = (byte)(iVar3 >> 0x1f);
  sBitMap[iVar2 >> 3] =
       sBitMap[iVar2 >> 3] |
       (byte)(0x80 >> (((char)iVar3 + (bVar1 >> 5) & 7) - (bVar1 >> 5) & 0x1f));
  return 0;
}



int ClearBit(char *sBitMap,int nBitNbr)

{
  byte bVar1;
  int iVar2;
  int iVar3;
  
  iVar3 = nBitNbr + -1;
  iVar2 = nBitNbr + 6;
  if (-1 < iVar3) {
    iVar2 = iVar3;
  }
  bVar1 = (byte)(iVar3 >> 0x1f);
  sBitMap[iVar2 >> 3] =
       sBitMap[iVar2 >> 3] &
       ~(byte)(0x80 >> (((char)iVar3 + (bVar1 >> 5) & 7) - (bVar1 >> 5) & 0x1f));
  return 0;
}



int CheckBit(char *cPtr,int nBitNbr)

{
  byte bVar1;
  int iVar2;
  
  iVar2 = nBitNbr + 7;
  if (-1 < nBitNbr) {
    iVar2 = nBitNbr;
  }
  bVar1 = (byte)(nBitNbr >> 0x1f);
  return (int)cPtr[iVar2 >> 3] >> (((bVar1 >> 5) - ((char)nBitNbr + (bVar1 >> 5) & 7)) + 7 & 0x1f) &
         1;
}



// WARNING: Unknown calling convention

int FieldPresent(char *cPtr,int nFldNbr)

{
  int iVar1;
  
  iVar1 = CheckBit(cPtr,nFldNbr + -1);
  return iVar1;
}



// WARNING: Unknown calling convention

int ClearAllBits(char *sBitMap)

{
  sBitMap[0] = '\0';
  sBitMap[1] = '\0';
  sBitMap[2] = '\0';
  sBitMap[3] = '\0';
  sBitMap[4] = '\0';
  sBitMap[5] = '\0';
  sBitMap[6] = '\0';
  sBitMap[7] = '\0';
  sBitMap[8] = '\0';
  sBitMap[9] = '\0';
  sBitMap[10] = '\0';
  sBitMap[0xb] = '\0';
  sBitMap[0xc] = '\0';
  sBitMap[0xd] = '\0';
  sBitMap[0xe] = '\0';
  sBitMap[0xf] = '\0';
  return 0;
}



// WARNING: Unknown calling convention

void szcpy(uchar *sDst,uchar *sSrc,int nLen)

{
  void *pvVar1;
  
  pvVar1 = memcpy(sDst,sSrc,(long)nLen);
  *(undefined1 *)((long)pvVar1 + (long)nLen) = 0;
  return;
}



// WARNING: Unknown calling convention

char * RightAdjust(char *sSrc,int nLen)

{
  size_t sVar1;
  long lVar2;
  char *pcVar3;
  char sDst [256];
  
  pcVar3 = sDst;
  for (lVar2 = 0x20; lVar2 != 0; lVar2 = lVar2 + -1) {
    *(undefined8 *)pcVar3 = 0x3030303030303030;
    pcVar3 = (char *)((long)pcVar3 + 8);
  }
  sVar1 = strlen(sSrc);
  memcpy(sDst + ((long)nLen - sVar1),sSrc,sVar1 + 1);
  return sDst;
}



// WARNING: Unknown calling convention

char compute_LRC(char *buffer,int lg)

{
  byte bVar1;
  long lVar2;
  
  trace_event("Start compute_LRC()",5);
  if (lg < 1) {
    bVar1 = 0x7f;
  }
  else {
    lVar2 = 0;
    bVar1 = 0xff;
    do {
      bVar1 = bVar1 ^ buffer[lVar2];
      lVar2 = lVar2 + 1;
    } while ((int)lVar2 < lg);
    bVar1 = bVar1 & 0x7f;
  }
  trace_event("End   compute_LRC()",5);
  return bVar1;
}



// WARNING: Unknown calling convention

int check_LRC(char *Frame,int Frame_Length)

{
  char cVar1;
  int iVar2;
  
  trace_event("Start check_LRC()",5);
  if (1 < Frame_Length) {
    cVar1 = compute_LRC(Frame,Frame_Length + -1);
    if (Frame[(long)Frame_Length + -1] == cVar1) {
      trace_event("End   check_LRC(OK)",5);
      iVar2 = 0;
    }
    else {
      trace_event("End   check_LRC(NOK)",5);
      iVar2 = -1;
    }
    return iVar2;
  }
  trace_event("End   check_LRC(NOK)",5);
  return 1;
}



// WARNING: Unknown calling convention

char ComputeLrc(uchar *sSrc,int nSrcLng)

{
  byte bVar1;
  uint uVar2;
  byte *pbVar3;
  uint uVar4;
  uint uVar5;
  uint uVar6;
  undefined1 (*pauVar7) [16];
  undefined1 auVar8 [16];
  byte local_28;
  
  if (nSrcLng < 1) {
    bVar1 = 0;
  }
  else {
    uVar2 = -(int)sSrc & 0xf;
    if ((uint)nSrcLng < uVar2) {
      uVar2 = nSrcLng;
    }
    uVar4 = nSrcLng;
    if (((uint)nSrcLng < 0x14) || (uVar4 = uVar2, uVar2 != 0)) {
      uVar2 = 0;
      bVar1 = 0;
      pbVar3 = sSrc;
      do {
        uVar2 = uVar2 + 1;
        bVar1 = bVar1 ^ *pbVar3;
        pbVar3 = pbVar3 + 1;
      } while (uVar2 != uVar4);
      if (nSrcLng == uVar2) {
        return bVar1;
      }
    }
    else {
      uVar4 = 0;
      uVar2 = 0;
      bVar1 = 0;
    }
    uVar5 = nSrcLng - uVar4 >> 4;
    if (uVar5 != 0) {
      auVar8 = (undefined1  [16])0x0;
      pauVar7 = (undefined1 (*) [16])(sSrc + uVar4);
      uVar6 = 0;
      do {
        uVar6 = uVar6 + 1;
        auVar8 = auVar8 ^ *pauVar7;
        pauVar7 = pauVar7 + 1;
      } while (uVar6 < uVar5);
      uVar2 = uVar2 + uVar5 * 0x10;
      auVar8 = auVar8 ^ auVar8 >> 0x40;
      auVar8 = auVar8 ^ auVar8 >> 0x20;
      auVar8 = auVar8 ^ auVar8 >> 0x10;
      local_28 = auVar8[1] ^ auVar8[0];
      bVar1 = bVar1 ^ local_28;
      if (nSrcLng - uVar4 == uVar5 * 0x10) {
        return bVar1;
      }
    }
    bVar1 = bVar1 ^ sSrc[(int)uVar2];
    if ((int)(uVar2 + 1) < nSrcLng) {
      bVar1 = bVar1 ^ sSrc[(int)(uVar2 + 1)];
      if ((int)(uVar2 + 2) < nSrcLng) {
        bVar1 = bVar1 ^ sSrc[(int)(uVar2 + 2)];
        if ((int)(uVar2 + 3) < nSrcLng) {
          bVar1 = bVar1 ^ sSrc[(int)(uVar2 + 3)];
          if ((int)(uVar2 + 4) < nSrcLng) {
            bVar1 = bVar1 ^ sSrc[(int)(uVar2 + 4)];
            if ((int)(uVar2 + 5) < nSrcLng) {
              bVar1 = bVar1 ^ sSrc[(int)(uVar2 + 5)];
              if ((int)(uVar2 + 6) < nSrcLng) {
                bVar1 = bVar1 ^ sSrc[(int)(uVar2 + 6)];
                if ((int)(uVar2 + 7) < nSrcLng) {
                  bVar1 = bVar1 ^ sSrc[(int)(uVar2 + 7)];
                  if ((int)(uVar2 + 8) < nSrcLng) {
                    bVar1 = bVar1 ^ sSrc[(int)(uVar2 + 8)];
                    if ((int)(uVar2 + 9) < nSrcLng) {
                      bVar1 = bVar1 ^ sSrc[(int)(uVar2 + 9)];
                      if ((int)(uVar2 + 10) < nSrcLng) {
                        bVar1 = bVar1 ^ sSrc[(int)(uVar2 + 10)];
                        if ((int)(uVar2 + 0xb) < nSrcLng) {
                          bVar1 = bVar1 ^ sSrc[(int)(uVar2 + 0xb)];
                          if ((int)(uVar2 + 0xc) < nSrcLng) {
                            bVar1 = bVar1 ^ sSrc[(int)(uVar2 + 0xc)];
                            if ((int)(uVar2 + 0xd) < nSrcLng) {
                              if ((int)(uVar2 + 0xe) < nSrcLng) {
                                return bVar1 ^ sSrc[(int)(uVar2 + 0xd)] ^ sSrc[(int)(uVar2 + 0xe)];
                              }
                              return bVar1 ^ sSrc[(int)(uVar2 + 0xd)];
                            }
                          }
                        }
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    }
  }
  return bVar1;
}



// WARNING: Unknown calling convention

int getlrc(char *buf_ptr,int nLen)

{
  uint uVar1;
  byte *pbVar2;
  uint uVar3;
  uint uVar4;
  uint uVar5;
  uint uVar6;
  uint uVar7;
  undefined1 (*pauVar8) [16];
  undefined1 auVar9 [16];
  byte local_28;
  
  pbVar2 = (byte *)(buf_ptr + 1);
  uVar6 = 1;
  if (0 < nLen) {
    uVar6 = nLen;
  }
  getlrc::lrc = *buf_ptr;
  uVar1 = -(int)pbVar2 & 0xf;
  if (uVar6 < uVar1) {
    uVar1 = uVar6;
  }
  uVar5 = uVar6;
  if ((uVar6 < 0x16) || (uVar5 = uVar1, uVar1 != 0)) {
    uVar1 = 0;
    do {
      uVar1 = uVar1 + 1;
      getlrc::lrc = getlrc::lrc ^ *pbVar2;
      pbVar2 = pbVar2 + 1;
    } while (uVar1 != uVar5);
    if (uVar6 == uVar1) goto LAB_0042a6e5;
  }
  else {
    uVar5 = 0;
    uVar1 = 0;
  }
  uVar7 = uVar6 - uVar5 >> 4;
  uVar4 = uVar7 * 0x10;
  if (uVar7 != 0) {
    auVar9 = (undefined1  [16])0x0;
    pauVar8 = (undefined1 (*) [16])(buf_ptr + (ulong)uVar5 + 1);
    uVar3 = 0;
    do {
      uVar3 = uVar3 + 1;
      auVar9 = auVar9 ^ *pauVar8;
      pauVar8 = pauVar8 + 1;
    } while (uVar3 < uVar7);
    uVar1 = uVar1 + uVar4;
    auVar9 = auVar9 ^ auVar9 >> 0x40;
    auVar9 = auVar9 ^ auVar9 >> 0x20;
    auVar9 = auVar9 ^ auVar9 >> 0x10;
    local_28 = auVar9[1] ^ auVar9[0];
    getlrc::lrc = local_28 ^ getlrc::lrc;
    pbVar2 = pbVar2 + uVar4;
    if (uVar6 - uVar5 == uVar4) goto LAB_0042a6e5;
  }
  getlrc::lrc = getlrc::lrc ^ *pbVar2;
  if ((((((int)(uVar1 + 1) < nLen) &&
        (getlrc::lrc = getlrc::lrc ^ pbVar2[1], (int)(uVar1 + 2) < nLen)) &&
       (getlrc::lrc = getlrc::lrc ^ pbVar2[2], (int)(uVar1 + 3) < nLen)) &&
      ((((getlrc::lrc = getlrc::lrc ^ pbVar2[3], (int)(uVar1 + 4) < nLen &&
         (getlrc::lrc = getlrc::lrc ^ pbVar2[4], (int)(uVar1 + 5) < nLen)) &&
        ((getlrc::lrc = getlrc::lrc ^ pbVar2[5], (int)(uVar1 + 6) < nLen &&
         ((getlrc::lrc = getlrc::lrc ^ pbVar2[6], (int)(uVar1 + 7) < nLen &&
          (getlrc::lrc = getlrc::lrc ^ pbVar2[7], (int)(uVar1 + 8) < nLen)))))) &&
       (getlrc::lrc = getlrc::lrc ^ pbVar2[8], (int)(uVar1 + 9) < nLen)))) &&
     ((((getlrc::lrc = getlrc::lrc ^ pbVar2[9], (int)(uVar1 + 10) < nLen &&
        (getlrc::lrc = getlrc::lrc ^ pbVar2[10], (int)(uVar1 + 0xb) < nLen)) &&
       (getlrc::lrc = getlrc::lrc ^ pbVar2[0xb], (int)(uVar1 + 0xc) < nLen)) &&
      ((getlrc::lrc = getlrc::lrc ^ pbVar2[0xc], (int)(uVar1 + 0xd) < nLen &&
       (getlrc::lrc = getlrc::lrc ^ pbVar2[0xd], (int)(uVar1 + 0xe) < nLen)))))) {
    getlrc::lrc = getlrc::lrc ^ pbVar2[0xe];
  }
LAB_0042a6e5:
  return (int)getlrc::lrc;
}



// WARNING: Unknown calling convention

int convert_827bit(char *msg,int nLen)

{
  ulong uVar1;
  uint uVar2;
  uint uVar3;
  int iVar4;
  long lVar5;
  uint uVar6;
  
  trace_event("Start convert_827bit()",5);
  if (0 < nLen) {
    uVar2 = -(int)msg & 0xf;
    if ((uint)nLen < uVar2) {
      uVar2 = nLen;
    }
    uVar3 = nLen;
    if (((uint)nLen < 0x11) || (uVar3 = uVar2, uVar2 != 0)) {
      *msg = *msg & 0x7f;
      if (uVar3 < 2) {
        iVar4 = 1;
      }
      else {
        msg[1] = msg[1] & 0x7f;
        if (uVar3 < 3) {
          iVar4 = 2;
        }
        else {
          msg[2] = msg[2] & 0x7f;
          if (uVar3 < 4) {
            iVar4 = 3;
          }
          else {
            msg[3] = msg[3] & 0x7f;
            if (uVar3 < 5) {
              iVar4 = 4;
            }
            else {
              msg[4] = msg[4] & 0x7f;
              if (uVar3 < 6) {
                iVar4 = 5;
              }
              else {
                msg[5] = msg[5] & 0x7f;
                if (uVar3 < 7) {
                  iVar4 = 6;
                }
                else {
                  msg[6] = msg[6] & 0x7f;
                  if (uVar3 < 8) {
                    iVar4 = 7;
                  }
                  else {
                    msg[7] = msg[7] & 0x7f;
                    if (uVar3 < 9) {
                      iVar4 = 8;
                    }
                    else {
                      msg[8] = msg[8] & 0x7f;
                      if (uVar3 < 10) {
                        iVar4 = 9;
                      }
                      else {
                        msg[9] = msg[9] & 0x7f;
                        if (uVar3 < 0xb) {
                          iVar4 = 10;
                        }
                        else {
                          msg[10] = msg[10] & 0x7f;
                          if (uVar3 < 0xc) {
                            iVar4 = 0xb;
                          }
                          else {
                            msg[0xb] = msg[0xb] & 0x7f;
                            if (uVar3 < 0xd) {
                              iVar4 = 0xc;
                            }
                            else {
                              msg[0xc] = msg[0xc] & 0x7f;
                              if (uVar3 < 0xe) {
                                iVar4 = 0xd;
                              }
                              else {
                                msg[0xd] = msg[0xd] & 0x7f;
                                if (uVar3 < 0xf) {
                                  iVar4 = 0xe;
                                }
                                else {
                                  msg[0xe] = msg[0xe] & 0x7f;
                                  if (uVar3 < 0x10) {
                                    iVar4 = 0xf;
                                  }
                                  else {
                                    msg[0xf] = msg[0xf] & 0x7f;
                                    iVar4 = 0x10;
                                  }
                                }
                              }
                            }
                          }
                        }
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
      if (nLen == uVar3) goto LAB_0042a93e;
    }
    else {
      uVar3 = 0;
      iVar4 = 0;
    }
    uVar2 = nLen - uVar3 >> 4;
    if (uVar2 != 0) {
      uVar6 = 0;
      lVar5 = 0;
      do {
        uVar1 = *(ulong *)((long)(msg + lVar5 + (ulong)uVar3) + 8);
        uVar6 = uVar6 + 1;
        *(ulong *)(msg + lVar5 + (ulong)uVar3) =
             *(ulong *)(msg + lVar5 + (ulong)uVar3) & 0x7f7f7f7f7f7f7f7f;
        *(ulong *)((long)(msg + lVar5 + (ulong)uVar3) + 8) = uVar1 & 0x7f7f7f7f7f7f7f7f;
        lVar5 = lVar5 + 0x10;
      } while (uVar6 < uVar2);
      iVar4 = iVar4 + uVar2 * 0x10;
      if (nLen - uVar3 == uVar2 * 0x10) goto LAB_0042a93e;
    }
    msg[iVar4] = msg[iVar4] & 0x7f;
    if (iVar4 + 1 < nLen) {
      msg[iVar4 + 1] = msg[iVar4 + 1] & 0x7f;
      if (iVar4 + 2 < nLen) {
        msg[iVar4 + 2] = msg[iVar4 + 2] & 0x7f;
        if (iVar4 + 3 < nLen) {
          msg[iVar4 + 3] = msg[iVar4 + 3] & 0x7f;
          if (iVar4 + 4 < nLen) {
            msg[iVar4 + 4] = msg[iVar4 + 4] & 0x7f;
            if (iVar4 + 5 < nLen) {
              msg[iVar4 + 5] = msg[iVar4 + 5] & 0x7f;
              if (iVar4 + 6 < nLen) {
                msg[iVar4 + 6] = msg[iVar4 + 6] & 0x7f;
                if (iVar4 + 7 < nLen) {
                  msg[iVar4 + 7] = msg[iVar4 + 7] & 0x7f;
                  if (iVar4 + 8 < nLen) {
                    msg[iVar4 + 8] = msg[iVar4 + 8] & 0x7f;
                    if (iVar4 + 9 < nLen) {
                      msg[iVar4 + 9] = msg[iVar4 + 9] & 0x7f;
                      if (iVar4 + 10 < nLen) {
                        msg[iVar4 + 10] = msg[iVar4 + 10] & 0x7f;
                        if (iVar4 + 0xb < nLen) {
                          msg[iVar4 + 0xb] = msg[iVar4 + 0xb] & 0x7f;
                          if (iVar4 + 0xc < nLen) {
                            msg[iVar4 + 0xc] = msg[iVar4 + 0xc] & 0x7f;
                            if (iVar4 + 0xd < nLen) {
                              msg[iVar4 + 0xd] = msg[iVar4 + 0xd] & 0x7f;
                              if (iVar4 + 0xe < nLen) {
                                msg[iVar4 + 0xe] = msg[iVar4 + 0xe] & 0x7f;
                              }
                            }
                          }
                        }
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    }
  }
LAB_0042a93e:
  trace_event("End   convert_827bit(OK)",5);
  return 0;
}



// WARNING: Unknown calling convention

int trim(char *sData,int nLen)

{
  long lVar1;
  int iVar2;
  long lVar3;
  uint uVar4;
  uint uVar5;
  uint *puVar6;
  uint *puVar7;
  char *pcVar8;
  bool bVar9;
  char sWork [4096];
  
  lVar1 = 0;
  pcVar8 = sWork;
  for (lVar3 = 0x200; lVar3 != 0; lVar3 = lVar3 + -1) {
    *(undefined8 *)pcVar8 = 0;
    pcVar8 = (char *)((long)pcVar8 + 8);
  }
  iVar2 = 0;
  puVar7 = (uint *)sWork;
  if (0 < nLen) {
    do {
      if (sData[lVar1] != ' ') {
        lVar3 = (long)iVar2;
        iVar2 = iVar2 + 1;
        sWork[lVar3] = sData[lVar1];
      }
      lVar1 = lVar1 + 1;
      puVar7 = (uint *)sWork;
    } while ((int)lVar1 < nLen);
  }
  do {
    puVar6 = puVar7;
    uVar4 = *puVar6 + 0xfefefeff & ~*puVar6;
    uVar5 = uVar4 & 0x80808080;
    puVar7 = puVar6 + 1;
  } while (uVar5 == 0);
  bVar9 = (uVar4 & 0x8080) == 0;
  if (bVar9) {
    uVar5 = uVar5 >> 0x10;
  }
  if (bVar9) {
    puVar7 = (uint *)((long)puVar6 + 6);
  }
  lVar1 = (long)puVar7 + ((-3 - (ulong)CARRY1((byte)uVar5,(byte)uVar5)) - (long)sWork);
  memcpy(sData,sWork,lVar1 + 1);
  return (int)lVar1;
}



// WARNING: Unknown calling convention

void replace(char *sStr,char cOrg,char cDest,int nLen)

{
  char *pcVar1;
  
  if (0 < nLen) {
    pcVar1 = sStr + (ulong)(nLen - 1) + 1;
    do {
      while (*sStr == cOrg) {
        *sStr = cDest;
        sStr = sStr + 1;
        if (sStr == pcVar1) {
          return;
        }
      }
      sStr = sStr + 1;
    } while (sStr != pcVar1);
  }
  return;
}



// WARNING: Unknown calling convention

void Hexa_To_Binaire_len(char *target,char *source,int len)

{
  char cVar1;
  byte bVar2;
  long lVar3;
  byte bVar4;
  byte bVar5;
  
  lVar3 = 0;
  if (0 < len) {
    do {
      cVar1 = source[lVar3 * 2];
      bVar2 = source[lVar3 * 2 + 1];
      bVar4 = 0xa0;
      if ((((cVar1 != 'A') && (bVar4 = 0xb0, cVar1 != 'B')) && (bVar4 = 0xc0, cVar1 != 'C')) &&
         ((bVar4 = 0xd0, cVar1 != 'D' && (bVar4 = 0xe0, cVar1 != 'E')))) {
        bVar4 = 0xf0;
        if (cVar1 != 'F') {
          bVar4 = cVar1 << 4;
        }
      }
      bVar5 = 10;
      if (((bVar2 != 0x41) && (bVar5 = 0xb, bVar2 != 0x42)) &&
         ((bVar5 = 0xc, bVar2 != 0x43 &&
          (((bVar5 = 0xd, bVar2 != 0x44 && (bVar5 = 0xe, bVar2 != 0x45)) &&
           (bVar5 = bVar2 & 0xf, bVar2 == 0x46)))))) {
        bVar5 = 0xf;
      }
      target[lVar3] = bVar4 | bVar5;
      lVar3 = lVar3 + 1;
    } while ((int)lVar3 < len);
  }
  return;
}



// WARNING: Unknown calling convention

void IsoIccToTlv(char *szBufferIn,int nLengthIn,char *szBufferOut,int *nLengthOut)

{
  int iVar1;
  uint uVar2;
  uint uVar3;
  long lVar4;
  uint *puVar5;
  uint *puVar6;
  bool bVar7;
  byte bVar8;
  int icLen;
  char sLine [500];
  TSTagIso icInfo;
  char icTmp [4096];
  TSTlvPrivate tlvInfo;
  
  bVar8 = 0;
  trace_event("Start IsoIccToTlv(/** MAN_23072018 **/)",5);
  puVar5 = (uint *)icTmp;
  for (lVar4 = 0x200; lVar4 != 0; lVar4 = lVar4 + -1) {
    puVar5[0] = 0;
    puVar5[1] = 0;
    puVar5 = puVar5 + (ulong)bVar8 * -4 + 2;
  }
  InitIsoIcTag(&icInfo);
  InitTlvPrivate(&tlvInfo);
  AnalyseIsoIc(szBufferIn,nLengthIn,&icInfo);
  sprintf(sLine,"[%d]",(ulong)(uint)nLengthIn);
  trace_event(sLine,0);
  fwrite("Start IsoIccToTlv=========\n,",1,0x1c,stderr);
  fprintf(stderr,"[%d][%s]\n",(ulong)(uint)nLengthIn,szBufferIn);
  fwrite("End=========\n",1,0xd,stderr);
  puVar5 = (uint *)icTmp;
  for (lVar4 = 0x200; lVar4 != 0; lVar4 = lVar4 + -1) {
    puVar5[0] = 0;
    puVar5[1] = 0;
    puVar5 = puVar5 + (ulong)bVar8 * -4 + 2;
  }
  iVar1 = GetIsoIcTag("5700",&icInfo,icTmp,&icLen);
  if (iVar1 == 0) {
    PutTlvPrivate("C35",&tlvInfo,icTmp,icLen);
  }
  puVar5 = (uint *)icTmp;
  for (lVar4 = 0x200; lVar4 != 0; lVar4 = lVar4 + -1) {
    puVar5[0] = 0;
    puVar5[1] = 0;
    puVar5 = puVar5 + (ulong)bVar8 * -4 + 2;
  }
  iVar1 = GetIsoIcTag("9F27",&icInfo,icTmp,&icLen);
  if ((iVar1 == 0) && (iVar1 = PutTlvPrivate("C02",&tlvInfo,icTmp,icLen), iVar1 != 0)) {
    trace_event("Erreur PutTlvPrivate [CHIP_CRYPTO_INFO_DATA_TAG]",0);
  }
  puVar5 = (uint *)icTmp;
  for (lVar4 = 0x200; lVar4 != 0; lVar4 = lVar4 + -1) {
    puVar5[0] = 0;
    puVar5[1] = 0;
    puVar5 = puVar5 + (ulong)bVar8 * -4 + 2;
  }
  iVar1 = GetIsoIcTag("8200",&icInfo,icTmp,&icLen);
  if (iVar1 == 0) {
    PutTlvPrivate("C12",&tlvInfo,icTmp,icLen);
  }
  puVar5 = (uint *)icTmp;
  for (lVar4 = 0x200; lVar4 != 0; lVar4 = lVar4 + -1) {
    puVar5[0] = 0;
    puVar5[1] = 0;
    puVar5 = puVar5 + (ulong)bVar8 * -4 + 2;
  }
  iVar1 = GetIsoIcTag("4F00",&icInfo,icTmp,&icLen);
  if (iVar1 == 0) {
    PutTlvPrivate("C16",&tlvInfo,icTmp,icLen);
  }
  puVar5 = (uint *)icTmp;
  for (lVar4 = 0x200; lVar4 != 0; lVar4 = lVar4 + -1) {
    puVar5[0] = 0;
    puVar5[1] = 0;
    puVar5 = puVar5 + (ulong)bVar8 * -4 + 2;
  }
  iVar1 = GetIsoIcTag("9F33",&icInfo,icTmp,&icLen);
  if (iVar1 == 0) {
    PutTlvPrivate("C14",&tlvInfo,icTmp,icLen);
  }
  puVar5 = (uint *)icTmp;
  for (lVar4 = 0x200; lVar4 != 0; lVar4 = lVar4 + -1) {
    puVar5[0] = 0;
    puVar5[1] = 0;
    puVar5 = puVar5 + (ulong)bVar8 * -4 + 2;
  }
  iVar1 = GetIsoIcTag("9100",&icInfo,icTmp,&icLen);
  if (iVar1 == 0) {
    PutTlvPrivate("C23",&tlvInfo,icTmp,icLen);
  }
  puVar5 = (uint *)icTmp;
  for (lVar4 = 0x200; lVar4 != 0; lVar4 = lVar4 + -1) {
    puVar5[0] = 0;
    puVar5[1] = 0;
    puVar5 = puVar5 + (ulong)bVar8 * -4 + 2;
  }
  iVar1 = GetIsoIcTag("9500",&icInfo,icTmp,&icLen);
  if (iVar1 == 0) {
    sprintf(sLine,"while adding the ISO_TAG_TVR icLen =%d, icTmp =%s",(ulong)(uint)icLen,icTmp);
    trace_event(sLine,5);
    PutTlvPrivate("C10",&tlvInfo,icTmp,icLen);
  }
  puVar5 = (uint *)icTmp;
  for (lVar4 = 0x200; lVar4 != 0; lVar4 = lVar4 + -1) {
    puVar5[0] = 0;
    puVar5[1] = 0;
    puVar5 = puVar5 + (ulong)bVar8 * -4 + 2;
  }
  iVar1 = GetIsoIcTag("9A00",&icInfo,icTmp,&icLen);
  if (iVar1 == 0) {
    PutTlvPrivate("C04",&tlvInfo,icTmp,icLen);
  }
  puVar5 = (uint *)icTmp;
  for (lVar4 = 0x200; lVar4 != 0; lVar4 = lVar4 + -1) {
    puVar5[0] = 0;
    puVar5[1] = 0;
    puVar5 = puVar5 + (ulong)bVar8 * -4 + 2;
  }
  iVar1 = GetIsoIcTag("9C00",&icInfo,icTmp,&icLen);
  if (iVar1 == 0) {
    PutTlvPrivate("C05",&tlvInfo,icTmp,icLen);
  }
  puVar5 = (uint *)icTmp;
  for (lVar4 = 0x200; lVar4 != 0; lVar4 = lVar4 + -1) {
    puVar5[0] = 0;
    puVar5[1] = 0;
    puVar5 = puVar5 + (ulong)bVar8 * -4 + 2;
  }
  iVar1 = GetIsoIcTag("5F2A",&icInfo,icTmp,&icLen);
  if (iVar1 == 0) {
    PutTlvPrivate("C03",&tlvInfo,icTmp,icLen);
  }
  puVar5 = (uint *)icTmp;
  for (lVar4 = 0x200; lVar4 != 0; lVar4 = lVar4 + -1) {
    puVar5[0] = 0;
    puVar5[1] = 0;
    puVar5 = puVar5 + (ulong)bVar8 * -4 + 2;
  }
  iVar1 = GetIsoIcTag("9F02",&icInfo,icTmp,&icLen);
  if (iVar1 == 0) {
    PutTlvPrivate("C06",&tlvInfo,icTmp,icLen);
  }
  puVar5 = (uint *)icTmp;
  for (lVar4 = 0x200; lVar4 != 0; lVar4 = lVar4 + -1) {
    puVar5[0] = 0;
    puVar5[1] = 0;
    puVar5 = puVar5 + (ulong)bVar8 * -4 + 2;
  }
  iVar1 = GetIsoIcTag("9F03",&icInfo,icTmp,&icLen);
  if (iVar1 == 0) {
    PutTlvPrivate("C21",&tlvInfo,icTmp,icLen);
  }
  puVar5 = (uint *)icTmp;
  for (lVar4 = 0x200; lVar4 != 0; lVar4 = lVar4 + -1) {
    puVar5[0] = 0;
    puVar5[1] = 0;
    puVar5 = puVar5 + (ulong)bVar8 * -4 + 2;
  }
  iVar1 = GetIsoIcTag("9F10",&icInfo,icTmp,&icLen);
  if (iVar1 == 0) {
    PutTlvPrivate("C20",&tlvInfo,icTmp,icLen);
  }
  puVar5 = (uint *)icTmp;
  for (lVar4 = 0x200; lVar4 != 0; lVar4 = lVar4 + -1) {
    puVar5[0] = 0;
    puVar5[1] = 0;
    puVar5 = puVar5 + (ulong)bVar8 * -4 + 2;
  }
  iVar1 = GetIsoIcTag("9F1A",&icInfo,icTmp,&icLen);
  if (iVar1 == 0) {
    PutTlvPrivate("C11",&tlvInfo,icTmp,icLen);
  }
  puVar5 = (uint *)icTmp;
  for (lVar4 = 0x200; lVar4 != 0; lVar4 = lVar4 + -1) {
    puVar5[0] = 0;
    puVar5[1] = 0;
    puVar5 = puVar5 + (ulong)bVar8 * -4 + 2;
  }
  iVar1 = GetIsoIcTag("9F1E",&icInfo,icTmp,&icLen);
  puVar5 = (uint *)icTmp;
  if (iVar1 == 0) {
    do {
      puVar6 = puVar5;
      uVar2 = *puVar6 + 0xfefefeff & ~*puVar6;
      uVar3 = uVar2 & 0x80808080;
      puVar5 = puVar6 + 1;
    } while (uVar3 == 0);
    bVar7 = (uVar2 & 0x8080) == 0;
    if (bVar7) {
      uVar3 = uVar3 >> 0x10;
    }
    if (bVar7) {
      puVar5 = (uint *)((long)puVar6 + 6);
    }
    sprintf(sLine,">>icLen =%d, icTmp =[%X],[%d], ISO_TAG_IFD_SERIAL_NUM=[%s]",(ulong)(uint)icLen,
            icTmp,(char *)((long)puVar5 +
                          ((-3 - (ulong)CARRY1((byte)uVar3,(byte)uVar3)) - (long)icTmp)),
            &DAT_004a7626);
    trace_event(sLine,5);
    PutTlvPrivate("C18",&tlvInfo,icTmp,icLen);
  }
  puVar5 = (uint *)icTmp;
  for (lVar4 = 0x200; lVar4 != 0; lVar4 = lVar4 + -1) {
    puVar5[0] = 0;
    puVar5[1] = 0;
    puVar5 = puVar5 + (ulong)bVar8 * -4 + 2;
  }
  iVar1 = GetIsoIcTag("9F26",&icInfo,icTmp,&icLen);
  if (iVar1 == 0) {
    PutTlvPrivate("C01",&tlvInfo,icTmp,icLen);
  }
  puVar5 = (uint *)icTmp;
  for (lVar4 = 0x200; lVar4 != 0; lVar4 = lVar4 + -1) {
    puVar5[0] = 0;
    puVar5[1] = 0;
    puVar5 = puVar5 + (ulong)bVar8 * -4 + 2;
  }
  iVar1 = GetIsoIcTag("9F34",&icInfo,icTmp,&icLen);
  if (iVar1 == 0) {
    PutTlvPrivate("C13",&tlvInfo,icTmp,icLen);
  }
  puVar5 = (uint *)icTmp;
  for (lVar4 = 0x200; lVar4 != 0; lVar4 = lVar4 + -1) {
    puVar5[0] = 0;
    puVar5[1] = 0;
    puVar5 = puVar5 + (ulong)bVar8 * -4 + 2;
  }
  iVar1 = GetIsoIcTag("9F35",&icInfo,icTmp,&icLen);
  if (iVar1 == 0) {
    PutTlvPrivate("C15",&tlvInfo,icTmp,icLen);
  }
  puVar5 = (uint *)icTmp;
  for (lVar4 = 0x200; lVar4 != 0; lVar4 = lVar4 + -1) {
    puVar5[0] = 0;
    puVar5[1] = 0;
    puVar5 = puVar5 + (ulong)bVar8 * -4 + 2;
  }
  iVar1 = GetIsoIcTag("9F36",&icInfo,icTmp,&icLen);
  if (iVar1 == 0) {
    PutTlvPrivate("C07",&tlvInfo,icTmp,icLen);
  }
  puVar5 = (uint *)icTmp;
  for (lVar4 = 0x200; lVar4 != 0; lVar4 = lVar4 + -1) {
    puVar5[0] = 0;
    puVar5[1] = 0;
    puVar5 = puVar5 + (ulong)bVar8 * -4 + 2;
  }
  iVar1 = GetIsoIcTag("9F37",&icInfo,icTmp,&icLen);
  if (iVar1 == 0) {
    PutTlvPrivate("C08",&tlvInfo,icTmp,icLen);
  }
  puVar5 = (uint *)icTmp;
  for (lVar4 = 0x200; lVar4 != 0; lVar4 = lVar4 + -1) {
    puVar5[0] = 0;
    puVar5[1] = 0;
    puVar5 = puVar5 + (ulong)bVar8 * -4 + 2;
  }
  iVar1 = GetIsoIcTag("9F41",&icInfo,icTmp,&icLen);
  if (iVar1 == 0) {
    PutTlvPrivate("C19",&tlvInfo,icTmp,icLen);
  }
  puVar5 = (uint *)icTmp;
  for (lVar4 = 0x200; lVar4 != 0; lVar4 = lVar4 + -1) {
    puVar5[0] = 0;
    puVar5[1] = 0;
    puVar5 = puVar5 + (ulong)bVar8 * -4 + 2;
  }
  iVar1 = GetIsoIcTag("9F53",&icInfo,icTmp,&icLen);
  if (iVar1 == 0) {
    PutTlvPrivate("C09",&tlvInfo,icTmp,icLen);
  }
  puVar5 = (uint *)icTmp;
  for (lVar4 = 0x200; lVar4 != 0; lVar4 = lVar4 + -1) {
    puVar5[0] = 0;
    puVar5[1] = 0;
    puVar5 = puVar5 + (ulong)bVar8 * -4 + 2;
  }
  iVar1 = GetIsoIcTag("9F54",&icInfo,icTmp,&icLen);
  if (iVar1 == 0) {
    PutTlvPrivate("C24",&tlvInfo,icTmp,icLen);
  }
  puVar5 = (uint *)icTmp;
  for (lVar4 = 0x200; lVar4 != 0; lVar4 = lVar4 + -1) {
    puVar5[0] = 0;
    puVar5[1] = 0;
    puVar5 = puVar5 + (ulong)bVar8 * -4 + 2;
  }
  iVar1 = GetIsoIcTag("7100",&icInfo,icTmp,&icLen);
  if (iVar1 == 0) {
    PutTlvPrivate("C32",&tlvInfo,icTmp,icLen);
  }
  puVar5 = (uint *)icTmp;
  for (lVar4 = 0x200; lVar4 != 0; lVar4 = lVar4 + -1) {
    puVar5[0] = 0;
    puVar5[1] = 0;
    puVar5 = puVar5 + (ulong)bVar8 * -4 + 2;
  }
  iVar1 = GetIsoIcTag("7200",&icInfo,icTmp,&icLen);
  if (iVar1 == 0) {
    PutTlvPrivate("C33",&tlvInfo,icTmp,icLen);
  }
  puVar5 = (uint *)icTmp;
  for (lVar4 = 0x200; lVar4 != 0; lVar4 = lVar4 + -1) {
    puVar5[0] = 0;
    puVar5[1] = 0;
    puVar5 = puVar5 + (ulong)bVar8 * -4 + 2;
  }
  iVar1 = GetIsoIcTag("9600",&icInfo,icTmp,&icLen);
  if (iVar1 == 0) {
    PutTlvPrivate("C25",&tlvInfo,icTmp,icLen);
  }
  puVar5 = (uint *)icTmp;
  for (lVar4 = 0x200; lVar4 != 0; lVar4 = lVar4 + -1) {
    puVar5[0] = 0;
    puVar5[1] = 0;
    puVar5 = puVar5 + (ulong)bVar8 * -4 + 2;
  }
  iVar1 = GetIsoIcTag("5F34",&icInfo,icTmp,&icLen);
  if (iVar1 == 0) {
    PutTlvPrivate("C71",&tlvInfo,icTmp,icLen);
  }
  puVar5 = (uint *)icTmp;
  for (lVar4 = 0x200; lVar4 != 0; lVar4 = lVar4 + -1) {
    puVar5[0] = 0;
    puVar5[1] = 0;
    puVar5 = puVar5 + (ulong)bVar8 * -4 + 2;
  }
  iVar1 = GetIsoIcTag("5F24",&icInfo,icTmp,&icLen);
  if (iVar1 == 0) {
    PutTlvPrivate("C73",&tlvInfo,icTmp,icLen);
  }
  puVar5 = (uint *)icTmp;
  for (lVar4 = 0x200; lVar4 != 0; lVar4 = lVar4 + -1) {
    puVar5[0] = 0;
    puVar5[1] = 0;
    puVar5 = puVar5 + (ulong)bVar8 * -4 + 2;
  }
  iVar1 = GetIsoIcTag("9F06",&icInfo,icTmp,&icLen);
  if ((iVar1 == 0) && (iVar1 = PutTlvPrivate("C26",&tlvInfo,icTmp,icLen), iVar1 != 0)) {
    trace_event("Erreur PutTlvPrivate",0);
  }
  puVar5 = (uint *)icTmp;
  for (lVar4 = 0x200; lVar4 != 0; lVar4 = lVar4 + -1) {
    puVar5[0] = 0;
    puVar5[1] = 0;
    puVar5 = puVar5 + (ulong)bVar8 * -4 + 2;
  }
  iVar1 = GetIsoIcTag("5700",&icInfo,icTmp,&icLen);
  if ((iVar1 == 0) && (iVar1 = PutTlvPrivate("C27",&tlvInfo,icTmp,icLen), iVar1 != 0)) {
    trace_event("Erreur PutTlvPrivate",0);
  }
  puVar5 = (uint *)icTmp;
  for (lVar4 = 0x200; lVar4 != 0; lVar4 = lVar4 + -1) {
    puVar5[0] = 0;
    puVar5[1] = 0;
    puVar5 = puVar5 + (ulong)bVar8 * -4 + 2;
  }
  iVar1 = GetIsoIcTag("5A00",&icInfo,icTmp,&icLen);
  if ((iVar1 == 0) && (iVar1 = PutTlvPrivate("C28",&tlvInfo,icTmp,icLen), iVar1 != 0)) {
    trace_event("Erreur PutTlvPrivate",0);
  }
  puVar5 = (uint *)icTmp;
  for (lVar4 = 0x200; lVar4 != 0; lVar4 = lVar4 + -1) {
    puVar5[0] = 0;
    puVar5[1] = 0;
    puVar5 = puVar5 + (ulong)bVar8 * -4 + 2;
  }
  iVar1 = GetIsoIcTag("9F12",&icInfo,icTmp,&icLen);
  if ((iVar1 == 0) && (iVar1 = PutTlvPrivate("C29",&tlvInfo,icTmp,icLen), iVar1 != 0)) {
    trace_event("Erreur PutTlvPrivate",0);
  }
  puVar5 = (uint *)icTmp;
  for (lVar4 = 0x200; lVar4 != 0; lVar4 = lVar4 + -1) {
    puVar5[0] = 0;
    puVar5[1] = 0;
    puVar5 = puVar5 + (ulong)bVar8 * -4 + 2;
  }
  iVar1 = GetIsoIcTag("8C00",&icInfo,icTmp,&icLen);
  if ((iVar1 == 0) && (iVar1 = PutTlvPrivate("C30",&tlvInfo,icTmp,icLen), iVar1 != 0)) {
    trace_event("Erreur PutTlvPrivate",0);
  }
  puVar5 = (uint *)icTmp;
  for (lVar4 = 0x200; lVar4 != 0; lVar4 = lVar4 + -1) {
    puVar5[0] = 0;
    puVar5[1] = 0;
    puVar5 = puVar5 + (ulong)bVar8 * -4 + 2;
  }
  iVar1 = GetIsoIcTag("5000",&icInfo,icTmp,&icLen);
  if ((iVar1 == 0) && (iVar1 = PutTlvPrivate("C31",&tlvInfo,icTmp,icLen), iVar1 != 0)) {
    trace_event("Erreur PutTlvPrivate",0);
  }
  puVar5 = (uint *)icTmp;
  for (lVar4 = 0x200; lVar4 != 0; lVar4 = lVar4 + -1) {
    puVar5[0] = 0;
    puVar5[1] = 0;
    puVar5 = puVar5 + (ulong)bVar8 * -4 + 2;
  }
  iVar1 = GetIsoIcTag("8400",&icInfo,icTmp,&icLen);
  if (iVar1 == 0) {
    PutTlvPrivate("C80",&tlvInfo,icTmp,icLen);
  }
  puVar5 = (uint *)icTmp;
  for (lVar4 = 0x200; lVar4 != 0; lVar4 = lVar4 + -1) {
    puVar5[0] = 0;
    puVar5[1] = 0;
    puVar5 = puVar5 + (ulong)bVar8 * -4 + 2;
  }
  iVar1 = GetIsoIcTag("9F07",&icInfo,icTmp,&icLen);
  if (iVar1 == 0) {
    PutTlvPrivate("C41",&tlvInfo,icTmp,icLen);
  }
  puVar5 = (uint *)icTmp;
  for (lVar4 = 0x200; lVar4 != 0; lVar4 = lVar4 + -1) {
    puVar5[0] = 0;
    puVar5[1] = 0;
    puVar5 = puVar5 + (ulong)bVar8 * -4 + 2;
  }
  iVar1 = GetIsoIcTag("9F09",&icInfo,icTmp,&icLen);
  if ((iVar1 == 0) && (iVar1 = PutTlvPrivate("C17",&tlvInfo,icTmp,icLen), iVar1 != 0)) {
    trace_event("Erreur PutTlvPrivate CHIP_APPLI_VER_TAG",0);
  }
  puVar5 = (uint *)icTmp;
  for (lVar4 = 0x200; lVar4 != 0; lVar4 = lVar4 + -1) {
    puVar5[0] = 0;
    puVar5[1] = 0;
    puVar5 = puVar5 + (ulong)bVar8 * -4 + 2;
  }
  iVar1 = GetIsoIcTag("9F1F",&icInfo,icTmp,&icLen);
  if ((iVar1 == 0) && (iVar1 = PutTlvPrivate("C72",&tlvInfo,icTmp,icLen), iVar1 != 0)) {
    trace_event("Erreur PutTlvPrivate CHIP_TAG_TRACK_1_DATA",0);
  }
  trace_event(" Befor GET ICCtoTLV CHIP_CARD_PROD_ID",5);
  puVar5 = (uint *)icTmp;
  for (lVar4 = 0x200; lVar4 != 0; lVar4 = lVar4 + -1) {
    puVar5[0] = 0;
    puVar5[1] = 0;
    puVar5 = puVar5 + (ulong)bVar8 * -4 + 2;
  }
  iVar1 = GetIsoIcTag("9F63",&icInfo,icTmp,&icLen);
  if (iVar1 == 0) {
    sprintf(sLine," ISO_TAG_CARD_PROD_ID icLen =%d, icTmp =%s ,ISO_TAG_CARD_PROD_ID[%s] ",
            (ulong)(uint)icLen,icTmp,&DAT_004a8e68);
    trace_event(sLine,5);
    iVar1 = PutTlvPrivate("C63",&tlvInfo,icTmp,icLen);
    if (iVar1 != 0) {
      trace_event("Erreur PutTlvPrivate CHIP_CARD_PROD_ID",0);
    }
    sprintf(sLine," CHIP_CARD_PROD_ID icLen =%d, icTmp =%s , CHIP_CARD_PROD_ID[%s] ",
            (ulong)(uint)icLen,icTmp,&DAT_004a8e6d);
    trace_event(sLine,5);
  }
  trace_event(" AFTER GET ICCtoTLV CHIP_CARD_PROD_ID",5);
  trace_event("CHIP_THIRD_PARTY_DATA",5);
  iVar1 = GetIsoIcTag("9F6E",&icInfo,icTmp,&icLen);
  if (iVar1 == 0) {
    iVar1 = PutTlvPrivate("C82",&tlvInfo,icTmp,icLen);
    if (iVar1 != 0) {
      trace_event("Erreur PutTlvPrivate CHIP_THIRD_PARTY_DATA",0);
    }
  }
  else {
    trace_event("CHIP_THIRD_PARTY_DATA NOT FOUND",5);
  }
  iVar1 = PrivateBuildTlv(szBufferOut,&tlvInfo);
  *nLengthOut = iVar1;
  trace_event("End   IsoIccToTlv()",5);
  return;
}



// WARNING: Unknown calling convention

int IsoToTlv(int nIndiceCtx,TSIsoInfo *isoInfo,TSTlvAutho *tlvInfo)

{
  int iVar1;
  int iVar2;
  uint uVar3;
  void *pvVar4;
  long lVar5;
  uint *puVar6;
  uint *puVar7;
  uint uVar8;
  char *pcVar9;
  size_t __n;
  ulong uVar10;
  bool bVar11;
  byte bVar12;
  int local_2a1c;
  char bBlockSize [3];
  char tagName [4];
  char sCurrency [4];
  int tmpFldLen;
  char bTraceAudit [4];
  int nLength;
  char sMti [5];
  char cBlockSize [5];
  char cTraceAudit [7];
  char sOrigAmounts [13];
  char sAmount [19];
  char sLine [250];
  char tmpField [999];
  char tmpData [999];
  char sTlvBuffer [4096];
  char tmp110 [4096];
  
  bVar12 = 0;
  trace_event("Start IsoToTlv (**) ",5);
  pcVar9 = sLine;
  for (lVar5 = 0x1f; lVar5 != 0; lVar5 = lVar5 + -1) {
    pcVar9[0] = '\0';
    pcVar9[1] = '\0';
    pcVar9[2] = '\0';
    pcVar9[3] = '\0';
    pcVar9[4] = '\0';
    pcVar9[5] = '\0';
    pcVar9[6] = '\0';
    pcVar9[7] = '\0';
    pcVar9 = pcVar9 + (ulong)bVar12 * -0x10 + 8;
  }
  uVar3 = isoInfo->nMsgType;
  sOrigAmounts[0] = '\0';
  sOrigAmounts[1] = '\0';
  sOrigAmounts[2] = '\0';
  sOrigAmounts[3] = '\0';
  sOrigAmounts[4] = '\0';
  sOrigAmounts[5] = '\0';
  sOrigAmounts[6] = '\0';
  sOrigAmounts[7] = '\0';
  sOrigAmounts[8] = '\0';
  sOrigAmounts[9] = '\0';
  sOrigAmounts[10] = '\0';
  sOrigAmounts[0xb] = '\0';
  sAmount[0x10] = '\0';
  sAmount[0x11] = '\0';
  sOrigAmounts[0xc] = '\0';
  sAmount[0] = '\0';
  sAmount[1] = '\0';
  sAmount[2] = '\0';
  sAmount[3] = '\0';
  sAmount[4] = '\0';
  sAmount[5] = '\0';
  sAmount[6] = '\0';
  sAmount[7] = '\0';
  sAmount[8] = '\0';
  sAmount[9] = '\0';
  sAmount[10] = '\0';
  sAmount[0xb] = '\0';
  sAmount[0xc] = '\0';
  sAmount[0xd] = '\0';
  sAmount[0xe] = '\0';
  sAmount[0xf] = '\0';
  pcVar9[0] = '\0';
  pcVar9[1] = '\0';
  pcVar9 = tmpField;
  for (lVar5 = 0x7c; lVar5 != 0; lVar5 = lVar5 + -1) {
    pcVar9[0] = '\0';
    pcVar9[1] = '\0';
    pcVar9[2] = '\0';
    pcVar9[3] = '\0';
    pcVar9[4] = '\0';
    pcVar9[5] = '\0';
    pcVar9[6] = '\0';
    pcVar9[7] = '\0';
    pcVar9 = pcVar9 + (ulong)bVar12 * -0x10 + 8;
  }
  sAmount[0x12] = '\0';
  sCurrency[0] = '\0';
  sCurrency[1] = '\0';
  sCurrency[2] = '\0';
  sCurrency[3] = '\0';
  sMti[0] = '\0';
  sMti[1] = '\0';
  sMti[2] = '\0';
  sMti[3] = '\0';
  sMti[4] = '\0';
  tagName[0] = '\0';
  tagName[1] = '\0';
  tagName[2] = '\0';
  tagName[3] = '\0';
  pcVar9[4] = '\0';
  pcVar9[5] = '\0';
  pcVar9[0] = '\0';
  pcVar9[1] = '\0';
  pcVar9[2] = '\0';
  pcVar9[3] = '\0';
  pcVar9[6] = '\0';
  puVar7 = (uint *)tmpData;
  for (lVar5 = 0x7c; lVar5 != 0; lVar5 = lVar5 + -1) {
    puVar7[0] = 0;
    puVar7[1] = 0;
    puVar7 = puVar7 + (ulong)bVar12 * -4 + 2;
  }
  *(undefined2 *)(puVar7 + 1) = 0;
  *puVar7 = 0;
  *(char *)((long)puVar7 + 6) = '\0';
  pcVar9 = sTlvBuffer;
  for (lVar5 = 0x200; lVar5 != 0; lVar5 = lVar5 + -1) {
    pcVar9[0] = '\0';
    pcVar9[1] = '\0';
    pcVar9[2] = '\0';
    pcVar9[3] = '\0';
    pcVar9[4] = '\0';
    pcVar9[5] = '\0';
    pcVar9[6] = '\0';
    pcVar9[7] = '\0';
    pcVar9 = pcVar9 + (ulong)bVar12 * -0x10 + 8;
  }
  sprintf(sMti,"%04d",(ulong)uVar3);
  PutTlvAutho("300",tlvInfo,sMti,4);
  uVar3 = 1;
LAB_0042bcc0:
  while( true ) {
    pcVar9 = tmpField;
    for (lVar5 = 0x7c; lVar5 != 0; lVar5 = lVar5 + -1) {
      pcVar9[0] = '\0';
      pcVar9[1] = '\0';
      pcVar9[2] = '\0';
      pcVar9[3] = '\0';
      pcVar9[4] = '\0';
      pcVar9[5] = '\0';
      pcVar9[6] = '\0';
      pcVar9[7] = '\0';
      pcVar9 = pcVar9 + (ulong)bVar12 * -0x10 + 8;
    }
    pcVar9[0] = '\0';
    pcVar9[1] = '\0';
    pcVar9[2] = '\0';
    pcVar9[3] = '\0';
    pcVar9[4] = '\0';
    pcVar9[5] = '\0';
    pcVar9[6] = '\0';
    puVar7 = (uint *)tmpData;
    for (lVar5 = 0x7c; lVar5 != 0; lVar5 = lVar5 + -1) {
      puVar7[0] = 0;
      puVar7[1] = 0;
      puVar7 = puVar7 + (ulong)bVar12 * -4 + 2;
    }
    *puVar7 = 0;
    *(undefined2 *)(puVar7 + 1) = 0;
    *(char *)((long)puVar7 + 6) = '\0';
    if (uVar3 != 0x2e) break;
    uVar3 = 0x2f;
    trace_event("--IsoToTlv () ISO_ADTNL_DATA_NATL",5);
    pcVar9 = tmpField;
    for (lVar5 = 0x7c; lVar5 != 0; lVar5 = lVar5 + -1) {
      pcVar9[0] = '\0';
      pcVar9[1] = '\0';
      pcVar9[2] = '\0';
      pcVar9[3] = '\0';
      pcVar9[4] = '\0';
      pcVar9[5] = '\0';
      pcVar9[6] = '\0';
      pcVar9[7] = '\0';
      pcVar9 = pcVar9 + (ulong)bVar12 * -0x10 + 8;
    }
    pcVar9[0] = '\0';
    pcVar9[1] = '\0';
    pcVar9[2] = '\0';
    pcVar9[3] = '\0';
    pcVar9[4] = '\0';
    pcVar9[5] = '\0';
    pcVar9[6] = '\0';
    GetIsoField(0x17,isoInfo,tmpField,&tmpFldLen);
    if ((isoInfo->nMsgType == 0x44c) && (iVar1 = memcmp(tmpField,&DAT_004a4df4,3), iVar1 == 0)) {
      pcVar9 = tmpField;
      for (lVar5 = 0x7c; lVar5 != 0; lVar5 = lVar5 + -1) {
        pcVar9[0] = '\0';
        pcVar9[1] = '\0';
        pcVar9[2] = '\0';
        pcVar9[3] = '\0';
        pcVar9[4] = '\0';
        pcVar9[5] = '\0';
        pcVar9[6] = '\0';
        pcVar9[7] = '\0';
        pcVar9 = pcVar9 + (ulong)bVar12 * -0x10 + 8;
      }
      pcVar9[0] = '\0';
      pcVar9[1] = '\0';
      pcVar9[2] = '\0';
      pcVar9[3] = '\0';
      pcVar9[4] = '\0';
      pcVar9[5] = '\0';
      pcVar9[6] = '\0';
      iVar1 = GetIsoField(0x2e,isoInfo,tmpField,&tmpFldLen);
      if (iVar1 == 0) {
        sprintf(sLine,"MEL25082015 ... F47=[%s]",tmpField);
        trace_event(sLine,4);
        PutTlvAutho("047",tlvInfo,tmpField,tmpFldLen);
      }
    }
  }
  if ((int)uVar3 < 0x2f) {
    if (uVar3 == 4) {
      uVar3 = 5;
      trace_event("--IsoToTlv () ISO_STLMNT_AMOUNT",5);
      sprintf(tagName,"%.3d",5);
      pcVar9 = tmpField;
      for (lVar5 = 0x7c; lVar5 != 0; lVar5 = lVar5 + -1) {
        pcVar9[0] = '\0';
        pcVar9[1] = '\0';
        pcVar9[2] = '\0';
        pcVar9[3] = '\0';
        pcVar9[4] = '\0';
        pcVar9[5] = '\0';
        pcVar9[6] = '\0';
        pcVar9[7] = '\0';
        pcVar9 = pcVar9 + (ulong)bVar12 * -0x10 + 8;
      }
      pcVar9[4] = '\0';
      pcVar9[5] = '\0';
      pcVar9[0] = '\0';
      pcVar9[1] = '\0';
      pcVar9[2] = '\0';
      pcVar9[3] = '\0';
      pcVar9[6] = '\0';
      iVar1 = GetIsoField(4,isoInfo,sAmount,&tmpFldLen);
      if (iVar1 == 0) {
        iVar1 = GetIsoField(0x31,isoInfo,sCurrency,&tmpFldLen);
        if (iVar1 == 0) {
          iVar1 = AdjustTlvAmount(nIndiceCtx,sAmount,sCurrency,tmpData);
          if (iVar1 != 0) {
            trace_event("Error AdjustTlvAmount(ISO_STLMNT_AMOUNT)",1);
            return -1;
          }
LAB_0042bde9:
          PutTlvAutho(tagName,tlvInfo,tmpData,0x12);
        }
      }
      goto LAB_0042bcc0;
    }
    if ((int)uVar3 < 5) {
      if (uVar3 == 2) {
        trace_event("--IsoToTlv () ISO_PROC_CODE",5);
        pcVar9 = tmpField;
        for (lVar5 = 0x7c; lVar5 != 0; lVar5 = lVar5 + -1) {
          pcVar9[0] = '\0';
          pcVar9[1] = '\0';
          pcVar9[2] = '\0';
          pcVar9[3] = '\0';
          pcVar9[4] = '\0';
          pcVar9[5] = '\0';
          pcVar9[6] = '\0';
          pcVar9[7] = '\0';
          pcVar9 = pcVar9 + (ulong)bVar12 * -0x10 + 8;
        }
        pcVar9[0] = '\0';
        pcVar9[1] = '\0';
        pcVar9[2] = '\0';
        pcVar9[3] = '\0';
        pcVar9[4] = '\0';
        pcVar9[5] = '\0';
        pcVar9[6] = '\0';
        iVar1 = GetIsoField(2,isoInfo,tmpField,&tmpFldLen);
        uVar3 = 3;
        if (iVar1 == 0) {
          sprintf(tmpData,"%.3s002%.2s",&DAT_004a8ed5,tmpField);
          sprintf(tmpData + 8,"%.3s002%.2s",&DAT_004a8ee5,tmpField + 2);
          sprintf(tmpData + 0x10,"%.3s002%.2s",&DAT_004a8ee9,tmpField + 4);
          sprintf(tagName,"%.3d",3);
          PutTlvAutho(tagName,tlvInfo,tmpData,0x18);
        }
        goto LAB_0042bcc0;
      }
      if (uVar3 == 3) {
        uVar3 = 4;
        trace_event("--IsoToTlv () ISO_TRANS_AMOUNT",5);
        sprintf(tagName,"%.3d",4);
        pcVar9 = tmpField;
        for (lVar5 = 0x7c; lVar5 != 0; lVar5 = lVar5 + -1) {
          pcVar9[0] = '\0';
          pcVar9[1] = '\0';
          pcVar9[2] = '\0';
          pcVar9[3] = '\0';
          pcVar9[4] = '\0';
          pcVar9[5] = '\0';
          pcVar9[6] = '\0';
          pcVar9[7] = '\0';
          pcVar9 = pcVar9 + (ulong)bVar12 * -0x10 + 8;
        }
        pcVar9[0] = '\0';
        pcVar9[1] = '\0';
        pcVar9[2] = '\0';
        pcVar9[3] = '\0';
        pcVar9[4] = '\0';
        pcVar9[5] = '\0';
        pcVar9[6] = '\0';
        iVar1 = GetIsoField(3,isoInfo,sAmount,&tmpFldLen);
        if (iVar1 == 0) {
          iVar1 = GetIsoField(0x30,isoInfo,sCurrency,&tmpFldLen);
          if (iVar1 == 0) {
            iVar1 = AdjustTlvAmount(nIndiceCtx,sAmount,sCurrency,tmpData);
            if (iVar1 != 0) {
              trace_event("Error AdjustTlvAmount(ISO_TRANS_AMOUNT)",1);
              return -1;
            }
            goto LAB_0042bde9;
          }
        }
        goto LAB_0042bcc0;
      }
    }
    else {
      if (uVar3 == 5) {
        uVar3 = 6;
        trace_event("--IsoToTlv () ISO_BILLING_AMOUNT",5);
        sprintf(tagName,"%.3d",6);
        pcVar9 = tmpField;
        for (lVar5 = 0x7c; lVar5 != 0; lVar5 = lVar5 + -1) {
          pcVar9[0] = '\0';
          pcVar9[1] = '\0';
          pcVar9[2] = '\0';
          pcVar9[3] = '\0';
          pcVar9[4] = '\0';
          pcVar9[5] = '\0';
          pcVar9[6] = '\0';
          pcVar9[7] = '\0';
          pcVar9 = pcVar9 + (ulong)bVar12 * -0x10 + 8;
        }
        pcVar9[0] = '\0';
        pcVar9[1] = '\0';
        pcVar9[2] = '\0';
        pcVar9[3] = '\0';
        pcVar9[4] = '\0';
        pcVar9[5] = '\0';
        pcVar9[6] = '\0';
        iVar1 = GetIsoField(5,isoInfo,sAmount,&tmpFldLen);
        if (iVar1 == 0) {
          iVar1 = GetIsoField(0x32,isoInfo,sCurrency,&tmpFldLen);
          if (iVar1 == 0) {
            iVar1 = AdjustTlvAmount(nIndiceCtx,sAmount,sCurrency,tmpData);
            if (iVar1 != 0) {
              trace_event("Error AdjustTlvAmount(ISO_BILLING_AMOUNT)",1);
              return -1;
            }
            goto LAB_0042bde9;
          }
        }
        goto LAB_0042bcc0;
      }
      if (uVar3 == 0x1d) {
        trace_event("--IsoToTlv () ISO_ORIGINAL_AMOUNTS",5);
        pcVar9 = tmpField;
        for (lVar5 = 0x7c; lVar5 != 0; lVar5 = lVar5 + -1) {
          pcVar9[0] = '\0';
          pcVar9[1] = '\0';
          pcVar9[2] = '\0';
          pcVar9[3] = '\0';
          pcVar9[4] = '\0';
          pcVar9[5] = '\0';
          pcVar9[6] = '\0';
          pcVar9[7] = '\0';
          pcVar9 = pcVar9 + (ulong)bVar12 * -0x10 + 8;
        }
        sOrigAmounts[0] = '\0';
        sOrigAmounts[1] = '\0';
        sOrigAmounts[2] = '\0';
        sOrigAmounts[3] = '\0';
        sOrigAmounts[4] = '\0';
        sOrigAmounts[5] = '\0';
        sOrigAmounts[6] = '\0';
        sOrigAmounts[7] = '\0';
        sOrigAmounts[8] = '\0';
        sOrigAmounts[9] = '\0';
        sOrigAmounts[10] = '\0';
        sOrigAmounts[0xb] = '\0';
        sOrigAmounts[0xc] = '\0';
        pcVar9[0] = '\0';
        pcVar9[1] = '\0';
        pcVar9[2] = '\0';
        pcVar9[3] = '\0';
        pcVar9[4] = '\0';
        pcVar9[5] = '\0';
        pcVar9[6] = '\0';
        iVar1 = GetIsoField(0x1d,isoInfo,tmpField,&tmpFldLen);
        uVar3 = 0x1e;
        if (iVar1 == 0) {
          sOrigAmounts[0] = tmpField[0];
          sOrigAmounts[1] = tmpField[1];
          sOrigAmounts[2] = tmpField[2];
          sOrigAmounts[3] = tmpField[3];
          sOrigAmounts[4] = tmpField[4];
          sOrigAmounts[5] = tmpField[5];
          sOrigAmounts[6] = tmpField[6];
          sOrigAmounts[7] = tmpField[7];
          sOrigAmounts[8] = tmpField[8];
          sOrigAmounts[9] = tmpField[9];
          sOrigAmounts[10] = tmpField[10];
          sOrigAmounts[0xb] = tmpField[0xb];
          iVar1 = GetIsoField(0x30,isoInfo,sCurrency,&tmpFldLen);
          if (iVar1 == 0) {
            iVar1 = AdjustTlvAmount(nIndiceCtx,sOrigAmounts,sCurrency,tmpData);
            if (iVar1 != 0) {
              trace_event("Error AdjustTlvAmount(ISO_ORIGINAL_AMOUNTS)",1);
              return -1;
            }
            PutTlvAutho("294",tlvInfo,tmpData,0x12);
          }
          sOrigAmounts[0] = tmpField[0xc];
          sOrigAmounts[1] = tmpField[0xd];
          sOrigAmounts[2] = tmpField[0xe];
          sOrigAmounts[3] = tmpField[0xf];
          sOrigAmounts[4] = tmpField[0x10];
          sOrigAmounts[5] = tmpField[0x11];
          sOrigAmounts[6] = tmpField[0x12];
          sOrigAmounts[7] = tmpField[0x13];
          sOrigAmounts[8] = tmpField[0x14];
          sOrigAmounts[9] = tmpField[0x15];
          sOrigAmounts[10] = tmpField[0x16];
          sOrigAmounts[0xb] = tmpField[0x17];
          iVar1 = GetIsoField(0x32,isoInfo,sCurrency,&tmpFldLen);
          uVar3 = 0x1e;
          if (iVar1 == 0) {
            iVar1 = AdjustTlvAmount(nIndiceCtx,sOrigAmounts,sCurrency,tmpData);
            if (iVar1 != 0) {
              trace_event("Error AdjustTlvAmount(ISO_ORIGINAL_AMOUNTS-ISO_BILLING_CRNCY)",1);
              return -1;
            }
            PutTlvAutho("295",tlvInfo,tmpData,0x12);
          }
        }
        goto LAB_0042bcc0;
      }
    }
  }
  else {
    if (uVar3 == 0x6f) {
      trace_event("--IsoToTlv () ISO_RESERVED_ISO_3",5);
      iVar1 = GetIsoField(0x6d,isoInfo,tmpField,&tmpFldLen);
      uVar3 = 0x70;
      if (iVar1 == 0) {
        PutTlvAutho("112",tlvInfo,tmpField,tmpFldLen);
      }
      goto LAB_0042bcc0;
    }
    if ((int)uVar3 < 0x70) {
      if (uVar3 == 0x36) {
        trace_event("--IsoToTlv () ISO_ICC_DATA",5);
        pcVar9 = tmpField;
        for (lVar5 = 0x7c; lVar5 != 0; lVar5 = lVar5 + -1) {
          pcVar9[0] = '\0';
          pcVar9[1] = '\0';
          pcVar9[2] = '\0';
          pcVar9[3] = '\0';
          pcVar9[4] = '\0';
          pcVar9[5] = '\0';
          pcVar9[6] = '\0';
          pcVar9[7] = '\0';
          pcVar9 = pcVar9 + (ulong)bVar12 * -0x10 + 8;
        }
        pcVar9[4] = '\0';
        pcVar9[5] = '\0';
        pcVar9[0] = '\0';
        pcVar9[1] = '\0';
        pcVar9[2] = '\0';
        pcVar9[3] = '\0';
        pcVar9[6] = '\0';
        iVar1 = GetIsoField(0x36,isoInfo,tmpField,&tmpFldLen);
        uVar3 = 0x37;
        if (iVar1 == 0) {
          IsoIccToTlv(tmpField,tmpFldLen,tmpData,&nLength);
          puVar7 = (uint *)tmpData;
          do {
            puVar6 = puVar7;
            uVar8 = *puVar6 + 0xfefefeff & ~*puVar6;
            uVar3 = uVar8 & 0x80808080;
            puVar7 = puVar6 + 1;
          } while (uVar3 == 0);
          bVar11 = (uVar8 & 0x8080) == 0;
          if (bVar11) {
            uVar3 = uVar3 >> 0x10;
          }
          if (bVar11) {
            puVar7 = (uint *)((long)puVar6 + 6);
          }
          sprintf(sLine,"ISO_ICC_DATA ... =nLength[%d]vs strlen(tmpData)[%d]",(ulong)(uint)nLength,
                  (char *)((long)puVar7 +
                          ((-3 - (ulong)CARRY1((byte)uVar3,(byte)uVar3)) - (long)tmpData)));
          trace_event(sLine,0);
          sprintf(tagName,"%.3d",0x37);
          puVar7 = (uint *)tmpData;
          do {
            puVar6 = puVar7;
            uVar8 = *puVar6 + 0xfefefeff & ~*puVar6;
            uVar3 = uVar8 & 0x80808080;
            puVar7 = puVar6 + 1;
          } while (uVar3 == 0);
          bVar11 = (uVar8 & 0x8080) == 0;
          if (bVar11) {
            uVar3 = uVar3 >> 0x10;
          }
          if (bVar11) {
            puVar7 = (uint *)((long)puVar6 + 6);
          }
          PutTlvAutho(tagName,tlvInfo,tmpData,
                      (((int)puVar7 + -3) - (uint)CARRY1((byte)uVar3,(byte)uVar3)) - (int)tmpData);
          uVar3 = 0x37;
        }
        goto LAB_0042bcc0;
      }
      if (uVar3 == 0x6d) {
        pcVar9 = tmpField;
        for (lVar5 = 0x7c; lVar5 != 0; lVar5 = lVar5 + -1) {
          pcVar9[0] = '\0';
          pcVar9[1] = '\0';
          pcVar9[2] = '\0';
          pcVar9[3] = '\0';
          pcVar9[4] = '\0';
          pcVar9[5] = '\0';
          pcVar9[6] = '\0';
          pcVar9[7] = '\0';
          pcVar9 = pcVar9 + (ulong)bVar12 * -0x10 + 8;
        }
        pcVar9[4] = '\0';
        pcVar9[5] = '\0';
        pcVar9[0] = '\0';
        pcVar9[1] = '\0';
        pcVar9[2] = '\0';
        pcVar9[3] = '\0';
        pcVar9[6] = '\0';
        pcVar9 = tmp110;
        for (lVar5 = 0x200; lVar5 != 0; lVar5 = lVar5 + -1) {
          pcVar9[0] = '\0';
          pcVar9[1] = '\0';
          pcVar9[2] = '\0';
          pcVar9[3] = '\0';
          pcVar9[4] = '\0';
          pcVar9[5] = '\0';
          pcVar9[6] = '\0';
          pcVar9[7] = '\0';
          pcVar9 = pcVar9 + (ulong)bVar12 * -0x10 + 8;
        }
        iVar1 = GetIsoField(0x6d,isoInfo,tmpField,&tmpFldLen);
        uVar3 = 0x6e;
        if (iVar1 == 0) {
          local_2a1c = 0;
          if (0 < tmpFldLen) {
            uVar10 = 0;
            do {
              trace_event("Inside the while..",5);
              iVar1 = (int)uVar10;
              cTraceAudit[4] = '\0';
              cTraceAudit[5] = '\0';
              cBlockSize[0] = '\0';
              cBlockSize[1] = '\0';
              cBlockSize[2] = '\0';
              cBlockSize[3] = '\0';
              bBlockSize[2] = '\0';
              cBlockSize[4] = '\0';
              cTraceAudit[0] = '\0';
              cTraceAudit[1] = '\0';
              cTraceAudit[2] = '\0';
              cTraceAudit[3] = '\0';
              cTraceAudit[6] = '\0';
              bBlockSize[0] = (char)*(undefined2 *)(tmpField + iVar1);
              bTraceAudit[2] = tmpField[(long)iVar1 + 4];
              bTraceAudit._0_2_ = *(undefined2 *)(tmpField + (long)iVar1 + 2);
              bTraceAudit[3] = '\0';
              sprintf(sLine,"--bBlockSize %s",bBlockSize);
              trace_event(sLine,4);
              if ((bBlockSize[0] & 0xf0U) == 0xf0) break;
              sprintf(sLine,"--bTraceAudit %s",bTraceAudit);
              trace_event(sLine,4);
              HexToAscii((uchar *)bBlockSize,(uchar *)cBlockSize,4);
              HexToAscii((uchar *)bTraceAudit,(uchar *)cTraceAudit,6);
              sprintf(sLine,"--cBlockSize %s",cBlockSize);
              trace_event(sLine,4);
              sprintf(sLine,"--cTraceAudit %s",cTraceAudit);
              trace_event(sLine,4);
              iVar2 = atoi(cBlockSize);
              uVar3 = iVar2 - 3;
              sprintf(sLine,"--BlockSize %d",(ulong)uVar3);
              trace_event(sLine,4);
              IsoIccToTlv(tmpField + (long)iVar1 + 5,uVar3,tmpData,&nLength);
              lVar5 = (long)local_2a1c;
              __n = (size_t)nLength;
              *(undefined4 *)(tmp110 + lVar5) = cTraceAudit._0_4_;
              *(undefined2 *)(tmp110 + lVar5 + 4) = cTraceAudit._4_2_;
              pvVar4 = memcpy(tmp110 + lVar5 + 6,tmpData,__n);
              tmp110[lVar5 + 6 + __n] = '?';
              sprintf(sLine,"--tmp110+6+k= %s",pvVar4);
              trace_event(sLine,4);
              local_2a1c = local_2a1c + 7 + nLength;
              uVar3 = iVar1 + 5 + uVar3;
              uVar10 = (ulong)uVar3;
              sprintf(sLine,"---k= %d");
              trace_event(sLine,4);
              sprintf(sLine,"---j= %d",uVar10);
              trace_event(sLine,4);
            } while ((int)uVar3 < tmpFldLen);
          }
          sprintf(tagName,"%.3d",0x70);
          PutTlvAutho(tagName,tlvInfo,tmp110,local_2a1c);
          uVar3 = 0x6e;
        }
        goto LAB_0042bcc0;
      }
    }
    else {
      if (uVar3 == 0x76) {
        iVar1 = GetIsoField(0x76,isoInfo,tmpField,&tmpFldLen);
        uVar3 = 0x77;
        if (iVar1 == 0) {
          PutTlvAutho("126",tlvInfo,tmpField,0x10);
        }
        goto LAB_0042bcc0;
      }
      if (uVar3 == 0x7d) {
        trace_event("--IsoToTlv () ISO_RESERVED_PRIVE_USAGE_5",5);
        iVar1 = GetIsoField(0x7d,isoInfo,tmpField,&tmpFldLen);
        uVar3 = 0x7e;
        if (iVar1 == 0) {
          sprintf(sLine,"Terminal Number Is %s",tmpField);
          trace_event(sLine,4);
          PutTlvAutho("041",tlvInfo,tmpField,tmpFldLen);
        }
        goto LAB_0042bcc0;
      }
    }
  }
  uVar8 = uVar3 + 1;
  sprintf(tagName,"%.3d",(ulong)uVar8);
  pcVar9 = tmpField;
  for (lVar5 = 0x7c; lVar5 != 0; lVar5 = lVar5 + -1) {
    pcVar9[0] = '\0';
    pcVar9[1] = '\0';
    pcVar9[2] = '\0';
    pcVar9[3] = '\0';
    pcVar9[4] = '\0';
    pcVar9[5] = '\0';
    pcVar9[6] = '\0';
    pcVar9[7] = '\0';
    pcVar9 = pcVar9 + (ulong)bVar12 * -0x10 + 8;
  }
  pcVar9[0] = '\0';
  pcVar9[1] = '\0';
  pcVar9[2] = '\0';
  pcVar9[3] = '\0';
  pcVar9[4] = '\0';
  pcVar9[5] = '\0';
  pcVar9[6] = '\0';
  iVar1 = GetIsoField(uVar3,isoInfo,tmpField,&tmpFldLen);
  if ((iVar1 == 0) && (PutTlvAutho(tagName,tlvInfo,tmpField,tmpFldLen), uVar3 == 0x34)) {
    PutTlvAutho("130",tlvInfo,tmpField + 0x26,0xf);
    uVar3 = uVar8;
  }
  else {
    uVar3 = uVar8;
    if (uVar8 == 0x80) {
      trace_event("--IsoToTlv () After Switch",5);
      AuthoBuildTlv(sTlvBuffer,tlvInfo);
      trace_event("--IsoToTlv () After AuthoBuildTlv",5);
      PrintTlvBuffer(sTlvBuffer);
      trace_event("--IsoToTlv () After PrintTlvBuffer",5);
      ValidateTlvData(sTlvBuffer);
      trace_event("End IsoToTlv ()",5);
      return 0;
    }
  }
  goto LAB_0042bcc0;
}



// WARNING: Unknown calling convention

void IccTlvToIso(char *szBufferIn,int nLengthIn,char *szBufferOut,int *nLengthOut)

{
  int iVar1;
  long lVar2;
  char *pcVar3;
  byte bVar4;
  int nLen;
  TSTagIso v_TagIso;
  char sIccBuffer [4096];
  char sWork [4096];
  char sLine [4096];
  TSTlvPrivate tlvInfo;
  
  bVar4 = 0;
  trace_event("Start IccTlvToIso()",5);
  InitIsoIcTag(&v_TagIso);
  pcVar3 = sIccBuffer;
  for (lVar2 = 0x200; lVar2 != 0; lVar2 = lVar2 + -1) {
    pcVar3[0] = '\0';
    pcVar3[1] = '\0';
    pcVar3[2] = '\0';
    pcVar3[3] = '\0';
    pcVar3[4] = '\0';
    pcVar3[5] = '\0';
    pcVar3[6] = '\0';
    pcVar3[7] = '\0';
    pcVar3 = pcVar3 + (ulong)bVar4 * -0x10 + 8;
  }
  InitTlvPrivate(&tlvInfo);
  AnalyseTlvPrivate(szBufferIn,nLengthIn,&tlvInfo);
  iVar1 = GetTlvPrivate("C82",&tlvInfo,sWork,&nLen);
  if (iVar1 == 0) {
    AddIsoIcTag("9F6E",&v_TagIso,sWork,nLen);
  }
  else {
    trace_event("ISO_THIRD_PARTY_DATA NOT FOUND",5);
  }
  iVar1 = GetTlvPrivate("C12",&tlvInfo,sWork,&nLen);
  if (iVar1 == 0) {
    AddIsoIcTag("8200",&v_TagIso,sWork,nLen);
  }
  iVar1 = GetTlvPrivate("C16",&tlvInfo,sWork,&nLen);
  if (iVar1 == 0) {
    AddIsoIcTag("4F00",&v_TagIso,sWork,nLen);
  }
  iVar1 = GetTlvPrivate("C14",&tlvInfo,sWork,&nLen);
  if (iVar1 == 0) {
    AddIsoIcTag("9F33",&v_TagIso,sWork,nLen);
  }
  iVar1 = GetTlvPrivate("C10",&tlvInfo,sWork,&nLen);
  if (iVar1 == 0) {
    AddIsoIcTag("9500",&v_TagIso,sWork,nLen);
  }
  iVar1 = GetTlvPrivate("C04",&tlvInfo,sWork,&nLen);
  if (iVar1 == 0) {
    AddIsoIcTag("9A00",&v_TagIso,sWork,nLen);
  }
  iVar1 = GetTlvPrivate("C05",&tlvInfo,sWork,&nLen);
  if (iVar1 == 0) {
    AddIsoIcTag("9C00",&v_TagIso,sWork,nLen);
  }
  iVar1 = GetTlvPrivate("C03",&tlvInfo,sWork,&nLen);
  if (iVar1 == 0) {
    AddIsoIcTag("5F2A",&v_TagIso,sWork,nLen);
  }
  iVar1 = GetTlvPrivate("C06",&tlvInfo,sWork,&nLen);
  if (iVar1 == 0) {
    AddIsoIcTag("9F02",&v_TagIso,sWork,nLen);
  }
  iVar1 = GetTlvPrivate("C21",&tlvInfo,sWork,&nLen);
  if (iVar1 == 0) {
    AddIsoIcTag("9F03",&v_TagIso,sWork,nLen);
  }
  iVar1 = GetTlvPrivate("C20",&tlvInfo,sWork,&nLen);
  if (iVar1 == 0) {
    AddIsoIcTag("9F10",&v_TagIso,sWork,nLen);
  }
  iVar1 = GetTlvPrivate("C11",&tlvInfo,sWork,&nLen);
  if (iVar1 == 0) {
    AddIsoIcTag("9F1A",&v_TagIso,sWork,nLen);
  }
  iVar1 = GetTlvPrivate("C18",&tlvInfo,sWork,&nLen);
  if (iVar1 == 0) {
    AddIsoIcTag("9F1E",&v_TagIso,sWork,nLen);
  }
  iVar1 = GetTlvPrivate("C01",&tlvInfo,sWork,&nLen);
  if (iVar1 == 0) {
    AddIsoIcTag("9F26",&v_TagIso,sWork,nLen);
  }
  iVar1 = GetTlvPrivate("C02",&tlvInfo,sWork,&nLen);
  if (iVar1 == 0) {
    AddIsoIcTag("9F27",&v_TagIso,sWork,nLen);
  }
  iVar1 = GetTlvPrivate("C13",&tlvInfo,sWork,&nLen);
  if (iVar1 == 0) {
    AddIsoIcTag("9F34",&v_TagIso,sWork,nLen);
  }
  iVar1 = GetTlvPrivate("C15",&tlvInfo,sWork,&nLen);
  if (iVar1 == 0) {
    AddIsoIcTag("9F35",&v_TagIso,sWork,nLen);
  }
  iVar1 = GetTlvPrivate("C07",&tlvInfo,sWork,&nLen);
  if (iVar1 == 0) {
    AddIsoIcTag("9F36",&v_TagIso,sWork,nLen);
  }
  iVar1 = GetTlvPrivate("C08",&tlvInfo,sWork,&nLen);
  if (iVar1 == 0) {
    AddIsoIcTag("9F37",&v_TagIso,sWork,nLen);
  }
  iVar1 = GetTlvPrivate("C19",&tlvInfo,sWork,&nLen);
  if (iVar1 == 0) {
    AddIsoIcTag("9F41",&v_TagIso,sWork,nLen);
  }
  iVar1 = GetTlvPrivate("C09",&tlvInfo,sWork,&nLen);
  if (iVar1 == 0) {
    AddIsoIcTag("9F53",&v_TagIso,sWork,nLen);
  }
  iVar1 = GetTlvPrivate("C23",&tlvInfo,sWork,&nLen);
  if (iVar1 == 0) {
    AddIsoIcTag("9100",&v_TagIso,sWork,nLen);
  }
  iVar1 = GetTlvPrivate("C24",&tlvInfo,sWork,&nLen);
  if (iVar1 == 0) {
    AddIsoIcTag("9F54",&v_TagIso,sWork,nLen);
  }
  iVar1 = GetTlvPrivate("C25",&tlvInfo,sWork,&nLen);
  if (iVar1 == 0) {
    AddIsoIcTag("9600",&v_TagIso,sWork,nLen);
  }
  iVar1 = GetTlvPrivate("C32",&tlvInfo,sWork,&nLen);
  if (iVar1 == 0) {
    AddIsoIcTag("7100",&v_TagIso,sWork,nLen);
  }
  iVar1 = GetTlvPrivate("C33",&tlvInfo,sWork,&nLen);
  if (iVar1 == 0) {
    AddIsoIcTag("7200",&v_TagIso,sWork,nLen);
  }
  iVar1 = GetTlvPrivate("C71",&tlvInfo,sWork,&nLen);
  if (iVar1 == 0) {
    AddIsoIcTag("5F34",&v_TagIso,sWork,nLen);
  }
  iVar1 = GetTlvPrivate("C26",&tlvInfo,sWork,&nLen);
  if (iVar1 == 0) {
    iVar1 = AddIsoIcTag("9F06",&v_TagIso,sWork,nLen);
    if (iVar1 != 0) {
      trace_event("Erreur Put TAG: ISO_TAG_APP_SELECTED",0);
    }
  }
  iVar1 = GetTlvPrivate("C27",&tlvInfo,sWork,&nLen);
  if (iVar1 == 0) {
    iVar1 = AddIsoIcTag("5700",&v_TagIso,sWork,nLen);
    if (iVar1 != 0) {
      trace_event("Erreur Put TAG: ISO_TAG_TRACK2",0);
    }
  }
  iVar1 = GetTlvPrivate("C28",&tlvInfo,sWork,&nLen);
  if (iVar1 == 0) {
    iVar1 = AddIsoIcTag("5A00",&v_TagIso,sWork,nLen);
    if (iVar1 != 0) {
      trace_event("Erreur Put TAG: ISO_TAG_APP_PAN",0);
    }
  }
  iVar1 = GetTlvPrivate("C29",&tlvInfo,sWork,&nLen);
  if (iVar1 == 0) {
    iVar1 = AddIsoIcTag("9F12",&v_TagIso,sWork,nLen);
    if (iVar1 != 0) {
      trace_event("Erreur Put TAG: ISO_TAG_APP_NAME",0);
    }
  }
  iVar1 = GetTlvPrivate("C30",&tlvInfo,sWork,&nLen);
  if (iVar1 == 0) {
    iVar1 = AddIsoIcTag("5000",&v_TagIso,sWork,nLen);
    if (iVar1 != 0) {
      trace_event("Erreur Put TAG: ISO_TAG_APP_LABEL",0);
    }
  }
  iVar1 = GetTlvPrivate("C31",&tlvInfo,sWork,&nLen);
  if (iVar1 == 0) {
    iVar1 = AddIsoIcTag("8C00",&v_TagIso,sWork,nLen);
    if (iVar1 != 0) {
      trace_event("Erreur Put TAG: ISO_TAG_ICC",0);
    }
  }
  iVar1 = GetTlvPrivate("C80",&tlvInfo,sWork,&nLen);
  if (iVar1 == 0) {
    iVar1 = AddIsoIcTag("8400",&v_TagIso,sWork,nLen);
    if (iVar1 != 0) {
      trace_event("Erreur Put TAG: ISO_TAG_DED_FILE_NAME",0);
    }
  }
  iVar1 = GetTlvPrivate("C41",&tlvInfo,sWork,&nLen);
  if (iVar1 == 0) {
    iVar1 = AddIsoIcTag("9F07",&v_TagIso,sWork,nLen);
    if (iVar1 != 0) {
      trace_event("Erreur Put TAG: ISO_TAG_APP_USE_CONTROL",0);
    }
  }
  iVar1 = GetTlvPrivate("C17",&tlvInfo,sWork,&nLen);
  if (iVar1 == 0) {
    iVar1 = AddIsoIcTag("9F09",&v_TagIso,sWork,nLen);
    if (iVar1 != 0) {
      trace_event("Erreur Put TAG: ISO_TAG_TERM_APP_VER_NUM",0);
    }
  }
  iVar1 = GetTlvPrivate("C72",&tlvInfo,sWork,&nLen);
  if (iVar1 == 0) {
    iVar1 = AddIsoIcTag("9F1F",&v_TagIso,sWork,nLen);
    if (iVar1 != 0) {
      trace_event("Erreur Put TAG: ISO_TAG_TRACK_1_DATA",0);
    }
  }
  iVar1 = GetTlvPrivate("C73",&tlvInfo,sWork,&nLen);
  if (iVar1 == 0) {
    iVar1 = AddIsoIcTag("5F24",&v_TagIso,sWork,nLen);
    if (iVar1 != 0) {
      trace_event("Erreur Put TAG: ISO_TAG_APP_EXP_DATE",0);
    }
  }
  pcVar3 = sWork;
  for (lVar2 = 0x200; lVar2 != 0; lVar2 = lVar2 + -1) {
    pcVar3[0] = '\0';
    pcVar3[1] = '\0';
    pcVar3[2] = '\0';
    pcVar3[3] = '\0';
    pcVar3[4] = '\0';
    pcVar3[5] = '\0';
    pcVar3[6] = '\0';
    pcVar3[7] = '\0';
    pcVar3 = pcVar3 + (ulong)bVar4 * -0x10 + 8;
  }
  iVar1 = GetTlvPrivate("C63",&tlvInfo,sWork,&nLen);
  if (iVar1 == 0) {
    sprintf(sLine," CHIP_TAG_CARD_PROD_ID icLen =%d, sWork =%s ,CHIP_TAG_CARD_PROD_ID[%s] ",
            (ulong)(uint)nLen,sWork,&DAT_004a8e6d);
    trace_event(sLine,5);
    if (sWork[0] != '\0') {
      iVar1 = AddIsoIcTag("9F63",&v_TagIso,sWork,nLen);
      if (iVar1 == 0) {
        sprintf(sLine," CHIP_TAG_CARD_PROD_ID icLen =%d, icTmp =%s ,CHIP_TAG_CARD_PROD_ID[%s] ",
                (ulong)(uint)nLen,sWork,&DAT_004a8e6d);
        trace_event(sLine,5);
      }
      else {
        trace_event("Erreur Put TAG: ISO_TAG_CARD_PROD_ID",0);
      }
    }
  }
  nLen = IsoBuildIcFld(sIccBuffer,&v_TagIso);
  IsoDumpIccFields(sIccBuffer,nLen);
  iVar1 = nLen;
  memcpy(szBufferOut,sIccBuffer,(long)nLen);
  *nLengthOut = iVar1;
  trace_event("End   IccTlvToIso(void)",5);
  return;
}



// WARNING: Unknown calling convention

int TlvToIso(int nIndiceCtx,TSTlvAutho *tlvInfo,TSIsoInfo *isoInfo,char sens)

{
  int iVar1;
  long lVar2;
  char *pcVar3;
  byte bVar4;
  char sResponse [4];
  char sCurrency [4];
  int nResponseLength;
  int nLength;
  int nLen;
  char sAmount [19];
  char sOrigAmounts [25];
  char secResult [33];
  char sLine [100];
  char sTlvPrivateBuffer [1024];
  char tmpField [4096];
  char sWork [4096];
  TSTlvPrivate sTlvPrivateInfo;
  
  bVar4 = 0;
  sAmount[0x10] = '\0';
  sAmount[0x11] = '\0';
  secResult[0] = '\0';
  secResult[1] = '\0';
  secResult[2] = '\0';
  secResult[3] = '\0';
  secResult[4] = '\0';
  secResult[5] = '\0';
  secResult[6] = '\0';
  secResult[7] = '\0';
  secResult[8] = '\0';
  secResult[9] = '\0';
  secResult[10] = '\0';
  secResult[0xb] = '\0';
  secResult[0xc] = '\0';
  secResult[0xd] = '\0';
  secResult[0xe] = '\0';
  secResult[0xf] = '\0';
  pcVar3 = tmpField;
  for (lVar2 = 0x200; lVar2 != 0; lVar2 = lVar2 + -1) {
    pcVar3[0] = '\0';
    pcVar3[1] = '\0';
    pcVar3[2] = '\0';
    pcVar3[3] = '\0';
    pcVar3[4] = '\0';
    pcVar3[5] = '\0';
    pcVar3[6] = '\0';
    pcVar3[7] = '\0';
    pcVar3 = pcVar3 + 8;
  }
  secResult[0x10] = '\0';
  secResult[0x11] = '\0';
  secResult[0x12] = '\0';
  secResult[0x13] = '\0';
  secResult[0x14] = '\0';
  secResult[0x15] = '\0';
  secResult[0x16] = '\0';
  secResult[0x17] = '\0';
  secResult[0x18] = '\0';
  secResult[0x19] = '\0';
  secResult[0x1a] = '\0';
  secResult[0x1b] = '\0';
  secResult[0x1c] = '\0';
  secResult[0x1d] = '\0';
  secResult[0x1e] = '\0';
  secResult[0x1f] = '\0';
  secResult[0x20] = '\0';
  sResponse[0] = '\0';
  sResponse[1] = '\0';
  sResponse[2] = '\0';
  sResponse[3] = '\0';
  sAmount[0] = '\0';
  sAmount[1] = '\0';
  sAmount[2] = '\0';
  sAmount[3] = '\0';
  sAmount[4] = '\0';
  sAmount[5] = '\0';
  sAmount[6] = '\0';
  sAmount[7] = '\0';
  sAmount[8] = '\0';
  sAmount[9] = '\0';
  sAmount[10] = '\0';
  sAmount[0xb] = '\0';
  sAmount[0xc] = '\0';
  sAmount[0xd] = '\0';
  sAmount[0xe] = '\0';
  sAmount[0xf] = '\0';
  sAmount[0x12] = '\0';
  sCurrency[0] = '\0';
  sCurrency[1] = '\0';
  sCurrency[2] = '\0';
  sCurrency[3] = '\0';
  sOrigAmounts[0] = '\0';
  sOrigAmounts[1] = '\0';
  sOrigAmounts[2] = '\0';
  sOrigAmounts[3] = '\0';
  sOrigAmounts[4] = '\0';
  sOrigAmounts[5] = '\0';
  sOrigAmounts[6] = '\0';
  sOrigAmounts[7] = '\0';
  sOrigAmounts[8] = '\0';
  sOrigAmounts[9] = '\0';
  sOrigAmounts[10] = '\0';
  sOrigAmounts[0xb] = '\0';
  sOrigAmounts[0xc] = '\0';
  sOrigAmounts[0xd] = '\0';
  sOrigAmounts[0xe] = '\0';
  sOrigAmounts[0xf] = '\0';
  sOrigAmounts[0x10] = '\0';
  sOrigAmounts[0x11] = '\0';
  sOrigAmounts[0x12] = '\0';
  sOrigAmounts[0x13] = '\0';
  sOrigAmounts[0x14] = '\0';
  sOrigAmounts[0x15] = '\0';
  sOrigAmounts[0x16] = '\0';
  sOrigAmounts[0x17] = '\0';
  sOrigAmounts[0x18] = '\0';
  pcVar3 = sLine;
  for (lVar2 = 0xc; lVar2 != 0; lVar2 = lVar2 + -1) {
    pcVar3[0] = '\0';
    pcVar3[1] = '\0';
    pcVar3[2] = '\0';
    pcVar3[3] = '\0';
    pcVar3[4] = '\0';
    pcVar3[5] = '\0';
    pcVar3[6] = '\0';
    pcVar3[7] = '\0';
    pcVar3 = pcVar3 + 8;
  }
  pcVar3[0] = '\0';
  pcVar3[1] = '\0';
  pcVar3[2] = '\0';
  pcVar3[3] = '\0';
  pcVar3 = sTlvPrivateBuffer;
  for (lVar2 = 0x80; lVar2 != 0; lVar2 = lVar2 + -1) {
    pcVar3[0] = '\0';
    pcVar3[1] = '\0';
    pcVar3[2] = '\0';
    pcVar3[3] = '\0';
    pcVar3[4] = '\0';
    pcVar3[5] = '\0';
    pcVar3[6] = '\0';
    pcVar3[7] = '\0';
    pcVar3 = pcVar3 + 8;
  }
  memset(&sTlvPrivateInfo,0,0x273c);
  trace_event("TlvToIso( start ) ",5);
  if (sens == '\x04') {
    pcVar3 = tmpField;
    for (lVar2 = 0x200; lVar2 != 0; lVar2 = lVar2 + -1) {
      pcVar3[0] = '\0';
      pcVar3[1] = '\0';
      pcVar3[2] = '\0';
      pcVar3[3] = '\0';
      pcVar3[4] = '\0';
      pcVar3[5] = '\0';
      pcVar3[6] = '\0';
      pcVar3[7] = '\0';
      pcVar3 = pcVar3 + (ulong)bVar4 * -0x10 + 8;
    }
    iVar1 = GetTlvAutho("007",tlvInfo,tmpField,&nLength);
    if (iVar1 == 0) {
      PutIsoField(6,isoInfo,tmpField,nLength);
    }
    pcVar3 = tmpField;
    for (lVar2 = 0x200; lVar2 != 0; lVar2 = lVar2 + -1) {
      pcVar3[0] = '\0';
      pcVar3[1] = '\0';
      pcVar3[2] = '\0';
      pcVar3[3] = '\0';
      pcVar3[4] = '\0';
      pcVar3[5] = '\0';
      pcVar3[6] = '\0';
      pcVar3[7] = '\0';
      pcVar3 = pcVar3 + (ulong)bVar4 * -0x10 + 8;
    }
    iVar1 = GetTlvAutho("011",tlvInfo,tmpField,&nLength);
    if (iVar1 == 0) {
      PutIsoField(10,isoInfo,tmpField,nLength);
    }
    pcVar3 = tmpField;
    for (lVar2 = 0x200; lVar2 != 0; lVar2 = lVar2 + -1) {
      pcVar3[0] = '\0';
      pcVar3[1] = '\0';
      pcVar3[2] = '\0';
      pcVar3[3] = '\0';
      pcVar3[4] = '\0';
      pcVar3[5] = '\0';
      pcVar3[6] = '\0';
      pcVar3[7] = '\0';
      pcVar3 = pcVar3 + (ulong)bVar4 * -0x10 + 8;
    }
    iVar1 = GetTlvAutho("037",tlvInfo,tmpField,&nLength);
    if (iVar1 == 0) {
      PutIsoField(0x24,isoInfo,tmpField,nLength);
    }
    pcVar3 = tmpField;
    for (lVar2 = 0x200; lVar2 != 0; lVar2 = lVar2 + -1) {
      pcVar3[0] = '\0';
      pcVar3[1] = '\0';
      pcVar3[2] = '\0';
      pcVar3[3] = '\0';
      pcVar3[4] = '\0';
      pcVar3[5] = '\0';
      pcVar3[6] = '\0';
      pcVar3[7] = '\0';
      pcVar3 = pcVar3 + (ulong)bVar4 * -0x10 + 8;
    }
    iVar1 = GetTlvAutho("022",tlvInfo,tmpField,&nLength);
    if (iVar1 == 0) {
      PutIsoField(0x15,isoInfo,tmpField,nLength);
    }
  }
  sAmount[0] = '\0';
  sAmount[1] = '\0';
  sAmount[2] = '\0';
  sAmount[3] = '\0';
  sAmount[4] = '\0';
  sAmount[5] = '\0';
  sAmount[6] = '\0';
  sAmount[7] = '\0';
  sAmount[8] = '\0';
  sAmount[9] = '\0';
  sAmount[10] = '\0';
  sAmount[0xb] = '\0';
  sAmount[0xc] = '\0';
  sAmount[0xd] = '\0';
  sAmount[0xe] = '\0';
  sAmount[0xf] = '\0';
  sAmount[0x10] = '\0';
  sAmount[0x11] = '\0';
  sAmount[0x12] = '\0';
  iVar1 = GetTlvAutho("004",tlvInfo,sAmount,&nLength);
  if (iVar1 == 0) {
    sCurrency[0] = '\0';
    sCurrency[1] = '\0';
    sCurrency[2] = '\0';
    sCurrency[3] = '\0';
    iVar1 = GetTlvAutho("049",tlvInfo,sCurrency,&nLength);
    if (iVar1 != 0) goto LAB_0042d7f6;
    pcVar3 = tmpField;
    for (lVar2 = 0x200; lVar2 != 0; lVar2 = lVar2 + -1) {
      pcVar3[0] = '\0';
      pcVar3[1] = '\0';
      pcVar3[2] = '\0';
      pcVar3[3] = '\0';
      pcVar3[4] = '\0';
      pcVar3[5] = '\0';
      pcVar3[6] = '\0';
      pcVar3[7] = '\0';
      pcVar3 = pcVar3 + (ulong)bVar4 * -0x10 + 8;
    }
    iVar1 = AdjustIsoAmount(nIndiceCtx,sAmount,sCurrency,tmpField);
    if (iVar1 == 0) {
      PutIsoField(3,isoInfo,tmpField,0xc);
      PutIsoField(0x31,isoInfo,sCurrency,3);
      goto LAB_0042d7f6;
    }
    goto LAB_0042e798;
  }
LAB_0042d7f6:
  if (sens == '\0') {
    sAmount[0] = '\0';
    sAmount[1] = '\0';
    sAmount[2] = '\0';
    sAmount[3] = '\0';
    sAmount[4] = '\0';
    sAmount[5] = '\0';
    sAmount[6] = '\0';
    sAmount[7] = '\0';
    sAmount[8] = '\0';
    sAmount[9] = '\0';
    sAmount[10] = '\0';
    sAmount[0xb] = '\0';
    sAmount[0xc] = '\0';
    sAmount[0xd] = '\0';
    sAmount[0xe] = '\0';
    sAmount[0xf] = '\0';
    sAmount[0x10] = '\0';
    sAmount[0x11] = '\0';
    sAmount[0x12] = '\0';
    iVar1 = GetTlvAutho("213",tlvInfo,sAmount,&nLength);
    if (iVar1 == 0) {
      sCurrency[0] = '\0';
      sCurrency[1] = '\0';
      sCurrency[2] = '\0';
      sCurrency[3] = '\0';
      iVar1 = GetTlvAutho("214",tlvInfo,sCurrency,&nLength);
      if (iVar1 == 0) {
        pcVar3 = tmpField;
        for (lVar2 = 0x200; lVar2 != 0; lVar2 = lVar2 + -1) {
          pcVar3[0] = '\0';
          pcVar3[1] = '\0';
          pcVar3[2] = '\0';
          pcVar3[3] = '\0';
          pcVar3[4] = '\0';
          pcVar3[5] = '\0';
          pcVar3[6] = '\0';
          pcVar3[7] = '\0';
          pcVar3 = pcVar3 + (ulong)bVar4 * -0x10 + 8;
        }
        iVar1 = AdjustIsoAmount(nIndiceCtx,sAmount,sCurrency,tmpField);
        if (iVar1 != 0) goto LAB_0042e798;
        PutIsoField(4,isoInfo,tmpField,0xc);
        PutIsoField(0x31,isoInfo,sCurrency,3);
      }
    }
    pcVar3 = tmpField;
    for (lVar2 = 0x200; lVar2 != 0; lVar2 = lVar2 + -1) {
      pcVar3[0] = '\0';
      pcVar3[1] = '\0';
      pcVar3[2] = '\0';
      pcVar3[3] = '\0';
      pcVar3[4] = '\0';
      pcVar3[5] = '\0';
      pcVar3[6] = '\0';
      pcVar3[7] = '\0';
      pcVar3 = pcVar3 + (ulong)bVar4 * -0x10 + 8;
    }
    iVar1 = GetTlvAutho("216",tlvInfo,tmpField,&nLength);
    if (iVar1 == 0) {
      PutIsoField(8,isoInfo,tmpField,8);
    }
    pcVar3 = tmpField;
    for (lVar2 = 0x200; lVar2 != 0; lVar2 = lVar2 + -1) {
      pcVar3[0] = '\0';
      pcVar3[1] = '\0';
      pcVar3[2] = '\0';
      pcVar3[3] = '\0';
      pcVar3[4] = '\0';
      pcVar3[5] = '\0';
      pcVar3[6] = '\0';
      pcVar3[7] = '\0';
      pcVar3 = pcVar3 + (ulong)bVar4 * -0x10 + 8;
    }
    iVar1 = GetTlvAutho("215",tlvInfo,tmpField,&nLength);
    if (iVar1 == 0) {
      sprintf(sLine,"Settlement Date IS %s ",tmpField);
      trace_event(sLine,4);
      PutIsoField(0xe,isoInfo,tmpField + 4,4);
    }
    pcVar3 = tmpField;
    for (lVar2 = 0x200; lVar2 != 0; lVar2 = lVar2 + -1) {
      pcVar3[0] = '\0';
      pcVar3[1] = '\0';
      pcVar3[2] = '\0';
      pcVar3[3] = '\0';
      pcVar3[4] = '\0';
      pcVar3[5] = '\0';
      pcVar3[6] = '\0';
      pcVar3[7] = '\0';
      pcVar3 = pcVar3 + (ulong)bVar4 * -0x10 + 8;
    }
    iVar1 = GetTlvAutho("016",tlvInfo,tmpField,&nLength);
    if (iVar1 == 0) {
      PutIsoField(0xf,isoInfo,tmpField,4);
    }
  }
  else if (sens == '\x01') {
    sAmount[0x10] = '\0';
    sAmount[0x11] = '\0';
    sAmount[0] = '\0';
    sAmount[1] = '\0';
    sAmount[2] = '\0';
    sAmount[3] = '\0';
    sAmount[4] = '\0';
    sAmount[5] = '\0';
    sAmount[6] = '\0';
    sAmount[7] = '\0';
    sAmount[8] = '\0';
    sAmount[9] = '\0';
    sAmount[10] = '\0';
    sAmount[0xb] = '\0';
    sAmount[0xc] = '\0';
    sAmount[0xd] = '\0';
    sAmount[0xe] = '\0';
    sAmount[0xf] = '\0';
    sAmount[0x12] = '\0';
    iVar1 = GetTlvAutho("218",tlvInfo,sAmount,&nLength);
    if (iVar1 == 0) {
      sCurrency[0] = '\0';
      sCurrency[1] = '\0';
      sCurrency[2] = '\0';
      sCurrency[3] = '\0';
      iVar1 = GetTlvAutho("219",tlvInfo,sCurrency,&nLength);
      if (iVar1 == 0) {
        pcVar3 = tmpField;
        for (lVar2 = 0x200; lVar2 != 0; lVar2 = lVar2 + -1) {
          pcVar3[0] = '\0';
          pcVar3[1] = '\0';
          pcVar3[2] = '\0';
          pcVar3[3] = '\0';
          pcVar3[4] = '\0';
          pcVar3[5] = '\0';
          pcVar3[6] = '\0';
          pcVar3[7] = '\0';
          pcVar3 = pcVar3 + (ulong)bVar4 * -0x10 + 8;
        }
        iVar1 = AdjustIsoAmount(nIndiceCtx,sAmount,sCurrency,tmpField);
        if (iVar1 != 0) goto LAB_0042e798;
        PutIsoField(4,isoInfo,tmpField,0xc);
        PutIsoField(0x31,isoInfo,sCurrency,3);
      }
    }
    pcVar3 = tmpField;
    for (lVar2 = 0x200; lVar2 != 0; lVar2 = lVar2 + -1) {
      pcVar3[0] = '\0';
      pcVar3[1] = '\0';
      pcVar3[2] = '\0';
      pcVar3[3] = '\0';
      pcVar3[4] = '\0';
      pcVar3[5] = '\0';
      pcVar3[6] = '\0';
      pcVar3[7] = '\0';
      pcVar3 = pcVar3 + (ulong)bVar4 * -0x10 + 8;
    }
    iVar1 = GetTlvAutho("221",tlvInfo,tmpField,&nLength);
    if (iVar1 == 0) {
      PutIsoField(8,isoInfo,tmpField,8);
    }
    pcVar3 = tmpField;
    for (lVar2 = 0x200; lVar2 != 0; lVar2 = lVar2 + -1) {
      pcVar3[0] = '\0';
      pcVar3[1] = '\0';
      pcVar3[2] = '\0';
      pcVar3[3] = '\0';
      pcVar3[4] = '\0';
      pcVar3[5] = '\0';
      pcVar3[6] = '\0';
      pcVar3[7] = '\0';
      pcVar3 = pcVar3 + (ulong)bVar4 * -0x10 + 8;
    }
    iVar1 = GetTlvAutho("220",tlvInfo,tmpField,&nLength);
    if (iVar1 == 0) {
      PutIsoField(0xe,isoInfo,tmpField + 4,4);
    }
    pcVar3 = tmpField;
    for (lVar2 = 0x200; lVar2 != 0; lVar2 = lVar2 + -1) {
      pcVar3[0] = '\0';
      pcVar3[1] = '\0';
      pcVar3[2] = '\0';
      pcVar3[3] = '\0';
      pcVar3[4] = '\0';
      pcVar3[5] = '\0';
      pcVar3[6] = '\0';
      pcVar3[7] = '\0';
      pcVar3 = pcVar3 + (ulong)bVar4 * -0x10 + 8;
    }
    iVar1 = GetTlvAutho("016",tlvInfo,tmpField,&nLength);
    if (iVar1 == 0) {
      PutIsoField(0xf,isoInfo,tmpField,4);
    }
    sResponse[0] = '\0';
    sResponse[1] = '\0';
    sResponse[2] = '\0';
    sResponse[3] = '\0';
    iVar1 = GetTlvAutho("202",tlvInfo,sResponse,&nResponseLength);
    if (iVar1 == 0) {
      pcVar3 = tmpField;
      for (lVar2 = 0x200; lVar2 != 0; lVar2 = lVar2 + -1) {
        pcVar3[0] = '\0';
        pcVar3[1] = '\0';
        pcVar3[2] = '\0';
        pcVar3[3] = '\0';
        pcVar3[4] = '\0';
        pcVar3[5] = '\0';
        pcVar3[6] = '\0';
        pcVar3[7] = '\0';
        pcVar3 = pcVar3 + (ulong)bVar4 * -0x10 + 8;
      }
      iVar1 = GetIsoField(0x3c,isoInfo,tmpField,&nLength);
      if (iVar1 == 0) {
        AnalyseTlvPrivate(tmpField,nLength,&sTlvPrivateInfo);
      }
      else {
        InitTlvPrivate(&sTlvPrivateInfo);
      }
      PutTlvPrivate("039",&sTlvPrivateInfo,sResponse,nResponseLength);
      pcVar3 = tmpField;
      for (lVar2 = 0x200; lVar2 != 0; lVar2 = lVar2 + -1) {
        pcVar3[0] = '\0';
        pcVar3[1] = '\0';
        pcVar3[2] = '\0';
        pcVar3[3] = '\0';
        pcVar3[4] = '\0';
        pcVar3[5] = '\0';
        pcVar3[6] = '\0';
        pcVar3[7] = '\0';
        pcVar3 = pcVar3 + (ulong)bVar4 * -0x10 + 8;
      }
      nLength = PrivateBuildTlv(tmpField,&sTlvPrivateInfo);
      PutIsoField(0x3c,isoInfo,tmpField,nLength);
    }
  }
  else if (sens == '\x03') {
    pcVar3 = tmpField;
    for (lVar2 = 0x200; lVar2 != 0; lVar2 = lVar2 + -1) {
      pcVar3[0] = '\0';
      pcVar3[1] = '\0';
      pcVar3[2] = '\0';
      pcVar3[3] = '\0';
      pcVar3[4] = '\0';
      pcVar3[5] = '\0';
      pcVar3[6] = '\0';
      pcVar3[7] = '\0';
      pcVar3 = pcVar3 + (ulong)bVar4 * -0x10 + 8;
    }
    iVar1 = GetTlvAutho("015",tlvInfo,tmpField,&nLength);
    if (iVar1 == 0) {
      sprintf(sLine,"Settlement Date IS %s ",tmpField);
      trace_event(sLine,4);
      PutIsoField(0xe,isoInfo,tmpField,4);
    }
  }
  sAmount[0x10] = '\0';
  sAmount[0x11] = '\0';
  sAmount[0] = '\0';
  sAmount[1] = '\0';
  sAmount[2] = '\0';
  sAmount[3] = '\0';
  sAmount[4] = '\0';
  sAmount[5] = '\0';
  sAmount[6] = '\0';
  sAmount[7] = '\0';
  sAmount[8] = '\0';
  sAmount[9] = '\0';
  sAmount[10] = '\0';
  sAmount[0xb] = '\0';
  sAmount[0xc] = '\0';
  sAmount[0xd] = '\0';
  sAmount[0xe] = '\0';
  sAmount[0xf] = '\0';
  sAmount[0x12] = '\0';
  iVar1 = GetTlvAutho("006",tlvInfo,sAmount,&nLength);
  if (iVar1 == 0) {
    sCurrency[0] = '\0';
    sCurrency[1] = '\0';
    sCurrency[2] = '\0';
    sCurrency[3] = '\0';
    iVar1 = GetTlvAutho("051",tlvInfo,sCurrency,&nLength);
    if (iVar1 == 0) {
      pcVar3 = tmpField;
      for (lVar2 = 0x200; lVar2 != 0; lVar2 = lVar2 + -1) {
        pcVar3[0] = '\0';
        pcVar3[1] = '\0';
        pcVar3[2] = '\0';
        pcVar3[3] = '\0';
        pcVar3[4] = '\0';
        pcVar3[5] = '\0';
        pcVar3[6] = '\0';
        pcVar3[7] = '\0';
        pcVar3 = pcVar3 + (ulong)bVar4 * -0x10 + 8;
      }
      iVar1 = AdjustIsoAmount(nIndiceCtx,sAmount,sCurrency,tmpField);
      if (iVar1 != 0) goto LAB_0042e798;
      PutIsoField(5,isoInfo,tmpField,0xc);
      PutIsoField(0x32,isoInfo,sCurrency,3);
    }
    pcVar3 = tmpField;
    for (lVar2 = 0x200; lVar2 != 0; lVar2 = lVar2 + -1) {
      pcVar3[0] = '\0';
      pcVar3[1] = '\0';
      pcVar3[2] = '\0';
      pcVar3[3] = '\0';
      pcVar3[4] = '\0';
      pcVar3[5] = '\0';
      pcVar3[6] = '\0';
      pcVar3[7] = '\0';
      pcVar3 = pcVar3 + (ulong)bVar4 * -0x10 + 8;
    }
    iVar1 = GetTlvAutho("010",tlvInfo,tmpField,&nLength);
    if (iVar1 == 0) {
      PutIsoField(9,isoInfo,tmpField,8);
    }
  }
  pcVar3 = tmpField;
  for (lVar2 = 0x200; lVar2 != 0; lVar2 = lVar2 + -1) {
    pcVar3[0] = '\0';
    pcVar3[1] = '\0';
    pcVar3[2] = '\0';
    pcVar3[3] = '\0';
    pcVar3[4] = '\0';
    pcVar3[5] = '\0';
    pcVar3[6] = '\0';
    pcVar3[7] = '\0';
    pcVar3 = pcVar3 + (ulong)bVar4 * -0x10 + 8;
  }
  iVar1 = GetTlvAutho("024",tlvInfo,tmpField,&nLength);
  if (iVar1 == 0) {
    PutIsoField(0x17,isoInfo,tmpField,nLength);
  }
  sAmount[0x10] = '\0';
  sAmount[0x11] = '\0';
  sAmount[0] = '\0';
  sAmount[1] = '\0';
  sAmount[2] = '\0';
  sAmount[3] = '\0';
  sAmount[4] = '\0';
  sAmount[5] = '\0';
  sAmount[6] = '\0';
  sAmount[7] = '\0';
  sAmount[8] = '\0';
  sAmount[9] = '\0';
  sAmount[10] = '\0';
  sAmount[0xb] = '\0';
  sAmount[0xc] = '\0';
  sAmount[0xd] = '\0';
  sAmount[0xe] = '\0';
  sAmount[0xf] = '\0';
  sAmount[0x12] = '\0';
  sOrigAmounts[0] = '\0';
  sOrigAmounts[1] = '\0';
  sOrigAmounts[2] = '\0';
  sOrigAmounts[3] = '\0';
  sOrigAmounts[4] = '\0';
  sOrigAmounts[5] = '\0';
  sOrigAmounts[6] = '\0';
  sOrigAmounts[7] = '\0';
  sOrigAmounts[8] = '\0';
  sOrigAmounts[9] = '\0';
  sOrigAmounts[10] = '\0';
  sOrigAmounts[0xb] = '\0';
  sOrigAmounts[0xc] = '\0';
  sOrigAmounts[0xd] = '\0';
  sOrigAmounts[0xe] = '\0';
  sOrigAmounts[0xf] = '\0';
  sOrigAmounts[0x10] = '\0';
  sOrigAmounts[0x11] = '\0';
  sOrigAmounts[0x12] = '\0';
  sOrigAmounts[0x13] = '\0';
  sOrigAmounts[0x14] = '\0';
  sOrigAmounts[0x15] = '\0';
  sOrigAmounts[0x16] = '\0';
  sOrigAmounts[0x17] = '\0';
  sOrigAmounts[0x18] = '\0';
  iVar1 = GetTlvAutho("295",tlvInfo,sAmount,&nLength);
  if (iVar1 == 0) {
    iVar1 = GetTlvAutho("051",tlvInfo,sCurrency,&nLength);
    if (iVar1 != 0) goto LAB_0042d98c;
    pcVar3 = tmpField;
    for (lVar2 = 0x200; lVar2 != 0; lVar2 = lVar2 + -1) {
      pcVar3[0] = '\0';
      pcVar3[1] = '\0';
      pcVar3[2] = '\0';
      pcVar3[3] = '\0';
      pcVar3[4] = '\0';
      pcVar3[5] = '\0';
      pcVar3[6] = '\0';
      pcVar3[7] = '\0';
      pcVar3 = pcVar3 + (ulong)bVar4 * -0x10 + 8;
    }
    iVar1 = AdjustIsoAmount(nIndiceCtx,sAmount,sCurrency,tmpField);
    if (iVar1 == 0) {
      sAmount[0x10] = '\0';
      sAmount[0x11] = '\0';
      sAmount[0] = '\0';
      sAmount[1] = '\0';
      sAmount[2] = '\0';
      sAmount[3] = '\0';
      sAmount[4] = '\0';
      sAmount[5] = '\0';
      sAmount[6] = '\0';
      sAmount[7] = '\0';
      sAmount[8] = '\0';
      sAmount[9] = '\0';
      sAmount[10] = '\0';
      sAmount[0xb] = '\0';
      sAmount[0xc] = '\0';
      sAmount[0xd] = '\0';
      sAmount[0xe] = '\0';
      sAmount[0xf] = '\0';
      sOrigAmounts._12_4_ = (undefined4)CONCAT71(tmpField._1_7_,tmpField[0]);
      sOrigAmounts._16_4_ = SUB74(tmpField._1_7_,3);
      sAmount[0x12] = '\0';
      sOrigAmounts[0x14] = tmpField[8];
      sOrigAmounts[0x15] = tmpField[9];
      sOrigAmounts[0x16] = tmpField[10];
      sOrigAmounts[0x17] = tmpField[0xb];
      sCurrency[0] = '\0';
      sCurrency[1] = '\0';
      sCurrency[2] = '\0';
      sCurrency[3] = '\0';
      GetTlvAutho("294",tlvInfo,sAmount,&nLength);
      GetTlvAutho("049",tlvInfo,sCurrency,&nLength);
      pcVar3 = tmpField;
      for (lVar2 = 0x200; lVar2 != 0; lVar2 = lVar2 + -1) {
        pcVar3[0] = '\0';
        pcVar3[1] = '\0';
        pcVar3[2] = '\0';
        pcVar3[3] = '\0';
        pcVar3[4] = '\0';
        pcVar3[5] = '\0';
        pcVar3[6] = '\0';
        pcVar3[7] = '\0';
        pcVar3 = pcVar3 + (ulong)bVar4 * -0x10 + 8;
      }
      iVar1 = AdjustIsoAmount(nIndiceCtx,sAmount,sCurrency,tmpField);
      if (iVar1 == 0) {
        sOrigAmounts[1] = tmpField[1];
        sOrigAmounts[2] = tmpField[2];
        sOrigAmounts[3] = tmpField[3];
        sOrigAmounts[4] = tmpField[4];
        sOrigAmounts[5] = tmpField[5];
        sOrigAmounts[6] = tmpField[6];
        sOrigAmounts[7] = tmpField[7];
        sOrigAmounts[0] = tmpField[0];
        sOrigAmounts[8] = tmpField[8];
        sOrigAmounts[9] = tmpField[9];
        sOrigAmounts[10] = tmpField[10];
        sOrigAmounts[0xb] = tmpField[0xb];
        PutIsoField(0x1d,isoInfo,sOrigAmounts,0x18);
        goto LAB_0042d98c;
      }
    }
LAB_0042e798:
    iVar1 = -1;
  }
  else {
LAB_0042d98c:
    pcVar3 = tmpField;
    for (lVar2 = 0x200; lVar2 != 0; lVar2 = lVar2 + -1) {
      pcVar3[0] = '\0';
      pcVar3[1] = '\0';
      pcVar3[2] = '\0';
      pcVar3[3] = '\0';
      pcVar3[4] = '\0';
      pcVar3[5] = '\0';
      pcVar3[6] = '\0';
      pcVar3[7] = '\0';
      pcVar3 = pcVar3 + (ulong)bVar4 * -0x10 + 8;
    }
    iVar1 = GetTlvAutho("032",tlvInfo,tmpField,&nLength);
    if (iVar1 == 0) {
      PutIsoField(0x1f,isoInfo,tmpField,nLength);
    }
    pcVar3 = tmpField;
    for (lVar2 = 0x200; lVar2 != 0; lVar2 = lVar2 + -1) {
      pcVar3[0] = '\0';
      pcVar3[1] = '\0';
      pcVar3[2] = '\0';
      pcVar3[3] = '\0';
      pcVar3[4] = '\0';
      pcVar3[5] = '\0';
      pcVar3[6] = '\0';
      pcVar3[7] = '\0';
      pcVar3 = pcVar3 + (ulong)bVar4 * -0x10 + 8;
    }
    iVar1 = GetTlvAutho("036",tlvInfo,tmpField,&nLength);
    if (iVar1 == 0) {
      PutIsoField(0x23,isoInfo,tmpField,nLength);
    }
    pcVar3 = tmpField;
    for (lVar2 = 0x200; lVar2 != 0; lVar2 = lVar2 + -1) {
      pcVar3[0] = '\0';
      pcVar3[1] = '\0';
      pcVar3[2] = '\0';
      pcVar3[3] = '\0';
      pcVar3[4] = '\0';
      pcVar3[5] = '\0';
      pcVar3[6] = '\0';
      pcVar3[7] = '\0';
      pcVar3 = pcVar3 + (ulong)bVar4 * -0x10 + 8;
    }
    iVar1 = GetTlvAutho("038",tlvInfo,tmpField,&nLength);
    if (iVar1 == 0) {
      PutIsoField(0x25,isoInfo,tmpField,nLength);
    }
    pcVar3 = tmpField;
    for (lVar2 = 0x200; lVar2 != 0; lVar2 = lVar2 + -1) {
      pcVar3[0] = '\0';
      pcVar3[1] = '\0';
      pcVar3[2] = '\0';
      pcVar3[3] = '\0';
      pcVar3[4] = '\0';
      pcVar3[5] = '\0';
      pcVar3[6] = '\0';
      pcVar3[7] = '\0';
      pcVar3 = pcVar3 + (ulong)bVar4 * -0x10 + 8;
    }
    iVar1 = GetTlvAutho("039",tlvInfo,tmpField,&nLength);
    if (iVar1 == 0) {
      PutIsoField(0x26,isoInfo,tmpField,nLength);
    }
    iVar1 = GetTlvAutho("048",tlvInfo,sTlvPrivateBuffer,&nLength);
    if (iVar1 == 0) {
      InitTlvPrivate(&sTlvPrivateInfo);
      AnalyseTlvPrivate(sTlvPrivateBuffer,nLength,&sTlvPrivateInfo);
      secResult[0] = '\0';
      secResult[1] = '\0';
      secResult[2] = '\0';
      secResult[3] = '\0';
      secResult[4] = '\0';
      secResult[5] = '\0';
      secResult[6] = '\0';
      secResult[7] = '\0';
      secResult[8] = '\0';
      secResult[9] = '\0';
      secResult[10] = '\0';
      secResult[0xb] = '\0';
      secResult[0xc] = '\0';
      secResult[0xd] = '\0';
      secResult[0xe] = '\0';
      secResult[0xf] = '\0';
      secResult[0x10] = '\0';
      secResult[0x11] = '\0';
      secResult[0x12] = '\0';
      secResult[0x13] = '\0';
      secResult[0x14] = '\0';
      secResult[0x15] = '\0';
      secResult[0x16] = '\0';
      secResult[0x17] = '\0';
      secResult[0x18] = '\0';
      secResult[0x19] = '\0';
      secResult[0x1a] = '\0';
      secResult[0x1b] = '\0';
      secResult[0x1c] = '\0';
      secResult[0x1d] = '\0';
      secResult[0x1e] = '\0';
      secResult[0x1f] = '\0';
      secResult[0x20] = '\0';
      iVar1 = GetTlvAutho("270",tlvInfo,secResult,&nLength);
      if (iVar1 == 0) goto LAB_0042e0b8;
LAB_0042de57:
      pcVar3 = tmpField;
      for (lVar2 = 0x200; lVar2 != 0; lVar2 = lVar2 + -1) {
        pcVar3[0] = '\0';
        pcVar3[1] = '\0';
        pcVar3[2] = '\0';
        pcVar3[3] = '\0';
        pcVar3[4] = '\0';
        pcVar3[5] = '\0';
        pcVar3[6] = '\0';
        pcVar3[7] = '\0';
        pcVar3 = pcVar3 + (ulong)bVar4 * -0x10 + 8;
      }
      nLength = PrivateBuildTlv(tmpField,&sTlvPrivateInfo);
      trace_event("3.8.TlvToIso( start ) ",5);
      if (0 < nLength) {
        PutIsoField(0x2f,isoInfo,tmpField,nLength);
      }
    }
    else {
      InitTlvPrivate(&sTlvPrivateInfo);
      secResult[0] = '\0';
      secResult[1] = '\0';
      secResult[2] = '\0';
      secResult[3] = '\0';
      secResult[4] = '\0';
      secResult[5] = '\0';
      secResult[6] = '\0';
      secResult[7] = '\0';
      secResult[8] = '\0';
      secResult[9] = '\0';
      secResult[10] = '\0';
      secResult[0xb] = '\0';
      secResult[0xc] = '\0';
      secResult[0xd] = '\0';
      secResult[0xe] = '\0';
      secResult[0xf] = '\0';
      secResult[0x10] = '\0';
      secResult[0x11] = '\0';
      secResult[0x12] = '\0';
      secResult[0x13] = '\0';
      secResult[0x14] = '\0';
      secResult[0x15] = '\0';
      secResult[0x16] = '\0';
      secResult[0x17] = '\0';
      secResult[0x18] = '\0';
      secResult[0x19] = '\0';
      secResult[0x1a] = '\0';
      secResult[0x1b] = '\0';
      secResult[0x1c] = '\0';
      secResult[0x1d] = '\0';
      secResult[0x1e] = '\0';
      secResult[0x1f] = '\0';
      secResult[0x20] = '\0';
      iVar1 = GetTlvAutho("270",tlvInfo,secResult,&nLength);
      if (iVar1 == 0) {
LAB_0042e0b8:
        pcVar3 = tmpField;
        for (lVar2 = 0x200; lVar2 != 0; lVar2 = lVar2 + -1) {
          pcVar3[0] = '\0';
          pcVar3[1] = '\0';
          pcVar3[2] = '\0';
          pcVar3[3] = '\0';
          pcVar3[4] = '\0';
          pcVar3[5] = '\0';
          pcVar3[6] = '\0';
          pcVar3[7] = '\0';
          pcVar3 = pcVar3 + (ulong)bVar4 * -0x10 + 8;
        }
        tmpField[0] = secResult[0];
        PutTlvPrivate("P87",&sTlvPrivateInfo,tmpField,1);
        pcVar3 = tmpField;
        for (lVar2 = 0x200; lVar2 != 0; lVar2 = lVar2 + -1) {
          pcVar3[0] = '\0';
          pcVar3[1] = '\0';
          pcVar3[2] = '\0';
          pcVar3[3] = '\0';
          pcVar3[4] = '\0';
          pcVar3[5] = '\0';
          pcVar3[6] = '\0';
          pcVar3[7] = '\0';
          pcVar3 = pcVar3 + (ulong)bVar4 * -0x10 + 8;
        }
        tmpField[0] = secResult[1];
        PutTlvPrivate("P88",&sTlvPrivateInfo,tmpField,1);
        pcVar3 = tmpField;
        for (lVar2 = 0x200; lVar2 != 0; lVar2 = lVar2 + -1) {
          pcVar3[0] = '\0';
          pcVar3[1] = '\0';
          pcVar3[2] = '\0';
          pcVar3[3] = '\0';
          pcVar3[4] = '\0';
          pcVar3[5] = '\0';
          pcVar3[6] = '\0';
          pcVar3[7] = '\0';
          pcVar3 = pcVar3 + (ulong)bVar4 * -0x10 + 8;
        }
        tmpField[0] = secResult[0x11];
        PutTlvPrivate("P20",&sTlvPrivateInfo,tmpField,1);
        pcVar3 = tmpField;
        for (lVar2 = 0x200; lVar2 != 0; lVar2 = lVar2 + -1) {
          pcVar3[0] = '\0';
          pcVar3[1] = '\0';
          pcVar3[2] = '\0';
          pcVar3[3] = '\0';
          pcVar3[4] = '\0';
          pcVar3[5] = '\0';
          pcVar3[6] = '\0';
          pcVar3[7] = '\0';
          pcVar3 = pcVar3 + (ulong)bVar4 * -0x10 + 8;
        }
        tmpField[0] = secResult[0x12];
        PutTlvPrivate("P21",&sTlvPrivateInfo,tmpField,1);
        pcVar3 = tmpField;
        for (lVar2 = 0x200; lVar2 != 0; lVar2 = lVar2 + -1) {
          pcVar3[0] = '\0';
          pcVar3[1] = '\0';
          pcVar3[2] = '\0';
          pcVar3[3] = '\0';
          pcVar3[4] = '\0';
          pcVar3[5] = '\0';
          pcVar3[6] = '\0';
          pcVar3[7] = '\0';
          pcVar3 = pcVar3 + (ulong)bVar4 * -0x10 + 8;
        }
        tmpField[0] = secResult[0x13];
        PutTlvPrivate("P23",&sTlvPrivateInfo,tmpField,1);
        pcVar3 = tmpField;
        for (lVar2 = 0x200; lVar2 != 0; lVar2 = lVar2 + -1) {
          pcVar3[0] = '\0';
          pcVar3[1] = '\0';
          pcVar3[2] = '\0';
          pcVar3[3] = '\0';
          pcVar3[4] = '\0';
          pcVar3[5] = '\0';
          pcVar3[6] = '\0';
          pcVar3[7] = '\0';
          pcVar3 = pcVar3 + (ulong)bVar4 * -0x10 + 8;
        }
        tmpField[0] = secResult[0x14];
        PutTlvPrivate("P22",&sTlvPrivateInfo,tmpField,1);
        goto LAB_0042de57;
      }
    }
    sAmount[0] = '\0';
    sAmount[1] = '\0';
    sAmount[2] = '\0';
    sAmount[3] = '\0';
    sAmount[4] = '\0';
    sAmount[5] = '\0';
    sAmount[6] = '\0';
    sAmount[7] = '\0';
    sAmount[8] = '\0';
    sAmount[9] = '\0';
    sAmount[10] = '\0';
    sAmount[0xb] = '\0';
    sAmount[0xc] = '\0';
    sAmount[0xd] = '\0';
    sAmount[0xe] = '\0';
    sAmount[0xf] = '\0';
    sAmount[0x10] = '\0';
    sAmount[0x11] = '\0';
    sAmount[0x12] = '\0';
    iVar1 = GetTlvAutho("046",tlvInfo,sAmount,&nLength);
    if (iVar1 == 0) {
      sCurrency[0] = '\0';
      sCurrency[1] = '\0';
      sCurrency[2] = '\0';
      sCurrency[3] = '\0';
      iVar1 = GetTlvAutho("051",tlvInfo,sCurrency,&nLength);
      if (iVar1 == 0) {
        pcVar3 = tmpField;
        for (lVar2 = 0x200; lVar2 != 0; lVar2 = lVar2 + -1) {
          pcVar3[0] = '\0';
          pcVar3[1] = '\0';
          pcVar3[2] = '\0';
          pcVar3[3] = '\0';
          pcVar3[4] = '\0';
          pcVar3[5] = '\0';
          pcVar3[6] = '\0';
          pcVar3[7] = '\0';
          pcVar3 = pcVar3 + (ulong)bVar4 * -0x10 + 8;
        }
        iVar1 = AdjustIsoAmount(nIndiceCtx,sAmount,sCurrency,tmpField);
        if (iVar1 != 0) goto LAB_0042e798;
        PutIsoField(0x73,isoInfo,tmpField,0xc);
      }
    }
    pcVar3 = tmpField;
    for (lVar2 = 0x200; lVar2 != 0; lVar2 = lVar2 + -1) {
      pcVar3[0] = '\0';
      pcVar3[1] = '\0';
      pcVar3[2] = '\0';
      pcVar3[3] = '\0';
      pcVar3[4] = '\0';
      pcVar3[5] = '\0';
      pcVar3[6] = '\0';
      pcVar3[7] = '\0';
      pcVar3 = pcVar3 + (ulong)bVar4 * -0x10 + 8;
    }
    iVar1 = GetTlvAutho("053",tlvInfo,tmpField,&nLength);
    if (iVar1 == 0) {
      PutIsoField(0x34,isoInfo,tmpField,nLength);
    }
    pcVar3 = tmpField;
    for (lVar2 = 0x200; lVar2 != 0; lVar2 = lVar2 + -1) {
      pcVar3[0] = '\0';
      pcVar3[1] = '\0';
      pcVar3[2] = '\0';
      pcVar3[3] = '\0';
      pcVar3[4] = '\0';
      pcVar3[5] = '\0';
      pcVar3[6] = '\0';
      pcVar3[7] = '\0';
      pcVar3 = pcVar3 + (ulong)bVar4 * -0x10 + 8;
    }
    iVar1 = GetTlvAutho("063",tlvInfo,tmpField,&nLength);
    if (iVar1 == 0) {
      PutIsoField(0x3e,isoInfo,tmpField,nLength);
    }
    pcVar3 = tmpField;
    for (lVar2 = 0x200; lVar2 != 0; lVar2 = lVar2 + -1) {
      pcVar3[0] = '\0';
      pcVar3[1] = '\0';
      pcVar3[2] = '\0';
      pcVar3[3] = '\0';
      pcVar3[4] = '\0';
      pcVar3[5] = '\0';
      pcVar3[6] = '\0';
      pcVar3[7] = '\0';
      pcVar3 = pcVar3 + (ulong)bVar4 * -0x10 + 8;
    }
    iVar1 = GetTlvAutho("072",tlvInfo,tmpField,&nLength);
    if (iVar1 == 0) {
      PutIsoField(0x47,isoInfo,tmpField,nLength);
    }
    pcVar3 = tmpField;
    for (lVar2 = 0x200; lVar2 != 0; lVar2 = lVar2 + -1) {
      pcVar3[0] = '\0';
      pcVar3[1] = '\0';
      pcVar3[2] = '\0';
      pcVar3[3] = '\0';
      pcVar3[4] = '\0';
      pcVar3[5] = '\0';
      pcVar3[6] = '\0';
      pcVar3[7] = '\0';
      pcVar3 = pcVar3 + (ulong)bVar4 * -0x10 + 8;
    }
    iVar1 = GetTlvAutho("073",tlvInfo,tmpField,&nLength);
    if (iVar1 == 0) {
      PutIsoField(0x48,isoInfo,tmpField,nLength);
    }
    pcVar3 = tmpField;
    for (lVar2 = 0x200; lVar2 != 0; lVar2 = lVar2 + -1) {
      pcVar3[0] = '\0';
      pcVar3[1] = '\0';
      pcVar3[2] = '\0';
      pcVar3[3] = '\0';
      pcVar3[4] = '\0';
      pcVar3[5] = '\0';
      pcVar3[6] = '\0';
      pcVar3[7] = '\0';
      pcVar3 = pcVar3 + (ulong)bVar4 * -0x10 + 8;
    }
    iVar1 = GetTlvAutho("054",tlvInfo,tmpField,&nLength);
    if (iVar1 == 0) {
      PutIsoField(0x35,isoInfo,tmpField,nLength);
    }
    pcVar3 = tmpField;
    for (lVar2 = 0x200; lVar2 != 0; lVar2 = lVar2 + -1) {
      pcVar3[0] = '\0';
      pcVar3[1] = '\0';
      pcVar3[2] = '\0';
      pcVar3[3] = '\0';
      pcVar3[4] = '\0';
      pcVar3[5] = '\0';
      pcVar3[6] = '\0';
      pcVar3[7] = '\0';
      pcVar3 = pcVar3 + (ulong)bVar4 * -0x10 + 8;
    }
    iVar1 = GetTlvAutho("096",tlvInfo,tmpField,&nLength);
    if (iVar1 == 0) {
      PutIsoField(0x5f,isoInfo,tmpField,nLength);
    }
    pcVar3 = tmpField;
    for (lVar2 = 0x200; lVar2 != 0; lVar2 = lVar2 + -1) {
      pcVar3[0] = '\0';
      pcVar3[1] = '\0';
      pcVar3[2] = '\0';
      pcVar3[3] = '\0';
      pcVar3[4] = '\0';
      pcVar3[5] = '\0';
      pcVar3[6] = '\0';
      pcVar3[7] = '\0';
      pcVar3 = pcVar3 + (ulong)bVar4 * -0x10 + 8;
    }
    iVar1 = GetTlvAutho("102",tlvInfo,tmpField,&nLength);
    if (iVar1 == 0) {
      PutIsoField(0x65,isoInfo,tmpField,nLength);
    }
    pcVar3 = tmpField;
    for (lVar2 = 0x200; lVar2 != 0; lVar2 = lVar2 + -1) {
      pcVar3[0] = '\0';
      pcVar3[1] = '\0';
      pcVar3[2] = '\0';
      pcVar3[3] = '\0';
      pcVar3[4] = '\0';
      pcVar3[5] = '\0';
      pcVar3[6] = '\0';
      pcVar3[7] = '\0';
      pcVar3 = pcVar3 + (ulong)bVar4 * -0x10 + 8;
    }
    iVar1 = GetTlvAutho("062",tlvInfo,tmpField,&nLength);
    if (iVar1 == 0) {
      PutIsoField(0x3d,isoInfo,tmpField,nLength);
    }
    pcVar3 = tmpField;
    for (lVar2 = 0x200; lVar2 != 0; lVar2 = lVar2 + -1) {
      pcVar3[0] = '\0';
      pcVar3[1] = '\0';
      pcVar3[2] = '\0';
      pcVar3[3] = '\0';
      pcVar3[4] = '\0';
      pcVar3[5] = '\0';
      pcVar3[6] = '\0';
      pcVar3[7] = '\0';
      pcVar3 = pcVar3 + (ulong)bVar4 * -0x10 + 8;
    }
    iVar1 = GetTlvAutho("055",tlvInfo,tmpField,&nLength);
    if (iVar1 == 0) {
      nLen = 0;
      pcVar3 = sWork;
      for (lVar2 = 0x200; lVar2 != 0; lVar2 = lVar2 + -1) {
        pcVar3[0] = '\0';
        pcVar3[1] = '\0';
        pcVar3[2] = '\0';
        pcVar3[3] = '\0';
        pcVar3[4] = '\0';
        pcVar3[5] = '\0';
        pcVar3[6] = '\0';
        pcVar3[7] = '\0';
        pcVar3 = pcVar3 + (ulong)bVar4 * -0x10 + 8;
      }
      IccTlvToIso(tmpField,nLength,sWork,&nLen);
      if (0 < nLen) {
        PutIsoField(0x36,isoInfo,sWork,nLen);
      }
    }
    if (sens == '\x01') {
      pcVar3 = tmpField;
      for (lVar2 = 0x200; lVar2 != 0; lVar2 = lVar2 + -1) {
        pcVar3[0] = '\0';
        pcVar3[1] = '\0';
        pcVar3[2] = '\0';
        pcVar3[3] = '\0';
        pcVar3[4] = '\0';
        pcVar3[5] = '\0';
        pcVar3[6] = '\0';
        pcVar3[7] = '\0';
        pcVar3 = pcVar3 + (ulong)bVar4 * -0x10 + 8;
      }
      iVar1 = GetTlvAutho("102",tlvInfo,tmpField,&nLength);
      if (iVar1 == 0) {
        PutIsoField(0x65,isoInfo,tmpField,nLength);
      }
    }
    trace_event("TlvToIso( End ) ",5);
    iVar1 = 0;
  }
  return iVar1;
}



// WARNING: Unknown calling convention

int SafTlvToIso(int nIndiceCtx,TSTlvAutho *tlvInfo,TSIsoInfo *isoInfo)

{
  uint uVar1;
  int iVar2;
  int iVar3;
  long lVar4;
  uint uVar5;
  char *pcVar6;
  uint field_no;
  byte bVar7;
  char Tag [4];
  char sCurrency [4];
  int nLength;
  int nLen;
  char sMti [5];
  char sTermNbr [9];
  char sAmount [19];
  char sOrigAmounts [25];
  char acStack_303a [2];
  char tmpField [4096];
  char tmpData [4096];
  char sWork [4096];
  
  bVar7 = 0;
  trace_event("Start SafTlvToIso()",5);
  sMti[0] = '\0';
  sMti[1] = '\0';
  sMti[2] = '\0';
  sMti[3] = '\0';
  sMti[4] = '\0';
  Tag[0] = '\0';
  Tag[1] = '\0';
  Tag[2] = '\0';
  Tag[3] = '\0';
  uVar1 = 1;
  field_no = 0;
LAB_0042e978:
  uVar5 = uVar1;
  uVar1 = uVar5;
  switch(field_no) {
  default:
    goto switchD_0042e989_caseD_0;
  case 2:
    sprintf(Tag,"%.3d",3);
    pcVar6 = tmpData;
    for (lVar4 = 0x200; lVar4 != 0; lVar4 = lVar4 + -1) {
      pcVar6[0] = '\0';
      pcVar6[1] = '\0';
      pcVar6[2] = '\0';
      pcVar6[3] = '\0';
      pcVar6[4] = '\0';
      pcVar6[5] = '\0';
      pcVar6[6] = '\0';
      pcVar6[7] = '\0';
      pcVar6 = pcVar6 + (ulong)bVar7 * -0x10 + 8;
    }
    iVar2 = GetTlvAutho(Tag,tlvInfo,tmpData,&nLength);
    if (iVar2 != 0) goto LAB_0042e9d0;
    pcVar6 = tmpField;
    for (lVar4 = 0x200; lVar4 != 0; lVar4 = lVar4 + -1) {
      pcVar6[0] = '\0';
      pcVar6[1] = '\0';
      pcVar6[2] = '\0';
      pcVar6[3] = '\0';
      pcVar6[4] = '\0';
      pcVar6[5] = '\0';
      pcVar6[6] = '\0';
      pcVar6[7] = '\0';
      pcVar6 = pcVar6 + (ulong)bVar7 * -0x10 + 8;
    }
    tmpField[0] = tmpData[6];
    tmpField[1] = tmpData[7];
    tmpField[2] = tmpData[0xe];
    tmpField[3] = tmpData[0xf];
    tmpField[4] = tmpData[0x16];
    tmpField[5] = tmpData[0x17];
    PutIsoField(2,isoInfo,tmpField,6);
    goto LAB_0042e9d0;
  case 3:
    sprintf(Tag,"%.3d",4);
    iVar2 = GetTlvAutho(Tag,tlvInfo,sAmount,&nLength);
    if (iVar2 != 0) goto LAB_0042e9d0;
    iVar2 = GetTlvAutho("049",tlvInfo,sCurrency,&nLength);
    if (iVar2 != 0) goto LAB_0042e9d0;
    pcVar6 = tmpField;
    for (lVar4 = 0x200; lVar4 != 0; lVar4 = lVar4 + -1) {
      pcVar6[0] = '\0';
      pcVar6[1] = '\0';
      pcVar6[2] = '\0';
      pcVar6[3] = '\0';
      pcVar6[4] = '\0';
      pcVar6[5] = '\0';
      pcVar6[6] = '\0';
      pcVar6[7] = '\0';
      pcVar6 = pcVar6 + (ulong)bVar7 * -0x10 + 8;
    }
    iVar2 = AdjustIsoAmount(nIndiceCtx,sAmount,sCurrency,tmpField);
    if (iVar2 == 0) {
      PutIsoField(3,isoInfo,tmpField,0xc);
      goto LAB_0042e9d0;
    }
    break;
  case 4:
    sAmount[0] = '\0';
    sAmount[1] = '\0';
    sAmount[2] = '\0';
    sAmount[3] = '\0';
    sAmount[4] = '\0';
    sAmount[5] = '\0';
    sAmount[6] = '\0';
    sAmount[7] = '\0';
    sAmount[0x10] = '\0';
    sAmount[0x11] = '\0';
    sAmount[8] = '\0';
    sAmount[9] = '\0';
    sAmount[10] = '\0';
    sAmount[0xb] = '\0';
    sAmount[0xc] = '\0';
    sAmount[0xd] = '\0';
    sAmount[0xe] = '\0';
    sAmount[0xf] = '\0';
    sAmount[0x12] = '\0';
    iVar2 = GetTlvAutho("213",tlvInfo,sAmount,&nLength);
    if (iVar2 != 0) goto LAB_0042e9d0;
    sCurrency[0] = '\0';
    sCurrency[1] = '\0';
    sCurrency[2] = '\0';
    sCurrency[3] = '\0';
    iVar2 = GetTlvAutho("214",tlvInfo,sCurrency,&nLength);
    if (iVar2 != 0) goto LAB_0042e9d0;
    pcVar6 = tmpField;
    for (lVar4 = 0x200; lVar4 != 0; lVar4 = lVar4 + -1) {
      pcVar6[0] = '\0';
      pcVar6[1] = '\0';
      pcVar6[2] = '\0';
      pcVar6[3] = '\0';
      pcVar6[4] = '\0';
      pcVar6[5] = '\0';
      pcVar6[6] = '\0';
      pcVar6[7] = '\0';
      pcVar6 = pcVar6 + (ulong)bVar7 * -0x10 + 8;
    }
    iVar2 = AdjustIsoAmount(nIndiceCtx,sAmount,sCurrency,tmpField);
    if (iVar2 == 0) {
      PutIsoField(4,isoInfo,tmpField,0xc);
      goto LAB_0042e9d0;
    }
    break;
  case 5:
    sprintf(Tag,"%.3d",6);
    iVar2 = GetTlvAutho(Tag,tlvInfo,sAmount,&nLength);
    if (iVar2 != 0) goto LAB_0042e9d0;
    iVar2 = GetTlvAutho("051",tlvInfo,sCurrency,&nLength);
    if (iVar2 != 0) goto LAB_0042e9d0;
    pcVar6 = tmpField;
    for (lVar4 = 0x200; lVar4 != 0; lVar4 = lVar4 + -1) {
      pcVar6[0] = '\0';
      pcVar6[1] = '\0';
      pcVar6[2] = '\0';
      pcVar6[3] = '\0';
      pcVar6[4] = '\0';
      pcVar6[5] = '\0';
      pcVar6[6] = '\0';
      pcVar6[7] = '\0';
      pcVar6 = pcVar6 + (ulong)bVar7 * -0x10 + 8;
    }
    iVar2 = AdjustIsoAmount(nIndiceCtx,sAmount,sCurrency,tmpField);
    if (iVar2 == 0) {
      PutIsoField(5,isoInfo,tmpField,0xc);
      goto LAB_0042e9d0;
    }
    break;
  case 8:
    iVar2 = GetTlvAutho("216",tlvInfo,tmpField,&nLength);
    if (iVar2 != 0) goto LAB_0042e9d0;
    PutIsoField(8,isoInfo,tmpField,8);
    goto LAB_0042e9d0;
  case 9:
    iVar2 = GetTlvAutho("010",tlvInfo,tmpField,&nLength);
    if (iVar2 != 0) goto LAB_0042e9d0;
    PutIsoField(9,isoInfo,tmpField,8);
    goto LAB_0042e9d0;
  case 0xe:
    pcVar6 = tmpField;
    for (lVar4 = 0x200; lVar4 != 0; lVar4 = lVar4 + -1) {
      pcVar6[0] = '\0';
      pcVar6[1] = '\0';
      pcVar6[2] = '\0';
      pcVar6[3] = '\0';
      pcVar6[4] = '\0';
      pcVar6[5] = '\0';
      pcVar6[6] = '\0';
      pcVar6[7] = '\0';
      pcVar6 = pcVar6 + (ulong)bVar7 * -0x10 + 8;
    }
    iVar2 = GetTlvAutho("015",tlvInfo,tmpField,&nLength);
    if (iVar2 != 0) goto LAB_0042e9d0;
    PutIsoField(0xe,isoInfo,tmpField,4);
    goto LAB_0042e9d0;
  case 0xf:
    pcVar6 = tmpField;
    for (lVar4 = 0x200; lVar4 != 0; lVar4 = lVar4 + -1) {
      pcVar6[0] = '\0';
      pcVar6[1] = '\0';
      pcVar6[2] = '\0';
      pcVar6[3] = '\0';
      pcVar6[4] = '\0';
      pcVar6[5] = '\0';
      pcVar6[6] = '\0';
      pcVar6[7] = '\0';
      pcVar6 = pcVar6 + (ulong)bVar7 * -0x10 + 8;
    }
    iVar2 = GetTlvAutho("016",tlvInfo,tmpField,&nLength);
    if (iVar2 != 0) goto LAB_0042e9d0;
    PutIsoField(0xf,isoInfo,tmpField,4);
    goto LAB_0042e9d0;
  case 0x1d:
    sAmount[0x10] = '\0';
    sAmount[0x11] = '\0';
    sAmount[0] = '\0';
    sAmount[1] = '\0';
    sAmount[2] = '\0';
    sAmount[3] = '\0';
    sAmount[4] = '\0';
    sAmount[5] = '\0';
    sAmount[6] = '\0';
    sAmount[7] = '\0';
    sAmount[8] = '\0';
    sAmount[9] = '\0';
    sAmount[10] = '\0';
    sAmount[0xb] = '\0';
    sAmount[0xc] = '\0';
    sAmount[0xd] = '\0';
    sAmount[0xe] = '\0';
    sAmount[0xf] = '\0';
    sAmount[0x12] = '\0';
    sOrigAmounts[0] = '\0';
    sOrigAmounts[1] = '\0';
    sOrigAmounts[2] = '\0';
    sOrigAmounts[3] = '\0';
    sOrigAmounts[4] = '\0';
    sOrigAmounts[5] = '\0';
    sOrigAmounts[6] = '\0';
    sOrigAmounts[7] = '\0';
    sOrigAmounts[8] = '\0';
    sOrigAmounts[9] = '\0';
    sOrigAmounts[10] = '\0';
    sOrigAmounts[0xb] = '\0';
    sOrigAmounts[0xc] = '\0';
    sOrigAmounts[0xd] = '\0';
    sOrigAmounts[0xe] = '\0';
    sOrigAmounts[0xf] = '\0';
    sOrigAmounts[0x10] = '\0';
    sOrigAmounts[0x11] = '\0';
    sOrigAmounts[0x12] = '\0';
    sOrigAmounts[0x13] = '\0';
    sOrigAmounts[0x14] = '\0';
    sOrigAmounts[0x15] = '\0';
    sOrigAmounts[0x16] = '\0';
    sOrigAmounts[0x17] = '\0';
    sOrigAmounts[0x18] = '\0';
    iVar2 = GetTlvAutho("295",tlvInfo,sAmount,&nLength);
    if (iVar2 != 0) goto LAB_0042e9d0;
    iVar2 = GetTlvAutho("051",tlvInfo,sCurrency,&nLength);
    if (iVar2 != 0) goto LAB_0042e9d0;
    pcVar6 = tmpField;
    for (lVar4 = 0x200; lVar4 != 0; lVar4 = lVar4 + -1) {
      pcVar6[0] = '\0';
      pcVar6[1] = '\0';
      pcVar6[2] = '\0';
      pcVar6[3] = '\0';
      pcVar6[4] = '\0';
      pcVar6[5] = '\0';
      pcVar6[6] = '\0';
      pcVar6[7] = '\0';
      pcVar6 = pcVar6 + (ulong)bVar7 * -0x10 + 8;
    }
    iVar2 = AdjustIsoAmount(nIndiceCtx,sAmount,sCurrency,tmpField);
    if (iVar2 == 0) {
      sOrigAmounts[0xe] = tmpField[2];
      sOrigAmounts[0xf] = tmpField[3];
      sOrigAmounts[0xc] = tmpField[0];
      sOrigAmounts[0xd] = tmpField[1];
      sAmount[0] = '\0';
      sAmount[1] = '\0';
      sAmount[2] = '\0';
      sAmount[3] = '\0';
      sAmount[4] = '\0';
      sAmount[5] = '\0';
      sAmount[6] = '\0';
      sAmount[7] = '\0';
      sAmount[8] = '\0';
      sAmount[9] = '\0';
      sAmount[10] = '\0';
      sAmount[0xb] = '\0';
      sAmount[0xc] = '\0';
      sAmount[0xd] = '\0';
      sAmount[0xe] = '\0';
      sAmount[0xf] = '\0';
      sAmount[0x12] = '\0';
      sOrigAmounts._16_4_ =
           (undefined4)
           (CONCAT26(tmpField._6_2_,CONCAT24(tmpField._4_2_,sOrigAmounts._12_4_)) >> 0x20);
      sOrigAmounts[0x14] = tmpField[8];
      sOrigAmounts[0x15] = tmpField[9];
      sOrigAmounts[0x16] = tmpField[10];
      sOrigAmounts[0x17] = tmpField[0xb];
      sAmount[0x10] = '\0';
      sAmount[0x11] = '\0';
      sCurrency[0] = '\0';
      sCurrency[1] = '\0';
      sCurrency[2] = '\0';
      sCurrency[3] = '\0';
      GetTlvAutho("294",tlvInfo,sAmount,&nLength);
      GetTlvAutho("049",tlvInfo,sCurrency,&nLength);
      pcVar6 = tmpField;
      for (lVar4 = 0x200; lVar4 != 0; lVar4 = lVar4 + -1) {
        pcVar6[0] = '\0';
        pcVar6[1] = '\0';
        pcVar6[2] = '\0';
        pcVar6[3] = '\0';
        pcVar6[4] = '\0';
        pcVar6[5] = '\0';
        pcVar6[6] = '\0';
        pcVar6[7] = '\0';
        pcVar6 = pcVar6 + (ulong)bVar7 * -0x10 + 8;
      }
      iVar2 = AdjustIsoAmount(nIndiceCtx,sAmount,sCurrency,tmpField);
      if (iVar2 == 0) {
        sOrigAmounts[2] = tmpField[2];
        sOrigAmounts[3] = tmpField[3];
        sOrigAmounts[0] = tmpField[0];
        sOrigAmounts[1] = tmpField[1];
        sOrigAmounts[4] = tmpField[4];
        sOrigAmounts[5] = tmpField[5];
        sOrigAmounts[6] = tmpField[6];
        sOrigAmounts[7] = tmpField[7];
        sOrigAmounts[8] = tmpField[8];
        sOrigAmounts[9] = tmpField[9];
        sOrigAmounts[10] = tmpField[10];
        sOrigAmounts[0xb] = tmpField[0xb];
        PutIsoField(0x1d,isoInfo,sOrigAmounts,0x18);
        goto LAB_0042e9d0;
      }
    }
    break;
  case 0x28:
    sTermNbr[0] = '\0';
    sTermNbr[1] = '\0';
    sTermNbr[2] = '\0';
    sTermNbr[3] = '\0';
    sTermNbr[4] = '\0';
    sTermNbr[5] = '\0';
    sTermNbr[6] = '\0';
    sTermNbr[7] = '\0';
    sTermNbr[8] = '\0';
    iVar3 = GetTlvAutho("041",tlvInfo,tmpField,&nLength);
    iVar2 = nLength;
    if (iVar3 != 0) goto LAB_0042e9d0;
    lVar4 = (long)nLength;
    if (nLength < 9) {
      memcpy(sTermNbr,tmpField,(long)nLength);
    }
    else {
      nLength = 8;
      iVar2 = 8;
      builtin_strncpy(sTermNbr,"00000000",8);
                    // WARNING: Ignoring partial resolution of indirect
      sTermNbr._6_2_ = *(undefined2 *)(acStack_303a + lVar4);
    }
    PutIsoField(0x28,isoInfo,sTermNbr,iVar2);
    goto LAB_0042e9d0;
  case 0x31:
    iVar2 = GetTlvAutho("050",tlvInfo,sCurrency,&nLength);
    if (iVar2 != 0) goto LAB_0042e9d0;
    PutIsoField(0x31,isoInfo,sCurrency,3);
    goto LAB_0042e9d0;
  case 0x36:
    iVar2 = GetTlvAutho("055",tlvInfo,tmpField,&nLength);
    if (iVar2 != 0) goto LAB_0042e9d0;
    nLen = 0;
    pcVar6 = sWork;
    for (lVar4 = 0x200; lVar4 != 0; lVar4 = lVar4 + -1) {
      pcVar6[0] = '\0';
      pcVar6[1] = '\0';
      pcVar6[2] = '\0';
      pcVar6[3] = '\0';
      pcVar6[4] = '\0';
      pcVar6[5] = '\0';
      pcVar6[6] = '\0';
      pcVar6[7] = '\0';
      pcVar6 = pcVar6 + (ulong)bVar7 * -0x10 + 8;
    }
    IccTlvToIso(tmpField,nLength,sWork,&nLen);
    if (nLen < 1) goto LAB_0042e9d0;
    PutIsoField(0x36,isoInfo,sWork,nLen);
    goto LAB_0042e9d0;
  case 0x73:
    sAmount[0] = '\0';
    sAmount[1] = '\0';
    sAmount[2] = '\0';
    sAmount[3] = '\0';
    sAmount[4] = '\0';
    sAmount[5] = '\0';
    sAmount[6] = '\0';
    sAmount[7] = '\0';
    sAmount[0x10] = '\0';
    sAmount[0x11] = '\0';
    sAmount[8] = '\0';
    sAmount[9] = '\0';
    sAmount[10] = '\0';
    sAmount[0xb] = '\0';
    sAmount[0xc] = '\0';
    sAmount[0xd] = '\0';
    sAmount[0xe] = '\0';
    sAmount[0xf] = '\0';
    sAmount[0x12] = '\0';
    iVar2 = GetTlvAutho("046",tlvInfo,sAmount,&nLength);
    if (iVar2 != 0) goto LAB_0042e9d0;
    sCurrency[0] = '\0';
    sCurrency[1] = '\0';
    sCurrency[2] = '\0';
    sCurrency[3] = '\0';
    iVar2 = GetTlvAutho("051",tlvInfo,sCurrency,&nLength);
    if (iVar2 != 0) goto LAB_0042e9d0;
    pcVar6 = tmpField;
    for (lVar4 = 0x200; lVar4 != 0; lVar4 = lVar4 + -1) {
      pcVar6[0] = '\0';
      pcVar6[1] = '\0';
      pcVar6[2] = '\0';
      pcVar6[3] = '\0';
      pcVar6[4] = '\0';
      pcVar6[5] = '\0';
      pcVar6[6] = '\0';
      pcVar6[7] = '\0';
      pcVar6 = pcVar6 + (ulong)bVar7 * -0x10 + 8;
    }
    iVar2 = AdjustIsoAmount(nIndiceCtx,sAmount,sCurrency,tmpField);
    if (iVar2 == 0) {
      PutIsoField(0x73,isoInfo,tmpField,0xc);
      goto LAB_0042e9d0;
    }
  }
  return -1;
switchD_0042e989_caseD_0:
  do {
    uVar5 = uVar1;
    sprintf(Tag,"%03d",(ulong)uVar5);
    iVar2 = GetTlvAutho(Tag,tlvInfo,tmpField,&nLength);
    if (iVar2 == 0) {
      PutIsoField(field_no,isoInfo,tmpField,nLength);
    }
    if (uVar5 == 0x80) {
      GetTlvAutho("300",tlvInfo,sMti,&nLength);
      iVar2 = atoi(sMti);
      isoInfo->nMsgType = iVar2;
      trace_event("End   SafTlvToIso()",5);
      return 0;
    }
LAB_0042e9d0:
    uVar1 = uVar5 + 1;
    field_no = uVar5;
  } while (0x73 < uVar5);
  goto LAB_0042e978;
}



// WARNING: Unknown calling convention

void GetInternalStan(int nIndiceCtx,char *sInternalStan)

{
  int response_code;
  char T_stan_seq [7];
  sqlca sqlca;
  char sLine [512];
  
  trace_event("Start GetInternalStan() ",5);
  sLine._184_8_ = T_stan_seq;
  sLine._40_8_ = &sqlca;
  sLine._56_8_ = &sqladt;
  sLine._64_8_ = &sqltds;
  T_stan_seq[4] = '\0';
  T_stan_seq[5] = '\0';
  sLine[0x16] = '\0';
  sLine[0x17] = '\x11';
  sLine[0x110] = '\0';
  sLine[0x111] = '\0';
  sLine._48_8_ = s_begin__response_code____PCRD_GEN_004a9598;
  sLine[0x114] = '\0';
  sLine[0x115] = '\0';
  sLine[0x112] = '\0';
  sLine[0x113] = '\0';
  sLine[0x116] = '\0';
  sLine[0x117] = '\0';
  sLine._32_8_ = sqlcud0;
  sLine._176_8_ = &response_code;
  T_stan_seq[0] = '\0';
  T_stan_seq[1] = '\0';
  T_stan_seq[2] = '\0';
  T_stan_seq[3] = '\0';
  T_stan_seq[6] = '\0';
  response_code = 0x38d;
  sLine._72_8_ = sLine + 0xb0;
  sLine[0] = '\f';
  sLine[1] = '\0';
  sLine[2] = '\0';
  sLine[3] = '\0';
  sLine[4] = '\0';
  sLine[5] = '\0';
  sLine[6] = '\0';
  sLine[7] = '\0';
  sLine[8] = '\x02';
  sLine[9] = '\0';
  sLine[10] = '\0';
  sLine[0xb] = '\0';
  sLine[0xc] = '\x01';
  sLine[0xd] = '\0';
  sLine[0xe] = '\0';
  sLine[0xf] = '\0';
  sLine._80_8_ = sLine + 0xc0;
  sLine[0x10] = '\x05';
  sLine[0x11] = '\0';
  sLine[0x12] = '\0';
  sLine[0x13] = '\0';
  sLine[0x18] = '\0';
  sLine[0x19] = '\0';
  sLine[0x1a] = '\0';
  sLine[0x1b] = '\0';
  sLine._88_8_ = sLine + 0xd0;
  sLine[0xc0] = '\x04';
  sLine[0xc1] = '\0';
  sLine[0xc2] = '\0';
  sLine[0xc3] = '\0';
  sLine[0xc4] = '\0';
  sLine[0xc5] = '\0';
  sLine[0xc6] = '\0';
  sLine[199] = '\0';
  sLine[0xd0] = '\0';
  sLine[0xd1] = '\0';
  sLine[0xd2] = '\0';
  sLine[0xd3] = '\0';
  sLine[0xd8] = '\0';
  sLine[0xd9] = '\0';
  sLine[0xda] = '\0';
  sLine[0xdb] = '\0';
  sLine[0xdc] = '\0';
  sLine[0xdd] = '\0';
  sLine[0xde] = '\0';
  sLine[0xdf] = '\0';
  sLine[0xe8] = '\0';
  sLine[0xe9] = '\0';
  sLine[0xea] = '\0';
  sLine[0xeb] = '\0';
  sLine[0xf0] = '\0';
  sLine[0xf1] = '\0';
  sLine[0xf2] = '\0';
  sLine[0xf3] = '\0';
  sLine[0xf4] = '\0';
  sLine[0xf5] = '\0';
  sLine[0xf6] = '\0';
  sLine[0xf7] = '\0';
  sLine[200] = '\a';
  sLine[0xc9] = '\0';
  sLine[0xca] = '\0';
  sLine[0xcb] = '\0';
  sLine[0xcc] = '\0';
  sLine[0xcd] = '\0';
  sLine[0xce] = '\0';
  sLine[0xcf] = '\0';
  sLine[0xd4] = '\0';
  sLine[0xd5] = '\0';
  sLine[0xd6] = '\0';
  sLine[0xd7] = '\0';
  sLine[0xe0] = '\0';
  sLine[0xe1] = '\0';
  sLine[0xe2] = '\0';
  sLine[0xe3] = '\0';
  sLine[0xe4] = '\0';
  sLine[0xe5] = '\0';
  sLine[0xe6] = '\0';
  sLine[0xe7] = '\0';
  sLine[0xec] = '\0';
  sLine[0xed] = '\0';
  sLine[0xee] = '\0';
  sLine[0xef] = '\0';
  sLine[0xf8] = '\0';
  sLine[0xf9] = '\0';
  sLine[0xfa] = '\0';
  sLine[0xfb] = '\0';
  sLine[0xfc] = '\0';
  sLine[0xfd] = '\0';
  sLine[0xfe] = '\0';
  sLine[0xff] = '\0';
  sLine._96_8_ = sLine + 0xd8;
  sLine._104_8_ = sLine + 0xe8;
  sLine._112_8_ = sLine + 0xf0;
  sLine._120_8_ = sLine + 0x100;
  sLine._128_8_ = sLine + 0x110;
  sLine._136_8_ = sLine + 0x114;
  sqlcxt((long)nIndiceCtx * 0x10 + 0x713948,&sqlctx,sLine,&sqlfpn);
  if (sqlca.sqlcode < 0) {
    sprintf(sLine,"%.40s",sqlca.sqlerrm.sqlerrmc);
    trace_event(sLine,1);
    builtin_strncpy(sInternalStan,"999999",6);
    trace_event("End GetInternalStan(SYSTEM_MALFUNCTION)",5);
  }
  else {
    if (response_code == 0) {
      *(undefined4 *)sInternalStan = T_stan_seq._0_4_;
      *(undefined2 *)(sInternalStan + 4) = T_stan_seq._4_2_;
    }
    else {
      builtin_strncpy(sInternalStan,"999999",6);
    }
    sInternalStan[6] = '\0';
    sprintf(sLine,"End GetInternalStan(%d | %s)",(ulong)(uint)response_code,sInternalStan);
    trace_event(sLine,5);
  }
  return;
}



// WARNING: Unknown calling convention

int ResetResource(int nIndexCtx,char *p_ResourceId,char *p_InternalId)

{
  int iVar1;
  int T_resource_pid;
  int T_resource_ppid;
  int result;
  char T_resource_id [7];
  anon_struct_34_2_43c7b5cf T_internal_id;
  sqlexd_conflict1 sqlstm;
  char sLine [512];
  
  sprintf(sLine,"**** debug mode 0-OFF , 1-ON : [%d] ****",(ulong)(uint)debug_option);
  trace_event(sLine,0);
  trace_event("Start  ResetResource()",5);
  T_resource_id._0_4_ = *(undefined4 *)p_ResourceId;
  T_internal_id.arr[0] = '\0';
  T_internal_id.arr[1] = '\0';
  T_internal_id.arr[2] = '\0';
  T_internal_id.arr[3] = '\0';
  T_internal_id.arr[4] = '\0';
  T_internal_id.arr[5] = '\0';
  T_internal_id.arr[6] = '\0';
  T_internal_id.arr[7] = '\0';
  T_internal_id.len = 0;
  T_resource_id[6] = '\0';
  T_internal_id.arr[8] = '\0';
  T_internal_id.arr[9] = '\0';
  T_internal_id.arr[10] = '\0';
  T_internal_id.arr[0xb] = '\0';
  T_internal_id.arr[0xc] = '\0';
  T_internal_id.arr[0xd] = '\0';
  T_internal_id.arr[0xe] = '\0';
  T_internal_id.arr[0xf] = '\0';
  T_internal_id.arr[0x10] = '\0';
  T_internal_id.arr[0x11] = '\0';
  T_internal_id.arr[0x12] = '\0';
  T_internal_id.arr[0x13] = '\0';
  T_internal_id.arr[0x14] = '\0';
  T_internal_id.arr[0x15] = '\0';
  T_internal_id.arr[0x16] = '\0';
  T_internal_id.arr[0x17] = '\0';
  T_resource_id._4_2_ = *(undefined2 *)(p_ResourceId + 4);
  T_internal_id.arr[0x18] = '\0';
  T_internal_id.arr[0x19] = '\0';
  T_internal_id.arr[0x1a] = '\0';
  T_internal_id.arr[0x1b] = '\0';
  T_internal_id.arr[0x1c] = '\0';
  T_internal_id.arr[0x1d] = '\0';
  T_internal_id.arr[0x1e] = '\0';
  T_internal_id.arr[0x1f] = '\0';
  T_resource_pid = getpid();
  T_resource_ppid = getppid();
  sqlstm.sqphsv = sqlstm.sqhstv;
  sqlstm.sqladtp = &sqladt;
  sqlstm.sqadto[0] = 0;
  sqlstm.sqltdsp = &sqltds;
  sqlstm.sqlety = 0x1100;
  sqlstm.sqtdso[0] = 0;
  sqlstm.stmt = 
  "begin :result := PCRD_P7_FUNCTION_TOOLS . RESET_RESOURCE ( :T_resource_id , :T_resource_pid , :T_resource_ppid , :T_internal_id ) ; END ;"
  ;
  sqlstm.sqadto[1] = 0;
  sqlstm.sqtdso[1] = 0;
  sqlstm.sqlvsn = 0xc;
  sqlstm.cud = sqlcud0;
  sqlstm.sqhstv[0] = (uchar *)&result;
  sqlstm.arrsiz = 5;
  sqlstm.iters = 1;
  sqlstm.offset = 5;
  sqlstm.sqhstv[2] = (uchar *)&T_resource_pid;
  sqlstm.sqlest = (uchar *)&sqlca;
  sqlstm.occurs = 0;
  sqlstm.sqhstl[0] = 4;
  sqlstm.sqhsts[0] = 0;
  sqlstm.sqhstv[3] = (uchar *)&T_resource_ppid;
  sqlstm.sqindv[0] = (short *)0x0;
  sqlstm.sqinds[0] = 0;
  sqlstm.sqharm[0] = 0;
  sqlstm.sqhstl[1] = 7;
  sqlstm.sqhsts[1] = 0;
  sqlstm.sqindv[1] = (short *)0x0;
  sqlstm.sqinds[1] = 0;
  sqlstm.sqharm[1] = 0;
  sqlstm.sqhstl[2] = 4;
  sqlstm.sqhsts[2] = 0;
  sqlstm.sqindv[2] = (short *)0x0;
  sqlstm.sqinds[2] = 0;
  sqlstm.sqphsl = sqlstm.sqhstl;
  sqlstm.sqharm[2] = 0;
  sqlstm.sqphss = sqlstm.sqhsts;
  sqlstm.sqtdso[3] = 0;
  sqlstm.sqadto[2] = 0;
  sqlstm.sqtdso[2] = 0;
  sqlstm.sqpind = sqlstm.sqindv;
  sqlstm.sqadto[4] = 0;
  sqlstm.sqpins = sqlstm.sqinds;
  sqlstm.sqtdso[4] = 0;
  sqlstm.sqhstl[3] = 4;
  sqlstm.sqhsts[3] = 0;
  sqlstm.sqparm = sqlstm.sqharm;
  sqlstm.sqindv[3] = (short *)0x0;
  sqlstm.sqinds[3] = 0;
  sqlstm.sqharm[3] = 0;
  sqlstm.sqparc = sqlstm.sqharc;
  sqlstm.sqadto[3] = 0;
  sqlstm.sqhstl[4] = 0x22;
  sqlstm.sqpadto = sqlstm.sqadto;
  sqlstm.sqhsts[4] = 0;
  sqlstm.sqindv[4] = (short *)0x0;
  sqlstm.sqinds[4] = 0;
  sqlstm.sqptdso = sqlstm.sqtdso;
  sqlstm.sqharm[4] = 0;
  sqlstm.sqhstv[1] = (uchar *)T_resource_id;
  sqlstm.sqhstv[4] = (uchar *)&T_internal_id;
  sqlcxt((long)nIndexCtx * 0x10 + 0x713948,&sqlctx,&sqlstm,&sqlfpn);
  if (sqlca.sqlcode < 0) {
    trace_event("End ResetResource (MALFUNCTION)",5);
    iVar1 = -1;
  }
  else {
    trace_event("Start  ResetResource()",5);
    if (result == 0) {
      memcpy(p_InternalId,T_internal_id.arr,(ulong)T_internal_id.len);
      trace_event("End ResetResource(OK)",5);
      iVar1 = 0;
    }
    else {
      trace_event("End ResetResource(NOK)",5);
      iVar1 = -1;
    }
  }
  return iVar1;
}



// WARNING: Unknown calling convention

int UpdateResource(int nIndexCtx,char *p_ResourceId,char *p_ResourceLive,char *p_ProcessingStep)

{
  int iVar1;
  char T_resource_live [2];
  char T_processing_step [4];
  int result;
  char T_resource_id [7];
  sqlexd_conflict1 sqlstm;
  char sLine [512];
  
  trace_event("Start  UpdateResource()",5);
  T_resource_id._0_4_ = *(undefined4 *)p_ResourceId;
  T_resource_id[6] = '\0';
  T_resource_id._4_2_ = *(undefined2 *)(p_ResourceId + 4);
  T_resource_live[1] = '\0';
  T_resource_live[0] = *p_ResourceLive;
  T_processing_step[3] = '\0';
  T_processing_step._0_3_ = *(uint3 *)p_ProcessingStep;
  sprintf(sLine,"Resource Id     = %.6s ",p_ResourceId);
  trace_event(sLine,5);
  sprintf(sLine,"Resource Live   = %.1s ",p_ResourceLive);
  trace_event(sLine,5);
  sprintf(sLine,"Processing Step = %.3s ",p_ProcessingStep);
  trace_event(sLine,5);
  sqlstm.sqladtp = &sqladt;
  sqlstm.sqltdsp = &sqltds;
  sqlstm.sqlety = 0x1100;
  sqlstm.sqadto[0] = 0;
  sqlstm.sqtdso[0] = 0;
  sqlstm.stmt = 
  "begin :result := PCRD_P7_FUNCTION_TOOLS . UPDATE_RESOURCE ( :T_resource_id , :T_resource_live , :T_processing_step ) ; END ;"
  ;
  sqlstm.sqadto[1] = 0;
  sqlstm.sqtdso[1] = 0;
  sqlstm.cud = sqlcud0;
  sqlstm.sqhstv[0] = (uchar *)&result;
  sqlstm.sqlvsn = 0xc;
  sqlstm.arrsiz = 5;
  sqlstm.iters = 1;
  sqlstm.sqphsv = sqlstm.sqhstv;
  sqlstm.offset = 0x28;
  sqlstm.sqlest = (uchar *)&sqlca;
  sqlstm.occurs = 0;
  sqlstm.sqhstl[0] = 4;
  sqlstm.sqhsts[0] = 0;
  sqlstm.sqindv[0] = (short *)0x0;
  sqlstm.sqinds[0] = 0;
  sqlstm.sqharm[0] = 0;
  sqlstm.sqhstl[1] = 7;
  sqlstm.sqhsts[1] = 0;
  sqlstm.sqindv[1] = (short *)0x0;
  sqlstm.sqinds[1] = 0;
  sqlstm.sqharm[1] = 0;
  sqlstm.sqhstl[2] = 2;
  sqlstm.sqhsts[2] = 0;
  sqlstm.sqindv[2] = (short *)0x0;
  sqlstm.sqinds[2] = 0;
  sqlstm.sqphsl = sqlstm.sqhstl;
  sqlstm.sqharm[2] = 0;
  sqlstm.sqadto[2] = 0;
  sqlstm.sqphss = sqlstm.sqhsts;
  sqlstm.sqtdso[2] = 0;
  sqlstm.sqhstl[3] = 4;
  sqlstm.sqpind = sqlstm.sqindv;
  sqlstm.sqhsts[3] = 0;
  sqlstm.sqpins = sqlstm.sqinds;
  sqlstm.sqindv[3] = (short *)0x0;
  sqlstm.sqinds[3] = 0;
  sqlstm.sqharm[3] = 0;
  sqlstm.sqparm = sqlstm.sqharm;
  sqlstm.sqadto[3] = 0;
  sqlstm.sqtdso[3] = 0;
  sqlstm.sqparc = sqlstm.sqharc;
  sqlstm.sqpadto = sqlstm.sqadto;
  sqlstm.sqptdso = sqlstm.sqtdso;
  sqlstm.sqhstv[1] = (uchar *)T_resource_id;
  sqlstm.sqhstv[2] = (uchar *)T_resource_live;
  sqlstm.sqhstv[3] = (uchar *)T_processing_step;
  sqlcxt((long)nIndexCtx * 0x10 + 0x713948,&sqlctx,&sqlstm,&sqlfpn);
  if (sqlca.sqlcode < 0) {
    strcpy(sLine,sqlca.sqlerrm.sqlerrmc);
    trace_event(sLine,4);
    trace_event("End UpdateResource (MALFUNCTION)",5);
    iVar1 = -1;
  }
  else if (result == 0) {
    trace_event("End UpdateResource(OK)",5);
    iVar1 = 0;
  }
  else {
    trace_event("End UpdateResource(NOK)",5);
    iVar1 = -1;
  }
  return iVar1;
}



// WARNING: Unknown calling convention

int ResourceActivity(int nIndexCtx,char *pResourceId,int pActivity)

{
  int iVar1;
  int T_activity;
  int result;
  char T_resource_id [7];
  sqlexd_conflict1 sqlstm;
  
  T_resource_id._0_4_ = *(undefined4 *)pResourceId;
  sqlstm.sqladtp = &sqladt;
  sqlstm.sqhstv[1] = (uchar *)T_resource_id;
  sqlstm.sqlety = 0x1100;
  T_resource_id._4_2_ = *(undefined2 *)(pResourceId + 4);
  sqlstm.sqhstv[0] = (uchar *)&result;
  sqlstm.stmt = 
  "begin :result := PCRD_P7_FUNCTION_TOOLS . RESOURCE_ACTIVITY ( :T_resource_id , :T_activity ) ; END ;"
  ;
  sqlstm.sqhstv[2] = (uchar *)&T_activity;
  sqlstm.cud = sqlcud0;
  sqlstm.sqlest = (uchar *)&sqlca;
  sqlstm.sqtdso[0] = 0;
  T_resource_id[6] = '\0';
  sqlstm.sqltdsp = &sqltds;
  sqlstm.sqlvsn = 0xc;
  sqlstm.sqadto[0] = 0;
  sqlstm.arrsiz = 5;
  sqlstm.iters = 1;
  sqlstm.offset = 0x47;
  sqlstm.occurs = 0;
  sqlstm.sqhstl[0] = 4;
  sqlstm.sqhsts[0] = 0;
  sqlstm.sqindv[0] = (short *)0x0;
  sqlstm.sqinds[0] = 0;
  sqlstm.sqharm[0] = 0;
  sqlstm.sqhstl[1] = 7;
  sqlstm.sqhsts[1] = 0;
  sqlstm.sqindv[1] = (short *)0x0;
  sqlstm.sqinds[1] = 0;
  sqlstm.sqharm[1] = 0;
  sqlstm.sqphsv = sqlstm.sqhstv;
  sqlstm.sqadto[1] = 0;
  sqlstm.sqphsl = sqlstm.sqhstl;
  sqlstm.sqtdso[1] = 0;
  sqlstm.sqhstl[2] = 4;
  sqlstm.sqhsts[2] = 0;
  sqlstm.sqphss = sqlstm.sqhsts;
  sqlstm.sqindv[2] = (short *)0x0;
  sqlstm.sqinds[2] = 0;
  sqlstm.sqharm[2] = 0;
  sqlstm.sqpind = sqlstm.sqindv;
  sqlstm.sqadto[2] = 0;
  sqlstm.sqtdso[2] = 0;
  sqlstm.sqpins = sqlstm.sqinds;
  sqlstm.sqparm = sqlstm.sqharm;
  sqlstm.sqparc = sqlstm.sqharc;
  sqlstm.sqpadto = sqlstm.sqadto;
  sqlstm.sqptdso = sqlstm.sqtdso;
  T_activity = pActivity;
  sqlcxt((long)nIndexCtx * 0x10 + 0x713948,&sqlctx,&sqlstm,&sqlfpn);
  if (sqlca.sqlcode < 0) {
    trace_event("END ResourceActivity (MALFUNCTION) ",5);
    iVar1 = -1;
  }
  else if (result == 0) {
    trace_event("END ResourceActivity (OK) ",5);
    iVar1 = 0;
  }
  else {
    trace_event("END ResourceActivity (NOK) ",5);
    iVar1 = -1;
  }
  return iVar1;
}



// WARNING: Unknown calling convention

int ResourceStatusSignOn(void)

{
  int iVar1;
  char sLine [512];
  
  sprintf(sLine,"Start ResourceStatusSignOn(%s)",ResourceStatus);
  trace_event(sLine,4);
  iVar1 = memcmp(ResourceStatus,&DAT_004a2b1c,3);
  if (iVar1 == 0) {
    trace_event("End   ResourceStatusSignOn(OK)",4);
    iVar1 = 0;
  }
  else {
    iVar1 = -1;
    trace_event("End   ResourceStatusSignOn(NOK)",4);
  }
  return iVar1;
}



// WARNING: Unknown calling convention

int IncResourceActivity(int nIndexCtx,char *p_ResourceId,int pActivityCounter)

{
  int iVar1;
  int T_activity_counter;
  int result;
  char T_resource_id [7];
  sqlexd_conflict1 sqlstm;
  
  trace_event("Start  IncResourceActivity()",5);
  T_resource_id._0_4_ = *(undefined4 *)p_ResourceId;
  sqlstm.sqhstv[1] = (uchar *)T_resource_id;
  sqlstm.sqladtp = &sqladt;
  T_resource_id._4_2_ = *(undefined2 *)(p_ResourceId + 4);
  sqlstm.sqhstv[2] = (uchar *)&T_activity_counter;
  sqlstm.sqltdsp = &sqltds;
  sqlstm.stmt = 
  "begin :result := PCRD_P7_FUNCTION_TOOLS . INC_RESOURCE_ACTIVITY ( :T_resource_id , :T_activity_counter ) ; END ;"
  ;
  sqlstm.sqadto[1] = 0;
  sqlstm.cud = sqlcud0;
  sqlstm.sqtdso[0] = 0;
  sqlstm.sqadto[0] = 0;
  sqlstm.sqlety = 0x1100;
  sqlstm.sqhstv[0] = (uchar *)&result;
  T_resource_id[6] = '\0';
  sqlstm.sqlvsn = 0xc;
  sqlstm.arrsiz = 5;
  sqlstm.iters = 1;
  sqlstm.offset = 0x62;
  sqlstm.sqlest = (uchar *)&sqlca;
  sqlstm.occurs = 0;
  sqlstm.sqhstl[0] = 4;
  sqlstm.sqhsts[0] = 0;
  sqlstm.sqindv[0] = (short *)0x0;
  sqlstm.sqinds[0] = 0;
  sqlstm.sqharm[0] = 0;
  sqlstm.sqhstl[1] = 7;
  sqlstm.sqhsts[1] = 0;
  sqlstm.sqindv[1] = (short *)0x0;
  sqlstm.sqinds[1] = 0;
  sqlstm.sqharm[1] = 0;
  sqlstm.sqtdso[1] = 0;
  sqlstm.sqphsv = sqlstm.sqhstv;
  sqlstm.sqhstl[2] = 4;
  sqlstm.sqphsl = sqlstm.sqhstl;
  sqlstm.sqhsts[2] = 0;
  sqlstm.sqindv[2] = (short *)0x0;
  sqlstm.sqinds[2] = 0;
  sqlstm.sqphss = sqlstm.sqhsts;
  sqlstm.sqharm[2] = 0;
  sqlstm.sqadto[2] = 0;
  sqlstm.sqtdso[2] = 0;
  sqlstm.sqpind = sqlstm.sqindv;
  sqlstm.sqpins = sqlstm.sqinds;
  sqlstm.sqparm = sqlstm.sqharm;
  sqlstm.sqparc = sqlstm.sqharc;
  sqlstm.sqpadto = sqlstm.sqadto;
  sqlstm.sqptdso = sqlstm.sqtdso;
  T_activity_counter = pActivityCounter;
  sqlcxt((long)nIndexCtx * 0x10 + 0x713948,&sqlctx,&sqlstm,&sqlfpn);
  if (sqlca.sqlcode < 0) {
    trace_event("End IncResourceActivity(MALFUNCTION)",5);
    iVar1 = -1;
  }
  else if (result == 0) {
    trace_event("End IncResourceActivity(OK)",5);
    iVar1 = 0;
  }
  else {
    trace_event("End IncResourceActivity(NOK)",5);
    iVar1 = -1;
  }
  return iVar1;
}



// WARNING: Unknown calling convention

int LogEvent(int nIndexCtx,char *ResourceId,char *TerminalId,char *EventId,char *SysErrno,
            char *ApiErrno1,char *ApiErrno2,char *ApiPid,char *ApiPpid)

{
  int iVar1;
  size_t sVar2;
  long lVar3;
  char *pcVar4;
  anon_struct_4_2_43c7b5cf T_action;
  int response;
  char T_event_id [5];
  char T_resource_id [7];
  anon_struct_12_2_43c7b5cf T_sys_errno;
  anon_struct_12_2_43c7b5cf T_api_errno_1;
  anon_struct_12_2_43c7b5cf T_api_errno_2;
  anon_struct_12_2_43c7b5cf T_api_pid;
  anon_struct_12_2_43c7b5cf T_api_ppid;
  anon_struct_18_2_43c7b5cf T_terminal_id;
  sqlexd_conflict3 sqlstm;
  char sLine [4096];
  
  pcVar4 = sLine;
  for (lVar3 = 0x200; lVar3 != 0; lVar3 = lVar3 + -1) {
    pcVar4[0] = '\0';
    pcVar4[1] = '\0';
    pcVar4[2] = '\0';
    pcVar4[3] = '\0';
    pcVar4[4] = '\0';
    pcVar4[5] = '\0';
    pcVar4[6] = '\0';
    pcVar4[7] = '\0';
    pcVar4 = pcVar4 + 8;
  }
  sprintf(sLine,"Start LogEvent(%.6s,%.4s,%.15s)",ResourceId,EventId,TerminalId);
  trace_event(sLine,5);
  T_action.len = 0;
  T_terminal_id.arr[0] = '\0';
  T_terminal_id.arr[1] = '\0';
  T_terminal_id.arr[2] = '\0';
  T_terminal_id.arr[3] = '\0';
  T_terminal_id.arr[4] = '\0';
  T_terminal_id.arr[5] = '\0';
  T_terminal_id.arr[6] = '\0';
  T_terminal_id.arr[7] = '\0';
  T_sys_errno.arr[0] = '\0';
  T_sys_errno.arr[1] = '\0';
  T_sys_errno.arr[2] = '\0';
  T_sys_errno.arr[3] = '\0';
  T_sys_errno.arr[4] = '\0';
  T_sys_errno.arr[5] = '\0';
  T_sys_errno.arr[6] = '\0';
  T_sys_errno.arr[7] = '\0';
  T_api_errno_1.arr[0] = '\0';
  T_api_errno_1.arr[1] = '\0';
  T_api_errno_1.arr[2] = '\0';
  T_api_errno_1.arr[3] = '\0';
  T_api_errno_1.arr[4] = '\0';
  T_api_errno_1.arr[5] = '\0';
  T_api_errno_1.arr[6] = '\0';
  T_api_errno_1.arr[7] = '\0';
  T_terminal_id.len = 0xf;
  T_resource_id._0_4_ = *(undefined4 *)ResourceId;
  T_api_errno_2.arr[0] = '\0';
  T_api_errno_2.arr[1] = '\0';
  T_api_errno_2.arr[2] = '\0';
  T_api_errno_2.arr[3] = '\0';
  T_api_errno_2.arr[4] = '\0';
  T_api_errno_2.arr[5] = '\0';
  T_api_errno_2.arr[6] = '\0';
  T_api_errno_2.arr[7] = '\0';
  T_resource_id[6] = '\0';
  T_event_id[4] = '\0';
  T_terminal_id.arr[8] = '\0';
  T_terminal_id.arr[9] = '\0';
  T_terminal_id.arr[10] = '\0';
  T_terminal_id.arr[0xb] = '\0';
  T_terminal_id.arr[0xc] = '\0';
  T_terminal_id.arr[0xd] = '\0';
  T_terminal_id.arr[0xe] = '\0';
  T_terminal_id.arr[0xf] = '\0';
  T_resource_id._4_2_ = *(undefined2 *)(ResourceId + 4);
  T_sys_errno.arr[8] = '\0';
  T_api_errno_1.arr[8] = '\0';
  T_api_errno_2.arr[8] = '\0';
  T_api_pid.arr[0] = '\0';
  T_api_pid.arr[1] = '\0';
  T_api_pid.arr[2] = '\0';
  T_api_pid.arr[3] = '\0';
  T_api_pid.arr[4] = '\0';
  T_api_pid.arr[5] = '\0';
  T_api_pid.arr[6] = '\0';
  T_api_pid.arr[7] = '\0';
  T_api_pid.arr[8] = '\0';
  T_api_ppid.arr[0] = '\0';
  T_api_ppid.arr[1] = '\0';
  T_api_ppid.arr[2] = '\0';
  T_api_ppid.arr[3] = '\0';
  T_api_ppid.arr[4] = '\0';
  T_api_ppid.arr[5] = '\0';
  T_api_ppid.arr[6] = '\0';
  T_api_ppid.arr[7] = '\0';
  T_event_id._0_4_ = *(undefined4 *)EventId;
  T_api_ppid.arr[8] = '\0';
  T_action.arr[0] = '\0';
  T_sys_errno.len = 8;
  T_api_errno_1.len = 8;
  T_api_errno_2.len = 8;
  T_api_pid.len = 8;
  T_api_ppid.len = 8;
  if (TerminalId == (char *)0x0) {
    T_terminal_id.arr[0] = '#';
    T_terminal_id.arr[1] = '#';
    T_terminal_id.arr[2] = '\0';
    T_terminal_id.arr[3] = '\0';
    T_terminal_id.arr[4] = '\0';
    T_terminal_id.arr[5] = '\0';
    T_terminal_id.arr[6] = '\0';
    T_terminal_id.arr[7] = '\0';
    T_terminal_id.len = 2;
  }
  else {
    sVar2 = strlen(TerminalId);
    memcpy(T_terminal_id.arr,TerminalId,sVar2);
    T_terminal_id.len = (ushort)sVar2;
  }
  if (ApiErrno1 == (char *)0x0) {
    T_api_errno_1.arr[0] = '#';
    T_api_errno_1.arr[1] = '#';
    T_api_errno_1.len = 2;
  }
  else {
    sVar2 = strlen(ApiErrno1);
    memcpy(T_api_errno_1.arr,ApiErrno1,sVar2);
    T_api_errno_1.len = (ushort)sVar2;
  }
  if (ApiErrno2 == (char *)0x0) {
    T_api_errno_2.arr[0] = '#';
    T_api_errno_2.arr[1] = '#';
    T_api_errno_2.len = 2;
  }
  else {
    sVar2 = strlen(ApiErrno2);
    memcpy(T_api_errno_2.arr,ApiErrno2,sVar2);
    T_api_errno_2.len = (ushort)sVar2;
  }
  T_api_pid.len = 8;
  T_api_ppid.len = 8;
  T_api_pid.arr._0_8_ = *(undefined8 *)ApiPid;
  T_api_ppid.arr._0_8_ = *(undefined8 *)ApiPpid;
  if (SysErrno == (char *)0x0) {
    T_sys_errno.arr[0] = '#';
    T_sys_errno.arr[1] = '#';
    T_sys_errno.len = 2;
  }
  else {
    sVar2 = strlen(SysErrno);
    memcpy(T_sys_errno.arr,SysErrno,sVar2);
    T_sys_errno.len = (ushort)sVar2;
  }
  sqlstm.sqladtp = &sqladt;
  sqlstm.sqlety = 0x1100;
  sqlstm.sqadto[0] = 0;
  sqlstm.sqltdsp = &sqltds;
  sqlstm.sqtdso[0] = 0;
  sqlstm.sqadto[1] = 0;
  sqlstm.stmt = 
  "declare v_terminal_id RESOURCE_EVENT_LOG . terminal_id % TYPE ; v_api_errno_1 RESOURCE_EVENT_LOG . api_errno_1 % TYPE ; v_api_errno_2 RESOURCE_EVENT_LOG . api_errno_2 % TYPE ; v_sys_errno RESOURCE_EVENT_LOG . sys_errno % TYPE ; BEGIN v_terminal_id := :T_terminal_id ; v_api_errno_1 := :T_api_errno_1 ; v_api_errno_2 := :T_api_errno_2 ; v_sys_errno := :T_sys_errno ; IF v_terminal_id = \'##\' THEN v_terminal_id := NULL ; END IF ; IF v_api_errno_1 = \'##\' THEN v_api_errno_1 := NULL ; END IF ; IF v_api_errno_2 = \'##\' THEN v_api_errno_1 := NULL ; END IF ; IF v_sys_errno = \'##\' THEN v_sys_errno := NULL ; END IF ; :response := PCRD_EVENT_MANAGE . INSERT_EVENT ( :T_resource_id , v_terminal_id , :T_event_id , v_sys_errno , v_api_errno_1 , v_api_errno_2 , :T_api_pid , :T_api_ppid , :T_action ) ; END ;"
  ;
  sqlstm.sqtdso[1] = 0;
  sqlstm.sqlvsn = 0xc;
  sqlstm.cud = sqlcud0;
  sqlstm.arrsiz = 10;
  sqlstm.iters = 1;
  sqlstm.offset = 5;
  sqlstm.sqlest = (uchar *)&sqlca;
  sqlstm.sqhstv[4] = (uchar *)&response;
  sqlstm.occurs = 0;
  sqlstm.sqhstl[0] = 0x12;
  sqlstm.sqhsts[0] = 0;
  sqlstm.sqindv[0] = (short *)0x0;
  sqlstm.sqinds[0] = 0;
  sqlstm.sqharm[0] = 0;
  sqlstm.sqhstl[1] = 0xb;
  sqlstm.sqhsts[1] = 0;
  sqlstm.sqindv[1] = (short *)0x0;
  sqlstm.sqinds[1] = 0;
  sqlstm.sqharm[1] = 0;
  sqlstm.sqhstl[2] = 0xb;
  sqlstm.sqhsts[2] = 0;
  sqlstm.sqindv[2] = (short *)0x0;
  sqlstm.sqinds[2] = 0;
  sqlstm.sqhstv[5] = (uchar *)T_resource_id;
  sqlstm.sqadto[2] = 0;
  sqlstm.sqtdso[2] = 0;
  sqlstm.sqadto[3] = 0;
  sqlstm.sqtdso[5] = 0;
  sqlstm.sqhstv[6] = (uchar *)T_event_id;
  sqlstm.sqharm[2] = 0;
  sqlstm.sqhstl[3] = 0xb;
  sqlstm.sqhsts[3] = 0;
  sqlstm.sqindv[3] = (short *)0x0;
  sqlstm.sqinds[3] = 0;
  sqlstm.sqharm[3] = 0;
  sqlstm.sqtdso[3] = 0;
  sqlstm.sqhstl[4] = 4;
  sqlstm.sqhsts[4] = 0;
  sqlstm.sqindv[4] = (short *)0x0;
  sqlstm.sqinds[4] = 0;
  sqlstm.sqharm[4] = 0;
  sqlstm.sqadto[4] = 0;
  sqlstm.sqtdso[4] = 0;
  sqlstm.sqhstl[5] = 7;
  sqlstm.sqhsts[5] = 0;
  sqlstm.sqindv[5] = (short *)0x0;
  sqlstm.sqinds[5] = 0;
  sqlstm.sqharm[5] = 0;
  sqlstm.sqadto[5] = 0;
  sqlstm.sqhstl[6] = 5;
  sqlstm.sqhsts[6] = 0;
  sqlstm.sqindv[6] = (short *)0x0;
  sqlstm.sqinds[6] = 0;
  sqlstm.sqharm[6] = 0;
  sqlstm.sqadto[6] = 0;
  sqlstm.sqtdso[6] = 0;
  sqlstm.sqtdso[8] = 0;
  sqlstm.sqadto[9] = 0;
  sqlstm.sqtdso[9] = 0;
  sqlstm.sqhstl[7] = 0xb;
  sqlstm.sqhsts[7] = 0;
  sqlstm.sqadto[7] = 0;
  sqlstm.sqindv[7] = (short *)0x0;
  sqlstm.sqtdso[7] = 0;
  sqlstm.sqinds[7] = 0;
  sqlstm.sqharm[7] = 0;
  sqlstm.sqhstl[8] = 0xb;
  sqlstm.sqhsts[8] = 0;
  sqlstm.sqindv[8] = (short *)0x0;
  sqlstm.sqadto[8] = 0;
  sqlstm.sqhstv[9] = (uchar *)&T_action;
  sqlstm.sqinds[8] = 0;
  sqlstm.sqharm[8] = 0;
  sqlstm.sqhstl[9] = 3;
  sqlstm.sqphsv = sqlstm.sqhstv;
  sqlstm.sqhsts[9] = 0;
  sqlstm.sqindv[9] = (short *)0x0;
  sqlstm.sqinds[9] = 0;
  sqlstm.sqphsl = sqlstm.sqhstl;
  sqlstm.sqharm[9] = 0;
  sqlstm.sqphss = sqlstm.sqhsts;
  sqlstm.sqpind = sqlstm.sqindv;
  sqlstm.sqpins = sqlstm.sqinds;
  sqlstm.sqparm = sqlstm.sqharm;
  sqlstm.sqparc = sqlstm.sqharc;
  sqlstm.sqpadto = sqlstm.sqadto;
  sqlstm.sqptdso = sqlstm.sqtdso;
  sqlstm.sqhstv[0] = (uchar *)&T_terminal_id;
  sqlstm.sqhstv[1] = (uchar *)&T_api_errno_1;
  sqlstm.sqhstv[2] = (uchar *)&T_api_errno_2;
  sqlstm.sqhstv[3] = (uchar *)&T_sys_errno;
  sqlstm.sqhstv[7] = (uchar *)&T_api_pid;
  sqlstm.sqhstv[8] = (uchar *)&T_api_ppid;
  sqlcxt((long)nIndexCtx * 0x10 + 0x713948,&sqlctx,&sqlstm,&sqlfpn);
  if (sqlca.sqlcode < 0) {
    strcpy(sLine,sqlca.sqlerrm.sqlerrmc);
    trace_event(sLine,1);
    trace_event("End   LogEvent(SYSTEM_MALFUNCTION)",5);
    iVar1 = 0x38d;
  }
  else if (response == 0) {
    CommitOracle(nIndexCtx);
    sprintf(sLine,"End  LogEvent(%d)",(ulong)(uint)response);
    trace_event("End   LogEvent(OK)",5);
    iVar1 = 0;
  }
  else {
    trace_event("End   LogEvent(NOK)",5);
    iVar1 = -1;
  }
  return iVar1;
}



// WARNING: Removing unreachable block (ram,0x00430d3a)
// WARNING: Removing unreachable block (ram,0x00430d91)
// WARNING: Unknown calling convention

int LogAtmEvent(int nIndexCtx,char *ResourceId,char *TerminalId,char *EventId,char *SysErrno,
               char *ApiErrno1,char *ApiErrno2,char *ApiPid,char *Apitid,char *Action)

{
  int iVar1;
  size_t sVar2;
  ulong uVar3;
  uint uVar4;
  uchar *puVar5;
  bool bVar6;
  byte bVar7;
  uchar auStack_33d4 [64];
  uchar auStack_3394 [64];
  uchar auStack_3354 [7900];
  char T_action [2];
  int response;
  char T_event_id [5];
  char T_resource_id [7];
  anon_struct_12_2_43c7b5cf T_api_pid;
  anon_struct_12_2_43c7b5cf T_api_tid;
  anon_struct_18_2_43c7b5cf T_terminal_id;
  anon_struct_54_2_43c7b5cf T_api_errno_1;
  anon_struct_54_2_43c7b5cf T_api_errno_2;
  anon_struct_132_2_43c7b5cf T_sys_errno;
  sqlexd_conflict3 sqlstm;
  char sLine [4096];
  
  bVar7 = 0;
  sprintf(sLine,"Start LogAtmEvent(%.6s,%.4s,%.15s)",ResourceId);
  trace_event(sLine,5);
  puVar5 = T_sys_errno.arr + 2;
  T_terminal_id.arr[0] = '\0';
  T_terminal_id.arr[1] = '\0';
  T_terminal_id.arr[2] = '\0';
  T_terminal_id.arr[3] = '\0';
  T_terminal_id.arr[4] = '\0';
  T_terminal_id.arr[5] = '\0';
  T_terminal_id.arr[6] = '\0';
  T_terminal_id.arr[7] = '\0';
  T_terminal_id.arr[8] = '\0';
  T_terminal_id.arr[9] = '\0';
  T_terminal_id.arr[10] = '\0';
  T_terminal_id.arr[0xb] = '\0';
  T_terminal_id.arr[0xc] = '\0';
  T_terminal_id.arr[0xd] = '\0';
  T_terminal_id.arr[0xe] = '\0';
  T_terminal_id.arr[0xf] = '\0';
  bVar6 = ((ulong)puVar5 & 4) != 0;
  T_resource_id[6] = '\0';
  T_event_id[4] = '\0';
  T_sys_errno.arr[0] = '\0';
  T_sys_errno.arr[1] = '\0';
  uVar4 = 0x7f;
  if (bVar6) {
    T_sys_errno.arr[2] = '\0';
    T_sys_errno.arr[3] = '\0';
    T_sys_errno.arr[4] = '\0';
    T_sys_errno.arr[5] = '\0';
    uVar4 = 0x7b;
    puVar5 = T_sys_errno.arr + 6;
  }
  for (uVar3 = (ulong)(uVar4 >> 3); uVar3 != 0; uVar3 = uVar3 - 1) {
    puVar5[0] = '\0';
    puVar5[1] = '\0';
    puVar5[2] = '\0';
    puVar5[3] = '\0';
    puVar5[4] = '\0';
    puVar5[5] = '\0';
    puVar5[6] = '\0';
    puVar5[7] = '\0';
    puVar5 = puVar5 + (ulong)bVar7 * -0x10 + 8;
  }
  if (!bVar6) {
    puVar5[0] = '\0';
    puVar5[1] = '\0';
    puVar5[2] = '\0';
    puVar5[3] = '\0';
    puVar5 = puVar5 + 4;
  }
  puVar5[0] = '\0';
  puVar5[1] = '\0';
  puVar5[2] = '\0';
  uVar4 = 0x31;
  puVar5 = T_api_errno_1.arr + 2;
  bVar6 = ((ulong)puVar5 & 4) != 0;
  if (bVar6) {
    T_api_errno_1.arr[2] = '\0';
    T_api_errno_1.arr[3] = '\0';
    T_api_errno_1.arr[4] = '\0';
    T_api_errno_1.arr[5] = '\0';
    uVar4 = 0x2d;
    puVar5 = T_api_errno_1.arr + 6;
  }
  for (uVar3 = (ulong)(uVar4 >> 3); uVar3 != 0; uVar3 = uVar3 - 1) {
    puVar5[0] = '\0';
    puVar5[1] = '\0';
    puVar5[2] = '\0';
    puVar5[3] = '\0';
    puVar5[4] = '\0';
    puVar5[5] = '\0';
    puVar5[6] = '\0';
    puVar5[7] = '\0';
    puVar5 = puVar5 + (ulong)bVar7 * -0x10 + 8;
  }
  if (bVar6) {
    puVar5[0] = '\0';
    puVar5[1] = '\0';
    puVar5[2] = '\0';
    puVar5[3] = '\0';
    puVar5 = puVar5 + 4;
  }
  T_api_errno_1.arr[0] = '\0';
  T_api_errno_1.arr[1] = '\0';
  *puVar5 = '\0';
  uVar4 = 0x31;
  puVar5 = T_api_errno_2.arr + 2;
  bVar6 = ((ulong)puVar5 & 4) != 0;
  if (bVar6) {
    T_api_errno_2.arr[2] = '\0';
    T_api_errno_2.arr[3] = '\0';
    T_api_errno_2.arr[4] = '\0';
    T_api_errno_2.arr[5] = '\0';
    uVar4 = 0x2d;
    puVar5 = T_api_errno_2.arr + 6;
  }
  for (uVar3 = (ulong)(uVar4 >> 3); uVar3 != 0; uVar3 = uVar3 - 1) {
    puVar5[0] = '\0';
    puVar5[1] = '\0';
    puVar5[2] = '\0';
    puVar5[3] = '\0';
    puVar5[4] = '\0';
    puVar5[5] = '\0';
    puVar5[6] = '\0';
    puVar5[7] = '\0';
    puVar5 = puVar5 + (ulong)bVar7 * -0x10 + 8;
  }
  if (bVar6) {
    puVar5[0] = '\0';
    puVar5[1] = '\0';
    puVar5[2] = '\0';
    puVar5[3] = '\0';
    puVar5 = puVar5 + 4;
  }
  T_api_errno_2.arr[0] = '\0';
  T_api_errno_2.arr[1] = '\0';
  *puVar5 = '\0';
  T_api_pid.arr[0] = '\0';
  T_api_pid.arr[1] = '\0';
  T_api_pid.arr[2] = '\0';
  T_api_pid.arr[3] = '\0';
  T_api_pid.arr[4] = '\0';
  T_api_pid.arr[5] = '\0';
  T_api_pid.arr[6] = '\0';
  T_api_pid.arr[7] = '\0';
  T_api_pid.arr[8] = '\0';
  T_api_tid.arr[0] = '\0';
  T_api_tid.arr[1] = '\0';
  T_api_tid.arr[2] = '\0';
  T_api_tid.arr[3] = '\0';
  T_api_tid.arr[4] = '\0';
  T_api_tid.arr[5] = '\0';
  T_api_tid.arr[6] = '\0';
  T_api_tid.arr[7] = '\0';
  T_api_tid.arr[8] = '\0';
  T_api_errno_1.len = 0;
  T_api_errno_2.len = 0;
  T_terminal_id.len = 0;
  T_sys_errno.len = 0;
  T_resource_id._0_4_ = *(undefined4 *)ResourceId;
  T_api_pid.len = 0;
  T_api_tid.len = 0;
  T_action[0] = 'I';
  T_action[1] = '\0';
  T_resource_id._4_2_ = *(undefined2 *)(ResourceId + 4);
  T_event_id._0_4_ = *(undefined4 *)EventId;
  if (TerminalId == (char *)0x0) {
    T_terminal_id.arr[0] = '#';
    T_terminal_id.arr[1] = '#';
    T_terminal_id.len = 2;
  }
  else {
    sVar2 = strlen(TerminalId);
    memcpy(T_terminal_id.arr,TerminalId,sVar2);
    T_terminal_id.len = (ushort)sVar2;
  }
  if (ApiErrno1 == (char *)0x0) {
    T_api_errno_1.arr[0] = '#';
    T_api_errno_1.arr[1] = '#';
    T_api_errno_1.len = 2;
  }
  else {
    sVar2 = strlen(ApiErrno1);
    memcpy(T_api_errno_1.arr,ApiErrno1,sVar2);
    T_api_errno_1.len = (ushort)sVar2;
  }
  if (ApiErrno2 == (char *)0x0) {
    T_api_errno_2.arr[0] = '#';
    T_api_errno_2.arr[1] = '#';
    T_api_errno_2.len = 2;
  }
  else {
    sVar2 = strlen(ApiErrno2);
    memcpy(T_api_errno_2.arr,ApiErrno2,sVar2);
    T_api_errno_2.len = (ushort)sVar2;
  }
  T_api_pid.len = 8;
  T_api_tid.len = 8;
  T_api_pid.arr._0_8_ = *(undefined8 *)ApiPid;
  T_api_tid.arr._0_8_ = *(undefined8 *)Apitid;
  if (SysErrno == (char *)0x0) {
    T_sys_errno.arr[0] = '#';
    T_sys_errno.arr[1] = '#';
    T_sys_errno.len = 2;
  }
  else {
    sVar2 = strlen(SysErrno);
    memcpy(T_sys_errno.arr,SysErrno,sVar2);
    T_sys_errno.len = (ushort)sVar2;
  }
  sqlstm.sqladtp = &sqladt;
  sqlstm.sqlety = 0x1100;
  sqlstm.sqltdsp = &sqltds;
  sqlstm.sqadto[0] = 0;
  sqlstm.sqtdso[0] = 0;
  sqlstm.stmt = 
  "declare v_terminal_id TERMINAL_ATM_EVENT_LOG . terminal_atm_number % TYPE ; v_api_errno_1 TERMINAL_ATM_EVENT_LOG . msg_errno_1 % TYPE ; v_api_errno_2 TERMINAL_ATM_EVENT_LOG . msg_errno_2 % TYPE ; v_sys_errno TERMINAL_ATM_EVENT_LOG . private_data % TYPE ; v_action TERMINAL_ATM_EVENT_LOG . event_type % TYPE ; BEGIN v_terminal_id := :T_terminal_id ; v_api_errno_1 := :T_api_errno_1 ; v_api_errno_2 := :T_api_errno_2 ; v_sys_errno := :T_sys_errno ; IF v_terminal_id = \'##\' THEN v_terminal_id := NULL ; END IF ; IF v_api_errno_1 = \'##\' THEN v_api_errno_1 := NULL ; END IF ; IF v_api_errno_2 = \'##\' THEN v_api_errno_1 := NULL ; END IF ; IF v_sys_errno = \'##\' THEN v_sys_errno := NULL ; END IF ; :response := PCRD_EVENT_MANAGE . INSERT_ATM_EVENT ( :T_resource_id , v_terminal_id , :T_event_id , v_api_errno_1 , v_api_errno_2 , v_sys_errno , :T_api_pid , :T_api_tid , v_action ) ; IF ( v_action IS NULL ) THEN :T_action := \'I\' ; ELSE :T_action := v_action ; END IF ; END ;"
  ;
  sqlstm.sqadto[1] = 0;
  sqlstm.sqtdso[1] = 0;
  sqlstm.cud = sqlcud0;
  sqlstm.sqhstv[4] = (uchar *)&response;
  sqlstm.sqlvsn = 0xc;
  sqlstm.arrsiz = 10;
  sqlstm.iters = 1;
  sqlstm.offset = 0x3c;
  sqlstm.sqlest = (uchar *)&sqlca;
  sqlstm.occurs = 0;
  sqlstm.sqhstl[0] = 0x12;
  sqlstm.sqhsts[0] = 0;
  sqlstm.sqindv[0] = (short *)0x0;
  sqlstm.sqinds[0] = 0;
  sqlstm.sqharm[0] = 0;
  sqlstm.sqhstl[1] = 0x35;
  sqlstm.sqhsts[1] = 0;
  sqlstm.sqindv[1] = (short *)0x0;
  sqlstm.sqinds[1] = 0;
  sqlstm.sqharm[1] = 0;
  sqlstm.sqhstl[2] = 0x35;
  sqlstm.sqhsts[2] = 0;
  sqlstm.sqindv[2] = (short *)0x0;
  sqlstm.sqinds[2] = 0;
  sqlstm.sqharm[2] = 0;
  sqlstm.sqhstv[5] = (uchar *)T_resource_id;
  sqlstm.sqadto[2] = 0;
  sqlstm.sqtdso[2] = 0;
  sqlstm.sqhstv[6] = (uchar *)T_event_id;
  sqlstm.sqadto[3] = 0;
  sqlstm.sqhstl[3] = 0x83;
  sqlstm.sqhsts[3] = 0;
  sqlstm.sqindv[3] = (short *)0x0;
  sqlstm.sqadto[6] = 0;
  sqlstm.sqinds[3] = 0;
  sqlstm.sqharm[3] = 0;
  sqlstm.sqtdso[3] = 0;
  sqlstm.sqhstl[4] = 4;
  sqlstm.sqhsts[4] = 0;
  sqlstm.sqindv[4] = (short *)0x0;
  sqlstm.sqinds[4] = 0;
  sqlstm.sqharm[4] = 0;
  sqlstm.sqadto[4] = 0;
  sqlstm.sqtdso[4] = 0;
  sqlstm.sqhstl[5] = 7;
  sqlstm.sqhsts[5] = 0;
  sqlstm.sqindv[5] = (short *)0x0;
  sqlstm.sqinds[5] = 0;
  sqlstm.sqharm[5] = 0;
  sqlstm.sqadto[5] = 0;
  sqlstm.sqtdso[5] = 0;
  sqlstm.sqhstl[6] = 5;
  sqlstm.sqhsts[6] = 0;
  sqlstm.sqindv[6] = (short *)0x0;
  sqlstm.sqinds[6] = 0;
  sqlstm.sqharm[6] = 0;
  sqlstm.sqtdso[6] = 0;
  sqlstm.sqadto[9] = 0;
  sqlstm.sqtdso[9] = 0;
  sqlstm.sqhstl[7] = 0xb;
  sqlstm.sqhsts[7] = 0;
  sqlstm.sqindv[7] = (short *)0x0;
  sqlstm.sqinds[7] = 0;
  sqlstm.sqadto[7] = 0;
  sqlstm.sqharm[7] = 0;
  sqlstm.sqtdso[7] = 0;
  sqlstm.sqhstl[8] = 0xb;
  sqlstm.sqhsts[8] = 0;
  sqlstm.sqindv[8] = (short *)0x0;
  sqlstm.sqinds[8] = 0;
  sqlstm.sqharm[8] = 0;
  sqlstm.sqadto[8] = 0;
  sqlstm.sqhstl[9] = 2;
  sqlstm.sqtdso[8] = 0;
  sqlstm.sqhstv[9] = (uchar *)T_action;
  sqlstm.sqhsts[9] = 0;
  sqlstm.sqindv[9] = (short *)0x0;
  sqlstm.sqinds[9] = 0;
  sqlstm.sqphsv = sqlstm.sqhstv;
  sqlstm.sqharm[9] = 0;
  sqlstm.sqphsl = sqlstm.sqhstl;
  sqlstm.sqphss = sqlstm.sqhsts;
  sqlstm.sqpind = sqlstm.sqindv;
  sqlstm.sqpins = sqlstm.sqinds;
  sqlstm.sqparm = sqlstm.sqharm;
  sqlstm.sqparc = sqlstm.sqharc;
  sqlstm.sqpadto = sqlstm.sqadto;
  sqlstm.sqptdso = sqlstm.sqtdso;
  sqlstm.sqhstv[0] = (uchar *)&T_terminal_id;
  sqlstm.sqhstv[1] = (uchar *)&T_api_errno_1;
  sqlstm.sqhstv[2] = (uchar *)&T_api_errno_2;
  sqlstm.sqhstv[3] = (uchar *)&T_sys_errno;
  sqlstm.sqhstv[7] = (uchar *)&T_api_pid;
  sqlstm.sqhstv[8] = (uchar *)&T_api_tid;
  sqlcxt((long)nIndexCtx * 0x10 + 0x713948,&sqlctx,&sqlstm,&sqlfpn);
  if (sqlca.sqlcode < 0) {
    strcpy(sLine,sqlca.sqlerrm.sqlerrmc);
    trace_event(sLine,1);
    trace_event("End   LogAtmEvent(SYSTEM_MALFUNCTION)",5);
    iVar1 = 0x38d;
  }
  else if (response == 0) {
    CommitOracle(nIndexCtx);
    *Action = T_action[0];
    trace_event("End   LogAtmEvent(OK)",5);
    iVar1 = 0;
  }
  else {
    trace_event("End   LogAtmEvent(NOK)",5);
    iVar1 = -1;
  }
  return iVar1;
}



// WARNING: Unknown calling convention

int TranslateRespCode(int nIndexCtx,char *ResourceId,char *FromCode,char *Direction,char *ToCode)

{
  int iVar1;
  size_t __n;
  char T_resource_code [3];
  char T_translat_direction [3];
  int result;
  anon_struct_6_2_43c7b5cf T_action_code_from;
  anon_struct_6_2_43c7b5cf T_action_code_translat;
  sqlexd_conflict1 sqlstm;
  char sLine [512];
  
  sprintf(sLine,"Start TranslateRespCode(FromCode = %s, Direction=%s)");
  trace_event(sLine,5);
  T_translat_direction[0] = '\0';
  T_translat_direction[1] = '\0';
  T_resource_code._0_2_ = *(undefined2 *)ResourceId;
  T_resource_code[2] = '\0';
  T_action_code_from.arr[0] = '\0';
  T_action_code_from.arr[1] = '\0';
  T_action_code_from.arr[2] = '\0';
  T_action_code_from.arr[3] = '\0';
  T_action_code_translat.arr[0] = '\0';
  T_action_code_translat.arr[1] = '\0';
  T_action_code_translat.arr[2] = '\0';
  T_action_code_translat.arr[3] = '\0';
  T_translat_direction[2] = '\0';
  sprintf(sLine,"ResourceId = %s",ResourceId);
  trace_event(sLine,5);
  T_translat_direction._0_2_ = *(undefined2 *)Direction;
  __n = strlen(FromCode);
  memcpy(T_action_code_from.arr,FromCode,__n);
  sqlstm.sqadto[0] = 0;
  sqlstm.sqladtp = &sqladt;
  sqlstm.sqltdsp = &sqltds;
  T_action_code_from.len = (ushort)__n;
  sqlstm.stmt = 
  "begin :result := PCRD_GET_PARAM_GENERAL_ROWS . GET_RESOURCE_ACTION_CODE ( :T_resource_code , :T_action_code_from , :T_translat_direction , :T_action_code_translat ) ; END ;"
  ;
  T_action_code_translat.len = 0;
  ToCode[0] = '9';
  ToCode[1] = '0';
  sqlstm.sqlety = 0x1100;
  sqlstm.cud = sqlcud0;
  sqlstm.sqhstv[0] = (uchar *)&result;
  sqlstm.sqtdso[0] = 0;
  sqlstm.sqadto[1] = 0;
  sqlstm.sqtdso[1] = 0;
  ToCode[2] = '9';
  sqlstm.sqlvsn = 0xc;
  sqlstm.arrsiz = 5;
  sqlstm.iters = 1;
  sqlstm.offset = 5;
  sqlstm.sqlest = (uchar *)&sqlca;
  sqlstm.occurs = 0;
  sqlstm.sqhstl[0] = 4;
  sqlstm.sqhsts[0] = 0;
  sqlstm.sqindv[0] = (short *)0x0;
  sqlstm.sqinds[0] = 0;
  sqlstm.sqharm[0] = 0;
  sqlstm.sqhstl[1] = 3;
  sqlstm.sqhsts[1] = 0;
  sqlstm.sqindv[1] = (short *)0x0;
  sqlstm.sqinds[1] = 0;
  sqlstm.sqharm[1] = 0;
  sqlstm.sqtdso[2] = 0;
  sqlstm.sqadto[3] = 0;
  sqlstm.sqtdso[3] = 0;
  sqlstm.sqadto[4] = 0;
  sqlstm.sqhstl[2] = 6;
  sqlstm.sqtdso[4] = 0;
  sqlstm.sqphsv = sqlstm.sqhstv;
  sqlstm.sqhsts[2] = 0;
  sqlstm.sqindv[2] = (short *)0x0;
  sqlstm.sqinds[2] = 0;
  sqlstm.sqphsl = sqlstm.sqhstl;
  sqlstm.sqharm[2] = 0;
  sqlstm.sqphss = sqlstm.sqhsts;
  sqlstm.sqadto[2] = 0;
  sqlstm.sqhstl[3] = 3;
  sqlstm.sqpind = sqlstm.sqindv;
  sqlstm.sqhsts[3] = 0;
  sqlstm.sqindv[3] = (short *)0x0;
  sqlstm.sqinds[3] = 0;
  sqlstm.sqpins = sqlstm.sqinds;
  sqlstm.sqharm[3] = 0;
  sqlstm.sqhstl[4] = 6;
  sqlstm.sqhsts[4] = 0;
  sqlstm.sqparm = sqlstm.sqharm;
  sqlstm.sqindv[4] = (short *)0x0;
  sqlstm.sqinds[4] = 0;
  sqlstm.sqharm[4] = 0;
  sqlstm.sqparc = sqlstm.sqharc;
  sqlstm.sqpadto = sqlstm.sqadto;
  sqlstm.sqptdso = sqlstm.sqtdso;
  sqlstm.sqhstv[1] = (uchar *)T_resource_code;
  sqlstm.sqhstv[2] = (uchar *)&T_action_code_from;
  sqlstm.sqhstv[3] = (uchar *)T_translat_direction;
  sqlstm.sqhstv[4] = (uchar *)&T_action_code_translat;
  sqlcxt((long)nIndexCtx * 0x10 + 0x713948,&sqlctx,&sqlstm,&sqlfpn);
  if (sqlca.sqlcode < 0) {
    trace_event("End   TranslateRespCode(MALFUNCTION)",5);
    iVar1 = -1;
  }
  else if (result == 0) {
    memcpy(ToCode,T_action_code_translat.arr,(ulong)T_action_code_translat.len);
    sprintf(sLine,"End   TranslateRespCode(OK|%.2s)",ToCode);
    trace_event(sLine,5);
    iVar1 = 0;
  }
  else {
    trace_event("End   TranslateRespCode(NOK)",5);
    iVar1 = -1;
  }
  return iVar1;
}



// WARNING: Unknown calling convention

int TranslateRespCodeMCAsI(int nIndexCtx,char *ResourceId,char *FromCode,char *ToCode)

{
  int iVar1;
  size_t __n;
  char T_resource_code [3];
  anon_struct_4_2_43c7b5cf T_action_code_from;
  anon_struct_4_2_43c7b5cf T_action_code_translat;
  int result;
  sqlexd_conflict1 sqlstm;
  char sLine [512];
  
  sprintf(sLine,"Start TranslateRespCodeMCAsI(FromCode = %s)");
  trace_event(sLine,5);
  T_action_code_from.arr[0] = '\0';
  T_action_code_from.arr[1] = '\0';
  T_resource_code._0_2_ = *(undefined2 *)ResourceId;
  T_resource_code[2] = '\0';
  T_action_code_translat.arr[0] = '\0';
  T_action_code_translat.arr[1] = '\0';
  sprintf(sLine,"ResourceId = %s",ResourceId);
  trace_event(sLine,5);
  __n = strlen(FromCode);
  memcpy(T_action_code_from.arr,FromCode,__n);
  sqlstm.sqladtp = &sqladt;
  T_action_code_from.len = (ushort)__n;
  sqlstm.sqltdsp = &sqltds;
  T_action_code_translat.len = 0;
  ToCode[0] = '0';
  ToCode[1] = '5';
  sqlstm.stmt = 
  "begin :result := PCRD_GET_PARAM_GENERAL_ROWS . GET_RESOURCE_ACTION_CODE_ASI ( :T_resource_code , :T_action_code_from , :T_action_code_translat ) ; END ;"
  ;
  sqlstm.sqlety = 0x1100;
  sqlstm.sqadto[0] = 0;
  sqlstm.sqtdso[0] = 0;
  sqlstm.cud = sqlcud0;
  sqlstm.sqhstv[0] = (uchar *)&result;
  sqlstm.sqadto[1] = 0;
  sqlstm.sqlvsn = 0xc;
  sqlstm.arrsiz = 5;
  sqlstm.iters = 1;
  sqlstm.offset = 0x28;
  sqlstm.sqlest = (uchar *)&sqlca;
  sqlstm.occurs = 0;
  sqlstm.sqhstl[0] = 4;
  sqlstm.sqhsts[0] = 0;
  sqlstm.sqindv[0] = (short *)0x0;
  sqlstm.sqinds[0] = 0;
  sqlstm.sqharm[0] = 0;
  sqlstm.sqhstl[1] = 3;
  sqlstm.sqhsts[1] = 0;
  sqlstm.sqindv[1] = (short *)0x0;
  sqlstm.sqinds[1] = 0;
  sqlstm.sqharm[1] = 0;
  sqlstm.sqtdso[1] = 0;
  sqlstm.sqhstl[2] = 4;
  sqlstm.sqadto[2] = 0;
  sqlstm.sqhsts[2] = 0;
  sqlstm.sqtdso[2] = 0;
  sqlstm.sqindv[2] = (short *)0x0;
  sqlstm.sqadto[3] = 0;
  sqlstm.sqinds[2] = 0;
  sqlstm.sqtdso[3] = 0;
  sqlstm.sqphsv = sqlstm.sqhstv;
  sqlstm.sqharm[2] = 0;
  sqlstm.sqhstl[3] = 4;
  sqlstm.sqphsl = sqlstm.sqhstl;
  sqlstm.sqhsts[3] = 0;
  sqlstm.sqindv[3] = (short *)0x0;
  sqlstm.sqinds[3] = 0;
  sqlstm.sqphss = sqlstm.sqhsts;
  sqlstm.sqharm[3] = 0;
  sqlstm.sqpind = sqlstm.sqindv;
  sqlstm.sqpins = sqlstm.sqinds;
  sqlstm.sqparm = sqlstm.sqharm;
  sqlstm.sqparc = sqlstm.sqharc;
  sqlstm.sqpadto = sqlstm.sqadto;
  sqlstm.sqptdso = sqlstm.sqtdso;
  sqlstm.sqhstv[1] = (uchar *)T_resource_code;
  sqlstm.sqhstv[2] = (uchar *)&T_action_code_from;
  sqlstm.sqhstv[3] = (uchar *)&T_action_code_translat;
  sqlcxt((long)nIndexCtx * 0x10 + 0x713948,&sqlctx,&sqlstm,&sqlfpn);
  if (sqlca.sqlcode < 0) {
    trace_event("End   TranslateRespCodeMCAsI(MALFUNCTION)",5);
    iVar1 = -1;
  }
  else if (result == 0) {
    memcpy(ToCode,T_action_code_translat.arr,(ulong)T_action_code_translat.len);
    sprintf(sLine,"End   TranslateRespCodeMCAsI(OK|%.2s)",ToCode);
    trace_event(sLine,5);
    iVar1 = 0;
  }
  else {
    trace_event("End   TranslateRespCodeMCAsI(NOK)",5);
    iVar1 = -1;
  }
  return iVar1;
}



// WARNING: Removing unreachable block (ram,0x004322c0)
// WARNING: Removing unreachable block (ram,0x004322a0)
// WARNING: Removing unreachable block (ram,0x00432280)
// WARNING: Removing unreachable block (ram,0x0043216d)
// WARNING: Unknown calling convention

int AdjustTlvAmount(int nIndiceCtx,char *iso_amount,char *currency,char *tlv_amount)

{
  int iVar1;
  double dVar2;
  char T_currency [4];
  int exponent;
  int response_code;
  sqlca sqlca;
  char sAmount [19];
  char sLine [512];
  
  sprintf(sLine,"Start AdjustTlvAmount (%.18s), (%.3s)",iso_amount,currency);
  trace_event(sLine,4);
  sAmount[0] = '\f';
  sAmount[1] = '\0';
  sAmount[2] = '\0';
  sAmount[3] = '\0';
  sAmount[4] = '\0';
  sAmount[5] = '\0';
  sAmount[6] = '\0';
  sAmount[7] = '\0';
  sAmount[8] = '\x03';
  sAmount[9] = '\0';
  sAmount[10] = '\0';
  sAmount[0xb] = '\0';
  sAmount[0xc] = '\x01';
  sAmount[0xd] = '\0';
  sAmount[0xe] = '\0';
  sAmount[0xf] = '\0';
  stack0xfffffffffffffc78 = 5;
  sqlcxt((long)nIndiceCtx * 0x10 + 0x713948,&sqlctx,sAmount,&sqlfpn);
  if (sqlca.sqlcode < 0) {
    sprintf(sLine,"%.40s",sqlca.sqlerrm.sqlerrmc);
    trace_event(sLine,1);
    trace_event("End AdjustTlvAmount(MALFUNCTION)",1);
    iVar1 = -1;
  }
  else if (response_code == 0) {
    dVar2 = atof(iso_amount);
    sAmount[0] = '\0';
    sAmount[1] = '\0';
    sAmount[2] = '\0';
    sAmount[3] = '\0';
    sAmount[4] = '\0';
    sAmount[5] = '\0';
    sAmount[6] = '\0';
    sAmount[7] = '\0';
    sAmount[8] = '\0';
    sAmount[9] = '\0';
    sAmount[10] = '\0';
    sAmount[0xb] = '\0';
    sAmount[0xc] = '\0';
    sAmount[0xd] = '\0';
    sAmount[0xe] = '\0';
    sAmount[0xf] = '\0';
    stack0xfffffffffffffc78 = stack0xfffffffffffffc78 & 0xff000000;
    sprintf(sAmount,"%018.0f",dVar2 * -333.0);
    *(undefined8 *)tlv_amount = sAmount._0_8_;
    *(undefined8 *)(tlv_amount + 8) = sAmount._8_8_;
    *(undefined2 *)(tlv_amount + 0x10) = sAmount._16_2_;
    builtin_strncpy(sLine,"End AdjustTlvAmount(OK)",0x18);
    trace_event(sLine,5);
    iVar1 = 0;
  }
  else {
    sprintf(sLine,"End AdjustTlvAmount(NOK %d)");
    trace_event(sLine,5);
    iVar1 = -1;
  }
  return iVar1;
}



// WARNING: Removing unreachable block (ram,0x00432710)
// WARNING: Removing unreachable block (ram,0x004326c0)
// WARNING: Removing unreachable block (ram,0x004326c5)
// WARNING: Removing unreachable block (ram,0x004326ca)
// WARNING: Removing unreachable block (ram,0x004326cf)
// WARNING: Removing unreachable block (ram,0x004326e0)
// WARNING: Removing unreachable block (ram,0x0043261b)
// WARNING: Removing unreachable block (ram,0x00432627)
// WARNING: Removing unreachable block (ram,0x004326f8)
// WARNING: Removing unreachable block (ram,0x00432637)
// WARNING: Unknown calling convention

int AdjustIsoAmount(int nIndiceCtx,char *tlv_amount,char *currency,char *iso_amount)

{
  long lVar1;
  char *pcVar2;
  char T_currency [4];
  int exponent;
  int response_code;
  sqlca sqlca;
  char sAmount [19];
  char sLine [512];
  
  pcVar2 = sLine;
  for (lVar1 = 0x40; lVar1 != 0; lVar1 = lVar1 + -1) {
    pcVar2[0] = '\0';
    pcVar2[1] = '\0';
    pcVar2[2] = '\0';
    pcVar2[3] = '\0';
    pcVar2[4] = '\0';
    pcVar2[5] = '\0';
    pcVar2[6] = '\0';
    pcVar2[7] = '\0';
    pcVar2 = pcVar2 + 8;
  }
  sAmount[0] = '\f';
  sAmount[1] = '\0';
  sAmount[2] = '\0';
  sAmount[3] = '\0';
  sAmount[4] = '\0';
  sAmount[5] = '\0';
  sAmount[6] = '\0';
  sAmount[7] = '\0';
  sAmount[8] = '\x03';
  sAmount[9] = '\0';
  sAmount[10] = '\0';
  sAmount[0xb] = '\0';
  sAmount[0xc] = '\x01';
  sAmount[0xd] = '\0';
  sAmount[0xe] = '\0';
  sAmount[0xf] = '\0';
  stack0xfffffffffffffc88 = 0x20;
  sqlcxt((long)nIndiceCtx * 0x10 + 0x713948,&sqlctx,sAmount,&sqlfpn);
  if (sqlca.sqlcode < 0) {
    sprintf(sLine,"%.40s",sqlca.sqlerrm.sqlerrmc);
    trace_event(sLine,1);
    trace_event("End AdjustIsoAmount(NOK)",5);
  }
  else {
    sprintf(sLine,"End AdjustIsoAmount(NOK %d)");
    trace_event(sLine,5);
  }
  return -1;
}



// WARNING: Unknown calling convention

int AdjustTlvRate(char *iso_rate,char *tlv_rate)

{
  int iVar1;
  size_t sVar2;
  long lVar3;
  int iVar4;
  char *pcVar5;
  byte bVar6;
  double dVar7;
  char sNbDecimales [2];
  char sRate [15];
  char sIsoRate [4097];
  
  bVar6 = 0;
  sNbDecimales[1] = '\0';
  sNbDecimales[0] = *iso_rate;
  iVar1 = atoi(sNbDecimales);
  pcVar5 = sIsoRate;
  for (lVar3 = 0x200; lVar3 != 0; lVar3 = lVar3 + -1) {
    pcVar5[0] = '\0';
    pcVar5[1] = '\0';
    pcVar5[2] = '\0';
    pcVar5[3] = '\0';
    pcVar5[4] = '\0';
    pcVar5[5] = '\0';
    pcVar5[6] = '\0';
    pcVar5[7] = '\0';
    pcVar5 = pcVar5 + (ulong)bVar6 * -0x10 + 8;
  }
  *pcVar5 = '\0';
  sVar2 = strlen(iso_rate);
  memcpy(sIsoRate,iso_rate + 1,sVar2 - 1);
  dVar7 = atof(sIsoRate);
  if (0 < iVar1) {
    iVar4 = 0;
    do {
      iVar4 = iVar4 + 1;
      dVar7 = dVar7 / 10.0;
    } while (iVar4 != iVar1);
  }
  sRate[0xc] = '\0';
  sRate[0xd] = '\0';
  sRate[0] = '\0';
  sRate[1] = '\0';
  sRate[2] = '\0';
  sRate[3] = '\0';
  sRate[4] = '\0';
  sRate[5] = '\0';
  sRate[6] = '\0';
  sRate[7] = '\0';
  sRate[8] = '\0';
  sRate[9] = '\0';
  sRate[10] = '\0';
  sRate[0xb] = '\0';
  sRate[0xe] = '\0';
  sprintf(sRate,"%014.0f",dVar7 * 1000000.0);
  *(undefined8 *)tlv_rate = sRate._0_8_;
  *(undefined4 *)(tlv_rate + 8) = sRate._8_4_;
  *(undefined2 *)(tlv_rate + 0xc) = sRate._12_2_;
  return 0;
}



// WARNING: Unknown calling convention

void DumpIso(char *data)

{
  byte bVar1;
  int iVar2;
  long lVar3;
  char *pcVar4;
  int iVar5;
  long lVar6;
  char **ppcVar7;
  char *pcVar8;
  uchar *puVar9;
  uint uVar10;
  uint field_no;
  undefined1 uVar11;
  byte bVar12;
  int nLength;
  char sTag [5];
  char CardTrunc [23];
  char CryptPart [23];
  TSIsoInfo msgInfo;
  char sub_data [4096];
  char sWork [4096];
  char sLine [4096];
  char sValue [4096];
  TSTlvPrivate tlvInfo;
  
  bVar12 = 0;
  lVar6 = 0;
  CryptPart[0x14] = '\0';
  CryptPart[0x15] = '\0';
  CardTrunc[0x14] = '\0';
  CardTrunc[0x15] = '\0';
  CardTrunc[0] = '\0';
  CardTrunc[1] = '\0';
  CardTrunc[2] = '\0';
  CardTrunc[3] = '\0';
  CardTrunc[4] = '\0';
  CardTrunc[5] = '\0';
  CardTrunc[6] = '\0';
  CardTrunc[7] = '\0';
  CardTrunc[8] = '\0';
  CardTrunc[9] = '\0';
  CardTrunc[10] = '\0';
  CardTrunc[0xb] = '\0';
  CardTrunc[0xc] = '\0';
  CardTrunc[0xd] = '\0';
  CardTrunc[0xe] = '\0';
  CardTrunc[0xf] = '\0';
  CardTrunc[0x10] = '\0';
  CardTrunc[0x11] = '\0';
  CardTrunc[0x12] = '\0';
  CardTrunc[0x13] = '\0';
  CardTrunc[0x16] = '\0';
  CryptPart[0] = '\0';
  CryptPart[1] = '\0';
  CryptPart[2] = '\0';
  CryptPart[3] = '\0';
  CryptPart[4] = '\0';
  CryptPart[5] = '\0';
  CryptPart[6] = '\0';
  CryptPart[7] = '\0';
  CryptPart[8] = '\0';
  CryptPart[9] = '\0';
  CryptPart[10] = '\0';
  CryptPart[0xb] = '\0';
  CryptPart[0xc] = '\0';
  CryptPart[0xd] = '\0';
  CryptPart[0xe] = '\0';
  CryptPart[0xf] = '\0';
  CryptPart[0x10] = '\0';
  CryptPart[0x11] = '\0';
  CryptPart[0x12] = '\0';
  CryptPart[0x13] = '\0';
  CryptPart[0x16] = '\0';
  trace_event("Start DumpIso()",5);
  pcVar8 = sWork;
  for (lVar3 = 0x200; lVar3 != 0; lVar3 = lVar3 + -1) {
    pcVar8[0] = '\0';
    pcVar8[1] = '\0';
    pcVar8[2] = '\0';
    pcVar8[3] = '\0';
    pcVar8[4] = '\0';
    pcVar8[5] = '\0';
    pcVar8[6] = '\0';
    pcVar8[7] = '\0';
    pcVar8 = pcVar8 + (ulong)bVar12 * -0x10 + 8;
  }
  InitIsoInfo(&msgInfo);
  AnalyseIso(data,&msgInfo);
  builtin_strncpy(sLine,"- BIT MA",8);
  builtin_strncpy(sLine + 8,"P  : ",5);
  pcVar8 = sLine + 0xd;
  do {
    pcVar4 = msgInfo.sBitMap + lVar6;
    lVar6 = lVar6 + 1;
    sprintf(pcVar8," %02X",(ulong)(uint)(int)*pcVar4);
    pcVar8 = pcVar8 + 3;
  } while ((int)lVar6 < (int)(((int)msgInfo.sBitMap[0] >> 0x1f & 8U) + 8));
  trace_event(sLine,4);
  trace_event("------------------------------------",4);
  sprintf(sLine,"- M.T.I      : %04d",(ulong)(uint)msgInfo.nMsgType);
  trace_event(sLine,4);
  trace_event("------------------------------------",4);
  trace_event("- FLD (FIELD): LENGTH :  DATA       ",4);
  trace_event("------------------------------------",4);
  field_no = 1;
  uVar10 = 2;
  do {
    switch(uVar10) {
    case 0:
    case 1:
    case 3:
    case 4:
    case 5:
    case 6:
    case 7:
    case 8:
    case 9:
    case 10:
    case 0xb:
    case 0xc:
    case 0xd:
    case 0xe:
    case 0xf:
    case 0x10:
    case 0x11:
    case 0x12:
    case 0x13:
    case 0x14:
    case 0x15:
    case 0x16:
    case 0x17:
    case 0x18:
    case 0x19:
    case 0x1a:
    case 0x1b:
    case 0x1c:
    case 0x1d:
    case 0x1e:
    case 0x1f:
    case 0x20:
    case 0x21:
    case 0x22:
    case 0x24:
    case 0x25:
    case 0x26:
    case 0x27:
    case 0x28:
    case 0x29:
    case 0x2a:
    case 0x2b:
    case 0x2c:
    case 0x2e:
    case 0x2f:
    case 0x31:
    case 0x32:
    case 0x33:
    case 0x36:
    case 0x38:
    case 0x39:
    case 0x3a:
    case 0x3b:
    case 0x3f:
    case 0x40:
    case 0x41:
    case 0x42:
    case 0x43:
    case 0x44:
    case 0x45:
    case 0x46:
    case 0x47:
    case 0x48:
    case 0x49:
    case 0x4a:
    case 0x4b:
    case 0x4c:
    case 0x4d:
    case 0x4e:
    case 0x4f:
    case 0x50:
    case 0x51:
    case 0x52:
    case 0x53:
    case 0x54:
    case 0x55:
    case 0x56:
    case 0x57:
    case 0x58:
    case 0x59:
    case 0x5a:
    case 0x5b:
    case 0x5c:
    case 0x5d:
    case 0x5e:
    case 0x5f:
    case 0x60:
    case 0x61:
    case 0x62:
    case 99:
    case 100:
    case 0x65:
    case 0x66:
    case 0x68:
    case 0x69:
    case 0x6a:
    case 0x6b:
    case 0x6c:
    case 0x6d:
    case 0x6e:
    case 0x6f:
      do {
        iVar2 = GetIsoField(field_no,&msgInfo,sWork,&nLength);
        if (iVar2 == 0) {
          sprintf(sLine,"- FLD (%03d) : (%03d) : [%s] ",(ulong)uVar10,(ulong)(uint)nLength,sWork);
LAB_00433053:
          trace_event(sLine,4);
        }
LAB_00433060:
        field_no = uVar10;
        if (0x7e < (int)uVar10) {
          trace_event("------------------------------------",4);
          trace_event("End   DumpIso()",5);
          return;
        }
LAB_00432aa0:
        uVar10 = field_no + 1;
      } while (0x72 < uVar10);
      break;
    default:
      iVar2 = GetIsoField(field_no,&msgInfo,sWork,&nLength);
      field_no = uVar10;
      if (iVar2 != 0) goto LAB_00432aa0;
      if (debug_option == 1) {
        sprintf(sLine,"- FLD (%03d) : (%03d) : [%s] ",2,(ulong)(uint)nLength,sWork);
      }
      else {
        TrunCard(sWork,CardTrunc);
        CryptCard(sWork,CryptPart);
        sprintf(sLine,"- FLD (%03d) : (%03d) : [%s][%s]",2,(ulong)(uint)nLength,CardTrunc,CryptPart)
        ;
      }
      trace_event(sLine,4);
      goto LAB_00432aa0;
    case 0x23:
    case 0x2d:
    case 0x34:
    case 0x67:
    case 0x70:
    case 0x71:
    case 0x72:
      iVar2 = GetIsoField(field_no,&msgInfo,sWork,&nLength);
      if (iVar2 != 0) goto LAB_00433060;
      if (debug_option == 1) {
        sprintf(sLine,"- FLD (%03d) : (%03d) : [%s] ",(ulong)uVar10,(ulong)(uint)nLength,sWork);
        goto LAB_00433053;
      }
      sprintf(sLine,"- FLD (%03d) : (%03d) : [*******************] ",(ulong)uVar10,
              (ulong)(uint)nLength);
      goto LAB_00433053;
    case 0x30:
      iVar2 = GetIsoField(field_no,&msgInfo,sWork,&nLength);
      field_no = uVar10;
      if (iVar2 != 0) goto LAB_00432aa0;
      sprintf(sLine,"- FLD (%03d) : (%03d) : ",0x30,(ulong)(uint)nLength);
      trace_event(sLine,4);
      InitTlvPrivate(&tlvInfo);
      AnalyseTlvPrivate(sWork,nLength,&tlvInfo);
      ppcVar7 = &sPrivateDataDesc[0].value;
      goto LAB_00432c86;
    case 0x35:
      iVar2 = GetIsoField(field_no,&msgInfo,sWork,&nLength);
      field_no = uVar10;
      if (iVar2 != 0) goto LAB_00432aa0;
      lVar3 = 0;
      sprintf(sLine,"- FLD (%03d) : (%03d) : ",0x35,(ulong)(uint)nLength);
      trace_event(sLine,4);
      do {
        GetSecurityData((int)lVar3,sWork,sub_data,&nLength);
        ppcVar7 = sSecurityDesc + lVar3;
        lVar3 = lVar3 + 1;
        sprintf(sLine,"       > %.25s ..............: [%s] ",*ppcVar7,sub_data);
        trace_event(sLine,4);
        if (lVar3 == 10) goto LAB_00432aa0;
      } while( true );
    case 0x37:
      iVar2 = GetIsoField(field_no,&msgInfo,sWork,&nLength);
      field_no = uVar10;
      if (iVar2 != 0) goto LAB_00432aa0;
      iVar2 = 0;
      sprintf(sLine,"- FLD (%03d) : (%03d) : ",0x37,(ulong)(uint)nLength);
      trace_event(sLine,4);
      if (nLength < 1) goto LAB_00432aa0;
      do {
        puVar9 = (uchar *)sValue;
        for (lVar3 = 0x200; lVar3 != 0; lVar3 = lVar3 + -1) {
          puVar9[0] = '\0';
          puVar9[1] = '\0';
          puVar9[2] = '\0';
          puVar9[3] = '\0';
          puVar9[4] = '\0';
          puVar9[5] = '\0';
          puVar9[6] = '\0';
          puVar9[7] = '\0';
          puVar9 = puVar9 + (ulong)bVar12 * -0x10 + 8;
        }
        sTag[0] = '\0';
        sTag[1] = '\0';
        sTag[2] = '\0';
        sTag[3] = '\0';
        sTag[4] = '\0';
        if ((sWork[iVar2] & 0x1fU) == 0x1f) {
          iVar5 = iVar2 + 2;
          sprintf(sTag,"%02X%02X",(ulong)(byte)sWork[iVar2],(ulong)(byte)sWork[iVar2 + 1]);
        }
        else {
          iVar5 = iVar2 + 1;
          sprintf(sTag,"%02X  ");
        }
        iVar2 = iVar5 + 1;
        bVar1 = sWork[iVar5];
        puVar9 = (uchar *)(sWork + iVar2);
        uVar11 = puVar9 == (uchar *)0x0;
        HexToAscii(puVar9,(uchar *)sValue,(uint)bVar1 + (uint)bVar1);
        lVar3 = 5;
        pcVar8 = sTag;
        pcVar4 = "57  ";
        do {
          if (lVar3 == 0) break;
          lVar3 = lVar3 + -1;
          uVar11 = *pcVar8 == *pcVar4;
          pcVar8 = pcVar8 + (ulong)bVar12 * -2 + 1;
          pcVar4 = pcVar4 + (ulong)bVar12 * -2 + 1;
        } while ((bool)uVar11);
        if ((bool)uVar11) {
          builtin_strncpy(sLine,"      > TAG (57  ) ....: [*******************]",0x2f);
          iVar2 = (uint)bVar1 + iVar2;
          trace_event(sLine,4);
          if (nLength <= iVar2) goto LAB_00432aa0;
        }
        else {
          iVar2 = (uint)bVar1 + iVar2;
          sprintf(sLine,"      > TAG (%.4s) ....: [%s]",sTag,sValue);
          trace_event(sLine,4);
          if (nLength <= iVar2) goto LAB_00432aa0;
        }
      } while( true );
    case 0x3c:
      iVar2 = GetIsoField(field_no,&msgInfo,sWork,&nLength);
      field_no = uVar10;
      if (iVar2 != 0) goto LAB_00432aa0;
      sprintf(sLine,"- FLD (%03d) : (%03d) : ",0x3c,(ulong)(uint)nLength);
      trace_event(sLine,4);
      InitTlvPrivate(&tlvInfo);
      AnalyseTlvPrivate(sWork,nLength,&tlvInfo);
      ppcVar7 = &sPrivateAddPosDesc[0].value;
      do {
        iVar2 = GetTlvPrivate(*ppcVar7,&tlvInfo,sub_data,&nLength);
        if (iVar2 == 0) {
          pcVar8 = ((t_tlv_print *)(ppcVar7 + -1))->description;
          pcVar4 = *ppcVar7;
          sub_data[nLength] = '\0';
          sprintf(sLine,"       >Tag: \'%.3s\' : (%25s) : [%s]",pcVar4,pcVar8,sub_data);
          trace_event(sLine,4);
        }
        ppcVar7 = ppcVar7 + 2;
        if (ppcVar7 == &sPrivateCpsDesc[0].value) goto LAB_00432aa0;
      } while( true );
    case 0x3d:
      iVar2 = GetIsoField(field_no,&msgInfo,sWork,&nLength);
      field_no = uVar10;
      if (iVar2 != 0) goto LAB_00432aa0;
      sprintf(sLine,"- FLD (%03d) : (%03d) : ",0x3d,(ulong)(uint)nLength);
      trace_event(sLine,4);
      InitTlvPrivate(&tlvInfo);
      AnalyseTlvPrivate(sWork,nLength,&tlvInfo);
      ppcVar7 = &sPrivateNetworkDesc[0].value;
      do {
        iVar2 = GetTlvPrivate(*ppcVar7,&tlvInfo,sub_data,&nLength);
        if (iVar2 == 0) {
          pcVar8 = ((t_tlv_print *)(ppcVar7 + -1))->description;
          pcVar4 = *ppcVar7;
          sub_data[nLength] = '\0';
          sprintf(sLine,"       >Tag: \'%.3s\' : (%25s) : [%s]",pcVar4,pcVar8,sub_data);
          trace_event(sLine,4);
        }
        ppcVar7 = ppcVar7 + 2;
        if (ppcVar7 == (char **)0x6ff818) goto LAB_00432aa0;
      } while( true );
    case 0x3e:
      iVar2 = GetIsoField(field_no,&msgInfo,sWork,&nLength);
      field_no = uVar10;
      if (iVar2 != 0) goto LAB_00432aa0;
      sprintf(sLine,"- FLD (%03d) : (%03d) : ",0x3e,(ulong)(uint)nLength);
      trace_event(sLine,4);
      InitTlvPrivate(&tlvInfo);
      AnalyseTlvPrivate(sWork,nLength,&tlvInfo);
      ppcVar7 = &sPrivateCpsDesc[0].value;
      do {
        iVar2 = GetTlvPrivate(*ppcVar7,&tlvInfo,sub_data,&nLength);
        if (iVar2 == 0) {
          pcVar8 = ((t_tlv_print *)(ppcVar7 + -1))->description;
          pcVar4 = *ppcVar7;
          sub_data[nLength] = '\0';
          sprintf(sLine,"       >Tag: \'%.3s\' : (%25s) : [%s]",pcVar4,pcVar8,sub_data);
          trace_event(sLine,4);
        }
        ppcVar7 = ppcVar7 + 2;
        if (ppcVar7 == (char **)0x6ff8d8) goto LAB_00432aa0;
      } while( true );
    }
  } while( true );
LAB_00432c86:
  iVar2 = GetTlvPrivate(*ppcVar7,&tlvInfo,sub_data,&nLength);
  if (iVar2 == 0) {
    pcVar8 = *ppcVar7;
    sub_data[nLength] = '\0';
    iVar2 = memcmp(pcVar8,&DAT_004a4e04,3);
    if ((iVar2 == 0) || (iVar2 = memcmp(pcVar8,&DAT_004aa703,3), iVar2 == 0)) {
      pcVar4 = ((t_tlv_print *)(ppcVar7 + -1))->description;
      if (debug_option == 1) goto LAB_00432cf6;
      sprintf(sLine,"       >Tag: \'%.3s\' : (%25s) : [****************]",pcVar8,pcVar4);
    }
    else {
      pcVar4 = ((t_tlv_print *)(ppcVar7 + -1))->description;
LAB_00432cf6:
      sprintf(sLine,"       >Tag: \'%.3s\' : (%25s) : [%s]",pcVar8,pcVar4,sub_data);
    }
    trace_event(sLine,4);
  }
  ppcVar7 = ppcVar7 + 2;
  if (ppcVar7 == &sAdditRespDataDesc[0].value) goto LAB_00432aa0;
  goto LAB_00432c86;
}



// WARNING: Unknown calling convention

void dump_p7_struct(TSIsoInfo *isoinfo)

{
  long lVar1;
  char *pcVar2;
  char data [4096];
  
  pcVar2 = data;
  for (lVar1 = 0x200; lVar1 != 0; lVar1 = lVar1 + -1) {
    *(undefined8 *)pcVar2 = 0;
    pcVar2 = (char *)((long)pcVar2 + 8);
  }
  IsoBuildMsg(data,isoinfo);
  DumpIso(data);
  return;
}



// WARNING: Unknown calling convention

void IsoDumpIccFields(char *sIccData,int nIccLen)

{
  int iVar1;
  long lVar2;
  char *pcVar3;
  undefined **ppuVar4;
  char *__format;
  ISOTAG *pIVar5;
  char *pcVar6;
  char **ppcVar7;
  byte bVar8;
  int nLen;
  ISOTAG aIccIsoTag [40];
  TSTagIso lTagIso;
  char sWork [4096];
  char sLine [4096];
  
  bVar8 = 0;
  nLen = 0;
  ppuVar4 = &PTR_s_ISO_TAG_ISS_SCRIPT1_006ff520;
  pIVar5 = aIccIsoTag;
  for (lVar2 = 0x50; lVar2 != 0; lVar2 = lVar2 + -1) {
    pIVar5->sTagDesc = *ppuVar4;
    ppuVar4 = ppuVar4 + 1;
    pIVar5 = (ISOTAG *)&pIVar5->sTagValue;
  }
  ppcVar7 = &aIccIsoTag[0].sTagValue;
  trace_event("Start IsoDumpIccFields()",5);
  pcVar6 = sWork;
  for (lVar2 = 0x200; lVar2 != 0; lVar2 = lVar2 + -1) {
    pcVar6[0] = '\0';
    pcVar6[1] = '\0';
    pcVar6[2] = '\0';
    pcVar6[3] = '\0';
    pcVar6[4] = '\0';
    pcVar6[5] = '\0';
    pcVar6[6] = '\0';
    pcVar6[7] = '\0';
    pcVar6 = pcVar6 + (ulong)bVar8 * -0x10 + 8;
  }
  InitIsoIcTag(&lTagIso);
  AnalyseIsoIc(sIccData,nIccLen,&lTagIso);
  trace_event("         Field                        |  Len  |              Value",4);
  do {
    pcVar6 = sWork;
    for (lVar2 = 0x200; lVar2 != 0; lVar2 = lVar2 + -1) {
      pcVar6[0] = '\0';
      pcVar6[1] = '\0';
      pcVar6[2] = '\0';
      pcVar6[3] = '\0';
      pcVar6[4] = '\0';
      pcVar6[5] = '\0';
      pcVar6[6] = '\0';
      pcVar6[7] = '\0';
      pcVar6 = pcVar6 + (ulong)bVar8 * -0x10 + 8;
    }
    pcVar6 = *ppcVar7;
    iVar1 = GetIsoIcTag(pcVar6,&lTagIso,sWork,&nLen);
    if (iVar1 == 0) {
      if (debug_option == 0) {
        iVar1 = memcmp(pcVar6,&DAT_004d6e34,2);
        if (iVar1 != 0) {
          iVar1 = memcmp(pcVar6,&DAT_004a744c,2);
          if (iVar1 != 0) goto LAB_00433421;
        }
        pcVar3 = ((ISOTAG *)(ppcVar7 + -1))->sTagDesc;
        __format = " >> %s|%s : [%03d] : [.....................]";
      }
      else {
LAB_00433421:
        pcVar3 = ((ISOTAG *)(ppcVar7 + -1))->sTagDesc;
        __format = " >> %s|%s : [%03d] : [%s]";
      }
      sprintf(sLine,__format,pcVar6,pcVar3,(ulong)(uint)nLen,sWork);
      trace_event(sLine,4);
    }
    ppcVar7 = ppcVar7 + 2;
    if (ppcVar7 == (char **)(lTagIso.nPresent + 2)) {
      trace_event("End   IsoDumpIccFields()",5);
      return;
    }
  } while( true );
}



// WARNING: Unknown calling convention

void comphex(uchar *target,uchar *source)

{
  uchar uVar1;
  byte bVar2;
  byte bVar3;
  size_t sVar4;
  byte bVar5;
  ulong uVar6;
  
  uVar6 = 0;
  while( true ) {
    sVar4 = strlen((char *)source);
    if (sVar4 >> 1 <= uVar6) break;
    uVar1 = source[uVar6 * 2];
    bVar2 = source[uVar6 * 2 + 1];
    bVar3 = 0xa0;
    if ((((uVar1 != 'A') && (bVar3 = 0xb0, uVar1 != 'B')) && (bVar3 = 0xc0, uVar1 != 'C')) &&
       ((bVar3 = 0xd0, uVar1 != 'D' && (bVar3 = 0xe0, uVar1 != 'E')))) {
      bVar3 = 0xf0;
      if (uVar1 != 'F') {
        bVar3 = uVar1 << 4;
      }
    }
    bVar5 = 10;
    if (((bVar2 != 0x41) && (bVar5 = 0xb, bVar2 != 0x42)) &&
       ((bVar5 = 0xc, bVar2 != 0x43 &&
        (((bVar5 = 0xd, bVar2 != 0x44 && (bVar5 = 0xe, bVar2 != 0x45)) &&
         (bVar5 = bVar2 & 0xf, bVar2 == 0x46)))))) {
      bVar5 = 0xf;
    }
    target[uVar6] = bVar3 | bVar5;
    uVar6 = uVar6 + 1;
  }
  return;
}



// WARNING: Unknown calling convention

int TrunCard(char *Card,char *Trunc)

{
  int iVar1;
  size_t sVar2;
  long lVar3;
  
  sVar2 = strlen(Card);
  iVar1 = (int)sVar2;
  *(undefined4 *)Trunc = *(undefined4 *)Card;
  *(undefined2 *)(Trunc + 4) = *(undefined2 *)(Card + 4);
  lVar3 = 0;
  if (0 < iVar1 + -10) {
    do {
      Trunc[lVar3 + 6] = '*';
      lVar3 = lVar3 + 1;
    } while ((int)lVar3 < iVar1 + -10);
  }
  *(undefined4 *)(Trunc + (long)iVar1 + -4) = *(undefined4 *)(Card + (long)iVar1 + -4);
  Trunc[(long)iVar1 + -1] = '*';
  return 0;
}



// WARNING: Unknown calling convention

int TrunCard_8(char *Card,char *Trunc)

{
  int iVar1;
  size_t sVar2;
  long lVar3;
  
  sVar2 = strlen(Card);
  iVar1 = (int)sVar2;
  *(undefined8 *)Trunc = *(undefined8 *)Card;
  lVar3 = 0;
  if (0 < iVar1 + -0xc) {
    do {
      Trunc[lVar3 + 8] = '*';
      lVar3 = lVar3 + 1;
    } while ((int)lVar3 < iVar1 + -0xc);
  }
  *(undefined4 *)(Trunc + (long)iVar1 + -4) = *(undefined4 *)(Card + (long)iVar1 + -4);
  Trunc[(long)iVar1 + -1] = '*';
  return 0;
}



// WARNING: Unknown calling convention

int DeCryptCard(char *source,char *dest)

{
  dest[0] = '\0';
  dest[1] = '\0';
  dest[2] = '\0';
  dest[3] = '\0';
  dest[4] = '\0';
  dest[5] = '\0';
  dest[6] = '\0';
  dest[7] = '\0';
  DES(-1,'H',(uchar *)dest,(uchar *)"A1002B0607C1806F",(uchar *)dest);
  comphex((uchar *)dest,(uchar *)source);
  return 0;
}



// WARNING: Unknown calling convention

void EncryptBuff(char *sSrc,int nlenSrc,char *sDest,char Set,char origine,char sens)

{
  int iVar1;
  long lVar2;
  long lVar3;
  uchar *puVar4;
  uint uVar5;
  byte bVar6;
  char sTmpBuf [64];
  char sDestPrint [15000];
  
  bVar6 = 0;
  sDest[0] = '\0';
  sDest[1] = '\0';
  sDest[2] = '\0';
  sDest[3] = '\0';
  sDest[4] = '\0';
  sDest[5] = '\0';
  sDest[6] = '\0';
  sDest[7] = '\0';
  memset(sDestPrint,0,15000);
  puVar4 = (uchar *)sTmpBuf;
  for (lVar2 = 8; lVar2 != 0; lVar2 = lVar2 + -1) {
    puVar4[0] = '\0';
    puVar4[1] = '\0';
    puVar4[2] = '\0';
    puVar4[3] = '\0';
    puVar4[4] = '\0';
    puVar4[5] = '\0';
    puVar4[6] = '\0';
    puVar4[7] = '\0';
    puVar4 = puVar4 + (ulong)bVar6 * -0x10 + 8;
  }
  trace_event("Before Dump",4);
  uVar5 = nlenSrc % 8;
  sprintf(sDestPrint,"%01d",(ulong)uVar5);
  if (nlenSrc < 9) {
    DES(1,'C',(uchar *)sSrc,(uchar *)"A1002B0607C1806F",(uchar *)sDest);
    sDestPrint._1_8_ = *(undefined8 *)sDest;
    dump_buffer_debug((uchar *)sDestPrint,9,Set,origine,sens);
  }
  else {
    lVar2 = 0;
    do {
      puVar4 = (uchar *)sTmpBuf;
      for (lVar3 = 8; lVar3 != 0; lVar3 = lVar3 + -1) {
        puVar4[0] = '\0';
        puVar4[1] = '\0';
        puVar4[2] = '\0';
        puVar4[3] = '\0';
        puVar4[4] = '\0';
        puVar4[5] = '\0';
        puVar4[6] = '\0';
        puVar4[7] = '\0';
        puVar4 = puVar4 + (ulong)bVar6 * -0x10 + 8;
      }
      DES(1,'C',(uchar *)(sSrc + lVar2),(uchar *)"A1002B0607C1806F",(uchar *)sTmpBuf);
      *(undefined8 *)(sDest + lVar2) = sTmpBuf._0_8_;
      lVar2 = lVar2 + 8;
    } while ((int)lVar2 < (int)(nlenSrc - uVar5));
    iVar1 = ((nlenSrc - uVar5) - 1 & 0xfffffff8) + 8;
    if (uVar5 == 0) {
      memcpy(sDestPrint + 1,sDest,(long)nlenSrc);
      dump_buffer_debug((uchar *)sDestPrint,nlenSrc + 1,Set,origine,sens);
    }
    else {
      puts("Inside k");
      puVar4 = (uchar *)sTmpBuf;
      for (lVar2 = 8; lVar2 != 0; lVar2 = lVar2 + -1) {
        puVar4[0] = '\0';
        puVar4[1] = '\0';
        puVar4[2] = '\0';
        puVar4[3] = '\0';
        puVar4[4] = '\0';
        puVar4[5] = '\0';
        puVar4[6] = '\0';
        puVar4[7] = '\0';
        puVar4 = puVar4 + (ulong)bVar6 * -0x10 + 8;
      }
      DES(1,'C',(uchar *)(sSrc + iVar1),(uchar *)"A1002B0607C1806F",(uchar *)sTmpBuf);
      *(undefined8 *)(sDest + iVar1) = sTmpBuf._0_8_;
      memcpy(sDestPrint + 1,sDest,(long)(int)((nlenSrc + 8) - uVar5));
      dump_buffer_debug((uchar *)sDestPrint,(nlenSrc + 9) - uVar5,Set,origine,sens);
    }
  }
  return;
}



// WARNING: Unknown calling convention

void DecryptBuff(char *sSrcPrint,int nlenSrc,char *sDest,int nLenToprint)

{
  long lVar1;
  long lVar2;
  uchar *puVar3;
  int iVar4;
  uint SizeBuffer;
  byte bVar5;
  char sRem [1];
  char sTmpBuf [64];
  char sSrc [2000];
  
  bVar5 = 0;
  SizeBuffer = nlenSrc - 1;
  sRem[0] = '\0';
  puVar3 = (uchar *)sTmpBuf;
  for (lVar1 = 8; lVar1 != 0; lVar1 = lVar1 + -1) {
    puVar3[0] = '\0';
    puVar3[1] = '\0';
    puVar3[2] = '\0';
    puVar3[3] = '\0';
    puVar3[4] = '\0';
    puVar3[5] = '\0';
    puVar3[6] = '\0';
    puVar3[7] = '\0';
    puVar3 = puVar3 + 8;
  }
  puVar3 = (uchar *)sSrc;
  for (lVar1 = 0xfa; lVar1 != 0; lVar1 = lVar1 + -1) {
    puVar3[0] = '\0';
    puVar3[1] = '\0';
    puVar3[2] = '\0';
    puVar3[3] = '\0';
    puVar3[4] = '\0';
    puVar3[5] = '\0';
    puVar3[6] = '\0';
    puVar3[7] = '\0';
    puVar3 = puVar3 + 8;
  }
  memcpy(sSrc,sSrcPrint + 1,(long)(int)SizeBuffer);
  if ((int)SizeBuffer < 9) {
    DES(-1,'C',(uchar *)sSrc,(uchar *)"A1002B0607C1806F",(uchar *)sDest);
  }
  else {
    lVar1 = 0;
    iVar4 = SizeBuffer - (SizeBuffer & 7);
    do {
      puVar3 = (uchar *)sTmpBuf;
      for (lVar2 = 8; lVar2 != 0; lVar2 = lVar2 + -1) {
        puVar3[0] = '\0';
        puVar3[1] = '\0';
        puVar3[2] = '\0';
        puVar3[3] = '\0';
        puVar3[4] = '\0';
        puVar3[5] = '\0';
        puVar3[6] = '\0';
        puVar3[7] = '\0';
        puVar3 = puVar3 + (ulong)bVar5 * -0x10 + 8;
      }
      DES(-1,'C',(uchar *)(sSrc + lVar1),(uchar *)"A1002B0607C1806F",(uchar *)sTmpBuf);
      *(undefined8 *)(sDest + lVar1) = sTmpBuf._0_8_;
      lVar1 = lVar1 + 8;
    } while ((int)lVar1 < iVar4);
    iVar4 = (iVar4 - 1U & 0xfffffff8) + 8;
    if ((SizeBuffer & 7) != 0) {
      puts("Inside k");
      puVar3 = (uchar *)sTmpBuf;
      for (lVar1 = 8; lVar1 != 0; lVar1 = lVar1 + -1) {
        puVar3[0] = '\0';
        puVar3[1] = '\0';
        puVar3[2] = '\0';
        puVar3[3] = '\0';
        puVar3[4] = '\0';
        puVar3[5] = '\0';
        puVar3[6] = '\0';
        puVar3[7] = '\0';
        puVar3 = puVar3 + (ulong)bVar5 * -0x10 + 8;
      }
      DES(-1,'C',(uchar *)(sSrc + iVar4),(uchar *)"A1002B0607C1806F",(uchar *)sTmpBuf);
      *(undefined8 *)(sDest + iVar4) = sTmpBuf._0_8_;
    }
  }
  if (*sSrcPrint != '0') {
    sRem[0] = *sSrcPrint;
    iVar4 = atoi(sRem);
    SizeBuffer = nlenSrc + -9 + iVar4;
  }
  dump_buffer_debug((uchar *)sDest,SizeBuffer,'A','B','I');
  return;
}



// WARNING: Unknown calling convention

int CryptCard(char *Card,char *CryptCrd)

{
  uint uVar1;
  uint uVar2;
  size_t __n;
  long lVar3;
  uint *puVar4;
  uint *puVar5;
  ulong uVar6;
  char *pcVar7;
  uchar *puVar8;
  bool bVar9;
  char acStack_10f2 [10];
  char clearCard [23];
  char CryptHex [128];
  char sLine [4097];
  
  pcVar7 = sLine;
  for (lVar3 = 0x200; lVar3 != 0; lVar3 = lVar3 + -1) {
    pcVar7[0] = '\0';
    pcVar7[1] = '\0';
    pcVar7[2] = '\0';
    pcVar7[3] = '\0';
    pcVar7[4] = '\0';
    pcVar7[5] = '\0';
    pcVar7[6] = '\0';
    pcVar7[7] = '\0';
    pcVar7 = pcVar7 + 8;
  }
  *pcVar7 = '\0';
  puVar8 = (uchar *)CryptHex;
  for (lVar3 = 0x10; lVar3 != 0; lVar3 = lVar3 + -1) {
    puVar8[0] = '\0';
    puVar8[1] = '\0';
    puVar8[2] = '\0';
    puVar8[3] = '\0';
    puVar8[4] = '\0';
    puVar8[5] = '\0';
    puVar8[6] = '\0';
    puVar8[7] = '\0';
    puVar8 = puVar8 + 8;
  }
  builtin_strncpy(acStack_10f2 + 2,"W:C",4);
  acStack_10f2[6] = '\0';
  acStack_10f2[7] = '\0';
  acStack_10f2[8] = '\0';
  acStack_10f2[9] = '\0';
  __n = strlen(Card);
  builtin_strncpy(acStack_10f2 + 2,"k:C",4);
  acStack_10f2[6] = '\0';
  acStack_10f2[7] = '\0';
  acStack_10f2[8] = '\0';
  acStack_10f2[9] = '\0';
  memset(clearCard,0,__n);
  builtin_strncpy(acStack_10f2 + 2,"z:C",4);
  acStack_10f2[6] = '\0';
  acStack_10f2[7] = '\0';
  acStack_10f2[8] = '\0';
  acStack_10f2[9] = '\0';
  memcpy(clearCard,Card + 6,__n - 10);
  uVar6 = 0;
  acStack_10f2[__n] = Card[__n - 1];
  puVar5 = (uint *)clearCard;
  puVar8 = (uchar *)CryptHex;
  while( true ) {
    do {
      puVar4 = puVar5;
      uVar1 = *puVar4 + 0xfefefeff & ~*puVar4;
      uVar2 = uVar1 & 0x80808080;
      puVar5 = puVar4 + 1;
    } while (uVar2 == 0);
    bVar9 = (uVar1 & 0x8080) == 0;
    if (bVar9) {
      uVar2 = uVar2 >> 0x10;
    }
    if (bVar9) {
      puVar5 = (uint *)((long)puVar4 + 6);
    }
    if ((long)puVar5 + ((-3 - (ulong)CARRY1((byte)uVar2,(byte)uVar2)) - (long)clearCard) <= uVar6)
    break;
    pcVar7 = clearCard + uVar6;
    uVar6 = uVar6 + 1;
    acStack_10f2[2] = -0x52;
    acStack_10f2[3] = ':';
    acStack_10f2[4] = 'C';
    acStack_10f2[5] = '\0';
    acStack_10f2[6] = '\0';
    acStack_10f2[7] = '\0';
    acStack_10f2[8] = '\0';
    acStack_10f2[9] = '\0';
    sprintf((char *)puVar8,"%0X",(ulong)(uint)(int)*pcVar7);
    puVar5 = (uint *)clearCard;
    puVar8 = puVar8 + 2;
  }
  builtin_strncpy(acStack_10f2 + 2,"\r;C",4);
  acStack_10f2[6] = '\0';
  acStack_10f2[7] = '\0';
  acStack_10f2[8] = '\0';
  acStack_10f2[9] = '\0';
  DES(1,'H',(uchar *)CryptHex,(uchar *)"A1002B0607C1806F",(uchar *)CryptCrd);
  return 0;
}



// WARNING: Unknown calling convention

int GetTrack2Data(char *sTrack2Data,char *sPan,char *sExpiryDate,char *sServiceCode,char *sPvv,
                 char *sCvv1)

{
  char cVar1;
  size_t sVar2;
  
  sVar2 = strlen(sTrack2Data);
  if ((int)sVar2 != 0) {
    sVar2 = (size_t)(*sTrack2Data == '0');
    cVar1 = sTrack2Data[sVar2];
    while ((int)cVar1 - 0x30U < 10) {
      sVar2 = sVar2 + 1;
      cVar1 = sTrack2Data[sVar2];
    }
    memcpy(sPan,sTrack2Data,sVar2);
    *(undefined4 *)sExpiryDate = *(undefined4 *)(sTrack2Data + sVar2 + 1);
    *(undefined2 *)sServiceCode = *(undefined2 *)(sTrack2Data + sVar2 + 5);
    sServiceCode[2] = (sTrack2Data + sVar2 + 5)[2];
    *(undefined4 *)sPvv = *(undefined4 *)(sTrack2Data + sVar2 + 8);
    sPvv[4] = (sTrack2Data + sVar2 + 8)[4];
    *(undefined2 *)sCvv1 = *(undefined2 *)(sTrack2Data + sVar2 + 0xe);
    sCvv1[2] = (sTrack2Data + sVar2 + 0xe)[2];
    if (*sCvv1 == '\0') {
      sCvv1[2] = '0';
      sCvv1[0] = '0';
      sCvv1[1] = '0';
    }
  }
  return 0;
}



// WARNING: Unknown calling convention

int GetBankTrack2Data(char *sTrack2Data,char *sPan,char *sExpiryDate,char *sServiceCode,char *sPvv,
                     char *sCvv1,char *sTrack2DataC)

{
  uint uVar1;
  uint uVar2;
  size_t sVar3;
  long lVar4;
  char *__src;
  uint *puVar5;
  uint *puVar6;
  size_t __n;
  int iVar7;
  bool bVar8;
  byte bVar9;
  long local_160;
  long local_158;
  long local_150;
  char tmpField [255];
  
  bVar9 = 0;
  sVar3 = strlen(sTrack2Data);
  puVar6 = (uint *)tmpField;
  for (lVar4 = 0x1f; lVar4 != 0; lVar4 = lVar4 + -1) {
    puVar6[0] = 0;
    puVar6[1] = 0;
    puVar6 = puVar6 + (ulong)bVar9 * -4 + 2;
  }
  sTrack2DataC[0] = '\0';
  sTrack2DataC[1] = '\0';
  sTrack2DataC[2] = '\0';
  sTrack2DataC[3] = '\0';
  sTrack2DataC[4] = '\0';
  sTrack2DataC[5] = '\0';
  sTrack2DataC[6] = '\0';
  sTrack2DataC[7] = '\0';
  *puVar6 = 0;
  *(undefined2 *)(puVar6 + 1) = 0;
  *(undefined1 *)((long)puVar6 + 6) = 0;
  if ((int)sVar3 != 0) {
    if ((int)*sTrack2Data - 0x30U < 10) {
      sVar3 = 1;
      do {
        __n = sVar3;
        iVar7 = (int)__n;
        sVar3 = __n + 1;
      } while ((int)sTrack2Data[__n] - 0x30U < 10);
      local_160 = __n + 5;
      local_158 = __n + 8;
      local_150 = __n + 0xe;
    }
    else {
      local_150 = 0xe;
      local_158 = 8;
      sVar3 = 1;
      local_160 = 5;
      __n = 0;
      iVar7 = 0;
    }
    if (*sTrack2Data == '0') {
      __src = sTrack2Data + 1;
      memcpy(sPan,__src,(long)(iVar7 + -1));
    }
    else {
      memcpy(sPan,sTrack2Data,__n);
      __src = sTrack2Data;
    }
    *(undefined4 *)sExpiryDate = *(undefined4 *)(sTrack2Data + sVar3);
    *(undefined2 *)sServiceCode = *(undefined2 *)(sTrack2Data + local_160);
    sServiceCode[2] = (sTrack2Data + local_160)[2];
    *(undefined4 *)sPvv = *(undefined4 *)(sTrack2Data + local_158);
    sPvv[4] = (sTrack2Data + local_158)[4];
    *(undefined2 *)sCvv1 = *(undefined2 *)(sTrack2Data + local_150);
    sCvv1[2] = (sTrack2Data + local_150)[2];
    tmpField._0_8_ = *(undefined8 *)__src;
    tmpField._8_8_ = *(undefined8 *)(__src + 8);
    tmpField._16_8_ = *(undefined8 *)(__src + 0x10);
    tmpField._24_8_ = *(undefined8 *)(__src + 0x18);
    tmpField[0x20] = __src[0x20];
    puVar6 = (uint *)tmpField;
    do {
      puVar5 = puVar6;
      uVar1 = *puVar5 + 0xfefefeff & ~*puVar5;
      uVar2 = uVar1 & 0x80808080;
      puVar6 = puVar5 + 1;
    } while (uVar2 == 0);
    bVar8 = (uVar1 & 0x8080) == 0;
    if (bVar8) {
      uVar2 = uVar2 >> 0x10;
    }
    if (bVar8) {
      puVar6 = (uint *)((long)puVar5 + 6);
    }
    memcpy(sTrack2DataC,tmpField,
           (long)puVar6 + ((-3 - (ulong)CARRY1((byte)uVar2,(byte)uVar2)) - (long)tmpField));
    if (*sCvv1 == '\0') {
      sCvv1[2] = '0';
      sCvv1[0] = '0';
      sCvv1[1] = '0';
    }
  }
  return 0;
}



// WARNING: Unknown calling convention

int GetDinersTrack2Data(char *sTrack2Data,char *sPan,char *sExpiryDate,char *sServiceCode,
                       char *sEffectiveDate,char *sPvv,char *sCvv1,char *sTrack2DataC)

{
  char cVar1;
  undefined2 uVar2;
  undefined4 uVar3;
  uint uVar4;
  uint uVar5;
  size_t sVar6;
  long lVar7;
  long lVar8;
  uint *puVar9;
  uint *puVar10;
  int iVar11;
  char *pcVar12;
  long lVar13;
  long lVar14;
  bool bVar15;
  byte bVar16;
  long local_268;
  long local_258;
  char tmpField [255];
  char tmpField1 [255];
  
  bVar16 = 0;
  sVar6 = strlen(sTrack2Data);
  puVar10 = (uint *)tmpField;
  for (lVar7 = 0x1f; lVar7 != 0; lVar7 = lVar7 + -1) {
    puVar10[0] = 0;
    puVar10[1] = 0;
    puVar10 = puVar10 + (ulong)bVar16 * -4 + 2;
  }
  *(undefined2 *)(puVar10 + 1) = 0;
  *puVar10 = 0;
  *(undefined1 *)((long)puVar10 + 6) = 0;
  pcVar12 = tmpField1;
  for (lVar7 = 0x1f; lVar7 != 0; lVar7 = lVar7 + -1) {
    pcVar12[0] = '\0';
    pcVar12[1] = '\0';
    pcVar12[2] = '\0';
    pcVar12[3] = '\0';
    pcVar12[4] = '\0';
    pcVar12[5] = '\0';
    pcVar12[6] = '\0';
    pcVar12[7] = '\0';
    pcVar12 = pcVar12 + (ulong)bVar16 * -0x10 + 8;
  }
  sTrack2DataC[0] = '\0';
  sTrack2DataC[1] = '\0';
  sTrack2DataC[2] = '\0';
  sTrack2DataC[3] = '\0';
  sTrack2DataC[4] = '\0';
  sTrack2DataC[5] = '\0';
  sTrack2DataC[6] = '\0';
  sTrack2DataC[7] = '\0';
  pcVar12[0] = '\0';
  pcVar12[1] = '\0';
  pcVar12[2] = '\0';
  pcVar12[3] = '\0';
  pcVar12[4] = '\0';
  pcVar12[5] = '\0';
  pcVar12[6] = '\0';
  trace_event("GetDinersTrack2Data ...",5);
  if ((int)sVar6 != 0) {
    sVar6 = strlen(sTrack2Data);
    memcpy(tmpField1,sTrack2Data + (*sTrack2Data == ';'),sVar6 - (*sTrack2Data == ';'));
    if ((int)tmpField1[0] - 0x30U < 10) {
      pcVar12 = tmpField1;
      iVar11 = 0;
      do {
        pcVar12 = pcVar12 + 1;
        iVar11 = iVar11 + 1;
      } while ((int)*pcVar12 - 0x30U < 10);
      sVar6 = (size_t)iVar11;
      lVar7 = sVar6 + 5;
      lVar14 = sVar6 + 1;
      lVar13 = sVar6 + 8;
      lVar8 = sVar6 + 0x15;
      local_268 = sVar6 + 0xc;
      local_258 = sVar6 + 0xf;
    }
    else {
      lVar8 = 0x15;
      local_258 = 0xf;
      local_268 = 0xc;
      lVar13 = 8;
      lVar7 = 5;
      lVar14 = 1;
      sVar6 = 0;
      iVar11 = 0;
    }
    if (tmpField1[0] == '0') {
      memcpy(sPan,tmpField1 + 1,(long)(iVar11 + -1));
    }
    else {
      memcpy(sPan,tmpField1,sVar6);
    }
    *(undefined4 *)sExpiryDate = *(undefined4 *)(tmpField1 + lVar14);
    uVar2 = *(undefined2 *)(tmpField1 + lVar7);
    sServiceCode[2] = tmpField1[lVar7 + 2];
    uVar3 = *(undefined4 *)(tmpField1 + lVar13);
    *(undefined2 *)sServiceCode = uVar2;
    *(undefined4 *)sEffectiveDate = uVar3;
    *sPvv = '1';
    uVar2 = *(undefined2 *)(tmpField1 + local_268);
    sPvv[3] = tmpField1[local_268 + 2];
    *(undefined2 *)(sPvv + 1) = uVar2;
    uVar2 = *(undefined2 *)(tmpField1 + local_258);
    sCvv1[2] = tmpField1[local_258 + 2];
    cVar1 = tmpField1[lVar8];
    *(undefined2 *)sCvv1 = uVar2;
    sPvv[4] = cVar1;
    if (*sCvv1 == '\0') {
      sCvv1[2] = '0';
      sCvv1[0] = '0';
      sCvv1[1] = '0';
    }
    sVar6 = strlen(sPan);
    iVar11 = (int)sVar6;
    memcpy(tmpField,sPan,(long)iVar11);
    *(undefined1 *)((long)tmpField + (long)iVar11) = 0x3d;
    *(undefined4 *)((long)tmpField + (long)(iVar11 + 1)) = *(undefined4 *)sExpiryDate;
    *(undefined2 *)((long)(iVar11 + 5) + (long)tmpField) = *(undefined2 *)sServiceCode;
    tmpField[(long)(iVar11 + 5) + 2] = sServiceCode[2];
    *(undefined4 *)((long)(iVar11 + 8) + (long)tmpField) = *(undefined4 *)sPvv;
    tmpField[(long)(iVar11 + 8) + 4] = sPvv[4];
    uVar2 = *(undefined2 *)sCvv1;
    *(undefined1 *)((long)tmpField + (long)(iVar11 + 0xd)) = 0x30;
    *(undefined2 *)((long)(iVar11 + 0xe) + (long)tmpField) = uVar2;
    tmpField[(long)(iVar11 + 0xe) + 2] = sCvv1[2];
    puVar10 = (uint *)tmpField;
    do {
      puVar9 = puVar10;
      uVar4 = *puVar9 + 0xfefefeff & ~*puVar9;
      uVar5 = uVar4 & 0x80808080;
      puVar10 = puVar9 + 1;
    } while (uVar5 == 0);
    bVar15 = (uVar4 & 0x8080) == 0;
    if (bVar15) {
      uVar5 = uVar5 >> 0x10;
    }
    if (bVar15) {
      puVar10 = (uint *)((long)puVar9 + 6);
    }
    memcpy(sTrack2DataC,tmpField,
           (long)puVar10 + ((-3 - (ulong)CARRY1((byte)uVar5,(byte)uVar5)) - (long)tmpField));
  }
  return 0;
}



// WARNING: Unknown calling convention

int GetDinersTrack1Data(char *sTrack1Data,char *sPan,char *sExpiryDate,char *sServiceCode,char *sPvv
                       ,char *sCvv1)

{
  char cVar1;
  undefined2 uVar2;
  size_t sVar3;
  char *pcVar4;
  long lVar5;
  int iVar6;
  ulong uVar7;
  int iVar8;
  char tmpField1 [255];
  
  sVar3 = strlen(sTrack1Data);
  if ((int)sVar3 != 0) {
    cVar1 = *sTrack1Data;
    if (cVar1 == '%') {
      trace_event("k ====== 1",5);
      sVar3 = strlen(sTrack1Data);
    }
    uVar7 = (ulong)(cVar1 == '%');
    memcpy(tmpField1,sTrack1Data + uVar7,sVar3 - uVar7);
    if (tmpField1[0] == '^') {
      sVar3 = 0xffffffffffffffff;
      iVar8 = 1;
    }
    else {
      pcVar4 = tmpField1;
      iVar8 = 0;
      do {
        iVar6 = iVar8;
        pcVar4 = pcVar4 + 1;
        iVar8 = iVar6 + 1;
      } while (*pcVar4 != '^');
      iVar8 = iVar6 + 2;
      sVar3 = (size_t)iVar6;
    }
    memcpy(sPan,tmpField1 + 1,sVar3);
    lVar5 = (long)iVar8;
    cVar1 = tmpField1[lVar5];
    while (cVar1 != '^') {
      iVar8 = iVar8 + 1;
      lVar5 = (long)iVar8;
      cVar1 = tmpField1[lVar5];
    }
    *(undefined4 *)sExpiryDate = *(undefined4 *)(tmpField1 + lVar5 + 1);
    uVar2 = *(undefined2 *)(tmpField1 + lVar5 + 5);
    sServiceCode[2] = tmpField1[lVar5 + 7];
    *(undefined2 *)sServiceCode = uVar2;
    cVar1 = tmpField1[lVar5 + 0x10];
    *(undefined4 *)sPvv = *(undefined4 *)(tmpField1 + lVar5 + 0xc);
    sPvv[4] = cVar1;
    cVar1 = tmpField1[lVar5 + 0x1b];
    *(undefined2 *)sCvv1 = *(undefined2 *)(tmpField1 + lVar5 + 0x19);
    sCvv1[2] = cVar1;
    iVar8 = memcmp(sCvv1,"   ",3);
    if (iVar8 == 0) {
      sCvv1[2] = '0';
      sCvv1[0] = '0';
      sCvv1[1] = '0';
    }
  }
  return 0;
}



// WARNING: Unknown calling convention

int GetTrack3Data(char *sTrack3Data,char *sOffset)

{
  size_t sVar1;
  
  sVar1 = strlen(sTrack3Data);
  if ((int)sVar1 != 0) {
    *(undefined4 *)sOffset = *(undefined4 *)(sTrack3Data + 0x31);
  }
  return 0;
}



// WARNING: Unknown calling convention

int GetTrack1Data(char *sTrack1Data,char *sPan,char *sExpiryDate,char *sServiceCode,char *sPvv,
                 char *sCvv1)

{
  char cVar1;
  size_t sVar2;
  char *pcVar3;
  long lVar4;
  int iVar5;
  int iVar6;
  
  sVar2 = strlen(sTrack1Data);
  if ((int)sVar2 != 0) {
    if (*sTrack1Data == '^') {
      lVar4 = 1;
      sVar2 = 0xffffffffffffffff;
      iVar6 = 1;
    }
    else {
      pcVar3 = sTrack1Data + 1;
      iVar6 = 0;
      do {
        iVar5 = iVar6;
        cVar1 = *pcVar3;
        pcVar3 = pcVar3 + 1;
        iVar6 = iVar5 + 1;
      } while (cVar1 != '^');
      iVar6 = iVar5 + 2;
      sVar2 = (size_t)iVar5;
      lVar4 = (long)iVar6;
    }
    memcpy(sPan,sTrack1Data + 1,sVar2);
    if (sTrack1Data[lVar4] != '^') {
      lVar4 = (long)iVar6;
      do {
        lVar4 = lVar4 + 1;
      } while (sTrack1Data[lVar4] != '^');
    }
    *(undefined4 *)sExpiryDate = *(undefined4 *)(sTrack1Data + lVar4 + 1);
    *(undefined2 *)sServiceCode = *(undefined2 *)(sTrack1Data + lVar4 + 5);
    sServiceCode[2] = (sTrack1Data + lVar4 + 5)[2];
    *(undefined4 *)sPvv = *(undefined4 *)(sTrack1Data + lVar4 + 8);
    sPvv[4] = (sTrack1Data + lVar4 + 8)[4];
    *(undefined2 *)sCvv1 = *(undefined2 *)(sTrack1Data + lVar4 + 0xf);
    sCvv1[2] = (sTrack1Data + lVar4 + 0xf)[2];
  }
  return 0;
}



// WARNING: Unknown calling convention

int GetSecurityData(int subfield,char *security_data,char *value,int *length)

{
  void *pvVar1;
  
  pvVar1 = memcpy(value,security_data + secdata[subfield].offset,(long)secdata[subfield].length);
  *(undefined1 *)((long)pvVar1 + (long)secdata[subfield].length) = 0;
  *length = secdata[subfield].length;
  return 0;
}



// WARNING: Unknown calling convention

int PutSecurityData(int subfield,char *security_data,char *value,int length)

{
  int iVar1;
  
  if (secdata[subfield].length == length) {
    memcpy(security_data + secdata[subfield].offset,value,(long)secdata[subfield].length);
    iVar1 = 0;
  }
  else {
    trace_event("PutSecurityData Error()",5);
    trace_event("LENGTH FIELD ERROR",5);
    iVar1 = -1;
  }
  return iVar1;
}



// WARNING: Unknown calling convention

int RessourceUp(TSResources *sResource)

{
  int iVar1;
  int iVar2;
  
  iVar1 = -1;
  if (sResource->resource_live[0] == 'Y') {
    iVar1 = memcmp(sResource->pris_processing_step,&DAT_004a2b1c,3);
    if (iVar1 == 0) {
      iVar2 = kill(sResource->pris_pid,0);
      iVar1 = 0;
      if (iVar2 == 0) {
        iVar1 = -1;
        trace_event("End   RessourceUp (NOK)",5);
      }
    }
    else {
      iVar1 = -1;
    }
  }
  return iVar1;
}



// WARNING: Unknown calling convention

int SwapDestAndSource(char *sSecurityData)

{
  int extraout_EAX;
  int nLength;
  char sSourceResource [7];
  char sDestResource [7];
  char tmp_buffer [7];
  char sSourceId [9];
  char sDestinationId [9];
  
  sSourceResource[4] = '\0';
  sSourceResource[5] = '\0';
  sDestResource[4] = '\0';
  sDestResource[5] = '\0';
  sSourceResource[0] = '\0';
  sSourceResource[1] = '\0';
  sSourceResource[2] = '\0';
  sSourceResource[3] = '\0';
  sSourceResource[6] = '\0';
  sDestResource[0] = '\0';
  sDestResource[1] = '\0';
  sDestResource[2] = '\0';
  sDestResource[3] = '\0';
  sDestResource[6] = '\0';
  sSourceId[0] = '\0';
  sSourceId[1] = '\0';
  sSourceId[2] = '\0';
  sSourceId[3] = '\0';
  sSourceId[4] = '\0';
  sSourceId[5] = '\0';
  sSourceId[6] = '\0';
  sSourceId[7] = '\0';
  sSourceId[8] = '\0';
  sDestinationId[0] = '\0';
  sDestinationId[1] = '\0';
  sDestinationId[2] = '\0';
  sDestinationId[3] = '\0';
  sDestinationId[4] = '\0';
  sDestinationId[5] = '\0';
  sDestinationId[6] = '\0';
  sDestinationId[7] = '\0';
  sDestinationId[8] = '\0';
  trace_event("SwapDestAndSource ( Start )",5);
  GetSecurityData(5,sSecurityData,sSourceResource,&nLength);
  GetSecurityData(4,sSecurityData,sSourceId,&nLength);
  GetSecurityData(7,sSecurityData,sDestResource,&nLength);
  GetSecurityData(6,sSecurityData,sDestinationId,&nLength);
  PutSecurityData(5,sSecurityData,sDestResource,6);
  PutSecurityData(4,sSecurityData,sDestinationId,8);
  PutSecurityData(7,sSecurityData,sSourceResource,6);
  PutSecurityData(6,sSecurityData,sSourceId,8);
  trace_event("SwapDestAndSource ( End )",5);
  return extraout_EAX;
}



// WARNING: Unknown calling convention

int ReplyIsoMsg(TSIsoInfo *IsoInfo,char *Field38,char *Field39)

{
  size_t sVar1;
  int nLength;
  char sSecurityData [4096];
  
  GetIsoField(0x34,IsoInfo,sSecurityData,&nLength);
  SwapDestAndSource(sSecurityData);
  PutIsoField(0x34,IsoInfo,sSecurityData,nLength);
  if (*Field38 != '\0') {
    sVar1 = strlen(Field38);
    PutIsoField(0x25,IsoInfo,Field38,(int)sVar1);
  }
  if (*Field39 != '\0') {
    sVar1 = strlen(Field39);
    PutIsoField(0x26,IsoInfo,Field39,(int)sVar1);
  }
  return 0;
}



// WARNING: Unknown calling convention

int ReplyIsoMsgToBal(int nBal,TSIsoInfo *IsoInfo,char *Field38,char *Field39)

{
  int iVar1;
  long lVar2;
  char *pcVar3;
  byte bVar4;
  int nLength;
  char sDestinationPid [10];
  char sSecurityData [100];
  TSBalExchange sBalMsg;
  
  bVar4 = 0;
  trace_event("Start ReplyIsoMsgToBal()",5);
  pcVar3 = sSecurityData;
  for (lVar2 = 0xc; lVar2 != 0; lVar2 = lVar2 + -1) {
    pcVar3[0] = '\0';
    pcVar3[1] = '\0';
    pcVar3[2] = '\0';
    pcVar3[3] = '\0';
    pcVar3[4] = '\0';
    pcVar3[5] = '\0';
    pcVar3[6] = '\0';
    pcVar3[7] = '\0';
    pcVar3 = pcVar3 + (ulong)bVar4 * -0x10 + 8;
  }
  sDestinationPid[0] = '\0';
  sDestinationPid[1] = '\0';
  sDestinationPid[2] = '\0';
  sDestinationPid[3] = '\0';
  sDestinationPid[4] = '\0';
  sDestinationPid[5] = '\0';
  sDestinationPid[6] = '\0';
  sDestinationPid[7] = '\0';
  sDestinationPid[8] = '\0';
  sDestinationPid[9] = '\0';
  pcVar3[0] = '\0';
  pcVar3[1] = '\0';
  pcVar3[2] = '\0';
  pcVar3[3] = '\0';
  ReplyIsoMsg(IsoInfo,Field38,Field39);
  GetIsoField(0x34,IsoInfo,sSecurityData,&nLength);
  GetSecurityData(6,sSecurityData,sDestinationPid,&nLength);
  sBalMsg.sHeader.nPartnerId = atoi(sDestinationPid);
  iVar1 = IsoInfo->nMsgType;
  sBalMsg.sHeader.nSourceId = getpid();
  sBalMsg.sHeader.nCommand = iVar1;
  nLength = IsoBuildMsg(sBalMsg.sBody,IsoInfo);
  sBalMsg.sHeader.nLen = nLength;
  iVar1 = WriteBalMsg(nBal,&sBalMsg);
  if (iVar1 == 0) {
    trace_event("End ReplyIsoMsgToBal(OK)",5);
    iVar1 = 0;
  }
  else {
    iVar1 = -1;
    trace_event("Failed to send reply request",5);
    trace_event("End ReplyIsoMsgToBal(NOK)",5);
  }
  return iVar1;
}



// WARNING: Unknown calling convention

int SendStopIsoMessage(char *Resource,pid_t nPid)

{
  int iVar1;
  uint uVar2;
  uint uVar3;
  uint *puVar4;
  uint *puVar5;
  long lVar6;
  TSBalExchange *pTVar7;
  bool bVar8;
  byte bVar9;
  char sPid [9];
  char sPurgeTime [10];
  char date_gmt [12];
  char tmpField [256];
  char sLine [512];
  TSIsoInfo IsoInfo;
  TSBalExchange sBalMsg;
  TSTlvPrivate TlvInfo;
  
  bVar9 = 0;
  InitIsoInfo(&IsoInfo);
  IsoInfo.nMsgType = 0x646;
  sPurgeTime[8] = '\0';
  sPurgeTime[9] = '\0';
  sPurgeTime[0] = '\0';
  sPurgeTime[1] = '\0';
  sPurgeTime[2] = '\0';
  sPurgeTime[3] = '\0';
  sPurgeTime[4] = '\0';
  sPurgeTime[5] = '\0';
  sPurgeTime[6] = '\0';
  sPurgeTime[7] = '\0';
  date_gmt[0] = '\0';
  date_gmt[1] = '\0';
  date_gmt[2] = '\0';
  date_gmt[3] = '\0';
  date_gmt[4] = '\0';
  date_gmt[5] = '\0';
  date_gmt[6] = '\0';
  date_gmt[7] = '\0';
  date_gmt[8] = '\0';
  date_gmt[9] = '\0';
  date_gmt[10] = '\0';
  date_gmt[0xb] = '\0';
  current_gmt_date(date_gmt);
  AddIsoField(6,&IsoInfo,date_gmt + 2,10);
  AddIsoField(0x17,&IsoInfo,"600",3);
  AddIsoField(0x18,&IsoInfo,"6600",4);
  InitTlvPrivate(&TlvInfo);
  AddTlvPrivate("A09",&TlvInfo,"ADM",3);
  iVar1 = PrivateBuildTlv(tmpField,&TlvInfo);
  AddIsoField(0x2b,&IsoInfo,tmpField,iVar1);
  PutSecurityData(0,tmpField,"00",2);
  PutSecurityData(1,tmpField,"00",2);
  PutSecurityData(2,tmpField,"000",3);
  PutSecurityData(3,tmpField,"000",3);
  sPid[0] = '\0';
  sPid[1] = '\0';
  sPid[2] = '\0';
  sPid[3] = '\0';
  sPid[4] = '\0';
  sPid[5] = '\0';
  sPid[6] = '\0';
  sPid[7] = '\0';
  sPid[8] = '\0';
  uVar2 = getpid();
  sprintf(sPid,"%08d",(ulong)uVar2);
  PutSecurityData(4,tmpField,sPid,8);
  PutSecurityData(5,tmpField,"000000",6);
  sPid[0] = '\0';
  sPid[1] = '\0';
  sPid[2] = '\0';
  sPid[3] = '\0';
  sPid[4] = '\0';
  sPid[5] = '\0';
  sPid[6] = '\0';
  sPid[7] = '\0';
  sPid[8] = '\0';
  sprintf(sPid,"%08d",(ulong)(uint)nPid);
  PutSecurityData(6,tmpField,sPid,8);
  PutSecurityData(7,tmpField,Resource,6);
  PutSecurityData(8,tmpField,"000000000000000",0xf);
  builtin_strncpy(sPurgeTime,"00000000",8);
  sPurgeTime[8] = '0';
  PutSecurityData(9,tmpField,sPurgeTime,9);
  puVar5 = (uint *)tmpField;
  do {
    puVar4 = puVar5;
    uVar3 = *puVar4 + 0xfefefeff & ~*puVar4;
    uVar2 = uVar3 & 0x80808080;
    puVar5 = puVar4 + 1;
  } while (uVar2 == 0);
  bVar8 = (uVar3 & 0x8080) == 0;
  if (bVar8) {
    uVar2 = uVar2 >> 0x10;
  }
  if (bVar8) {
    puVar5 = (uint *)((long)puVar4 + 6);
  }
  AddIsoField(0x34,&IsoInfo,tmpField,
              (((int)puVar5 + -3) - (uint)CARRY1((byte)uVar2,(byte)uVar2)) - (int)tmpField);
  pTVar7 = &sBalMsg;
  for (lVar6 = 0x204; lVar6 != 0; lVar6 = lVar6 + -1) {
    (pTVar7->sHeader).sPartner[0] = '\0';
    (pTVar7->sHeader).sPartner[1] = '\0';
    (pTVar7->sHeader).sSource[0] = '\0';
    (pTVar7->sHeader).sSource[1] = '\0';
    (pTVar7->sHeader).nPartnerId = 0;
    pTVar7 = (TSBalExchange *)((long)pTVar7 + (ulong)bVar9 * -0x10 + 8);
  }
  sprintf(sLine,
          "\nsBalMsg.sHeader.nPartnerId => %d.\nsBalMsg.sHeader.nSourceId=> %d.\nsBalMsg.sHeader.nCommand=> %d\n"
          ,0,0,0);
  sBalMsg.sHeader.nPartnerId = nPid;
  sBalMsg.sHeader.nSourceId = getpid();
  sBalMsg.sHeader.nCommand = 0x646;
  sBalMsg.sHeader.nLen = IsoBuildMsg(sBalMsg.sBody,&IsoInfo);
  iVar1 = WriteBalMsg(nBalAdm,&sBalMsg);
  if (iVar1 != 0) {
    trace_event("Send Stop Message Failed",5);
    iVar1 = -1;
  }
  return iVar1;
}



// WARNING: Unknown calling convention

int SendSatusLineInfo(char *Resource,pid_t nPid,int nStatus)

{
  int iVar1;
  uint uVar2;
  uint uVar3;
  uint *puVar4;
  uint *puVar5;
  bool bVar6;
  char sPid [9];
  char sPurgeTime [10];
  char date_gmt [11];
  char tmpField [256];
  TSIsoInfo IsoInfo;
  TSBalExchange sBalMsg;
  TSTlvPrivate TlvInfo;
  
  InitIsoInfo(&IsoInfo);
  sPurgeTime[8] = '\0';
  sPurgeTime[9] = '\0';
  date_gmt[8] = '\0';
  date_gmt[9] = '\0';
  IsoInfo.nMsgType = 0x646;
  sPurgeTime[0] = '\0';
  sPurgeTime[1] = '\0';
  sPurgeTime[2] = '\0';
  sPurgeTime[3] = '\0';
  sPurgeTime[4] = '\0';
  sPurgeTime[5] = '\0';
  sPurgeTime[6] = '\0';
  sPurgeTime[7] = '\0';
  date_gmt[0] = '\0';
  date_gmt[1] = '\0';
  date_gmt[2] = '\0';
  date_gmt[3] = '\0';
  date_gmt[4] = '\0';
  date_gmt[5] = '\0';
  date_gmt[6] = '\0';
  date_gmt[7] = '\0';
  date_gmt[10] = '\0';
  current_gmt_date(date_gmt);
  AddIsoField(6,&IsoInfo,date_gmt + 2,10);
  if (nStatus == 0) {
    AddIsoField(0x17,&IsoInfo,"611",3);
  }
  else {
    AddIsoField(0x17,&IsoInfo,"610",3);
  }
  AddIsoField(0x18,&IsoInfo,"6600",4);
  InitTlvPrivate(&TlvInfo);
  AddTlvPrivate("A09",&TlvInfo,"ADM",3);
  iVar1 = PrivateBuildTlv(tmpField,&TlvInfo);
  AddIsoField(0x2f,&IsoInfo,tmpField,iVar1);
  PutSecurityData(0,tmpField,"00",2);
  PutSecurityData(1,tmpField,"00",2);
  PutSecurityData(2,tmpField,"000",3);
  PutSecurityData(3,tmpField,"000",3);
  sPid[0] = '\0';
  sPid[1] = '\0';
  sPid[2] = '\0';
  sPid[3] = '\0';
  sPid[4] = '\0';
  sPid[5] = '\0';
  sPid[6] = '\0';
  sPid[7] = '\0';
  sPid[8] = '\0';
  uVar2 = getpid();
  sprintf(sPid,"%08d",(ulong)uVar2);
  PutSecurityData(4,tmpField,sPid,8);
  PutSecurityData(5,tmpField,"000000",6);
  sPid[0] = '\0';
  sPid[1] = '\0';
  sPid[2] = '\0';
  sPid[3] = '\0';
  sPid[4] = '\0';
  sPid[5] = '\0';
  sPid[6] = '\0';
  sPid[7] = '\0';
  sPid[8] = '\0';
  sprintf(sPid,"%08d",(ulong)(uint)nPid);
  PutSecurityData(6,tmpField,sPid,8);
  PutSecurityData(7,tmpField,Resource,6);
  PutSecurityData(8,tmpField,"000000000000000",0xf);
  builtin_strncpy(sPurgeTime,"00000000",8);
  sPurgeTime[8] = '0';
  PutSecurityData(9,tmpField,sPurgeTime,9);
  puVar5 = (uint *)tmpField;
  do {
    puVar4 = puVar5;
    uVar3 = *puVar4 + 0xfefefeff & ~*puVar4;
    uVar2 = uVar3 & 0x80808080;
    puVar5 = puVar4 + 1;
  } while (uVar2 == 0);
  bVar6 = (uVar3 & 0x8080) == 0;
  if (bVar6) {
    uVar2 = uVar2 >> 0x10;
  }
  if (bVar6) {
    puVar5 = (uint *)((long)puVar4 + 6);
  }
  AddIsoField(0x34,&IsoInfo,tmpField,
              (((int)puVar5 + -3) - (uint)CARRY1((byte)uVar2,(byte)uVar2)) - (int)tmpField);
  sBalMsg.sHeader.nPartnerId = nPid;
  sBalMsg.sHeader.nSourceId = getpid();
  sBalMsg.sHeader.nCommand = 0x646;
  sBalMsg.sHeader.nLen = IsoBuildMsg(sBalMsg.sBody,&IsoInfo);
  iVar1 = WriteBalMsg(nBalAdm,&sBalMsg);
  if (iVar1 != 0) {
    trace_event("Send Status Line Info Message Failed",5);
    iVar1 = -1;
  }
  return iVar1;
}



// WARNING: Unknown calling convention

void tlvcpy(char *destination,char *source,int len)

{
  void *pvVar1;
  
  pvVar1 = memcpy(destination,source,(long)len);
  *(undefined1 *)((long)pvVar1 + (long)len) = 0;
  return;
}



// WARNING: Unknown calling convention

int InsertErrorMsg(TSIsoInfo *IsoInfo,char *sErrMsg,int nLen)

{
  int iVar1;
  long lVar2;
  char *pcVar3;
  byte bVar4;
  int nLenWork;
  char szWork [4096];
  TSTlvPrivate TlvInfo;
  
  bVar4 = 0;
  InitTlvPrivate(&TlvInfo);
  pcVar3 = szWork;
  for (lVar2 = 0x200; lVar2 != 0; lVar2 = lVar2 + -1) {
    pcVar3[0] = '\0';
    pcVar3[1] = '\0';
    pcVar3[2] = '\0';
    pcVar3[3] = '\0';
    pcVar3[4] = '\0';
    pcVar3[5] = '\0';
    pcVar3[6] = '\0';
    pcVar3[7] = '\0';
    pcVar3 = pcVar3 + (ulong)bVar4 * -0x10 + 8;
  }
  iVar1 = GetIsoField(0x2f,IsoInfo,szWork,&nLenWork);
  if (iVar1 == 0) {
    AnalyseTlvPrivate(szWork,nLenWork,&TlvInfo);
    PutTlvPrivate("P02",&TlvInfo,sErrMsg,nLen);
  }
  else {
    AddTlvPrivate("P02",&TlvInfo,sErrMsg,nLen);
  }
  pcVar3 = szWork;
  for (lVar2 = 0x200; lVar2 != 0; lVar2 = lVar2 + -1) {
    pcVar3[0] = '\0';
    pcVar3[1] = '\0';
    pcVar3[2] = '\0';
    pcVar3[3] = '\0';
    pcVar3[4] = '\0';
    pcVar3[5] = '\0';
    pcVar3[6] = '\0';
    pcVar3[7] = '\0';
    pcVar3 = pcVar3 + (ulong)bVar4 * -0x10 + 8;
  }
  nLenWork = PrivateBuildTlv(szWork,&TlvInfo);
  if (0 < nLenWork) {
    nLenWork = PutIsoField(0x2f,IsoInfo,szWork,nLenWork);
  }
  return nLenWork;
}



// WARNING: Unknown calling convention

int adjust_amount(int nIndexCtx,char *V_amount,char *V_currency)

{
  int iVar1;
  double dVar2;
  char T_currency [4];
  int exponent;
  int response_code;
  char L_amount [13];
  sqlca sqlca;
  sqlexd_conflict sqlstm;
  char ligne [512];
  
  sprintf(ligne,"Start adjust_amount(%.12s, %.3s)",V_amount,V_currency);
  trace_event(ligne,5);
  L_amount[0] = '\0';
  L_amount[1] = '\0';
  L_amount[2] = '\0';
  L_amount[3] = '\0';
  L_amount[4] = '\0';
  L_amount[5] = '\0';
  L_amount[6] = '\0';
  L_amount[7] = '\0';
  L_amount[8] = '\0';
  L_amount[9] = '\0';
  L_amount[10] = '\0';
  L_amount[0xb] = '\0';
  sqlstm.sqladtp = &sqladt;
  L_amount[0xc] = '\0';
  sqlstm.cud = sqlcud0;
  exponent = -3;
  sqlstm.sqlest = (uchar *)&sqlca;
  sqlstm.sqltdsp = &sqltds;
  sqlstm.sqtdso[0] = 0;
  sqlstm.sqlvsn = 0xc;
  sqlstm.arrsiz = 3;
  sqlstm.sqhstv[2] = (uchar *)&exponent;
  sqlstm.stmt = 
  "begin :response_code := PCRD_GET_PARAM_GENERAL_ROWS . GET_CURRENCY_EXPONENT ( :T_currency , :exponent ) ; END ;"
  ;
  sqlstm.iters = 1;
  T_currency[3] = '\0';
  T_currency._0_3_ = *(uint3 *)V_currency;
  sqlstm.sqadto[0] = 0;
  sqlstm.sqlety = 0x1100;
  sqlstm.sqhstv[0] = (uchar *)&response_code;
  sqlstm.offset = 5;
  sqlstm.occurs = 0;
  sqlstm.sqphsv = sqlstm.sqhstv;
  sqlstm.sqhstl[0] = 4;
  sqlstm.sqhsts[0] = 0;
  sqlstm.sqindv[0] = (short *)0x0;
  sqlstm.sqinds[0] = 0;
  sqlstm.sqharm[0] = 0;
  sqlstm.sqhstl[1] = 4;
  sqlstm.sqhsts[1] = 0;
  sqlstm.sqindv[1] = (short *)0x0;
  sqlstm.sqinds[1] = 0;
  sqlstm.sqharm[1] = 0;
  sqlstm.sqphsl = sqlstm.sqhstl;
  sqlstm.sqadto[1] = 0;
  sqlstm.sqtdso[1] = 0;
  sqlstm.sqphss = sqlstm.sqhsts;
  sqlstm.sqhstl[2] = 4;
  sqlstm.sqhsts[2] = 0;
  sqlstm.sqindv[2] = (short *)0x0;
  sqlstm.sqpind = sqlstm.sqindv;
  sqlstm.sqinds[2] = 0;
  sqlstm.sqharm[2] = 0;
  sqlstm.sqadto[2] = 0;
  sqlstm.sqpins = sqlstm.sqinds;
  sqlstm.sqtdso[2] = 0;
  sqlstm.sqparm = sqlstm.sqharm;
  sqlstm.sqparc = sqlstm.sqharc;
  sqlstm.sqpadto = sqlstm.sqadto;
  sqlstm.sqptdso = sqlstm.sqtdso;
  sqlstm.sqhstv[1] = (uchar *)T_currency;
  sqlcxt((long)nIndexCtx * 0x10 + 0x713948,&sqlctx,&sqlstm,&sqlfpn);
  if ((sqlca.sqlcode < 0) || (response_code < 0)) {
    strcpy(ligne,sqlca.sqlerrm.sqlerrmc);
    trace_event(ligne,1);
    trace_event("End   adjust_amount(MALFUNCTION)",5);
    iVar1 = -2;
  }
  else {
    if (exponent == 0) {
      exponent = 1;
    }
    else if (exponent == 1) {
      exponent = 10;
    }
    else if (exponent == 2) {
      exponent = 100;
    }
    else if (exponent == 3) {
      exponent = 1000;
    }
    L_amount[0xc] = DAT_0000000c;
    L_amount._0_8_ = *(undefined8 *)V_amount;
    L_amount._8_4_ = *(undefined4 *)(V_amount + 8);
    dVar2 = atof(L_amount);
    sprintf(L_amount,"%012.0f",dVar2 / (double)exponent);
    *(undefined8 *)V_amount = L_amount._0_8_;
    *(undefined4 *)(V_amount + 8) = L_amount._8_4_;
    sprintf(ligne,"End   adjust_amount(%.12s)",V_amount);
    trace_event(ligne,5);
    iVar1 = 0;
  }
  return iVar1;
}



// WARNING: Unknown calling convention

int adjust_amount_numeric(int nIndexCtx,double *V_amount,char *V_currency)

{
  int iVar1;
  double dVar2;
  char T_currency [4];
  int exponent;
  int response_code;
  sqlca sqlca;
  sqlexd_conflict sqlstm;
  char ligne [512];
  
  sprintf(ligne,"Start adjust_amount_numeric(%f, %.3s)",*V_amount);
  trace_event(ligne,5);
  sqlstm.sqhstv[2] = (uchar *)&exponent;
  sqlstm.sqladtp = &sqladt;
  sqlstm.cud = sqlcud0;
  sqlstm.sqadto[1] = 0;
  sqlstm.sqlest = (uchar *)&sqlca;
  sqlstm.sqltdsp = &sqltds;
  sqlstm.sqtdso[0] = 0;
  sqlstm.sqtdso[1] = 0;
  exponent = -3;
  sqlstm.stmt = 
  "begin :response_code := PCRD_GET_PARAM_GENERAL_ROWS . GET_CURRENCY_EXPONENT ( :T_currency , :exponent ) ; END ;"
  ;
  sqlstm.sqlvsn = 0xc;
  T_currency[3] = '\0';
  T_currency._0_3_ = *(uint3 *)V_currency;
  sqlstm.sqadto[0] = 0;
  sqlstm.sqlety = 0x1100;
  sqlstm.sqhstv[0] = (uchar *)&response_code;
  sqlstm.arrsiz = 3;
  sqlstm.iters = 1;
  sqlstm.offset = 0x20;
  sqlstm.occurs = 0;
  sqlstm.sqhstl[0] = 4;
  sqlstm.sqhsts[0] = 0;
  sqlstm.sqindv[0] = (short *)0x0;
  sqlstm.sqinds[0] = 0;
  sqlstm.sqharm[0] = 0;
  sqlstm.sqhstl[1] = 4;
  sqlstm.sqhsts[1] = 0;
  sqlstm.sqindv[1] = (short *)0x0;
  sqlstm.sqinds[1] = 0;
  sqlstm.sqharm[1] = 0;
  sqlstm.sqphsv = sqlstm.sqhstv;
  sqlstm.sqhstl[2] = 4;
  sqlstm.sqhsts[2] = 0;
  sqlstm.sqindv[2] = (short *)0x0;
  sqlstm.sqphsl = sqlstm.sqhstl;
  sqlstm.sqinds[2] = 0;
  sqlstm.sqharm[2] = 0;
  sqlstm.sqadto[2] = 0;
  sqlstm.sqphss = sqlstm.sqhsts;
  sqlstm.sqtdso[2] = 0;
  sqlstm.sqpind = sqlstm.sqindv;
  sqlstm.sqpins = sqlstm.sqinds;
  sqlstm.sqparm = sqlstm.sqharm;
  sqlstm.sqparc = sqlstm.sqharc;
  sqlstm.sqpadto = sqlstm.sqadto;
  sqlstm.sqptdso = sqlstm.sqtdso;
  sqlstm.sqhstv[1] = (uchar *)T_currency;
  sqlcxt((long)nIndexCtx * 0x10 + 0x713948,&sqlctx,&sqlstm,&sqlfpn);
  if (sqlca.sqlcode < 0) {
    strcpy(ligne,sqlca.sqlerrm.sqlerrmc);
    trace_event(ligne,1);
    trace_event("End   adjust_amount_numeric(MALFUNCTION)",5);
    iVar1 = -2;
  }
  else if (response_code < 0) {
    strcpy(ligne,sqlca.sqlerrm.sqlerrmc);
    trace_event(ligne,1);
    trace_event("End   adjust_amount(MALFUNCTION)",5);
    iVar1 = -2;
  }
  else {
    if (exponent == 0) {
      dVar2 = 1.0;
      exponent = 1;
    }
    else if (exponent == 1) {
      exponent = 10;
      dVar2 = 10.0;
    }
    else if (exponent == 2) {
      exponent = 100;
      dVar2 = 100.0;
    }
    else if (exponent == 3) {
      exponent = 1000;
      dVar2 = 1000.0;
    }
    else {
      dVar2 = (double)exponent;
    }
    *V_amount = *V_amount / dVar2;
    sprintf(ligne,"End   adjust_amount_numeric(%f)");
    trace_event(ligne,5);
    iVar1 = 0;
  }
  return iVar1;
}



// WARNING: Unknown calling convention

int amount_to_iso(int nIndexCtx,double *V_amount,char *V_currency)

{
  int iVar1;
  double dVar2;
  char T_currency [4];
  int exponent;
  int response_code;
  sqlca sqlca;
  sqlexd_conflict sqlstm;
  char ligne [512];
  
  sprintf(ligne,"Start amount_to_iso(%f, %.3s)",*V_amount);
  trace_event(ligne,5);
  sqlstm.sqhstv[2] = (uchar *)&exponent;
  sqlstm.sqladtp = &sqladt;
  sqlstm.cud = sqlcud0;
  sqlstm.sqadto[1] = 0;
  sqlstm.sqlest = (uchar *)&sqlca;
  sqlstm.sqltdsp = &sqltds;
  sqlstm.sqtdso[0] = 0;
  sqlstm.sqtdso[1] = 0;
  exponent = -3;
  sqlstm.stmt = 
  "begin :response_code := PCRD_GET_PARAM_GENERAL_ROWS . GET_CURRENCY_EXPONENT ( :T_currency , :exponent ) ; END ;"
  ;
  sqlstm.sqlvsn = 0xc;
  T_currency[3] = '\0';
  T_currency._0_3_ = *(uint3 *)V_currency;
  sqlstm.sqadto[0] = 0;
  sqlstm.sqlety = 0x1100;
  sqlstm.sqhstv[0] = (uchar *)&response_code;
  sqlstm.arrsiz = 3;
  sqlstm.iters = 1;
  sqlstm.offset = 0x3b;
  sqlstm.occurs = 0;
  sqlstm.sqhstl[0] = 4;
  sqlstm.sqhsts[0] = 0;
  sqlstm.sqindv[0] = (short *)0x0;
  sqlstm.sqinds[0] = 0;
  sqlstm.sqharm[0] = 0;
  sqlstm.sqhstl[1] = 4;
  sqlstm.sqhsts[1] = 0;
  sqlstm.sqindv[1] = (short *)0x0;
  sqlstm.sqinds[1] = 0;
  sqlstm.sqharm[1] = 0;
  sqlstm.sqphsv = sqlstm.sqhstv;
  sqlstm.sqhstl[2] = 4;
  sqlstm.sqhsts[2] = 0;
  sqlstm.sqindv[2] = (short *)0x0;
  sqlstm.sqphsl = sqlstm.sqhstl;
  sqlstm.sqinds[2] = 0;
  sqlstm.sqharm[2] = 0;
  sqlstm.sqadto[2] = 0;
  sqlstm.sqphss = sqlstm.sqhsts;
  sqlstm.sqtdso[2] = 0;
  sqlstm.sqpind = sqlstm.sqindv;
  sqlstm.sqpins = sqlstm.sqinds;
  sqlstm.sqparm = sqlstm.sqharm;
  sqlstm.sqparc = sqlstm.sqharc;
  sqlstm.sqpadto = sqlstm.sqadto;
  sqlstm.sqptdso = sqlstm.sqtdso;
  sqlstm.sqhstv[1] = (uchar *)T_currency;
  sqlcxt((long)nIndexCtx * 0x10 + 0x713948,&sqlctx,&sqlstm,&sqlfpn);
  if ((sqlca.sqlcode < 0) || (response_code < 0)) {
    strcpy(ligne,sqlca.sqlerrm.sqlerrmc);
    trace_event(ligne,1);
    trace_event("End   amount_to_iso(MALFUNCTION)",5);
    iVar1 = -2;
  }
  else {
    if (exponent == 0) {
      dVar2 = 1.0;
      exponent = 1;
    }
    else if (exponent == 1) {
      exponent = 10;
      dVar2 = 10.0;
    }
    else if (exponent == 2) {
      exponent = 100;
      dVar2 = 100.0;
    }
    else if (exponent == 3) {
      exponent = 1000;
      dVar2 = 1000.0;
    }
    else {
      dVar2 = (double)exponent;
    }
    *V_amount = dVar2 * *V_amount;
    sprintf(ligne,"End   amount_to_iso(%f)");
    trace_event(ligne,5);
    iVar1 = 0;
  }
  return iVar1;
}



// WARNING: Unknown calling convention

int adjust_amount_float(int nIndexCtx,char *V_amount,char *V_currency)

{
  int iVar1;
  size_t __n;
  double dVar2;
  char T_currency [4];
  int exponent;
  int response_code;
  char L_amount [23];
  sqlca sqlca;
  sqlexd_conflict sqlstm;
  char ligne [512];
  
  sprintf(ligne,"Start adjust_amount_float(%.15s, %.3s)",V_amount);
  trace_event(ligne,5);
  L_amount[0x14] = '\0';
  L_amount[0x15] = '\0';
  L_amount[0] = '\0';
  L_amount[1] = '\0';
  L_amount[2] = '\0';
  L_amount[3] = '\0';
  L_amount[4] = '\0';
  L_amount[5] = '\0';
  L_amount[6] = '\0';
  L_amount[7] = '\0';
  sqlstm.sqladtp = &sqladt;
  sqlstm.stmt = 
  "begin :response_code := PCRD_GET_PARAM_GENERAL_ROWS . GET_CURRENCY_EXPONENT ( :T_currency , :exponent ) ; END ;"
  ;
  sqlstm.sqlest = (uchar *)&sqlca;
  sqlstm.sqltdsp = &sqltds;
  sqlstm.sqlety = 0x1100;
  sqlstm.sqadto[0] = 0;
  sqlstm.sqhstv[2] = (uchar *)&exponent;
  sqlstm.cud = sqlcud0;
  sqlstm.sqtdso[0] = 0;
  T_currency[3] = '\0';
  T_currency._0_3_ = *(uint3 *)V_currency;
  sqlstm.sqhstv[0] = (uchar *)&response_code;
  L_amount[8] = '\0';
  L_amount[9] = '\0';
  L_amount[10] = '\0';
  L_amount[0xb] = '\0';
  L_amount[0xc] = '\0';
  L_amount[0xd] = '\0';
  L_amount[0xe] = '\0';
  L_amount[0xf] = '\0';
  L_amount[0x10] = '\0';
  L_amount[0x11] = '\0';
  L_amount[0x12] = '\0';
  L_amount[0x13] = '\0';
  L_amount[0x16] = '\0';
  sqlstm.sqphsv = sqlstm.sqhstv;
  exponent = -3;
  sqlstm.sqlvsn = 0xc;
  sqlstm.arrsiz = 3;
  sqlstm.iters = 1;
  sqlstm.offset = 0x56;
  sqlstm.occurs = 0;
  sqlstm.sqhstl[0] = 4;
  sqlstm.sqhsts[0] = 0;
  sqlstm.sqindv[0] = (short *)0x0;
  sqlstm.sqinds[0] = 0;
  sqlstm.sqharm[0] = 0;
  sqlstm.sqhstl[1] = 4;
  sqlstm.sqhsts[1] = 0;
  sqlstm.sqindv[1] = (short *)0x0;
  sqlstm.sqphsl = sqlstm.sqhstl;
  sqlstm.sqphss = sqlstm.sqhsts;
  sqlstm.sqtdso[2] = 0;
  sqlstm.sqinds[1] = 0;
  sqlstm.sqharm[1] = 0;
  sqlstm.sqpind = sqlstm.sqindv;
  sqlstm.sqadto[1] = 0;
  sqlstm.sqtdso[1] = 0;
  sqlstm.sqpins = sqlstm.sqinds;
  sqlstm.sqhstl[2] = 4;
  sqlstm.sqhsts[2] = 0;
  sqlstm.sqindv[2] = (short *)0x0;
  sqlstm.sqparm = sqlstm.sqharm;
  sqlstm.sqinds[2] = 0;
  sqlstm.sqharm[2] = 0;
  sqlstm.sqadto[2] = 0;
  sqlstm.sqparc = sqlstm.sqharc;
  sqlstm.sqpadto = sqlstm.sqadto;
  sqlstm.sqptdso = sqlstm.sqtdso;
  sqlstm.sqhstv[1] = (uchar *)T_currency;
  sqlcxt((long)nIndexCtx * 0x10 + 0x713948,&sqlctx,&sqlstm,&sqlfpn);
  if ((sqlca.sqlcode < 0) || (response_code < 0)) {
    strcpy(ligne,sqlca.sqlerrm.sqlerrmc);
    trace_event(ligne,1);
    trace_event("End   adjust_amount_float(MALFUNCTION)",5);
    iVar1 = -2;
  }
  else {
    if (exponent == 0) {
      exponent = 1;
    }
    else if (exponent == 1) {
      exponent = 10;
    }
    else if (exponent == 2) {
      exponent = 100;
    }
    else if (exponent == 3) {
      exponent = 1000;
    }
    L_amount[0] = '\0';
    L_amount[1] = '\0';
    L_amount[2] = '\0';
    L_amount[3] = '\0';
    L_amount[4] = '\0';
    L_amount[5] = '\0';
    L_amount[6] = '\0';
    L_amount[7] = '\0';
    L_amount[8] = '\0';
    L_amount[9] = '\0';
    L_amount[10] = '\0';
    L_amount[0xb] = '\0';
    L_amount[0xc] = '\0';
    L_amount[0xd] = '\0';
    L_amount[0xe] = '\0';
    L_amount[0xf] = '\0';
    L_amount[0x10] = '\0';
    L_amount[0x11] = '\0';
    L_amount[0x12] = '\0';
    L_amount[0x13] = '\0';
    L_amount[0x14] = '\0';
    L_amount[0x15] = '\0';
    L_amount[0x16] = '\0';
    __n = strlen(V_amount);
    memcpy(L_amount,V_amount,__n);
    sprintf(ligne,"End   adjust_amount_float(%s)",L_amount);
    trace_event(ligne,5);
    dVar2 = atof(L_amount);
    dVar2 = dVar2 / (double)exponent;
    if (exponent == 1) {
      sprintf(V_amount,"%.0f",dVar2);
    }
    else if (exponent == 10) {
      sprintf(V_amount,"%.1f",dVar2);
    }
    else if (exponent == 100) {
      sprintf(V_amount,"%.2f",dVar2);
    }
    else if (exponent == 1000) {
      sprintf(V_amount,"%.3f",dVar2);
    }
    sprintf(ligne,"End   adjust_amount_float(%.13s)",V_amount);
    trace_event(ligne,5);
    iVar1 = 0;
  }
  return iVar1;
}



// WARNING: Unknown calling convention

int ConnectOracleCmd(int indice,char *sUser,char *sPass)

{
  long lVar1;
  size_t sVar2;
  char *__src;
  anon_struct_22_2_43c7b5cf pUserName;
  anon_struct_22_2_43c7b5cf pPassWord;
  sqlca sqlca;
  sqlexd sqlstm;
  char sLine [512];
  
  strcpy((char *)pUserName.arr,sUser);
  sVar2 = strlen(sUser);
  pUserName.len = (ushort)sVar2;
  strcpy((char *)pPassWord.arr,sPass);
  sVar2 = strlen(sPass);
  pPassWord.len = (ushort)sVar2;
  sprintf(sLine,"Start ConnectOracleCmd(%s,%s) ",sUser,sPass);
  trace_event(sLine,5);
  sqlstm.sqladtp = &sqladt;
  sqlstm.sqlety = 0x1100;
  sqlstm.sqadto[0] = 0;
  sqlstm.sqltdsp = &sqltds;
  sqlstm.sqtdso[0] = 0;
  sqlstm.sqadto[1] = 0;
  sqlstm.sqtdso[1] = 0;
  sqlstm.cud = sqlcud0;
  sqlstm.sqphsv = sqlstm.sqhstv;
  sqlstm.sqlvsn = 0xc;
  sqlstm.arrsiz = 4;
  sqlstm.iters = 10;
  sqlstm.sqphsl = sqlstm.sqhstl;
  sqlstm.offset = 5;
  sqlstm.occurs = 0;
  sqlstm.sqphss = sqlstm.sqhsts;
  sqlstm.sqhstl[0] = 0x16;
  sqlstm.sqhsts[0] = 0x16;
  sqlstm.sqpind = sqlstm.sqindv;
  sqlstm.sqindv[0] = (short *)0x0;
  sqlstm.sqinds[0] = 0;
  sqlstm.sqharm[0] = 0;
  sqlstm.sqpins = sqlstm.sqinds;
  sqlstm.sqhstl[1] = 0x16;
  sqlstm.sqhsts[1] = 0x16;
  sqlstm.sqparm = sqlstm.sqharm;
  sqlstm.sqindv[1] = (short *)0x0;
  sqlstm.sqinds[1] = 0;
  sqlstm.sqharm[1] = 0;
  sqlstm.sqparc = sqlstm.sqharc;
  sqlstm.sqpadto = sqlstm.sqadto;
  sqlstm.sqptdso = sqlstm.sqtdso;
  sqlstm.sqlcmax = 100;
  sqlstm.sqlcmin = 2;
  sqlstm.sqlcincr = 1;
  sqlstm.sqlctimeout = 0;
  sqlstm.sqlcnowait = 0;
  lVar1 = (long)indice * 0x10 + 0x713948;
  sqlstm.sqlest = (uchar *)&sqlca;
  sqlstm.sqhstv[0] = (uchar *)&pUserName;
  sqlstm.sqhstv[1] = (uchar *)&pPassWord;
  sqlcxt(lVar1,&sqlctx,&sqlstm,&sqlfpn);
  if (-1 < sqlca.sqlcode) {
    sqlstm.sqlety = 0x1100;
    sqlstm.sqladtp = &sqladt;
    sqlstm.sqlvsn = 0xc;
    sqlstm.arrsiz = 4;
    sqlstm.sqltdsp = &sqltds;
    sqlstm.iters = 1;
    sqlstm.offset = 0x24;
    sqlstm.stmt = "alter SESSION SET NLS_DATE_FORMAT = \'DD/MM/YY HH24:MI:SS\'";
    sqlstm.occurs = 0;
    sqlstm.cud = sqlcud0;
    sqlstm.sqlest = (uchar *)&sqlca;
    sqlcxt(lVar1,&sqlctx,&sqlstm,&sqlfpn);
    if (-1 < sqlca.sqlcode) {
      trace_event("End ConnectOracleCmd()",5);
      return 0;
    }
  }
  __src = sqlca.sqlerrm.sqlerrmc;
  fwrite("End   ConnectOracleCmd(NOK) \n",1,0x1d,stderr);
  fprintf(stderr,"%s \n",__src);
  strcpy(sLine,__src);
  trace_event(sLine,5);
  builtin_strncpy(sLine,"End ConnectOracleCmd(NOK) ",0x1b);
  trace_event(sLine,5);
  return -1;
}



// WARNING: Unknown calling convention

int ConnectOracle(int indice)

{
  char *pcVar1;
  long lVar2;
  uchar *puVar3;
  byte bVar4;
  char mode [2];
  uchar pass [9];
  anon_struct_22_2_43c7b5cf username;
  anon_struct_22_2_43c7b5cf password;
  char user [24];
  uchar pass_encrypt [65];
  uchar pass_plain [65];
  sqlca sqlca;
  char sLine [512];
  
  bVar4 = 0;
  trace_event("Start ConnectOracle()",5);
  puVar3 = pass_encrypt;
  for (lVar2 = 8; lVar2 != 0; lVar2 = lVar2 + -1) {
    puVar3[0] = '\0';
    puVar3[1] = '\0';
    puVar3[2] = '\0';
    puVar3[3] = '\0';
    puVar3[4] = '\0';
    puVar3[5] = '\0';
    puVar3[6] = '\0';
    puVar3[7] = '\0';
    puVar3 = puVar3 + (ulong)bVar4 * -0x10 + 8;
  }
  user[0] = '\0';
  user[1] = '\0';
  user[2] = '\0';
  user[3] = '\0';
  user[4] = '\0';
  user[5] = '\0';
  user[6] = '\0';
  user[7] = '\0';
  user[8] = '\0';
  user[9] = '\0';
  user[10] = '\0';
  user[0xb] = '\0';
  user[0xc] = '\0';
  user[0xd] = '\0';
  user[0xe] = '\0';
  user[0xf] = '\0';
  mode[0] = '\0';
  mode[1] = '\0';
  user[0x10] = '\0';
  user[0x11] = '\0';
  user[0x12] = '\0';
  user[0x13] = '\0';
  user[0x14] = '\0';
  user[0x15] = '\0';
  user[0x16] = '\0';
  user[0x17] = '\0';
  pass[0] = '\0';
  pass[1] = '\0';
  pass[2] = '\0';
  pass[3] = '\0';
  pass[4] = '\0';
  pass[5] = '\0';
  pass[6] = '\0';
  pass[7] = '\0';
  pass[8] = '\0';
  *puVar3 = '\0';
  pcVar1 = getenv("DB_MODE");
  strcpy(mode,pcVar1);
  if (mode[0] == '0') {
    pcVar1 = getenv("DB_USER_PROD");
    strcpy(user,pcVar1);
    pcVar1 = getenv("DB_PASSWORD_PROD");
    strcpy((char *)pass_encrypt,pcVar1);
  }
  else {
    pcVar1 = getenv("DB_USER_TEST");
    strcpy(user,pcVar1);
    pcVar1 = getenv("DB_PASSWORD_TEST");
    strcpy((char *)pass_encrypt,pcVar1);
  }
  pthread_mutex_lock((pthread_mutex_t *)&ConnectMutex);
  DES(-1,'H',pass_encrypt,(uchar *)"A1002B0607C1806F",pass_plain);
  compress(pass,pass_plain);
  pthread_mutex_unlock((pthread_mutex_t *)&ConnectMutex);
  pcVar1 = stpcpy((char *)username.arr,user);
  username.len = (short)pcVar1 - (short)username.arr;
  pcVar1 = stpcpy((char *)password.arr,(char *)pass);
  password.len = (short)pcVar1 - (short)password.arr;
  sLine._56_8_ = &sqladt;
  sLine[0x178] = '\0';
  sLine[0x179] = '\0';
  sLine._64_8_ = &sqltds;
  sLine[0x16] = '\0';
  sLine[0x17] = '\x11';
  sLine[0x170] = '\0';
  sLine[0x171] = '\0';
  sLine[0x172] = '\0';
  sLine[0x173] = '\0';
  sLine._32_8_ = sqlcud0;
  sLine._72_8_ = sLine + 0xb0;
  sLine[0x17a] = '\0';
  sLine[0x17b] = '\0';
  sLine[0] = '\f';
  sLine[1] = '\0';
  sLine[2] = '\0';
  sLine[3] = '\0';
  sLine[4] = '\0';
  sLine[5] = '\0';
  sLine[6] = '\0';
  sLine[7] = '\0';
  sLine[8] = '\x04';
  sLine[9] = '\0';
  sLine[10] = '\0';
  sLine[0xb] = '\0';
  sLine._80_8_ = sLine + 0xd0;
  sLine[0xc] = '\n';
  sLine[0xd] = '\0';
  sLine[0xe] = '\0';
  sLine[0xf] = '\0';
  sLine[0x10] = '3';
  sLine[0x11] = '\0';
  sLine[0x12] = '\0';
  sLine[0x13] = '\0';
  sLine._88_8_ = sLine + 0xf0;
  sLine[0x18] = '\0';
  sLine[0x19] = '\0';
  sLine[0x1a] = '\0';
  sLine[0x1b] = '\0';
  sLine[0xd0] = '\x16';
  sLine[0xd1] = '\0';
  sLine[0xd2] = '\0';
  sLine[0xd3] = '\0';
  sLine[0xd4] = '\0';
  sLine[0xd5] = '\0';
  sLine[0xd6] = '\0';
  sLine[0xd7] = '\0';
  sLine._96_8_ = sLine + 0x100;
  sLine[0xf0] = '\x16';
  sLine[0xf1] = '\0';
  sLine[0xf2] = '\0';
  sLine[0xf3] = '\0';
  sLine[0x100] = '\0';
  sLine[0x101] = '\0';
  sLine[0x102] = '\0';
  sLine[0x103] = '\0';
  sLine[0x104] = '\0';
  sLine[0x105] = '\0';
  sLine[0x106] = '\0';
  sLine[0x107] = '\0';
  sLine[0x120] = '\0';
  sLine[0x121] = '\0';
  sLine[0x122] = '\0';
  sLine[0x123] = '\0';
  sLine._104_8_ = sLine + 0x120;
  sLine[0x130] = '\0';
  sLine[0x131] = '\0';
  sLine[0x132] = '\0';
  sLine[0x133] = '\0';
  sLine[0x134] = '\0';
  sLine[0x135] = '\0';
  sLine[0x136] = '\0';
  sLine[0x137] = '\0';
  sLine[0xd8] = '\x16';
  sLine[0xd9] = '\0';
  sLine[0xda] = '\0';
  sLine[0xdb] = '\0';
  sLine[0xdc] = '\0';
  sLine[0xdd] = '\0';
  sLine[0xde] = '\0';
  sLine[0xdf] = '\0';
  sLine[0xf4] = '\x16';
  sLine[0xf5] = '\0';
  sLine[0xf6] = '\0';
  sLine[0xf7] = '\0';
  sLine._112_8_ = sLine + 0x130;
  sLine[0x108] = '\0';
  sLine[0x109] = '\0';
  sLine[0x10a] = '\0';
  sLine[0x10b] = '\0';
  sLine[0x10c] = '\0';
  sLine[0x10d] = '\0';
  sLine[0x10e] = '\0';
  sLine[0x10f] = '\0';
  sLine[0x124] = '\0';
  sLine[0x125] = '\0';
  sLine[0x126] = '\0';
  sLine[0x127] = '\0';
  sLine[0x138] = '\0';
  sLine[0x139] = '\0';
  sLine[0x13a] = '\0';
  sLine[0x13b] = '\0';
  sLine[0x13c] = '\0';
  sLine[0x13d] = '\0';
  sLine[0x13e] = '\0';
  sLine[0x13f] = '\0';
  sLine._120_8_ = sLine + 0x150;
  sLine._128_8_ = sLine + 0x170;
  sLine[0x90] = 'd';
  sLine[0x91] = '\0';
  sLine[0x92] = '\0';
  sLine[0x93] = '\0';
  sLine[0x94] = '\x02';
  sLine[0x95] = '\0';
  sLine[0x96] = '\0';
  sLine[0x97] = '\0';
  sLine._136_8_ = sLine + 0x178;
  sLine[0x98] = '\x01';
  sLine[0x99] = '\0';
  sLine[0x9a] = '\0';
  sLine[0x9b] = '\0';
  sLine[0x9c] = '\0';
  sLine[0x9d] = '\0';
  sLine[0x9e] = '\0';
  sLine[0x9f] = '\0';
  sLine[0xa0] = '\0';
  sLine[0xa1] = '\0';
  sLine[0xa2] = '\0';
  sLine[0xa3] = '\0';
  lVar2 = (long)indice * 0x10 + 0x713948;
  sLine._40_8_ = &sqlca;
  sLine._176_8_ = &username;
  sLine._184_8_ = &password;
  sqlcxt(lVar2,&sqlctx,sLine,&sqlfpn);
  if (-1 < sqlca.sqlcode) {
    sLine[0] = '\f';
    sLine[1] = '\0';
    sLine[2] = '\0';
    sLine[3] = '\0';
    sLine[4] = '\0';
    sLine[5] = '\0';
    sLine[6] = '\0';
    sLine[7] = '\0';
    sLine._56_8_ = &sqladt;
    sLine[8] = '\x04';
    sLine[9] = '\0';
    sLine[10] = '\0';
    sLine[0xb] = '\0';
    sLine[0xc] = '\x01';
    sLine[0xd] = '\0';
    sLine[0xe] = '\0';
    sLine[0xf] = '\0';
    sLine[0x10] = 'R';
    sLine[0x11] = '\0';
    sLine[0x12] = '\0';
    sLine[0x13] = '\0';
    sLine._64_8_ = &sqltds;
    sLine[0x18] = '\0';
    sLine[0x19] = '\0';
    sLine[0x1a] = '\0';
    sLine[0x1b] = '\0';
    sLine._48_8_ = s_alter_SESSION_SET_NLS_DATE_FORMA_004abe78;
    sLine._32_8_ = sqlcud0;
    sLine[0x16] = '\0';
    sLine[0x17] = '\x11';
    sLine._40_8_ = &sqlca;
    sqlcxt(lVar2,&sqlctx,sLine,&sqlfpn);
    if (-1 < sqlca.sqlcode) {
      trace_event("End   ConnectOracle(OK)",5);
      return 0;
    }
  }
  strcpy(sLine,sqlca.sqlerrm.sqlerrmc);
  fprintf(stderr,"%s\n",sLine);
  trace_event(sLine,0);
  trace_event("End   ConnectOracle(NOK)",5);
  return -1;
}



// WARNING: Unknown calling convention

void DeconnectOracle(int indice)

{
  sqlca sqlca;
  sqlexd sqlstm;
  
  trace_event("Start DeconnectOracle()",5);
  sqlstm.sqladtp = &sqladt;
  sqlstm.sqlvsn = 0xc;
  sqlstm.arrsiz = 4;
  sqlstm.sqltdsp = &sqltds;
  sqlstm.iters = 1;
  sqlstm.offset = 0x61;
  sqlstm.cud = sqlcud0;
  sqlstm.occurs = 0;
  sqlstm.sqlety = 0x1100;
  sqlstm.sqlest = (uchar *)&sqlca;
  sqlcxt((long)indice * 0x10 + 0x713948,&sqlctx,&sqlstm,&sqlfpn);
  trace_event("End   DeconnectOracle(VOID)",5);
  return;
}



// WARNING: Unknown calling convention

void CommitOracle(int indice)

{
  sqlexd sqlstm;
  
  trace_event("Start CommitOracle()",5);
  sqlstm.sqladtp = &sqladt;
  sqlstm.sqlvsn = 0xc;
  sqlstm.arrsiz = 4;
  sqlstm.sqltdsp = &sqltds;
  sqlstm.iters = 1;
  sqlstm.offset = 0x70;
  sqlstm.occurs = 0;
  sqlstm.cud = sqlcud0;
  sqlstm.sqlest = (uchar *)&sqlca;
  sqlstm.sqlety = 0x1100;
  sqlcxt((long)indice * 0x10 + 0x713948,&sqlctx,&sqlstm,&sqlfpn);
  trace_event("End   CommitOracle(VOID)",5);
  return;
}



// WARNING: Unknown calling convention

void RollBackOracle(int indice)

{
  sqlexd sqlstm;
  
  trace_event("Start RollBackOracle()",5);
  sqlstm.sqladtp = &sqladt;
  sqlstm.sqlvsn = 0xc;
  sqlstm.arrsiz = 4;
  sqlstm.sqltdsp = &sqltds;
  sqlstm.iters = 1;
  sqlstm.offset = 0x7f;
  sqlstm.occurs = 0;
  sqlstm.cud = sqlcud0;
  sqlstm.sqlest = (uchar *)&sqlca;
  sqlstm.sqlety = 0x1100;
  sqlcxt((long)indice * 0x10 + 0x713948,&sqlctx,&sqlstm,&sqlfpn);
  trace_event("End   RollBackOracle(OK)",5);
  return;
}



// WARNING: Unknown calling convention

void EnableThreads(int indice)

{
  sqlexd sqlstm;
  
  sqlstm.sqladtp = &sqladt;
  sqlstm.sqlvsn = 0xc;
  sqlstm.arrsiz = 4;
  sqlstm.iters = 1;
  sqlstm.sqltdsp = &sqltds;
  sqlstm.offset = 0x8e;
  sqlstm.occurs = 0;
  sqlstm.stmt = "";
  sqlstm.cud = sqlcud0;
  sqlstm.sqlest = (uchar *)&sqlca;
  sqlstm.sqlety = 0x1100;
  sqlcxt(0,&sqlctx,&sqlstm,&sqlfpn);
  return;
}



// WARNING: Unknown calling convention

void AllocateOracleCtx(int indice)

{
  sqlexd sqlstm;
  
  sqlstm.sqladtp = &sqladt;
  sqlstm.sqtdso[0] = 0;
  sqlstm.sqltdsp = &sqltds;
  sqlstm.sqadto[0] = 0;
  sqlstm.sqhstv[0] = (uchar *)&tab_ParamCtx[indice].ctx;
  sqlstm.sqlvsn = 0xc;
  sqlstm.stmt = "";
  sqlstm.arrsiz = 4;
  sqlstm.iters = 1;
  sqlstm.cud = sqlcud0;
  sqlstm.offset = 0x9d;
  sqlstm.occurs = 0;
  sqlstm.sqhstl[0] = 8;
  sqlstm.sqhsts[0] = 0;
  sqlstm.sqlest = (uchar *)&sqlca;
  sqlstm.sqindv[0] = (short *)0x0;
  sqlstm.sqlety = 0x1100;
  sqlstm.sqphsv = sqlstm.sqhstv;
  sqlstm.sqinds[0] = 0;
  sqlstm.sqharm[0] = 0;
  sqlstm.sqphsl = sqlstm.sqhstl;
  sqlstm.sqphss = sqlstm.sqhsts;
  sqlstm.sqpind = sqlstm.sqindv;
  sqlstm.sqpins = sqlstm.sqinds;
  sqlstm.sqparm = sqlstm.sqharm;
  sqlstm.sqparc = sqlstm.sqharc;
  sqlstm.sqpadto = sqlstm.sqadto;
  sqlstm.sqptdso = sqlstm.sqtdso;
  sqlcxt(0,&sqlctx,&sqlstm,&sqlfpn);
  return;
}



// WARNING: Unknown calling convention

void FreeOracleCtx(int indice)

{
  sqlexd sqlstm;
  
  trace_event("Start FreeOracleCtx()",5);
  sqlstm.sqtdso[0] = 0;
  sqlstm.sqladtp = &sqladt;
  sqlstm.sqadto[0] = 0;
  sqlstm.sqltdsp = &sqltds;
  sqlstm.sqhstv[0] = (uchar *)&tab_ParamCtx[indice].ctx;
  sqlstm.sqlvsn = 0xc;
  sqlstm.arrsiz = 4;
  sqlstm.stmt = "";
  sqlstm.iters = 1;
  sqlstm.offset = 0xb0;
  sqlstm.cud = sqlcud0;
  sqlstm.occurs = 0;
  sqlstm.sqhstl[0] = 8;
  sqlstm.sqhsts[0] = 0;
  sqlstm.sqindv[0] = (short *)0x0;
  sqlstm.sqlest = (uchar *)&sqlca;
  sqlstm.sqinds[0] = 0;
  sqlstm.sqlety = 0x1100;
  sqlstm.sqphsv = sqlstm.sqhstv;
  sqlstm.sqharm[0] = 0;
  sqlstm.sqphsl = sqlstm.sqhstl;
  sqlstm.sqphss = sqlstm.sqhsts;
  sqlstm.sqpind = sqlstm.sqindv;
  sqlstm.sqpins = sqlstm.sqinds;
  sqlstm.sqparm = sqlstm.sqharm;
  sqlstm.sqparc = sqlstm.sqharc;
  sqlstm.sqpadto = sqlstm.sqadto;
  sqlstm.sqptdso = sqlstm.sqtdso;
  sqlcxt(0,&sqlctx,&sqlstm,&sqlfpn);
  trace_event("End   FreeOracleCtx()",5);
  return;
}



// WARNING: Unknown calling convention

int ConnectOracleCmd2(int indice,char *sUser,char *sPass,FILE *fp)

{
  long lVar1;
  size_t sVar2;
  anon_struct_22_2_43c7b5cf pUserName;
  anon_struct_22_2_43c7b5cf pPassWord;
  sqlca sqlca;
  sqlexd sqlstm;
  char sLine [512];
  
  strcpy((char *)pUserName.arr,sUser);
  sVar2 = strlen(sUser);
  pUserName.len = (ushort)sVar2;
  strcpy((char *)pPassWord.arr,sPass);
  sVar2 = strlen(sPass);
  pPassWord.len = (ushort)sVar2;
  sprintf(sLine,"Start ConnectOracleCmd2(%s,%s) ",sUser,sPass);
  fprintf((FILE *)fp,sLine);
  sqlstm.sqladtp = &sqladt;
  sqlstm.sqlety = 0x1100;
  sqlstm.sqadto[0] = 0;
  sqlstm.sqltdsp = &sqltds;
  sqlstm.sqtdso[0] = 0;
  sqlstm.sqadto[1] = 0;
  sqlstm.sqtdso[1] = 0;
  sqlstm.cud = sqlcud0;
  sqlstm.sqphsv = sqlstm.sqhstv;
  sqlstm.sqlvsn = 0xc;
  sqlstm.arrsiz = 4;
  sqlstm.iters = 10;
  sqlstm.sqphsl = sqlstm.sqhstl;
  sqlstm.offset = 0xc3;
  sqlstm.occurs = 0;
  sqlstm.sqphss = sqlstm.sqhsts;
  sqlstm.sqhstl[0] = 0x16;
  sqlstm.sqhsts[0] = 0x16;
  sqlstm.sqpind = sqlstm.sqindv;
  sqlstm.sqindv[0] = (short *)0x0;
  sqlstm.sqinds[0] = 0;
  sqlstm.sqharm[0] = 0;
  sqlstm.sqpins = sqlstm.sqinds;
  sqlstm.sqhstl[1] = 0x16;
  sqlstm.sqhsts[1] = 0x16;
  sqlstm.sqparm = sqlstm.sqharm;
  sqlstm.sqindv[1] = (short *)0x0;
  sqlstm.sqinds[1] = 0;
  sqlstm.sqharm[1] = 0;
  sqlstm.sqparc = sqlstm.sqharc;
  sqlstm.sqpadto = sqlstm.sqadto;
  sqlstm.sqptdso = sqlstm.sqtdso;
  sqlstm.sqlcmax = 100;
  sqlstm.sqlcmin = 2;
  sqlstm.sqlcincr = 1;
  sqlstm.sqlctimeout = 0;
  sqlstm.sqlcnowait = 0;
  lVar1 = (long)indice * 0x10 + 0x713948;
  sqlstm.sqlest = (uchar *)&sqlca;
  sqlstm.sqhstv[0] = (uchar *)&pUserName;
  sqlstm.sqhstv[1] = (uchar *)&pPassWord;
  sqlcxt(lVar1,&sqlctx,&sqlstm,&sqlfpn);
  if (-1 < sqlca.sqlcode) {
    sqlstm.sqlvsn = 0xc;
    sqlstm.sqladtp = &sqladt;
    sqlstm.arrsiz = 4;
    sqlstm.iters = 1;
    sqlstm.offset = 0xe2;
    sqlstm.sqltdsp = &sqltds;
    sqlstm.occurs = 0;
    sqlstm.stmt = "alter SESSION SET NLS_DATE_FORMAT = \'DD/MM/YY HH24:MI:SS\'";
    sqlstm.cud = sqlcud0;
    sqlstm.sqlety = 0x1100;
    sqlstm.sqlest = (uchar *)&sqlca;
    sqlcxt(lVar1,&sqlctx,&sqlstm,&sqlfpn);
    if (-1 < sqlca.sqlcode) {
      fwrite("End   ConnectOracleCmd2(OK) \n",1,0x1d,(FILE *)fp);
      return 0;
    }
  }
  fwrite("End   ConnectOracleCmd2(NOK) \n",1,0x1e,(FILE *)fp);
  fprintf((FILE *)fp,"%s \n",sqlca.sqlerrm.sqlerrmc);
  return -1;
}



// WARNING: Unknown calling convention

int RefreshDBConnection(int nIndiceCtx)

{
  int iVar1;
  char T_dummy [12];
  sqlca sqlca;
  char szDetail [512];
  
  szDetail._176_8_ = T_dummy;
  szDetail._56_8_ = &sqladt;
  szDetail[0x178] = '\0';
  szDetail[0x179] = '\0';
  szDetail._40_8_ = &sqlca;
  szDetail._64_8_ = &sqltds;
  szDetail[0x170] = '\0';
  szDetail[0x171] = '\0';
  szDetail[0] = '\f';
  szDetail[1] = '\0';
  szDetail[2] = '\0';
  szDetail[3] = '\0';
  szDetail[4] = '\0';
  szDetail[5] = '\0';
  szDetail[6] = '\0';
  szDetail[7] = '\0';
  szDetail[8] = '\x04';
  szDetail[9] = '\0';
  szDetail[10] = '\0';
  szDetail[0xb] = '\0';
  szDetail._48_8_ = s_begin_SELECT__1__INTO__T_dummy_F_004abef8;
  szDetail[0xc] = '\x01';
  szDetail[0xd] = '\0';
  szDetail[0xe] = '\0';
  szDetail[0xf] = '\0';
  szDetail[0x10] = -0xf;
  szDetail[0x11] = '\0';
  szDetail[0x12] = '\0';
  szDetail[0x13] = '\0';
  szDetail._32_8_ = sqlcud0;
  szDetail[0x18] = '\0';
  szDetail[0x19] = '\0';
  szDetail[0x1a] = '\0';
  szDetail[0x1b] = '\0';
  szDetail[0x16] = '\0';
  szDetail[0x17] = '\x11';
  szDetail._72_8_ = szDetail + 0xb0;
  szDetail[0xd0] = '\f';
  szDetail[0xd1] = '\0';
  szDetail[0xd2] = '\0';
  szDetail[0xd3] = '\0';
  szDetail[0xd4] = '\0';
  szDetail[0xd5] = '\0';
  szDetail[0xd6] = '\0';
  szDetail[0xd7] = '\0';
  szDetail[0xf0] = '\0';
  szDetail[0xf1] = '\0';
  szDetail[0xf2] = '\0';
  szDetail[0xf3] = '\0';
  szDetail._80_8_ = szDetail + 0xd0;
  szDetail[0x100] = '\0';
  szDetail[0x101] = '\0';
  szDetail[0x102] = '\0';
  szDetail[0x103] = '\0';
  szDetail[0x104] = '\0';
  szDetail[0x105] = '\0';
  szDetail[0x106] = '\0';
  szDetail[0x107] = '\0';
  szDetail[0x120] = '\0';
  szDetail[0x121] = '\0';
  szDetail[0x122] = '\0';
  szDetail[0x123] = '\0';
  szDetail[0x130] = '\0';
  szDetail[0x131] = '\0';
  szDetail[0x132] = '\0';
  szDetail[0x133] = '\0';
  szDetail[0x134] = '\0';
  szDetail[0x135] = '\0';
  szDetail[0x136] = '\0';
  szDetail[0x137] = '\0';
  szDetail._88_8_ = szDetail + 0xf0;
  szDetail._96_8_ = szDetail + 0x100;
  szDetail._104_8_ = szDetail + 0x120;
  szDetail._112_8_ = szDetail + 0x130;
  szDetail._120_8_ = szDetail + 0x150;
  szDetail._128_8_ = szDetail + 0x170;
  szDetail._136_8_ = szDetail + 0x178;
  sqlcxt((long)nIndiceCtx * 0x10 + 0x713948,&sqlctx,szDetail,&sqlfpn);
  if (sqlca.sqlcode < 0) {
    trace_event("End RefreshDBConnection(MALFUNCTION) ",1);
    sprintf(szDetail,">>> Error on[%d]: %s",nIndiceCtx,sqlca.sqlerrm.sqlerrmc);
    trace_event(szDetail,1);
    iVar1 = -2;
  }
  else {
    iVar1 = 0;
  }
  return iVar1;
}



// WARNING: Unknown calling convention

void DeconnectOracleParamCtx(TSParamCtx *ParamCtx)

{
  sqlca sqlca;
  sqlexd sqlstm;
  
  trace_event("Start DeconnectOracleParamCtx()",5);
  sqlstm.sqlvsn = 0xc;
  sqlstm.sqladtp = &sqladt;
  sqlstm.arrsiz = 4;
  sqlstm.iters = 1;
  sqlstm.offset = 0x104;
  sqlstm.sqltdsp = &sqltds;
  sqlstm.occurs = 0;
  sqlstm.cud = sqlcud0;
  sqlstm.sqlety = 0x1100;
  sqlstm.sqlest = (uchar *)&sqlca;
  sqlcxt(&ParamCtx->ctx,&sqlctx,&sqlstm,&sqlfpn);
  trace_event("End   DeconnectOracleParamCtx(VOID)",5);
  return;
}



// WARNING: Unknown calling convention

void FreeOracleParamCtx(TSParamCtx *ParamCtx)

{
  sqlexd sqlstm;
  
  trace_event("Start FreeOracleParamCtx()",5);
  sqlstm.sqtdso[0] = 0;
  sqlstm.sqladtp = &sqladt;
  sqlstm.sqadto[0] = 0;
  sqlstm.sqltdsp = &sqltds;
  sqlstm.sqlvsn = 0xc;
  sqlstm.arrsiz = 4;
  sqlstm.iters = 1;
  sqlstm.stmt = "";
  sqlstm.offset = 0x113;
  sqlstm.occurs = 0;
  sqlstm.sqhstl[0] = 8;
  sqlstm.cud = sqlcud0;
  sqlstm.sqhsts[0] = 0;
  sqlstm.sqindv[0] = (short *)0x0;
  sqlstm.sqinds[0] = 0;
  sqlstm.sqharm[0] = 0;
  sqlstm.sqlest = (uchar *)&sqlca;
  sqlstm.sqlety = 0x1100;
  sqlstm.sqphsv = sqlstm.sqhstv;
  sqlstm.sqphsl = sqlstm.sqhstl;
  sqlstm.sqphss = sqlstm.sqhsts;
  sqlstm.sqpind = sqlstm.sqindv;
  sqlstm.sqpins = sqlstm.sqinds;
  sqlstm.sqparm = sqlstm.sqharm;
  sqlstm.sqparc = sqlstm.sqharc;
  sqlstm.sqpadto = sqlstm.sqadto;
  sqlstm.sqptdso = sqlstm.sqtdso;
  sqlstm.sqhstv[0] = (uchar *)&ParamCtx->ctx;
  sqlcxt(0,&sqlctx,&sqlstm,&sqlfpn);
  trace_event("End   FreeOracleParamCtx()",5);
  return;
}



// WARNING: Unknown calling convention

int signal_blocking(int signal)

{
  int iVar1;
  sigset_t *mask;
  
  trace_event("Start signal_blocking()",5);
  sigemptyset((sigset_t *)0x0);
  sigaddset((sigset_t *)0x0,signal);
  iVar1 = pthread_sigmask(0,(__sigset_t *)0x0,(__sigset_t *)0x0);
  if (iVar1 < 0) {
    trace_event("End   signal_blocking(NOK)",5);
    iVar1 = -1;
  }
  else {
    trace_event("End   signal_blocking(OK)",5);
    iVar1 = 0;
  }
  return iVar1;
}



// WARNING: Unknown calling convention

int signal_unblocking(int signal)

{
  int iVar1;
  sigset_t *mask;
  
  trace_event("Start signal_unblocking()",5);
  sigemptyset((sigset_t *)&mask);
  sigaddset((sigset_t *)&mask,signal);
  iVar1 = pthread_sigmask(1,(__sigset_t *)&mask,(__sigset_t *)0x0);
  if (iVar1 < 0) {
    trace_event("End   signal_unblocking(NOK)",5);
    iVar1 = -1;
  }
  else {
    trace_event("End   signal_unblocking(OK)",5);
    iVar1 = 0;
  }
  return iVar1;
}



// WARNING: Unknown calling convention

int install_handler(int signal,_func_void_int *processing)

{
  int iVar1;
  sigaction mask;
  
  trace_event("Start install_handler()",5);
  mask.__sigaction_handler = (anon_union_8_2_5ad2d23e_for___sigaction_handler)processing;
  sigemptyset((sigset_t *)&mask.sa_mask);
  mask.sa_flags = 4;
  iVar1 = sigaction(signal,(sigaction *)&mask,(sigaction *)0x0);
  if (iVar1 < 0) {
    trace_event("End   install_handler(NOK)",5);
    iVar1 = -1;
  }
  else {
    trace_event("End   install_handler(OK)",5);
    iVar1 = 0;
  }
  return iVar1;
}



// WARNING: Unknown calling convention

int desinstall_handler(int signal)

{
  int iVar1;
  sigaction mask;
  
  trace_event("Start desinstall_handler()",5);
  mask.__sigaction_handler.sa_handler = (__sighandler_t)0x0;
  sigemptyset((sigset_t *)&mask.sa_mask);
  mask.sa_flags = 0;
  iVar1 = sigaction(signal,(sigaction *)&mask,(sigaction *)0x0);
  if (iVar1 < 0) {
    trace_event("End   desinstall_hanlder(NOK)",5);
    iVar1 = -1;
  }
  else {
    trace_event("End   desinstall_handler(OK)",5);
    iVar1 = 0;
  }
  return iVar1;
}



// WARNING: Unknown calling convention

int ignore_signal(int signal)

{
  int iVar1;
  sigaction mask;
  
  trace_event("Start ignore_signal()",5);
  mask.__sigaction_handler = (anon_union_8_2_5ad2d23e_for___sigaction_handler)0x1;
  sigemptyset((sigset_t *)&mask.sa_mask);
  mask.sa_flags = 0;
  iVar1 = sigaction(signal,(sigaction *)&mask,(sigaction *)0x0);
  if (iVar1 < 0) {
    trace_event("End   ignore_signal(NOK)",5);
    iVar1 = -1;
  }
  else {
    trace_event("End   ignore_signal(OK)",5);
    iVar1 = 0;
  }
  return iVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

void InitDumpParam(void)

{
  long lVar1;
  char *pcVar2;
  
  pcVar2 = trace_file;
  for (lVar1 = 8; lVar1 != 0; lVar1 = lVar1 + -1) {
    pcVar2[0] = '\0';
    pcVar2[1] = '\0';
    pcVar2[2] = '\0';
    pcVar2[3] = '\0';
    pcVar2[4] = '\0';
    pcVar2[5] = '\0';
    pcVar2[6] = '\0';
    pcVar2[7] = '\0';
    pcVar2 = pcVar2 + 8;
  }
  trace_level = 6;
  return;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address
// WARNING: Unknown calling convention

int init_trace(void)

{
  uint uVar1;
  uint uVar2;
  int iVar3;
  ulong uVar4;
  char *pcVar5;
  uint *puVar6;
  long lVar7;
  uint *puVar8;
  bool bVar9;
  byte bVar10;
  char cpt_char [4];
  char fichier_trace_etendu [64];
  stat buf_stat;
  char label [256];
  
  bVar10 = 0;
  pcVar5 = label;
  for (lVar7 = 0x20; puVar6 = (uint *)trace_file, lVar7 != 0; lVar7 = lVar7 + -1) {
    pcVar5[0] = '\0';
    pcVar5[1] = '\0';
    pcVar5[2] = '\0';
    pcVar5[3] = '\0';
    pcVar5[4] = '\0';
    pcVar5[5] = '\0';
    pcVar5[6] = '\0';
    pcVar5[7] = '\0';
    pcVar5 = pcVar5 + 8;
  }
  do {
    puVar8 = puVar6;
    uVar1 = *puVar8 + 0xfefefeff & ~*puVar8;
    uVar2 = uVar1 & 0x80808080;
    puVar6 = puVar8 + 1;
  } while (uVar2 == 0);
  bVar9 = (uVar1 & 0x8080) == 0;
  if (bVar9) {
    uVar2 = uVar2 >> 0x10;
  }
  if (bVar9) {
    puVar6 = (uint *)((long)puVar8 + 6);
  }
  cpt_char[3] = '\0';
  cpt_char._0_3_ = *(uint3 *)((long)puVar6 + (-6 - (ulong)CARRY1((byte)uVar2,(byte)uVar2)));
  uVar4 = strtol(cpt_char,(char **)0x0,10);
  uVar4 = uVar4 & 0xffffffff;
  while( true ) {
    puVar6 = (uint *)fichier_trace_etendu;
    for (lVar7 = 8; lVar7 != 0; lVar7 = lVar7 + -1) {
      puVar6[0] = 0;
      puVar6[1] = 0;
      puVar6 = puVar6 + (ulong)bVar10 * -4 + 2;
    }
    pcVar5 = getenv("TRACE");
    sprintf(fichier_trace_etendu,"%s/%s",pcVar5,trace_file);
    puVar6 = (uint *)fichier_trace_etendu;
    do {
      puVar8 = puVar6;
      uVar1 = *puVar8 + 0xfefefeff & ~*puVar8;
      uVar2 = uVar1 & 0x80808080;
      puVar6 = puVar8 + 1;
    } while (uVar2 == 0);
    bVar9 = (uVar1 & 0x8080) == 0;
    if (bVar9) {
      uVar2 = uVar2 >> 0x10;
    }
    if (bVar9) {
      puVar6 = (uint *)((long)puVar8 + 6);
    }
    sprintf((char *)((long)puVar6 + (-6 - (ulong)CARRY1((byte)uVar2,(byte)uVar2))),"%03d",uVar4);
    iVar3 = __xstat(1,fichier_trace_etendu,(stat *)&buf_stat);
    if ((iVar3 < 0) || (buf_stat.st_size < max_size << 10)) break;
    uVar4 = (ulong)((int)uVar4 + 1);
  }
  fd_trace = open(fichier_trace_etendu,0x442,0x1a0);
  puVar6 = (uint *)trace_file;
  if (fd_trace < 0) {
    fprintf(_stdout,"FICHIER : %s\n",fichier_trace_etendu);
    puVar6 = (uint *)__errno_location();
    fprintf(_stdout,"ERRNO :%d\n",(ulong)*puVar6);
    fprintf(stderr,"%s\n",label);
    iVar3 = -1;
  }
  else {
    do {
      puVar8 = puVar6;
      uVar1 = *puVar8 + 0xfefefeff & ~*puVar8;
      uVar2 = uVar1 & 0x80808080;
      puVar6 = puVar8 + 1;
    } while (uVar2 == 0);
    bVar9 = (uVar1 & 0x8080) == 0;
    if (bVar9) {
      uVar2 = uVar2 >> 0x10;
    }
    if (bVar9) {
      puVar6 = (uint *)((long)puVar8 + 6);
    }
    sprintf((char *)((long)puVar6 + (-6 - (ulong)CARRY1((byte)uVar2,(byte)uVar2))),"%03d",uVar4);
    iVar3 = 0;
  }
  return iVar3;
}



// WARNING: Unknown calling convention

void trace_event(char *mess,int level)

{
  int iVar1;
  __pid_t _Var2;
  __pid_t _Var3;
  long lVar4;
  char *pcVar5;
  byte bVar6;
  char jj_c [3];
  char mm_c [3];
  char Mls [4];
  char date_heure_jour [5];
  char Mls_tmp [7];
  time_t lg;
  char date [15];
  timeval tp;
  tm date_r;
  char ligne [513];
  
  bVar6 = 0;
  date[0] = '\0';
  date[1] = '\0';
  date[2] = '\0';
  date[3] = '\0';
  date[4] = '\0';
  date[5] = '\0';
  date[6] = '\0';
  date[7] = '\0';
  date[8] = '\0';
  date[9] = '\0';
  date[10] = '\0';
  date[0xb] = '\0';
  date[0xc] = '\0';
  date[0xd] = '\0';
  date[0xe] = '\0';
  Mls[0] = '\0';
  Mls[1] = '\0';
  Mls[2] = '\0';
  Mls[3] = '\0';
  Mls_tmp[0] = '\0';
  Mls_tmp[1] = '\0';
  Mls_tmp[2] = '\0';
  Mls_tmp[3] = '\0';
  pcVar5 = ligne;
  for (lVar4 = 0x40; lVar4 != 0; lVar4 = lVar4 + -1) {
    pcVar5[0] = '\0';
    pcVar5[1] = '\0';
    pcVar5[2] = '\0';
    pcVar5[3] = '\0';
    pcVar5[4] = '\0';
    pcVar5[5] = '\0';
    pcVar5[6] = '\0';
    pcVar5[7] = '\0';
    pcVar5 = pcVar5 + 8;
  }
  Mls_tmp[6] = '\0';
  Mls_tmp[4] = '\0';
  Mls_tmp[5] = '\0';
  date_heure_jour[0] = '\0';
  date_heure_jour[1] = '\0';
  date_heure_jour[2] = '\0';
  date_heure_jour[3] = '\0';
  date_heure_jour[4] = '\0';
  mm_c[0] = '\0';
  mm_c[1] = '\0';
  mm_c[2] = '\0';
  jj_c[2] = '\0';
  *pcVar5 = '\0';
  jj_c[0] = '\0';
  jj_c[1] = '\0';
  if (level <= trace_level) {
    pthread_mutex_lock((pthread_mutex_t *)&trace_mutex);
    if (0 < fd_trace) {
      iVar1 = check_trace_size(fd_trace,max_size);
      if (iVar1 != 0) {
        close(fd_trace);
        init_trace();
      }
    }
    pthread_mutex_unlock((pthread_mutex_t *)&trace_mutex);
    lVar4 = 0x12;
    pcVar5 = ligne;
    while (lVar4 != 0) {
      lVar4 = lVar4 + -1;
      builtin_strncpy(pcVar5,"        ",8);
      pcVar5 = pcVar5 + (ulong)bVar6 * -0x10 + 8;
    }
    builtin_strncpy(pcVar5,"       ",7);
    time(&lg);
    localtime_r(&lg,(tm *)&date_r);
    sprintf(jj_c,"%02d",(ulong)(uint)date_r.tm_mday);
    sprintf(mm_c,"%02d",(ulong)(date_r.tm_mon + 1));
    date_heure_jour[2] = mm_c[0];
    date_heure_jour[3] = mm_c[1];
    date_heure_jour[0] = jj_c[0];
    date_heure_jour[1] = jj_c[1];
    current_date(date);
    current_hour(date + 8);
    gettimeofday((timeval *)&tp,(__timezone_ptr_t)0x0);
    sprintf(Mls_tmp,"%06d",tp.tv_usec);
    Mls._0_3_ = (undefined3)Mls_tmp._0_4_;
    lVar4 = syscall(0xba);
    _Var2 = getpid();
    _Var3 = getppid();
    sprintf(ligne,"%.4s %.2s%.2s%.2s%.3s %05d %08d %.05ld|%d|   ",date_heure_jour,date + 8,date + 10
            ,date + 0xc,Mls,_Var3,_Var2,lVar4,level);
    sprintf(ligne + 0x26,"%.93s",mess);
    pcVar5 = ligne;
    do {
      while( true ) {
        iVar1 = isprint((int)*pcVar5);
        if (iVar1 != 0) break;
        *pcVar5 = ' ';
        pcVar5 = pcVar5 + 1;
        ligne[0x82] = '.';
        if (pcVar5 == ligne + 0x84) goto LAB_004380ea;
      }
      pcVar5 = pcVar5 + 1;
    } while (pcVar5 != ligne + 0x84);
LAB_004380ea:
    ligne[0x83] = '\n';
    pthread_mutex_lock((pthread_mutex_t *)&trace_mutex);
    write(fd_trace,ligne,0x84);
    pthread_mutex_unlock((pthread_mutex_t *)&trace_mutex);
  }
  return;
}



// WARNING: Unknown calling convention

int check_trace_size(int fd_trace,int max_size)

{
  int iVar1;
  char *pcVar2;
  uint *puVar3;
  long lVar4;
  byte bVar5;
  char fichier_trace_etendu [64];
  stat buf_stat;
  char sLine [512];
  
  bVar5 = 0;
  pcVar2 = fichier_trace_etendu;
  for (lVar4 = 8; lVar4 != 0; lVar4 = lVar4 + -1) {
    *(undefined8 *)pcVar2 = 0;
    pcVar2 = (char *)((long)pcVar2 + 8);
  }
  pcVar2 = getenv("TRACE");
  sprintf(fichier_trace_etendu,"%s/%s",pcVar2,trace_file);
  iVar1 = __xstat(1,fichier_trace_etendu,(stat *)&buf_stat);
  pcVar2 = sLine;
  for (lVar4 = 0x40; lVar4 != 0; lVar4 = lVar4 + -1) {
    pcVar2[0] = '\0';
    pcVar2[1] = '\0';
    pcVar2[2] = '\0';
    pcVar2[3] = '\0';
    pcVar2[4] = '\0';
    pcVar2[5] = '\0';
    pcVar2[6] = '\0';
    pcVar2[7] = '\0';
    pcVar2 = pcVar2 + (ulong)bVar5 * -0x10 + 8;
  }
  if (iVar1 < 0) {
    puVar3 = (uint *)__errno_location();
    fprintf(stderr,"Errno stat file, errno : %d,file:[%s]\n",(ulong)*puVar3,fichier_trace_etendu);
    iVar1 = -1;
  }
  else {
    if (max_size < 0x1001) {
      lVar4 = (long)(max_size << 10);
    }
    else {
      lVar4 = 0x400000;
      sprintf(sLine,"Max size  HHA ===> ...%d ",(ulong)(uint)max_size);
      trace_event(sLine,5);
    }
    iVar1 = -(uint)(lVar4 <= buf_stat.st_size);
  }
  return iVar1;
}



// WARNING: Unknown calling convention

int WriteEntete(char *sEntete)

{
  __pid_t _Var1;
  __pid_t _Var2;
  long lVar3;
  char jj_c [3];
  char mm_c [3];
  char Mls [4];
  char date_heure_jour [5];
  char Mls_tmp [7];
  time_t lg;
  char date [15];
  timeval tp;
  tm date_r;
  
  Mls_tmp[4] = '\0';
  Mls_tmp[5] = '\0';
  date[0xc] = '\0';
  date[0xd] = '\0';
  Mls[0] = '\0';
  Mls[1] = '\0';
  Mls[2] = '\0';
  Mls[3] = '\0';
  Mls_tmp[0] = '\0';
  Mls_tmp[1] = '\0';
  Mls_tmp[2] = '\0';
  Mls_tmp[3] = '\0';
  Mls_tmp[6] = '\0';
  date[0] = '\0';
  date[1] = '\0';
  date[2] = '\0';
  date[3] = '\0';
  date[4] = '\0';
  date[5] = '\0';
  date[6] = '\0';
  date[7] = '\0';
  date[8] = '\0';
  date[9] = '\0';
  date[10] = '\0';
  date[0xb] = '\0';
  date[0xe] = '\0';
  current_date(date);
  current_hour(date + 8);
  gettimeofday((timeval *)&tp,(__timezone_ptr_t)0x0);
  sprintf(Mls_tmp,"%06d",tp.tv_usec);
  jj_c[0] = '\0';
  jj_c[1] = '\0';
  mm_c[0] = '\0';
  mm_c[1] = '\0';
  jj_c[2] = '\0';
  mm_c[2] = '\0';
  date_heure_jour[0] = '\0';
  date_heure_jour[1] = '\0';
  date_heure_jour[2] = '\0';
  date_heure_jour[3] = '\0';
  date_heure_jour[4] = '\0';
  Mls._0_3_ = (undefined3)Mls_tmp._0_4_;
  time(&lg);
  localtime_r(&lg,(tm *)&date_r);
  sprintf(jj_c,"%02d",(ulong)(uint)date_r.tm_mday);
  sprintf(mm_c,"%02d",(ulong)(date_r.tm_mon + 1));
  date_heure_jour[2] = mm_c[0];
  date_heure_jour[3] = mm_c[1];
  date_heure_jour[0] = jj_c[0];
  date_heure_jour[1] = jj_c[1];
  lVar3 = syscall(0xba);
  _Var1 = getpid();
  _Var2 = getppid();
  sprintf(sEntete,"%.4s %.2s%.2s%.2s%.3s %05d %08d %.05ld|D|   ",date_heure_jour,date + 8,date + 10,
          date + 0xc,Mls,_Var2,_Var1,lVar3);
  return 0x26;
}



// WARNING: Restarted to delay deadcode elimination for space: stack
// WARNING: Unknown calling convention

void dump_buffer(uchar *Buffer,int SizeBuffer,char Set,char origine,char sens)

{
  int iVar1;
  int iVar2;
  byte *pbVar3;
  long lVar4;
  char *pcVar5;
  long lVar6;
  uchar *sDst;
  uchar *puVar7;
  char *pcVar8;
  int iVar9;
  int iVar10;
  int iVar11;
  long lVar12;
  byte bVar13;
  int local_89b8;
  size_t local_89a0;
  char date [15];
  char entete_ligne [60];
  char sLine [256];
  char sWork [4096];
  char ligne [30720];
  
  bVar13 = 0;
  trace_event("Start dump_buffer()",0);
  if (debug_option == 1) {
    if (0x1000 < SizeBuffer) {
      return;
    }
    sDst = (uchar *)sWork;
    date[0xc] = '\0';
    date[0xd] = '\0';
    date[0] = '\0';
    date[1] = '\0';
    date[2] = '\0';
    date[3] = '\0';
    date[4] = '\0';
    date[5] = '\0';
    date[6] = '\0';
    date[7] = '\0';
    puVar7 = sDst;
    for (lVar6 = 0x200; lVar6 != 0; lVar6 = lVar6 + -1) {
      puVar7[0] = '\0';
      puVar7[1] = '\0';
      puVar7[2] = '\0';
      puVar7[3] = '\0';
      puVar7[4] = '\0';
      puVar7[5] = '\0';
      puVar7[6] = '\0';
      puVar7[7] = '\0';
      puVar7 = puVar7 + (ulong)bVar13 * -0x10 + 8;
    }
    date[8] = '\0';
    date[9] = '\0';
    date[10] = '\0';
    date[0xb] = '\0';
    date[0xe] = '\0';
    current_date(date);
    current_hour(date + 8);
    pcVar8 = entete_ligne;
    for (lVar6 = 7; lVar6 != 0; lVar6 = lVar6 + -1) {
      pcVar8[0] = '\0';
      pcVar8[1] = '\0';
      pcVar8[2] = '\0';
      pcVar8[3] = '\0';
      pcVar8[4] = '\0';
      pcVar8[5] = '\0';
      pcVar8[6] = '\0';
      pcVar8[7] = '\0';
      pcVar8 = pcVar8 + (ulong)bVar13 * -0x10 + 8;
    }
    pcVar8[0] = '\0';
    pcVar8[1] = '\0';
    pcVar8[2] = '\0';
    pcVar8[3] = '\0';
    builtin_strncpy(entete_ligne,"                                                           ",0x3b)
    ;
    iVar1 = WriteEntete(entete_ligne);
    memset(ligne,0,0x7800);
    pcVar8 = sLine;
    for (lVar6 = 0x20; lVar6 != 0; lVar6 = lVar6 + -1) {
      pcVar8[0] = '\0';
      pcVar8[1] = '\0';
      pcVar8[2] = '\0';
      pcVar8[3] = '\0';
      pcVar8[4] = '\0';
      pcVar8[5] = '\0';
      pcVar8[6] = '\0';
      pcVar8[7] = '\0';
      pcVar8 = pcVar8 + (ulong)bVar13 * -0x10 + 8;
    }
    memset(ligne,0x20,0x77ff);
    lVar6 = 0x1f;
    pcVar8 = sLine;
    while (lVar6 != 0) {
      lVar6 = lVar6 + -1;
      builtin_strncpy(pcVar8,"        ",8);
      pcVar8 = pcVar8 + (ulong)bVar13 * -0x10 + 8;
    }
    builtin_strncpy(pcVar8,"       ",7);
    iVar11 = iVar1 + 0x26;
    if (Set == 'E') {
      EbcdicToAscii(Buffer,sDst,SizeBuffer);
    }
    else {
      memcpy(sDst,Buffer,(long)SizeBuffer);
    }
    if (SizeBuffer < 1) {
      local_89b8 = 0x23;
      lVar6 = 0x82;
      lVar12 = 0;
      iVar10 = 0x82;
      pcVar8 = ligne;
      iVar9 = iVar1;
    }
    else {
      local_89b8 = 0;
      pbVar3 = Buffer + (SizeBuffer - 1);
      iVar10 = 0;
      iVar9 = iVar1;
      while( true ) {
        lVar6 = (long)iVar11;
        iVar11 = iVar11 + 3;
        sprintf(ligne + lVar6,"%02X ",(ulong)*Buffer);
        iVar2 = isprint((int)(char)*sDst);
        if (iVar2 == 0) {
          ligne[iVar9] = '.';
        }
        else {
          ligne[iVar9] = *sDst;
        }
        iVar10 = iVar10 + 1;
        ligne[(long)iVar9 + 1] = ' ';
        if (Buffer == pbVar3) break;
        iVar9 = iVar9 + 2;
        if (iVar10 == (iVar10 / 0x12) * 0x12) {
          iVar9 = local_89b8 * 0x84;
          lVar12 = (long)iVar9;
          lVar6 = lVar12 + iVar1;
          pcVar8 = ligne + lVar6 + 0x5e;
          (ligne + lVar6 + 0x62)[0] = ' ';
          (ligne + lVar6 + 0x62)[1] = ' ';
          pcVar8[0] = ' ';
          pcVar8[1] = ' ';
          pcVar8[2] = ' ';
          pcVar8[3] = ' ';
          memcpy(ligne + lVar12,entete_ligne,(long)iVar1);
          local_89b8 = local_89b8 + 1;
          iVar9 = iVar1 + 0x84 + iVar9;
          (ligne + lVar6 + 0x24)[0] = ' ';
          (ligne + lVar6 + 0x24)[1] = '|';
          (ligne + lVar12 + 0x82)[0] = '.';
          (ligne + lVar12 + 0x82)[1] = '\n';
          iVar11 = iVar9 + 0x26;
        }
        Buffer = Buffer + 1;
        sDst = sDst + 1;
      }
      local_89b8 = local_89b8 * 0x84;
      lVar12 = (long)local_89b8;
      iVar10 = local_89b8 + 0x82;
      local_89b8 = local_89b8 + 0x23;
      lVar6 = lVar12 + 0x82;
      pcVar8 = ligne + lVar12;
      iVar9 = iVar9 + 2;
    }
    local_89a0 = (size_t)iVar1;
    lVar4 = 0;
    iVar1 = iVar9;
    while (iVar1 <= local_89b8) {
      ligne[lVar4 + iVar9] = ' ';
      lVar4 = lVar4 + 1;
      iVar1 = iVar9 + (int)lVar4;
    }
    pcVar5 = ligne + iVar11;
    for (; iVar11 <= iVar10; iVar11 = iVar11 + 1) {
      *pcVar5 = ' ';
      pcVar5 = pcVar5 + 1;
    }
    ligne[iVar11 + 1] = '\n';
    memcpy(pcVar8,entete_ligne,local_89a0);
    pcVar8 = ligne + lVar12 + local_89a0 + 0x24;
    pcVar8[0] = ' ';
    pcVar8[1] = '|';
    pcVar8 = ligne + lVar6;
    pcVar8[0] = '.';
    pcVar8[1] = '\n';
    memcpy(sLine,entete_ligne,local_89a0);
    pcVar8 = sLine + local_89a0 + 0x24;
    pcVar8[0] = ' ';
    pcVar8[1] = '|';
    pcVar5 = sLine + local_89a0 + 0x26;
    sLine[0x82] = '.';
    sLine[0x83] = '\n';
    pthread_mutex_lock((pthread_mutex_t *)&trace_mutex);
    pcVar8 = sLine + local_89a0 + 0x36;
    pcVar8[0] = ' ';
    pcVar8[1] = ' ';
    pcVar8[2] = ' ';
    pcVar8[3] = ' ';
    pcVar5[0] = 'S';
    pcVar5[1] = 'T';
    pcVar5[2] = 'A';
    pcVar5[3] = 'R';
    pcVar5[4] = 'T';
    pcVar5[5] = ' ';
    pcVar5[6] = ' ';
    pcVar5[7] = ' ';
    pcVar8 = sLine + local_89a0 + 0x2e;
    pcVar8[0] = ' ';
    pcVar8[1] = ' ';
    pcVar8[2] = ' ';
    pcVar8[3] = ' ';
    pcVar8[4] = ' ';
    pcVar8[5] = ' ';
    pcVar8[6] = ' ';
    pcVar8[7] = ' ';
    write(fd_trace,sLine,0x84);
    if (origine == 'B') {
      builtin_strncpy(sLine + local_89a0 + 0x26,"QUEUE               ",0x14);
    }
    else if (origine == 'L') {
      builtin_strncpy(sLine + local_89a0 + 0x26,"NETWORK             ",0x14);
    }
    write(fd_trace,sLine,0x84);
    if (sens == 'I') {
      builtin_strncpy(sLine + local_89a0 + 0x26,"INCOMING            ",0x14);
    }
    else if (sens == 'O') {
      builtin_strncpy(sLine + local_89a0 + 0x26,"OUTGOING            ",0x14);
    }
    write(fd_trace,sLine,0x84);
    pcVar8 = sLine + local_89a0 + 0x36;
    pcVar8[0] = ' ';
    pcVar8[1] = ' ';
    pcVar8[2] = ' ';
    pcVar8[3] = ' ';
    pcVar5[0] = 'T';
    pcVar5[1] = 'I';
    pcVar5[2] = 'M';
    pcVar5[3] = 'E';
    pcVar5[4] = 'S';
    pcVar5[5] = 'T';
    pcVar5[6] = 'A';
    pcVar5[7] = 'M';
    pcVar8 = sLine + local_89a0 + 0x2e;
    pcVar8[0] = 'P';
    iVar1 = fd_trace;
    pcVar8[1] = ' ';
    pcVar8[2] = ' ';
    pcVar8[3] = ' ';
    pcVar8[4] = ' ';
    pcVar8[5] = ' ';
    pcVar8[6] = ' ';
    pcVar8[7] = ' ';
    *(undefined4 *)(sLine + local_89a0 + 0x3a) = date._0_4_;
    *(undefined4 *)(sLine + local_89a0 + 0x3e) = date._8_4_;
    *(undefined2 *)(sLine + local_89a0 + 0x42) = date._12_2_;
    write(iVar1,sLine,0x84);
    write(fd_trace,ligne,(long)(iVar11 + 1));
    iVar1 = fd_trace;
    pcVar8 = sLine + local_89a0 + 0x36;
    pcVar8[0] = ' ';
    pcVar8[1] = ' ';
    pcVar8[2] = ' ';
    pcVar8[3] = ' ';
    pcVar5[0] = 'E';
    pcVar5[1] = 'N';
    pcVar5[2] = 'D';
    pcVar5[3] = ' ';
    pcVar5[4] = ' ';
    pcVar5[5] = ' ';
    pcVar5[6] = ' ';
    pcVar5[7] = ' ';
    pcVar8 = sLine + local_89a0 + 0x2e;
    pcVar8[0] = ' ';
    pcVar8[1] = ' ';
    pcVar8[2] = ' ';
    pcVar8[3] = ' ';
    pcVar8[4] = ' ';
    pcVar8[5] = ' ';
    pcVar8[6] = ' ';
    pcVar8[7] = ' ';
    write(iVar1,sLine,0x84);
    pthread_mutex_unlock((pthread_mutex_t *)&trace_mutex);
  }
  trace_event("End   dump_buffer(VOID)",0);
  return;
}



// WARNING: Restarted to delay deadcode elimination for space: stack
// WARNING: Unknown calling convention

void dump_buffer_debug(uchar *Buffer,int SizeBuffer,char Set,char origine,char sens)

{
  int iVar1;
  int iVar2;
  long lVar3;
  char *pcVar4;
  long lVar5;
  uchar *sDst;
  uchar *puVar6;
  char *pcVar7;
  int iVar8;
  int iVar9;
  int iVar10;
  long lVar11;
  byte bVar12;
  int local_89b0;
  size_t local_89a8;
  char date [15];
  char entete_ligne [60];
  char sLine [256];
  char sWork [4096];
  char ligne [30720];
  
  bVar12 = 0;
  trace_event("Start dump_buffer_debug()",0);
  if (SizeBuffer < 0x1001) {
    sDst = (uchar *)sWork;
    date[0] = '\0';
    date[1] = '\0';
    date[2] = '\0';
    date[3] = '\0';
    date[4] = '\0';
    date[5] = '\0';
    date[6] = '\0';
    date[7] = '\0';
    date[0xc] = '\0';
    date[0xd] = '\0';
    date[8] = '\0';
    date[9] = '\0';
    date[10] = '\0';
    date[0xb] = '\0';
    puVar6 = sDst;
    for (lVar5 = 0x200; lVar5 != 0; lVar5 = lVar5 + -1) {
      puVar6[0] = '\0';
      puVar6[1] = '\0';
      puVar6[2] = '\0';
      puVar6[3] = '\0';
      puVar6[4] = '\0';
      puVar6[5] = '\0';
      puVar6[6] = '\0';
      puVar6[7] = '\0';
      puVar6 = puVar6 + (ulong)bVar12 * -0x10 + 8;
    }
    date[0xe] = '\0';
    current_date(date);
    current_hour(date + 8);
    pcVar7 = entete_ligne;
    for (lVar5 = 7; lVar5 != 0; lVar5 = lVar5 + -1) {
      pcVar7[0] = '\0';
      pcVar7[1] = '\0';
      pcVar7[2] = '\0';
      pcVar7[3] = '\0';
      pcVar7[4] = '\0';
      pcVar7[5] = '\0';
      pcVar7[6] = '\0';
      pcVar7[7] = '\0';
      pcVar7 = pcVar7 + (ulong)bVar12 * -0x10 + 8;
    }
    pcVar7[0] = '\0';
    pcVar7[1] = '\0';
    pcVar7[2] = '\0';
    pcVar7[3] = '\0';
    builtin_strncpy(entete_ligne,"                                                           ",0x3b)
    ;
    iVar1 = WriteEntete(entete_ligne);
    memset(ligne,0,0x7800);
    pcVar7 = sLine;
    for (lVar5 = 0x20; lVar5 != 0; lVar5 = lVar5 + -1) {
      pcVar7[0] = '\0';
      pcVar7[1] = '\0';
      pcVar7[2] = '\0';
      pcVar7[3] = '\0';
      pcVar7[4] = '\0';
      pcVar7[5] = '\0';
      pcVar7[6] = '\0';
      pcVar7[7] = '\0';
      pcVar7 = pcVar7 + (ulong)bVar12 * -0x10 + 8;
    }
    memset(ligne,0x20,0x77ff);
    lVar5 = 0x1f;
    pcVar7 = sLine;
    while (lVar5 != 0) {
      lVar5 = lVar5 + -1;
      builtin_strncpy(pcVar7,"        ",8);
      pcVar7 = pcVar7 + (ulong)bVar12 * -0x10 + 8;
    }
    builtin_strncpy(pcVar7,"       ",7);
    iVar10 = iVar1 + 0x26;
    if (Set == 'E') {
      EbcdicToAscii(Buffer,sDst,SizeBuffer);
    }
    else {
      memcpy(sDst,Buffer,(long)SizeBuffer);
    }
    if (SizeBuffer < 1) {
      local_89b0 = 0x23;
      lVar5 = 0x82;
      lVar11 = 0;
      iVar8 = 0x82;
      pcVar7 = ligne;
      iVar2 = iVar1;
    }
    else {
      local_89b0 = 0;
      iVar9 = 0;
      iVar8 = iVar1;
      while( true ) {
        lVar5 = (long)iVar10;
        iVar10 = iVar10 + 3;
        sprintf(ligne + lVar5,"%02X ",(ulong)(uint)(int)(char)*sDst);
        iVar2 = isprint((int)(char)*sDst);
        if (iVar2 == 0) {
          ligne[iVar8] = '.';
        }
        else {
          ligne[iVar8] = *sDst;
        }
        iVar9 = iVar9 + 1;
        iVar2 = iVar8 + 2;
        ligne[(long)iVar8 + 1] = ' ';
        if (iVar9 == SizeBuffer) break;
        iVar8 = iVar2;
        if ((iVar9 != 0) && (iVar9 == (iVar9 / 0x12) * 0x12)) {
          iVar8 = local_89b0 * 0x84;
          lVar11 = (long)iVar8;
          lVar5 = lVar11 + iVar1;
          pcVar7 = ligne + lVar5 + 0x5e;
          (ligne + lVar5 + 0x62)[0] = ' ';
          (ligne + lVar5 + 0x62)[1] = ' ';
          pcVar7[0] = ' ';
          pcVar7[1] = ' ';
          pcVar7[2] = ' ';
          pcVar7[3] = ' ';
          memcpy(ligne + lVar11,entete_ligne,(long)iVar1);
          local_89b0 = local_89b0 + 1;
          iVar8 = iVar1 + 0x84 + iVar8;
          (ligne + lVar5 + 0x24)[0] = ' ';
          (ligne + lVar5 + 0x24)[1] = '|';
          (ligne + lVar11 + 0x82)[0] = '.';
          (ligne + lVar11 + 0x82)[1] = '\n';
          iVar10 = iVar8 + 0x26;
        }
        sDst = sDst + 1;
      }
      local_89b0 = local_89b0 * 0x84;
      lVar11 = (long)local_89b0;
      iVar8 = local_89b0 + 0x82;
      local_89b0 = local_89b0 + 0x23;
      lVar5 = lVar11 + 0x82;
      pcVar7 = ligne + lVar11;
    }
    local_89a8 = (size_t)iVar1;
    lVar3 = 0;
    iVar1 = iVar2;
    while (iVar1 <= local_89b0) {
      ligne[lVar3 + iVar2] = ' ';
      lVar3 = lVar3 + 1;
      iVar1 = iVar2 + (int)lVar3;
    }
    pcVar4 = ligne + iVar10;
    for (; iVar10 <= iVar8; iVar10 = iVar10 + 1) {
      *pcVar4 = ' ';
      pcVar4 = pcVar4 + 1;
    }
    ligne[iVar10 + 1] = '\n';
    memcpy(pcVar7,entete_ligne,local_89a8);
    pcVar7 = ligne + lVar11 + local_89a8 + 0x24;
    pcVar7[0] = ' ';
    pcVar7[1] = '|';
    pcVar7 = ligne + lVar5;
    pcVar7[0] = '.';
    pcVar7[1] = '\n';
    memcpy(sLine,entete_ligne,local_89a8);
    pcVar7 = sLine + local_89a8 + 0x24;
    pcVar7[0] = ' ';
    pcVar7[1] = '|';
    pcVar4 = sLine + local_89a8 + 0x26;
    sLine[0x82] = '.';
    sLine[0x83] = '\n';
    pthread_mutex_lock((pthread_mutex_t *)&trace_mutex);
    pcVar7 = sLine + local_89a8 + 0x36;
    pcVar7[0] = ' ';
    pcVar7[1] = ' ';
    pcVar7[2] = ' ';
    pcVar7[3] = ' ';
    pcVar4[0] = 'S';
    pcVar4[1] = 'T';
    pcVar4[2] = 'A';
    pcVar4[3] = 'R';
    pcVar4[4] = 'T';
    pcVar4[5] = ' ';
    pcVar4[6] = ' ';
    pcVar4[7] = ' ';
    pcVar7 = sLine + local_89a8 + 0x2e;
    pcVar7[0] = ' ';
    pcVar7[1] = ' ';
    pcVar7[2] = ' ';
    pcVar7[3] = ' ';
    pcVar7[4] = ' ';
    pcVar7[5] = ' ';
    pcVar7[6] = ' ';
    pcVar7[7] = ' ';
    write(fd_trace,sLine,0x84);
    if (origine == 'B') {
      builtin_strncpy(sLine + local_89a8 + 0x26,"QUEUE               ",0x14);
    }
    else if (origine == 'L') {
      builtin_strncpy(sLine + local_89a8 + 0x26,"NETWORK             ",0x14);
    }
    write(fd_trace,sLine,0x84);
    if (sens == 'I') {
      builtin_strncpy(sLine + local_89a8 + 0x26,"INCOMING            ",0x14);
    }
    else if (sens == 'O') {
      builtin_strncpy(sLine + local_89a8 + 0x26,"OUTGOING            ",0x14);
    }
    write(fd_trace,sLine,0x84);
    pcVar7 = sLine + local_89a8 + 0x36;
    pcVar7[0] = ' ';
    pcVar7[1] = ' ';
    pcVar7[2] = ' ';
    pcVar7[3] = ' ';
    pcVar4[0] = 'T';
    pcVar4[1] = 'I';
    pcVar4[2] = 'M';
    pcVar4[3] = 'E';
    pcVar4[4] = 'S';
    pcVar4[5] = 'T';
    pcVar4[6] = 'A';
    pcVar4[7] = 'M';
    pcVar7 = sLine + local_89a8 + 0x2e;
    pcVar7[0] = 'P';
    iVar1 = fd_trace;
    pcVar7[1] = ' ';
    pcVar7[2] = ' ';
    pcVar7[3] = ' ';
    pcVar7[4] = ' ';
    pcVar7[5] = ' ';
    pcVar7[6] = ' ';
    pcVar7[7] = ' ';
    *(undefined4 *)(sLine + local_89a8 + 0x3a) = date._0_4_;
    *(undefined4 *)(sLine + local_89a8 + 0x3e) = date._8_4_;
    *(undefined2 *)(sLine + local_89a8 + 0x42) = date._12_2_;
    write(iVar1,sLine,0x84);
    write(fd_trace,ligne,(long)(iVar10 + 1));
    iVar1 = fd_trace;
    pcVar4[0] = 'E';
    pcVar4[1] = 'N';
    pcVar4[2] = 'D';
    pcVar4[3] = ' ';
    pcVar4[4] = ' ';
    pcVar4[5] = ' ';
    pcVar4[6] = ' ';
    pcVar4[7] = ' ';
    pcVar7 = sLine + local_89a8 + 0x2e;
    pcVar7[0] = ' ';
    pcVar7[1] = ' ';
    pcVar7[2] = ' ';
    pcVar7[3] = ' ';
    pcVar7[4] = ' ';
    pcVar7[5] = ' ';
    pcVar7[6] = ' ';
    pcVar7[7] = ' ';
    pcVar7 = sLine + local_89a8 + 0x36;
    pcVar7[0] = ' ';
    pcVar7[1] = ' ';
    pcVar7[2] = ' ';
    pcVar7[3] = ' ';
    write(iVar1,sLine,0x84);
    pthread_mutex_unlock((pthread_mutex_t *)&trace_mutex);
    trace_event("End   dump_buffer(VOID)",0);
  }
  return;
}



// WARNING: Unknown calling convention

void dump_internal(TSIsoInfo *msgInfo)

{
  uint3 uVar1;
  uint uVar2;
  uint uVar3;
  int iVar4;
  uint uVar5;
  long lVar6;
  uint *puVar7;
  uint *puVar8;
  char *pcVar9;
  size_t __n;
  bool bVar10;
  byte bVar11;
  int tmpLen;
  char ligne [512];
  char tmpField [512];
  
  bVar11 = 0;
  if (trace_level < 4) {
    trace_event("End   dump_internal()",5);
  }
  else {
    trace_event("---------------------------------------------------",4);
    puVar8 = (uint *)ligne;
    for (lVar6 = 0x40; lVar6 != 0; lVar6 = lVar6 + -1) {
      puVar8[0] = 0;
      puVar8[1] = 0;
      puVar8 = puVar8 + (ulong)bVar11 * -4 + 2;
    }
    ligne[0x18] = '\n';
    pcVar9 = tmpField;
    for (lVar6 = 0x40; lVar6 != 0; lVar6 = lVar6 + -1) {
      pcVar9[0] = '\0';
      pcVar9[1] = '\0';
      pcVar9[2] = '\0';
      pcVar9[3] = '\0';
      pcVar9[4] = '\0';
      pcVar9[5] = '\0';
      pcVar9[6] = '\0';
      pcVar9[7] = '\0';
      pcVar9 = pcVar9 + (ulong)bVar11 * -0x10 + 8;
    }
    builtin_strncpy(ligne," N      ",8);
    ligne[8] = '|';
    ligne[9] = ' ';
    ligne[10] = ' ';
    ligne[0xb] = ' ';
    ligne[0xc] = ' ';
    ligne[0xd] = ' ';
    ligne[0xe] = ' ';
    ligne[0xf] = ' ';
    ligne[0x10] = '[';
    ligne[0x11] = ' ';
    ligne[0x12] = 'D';
    ligne[0x13] = 'A';
    ligne[0x14] = 'T';
    ligne[0x15] = 'A';
    ligne[0x16] = ' ';
    ligne[0x17] = ']';
    pthread_mutex_lock((pthread_mutex_t *)&trace_mutex);
    puVar8 = (uint *)ligne;
    do {
      puVar7 = puVar8;
      uVar2 = *puVar7 + 0xfefefeff & ~*puVar7;
      uVar3 = uVar2 & 0x80808080;
      puVar8 = puVar7 + 1;
    } while (uVar3 == 0);
    bVar10 = (uVar2 & 0x8080) == 0;
    if (bVar10) {
      uVar3 = uVar3 >> 0x10;
    }
    if (bVar10) {
      puVar8 = (uint *)((long)puVar7 + 6);
    }
    uVar2 = 0;
    write(fd_trace,ligne,
          (size_t)((long)puVar8 + ((-3 - (ulong)CARRY1((byte)uVar3,(byte)uVar3)) - (long)ligne)));
    while( true ) {
      puVar8 = (uint *)ligne;
      for (lVar6 = 0x40; lVar6 != 0; lVar6 = lVar6 + -1) {
        puVar8[0] = 0;
        puVar8[1] = 0;
        puVar8 = puVar8 + (ulong)bVar11 * -4 + 2;
      }
      iVar4 = GetIsoField(uVar2,msgInfo,tmpField,&tmpLen);
      if (iVar4 == 0) {
        sprintf(ligne,"%03d %03d | ",(ulong)uVar2,(ulong)(uint)tmpLen);
        __n = (size_t)tmpLen;
        memcpy(ligne + 10,tmpField,__n);
        ligne[__n + 0xb] = '\0';
        puVar8 = (uint *)ligne;
        do {
          puVar7 = puVar8;
          uVar5 = *puVar7 + 0xfefefeff & ~*puVar7;
          uVar3 = uVar5 & 0x80808080;
          puVar8 = puVar7 + 1;
        } while (uVar3 == 0);
        bVar10 = (uVar5 & 0x8080) == 0;
        if (bVar10) {
          uVar3 = uVar3 >> 0x10;
        }
        if (bVar10) {
          puVar8 = (uint *)((long)puVar7 + 6);
        }
        write(fd_trace,ligne,
              (size_t)((long)puVar8 + ((-3 - (ulong)CARRY1((byte)uVar3,(byte)uVar3)) - (long)ligne))
             );
        write(fd_trace,"\n",1);
      }
      if (uVar2 == 0x7f) break;
      uVar2 = uVar2 + 1;
      if (uVar2 == 0x33) {
        puVar8 = (uint *)ligne;
        for (lVar6 = 0x40; lVar6 != 0; lVar6 = lVar6 + -1) {
          puVar8[0] = 0;
          puVar8[1] = 0;
          puVar8 = puVar8 + (ulong)bVar11 * -4 + 2;
        }
        iVar4 = GetIsoField(0x33,msgInfo,tmpField,&tmpLen);
        if (iVar4 == 0) {
          sprintf(ligne,"%03d %03d | ",0x33,(ulong)(uint)tmpLen);
          uVar1 = (uint3)ligne._16_8_;
          ligne[0x13] = '\0';
          ligne._16_3_ = uVar1;
          puVar8 = (uint *)ligne;
          do {
            puVar7 = puVar8;
            uVar5 = *puVar7 + 0xfefefeff & ~*puVar7;
            uVar3 = uVar5 & 0x80808080;
            puVar8 = puVar7 + 1;
          } while (uVar3 == 0);
          bVar10 = (uVar5 & 0x8080) == 0;
          if (bVar10) {
            uVar3 = uVar3 >> 0x10;
          }
          if (bVar10) {
            puVar8 = (uint *)((long)puVar7 + 6);
          }
          write(fd_trace,ligne,
                (size_t)((long)puVar8 +
                        ((-3 - (ulong)CARRY1((byte)uVar3,(byte)uVar3)) - (long)ligne)));
          write(fd_trace,"\n",1);
        }
      }
    }
    pthread_mutex_unlock((pthread_mutex_t *)&trace_mutex);
    trace_event("---------------------------------------------------",4);
  }
  return;
}



// WARNING: Unknown calling convention

void error_to_console(char *source,int severity,char *message,char *fix)

{
  int __severity;
  
  __severity = 0;
  if (severity != 0) {
    if (severity == 1) {
      __severity = 4;
    }
    else if (severity == 2) {
      __severity = 3;
    }
    else if (severity == 3) {
      __severity = 2;
    }
    else {
      __severity = (uint)(severity != 4) * 3 + 1;
    }
  }
  fmtmsg(0x200,source,__severity,message,fix,"");
  return;
}



// WARNING: Unknown calling convention

void dump_event(char *mess,int level)

{
  int iVar1;
  size_t __n;
  
  if (trace_level < level) {
    return;
  }
  pthread_mutex_lock((pthread_mutex_t *)&trace_mutex);
  if (0 < fd_trace) {
    iVar1 = check_trace_size(fd_trace,max_size);
    if (iVar1 != 0) {
      close(fd_trace);
      init_trace();
    }
  }
  pthread_mutex_unlock((pthread_mutex_t *)&trace_mutex);
  pthread_mutex_lock((pthread_mutex_t *)&trace_mutex);
  __n = strlen(mess);
  write(fd_trace,mess,__n);
  pthread_mutex_unlock((pthread_mutex_t *)&trace_mutex);
  return;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address
// WARNING: Unknown calling convention

int current_gmt_date(char *date_heure_jour)

{
  int iVar1;
  char jj_c [3];
  char mm_c [3];
  char hh_c [3];
  char mi_c [3];
  char ss_c [3];
  char aa_c [5];
  time_t lg;
  tm date_r;
  
  if (date_heure_jour == (char *)0x0) {
    trace_event("DAT003IM",1);
    _DAT_00000000 = 0x30303030;
    _DAT_00000004 = 0x3030;
    iVar1 = -1;
  }
  else {
    time(&lg);
    gmtime_r(&lg,(tm *)&date_r);
    date_heure_jour[0] = '\0';
    date_heure_jour[1] = '\0';
    date_heure_jour[2] = '\0';
    date_heure_jour[3] = '\0';
    date_heure_jour[4] = '\0';
    date_heure_jour[5] = '\0';
    date_heure_jour[6] = '\0';
    date_heure_jour[7] = '\0';
    date_heure_jour[8] = '\0';
    date_heure_jour[9] = '\0';
    date_heure_jour[10] = '\0';
    date_heure_jour[0xb] = '\0';
    iVar1 = date_r.tm_min + -1;
    date_r.tm_min = 0;
    if (iVar1 != 0x3c) {
      date_r.tm_min = iVar1;
    }
    sprintf(aa_c,"%04d",(ulong)(date_r.tm_year + 0x76c));
    sprintf(mm_c,"%02d",(ulong)(date_r.tm_mon + 1));
    sprintf(jj_c,"%02d",(ulong)(uint)date_r.tm_mday);
    sprintf(hh_c,"%02d",(ulong)(uint)date_r.tm_hour);
    sprintf(mi_c,"%02d",(ulong)(date_r.tm_min + 1));
    sprintf(ss_c,"%02d",(ulong)(uint)date_r.tm_sec);
    *(undefined2 *)date_heure_jour = aa_c._2_2_;
    *(undefined2 *)(date_heure_jour + 2) = mm_c._0_2_;
    *(undefined2 *)(date_heure_jour + 4) = jj_c._0_2_;
    *(undefined2 *)(date_heure_jour + 6) = hh_c._0_2_;
    *(undefined2 *)(date_heure_jour + 8) = mi_c._0_2_;
    *(undefined2 *)(date_heure_jour + 10) = ss_c._0_2_;
    iVar1 = 0;
  }
  return iVar1;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address
// WARNING: Unknown calling convention

int current_date_ddmmyy(char *date_du_jour)

{
  int iVar1;
  char jj_c [3];
  char mm_c [3];
  char aa_c [5];
  time_t lg;
  tm date_r;
  
  if (date_du_jour == (char *)0x0) {
    trace_event("DAT001IM",1);
    _DAT_00000000 = 0x30303030;
    _DAT_00000004 = 0x3030;
    iVar1 = -1;
  }
  else {
    time(&lg);
    localtime_r(&lg,(tm *)&date_r);
    sprintf(jj_c,"%02d",(ulong)(uint)date_r.tm_mday);
    sprintf(mm_c,"%02d",(ulong)(date_r.tm_mon + 1));
    sprintf(aa_c,"%04d",(ulong)(date_r.tm_year + 0x76c));
    *(undefined2 *)date_du_jour = jj_c._0_2_;
    *(undefined2 *)(date_du_jour + 2) = mm_c._0_2_;
    *(undefined2 *)(date_du_jour + 4) = aa_c._2_2_;
    iVar1 = 0;
  }
  return iVar1;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address
// WARNING: Unknown calling convention

int current_date(char *date_du_jour)

{
  int iVar1;
  tm *__tp;
  char *pcVar2;
  char jj_c [3];
  char mm_c [3];
  char aa_c [5];
  time_t d1;
  char date_tampon [27];
  tm tm_date_r;
  
  if (date_du_jour == (char *)0x0) {
    _DAT_00000000 = 0x30303030;
    _DAT_00000004 = 0x3030;
    iVar1 = -1;
  }
  else {
    time(&d1);
    __tp = localtime_r(&d1,(tm *)&tm_date_r);
    sprintf(jj_c,"%02d",(ulong)(uint)tm_date_r.tm_mday);
    sprintf(mm_c,"%02d",(ulong)(tm_date_r.tm_mon + 1));
    pcVar2 = asctime(__tp);
    *(int *)(date_du_jour + 4) = (int)((ulong)*(undefined8 *)(pcVar2 + 0x10) >> 0x20);
    iVar1 = 0;
    *(undefined2 *)date_du_jour = jj_c._0_2_;
    *(undefined2 *)(date_du_jour + 2) = mm_c._0_2_;
  }
  return iVar1;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address
// WARNING: Unknown calling convention

int current_date_mmdd(char *date_du_jour)

{
  int iVar1;
  char jj_c [3];
  char mm_c [3];
  time_t lg;
  tm date_r;
  
  if (date_du_jour == (char *)0x0) {
    trace_event("DAT000IM",1);
    _DAT_00000000 = 0x30303030;
    iVar1 = -1;
  }
  else {
    time(&lg);
    localtime_r(&lg,(tm *)&date_r);
    sprintf(jj_c,"%02d",(ulong)(uint)date_r.tm_mday);
    sprintf(mm_c,"%02d",(ulong)(date_r.tm_mon + 1));
    date_du_jour[4] = '\0';
    *(undefined2 *)date_du_jour = mm_c._0_2_;
    *(undefined2 *)(date_du_jour + 2) = jj_c._0_2_;
    iVar1 = 0;
  }
  return iVar1;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address
// WARNING: Unknown calling convention

int current_date_yyyymmdd(char *date_du_jour)

{
  int iVar1;
  tm *__tp;
  char *pcVar2;
  char jj_c [3];
  char mm_c [3];
  char aa_c [5];
  time_t lg;
  char date_tampon [27];
  tm date_r;
  
  if (date_du_jour == (char *)0x0) {
    trace_event("DAT001IM",1);
    _DAT_00000000 = 0x30303030;
    _DAT_00000004 = 0x3030;
    iVar1 = -1;
  }
  else {
    time(&lg);
    __tp = localtime_r(&lg,(tm *)&date_r);
    sprintf(jj_c,"%02d",(ulong)(uint)date_r.tm_mday);
    sprintf(mm_c,"%02d",(ulong)(date_r.tm_mon + 1));
    pcVar2 = asctime(__tp);
    *(int *)date_du_jour = (int)((ulong)*(undefined8 *)(pcVar2 + 0x10) >> 0x20);
    *(undefined2 *)(date_du_jour + 4) = mm_c._0_2_;
    *(undefined2 *)(date_du_jour + 6) = jj_c._0_2_;
    iVar1 = 0;
  }
  return iVar1;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address
// WARNING: Unknown calling convention

int current_date_yymmdd(char *date_du_jour)

{
  int iVar1;
  char jj_c [3];
  char mm_c [3];
  char aa_c [5];
  time_t lg;
  tm date_r;
  
  if (date_du_jour == (char *)0x0) {
    trace_event("DAT001IM",1);
    _DAT_00000000 = 0x30303030;
    _DAT_00000004 = 0x3030;
    iVar1 = -1;
  }
  else {
    time(&lg);
    localtime_r(&lg,(tm *)&date_r);
    sprintf(jj_c,"%02d",(ulong)(uint)date_r.tm_mday);
    sprintf(mm_c,"%02d",(ulong)(date_r.tm_mon + 1));
    sprintf(aa_c,"%04d",(ulong)(date_r.tm_year + 0x76c));
    *(undefined2 *)date_du_jour = aa_c._2_2_;
    *(undefined2 *)(date_du_jour + 2) = mm_c._0_2_;
    *(undefined2 *)(date_du_jour + 4) = jj_c._0_2_;
    iVar1 = 0;
  }
  return iVar1;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address
// WARNING: Unknown calling convention

int current_system_date(char *date_heure_jour)

{
  int iVar1;
  char jj_c [3];
  char mm_c [3];
  char hh_c [3];
  char mi_c [3];
  char ss_c [3];
  char aa_c [5];
  time_t lg;
  tm date_r;
  
  if (date_heure_jour == (char *)0x0) {
    trace_event("DAT003IM",1);
    _DAT_00000000 = 0x30303030;
    _DAT_00000004 = 0x3030;
    iVar1 = -1;
  }
  else {
    time(&lg);
    localtime_r(&lg,(tm *)&date_r);
    date_heure_jour[0] = '\0';
    date_heure_jour[1] = '\0';
    date_heure_jour[2] = '\0';
    date_heure_jour[3] = '\0';
    date_heure_jour[4] = '\0';
    date_heure_jour[5] = '\0';
    date_heure_jour[6] = '\0';
    date_heure_jour[7] = '\0';
    date_heure_jour[8] = '\0';
    date_heure_jour[9] = '\0';
    date_heure_jour[10] = '\0';
    date_heure_jour[0xb] = '\0';
    date_heure_jour[0xc] = '\0';
    date_heure_jour[0xd] = '\0';
    date_heure_jour[0xe] = '\0';
    date_heure_jour[0xf] = '\0';
    date_heure_jour[0x10] = '\0';
    iVar1 = date_r.tm_min + -1;
    date_r.tm_min = 0;
    if (iVar1 != 0x3c) {
      date_r.tm_min = iVar1;
    }
    sprintf(hh_c,"%02d",(ulong)(uint)date_r.tm_hour);
    sprintf(mi_c,"%02d",(ulong)(date_r.tm_min + 1));
    sprintf(ss_c,"%02d",(ulong)(uint)date_r.tm_sec);
    sprintf(jj_c,"%02d",(ulong)(uint)date_r.tm_mday);
    sprintf(mm_c,"%02d",(ulong)(date_r.tm_mon + 1));
    sprintf(aa_c,"%04d",(ulong)(date_r.tm_year + 0x76c));
    date_heure_jour[2] = '/';
    date_heure_jour[5] = '/';
    date_heure_jour[8] = ' ';
    date_heure_jour[0xb] = ':';
    date_heure_jour[0xe] = ':';
    *(undefined2 *)date_heure_jour = jj_c._0_2_;
    *(undefined2 *)(date_heure_jour + 3) = mm_c._0_2_;
    *(undefined2 *)(date_heure_jour + 6) = aa_c._2_2_;
    *(undefined2 *)(date_heure_jour + 9) = hh_c._0_2_;
    *(undefined2 *)(date_heure_jour + 0xc) = mi_c._0_2_;
    *(undefined2 *)(date_heure_jour + 0xf) = ss_c._0_2_;
    iVar1 = 0;
  }
  return iVar1;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address
// WARNING: Unknown calling convention

int current_hour(char *heure_du_jour)

{
  int iVar1;
  char hh_c [3];
  char mm_c [3];
  char ss_c [3];
  time_t lg;
  tm date_r;
  
  if (heure_du_jour == (char *)0x0) {
    trace_event("DAT003IM",1);
    _DAT_00000000 = 0x30303030;
    _DAT_00000004 = 0x3030;
    iVar1 = -1;
  }
  else {
    time(&lg);
    localtime_r(&lg,(tm *)&date_r);
    iVar1 = date_r.tm_min + -1;
    date_r.tm_min = 0;
    if (iVar1 != 0x3c) {
      date_r.tm_min = iVar1;
    }
    sprintf(hh_c,"%02d",(ulong)(uint)date_r.tm_hour);
    sprintf(mm_c,"%02d",(ulong)(date_r.tm_min + 1));
    sprintf(ss_c,"%02d",(ulong)(uint)date_r.tm_sec);
    *(undefined2 *)heure_du_jour = hh_c._0_2_;
    *(undefined2 *)(heure_du_jour + 2) = mm_c._0_2_;
    *(undefined2 *)(heure_du_jour + 4) = ss_c._0_2_;
    iVar1 = 0;
  }
  return iVar1;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address
// WARNING: Unknown calling convention

int current_hour_hhmm(char *heure_du_jour)

{
  int iVar1;
  char hh_c [3];
  char mm_c [3];
  time_t lg;
  tm date_r;
  
  if (heure_du_jour == (char *)0x0) {
    trace_event("current_hour_hhmm()",1);
    _DAT_00000000 = 0x30303030;
    _DAT_00000004 = 0x3030;
    iVar1 = -1;
  }
  else {
    time(&lg);
    localtime_r(&lg,(tm *)&date_r);
    iVar1 = date_r.tm_min + -1;
    date_r.tm_min = 0;
    if (iVar1 != 0x3c) {
      date_r.tm_min = iVar1;
    }
    sprintf(hh_c,"%02d",(ulong)(uint)date_r.tm_hour);
    sprintf(mm_c,"%02d",(ulong)(date_r.tm_min + 1));
    heure_du_jour[4] = '\0';
    *(undefined2 *)heure_du_jour = hh_c._0_2_;
    *(undefined2 *)(heure_du_jour + 2) = mm_c._0_2_;
    iVar1 = 0;
  }
  return iVar1;
}



// WARNING: Unknown calling convention

int char_to_date(char *date,char *date_cible)

{
  int iVar1;
  char mois [3];
  
  mois[0] = '\0';
  mois[1] = '\0';
  mois[2] = '\0';
  *(undefined2 *)date_cible = *(undefined2 *)date;
  strncpy(mois,date + 2,2);
  if (((int)mois[0] - 0x30U < 10) && ((int)mois[1] - 0x30U < 10)) {
    iVar1 = atoi(mois);
    if (iVar1 - 1U < 0xc) {
      *(undefined4 *)(date_cible + 2) = *(undefined4 *)t_month[iVar1];
      *(undefined4 *)(date_cible + 6) = *(undefined4 *)(date + 4);
      iVar1 = 0;
    }
    else {
      trace_event("DAT005IM",1);
      builtin_strncpy(date_cible,"0000000000",10);
      iVar1 = -1;
    }
    return iVar1;
  }
  trace_event("DAT004IM",1);
  builtin_strncpy(date_cible,"00000000",8);
  return -1;
}



// WARNING: Unknown calling convention

int annee_bissextile(int annee)

{
  uint uVar1;
  
  uVar1 = 1;
  if ((annee != (annee / 400) * 400) && (uVar1 = annee % 100, uVar1 != 0)) {
    uVar1 = (uint)((annee & 3U) == 0);
  }
  return uVar1;
}



// WARNING: Unknown calling convention

int ajouter_annee1(char *date)

{
  int iVar1;
  char aa_c [5];
  
  aa_c[4] = '\0';
  aa_c[2] = '\0';
  aa_c[3] = '\0';
  aa_c._0_2_ = *(ushort *)(date + 4);
  iVar1 = atoi(aa_c);
  sprintf(aa_c,"%02d",(ulong)(iVar1 + 1));
  *(undefined2 *)(date + 4) = aa_c._0_2_;
  return 0;
}



// WARNING: Unknown calling convention

int ajouter_mois1(char *date)

{
  int iVar1;
  ulong uVar2;
  char mm_c [3];
  
  mm_c._0_2_ = *(undefined2 *)(date + 2);
  mm_c[2] = '\0';
  iVar1 = atoi(mm_c);
  uVar2 = (ulong)(iVar1 + 1);
  if (0xb < iVar1) {
    ajouter_annee1(date);
    uVar2 = 1;
  }
  sprintf(mm_c,"%02d",uVar2);
  *(undefined2 *)(date + 2) = mm_c._0_2_;
  return 0;
}



// WARNING: Unknown calling convention

int ajouter_jour1(char *date)

{
  int iVar1;
  int iVar2;
  int annee;
  ulong uVar3;
  char jj_c [3];
  char mm_c [3];
  char aa_c [3];
  
  jj_c._0_2_ = *(undefined2 *)date;
  jj_c[2] = '\0';
  mm_c[2] = '\0';
  aa_c[2] = '\0';
  mm_c._0_2_ = *(undefined2 *)(date + 2);
  aa_c._0_2_ = *(undefined2 *)(date + 4);
  iVar1 = atoi(jj_c);
  iVar2 = atoi(mm_c);
  annee = atoi(aa_c);
  if (iVar2 == 2) {
    iVar2 = annee_bissextile(annee);
    iVar2 = iVar2 + 0x1c;
  }
  else {
    iVar2 = l_month[iVar2 + -1];
  }
  if (iVar1 < iVar2) {
    uVar3 = (ulong)(iVar1 + 1);
  }
  else {
    ajouter_mois1(date);
    uVar3 = 1;
  }
  sprintf(jj_c,"%02d",uVar3);
  *(undefined2 *)date = jj_c._0_2_;
  return 0;
}



// WARNING: Unknown calling convention

int ajouter_annee(char *date)

{
  int iVar1;
  char aa_c [5];
  
  aa_c._0_4_ = *(undefined4 *)(date + 4);
  aa_c[4] = '\0';
  iVar1 = atoi(aa_c);
  sprintf(aa_c,"%04d",(ulong)(iVar1 + 1));
  *(undefined4 *)(date + 4) = aa_c._0_4_;
  return 0;
}



// WARNING: Unknown calling convention

int ajouter_mois(char *date)

{
  int iVar1;
  ulong uVar2;
  char mm_c [3];
  
  mm_c._0_2_ = *(undefined2 *)(date + 2);
  mm_c[2] = '\0';
  iVar1 = atoi(mm_c);
  uVar2 = (ulong)(iVar1 + 1);
  if (0xb < iVar1) {
    ajouter_annee(date);
    uVar2 = 1;
  }
  sprintf(mm_c,"%02d",uVar2);
  *(undefined2 *)(date + 2) = mm_c._0_2_;
  return 0;
}



// WARNING: Unknown calling convention

int ajouter_jour(char *date)

{
  int iVar1;
  int iVar2;
  int annee;
  ulong uVar3;
  char jj_c [3];
  char mm_c [3];
  char aa_c [5];
  
  jj_c._0_2_ = *(undefined2 *)date;
  jj_c[2] = '\0';
  mm_c[2] = '\0';
  aa_c[4] = '\0';
  mm_c._0_2_ = *(undefined2 *)(date + 2);
  aa_c._0_4_ = *(undefined4 *)(date + 4);
  iVar1 = atoi(jj_c);
  iVar2 = atoi(mm_c);
  annee = atoi(aa_c);
  if (iVar2 == 2) {
    iVar2 = annee_bissextile(annee);
    iVar2 = iVar2 + 0x1c;
  }
  else {
    iVar2 = l_month[iVar2 + -1];
  }
  if (iVar1 < iVar2) {
    uVar3 = (ulong)(iVar1 + 1);
  }
  else {
    ajouter_mois(date);
    uVar3 = 1;
  }
  sprintf(jj_c,"%02d",uVar3);
  *(undefined2 *)date = jj_c._0_2_;
  return 0;
}



// WARNING: Unknown calling convention

int current_julian_date(char *date_du_jour)

{
  time_t lg;
  tm date_r;
  
  time(&lg);
  localtime_r(&lg,(tm *)&date_r);
  sprintf(date_du_jour,"%03d",(ulong)(date_r.tm_yday + 1));
  return 0;
}



// WARNING: Unknown calling convention

int convert_to_julian(char *date,char *julian_date)

{
  int annee;
  int iVar1;
  int iVar2;
  int iVar3;
  char mm_c [3];
  char jj_c [3];
  char julian_date_tampon [4];
  char aa_c [5];
  
  aa_c._0_4_ = *(undefined4 *)(date + 4);
  aa_c[4] = '\0';
  annee = atoi(aa_c);
  mm_c._0_2_ = *(undefined2 *)(date + 2);
  mm_c[2] = '\0';
  iVar1 = atoi(mm_c);
  jj_c._0_2_ = *(undefined2 *)date;
  jj_c[2] = '\0';
  iVar2 = atoi(jj_c);
  iVar1 = iVar1 + -1;
  iVar3 = iVar2;
  if ((((((0 < iVar1) && (iVar3 = iVar2 + 0x1f, 1 < iVar1)) && (iVar3 = iVar2 + 0x3b, 2 < iVar1)) &&
       ((iVar3 = iVar2 + 0x5a, 3 < iVar1 && (iVar3 = iVar2 + 0x78, 4 < iVar1)))) &&
      ((iVar3 = iVar2 + 0x97, 5 < iVar1 &&
       ((iVar3 = iVar2 + 0xb5, 6 < iVar1 && (iVar3 = iVar2 + 0xd4, 7 < iVar1)))))) &&
     ((iVar3 = iVar2 + 0xf3, 8 < iVar1 &&
      ((iVar3 = iVar2 + 0x111, 9 < iVar1 && (iVar3 = iVar2 + 0x130, 10 < iVar1)))))) {
    iVar3 = iVar2 + 0x16d;
    if (iVar1 < 0xc) {
      iVar3 = iVar2 + 0x14e;
    }
  }
  iVar1 = annee_bissextile(annee);
  sprintf(julian_date_tampon,"%03d",(ulong)(uint)(iVar3 + iVar1));
  *(undefined2 *)julian_date = julian_date_tampon._0_2_;
  julian_date[2] = julian_date_tampon[2];
  return iVar3 + iVar1;
}



// WARNING: Unknown calling convention

long difference_date(char *date1,char *date2)

{
  long lVar1;
  long lVar2;
  
  lVar1 = atol(date1);
  lVar2 = atol(date2);
  return (long)((int)lVar1 - (int)lVar2);
}



// WARNING: Unknown calling convention

int len(int i)

{
  int iVar1;
  int iVar2;
  
  iVar2 = 1;
  iVar1 = i / 10;
  if (0 < iVar1) {
    do {
      iVar2 = iVar2 + 1;
      iVar1 = iVar1 / 10;
    } while (iVar1 != 0);
  }
  return iVar2;
}



// WARNING: Unknown calling convention

int current_julian_date_qjjj(char *date_du_jour)

{
  char dd_c [4];
  char aa_c [5];
  time_t lg;
  tm date_r;
  
  time(&lg);
  localtime_r(&lg,(tm *)&date_r);
  sprintf(aa_c,"%04d",(ulong)(uint)date_r.tm_year);
  sprintf(dd_c,"%03d",(ulong)(date_r.tm_yday + 1));
  *date_du_jour = aa_c[3];
  *(undefined2 *)(date_du_jour + 1) = dd_c._0_2_;
  date_du_jour[3] = dd_c[2];
  return 0;
}



// WARNING: Unknown calling convention

int current_day_of_week(char *date_du_jour)

{
  char dd_c [2];
  time_t lg;
  tm date_r;
  
  time(&lg);
  localtime_r(&lg,(tm *)&date_r);
  sprintf(dd_c,"%01d",(ulong)(uint)date_r.tm_wday);
  *date_du_jour = dd_c[0];
  return 0;
}



// WARNING: Unknown calling convention

void get_timer(int *app_time)

{
  timeval V_time;
  
  gettimeofday((timeval *)&V_time,(__timezone_ptr_t)0x0);
  *app_time = (int)V_time.tv_sec;
  return;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address
// WARNING: Unknown calling convention

int current_date_yymmddhhmmss(char *date_heure_jour)

{
  int iVar1;
  char jj_c [3];
  char mm_c [3];
  char hh_c [3];
  char mi_c [3];
  char ss_c [3];
  char aa_c [5];
  long lg;
  tm date_r;
  
  if (date_heure_jour == (char *)0x0) {
    trace_event("DAT003IM",1);
    _DAT_00000000 = 0x30303030;
    _DAT_00000004 = 0x3030;
    iVar1 = -1;
  }
  else {
    time(&lg);
    localtime_r(&lg,(tm *)&date_r);
    date_heure_jour[0] = '\0';
    date_heure_jour[1] = '\0';
    date_heure_jour[2] = '\0';
    date_heure_jour[3] = '\0';
    date_heure_jour[4] = '\0';
    date_heure_jour[5] = '\0';
    date_heure_jour[6] = '\0';
    date_heure_jour[7] = '\0';
    date_heure_jour[8] = '\0';
    date_heure_jour[9] = '\0';
    date_heure_jour[10] = '\0';
    date_heure_jour[0xb] = '\0';
    iVar1 = date_r.tm_min + -1;
    date_r.tm_min = 0;
    if (iVar1 != 0x3c) {
      date_r.tm_min = iVar1;
    }
    sprintf(aa_c,"%04d",(ulong)(date_r.tm_year + 0x76c));
    sprintf(mm_c,"%02d",(ulong)(date_r.tm_mon + 1));
    sprintf(jj_c,"%02d",(ulong)(uint)date_r.tm_mday);
    sprintf(hh_c,"%02d",(ulong)(uint)date_r.tm_hour);
    sprintf(mi_c,"%02d",(ulong)(date_r.tm_min + 1));
    sprintf(ss_c,"%02d",(ulong)(uint)date_r.tm_sec);
    *(undefined2 *)date_heure_jour = aa_c._2_2_;
    *(undefined2 *)(date_heure_jour + 2) = mm_c._0_2_;
    *(undefined2 *)(date_heure_jour + 4) = jj_c._0_2_;
    *(undefined2 *)(date_heure_jour + 6) = hh_c._0_2_;
    *(undefined2 *)(date_heure_jour + 8) = mi_c._0_2_;
    *(undefined2 *)(date_heure_jour + 10) = ss_c._0_2_;
    iVar1 = 0;
  }
  return iVar1;
}



// WARNING: Unknown calling convention

void GetIssuerPurgeTime(time_t *nPurgeTime)

{
  char sLine [512];
  
  trace_event("Start GetIssuerPurgeTime()",5);
  time(nPurgeTime);
  *nPurgeTime = (long)(nTimerAcq - nIssAcqDelta) + *nPurgeTime + -1000000000;
  sprintf(sLine,"End GetIssuerPurgeTime(%ld)");
  trace_event(sLine,5);
  return;
}



// WARNING: Unknown calling convention

void GetAcquirerPurgeTime(time_t *nPurgeTime)

{
  char sLine [512];
  
  trace_event("Start GetAcquirerPurgeTime()",4);
  time(nPurgeTime);
  *nPurgeTime = (long)nTimerAcq + *nPurgeTime + -1000000000;
  sprintf(sLine,"End GetAcquirerPurgeTime(%ld)");
  trace_event(sLine,5);
  return;
}



// WARNING: Unknown calling convention

void GetSafPurgeTime(time_t *nPurgeTime)

{
  char sLine [512];
  
  trace_event("Start GetSafPurgeTime()",4);
  time(nPurgeTime);
  *nPurgeTime = (long)nTimerAcq + *nPurgeTime + -1000000000;
  sprintf(sLine,"End GetSafPurgeTime(%ld)");
  trace_event(sLine,5);
  return;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address
// WARNING: Unknown calling convention

int current_SID_date_yymmddhhmm(char *date_heure_jour)

{
  int iVar1;
  char jj_c [3];
  char mm_c [3];
  char hh_c [3];
  char mi_c [3];
  char aa_c [5];
  long lg;
  tm date_r;
  
  if (date_heure_jour == (char *)0x0) {
    trace_event("DAT003IM",1);
    _DAT_00000000 = 0x30303030;
    iVar1 = -1;
    _DAT_00000004 = 0x3030;
  }
  else {
    time(&lg);
    localtime_r(&lg,(tm *)&date_r);
    date_heure_jour[0] = '\0';
    date_heure_jour[1] = '\0';
    date_heure_jour[2] = '\0';
    date_heure_jour[3] = '\0';
    date_heure_jour[4] = '\0';
    date_heure_jour[5] = '\0';
    date_heure_jour[6] = '\0';
    date_heure_jour[7] = '\0';
    iVar1 = date_r.tm_min + -1;
    date_r.tm_min = 0;
    if (iVar1 != 0x3c) {
      date_r.tm_min = iVar1;
    }
    date_heure_jour[8] = '\0';
    date_heure_jour[9] = '\0';
    sprintf(aa_c,"%04d",(ulong)(date_r.tm_year + 0x76c));
    sprintf(mm_c,"%02d",(ulong)(date_r.tm_mon + 1));
    sprintf(jj_c,"%02d",(ulong)(uint)date_r.tm_mday);
    sprintf(hh_c,"%02d",(ulong)(uint)date_r.tm_hour);
    sprintf(mi_c,"%02d",(ulong)(date_r.tm_min + 1));
    *(undefined2 *)date_heure_jour = aa_c._2_2_;
    *(undefined2 *)(date_heure_jour + 2) = mm_c._0_2_;
    *(undefined2 *)(date_heure_jour + 4) = jj_c._0_2_;
    *(undefined2 *)(date_heure_jour + 6) = hh_c._0_2_;
    *(undefined2 *)(date_heure_jour + 8) = mi_c._0_2_;
    iVar1 = 0;
  }
  return iVar1;
}



// WARNING: Unknown calling convention

void GetSafPurgeTimeMS(timeval *sPurgeTime)

{
  long lVar1;
  long lVar2;
  int iVar3;
  char sLine [512];
  
  trace_event("Start GetSafPurgeTimeMS()",4);
  gettimeofday((timeval *)sPurgeTime,(__timezone_ptr_t)0x0);
  lVar2 = (long)(nTimerAcq / 1000) + sPurgeTime->tv_sec;
  iVar3 = nTimerAcq % 1000;
  sPurgeTime->tv_sec = lVar2;
  if (iVar3 < 1) {
    lVar1 = sPurgeTime->tv_usec;
  }
  else {
    iVar3 = iVar3 * 1000 + (int)sPurgeTime->tv_usec;
    if (iVar3 < 1000000) {
      lVar1 = (long)iVar3;
      sPurgeTime->tv_usec = lVar1;
    }
    else {
      lVar2 = lVar2 + 1;
      lVar1 = (long)(iVar3 + -1000000);
      sPurgeTime->tv_usec = lVar1;
    }
  }
  sPurgeTime->tv_sec = lVar2 + -1000000000;
  sprintf(sLine,"End GetSafPurgeTimeMS(%ld,%ld,%d)",lVar2 + -1000000000,lVar1);
  trace_event(sLine,5);
  return;
}



// WARNING: Unknown calling convention

int ToFullTrace(int nIndexCtx)

{
  if (((nIndexCtx != 8) && (nIndexCtx != 6)) && (1 < nIndexCtx - 9U)) {
    return -(uint)(nIndexCtx - 0xbU < 2);
  }
  return -1;
}



// WARNING: Unknown calling convention

int WaitDBConRequest(int nIndex)

{
  pthread_mutex_t *__mutex;
  int iVar1;
  
  __mutex = &tab_DBConThread[nIndex].ThrMutex;
  iVar1 = pthread_mutex_lock((pthread_mutex_t *)__mutex);
  if (iVar1 == 0x23) {
    trace_event("End   WaitDBConRequest(EDEADLK)",5);
    iVar1 = -1;
  }
  else {
    iVar1 = tab_DBConThread[nIndex].nState;
    while (iVar1 != 3) {
      pthread_cond_wait((pthread_cond_t *)&tab_DBConThread[nIndex].ThrCond,
                        (pthread_mutex_t *)__mutex);
      iVar1 = tab_DBConThread[nIndex].nState;
    }
    pthread_mutex_unlock((pthread_mutex_t *)__mutex);
    iVar1 = 0;
  }
  return iVar1;
}



// WARNING: Unknown calling convention

int InfoDBConThread(int nIndex)

{
  int iVar1;
  
  if (tab_DBConThread[nIndex].nFullTrace == 0) {
    trace_event("Start InfoDBConThread()",5);
  }
  iVar1 = pthread_mutex_lock((pthread_mutex_t *)&tab_DBConThread[nIndex].ThrMutex);
  if (iVar1 == 0x23) {
    iVar1 = -1;
    trace_event("End   InfoDBConThread(EDEADLK)",1);
  }
  else {
    tab_DBConThread[nIndex].nState = 3;
    pthread_cond_signal((pthread_cond_t *)&tab_DBConThread[nIndex].ThrCond);
    iVar1 = pthread_mutex_unlock((pthread_mutex_t *)&tab_DBConThread[nIndex].ThrMutex);
    if (tab_DBConThread[nIndex].nFullTrace == 0) {
      trace_event("End   InfoDBConThread(OK)",5);
      return iVar1;
    }
  }
  return iVar1;
}



// WARNING: Unknown calling convention

int FreeDBConThread(int nIndex)

{
  pthread_mutex_lock((pthread_mutex_t *)&tab_DBConThread[nIndex].ThrMutex);
  tab_DBConThread[nIndex].nState = 1;
  pthread_mutex_unlock((pthread_mutex_t *)&tab_DBConThread[nIndex].ThrMutex);
  return 0;
}



// WARNING: Unknown calling convention

int InitDBConThreads(void)

{
  pthread_mutex_t *__mutex;
  pthread_mutex_t *ppVar1;
  pthread_mutexattr_t mattr;
  pthread_condattr_t cattr;
  
  trace_event("Start InitDBConThreads()",5);
  pthread_mutexattr_init((pthread_mutexattr_t *)&mattr);
  pthread_condattr_init((pthread_condattr_t *)&cattr);
  __mutex = (pthread_mutex_t *)&tab_DBConThread[0].ThrMutex;
  do {
    __mutex[-1].__data.__lock = 0;
    *(undefined4 *)((long)__mutex + -0x24) = 0;
    *(undefined4 *)((long)__mutex + -0x20) = 0;
    *(undefined8 *)((long)__mutex + -0x18) = 0;
    *(undefined8 *)((long)__mutex + -0x10) = 0;
    *(undefined8 *)((long)__mutex + -8) = 0;
    *(undefined4 *)((long)__mutex + 0xb8) = 0;
    pthread_mutex_init(__mutex,(pthread_mutexattr_t *)&mattr);
    pthread_cond_init((pthread_cond_t *)(__mutex + 1),(pthread_condattr_t *)&cattr);
    pthread_mutex_init((pthread_mutex_t *)((long)__mutex + 0x58),(pthread_mutexattr_t *)&mattr);
    ppVar1 = (pthread_mutex_t *)((long)__mutex + 0xe8);
    pthread_cond_init((pthread_cond_t *)((long)__mutex + 0x80),(pthread_condattr_t *)&cattr);
    *(undefined4 *)((long)__mutex + 0xb0) = 0;
    *(undefined4 *)((long)__mutex + 0xb4) = 0;
    __mutex = ppVar1;
  } while (ppVar1 != (pthread_mutex_t *)&DAT_0070c288);
  return 0;
}



// WARNING: Unknown calling convention

int ProcessDBConRequest(int nIndex)

{
  uint nIndexCtx;
  int iVar1;
  pthread_mutex_t *__mutex;
  time_t nCurrTime;
  time_t start_time;
  time_t end_time;
  TSParamCtx ParamCtx;
  char sLine [1024];
  char sLine_1 [1024];
  
  if (tab_DBConThread[nIndex].nFullTrace == 0) {
    sprintf(sLine,"Start ProcessDBConRequest(RefThrIdx(%d),CtxIdx(%d), ProcThrId(%.08lu)",
            (ulong)(uint)nIndex,(ulong)(uint)tab_DBConThread[nIndex].nIndex,
            tab_DBConThread[nIndex].nThreadId);
    trace_event(sLine,5);
  }
  ParamCtx.ctx = tab_ParamCtx[tab_DBConThread[nIndex].nIndex].ctx;
  ParamCtx.ID = tab_ParamCtx[tab_DBConThread[nIndex].nIndex].ID;
  time(&nCurrTime);
  if (tab_DBConThread[nIndex].nExpiryTime < nCurrTime) {
    sprintf(sLine,"End   ProcessDBConRequest(TOOLATE) for ctx %d",
            (ulong)(uint)tab_DBConThread[nIndex].nIndex);
    trace_event(sLine,1);
    return 0;
  }
  nIndexCtx = tab_DBConThread[nIndex].nIndex;
  iVar1 = ToFullTrace(nIndexCtx);
  if (iVar1 == 0) {
    trace_event("Start DBConDoRefresh()",5);
  }
  time(&start_time);
  iVar1 = RefreshDBConnection(nIndexCtx);
  time(&end_time);
  if (iVar1 != 0) {
    if (1 < end_time - start_time) {
      sprintf(sLine_1,"DB_CONN_REFRESH: Too much time to serve the request for ctx %d(%lu)",
              (ulong)nIndexCtx);
      trace_event(sLine_1,1);
      __mutex = (pthread_mutex_t *)&tab_DBConThread[nIndex].ResultMutex;
      iVar1 = pthread_mutex_lock(__mutex);
      if (iVar1 == 0x23) goto LAB_0043ae41;
      tab_DBConThread[nIndex].nConState = 3;
      goto LAB_0043acad;
    }
    sprintf(sLine_1,"DB_CONN_REFRESH: Refresh DB Connection by Exception for ctx %d",
            (ulong)nIndexCtx);
    trace_event(sLine_1,1);
    DeconnectOracle(nIndexCtx);
    FreeOracleCtx(nIndexCtx);
    AllocateOracleCtx(nIndexCtx);
    ConnectOracle(nIndexCtx);
  }
  iVar1 = ToFullTrace(nIndexCtx);
  if (iVar1 == 0) {
    trace_event("End   DBConDoRefresh(OK)",5);
  }
  __mutex = (pthread_mutex_t *)&tab_DBConThread[nIndex].ResultMutex;
  iVar1 = pthread_mutex_lock(__mutex);
  if (iVar1 == 0x23) {
LAB_0043ae41:
    trace_event("End   InfoDBConThread(EDEADLK)",1);
    return -1;
  }
  tab_DBConThread[nIndex].nConState = 2;
LAB_0043acad:
  if (tab_DBConThread[nIndex].nCtxState == 9) {
    sprintf(sLine,">>> Free Dropped ctx %d",(ulong)(uint)tab_DBConThread[nIndex].nIndex);
    trace_event(sLine,1);
    DeconnectOracleParamCtx(&ParamCtx);
    FreeOracleParamCtx(&ParamCtx);
  }
  pthread_cond_signal((pthread_cond_t *)&tab_DBConThread[nIndex].ResultCond);
  pthread_mutex_unlock(__mutex);
  if (tab_DBConThread[nIndex].nFullTrace == 0) {
    trace_event("End   ProcessDBConRequest(OK)",5);
  }
  return 0;
}



int CheckAndRefreshDBCon(int nIndexCtx,timeval lastTime)

{
  pthread_mutex_t *__mutex;
  uint uVar1;
  int iVar2;
  int iVar3;
  int *piVar4;
  time_t tVar5;
  pthread_t pVar6;
  uint *puVar7;
  char *__format;
  uint local_698;
  int local_694;
  timeval currTime;
  pthread_attr_t pattr;
  timespec maxTimeToServe;
  char sLine [1024];
  
  iVar2 = ToFullTrace(nIndexCtx);
  if (iVar2 == 0) {
    pVar6 = pthread_self();
    sprintf(sLine,"Start CheckAndRefreshDBCon(IdxCtx(%d), ThrId(%.08lu))",(ulong)(uint)nIndexCtx,
            pVar6);
    trace_event(sLine,5);
    local_694 = 0;
  }
  else {
    local_694 = -1;
  }
  gettimeofday((timeval *)&currTime,(__timezone_ptr_t)0x0);
  if (currTime.tv_sec - lastTime.tv_sec < 2) {
    return 0;
  }
  pthread_mutex_lock((pthread_mutex_t *)&TabMutex);
  iVar2 = nNbThreads;
  if (nNbThreads < 1) {
LAB_0043af06:
    pthread_attr_init((pthread_attr_t *)&pattr);
    piVar4 = (int *)malloc(4);
    *piVar4 = iVar2;
    iVar3 = pthread_create(&tab_DBConThread[iVar2].tid,(pthread_attr_t *)&pattr,thread_dbcon_refresh
                           ,piVar4);
    if (iVar3 < 0) {
      puVar7 = (uint *)__errno_location();
      fprintf(stderr,"pthread_create Error %d\n",(ulong)*puVar7);
      free(piVar4);
      local_698 = 0xffffffff;
    }
    else {
      nNbThreads = nNbThreads + 1;
      sprintf((char *)&maxTimeToServe,"End   CreateDBConThread(OK): nNbThreads(%d)");
      trace_event((char *)&maxTimeToServe,5);
      local_698 = iVar2;
    }
    tab_DBConThread[(int)local_698].nState = 2;
    pthread_mutex_unlock((pthread_mutex_t *)&TabMutex);
    sleep(1);
    trace_event("End   AllocDBConThread(OK): Creating thread",5);
  }
  else {
    local_698 = 0;
    piVar4 = &tab_DBConThread[1].nState;
    if (tab_DBConThread[0].nState == 1) {
      local_698 = 0;
    }
    else {
      do {
        local_698 = local_698 + 1;
        if (local_698 == nNbThreads) {
          if ((int)local_698 < 100) goto LAB_0043af06;
          pthread_mutex_unlock((pthread_mutex_t *)&TabMutex);
          trace_event("End   AllocDBConThread(NONE)",1);
          goto LAB_0043b17d;
        }
        iVar3 = *piVar4;
        piVar4 = piVar4 + 0x3a;
      } while (iVar3 != 1);
    }
    tab_DBConThread[(int)local_698].nState = 2;
    pthread_mutex_unlock((pthread_mutex_t *)&TabMutex);
  }
  if ((int)local_698 < 0) {
LAB_0043b17d:
    sprintf(sLine,">>>>> No thread available -> Self refresh for ctx %d",(ulong)(uint)nIndexCtx);
    trace_event(sLine,1);
    DeconnectOracle(nIndexCtx);
    FreeOracleCtx(nIndexCtx);
    AllocateOracleCtx(nIndexCtx);
    ConnectOracle(nIndexCtx);
  }
  else {
    __mutex = &tab_DBConThread[(int)local_698].ResultMutex;
    iVar2 = pthread_mutex_lock((pthread_mutex_t *)__mutex);
    if (iVar2 == 0x23) {
      trace_event("End   CheckAndRefreshDBCon(EDEADLK on ResultMutex)",1);
      return -1;
    }
    tVar5 = time((time_t *)0x0);
    maxTimeToServe.tv_sec = tVar5 + 2;
    maxTimeToServe.tv_nsec = 0;
    tab_DBConThread[(int)local_698].nConState = 1;
    tab_DBConThread[(int)local_698].nCtxState = 0;
    tab_DBConThread[(int)local_698].nIndex = nIndexCtx;
    tab_DBConThread[(int)local_698].nExpiryTime = maxTimeToServe.tv_sec;
    pVar6 = pthread_self();
    tab_DBConThread[(int)local_698].nThreadId = pVar6;
    tab_DBConThread[(int)local_698].nFullTrace = local_694;
    InfoDBConThread(local_698);
    do {
      uVar1 = tab_DBConThread[(int)local_698].nConState;
      if (uVar1 != 1) goto joined_r0x0043b217;
      iVar2 = pthread_cond_timedwait
                        ((pthread_cond_t *)&tab_DBConThread[(int)local_698].ResultCond,
                         (pthread_mutex_t *)__mutex,(timespec *)&maxTimeToServe);
      if (iVar2 == 0x6e) {
        uVar1 = tab_DBConThread[(int)local_698].nConState;
        __format = "DB_CONN_REFRESH: TIMEOUT ON REFRESH for ctx %d(%d)(%d)";
        goto LAB_0043b1f2;
      }
    } while (iVar2 == 0);
    uVar1 = tab_DBConThread[(int)local_698].nConState;
    __format = "DB_CONN_REFRESH: ERROR WAIT ON REFRESH for ctx %d(%d)(%d)";
LAB_0043b1f2:
    sprintf(sLine,__format,(ulong)(uint)nIndexCtx,(ulong)uVar1,(ulong)local_698);
    trace_event(sLine,1);
    uVar1 = tab_DBConThread[(int)local_698].nConState;
joined_r0x0043b217:
    if ((uVar1 & 0xfffffffd) == 1) {
      sprintf(sLine,">>>>> External process failed to refresh -> local refresh for ctx %d(%d)(%d)",
              (ulong)(uint)nIndexCtx,(ulong)uVar1,(ulong)local_698);
      trace_event(sLine,1);
      AllocateOracleCtx(nIndexCtx);
      ConnectOracle(nIndexCtx);
      tab_DBConThread[(int)local_698].nCtxState = 9;
    }
    else if ((uVar1 == 2) && (tab_DBConThread[(int)local_698].nFullTrace == 0)) {
      sprintf(sLine,">>> Refresh Success %d(used %d)",(ulong)(uint)nIndexCtx,(ulong)local_698);
      trace_event(sLine,1);
    }
    tab_DBConThread[(int)local_698].nConState = 0;
    pthread_mutex_unlock((pthread_mutex_t *)__mutex);
  }
  if (local_694 == 0) {
    trace_event("End   CheckAndRefreshDBCon(OK)",5);
  }
  return 0;
}



// WARNING: Unknown calling convention

void * thread_dbcon_refresh(void *arg)

{
  int nIndex;
  pthread_t __th;
  int nIndiceCtx;
  
  trace_event(">>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>",4);
  trace_event("> Start thread_dbcon_refresh >>>>>>>>>>>>>>>>>>>>>>>>>>",4);
  trace_event(">>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>",4);
  __th = pthread_self();
  pthread_detach(__th);
                    // WARNING: Load size is inaccurate
  nIndex = *arg;
  free(arg);
  ThreadMaskSignals();
  do {
    WaitDBConRequest(nIndex);
    ProcessDBConRequest(nIndex);
    FreeDBConThread(nIndex);
  } while( true );
}



// WARNING: Unknown calling convention

void IniIsoPayFacDataTlv(TlvInfo *pkTlvInfo)

{
  pkTlvInfo->pkProperties = &ISSPayFacDataProp;
  ResetTlvInfo(pkTlvInfo);
  return;
}



// WARNING: Type propagation algorithm not settling
// WARNING: Unknown calling convention

void InitIsoIcTag(TSTagIso *msgInfo)

{
  ulong uVar1;
  int *piVar2;
  int *piVar3;
  TSTagIso *pTVar4;
  TSTagIso *pTVar5;
  char *pcVar6;
  char *pcVar7;
  int iVar8;
  uint uVar9;
  bool bVar11;
  ulong uVar10;
  
  piVar2 = msgInfo->nPosTag;
  uVar10 = 400;
  iVar8 = 400;
  bVar11 = ((ulong)piVar2 & 1) != 0;
  if (bVar11) {
    piVar2 = (int *)((long)msgInfo->nPosTag + 1);
    *(undefined1 *)msgInfo->nPosTag = 0;
    uVar10 = 399;
    iVar8 = 399;
  }
  if (((ulong)piVar2 & 2) == 0) {
    uVar9 = (uint)uVar10;
  }
  else {
    uVar9 = iVar8 - 2;
    uVar10 = (ulong)uVar9;
    *(undefined2 *)piVar2 = 0;
    piVar2 = (int *)((long)piVar2 + 2);
  }
  if (((ulong)piVar2 & 4) != 0) {
    *piVar2 = 0;
    uVar10 = (ulong)(uVar9 - 4);
    piVar2 = piVar2 + 1;
  }
  for (uVar1 = uVar10 >> 3; uVar1 != 0; uVar1 = uVar1 - 1) {
    piVar2[0] = 0;
    piVar2[1] = 0;
    piVar2 = piVar2 + 2;
  }
  if ((uVar10 & 4) != 0) {
    *piVar2 = 0;
    piVar2 = piVar2 + 1;
  }
  piVar3 = piVar2;
  if ((uVar10 & 2) != 0) {
    piVar3 = (int *)((long)piVar2 + 2);
    *(undefined2 *)piVar2 = 0;
  }
  if (bVar11) {
    *(undefined1 *)piVar3 = 0;
  }
  bVar11 = ((ulong)msgInfo & 1) != 0;
  uVar10 = 400;
  iVar8 = 400;
  if (bVar11) {
    pTVar4 = (TSTagIso *)((long)msgInfo->nPresent + 1);
    *(undefined1 *)msgInfo->nPresent = 0xff;
    uVar10 = 399;
    iVar8 = 399;
    uVar1 = (ulong)pTVar4 & 2;
  }
  else {
    uVar1 = (ulong)msgInfo & 2;
    pTVar4 = msgInfo;
  }
  if (uVar1 == 0) {
    uVar9 = (uint)uVar10;
  }
  else {
    uVar9 = iVar8 - 2;
    uVar10 = (ulong)uVar9;
    *(undefined2 *)pTVar4->nPresent = 0xffff;
    pTVar4 = (TSTagIso *)((long)pTVar4->nPresent + 2);
  }
  if (((ulong)pTVar4 & 4) != 0) {
    pTVar4->nPresent[0] = -1;
    uVar10 = (ulong)(uVar9 - 4);
    pTVar4 = (TSTagIso *)(pTVar4->nPresent + 1);
  }
  for (uVar1 = uVar10 >> 3; uVar1 != 0; uVar1 = uVar1 - 1) {
    pTVar4->nPresent[0] = -1;
    pTVar4->nPresent[1] = -1;
    pTVar4 = (TSTagIso *)(pTVar4->nPresent + 2);
  }
  if ((uVar10 & 4) != 0) {
    pTVar4->nPresent[0] = -1;
    pTVar4 = (TSTagIso *)(pTVar4->nPresent + 1);
  }
  pTVar5 = pTVar4;
  if ((uVar10 & 2) != 0) {
    pTVar5 = (TSTagIso *)((long)pTVar4->nPresent + 2);
    *(undefined2 *)pTVar4->nPresent = 0xffff;
  }
  if (bVar11) {
    *(undefined1 *)pTVar5->nPresent = 0xff;
  }
  pcVar7 = msgInfo->sChipData;
  msgInfo->nLength = 0;
  uVar10 = 999;
  iVar8 = 999;
  bVar11 = ((ulong)pcVar7 & 1) != 0;
  if (bVar11) {
    pcVar7 = msgInfo->sChipData + 1;
    msgInfo->sChipData[0] = '\0';
    uVar10 = 0x3e6;
    iVar8 = 0x3e6;
  }
  if (((ulong)pcVar7 & 2) == 0) {
    uVar9 = (uint)uVar10;
    pcVar6 = pcVar7;
  }
  else {
    pcVar6 = pcVar7 + 2;
    uVar9 = iVar8 - 2;
    uVar10 = (ulong)uVar9;
    pcVar7[0] = '\0';
    pcVar7[1] = '\0';
  }
  if (((ulong)pcVar6 & 4) != 0) {
    pcVar6[0] = '\0';
    pcVar6[1] = '\0';
    pcVar6[2] = '\0';
    pcVar6[3] = '\0';
    uVar10 = (ulong)(uVar9 - 4);
    pcVar6 = pcVar6 + 4;
  }
  for (uVar1 = uVar10 >> 3; uVar1 != 0; uVar1 = uVar1 - 1) {
    pcVar6[0] = '\0';
    pcVar6[1] = '\0';
    pcVar6[2] = '\0';
    pcVar6[3] = '\0';
    pcVar6[4] = '\0';
    pcVar6[5] = '\0';
    pcVar6[6] = '\0';
    pcVar6[7] = '\0';
    pcVar6 = pcVar6 + 8;
  }
  if ((uVar10 & 4) != 0) {
    pcVar6[0] = '\0';
    pcVar6[1] = '\0';
    pcVar6[2] = '\0';
    pcVar6[3] = '\0';
    pcVar6 = pcVar6 + 4;
  }
  pcVar7 = pcVar6;
  if ((uVar10 & 2) != 0) {
    pcVar7 = pcVar6 + 2;
    pcVar6[0] = '\0';
    pcVar6[1] = '\0';
  }
  if (!bVar11) {
    *pcVar7 = '\0';
  }
  return;
}



// WARNING: Type propagation algorithm not settling
// WARNING: Unknown calling convention

void InitIsoInfo(TSIsoInfo *msgInfo)

{
  ulong uVar1;
  TSIsoInfo *pTVar2;
  TSIsoInfo *pTVar3;
  char *pcVar4;
  char *pcVar5;
  int iVar6;
  uint uVar7;
  bool bVar9;
  ulong uVar8;
  
  uVar8 = 0x204;
  iVar6 = 0x204;
  bVar9 = ((ulong)msgInfo & 1) != 0;
  if (bVar9) {
    pTVar3 = (TSIsoInfo *)((long)msgInfo->nFieldPos + 1);
    *(undefined1 *)msgInfo->nFieldPos = 0;
    uVar8 = 0x203;
    iVar6 = 0x203;
    uVar1 = (ulong)pTVar3 & 2;
  }
  else {
    uVar1 = (ulong)msgInfo & 2;
    pTVar3 = msgInfo;
  }
  if (uVar1 == 0) {
    uVar7 = (uint)uVar8;
    pTVar2 = pTVar3;
  }
  else {
    pTVar2 = (TSIsoInfo *)((long)pTVar3->nFieldPos + 2);
    uVar7 = iVar6 - 2;
    uVar8 = (ulong)uVar7;
    *(undefined2 *)pTVar3->nFieldPos = 0;
  }
  if (((ulong)pTVar2 & 4) != 0) {
    pTVar2->nFieldPos[0] = 0;
    uVar8 = (ulong)(uVar7 - 4);
    pTVar2 = (TSIsoInfo *)(pTVar2->nFieldPos + 1);
  }
  for (uVar1 = uVar8 >> 3; uVar1 != 0; uVar1 = uVar1 - 1) {
    pTVar2->nFieldPos[0] = 0;
    pTVar2->nFieldPos[1] = 0;
    pTVar2 = (TSIsoInfo *)(pTVar2->nFieldPos + 2);
  }
  if ((uVar8 & 4) != 0) {
    pTVar2->nFieldPos[0] = 0;
    pTVar2 = (TSIsoInfo *)(pTVar2->nFieldPos + 1);
  }
  pTVar3 = pTVar2;
  if ((uVar8 & 2) != 0) {
    pTVar3 = (TSIsoInfo *)((long)pTVar2->nFieldPos + 2);
    *(undefined2 *)pTVar2->nFieldPos = 0;
  }
  if (bVar9) {
    *(undefined1 *)pTVar3->nFieldPos = 0;
  }
  pcVar4 = msgInfo->sData;
  msgInfo->sBitMap[0] = '\0';
  msgInfo->sBitMap[1] = '\0';
  msgInfo->sBitMap[2] = '\0';
  msgInfo->sBitMap[3] = '\0';
  msgInfo->sBitMap[4] = '\0';
  msgInfo->sBitMap[5] = '\0';
  msgInfo->sBitMap[6] = '\0';
  msgInfo->sBitMap[7] = '\0';
  msgInfo->sBitMap[8] = '\0';
  msgInfo->sBitMap[9] = '\0';
  msgInfo->sBitMap[10] = '\0';
  msgInfo->sBitMap[0xb] = '\0';
  msgInfo->sBitMap[0xc] = '\0';
  msgInfo->sBitMap[0xd] = '\0';
  msgInfo->sBitMap[0xe] = '\0';
  msgInfo->sBitMap[0xf] = '\0';
  msgInfo->nLength = 0;
  msgInfo->nMsgType = 0;
  uVar8 = 0x800;
  iVar6 = 0x800;
  bVar9 = ((ulong)pcVar4 & 1) != 0;
  if (bVar9) {
    pcVar4 = msgInfo->sData + 1;
    msgInfo->sData[0] = '\0';
    uVar8 = 0x7ff;
    iVar6 = 0x7ff;
  }
  if (((ulong)pcVar4 & 2) == 0) {
    uVar7 = (uint)uVar8;
  }
  else {
    uVar7 = iVar6 - 2;
    uVar8 = (ulong)uVar7;
    pcVar4[0] = '\0';
    pcVar4[1] = '\0';
    pcVar4 = pcVar4 + 2;
  }
  if (((ulong)pcVar4 & 4) != 0) {
    pcVar4[0] = '\0';
    pcVar4[1] = '\0';
    pcVar4[2] = '\0';
    pcVar4[3] = '\0';
    uVar8 = (ulong)(uVar7 - 4);
    pcVar4 = pcVar4 + 4;
  }
  for (uVar1 = uVar8 >> 3; uVar1 != 0; uVar1 = uVar1 - 1) {
    pcVar4[0] = '\0';
    pcVar4[1] = '\0';
    pcVar4[2] = '\0';
    pcVar4[3] = '\0';
    pcVar4[4] = '\0';
    pcVar4[5] = '\0';
    pcVar4[6] = '\0';
    pcVar4[7] = '\0';
    pcVar4 = pcVar4 + 8;
  }
  if ((uVar8 & 4) != 0) {
    pcVar4[0] = '\0';
    pcVar4[1] = '\0';
    pcVar4[2] = '\0';
    pcVar4[3] = '\0';
    pcVar4 = pcVar4 + 4;
  }
  pcVar5 = pcVar4;
  if ((uVar8 & 2) != 0) {
    pcVar5 = pcVar4 + 2;
    pcVar4[0] = '\0';
    pcVar4[1] = '\0';
  }
  if (bVar9) {
    *pcVar5 = '\0';
  }
  return;
}



// WARNING: Unknown calling convention

int GetIsoFieldType(int field_no)

{
  return tab_IsoFldInfo[field_no].type;
}



// WARNING: Unknown calling convention

int GetIsoFieldLength(int field_no)

{
  return tab_IsoFldInfo[field_no].length;
}



// WARNING: Unknown calling convention

int GetIsoTagIndice(char *szTagName)

{
  int iVar1;
  int iVar2;
  tag_info_t *__s2;
  
  __s2 = tab_IsoTagInfo;
  iVar2 = 0;
  do {
    iVar1 = memcmp(szTagName,__s2,4);
    if (iVar1 == 0) {
      return iVar2;
    }
    iVar2 = iVar2 + 1;
    __s2 = __s2 + 1;
  } while (iVar2 != 0x27);
  return -1;
}



// WARNING: Unknown calling convention

int GetIsoTagType(int nIndice)

{
  return tab_IsoTagInfo[nIndice].nType;
}



// WARNING: Unknown calling convention

int GetIsoTagLength(int nIndice)

{
  return tab_IsoTagInfo[nIndice].nLength;
}



// WARNING: Unknown calling convention

int AnalyseIso(char *buffer_rec,TSIsoInfo *msgInfo)

{
  char cVar1;
  bool bVar2;
  int *piVar3;
  undefined2 uVar4;
  int iVar5;
  uint uVar6;
  int iVar7;
  long lVar8;
  int *piVar9;
  uint uVar10;
  uint uVar11;
  int iVar12;
  TSIsoInfo *pTVar13;
  int iVar14;
  char *local_60;
  char szIsoFldLen [4];
  char szIsoMsgType [5];
  
  InitIsoInfo(msgInfo);
  szIsoMsgType._0_4_ = *(undefined4 *)buffer_rec;
  szIsoMsgType[4] = '\0';
  lVar8 = strtol(szIsoMsgType,(char **)0x0,10);
  msgInfo->nMsgType = (int)lVar8;
  cVar1 = buffer_rec[4];
  iVar14 = ((int)buffer_rec[4] >> 0x1f & 0x40U) + 0x40;
  memcpy(msgInfo->sBitMap,buffer_rec + 4,8);
  local_60 = buffer_rec + 0xc;
  memcpy(msgInfo->sData,local_60,((long)cVar1 >> 0x3f & 0xfffffffffffffff8U) + 0x7f4);
  pTVar13 = msgInfo;
  iVar12 = 1;
  do {
    while( true ) {
      iVar7 = iVar12 + -1;
      szIsoFldLen[0] = '\0';
      szIsoFldLen[1] = '\0';
      szIsoFldLen[2] = '\0';
      szIsoFldLen[3] = '\0';
      iVar5 = CheckBit(msgInfo->sBitMap,iVar7);
      if (iVar5 == 0) break;
      iVar5 = GetIsoFieldType(iVar7);
      uVar4 = szIsoFldLen._2_2_;
      switch(iVar5) {
      case 0:
        iVar7 = GetIsoFieldLength(iVar7);
        iVar7 = (iVar7 + 1) / 2;
        break;
      case 1:
      case 2:
        iVar7 = GetIsoFieldLength(iVar7);
        break;
      case 3:
        szIsoFldLen._0_2_ = *(undefined2 *)local_60;
        szIsoFldLen = (char  [4])CONCAT22(uVar4,szIsoFldLen._0_2_);
        lVar8 = strtol(szIsoFldLen,(char **)0x0,10);
        iVar7 = ((int)lVar8 + 1) / 2 + 2;
        break;
      case 4:
      case 5:
        szIsoFldLen._0_2_ = *(undefined2 *)local_60;
        szIsoFldLen = (char  [4])CONCAT22(uVar4,szIsoFldLen._0_2_);
        lVar8 = strtol(szIsoFldLen,(char **)0x0,10);
        iVar7 = (int)lVar8 + 2;
        break;
      case 6:
        szIsoFldLen._0_3_ = *(undefined3 *)local_60;
        lVar8 = strtol(szIsoFldLen,(char **)0x0,10);
        iVar7 = ((int)lVar8 + 1) / 2 + 3;
        break;
      case 7:
      case 8:
        szIsoFldLen._0_3_ = *(undefined3 *)local_60;
        lVar8 = strtol(szIsoFldLen,(char **)0x0,10);
        iVar7 = (int)lVar8 + 3;
        break;
      default:
        pTVar13->nFieldPos[1] = pTVar13->nFieldPos[0];
        lVar8 = 0;
        goto LAB_0043b9fd;
      }
      lVar8 = (long)iVar7;
      pTVar13->nFieldPos[1] = pTVar13->nFieldPos[0] + iVar7;
LAB_0043b9fd:
      local_60 = local_60 + lVar8;
      pTVar13 = (TSIsoInfo *)(pTVar13->nFieldPos + 1);
      bVar2 = iVar14 <= iVar12;
      iVar12 = iVar12 + 1;
      if (bVar2) goto LAB_0043ba13;
    }
    piVar3 = pTVar13->nFieldPos;
    pTVar13 = (TSIsoInfo *)(pTVar13->nFieldPos + 1);
    pTVar13->nFieldPos[0] = *piVar3;
    bVar2 = iVar12 < iVar14;
    iVar12 = iVar12 + 1;
  } while (bVar2);
LAB_0043ba13:
  piVar3 = msgInfo->nFieldPos + iVar14;
  msgInfo->nLength = *piVar3;
  if (iVar14 != 0x80) {
    uVar11 = 0x80 - iVar14;
    if (uVar11 < 0xc) {
      do {
        iVar14 = iVar14 + 1;
        msgInfo->nFieldPos[iVar14] = *piVar3;
      } while (iVar14 != 0x80);
    }
    else {
      uVar10 = uVar11 >> 2;
      if (uVar10 != 0) {
        uVar6 = 0;
        piVar9 = msgInfo->nFieldPos + (long)iVar14 + 1;
        do {
          iVar12 = *piVar3;
          uVar6 = uVar6 + 1;
          *piVar9 = iVar12;
          piVar9[1] = iVar12;
          piVar9[2] = iVar12;
          piVar9[3] = iVar12;
          piVar9 = piVar9 + 4;
        } while (uVar6 < uVar10);
        iVar14 = iVar14 + uVar10 * 4;
        if (uVar11 == uVar10 * 4) {
          return 0;
        }
      }
      msgInfo->nFieldPos[iVar14 + 1] = *piVar3;
      if ((iVar14 != 0x7f) && (msgInfo->nFieldPos[iVar14 + 2] = *piVar3, iVar14 != 0x7e)) {
        msgInfo->nFieldPos[iVar14 + 3] = *piVar3;
      }
    }
  }
  return 0;
}



// WARNING: Unknown calling convention

int AnalyseIsoIc(char *buffer,int nLength,TSTagIso *tagInfo)

{
  int iVar1;
  int iVar2;
  int iVar3;
  long lVar4;
  char szTagName [5];
  
  trace_event("Start   AnalyseIsoIc()",5);
  szTagName[0] = '\0';
  szTagName[1] = '\0';
  szTagName[2] = '\0';
  szTagName[3] = '\0';
  szTagName[4] = '\0';
  InitIsoIcTag(tagInfo);
  tagInfo->nLength = nLength;
  iVar2 = 0;
  memcpy(tagInfo->sChipData,buffer,(long)nLength);
  if (0 < nLength) {
    do {
      builtin_strncpy(szTagName,"0000",4);
      szTagName[4] = '\0';
      if ((*buffer & 0x1fU) == 0x1f) {
        HexToAscii((uchar *)buffer,(uchar *)szTagName,4);
        lVar4 = 2;
        iVar3 = 3;
      }
      else {
        lVar4 = 1;
        iVar3 = 2;
        HexToAscii((uchar *)buffer,(uchar *)szTagName,2);
      }
      iVar1 = GetIsoTagIndice(szTagName);
      if (-1 < iVar1) {
        (tagInfo->nPresent + iVar1)[100] = iVar2;
        tagInfo->nPresent[iVar1] = 0;
      }
      iVar2 = iVar2 + iVar3 + (char)((byte *)buffer)[lVar4];
      buffer = (char *)((byte *)buffer + (iVar3 + (char)((byte *)buffer)[lVar4]));
    } while (iVar2 < nLength);
  }
  trace_event("End   AnalyseIsoIc()",5);
  return 0;
}



// WARNING: Unknown calling convention

int GetIsoField(int field_no,TSIsoInfo *msgInfo,char *data,int *nLength)

{
  undefined2 uVar1;
  int iVar2;
  int nLng;
  long lVar3;
  char *pcVar4;
  char szIsoFldLen [4];
  
  szIsoFldLen[0] = '\0';
  szIsoFldLen[1] = '\0';
  szIsoFldLen[2] = '\0';
  szIsoFldLen[3] = '\0';
  iVar2 = CheckBit(msgInfo->sBitMap,field_no);
  if (iVar2 == 0) {
    return -1;
  }
  iVar2 = GetIsoFieldType(field_no);
  uVar1 = szIsoFldLen._2_2_;
  switch(iVar2) {
  case 0:
    nLng = GetIsoFieldLength(field_no);
    HexToAscii((uchar *)(msgInfo->sData + msgInfo->nFieldPos[field_no]),(uchar *)data,nLng);
    data[nLng] = '\0';
    *nLength = nLng;
    break;
  case 1:
  case 2:
    iVar2 = GetIsoFieldLength(field_no);
    memcpy(data,msgInfo->sData + msgInfo->nFieldPos[field_no],(long)iVar2);
    data[iVar2] = '\0';
    *nLength = iVar2;
    iVar2 = 0;
    break;
  case 3:
    szIsoFldLen._0_2_ = *(undefined2 *)(msgInfo->sData + msgInfo->nFieldPos[field_no]);
    szIsoFldLen = (char  [4])CONCAT22(uVar1,szIsoFldLen._0_2_);
    lVar3 = strtol(szIsoFldLen,(char **)0x0,10);
    iVar2 = (int)lVar3;
    pcVar4 = msgInfo->sData + (long)msgInfo->nFieldPos[field_no] + 2;
    goto LAB_0043bef3;
  case 4:
    szIsoFldLen._0_2_ = *(undefined2 *)(msgInfo->sData + msgInfo->nFieldPos[field_no]);
    szIsoFldLen = (char  [4])CONCAT22(uVar1,szIsoFldLen._0_2_);
    lVar3 = strtol(szIsoFldLen,(char **)0x0,10);
    iVar2 = (int)lVar3;
    pcVar4 = msgInfo->sData + (long)msgInfo->nFieldPos[field_no] + 2;
    goto LAB_0043bdc0;
  case 5:
    szIsoFldLen._0_2_ = *(undefined2 *)(msgInfo->sData + msgInfo->nFieldPos[field_no]);
    szIsoFldLen = (char  [4])CONCAT22(uVar1,szIsoFldLen._0_2_);
    lVar3 = strtol(szIsoFldLen,(char **)0x0,10);
    memcpy(data,msgInfo->sData + (long)msgInfo->nFieldPos[field_no] + 2,(long)(int)lVar3);
    *nLength = (int)lVar3;
    iVar2 = 0;
    break;
  case 6:
    szIsoFldLen._0_3_ = *(undefined3 *)(msgInfo->sData + msgInfo->nFieldPos[field_no]);
    lVar3 = strtol(szIsoFldLen,(char **)0x0,10);
    iVar2 = (int)lVar3;
    pcVar4 = msgInfo->sData + (long)msgInfo->nFieldPos[field_no] + 3;
LAB_0043bef3:
    HexToAscii((uchar *)pcVar4,(uchar *)data,iVar2);
    data[iVar2] = '\0';
    *nLength = iVar2;
    iVar2 = 0;
    break;
  case 7:
    szIsoFldLen._0_3_ = *(undefined3 *)(msgInfo->sData + msgInfo->nFieldPos[field_no]);
    lVar3 = strtol(szIsoFldLen,(char **)0x0,10);
    iVar2 = (int)lVar3;
    pcVar4 = msgInfo->sData + (long)msgInfo->nFieldPos[field_no] + 3;
LAB_0043bdc0:
    memcpy(data,pcVar4,(long)iVar2);
    data[iVar2] = '\0';
    *nLength = iVar2;
    iVar2 = 0;
    break;
  case 8:
    szIsoFldLen._0_3_ = *(undefined3 *)(msgInfo->sData + msgInfo->nFieldPos[field_no]);
    lVar3 = strtol(szIsoFldLen,(char **)0x0,10);
    memcpy(data,msgInfo->sData + (long)msgInfo->nFieldPos[field_no] + 3,(long)(int)lVar3);
    *nLength = (int)lVar3;
    iVar2 = 0;
    break;
  default:
    iVar2 = -1;
  }
  return iVar2;
}



// WARNING: Unknown calling convention

int AddIsoField(int field_no,TSIsoInfo *msgInfo,char *data,int nLength)

{
  char *cPtr;
  int iVar1;
  uint uVar2;
  int iVar3;
  uint uVar4;
  uint uVar5;
  uint uVar6;
  int *piVar7;
  char szIsoFldLen [5];
  
  cPtr = msgInfo->sBitMap;
  szIsoFldLen[0] = '\0';
  szIsoFldLen[1] = '\0';
  szIsoFldLen[2] = '\0';
  szIsoFldLen[3] = '\0';
  iVar1 = CheckBit(cPtr,field_no);
  if (iVar1 != 0) {
LAB_0043c1f6:
    return -1;
  }
  msgInfo->nFieldPos[field_no] = msgInfo->nLength;
  iVar1 = GetIsoFieldType(field_no);
  switch(iVar1) {
  case 0:
    iVar1 = GetIsoFieldLength(field_no);
    if (iVar1 != nLength) {
      return -1;
    }
    iVar1 = msgInfo->nLength;
    goto LAB_0043c2a6;
  case 1:
  case 2:
    iVar1 = GetIsoFieldLength(field_no);
    if (iVar1 != nLength) {
      return -1;
    }
    memcpy(msgInfo->sData + msgInfo->nLength,data,(long)nLength);
    goto LAB_0043c0b8;
  case 3:
    sprintf(szIsoFldLen,"%.2d",(ulong)(uint)nLength);
    *(undefined2 *)(msgInfo->sData + msgInfo->nLength) = szIsoFldLen._0_2_;
    iVar1 = msgInfo->nLength + 2;
    break;
  case 4:
  case 5:
    sprintf(szIsoFldLen,"%.2d",(ulong)(uint)nLength);
    *(undefined2 *)(msgInfo->sData + msgInfo->nLength) = szIsoFldLen._0_2_;
    iVar1 = msgInfo->nLength + 2;
    goto LAB_0043c09b;
  case 6:
    sprintf(szIsoFldLen,"%.3d",(ulong)(uint)nLength);
    iVar1 = msgInfo->nLength;
    *(undefined2 *)(msgInfo->sData + iVar1) = szIsoFldLen._0_2_;
    msgInfo->sData[(long)iVar1 + 2] = szIsoFldLen[2];
    iVar1 = msgInfo->nLength + 3;
    break;
  case 7:
  case 8:
    sprintf(szIsoFldLen,"%.3d",(ulong)(uint)nLength);
    iVar1 = msgInfo->nLength;
    *(undefined2 *)(msgInfo->sData + iVar1) = szIsoFldLen._0_2_;
    msgInfo->sData[(long)iVar1 + 2] = szIsoFldLen[2];
    iVar1 = msgInfo->nLength + 3;
LAB_0043c09b:
    msgInfo->nLength = iVar1;
    memcpy(msgInfo->sData + iVar1,data,(long)nLength);
    goto LAB_0043c0b8;
  default:
    goto LAB_0043c1f6;
  }
  msgInfo->nLength = iVar1;
LAB_0043c2a6:
  nLength = AsciiToHex((uchar *)data,(uchar *)(msgInfo->sData + iVar1),nLength);
LAB_0043c0b8:
  iVar1 = nLength + msgInfo->nLength;
  msgInfo->nLength = iVar1;
  if (field_no < 0x80) {
    uVar5 = 0x80 - field_no;
    uVar2 = -(((int)msgInfo + (field_no + 1) * 4 & 0xfU) >> 2) & 3;
    if (uVar5 < uVar2) {
      uVar2 = uVar5;
    }
    uVar4 = uVar5;
    if ((uVar5 < 7) || (uVar4 = uVar2, uVar2 != 0)) {
      iVar3 = field_no + 1;
      msgInfo->nFieldPos[iVar3] = iVar1;
      if (1 < uVar4) {
        iVar3 = field_no + 2;
        msgInfo->nFieldPos[iVar3] = iVar1;
        if (2 < uVar4) {
          iVar3 = field_no + 3;
          msgInfo->nFieldPos[iVar3] = iVar1;
          if (3 < uVar4) {
            iVar3 = field_no + 4;
            msgInfo->nFieldPos[iVar3] = iVar1;
            if (4 < uVar4) {
              iVar3 = field_no + 5;
              msgInfo->nFieldPos[iVar3] = iVar1;
              if (5 < uVar4) {
                iVar3 = field_no + 6;
                msgInfo->nFieldPos[iVar3] = iVar1;
              }
            }
          }
        }
      }
      if (uVar5 == uVar4) goto LAB_0043c1d7;
    }
    else {
      uVar4 = 0;
      iVar3 = field_no;
    }
    uVar2 = uVar5 - uVar4 >> 2;
    if (uVar2 != 0) {
      uVar6 = 0;
      piVar7 = msgInfo->nFieldPos + (long)field_no + (ulong)uVar4 + 1;
      do {
        uVar6 = uVar6 + 1;
        *piVar7 = iVar1;
        piVar7[1] = iVar1;
        piVar7[2] = iVar1;
        piVar7[3] = iVar1;
        piVar7 = piVar7 + 4;
      } while (uVar6 < uVar2);
      iVar3 = iVar3 + uVar2 * 4;
      if (uVar5 - uVar4 == uVar2 * 4) goto LAB_0043c1d7;
    }
    msgInfo->nFieldPos[iVar3 + 1] = iVar1;
    if ((iVar3 + 1 < 0x80) && (msgInfo->nFieldPos[iVar3 + 2] = iVar1, iVar3 != 0x7e)) {
      msgInfo->nFieldPos[iVar3 + 3] = iVar1;
    }
  }
LAB_0043c1d7:
  SetBit(cPtr,field_no + 1);
  if (field_no - 0x41U < 0x3f) {
    SetBit(cPtr,1);
  }
  return 0;
}



// WARNING: Unknown calling convention

int InsertIsoField(int field_no,TSIsoInfo *msgInfo,char *data,int nLength)

{
  char *cPtr;
  int *piVar1;
  char acVar2 [4];
  int iVar3;
  size_t __n;
  long lVar4;
  int *piVar5;
  char *pcVar6;
  byte bVar7;
  size_t local_1448;
  char *local_1440;
  char szIsoFldLen [4];
  char szIsoData [999];
  char szWork [4096];
  
  bVar7 = 0;
  cPtr = msgInfo->sBitMap;
  szIsoFldLen[0] = '\0';
  szIsoFldLen[1] = '\0';
  szIsoFldLen[2] = '\0';
  szIsoFldLen[3] = '\0';
  iVar3 = CheckBit(cPtr,field_no);
  if (iVar3 != 0) {
LAB_0043c503:
    return -1;
  }
  iVar3 = GetIsoFieldType(field_no);
  switch(iVar3) {
  case 0:
    iVar3 = GetIsoFieldLength(field_no);
    if (iVar3 != nLength) {
      return -1;
    }
    iVar3 = AsciiToHex((uchar *)data,(uchar *)szIsoData,nLength);
    local_1448 = (size_t)iVar3;
    break;
  case 1:
  case 2:
    iVar3 = GetIsoFieldLength(field_no);
    if (iVar3 != nLength) {
      return -1;
    }
    local_1448 = (size_t)nLength;
    memcpy(szIsoData,data,local_1448);
    break;
  case 3:
    sprintf(szIsoFldLen,"%.2d",(ulong)(uint)nLength);
    acVar2 = szIsoFldLen;
    szIsoData[0] = szIsoFldLen[0];
    szIsoData[1] = szIsoFldLen[1];
    szIsoFldLen = acVar2;
    iVar3 = AsciiToHex((uchar *)data,(uchar *)(szIsoData + 2),nLength);
    iVar3 = iVar3 + 2;
    local_1448 = (size_t)iVar3;
    break;
  case 4:
    sprintf(szIsoFldLen,"%.2d",(ulong)(uint)nLength);
    acVar2 = szIsoFldLen;
    szIsoData[0] = szIsoFldLen[0];
    szIsoData[1] = szIsoFldLen[1];
    szIsoFldLen = acVar2;
    goto LAB_0043c5ec;
  case 5:
    sprintf(szIsoFldLen,"%.2d",(ulong)(uint)nLength);
    acVar2 = szIsoFldLen;
    szIsoData[0] = szIsoFldLen[0];
    szIsoData[1] = szIsoFldLen[1];
    szIsoFldLen = acVar2;
LAB_0043c5ec:
    iVar3 = nLength + 2;
    memcpy(szIsoData + 2,data,(long)nLength);
    local_1448 = (size_t)iVar3;
    break;
  case 6:
    sprintf(szIsoFldLen,"%.3d",(ulong)(uint)nLength);
    acVar2 = szIsoFldLen;
    szIsoData[0] = szIsoFldLen[0];
    szIsoData[1] = szIsoFldLen[1];
    szIsoFldLen[2] = acVar2[2];
    szIsoData[2] = szIsoFldLen[2];
    szIsoFldLen = acVar2;
    iVar3 = AsciiToHex((uchar *)data,(uchar *)(szIsoData + 3),nLength);
    iVar3 = iVar3 + 3;
    local_1448 = (size_t)iVar3;
    break;
  case 7:
  case 8:
    iVar3 = nLength + 3;
    sprintf(szIsoFldLen,"%.3d",(ulong)(uint)nLength);
    acVar2 = szIsoFldLen;
    szIsoData[0] = szIsoFldLen[0];
    szIsoData[1] = szIsoFldLen[1];
    szIsoFldLen[2] = acVar2[2];
    szIsoData[2] = szIsoFldLen[2];
    szIsoFldLen = acVar2;
    memcpy(szIsoData + 3,data,(long)nLength);
    local_1448 = (size_t)iVar3;
    break;
  default:
    goto LAB_0043c503;
  }
  local_1440 = szIsoData;
  pcVar6 = szWork;
  for (lVar4 = 0x200; lVar4 != 0; lVar4 = lVar4 + -1) {
    pcVar6[0] = '\0';
    pcVar6[1] = '\0';
    pcVar6[2] = '\0';
    pcVar6[3] = '\0';
    pcVar6[4] = '\0';
    pcVar6[5] = '\0';
    pcVar6[6] = '\0';
    pcVar6[7] = '\0';
    pcVar6 = pcVar6 + (ulong)bVar7 * -0x10 + 8;
  }
  piVar1 = msgInfo->nFieldPos + (field_no + 1);
  __n = (size_t)(msgInfo->nLength - *piVar1);
  memcpy(szWork,msgInfo->sData + *piVar1,__n);
  if (field_no < 0x7f) {
    piVar5 = msgInfo->nFieldPos + 0x80;
    do {
      *piVar5 = *piVar5 + iVar3;
      piVar5 = piVar5 + -1;
    } while (piVar5 != (int *)((long)msgInfo + (ulong)(0x7e - field_no) * -4 + 0x1fc));
  }
  memcpy(msgInfo->sData + msgInfo->nFieldPos[field_no],local_1440,local_1448);
  *piVar1 = *piVar1 + iVar3;
  msgInfo->nLength = msgInfo->nLength + iVar3;
  SetBit(cPtr,field_no + 1);
  memcpy(msgInfo->sData + *piVar1,szWork,__n);
  if (field_no - 0x41U < 0x3f) {
    SetBit(cPtr,1);
  }
  return 0;
}



// WARNING: Unknown calling convention

int PutIsoField(int field_no,TSIsoInfo *msgInfo,char *data,int nLength)

{
  char *cPtr;
  int *piVar1;
  char acVar2 [4];
  int iVar3;
  int iVar4;
  int *piVar5;
  long lVar6;
  char *pcVar7;
  size_t __n;
  byte bVar8;
  int local_144c;
  size_t local_1448;
  char *local_1440;
  char szIsoFldLen [4];
  char szIsoData [999];
  char szWork [4096];
  
  bVar8 = 0;
  cPtr = msgInfo->sBitMap;
  szIsoFldLen[0] = '\0';
  szIsoFldLen[1] = '\0';
  szIsoFldLen[2] = '\0';
  szIsoFldLen[3] = '\0';
  iVar3 = CheckBit(cPtr,field_no);
  if (iVar3 == 0) {
    iVar3 = InsertIsoField(field_no,msgInfo,data,nLength);
    return iVar3;
  }
  iVar4 = GetIsoFieldType(field_no);
  iVar3 = -1;
  switch(iVar4) {
  case 0:
    iVar3 = GetIsoFieldLength(field_no);
    if (iVar3 != nLength) {
      return -1;
    }
    local_144c = AsciiToHex((uchar *)data,(uchar *)szIsoData,nLength);
    local_1448 = (size_t)local_144c;
    break;
  case 1:
  case 2:
    local_144c = GetIsoFieldLength(field_no);
    if (local_144c != nLength) {
      return -1;
    }
    local_1448 = (size_t)nLength;
    memcpy(szIsoData,data,local_1448);
    break;
  case 3:
    sprintf(szIsoFldLen,"%.2d",(ulong)(uint)nLength);
    acVar2 = szIsoFldLen;
    szIsoData[0] = szIsoFldLen[0];
    szIsoData[1] = szIsoFldLen[1];
    szIsoFldLen = acVar2;
    local_144c = AsciiToHex((uchar *)data,(uchar *)(szIsoData + 2),nLength);
    local_144c = local_144c + 2;
    local_1448 = (size_t)local_144c;
    break;
  case 4:
  case 5:
    sprintf(szIsoFldLen,"%.2d",(ulong)(uint)nLength);
    acVar2 = szIsoFldLen;
    szIsoData[0] = szIsoFldLen[0];
    szIsoData[1] = szIsoFldLen[1];
    szIsoFldLen = acVar2;
    memcpy(szIsoData + 2,data,(long)nLength);
    local_144c = nLength + 2;
    local_1448 = (size_t)local_144c;
    break;
  case 6:
    sprintf(szIsoFldLen,"%.3d",(ulong)(uint)nLength);
    acVar2 = szIsoFldLen;
    szIsoData[0] = szIsoFldLen[0];
    szIsoData[1] = szIsoFldLen[1];
    szIsoFldLen[2] = acVar2[2];
    szIsoData[2] = szIsoFldLen[2];
    szIsoFldLen = acVar2;
    local_144c = AsciiToHex((uchar *)data,(uchar *)(szIsoData + 3),nLength);
    local_144c = local_144c + 3;
    local_1448 = (size_t)local_144c;
    break;
  case 7:
  case 8:
    sprintf(szIsoFldLen,"%.3d",(ulong)(uint)nLength);
    acVar2 = szIsoFldLen;
    szIsoData[0] = szIsoFldLen[0];
    szIsoData[1] = szIsoFldLen[1];
    szIsoFldLen[2] = acVar2[2];
    szIsoData[2] = szIsoFldLen[2];
    szIsoFldLen = acVar2;
    memcpy(szIsoData + 3,data,(long)nLength);
    local_144c = nLength + 3;
    local_1448 = (size_t)local_144c;
    break;
  default:
    goto switchD_0043c745_default;
  }
  local_1440 = szIsoData;
  piVar1 = msgInfo->nFieldPos + (field_no + 1);
  iVar3 = *piVar1;
  iVar4 = msgInfo->nFieldPos[field_no];
  __n = (size_t)(msgInfo->nLength - iVar3);
  pcVar7 = szWork;
  for (lVar6 = 0x200; lVar6 != 0; lVar6 = lVar6 + -1) {
    pcVar7[0] = '\0';
    pcVar7[1] = '\0';
    pcVar7[2] = '\0';
    pcVar7[3] = '\0';
    pcVar7[4] = '\0';
    pcVar7[5] = '\0';
    pcVar7[6] = '\0';
    pcVar7[7] = '\0';
    pcVar7 = pcVar7 + (ulong)bVar8 * -0x10 + 8;
  }
  memcpy(szWork,msgInfo->sData + iVar3,__n);
  local_144c = local_144c - (iVar3 - iVar4);
  if (field_no < 0x7f) {
    piVar5 = msgInfo->nFieldPos + 0x80;
    do {
      *piVar5 = *piVar5 + local_144c;
      piVar5 = piVar5 + -1;
    } while (piVar5 != (int *)((long)msgInfo + (ulong)(0x7e - field_no) * -4 + 0x1fc));
    iVar4 = msgInfo->nFieldPos[field_no];
  }
  memcpy(msgInfo->sData + iVar4,local_1440,local_1448);
  *piVar1 = *piVar1 + local_144c;
  msgInfo->nLength = msgInfo->nLength + local_144c;
  SetBit(cPtr,field_no + 1);
  memcpy(msgInfo->sData + *piVar1,szWork,__n);
  iVar3 = 0;
  if (field_no - 0x41U < 0x3f) {
    SetBit(cPtr,1);
    iVar3 = 0;
  }
switchD_0043c745_default:
  return iVar3;
}



// WARNING: Unknown calling convention

int IsoBuildMsg(char *buffer_snd,TSIsoInfo *msgInfo)

{
  char cVar1;
  char szMsgType [5];
  
  sprintf(szMsgType,"%.4d",(ulong)(uint)msgInfo->nMsgType);
  *(undefined4 *)buffer_snd = szMsgType._0_4_;
  cVar1 = msgInfo->sBitMap[0];
  memcpy(buffer_snd + 4,msgInfo->sBitMap,8);
  memcpy(buffer_snd + 0xc,msgInfo->sData,(long)msgInfo->nLength);
  return msgInfo->nLength + ((int)cVar1 >> 0x1f & 8U) + 0xc;
}



// WARNING: Unknown calling convention

int GetIsoIcTag(char *tag_name,TSTagIso *tagInfo,char *data,int *length)

{
  int *piVar1;
  int iVar2;
  ulong uVar3;
  int iVar4;
  char sLine [512];
  
  iVar2 = GetIsoTagIndice(tag_name);
  if (iVar2 == -1) {
    sprintf(sLine,"==> tag_name=[%s], not present",tag_name);
    trace_event(sLine,0);
    iVar4 = -1;
  }
  else {
    piVar1 = tagInfo->nPresent + iVar2;
    iVar4 = *piVar1;
    if (iVar4 != -1) {
      uVar3 = (ulong)((tagInfo->sChipData[piVar1[100]] & 0x1fU) == 0x1f);
      *length = (uint)(byte)tagInfo->sChipData[uVar3 + (long)piVar1[100] + 1];
      iVar2 = GetIsoTagType(iVar2);
      switch(iVar2) {
      case 0:
      case 4:
        iVar4 = 0;
        memcpy(data,tagInfo->sChipData + uVar3 + (long)piVar1[100] + 2,(long)*length);
        break;
      case 1:
      case 5:
        iVar2 = memcmp(tag_name,&DAT_004a7626,4);
        if (iVar2 == 0) {
          memcpy(data,tagInfo->sChipData + uVar3 + (long)piVar1[100] + 2,(long)*length);
          iVar4 = 0;
          if (*data == '\0') {
            HexToAscii((uchar *)(tagInfo->sChipData + uVar3 + (long)piVar1[100] + 2),(uchar *)data,8
                      );
            sprintf(sLine,">9F1E=[%s]",data);
            trace_event(sLine,0);
          }
        }
        else {
          iVar4 = 0;
          memcpy(data,tagInfo->sChipData + uVar3 + (long)piVar1[100] + 2,(long)*length);
        }
        break;
      case 2:
      case 3:
        iVar4 = 0;
        BcdToAscii((uchar *)(tagInfo->sChipData + uVar3 + (long)piVar1[100] + 2),(uchar *)data,
                   *length * 2);
        *length = *length << 1;
        break;
      case 6:
        iVar4 = 0;
        HexToAscii((uchar *)(tagInfo->sChipData + uVar3 + (long)piVar1[100] + 2),(uchar *)data,
                   *length * 2);
        *length = *length << 1;
        break;
      default:
        iVar4 = 0;
        sprintf(sLine,"==> DEFAULT !!!!!! WAHT TO DO ?! GetIsoIcTag %s ",tag_name);
        trace_event(sLine,0);
      }
    }
  }
  return iVar4;
}



// WARNING: Unknown calling convention

int AddIsoIcTag(char *tag_name,TSTagIso *tagInfo,char *data,int length)

{
  int *piVar1;
  int iVar2;
  int iVar3;
  ulong uVar4;
  int unaff_R14D;
  bool bVar5;
  
  iVar2 = GetIsoTagIndice(tag_name);
  if ((iVar2 != -1) && (piVar1 = tagInfo->nPresent + iVar2, *piVar1 != 0)) {
    AsciiToHex((uchar *)tag_name,(uchar *)(tagInfo->sChipData + tagInfo->nLength),4);
    bVar5 = (tagInfo->sChipData[tagInfo->nLength] & 0x1fU) == 0x1f;
    uVar4 = (ulong)bVar5;
    iVar3 = GetIsoTagType(iVar2);
    switch(iVar3) {
    case 0:
    case 4:
      unaff_R14D = GetIsoTagLength(iVar2);
      if (unaff_R14D != length) {
        return -1;
      }
      memcpy(tagInfo->sChipData + uVar4 + (long)tagInfo->nLength + 2,data,(long)length);
      break;
    case 1:
    case 5:
      memcpy(tagInfo->sChipData + uVar4 + (long)tagInfo->nLength + 2,data,(long)length);
      unaff_R14D = length;
      break;
    case 2:
      iVar2 = GetIsoTagLength(iVar2);
      if (iVar2 != length) {
        return -1;
      }
      unaff_R14D = AsciiToBcd((uchar *)data,
                              (uchar *)(tagInfo->sChipData + uVar4 + (long)tagInfo->nLength + 2),
                              length);
      break;
    case 3:
      unaff_R14D = AsciiToBcd((uchar *)data,
                              (uchar *)(tagInfo->sChipData + uVar4 + (long)tagInfo->nLength + 2),
                              length);
      break;
    case 6:
      unaff_R14D = AsciiToHex((uchar *)data,
                              (uchar *)(tagInfo->sChipData + uVar4 + (long)tagInfo->nLength + 2),
                              length);
    }
    iVar2 = tagInfo->nLength;
    tagInfo->sChipData[(long)iVar2 + uVar4 + 1] = (char)unaff_R14D;
    piVar1[100] = iVar2;
    *piVar1 = 0;
    tagInfo->nLength = iVar2 + bVar5 + 2 + unaff_R14D;
    return 0;
  }
  return -1;
}



// WARNING: Unknown calling convention

int PutIsoIcTag(char *tag_name,TSTagIso *tagInfo,char *data,int length)

{
  int *piVar1;
  int iVar2;
  int iVar3;
  long lVar4;
  long lVar5;
  int iVar6;
  bool bVar8;
  int local_444;
  int local_440;
  int local_430;
  int local_42c;
  char szLastPart [999];
  uint uVar7;
  
  iVar2 = GetIsoTagIndice(tag_name);
  if (iVar2 == -1) {
LAB_0043d23d:
    iVar2 = -1;
  }
  else {
    piVar1 = tagInfo->nPresent + iVar2;
    if (*piVar1 == 0) {
      local_430 = piVar1[100];
      local_444 = 0;
      lVar5 = (long)local_430;
    }
    else {
      local_430 = tagInfo->nLength;
      lVar5 = (long)local_430;
      AsciiToHex((uchar *)tag_name,(uchar *)(tagInfo->sChipData + lVar5),4);
      local_444 = -1;
    }
    bVar8 = (tagInfo->sChipData[lVar5] & 0x1fU) == 0x1f;
    lVar4 = (ulong)bVar8 + 1;
    uVar7 = (uint)bVar8;
    iVar6 = uVar7 + 1;
    if (local_444 == 0) {
      local_42c = (int)tagInfo->sChipData[lVar4 + lVar5];
      memcpy(szLastPart,
             tagInfo->sChipData + lVar4 + lVar5 + (long)tagInfo->sChipData[lVar4 + lVar5] + 1,
             (long)((((tagInfo->nLength - local_430) - iVar6) - local_42c) + -1));
    }
    iVar3 = GetIsoTagType(iVar2);
    switch(iVar3) {
    case 0:
    case 4:
      local_440 = GetIsoTagLength(iVar2);
      if (local_440 != length) goto LAB_0043d23d;
      memcpy(tagInfo->sChipData + lVar5 + lVar4 + 1,data,(long)length);
      break;
    case 1:
    case 5:
      memcpy(tagInfo->sChipData + lVar5 + lVar4 + 1,data,(long)length);
      local_440 = length;
      break;
    case 2:
      iVar3 = GetIsoTagLength(iVar2);
      if (iVar3 != length) goto LAB_0043d23d;
      local_440 = AsciiToBcd((uchar *)data,(uchar *)(tagInfo->sChipData + lVar5 + lVar4 + 1),length)
      ;
      break;
    case 3:
      local_440 = AsciiToBcd((uchar *)data,(uchar *)(tagInfo->sChipData + lVar5 + lVar4 + 1),length)
      ;
      break;
    case 6:
      local_440 = AsciiToHex((uchar *)data,(uchar *)(tagInfo->sChipData + lVar5 + lVar4 + 1),length)
      ;
    }
    tagInfo->sChipData[lVar4 + lVar5] = (char)local_440;
    if (local_444 == 0) {
      iVar2 = iVar2 + 1;
      memcpy(tagInfo->sChipData + lVar4 + lVar5 + (long)local_440 + 1,szLastPart,
             (long)((((tagInfo->nLength - local_430) - iVar6) - local_42c) + -1));
      tagInfo->nLength = tagInfo->nLength + (local_440 - local_42c);
      if (iVar2 < 100) {
        do {
          piVar1 = tagInfo->nPresent + iVar2;
          if (*piVar1 == 0) {
            piVar1[100] = piVar1[100] + (local_440 - local_42c);
          }
          iVar2 = iVar2 + 1;
        } while (iVar2 != 100);
      }
      iVar2 = 0;
    }
    else {
      iVar2 = tagInfo->nLength;
      *piVar1 = 0;
      piVar1[100] = iVar2;
      tagInfo->nLength = iVar2 + uVar7 + 2 + local_440;
      iVar2 = 0;
    }
  }
  return iVar2;
}



// WARNING: Unknown calling convention

int IsoBuildIcFld(char *buffer_snd,TSTagIso *tagInfo)

{
  memcpy(buffer_snd,tagInfo->sChipData,(long)tagInfo->nLength);
  return tagInfo->nLength;
}



// WARNING: Unknown calling convention

int SetLocalYear(char *szMerchantDateYYMMDD,char *szGmtDateYYMMDD)

{
  char *__s1;
  int iVar1;
  long lVar2;
  ulong uVar3;
  int sFristMonthDigit [2];
  char szGmtYear [12];
  char szLocalYear [12];
  
  __s1 = szMerchantDateYYMMDD + 2;
  szGmtYear[0] = '\0';
  szGmtYear[1] = '\0';
  szGmtYear[2] = '\0';
  szGmtYear[3] = '\0';
  szGmtYear[4] = '\0';
  szGmtYear[5] = '\0';
  szGmtYear[6] = '\0';
  szGmtYear[7] = '\0';
  szGmtYear[8] = '\0';
  szGmtYear[9] = '\0';
  szGmtYear[10] = '\0';
  szGmtYear[0xb] = '\0';
  szLocalYear[0] = '\0';
  szLocalYear[1] = '\0';
  szLocalYear[2] = '\0';
  szLocalYear[3] = '\0';
  szLocalYear[4] = '\0';
  szLocalYear[5] = '\0';
  szLocalYear[6] = '\0';
  szLocalYear[7] = '\0';
  szLocalYear[8] = '\0';
  szLocalYear[9] = '\0';
  szLocalYear[10] = '\0';
  szLocalYear[0xb] = '\0';
  sFristMonthDigit[0] = 0;
  sFristMonthDigit[1] = 0;
  iVar1 = memcmp(__s1,szGmtDateYYMMDD + 2,2);
  if (iVar1 == 0) {
LAB_0043d3b0:
    *(undefined2 *)szMerchantDateYYMMDD = *(undefined2 *)szGmtDateYYMMDD;
    return 0;
  }
  iVar1 = memcmp(__s1,"01",2);
  if (iVar1 != 0) {
    iVar1 = memcmp(__s1,&DAT_004d1f75,2);
    if (iVar1 != 0) goto LAB_0043d3b0;
  }
  sFristMonthDigit[0]._0_1_ = szGmtDateYYMMDD[2];
  szGmtYear._0_2_ = *(undefined2 *)szGmtDateYYMMDD;
  lVar2 = strtol((char *)sFristMonthDigit,(char **)0x0,10);
  iVar1 = memcmp(__s1,"01",2);
  if (iVar1 == 0) {
    if ((int)lVar2 == 1) {
      lVar2 = strtol(szGmtYear,(char **)0x0,10);
      sprintf(szLocalYear,"%.2d",(ulong)((int)lVar2 + 1));
      goto LAB_0043d364;
    }
  }
  else if ((int)lVar2 != 1) {
    lVar2 = strtol(szGmtYear,(char **)0x0,10);
    sprintf(szLocalYear,"%.2d",(ulong)((int)lVar2 - 1));
    goto LAB_0043d364;
  }
  uVar3 = strtol(szGmtYear,(char **)0x0,10);
  sprintf(szLocalYear,"%.2d",uVar3 & 0xffffffff);
LAB_0043d364:
  *(undefined2 *)szMerchantDateYYMMDD = szLocalYear._0_2_;
  return 0;
}



// WARNING: Type propagation algorithm not settling
// WARNING: Unknown calling convention

void ResetTlvInfo(TlvInfo *kTlvInfo)

{
  ulong uVar1;
  char *pcVar2;
  char *pcVar3;
  int *piVar4;
  int *piVar5;
  int (*paiVar6) [2];
  int (*paiVar7) [2];
  int iVar8;
  uint uVar9;
  bool bVar11;
  ulong uVar10;
  
  kTlvInfo->nLength = 0;
  kTlvInfo->nNextFreeRFPos = 0;
  pcVar3 = kTlvInfo->sData;
  uVar10 = 0x400;
  iVar8 = 0x400;
  bVar11 = ((ulong)pcVar3 & 1) != 0;
  if (bVar11) {
    pcVar3 = kTlvInfo->sData + 1;
    kTlvInfo->sData[0] = '\0';
    uVar10 = 0x3ff;
    iVar8 = 0x3ff;
  }
  if (((ulong)pcVar3 & 2) == 0) {
    uVar9 = (uint)uVar10;
    pcVar2 = pcVar3;
  }
  else {
    pcVar2 = (char *)((long)pcVar3 + 2);
    uVar9 = iVar8 - 2;
    uVar10 = (ulong)uVar9;
    *(undefined2 *)pcVar3 = 0;
  }
  if (((ulong)pcVar2 & 4) != 0) {
    pcVar2[0] = '\0';
    pcVar2[1] = '\0';
    pcVar2[2] = '\0';
    pcVar2[3] = '\0';
    uVar10 = (ulong)(uVar9 - 4);
    pcVar2 = pcVar2 + 4;
  }
  for (uVar1 = uVar10 >> 3; uVar1 != 0; uVar1 = uVar1 - 1) {
    pcVar2[0] = '\0';
    pcVar2[1] = '\0';
    pcVar2[2] = '\0';
    pcVar2[3] = '\0';
    pcVar2[4] = '\0';
    pcVar2[5] = '\0';
    pcVar2[6] = '\0';
    pcVar2[7] = '\0';
    pcVar2 = pcVar2 + 8;
  }
  if ((uVar10 & 4) != 0) {
    pcVar2[0] = '\0';
    pcVar2[1] = '\0';
    pcVar2[2] = '\0';
    pcVar2[3] = '\0';
    pcVar2 = pcVar2 + 4;
  }
  pcVar3 = pcVar2;
  if ((uVar10 & 2) != 0) {
    pcVar3 = pcVar2 + 2;
    pcVar2[0] = '\0';
    pcVar2[1] = '\0';
  }
  if (bVar11) {
    *pcVar3 = '\0';
  }
  piVar5 = kTlvInfo->nPresent;
  uVar10 = 0x804;
  iVar8 = 0x804;
  bVar11 = ((ulong)piVar5 & 1) != 0;
  if (bVar11) {
    piVar5 = (int *)((long)kTlvInfo->nPresent + 1);
    *(undefined1 *)kTlvInfo->nPresent = 0;
    uVar10 = 0x803;
    iVar8 = 0x803;
  }
  if (((ulong)piVar5 & 2) == 0) {
    uVar9 = (uint)uVar10;
  }
  else {
    uVar9 = iVar8 - 2;
    uVar10 = (ulong)uVar9;
    *(undefined2 *)piVar5 = 0;
    piVar5 = (int *)((long)piVar5 + 2);
  }
  if (((ulong)piVar5 & 4) != 0) {
    *piVar5 = 0;
    uVar10 = (ulong)(uVar9 - 4);
    piVar5 = piVar5 + 1;
  }
  for (uVar1 = uVar10 >> 3; uVar1 != 0; uVar1 = uVar1 - 1) {
    piVar5[0] = 0;
    piVar5[1] = 0;
    piVar5 = piVar5 + 2;
  }
  if ((uVar10 & 4) != 0) {
    *piVar5 = 0;
    piVar5 = piVar5 + 1;
  }
  piVar4 = piVar5;
  if ((uVar10 & 2) != 0) {
    piVar4 = (int *)((long)piVar5 + 2);
    *(undefined2 *)piVar5 = 0;
  }
  if (bVar11) {
    *(undefined1 *)piVar4 = 0;
  }
  piVar5 = kTlvInfo->nPosTlv;
  uVar10 = 0x804;
  iVar8 = 0x804;
  bVar11 = ((ulong)piVar5 & 1) != 0;
  if (bVar11) {
    piVar5 = (int *)((long)kTlvInfo->nPosTlv + 1);
    *(undefined1 *)kTlvInfo->nPosTlv = 0;
    uVar10 = 0x803;
    iVar8 = 0x803;
  }
  if (((ulong)piVar5 & 2) == 0) {
    uVar9 = (uint)uVar10;
  }
  else {
    uVar9 = iVar8 - 2;
    uVar10 = (ulong)uVar9;
    *(undefined2 *)piVar5 = 0;
    piVar5 = (int *)((long)piVar5 + 2);
  }
  if (((ulong)piVar5 & 4) != 0) {
    *piVar5 = 0;
    uVar10 = (ulong)(uVar9 - 4);
    piVar5 = piVar5 + 1;
  }
  for (uVar1 = uVar10 >> 3; uVar1 != 0; uVar1 = uVar1 - 1) {
    piVar5[0] = 0;
    piVar5[1] = 0;
    piVar5 = piVar5 + 2;
  }
  if ((uVar10 & 4) != 0) {
    *piVar5 = 0;
    piVar5 = piVar5 + 1;
  }
  piVar4 = piVar5;
  if ((uVar10 & 2) != 0) {
    piVar4 = (int *)((long)piVar5 + 2);
    *(undefined2 *)piVar5 = 0;
  }
  if (bVar11) {
    *(undefined1 *)piVar4 = 0;
  }
  paiVar6 = kTlvInfo->nRepeatedFieldPos;
  uVar10 = 0x200;
  iVar8 = 0x200;
  bVar11 = ((ulong)paiVar6 & 1) != 0;
  if (bVar11) {
    paiVar6 = (int (*) [2])((long)kTlvInfo->nRepeatedFieldPos[0] + 1);
    *(undefined1 *)kTlvInfo->nRepeatedFieldPos[0] = 0;
    uVar10 = 0x1ff;
    iVar8 = 0x1ff;
  }
  if (((ulong)paiVar6 & 2) == 0) {
    uVar9 = (uint)uVar10;
  }
  else {
    uVar9 = iVar8 - 2;
    uVar10 = (ulong)uVar9;
    *(undefined2 *)*paiVar6 = 0;
    paiVar6 = (int (*) [2])((long)*paiVar6 + 2);
  }
  if (((ulong)paiVar6 & 4) != 0) {
    (*paiVar6)[0] = 0;
    uVar10 = (ulong)(uVar9 - 4);
    paiVar6 = (int (*) [2])(*paiVar6 + 1);
  }
  for (uVar1 = uVar10 >> 3; uVar1 != 0; uVar1 = uVar1 - 1) {
    *paiVar6 = (int  [2])0x0;
    paiVar6 = paiVar6 + 1;
  }
  if ((uVar10 & 4) != 0) {
    (*paiVar6)[0] = 0;
    paiVar6 = (int (*) [2])(*paiVar6 + 1);
  }
  paiVar7 = paiVar6;
  if ((uVar10 & 2) != 0) {
    paiVar7 = (int (*) [2])((long)*paiVar6 + 2);
    *(undefined2 *)*paiVar6 = 0;
  }
  if (bVar11) {
    *(undefined1 *)*paiVar7 = 0;
  }
  return;
}



// WARNING: Unknown calling convention

int AnalyseTlvInfo(char *buffer_in,int nLength,TlvInfo *pkTlvInfo)

{
  long lVar1;
  int iVar2;
  ulong uVar3;
  int iVar4;
  uint uVar5;
  int iVar6;
  int iVar7;
  tlv_field_t *__s1;
  TlvInfoProperties *local_78;
  uchar *local_70;
  int local_64;
  char szTlvName [13];
  char szTlvValueLen [16];
  
  if (0x400 < (uint)nLength) {
    return -1;
  }
  pkTlvInfo->nLength = nLength;
  memcpy(pkTlvInfo->sData,buffer_in,(long)nLength);
  if (0 < pkTlvInfo->nLength) {
    local_78 = pkTlvInfo->pkProperties;
    local_64 = 0;
    local_70 = (uchar *)buffer_in;
    do {
      szTlvName[0] = '\0';
      szTlvName[1] = '\0';
      szTlvName[2] = '\0';
      szTlvName[3] = '\0';
      szTlvName[4] = '\0';
      szTlvName[5] = '\0';
      szTlvName[6] = '\0';
      szTlvName[7] = '\0';
      szTlvName[8] = '\0';
      szTlvName[9] = '\0';
      szTlvName[10] = '\0';
      szTlvName[0xb] = '\0';
      szTlvName[0xc] = '\0';
      szTlvValueLen[0] = '\0';
      szTlvValueLen[1] = '\0';
      szTlvValueLen[2] = '\0';
      szTlvValueLen[3] = '\0';
      szTlvValueLen[4] = '\0';
      szTlvValueLen[5] = '\0';
      szTlvValueLen[6] = '\0';
      szTlvValueLen[7] = '\0';
      szTlvValueLen[8] = '\0';
      szTlvValueLen[9] = '\0';
      szTlvValueLen[10] = '\0';
      szTlvValueLen[0xb] = '\0';
      szTlvValueLen[0xc] = '\0';
      szTlvValueLen[0xd] = '\0';
      szTlvValueLen[0xe] = '\0';
      szTlvValueLen[0xf] = '\0';
      if (local_78->eTagType == TLV_LT_BIN) {
        HexToAscii(local_70,(uchar *)szTlvName,local_78->nTagLen * 2);
        local_78 = pkTlvInfo->pkProperties;
      }
      else {
        memcpy(szTlvName,local_70,(long)local_78->nTagLen);
      }
      if (local_78->eLengthType == TLV_LT_BIN) {
        uVar5 = local_78->nLengthLen - 1;
        if ((int)uVar5 < 0) {
          iVar7 = 0;
        }
        else {
          uVar3 = 0;
          iVar4 = 1;
          iVar7 = 0;
          do {
            lVar1 = uVar3 + (long)local_78->nTagLen + (long)(int)uVar5;
            uVar3 = uVar3 - 1;
            iVar6 = (uint)local_70[lVar1] * iVar4;
            iVar4 = iVar4 << 8;
            iVar7 = iVar7 + iVar6;
          } while (uVar3 != ~(ulong)uVar5);
        }
      }
      else {
        memcpy(szTlvValueLen,local_70 + local_78->nTagLen,(long)local_78->nLengthLen);
        iVar7 = atoi(szTlvValueLen);
        local_78 = pkTlvInfo->pkProperties;
      }
      iVar4 = local_78->nNbFields;
      if (0 < iVar4) {
        __s1 = local_78->tabFieldsInfo;
        iVar6 = 0;
        do {
          iVar2 = strcmp(__s1->szTag,szTlvName);
          if (iVar2 == 0) {
            if (local_78->tabFieldsInfo[iVar6].field_info.nLength < iVar7) {
              return -1;
            }
            iVar4 = pkTlvInfo->nPresent[iVar6];
            if (iVar4 == 1) {
              pkTlvInfo->nPresent[iVar6] = 2;
              iVar4 = pkTlvInfo->nNextFreeRFPos;
              pkTlvInfo->nPosTlv[iVar6] = iVar4;
              pkTlvInfo->nRepeatedFieldPos[iVar4][0] = iVar4;
              pkTlvInfo->nRepeatedFieldPos[iVar4 + 1][0] = local_64;
              pkTlvInfo->nRepeatedFieldPos[iVar4 + 1][1] = 0;
              pkTlvInfo->nNextFreeRFPos = iVar4 + 2;
            }
            else if (iVar4 == 2) {
              iVar4 = pkTlvInfo->nPosTlv[iVar6];
              do {
                iVar6 = iVar4;
                iVar4 = pkTlvInfo->nRepeatedFieldPos[iVar6][1];
              } while (iVar4 != 0);
              iVar4 = pkTlvInfo->nNextFreeRFPos;
              pkTlvInfo->nRepeatedFieldPos[iVar6][1] = iVar4;
              pkTlvInfo->nRepeatedFieldPos[iVar4][0] = local_64;
              pkTlvInfo->nRepeatedFieldPos[iVar4][1] = 0;
              pkTlvInfo->nNextFreeRFPos = iVar4 + 1;
            }
            else if (iVar4 == 0) {
              pkTlvInfo->nPresent[iVar6] = 1;
              pkTlvInfo->nPosTlv[iVar6] = local_64;
            }
            break;
          }
          iVar6 = iVar6 + 1;
          __s1 = __s1 + 1;
        } while (iVar6 != iVar4);
      }
      iVar7 = iVar7 + local_78->nTagLen + local_78->nLengthLen;
      local_64 = local_64 + iVar7;
      local_70 = local_70 + iVar7;
    } while (local_64 < pkTlvInfo->nLength);
  }
  return 0;
}



// WARNING: Unknown calling convention

int GetTlvInfoNextField(char *tlv_name,TlvInfo *pkTlvInfo,char *data,int *nLength,int nIter)

{
  E_ALPHA_FORMAT EVar1;
  int iVar2;
  int iVar3;
  char *__nptr;
  long lVar4;
  ulong uVar5;
  int iVar6;
  uint uVar7;
  TlvInfoProperties *pTVar8;
  tlv_field_t *__s1;
  int iVar9;
  char *local_50;
  char szAscTlvLen [13];
  
  pTVar8 = pkTlvInfo->pkProperties;
  szAscTlvLen[8] = '\0';
  szAscTlvLen[9] = '\0';
  szAscTlvLen[10] = '\0';
  szAscTlvLen[0xb] = '\0';
  szAscTlvLen[0xc] = '\0';
  iVar3 = pTVar8->nNbFields;
  szAscTlvLen[0] = '\0';
  szAscTlvLen[1] = '\0';
  szAscTlvLen[2] = '\0';
  szAscTlvLen[3] = '\0';
  szAscTlvLen[4] = '\0';
  szAscTlvLen[5] = '\0';
  szAscTlvLen[6] = '\0';
  szAscTlvLen[7] = '\0';
  if (iVar3 < 1) {
    return -1;
  }
  __s1 = pTVar8->tabFieldsInfo;
  iVar9 = 0;
  while (iVar2 = strcmp(__s1->szTag,tlv_name), iVar2 != 0) {
    iVar9 = iVar9 + 1;
    __s1 = __s1 + 1;
    if (iVar9 == iVar3) {
      return -1;
    }
  }
  iVar3 = pkTlvInfo->nPresent[iVar9];
  if (iVar3 == 0) {
    return -1;
  }
  if (pTVar8->tabFieldsInfo[iVar9].eIsRepeatable == NOT_REPEATABLE) {
    if (iVar3 == 1) {
      local_50 = pkTlvInfo->sData + (long)pTVar8->nTagLen + (long)pkTlvInfo->nPosTlv[iVar9];
    }
  }
  else if (iVar3 == 1) {
    if (nIter != 0) {
      return -1;
    }
    local_50 = pkTlvInfo->sData + (long)pTVar8->nTagLen + (long)pkTlvInfo->nPosTlv[iVar9];
  }
  else if (iVar3 == 2) {
    lVar4 = (long)pkTlvInfo->nPosTlv[iVar9];
    if (nIter < 1) {
      if (nIter != 0) {
        return -1;
      }
    }
    else {
      iVar3 = pkTlvInfo->nRepeatedFieldPos[lVar4][1];
      if (iVar3 == 0) {
        return -1;
      }
      iVar2 = 0;
      while( true ) {
        lVar4 = (long)iVar3;
        iVar2 = iVar2 + 1;
        if (iVar2 == nIter) break;
        iVar3 = pkTlvInfo->nRepeatedFieldPos[lVar4][1];
        if (iVar3 == 0) {
          return -1;
        }
      }
    }
    local_50 = pkTlvInfo->sData +
               (long)pkTlvInfo->nRepeatedFieldPos[lVar4][0] + (long)pTVar8->nTagLen;
  }
  if (pTVar8->eTagType == TLV_LT_BIN) {
    *nLength = 0;
    uVar7 = pTVar8->nLengthLen - 1;
    if ((int)uVar7 < 0) {
      iVar3 = 0;
    }
    else {
      iVar3 = 0;
      uVar5 = 0;
      iVar2 = 1;
      do {
        lVar4 = uVar5 + (long)(int)uVar7;
        uVar5 = uVar5 - 1;
        iVar6 = (uint)(byte)local_50[lVar4] * iVar2;
        iVar2 = iVar2 << 8;
        iVar3 = iVar3 + iVar6;
        *nLength = iVar3;
      } while (uVar5 != ~(ulong)uVar7);
    }
  }
  else {
    __nptr = (char *)memcpy(szAscTlvLen,local_50,(long)pTVar8->nLengthLen);
    iVar3 = atoi(__nptr);
    *nLength = iVar3;
    pTVar8 = pkTlvInfo->pkProperties;
  }
  switch(pTVar8->tabFieldsInfo[iVar9].field_info.eFormatType) {
  case FF_HEX:
    HexToAscii((uchar *)(local_50 + pTVar8->nLengthLen),(uchar *)data,iVar3 * 2);
    iVar3 = *nLength * 2;
    *nLength = iVar3;
    break;
  case FF_BCD:
    BcdToAscii((uchar *)(local_50 + pTVar8->nLengthLen),(uchar *)data,iVar3 * 2);
    iVar3 = *nLength * 2;
    *nLength = iVar3;
    break;
  case FF_ALPHA_A:
  case FF_ALPHA_N:
  case FF_ALPHA_AN:
  case FF_ALPHA_ANS:
  case FF_ALPHA_NS:
  case FF_Z:
    EVar1 = pTVar8->tabFieldsInfo[iVar9].field_info.eAlphaFormat;
    if (EVar1 != AF_ASCII) {
      if (EVar1 == AF_EBCDIC) {
        EbcdicToAscii((uchar *)(local_50 + pTVar8->nLengthLen),(uchar *)data,iVar3);
        iVar3 = *nLength;
      }
      break;
    }
  case FF_BIN:
    memcpy(data,local_50 + pTVar8->nLengthLen,(long)iVar3);
    iVar3 = *nLength;
  }
  data[iVar3] = '\0';
  return 0;
}



// WARNING: Unknown calling convention

int GetTlvInfoField(char *tlv_name,TlvInfo *kTlvInfo,char *data,int *nLength)

{
  int iVar1;
  
  iVar1 = GetTlvInfoNextField(tlv_name,kTlvInfo,data,nLength,0);
  return iVar1;
}



// WARNING: Type propagation algorithm not settling
// WARNING: Unknown calling convention

int AddTlvInfoField(char *tlv_name,TlvInfo *pkTlvInfo,char *data,int nLength)

{
  E_FIELD_FORMAT EVar1;
  E_ALPHA_FORMAT EVar2;
  int iVar3;
  TlvInfoProperties *pTVar4;
  int iVar5;
  uint uVar6;
  tlv_field_t *__s1;
  int iVar7;
  char szAscTlvLen [13];
  char szAscTlvLen_add [13];
  
  szAscTlvLen[0] = '\0';
  szAscTlvLen[1] = '\0';
  szAscTlvLen[2] = '\0';
  szAscTlvLen[3] = '\0';
  szAscTlvLen[4] = '\0';
  szAscTlvLen[5] = '\0';
  szAscTlvLen[6] = '\0';
  szAscTlvLen[7] = '\0';
  szAscTlvLen[8] = '\0';
  szAscTlvLen[9] = '\0';
  szAscTlvLen[10] = '\0';
  szAscTlvLen[0xb] = '\0';
  szAscTlvLen[0xc] = '\0';
  szAscTlvLen_add[0] = '\0';
  szAscTlvLen_add[1] = '\0';
  szAscTlvLen_add[2] = '\0';
  szAscTlvLen_add[3] = '\0';
  szAscTlvLen_add[4] = '\0';
  szAscTlvLen_add[5] = '\0';
  szAscTlvLen_add[6] = '\0';
  szAscTlvLen_add[7] = '\0';
  szAscTlvLen_add[8] = '\0';
  szAscTlvLen_add[9] = '\0';
  szAscTlvLen_add[10] = '\0';
  szAscTlvLen_add[0xb] = '\0';
  szAscTlvLen_add[0xc] = '\0';
  if (nLength == 0) {
    return 1;
  }
  pTVar4 = pkTlvInfo->pkProperties;
  iVar5 = pTVar4->nNbFields;
  if (iVar5 < 1) {
    return 1;
  }
  __s1 = pTVar4->tabFieldsInfo;
  iVar7 = 0;
  while (iVar3 = strcmp(__s1->szTag,tlv_name), iVar3 != 0) {
    iVar7 = iVar7 + 1;
    __s1 = __s1 + 1;
    if (iVar7 == iVar5) {
      return 1;
    }
  }
  if ((pkTlvInfo->nPresent[iVar7] == 1) &&
     (pTVar4->tabFieldsInfo[iVar7].eIsRepeatable != IS_REPEATABLE)) {
    return 1;
  }
  iVar5 = pTVar4->tabFieldsInfo[iVar7].field_info.nLength;
  EVar1 = pTVar4->tabFieldsInfo[iVar7].field_info.eFormatType;
  uVar6 = nLength;
  if (pTVar4->tabFieldsInfo[iVar7].field_info.eLengthUnit == LU_BYTE) {
    if (EVar1 == FF_BCD) {
LAB_0043e0eb:
      iVar5 = iVar5 * 2;
      uVar6 = (nLength + 1) / 2;
    }
    else if (EVar1 == FF_X_BCD) {
      iVar5 = iVar5 * 2 + -2;
      uVar6 = nLength / 2 + 1;
    }
    else if (EVar1 == FF_HEX) goto LAB_0043e0eb;
  }
  if (pTVar4->tabFieldsInfo[iVar7].field_info.eLengthType == FL_FIX) {
    if (nLength != iVar5) {
      return -1;
    }
  }
  else if (iVar5 < nLength) {
    return -1;
  }
  if (pTVar4->eTagType == TLV_LT_ASCII) {
    memcpy(pkTlvInfo->sData + pkTlvInfo->nLength,tlv_name,(long)pTVar4->nTagLen);
  }
  else {
    AsciiToHex((uchar *)tlv_name,(uchar *)(pkTlvInfo->sData + pkTlvInfo->nLength),
               pTVar4->nTagLen * 2);
  }
  pTVar4 = pkTlvInfo->pkProperties;
  switch(pTVar4->tabFieldsInfo[iVar7].field_info.eFormatType) {
  case FF_HEX:
    AsciiToHex((uchar *)data,
               (uchar *)(pkTlvInfo->sData +
                        (long)pTVar4->nLengthLen + (long)pTVar4->nTagLen + (long)pkTlvInfo->nLength)
               ,nLength);
    pTVar4 = pkTlvInfo->pkProperties;
    break;
  case FF_BCD:
    AsciiToBcd((uchar *)data,
               (uchar *)(pkTlvInfo->sData +
                        (long)pTVar4->nLengthLen + (long)pTVar4->nTagLen + (long)pkTlvInfo->nLength)
               ,nLength);
    pTVar4 = pkTlvInfo->pkProperties;
    break;
  case FF_ALPHA_A:
  case FF_ALPHA_N:
  case FF_ALPHA_AN:
  case FF_ALPHA_ANS:
  case FF_ALPHA_NS:
  case FF_Z:
    EVar2 = pTVar4->tabFieldsInfo[iVar7].field_info.eAlphaFormat;
    if (EVar2 != AF_ASCII) {
      uVar6 = nLength;
      if (EVar2 == AF_EBCDIC) {
        AsciiToEbcdic((uchar *)data,
                      (uchar *)(pkTlvInfo->sData +
                               (long)pTVar4->nLengthLen +
                               (long)pTVar4->nTagLen + (long)pkTlvInfo->nLength),nLength);
        pTVar4 = pkTlvInfo->pkProperties;
      }
      break;
    }
  case FF_BIN:
    memcpy(pkTlvInfo->sData +
           (long)pTVar4->nLengthLen + (long)pTVar4->nTagLen + (long)pkTlvInfo->nLength,data,
           (long)nLength);
    pTVar4 = pkTlvInfo->pkProperties;
    uVar6 = nLength;
    break;
  default:
    uVar6 = 0;
  }
  iVar5 = pkTlvInfo->nPresent[iVar7];
  if (iVar5 == 1) {
    pkTlvInfo->nPresent[iVar7] = 2;
    iVar3 = pkTlvInfo->nNextFreeRFPos;
    iVar5 = pkTlvInfo->nPosTlv[iVar7];
    pkTlvInfo->nPosTlv[iVar7] = iVar3;
    pkTlvInfo->nRepeatedFieldPos[iVar3][0] = iVar5;
    iVar5 = iVar3 + 1;
    pkTlvInfo->nRepeatedFieldPos[iVar3][1] = iVar5;
    iVar7 = pkTlvInfo->nLength;
    pkTlvInfo->nRepeatedFieldPos[iVar5][1] = 0;
    pkTlvInfo->nRepeatedFieldPos[iVar5][0] = iVar7;
    pkTlvInfo->nNextFreeRFPos = iVar3 + 2;
  }
  else if (iVar5 == 2) {
    iVar5 = pkTlvInfo->nPosTlv[iVar7];
    do {
      iVar7 = iVar5;
      iVar5 = pkTlvInfo->nRepeatedFieldPos[iVar7][1];
    } while (iVar5 != 0);
    iVar5 = pkTlvInfo->nNextFreeRFPos;
    iVar3 = pkTlvInfo->nLength;
    pkTlvInfo->nRepeatedFieldPos[iVar7][1] = iVar5;
    pkTlvInfo->nRepeatedFieldPos[iVar5][0] = iVar3;
    pkTlvInfo->nRepeatedFieldPos[iVar5][1] = 0;
    pkTlvInfo->nNextFreeRFPos = iVar5 + 1;
  }
  else if (iVar5 == 0) {
    iVar5 = pkTlvInfo->nLength;
    pkTlvInfo->nPresent[iVar7] = 1;
    pkTlvInfo->nPosTlv[iVar7] = iVar5;
  }
  if (pTVar4->eLengthType == TLV_LT_ASCII) {
    sprintf(szAscTlvLen,"%.*d",(ulong)(uint)pTVar4->nLengthLen,(ulong)uVar6);
    memcpy(pkTlvInfo->sData + (long)pkTlvInfo->nLength + (long)pkTlvInfo->pkProperties->nTagLen,
           szAscTlvLen,(long)pkTlvInfo->pkProperties->nLengthLen);
  }
  else {
    sprintf(szAscTlvLen,"%.*X",(ulong)(uint)(pTVar4->nLengthLen * 2),(ulong)uVar6);
    AsciiToHex((uchar *)szAscTlvLen,(uchar *)szAscTlvLen_add,pkTlvInfo->pkProperties->nLengthLen * 2
              );
    memcpy(pkTlvInfo->sData + (long)pkTlvInfo->nLength + (long)pkTlvInfo->pkProperties->nTagLen,
           szAscTlvLen_add,(long)pkTlvInfo->pkProperties->nLengthLen);
  }
  pkTlvInfo->nLength =
       pkTlvInfo->nLength +
       uVar6 + pkTlvInfo->pkProperties->nTagLen + pkTlvInfo->pkProperties->nLengthLen;
  return 0;
}



// WARNING: Unknown calling convention

int PutTlvInfoField(char *tlv_name,TlvInfo *pkTlvInfo,char *data,int nLength)

{
  E_ALPHA_FORMAT EVar1;
  int iVar2;
  int iVar3;
  char *pcVar4;
  int *piVar5;
  long lVar6;
  long lVar7;
  int iVar8;
  int iVar9;
  uint uVar10;
  int iVar11;
  size_t __n;
  uint uVar12;
  size_t __n_00;
  tlv_field_t *__s1;
  int iVar13;
  byte bVar14;
  TlvInfoProperties *local_4a0;
  char szAscTlvLen [13];
  char szAscTlvLen_add [13];
  char szOldTlvLen [13];
  char szLastPart [1024];
  
  bVar14 = 0;
  szAscTlvLen[0] = '\0';
  szAscTlvLen[1] = '\0';
  szAscTlvLen[2] = '\0';
  szAscTlvLen[3] = '\0';
  szAscTlvLen[4] = '\0';
  szAscTlvLen[5] = '\0';
  szAscTlvLen[6] = '\0';
  szAscTlvLen[7] = '\0';
  szAscTlvLen[8] = '\0';
  szAscTlvLen[9] = '\0';
  szAscTlvLen[10] = '\0';
  szAscTlvLen[0xb] = '\0';
  szAscTlvLen[0xc] = '\0';
  szAscTlvLen_add[0] = '\0';
  szAscTlvLen_add[1] = '\0';
  szAscTlvLen_add[2] = '\0';
  szAscTlvLen_add[3] = '\0';
  szAscTlvLen_add[4] = '\0';
  szAscTlvLen_add[5] = '\0';
  szAscTlvLen_add[6] = '\0';
  szAscTlvLen_add[7] = '\0';
  szAscTlvLen_add[8] = '\0';
  szAscTlvLen_add[9] = '\0';
  szAscTlvLen_add[10] = '\0';
  szAscTlvLen_add[0xb] = '\0';
  szAscTlvLen_add[0xc] = '\0';
  szOldTlvLen[0] = '\0';
  szOldTlvLen[1] = '\0';
  szOldTlvLen[2] = '\0';
  szOldTlvLen[3] = '\0';
  szOldTlvLen[4] = '\0';
  szOldTlvLen[5] = '\0';
  szOldTlvLen[6] = '\0';
  szOldTlvLen[7] = '\0';
  szOldTlvLen[8] = '\0';
  szOldTlvLen[9] = '\0';
  szOldTlvLen[10] = '\0';
  szOldTlvLen[0xb] = '\0';
  szOldTlvLen[0xc] = '\0';
  if (nLength != 0) {
    local_4a0 = pkTlvInfo->pkProperties;
    iVar3 = local_4a0->nNbFields;
    if (0 < iVar3) {
      __s1 = local_4a0->tabFieldsInfo;
      iVar13 = 0;
      do {
        iVar2 = strcmp(__s1->szTag,tlv_name);
        if (iVar2 == 0) {
          if (local_4a0->tabFieldsInfo[iVar13].field_info.nLength < nLength) {
            return 1;
          }
          pcVar4 = szLastPart;
          for (lVar6 = 0x80; lVar6 != 0; lVar6 = lVar6 + -1) {
            pcVar4[0] = '\0';
            pcVar4[1] = '\0';
            pcVar4[2] = '\0';
            pcVar4[3] = '\0';
            pcVar4[4] = '\0';
            pcVar4[5] = '\0';
            pcVar4[6] = '\0';
            pcVar4[7] = '\0';
            pcVar4 = pcVar4 + (ulong)bVar14 * -0x10 + 8;
          }
          if ((pkTlvInfo->nPresent[iVar13] != 1) ||
             (local_4a0->tabFieldsInfo[iVar13].eIsRepeatable == IS_REPEATABLE)) {
            iVar3 = AddTlvInfoField(tlv_name,pkTlvInfo,data,nLength);
            return iVar3;
          }
          if (local_4a0->eLengthType == TLV_LT_ASCII) {
            pcVar4 = (char *)memcpy(szOldTlvLen,
                                    pkTlvInfo->sData +
                                    (long)local_4a0->nTagLen + (long)pkTlvInfo->nPosTlv[iVar13],
                                    (long)local_4a0->nLengthLen);
            iVar9 = atoi(pcVar4);
            local_4a0 = pkTlvInfo->pkProperties;
            iVar3 = pkTlvInfo->nPosTlv[iVar13];
            iVar2 = local_4a0->nTagLen;
            uVar12 = local_4a0->nLengthLen;
            lVar6 = (long)iVar9;
            lVar7 = (long)iVar3 + (long)iVar2;
          }
          else {
            uVar12 = local_4a0->nLengthLen;
            iVar3 = pkTlvInfo->nPosTlv[iVar13];
            uVar10 = uVar12 - 1;
            if ((int)uVar10 < 0) {
              iVar9 = 0;
              iVar2 = local_4a0->nTagLen;
              lVar6 = 0;
              lVar7 = (long)iVar3 + (long)iVar2;
            }
            else {
              iVar9 = 0;
              iVar2 = local_4a0->nTagLen;
              lVar7 = (long)iVar3 + (long)iVar2;
              iVar11 = 1;
              pcVar4 = pkTlvInfo->sData + lVar7 + (int)uVar10;
              do {
                bVar14 = *pcVar4;
                pcVar4 = pcVar4 + -1;
                iVar8 = (uint)bVar14 * iVar11;
                iVar11 = iVar11 << 8;
                iVar9 = iVar9 + iVar8;
              } while ((byte *)pcVar4 !=
                       (byte *)((long)pkTlvInfo + lVar7 + (((long)(int)uVar10 + 3) - (ulong)uVar10))
                      );
              lVar6 = (long)iVar9;
            }
          }
          __n = (size_t)(int)((((pkTlvInfo->nLength - iVar3) - iVar2) - uVar12) - iVar9);
          lVar7 = lVar7 + (int)uVar12;
          memcpy(szLastPart,pkTlvInfo->sData + lVar6 + lVar7,__n);
          switch(local_4a0->tabFieldsInfo[iVar13].field_info.eFormatType) {
          case FF_BIN:
            memcpy(pkTlvInfo->sData + lVar7,data,(long)nLength);
            lVar7 = (long)pkTlvInfo->pkProperties->nLengthLen +
                    (long)pkTlvInfo->pkProperties->nTagLen + (long)pkTlvInfo->nPosTlv[iVar13];
          case FF_HEX:
            AsciiToHex((uchar *)data,(uchar *)(pkTlvInfo->sData + lVar7),nLength);
            break;
          case FF_BCD:
            AsciiToBcd((uchar *)data,(uchar *)(pkTlvInfo->sData + lVar7),nLength);
            break;
          case FF_ALPHA_A:
          case FF_ALPHA_N:
          case FF_ALPHA_AN:
          case FF_ALPHA_ANS:
          case FF_ALPHA_NS:
          case FF_Z:
            EVar1 = local_4a0->tabFieldsInfo[iVar13].field_info.eAlphaFormat;
            if (EVar1 == AF_ASCII) {
              __n_00 = (size_t)nLength;
              memcpy(pkTlvInfo->sData + lVar7,data,__n_00);
              local_4a0 = pkTlvInfo->pkProperties;
              uVar12 = local_4a0->nLengthLen;
              goto LAB_0043e565;
            }
            if (EVar1 != AF_EBCDIC) {
              __n_00 = (size_t)nLength;
              goto LAB_0043e565;
            }
            AsciiToEbcdic((uchar *)data,(uchar *)(pkTlvInfo->sData + lVar7),nLength);
            goto LAB_0043e54d;
          default:
            nLength = 0;
            __n_00 = 0;
            goto LAB_0043e565;
          }
          nLength = nLength / 2;
LAB_0043e54d:
          local_4a0 = pkTlvInfo->pkProperties;
          __n_00 = (size_t)nLength;
          uVar12 = local_4a0->nLengthLen;
LAB_0043e565:
          if (local_4a0->eLengthType == TLV_LT_ASCII) {
            sprintf(szAscTlvLen,"%.*d",(ulong)uVar12,(ulong)(uint)nLength);
            memcpy(pkTlvInfo->sData +
                   (long)pkTlvInfo->pkProperties->nTagLen + (long)pkTlvInfo->nPosTlv[iVar13],
                   szAscTlvLen,(long)pkTlvInfo->pkProperties->nLengthLen);
          }
          else {
            sprintf(szAscTlvLen,"%.*d",(ulong)(uVar12 * 2),(ulong)(uint)nLength);
            AsciiToHex((uchar *)szAscTlvLen,(uchar *)szAscTlvLen_add,
                       pkTlvInfo->pkProperties->nLengthLen * 2);
            memcpy(pkTlvInfo->sData +
                   (long)pkTlvInfo->pkProperties->nTagLen + (long)pkTlvInfo->nPosTlv[iVar13],
                   szAscTlvLen_add,(long)pkTlvInfo->pkProperties->nLengthLen);
          }
          iVar9 = nLength - iVar9;
          memcpy(pkTlvInfo->sData +
                 __n_00 + (long)pkTlvInfo->nPosTlv[iVar13] +
                          (long)pkTlvInfo->pkProperties->nLengthLen +
                          (long)pkTlvInfo->pkProperties->nTagLen,szLastPart,__n);
          pkTlvInfo->nLength = pkTlvInfo->nLength + iVar9;
          iVar3 = pkTlvInfo->nPosTlv[iVar13];
          iVar13 = pkTlvInfo->pkProperties->nNbFields;
          if (0 < iVar13) {
            piVar5 = pkTlvInfo->nPosTlv;
            iVar2 = 0;
            do {
              if ((piVar5[-0x201] == 1) && (iVar3 < *piVar5)) {
                *piVar5 = *piVar5 + iVar9;
              }
              iVar2 = iVar2 + 1;
              piVar5 = piVar5 + 1;
            } while (iVar2 < iVar13);
          }
          lVar6 = 0;
          do {
            iVar13 = *(int *)((long)pkTlvInfo->nRepeatedFieldPos[0] + lVar6);
            if (iVar3 < iVar13) {
              *(int *)((long)pkTlvInfo->nRepeatedFieldPos[0] + lVar6) = iVar13 + iVar9;
            }
            lVar6 = lVar6 + 8;
          } while (lVar6 != 0x200);
          return 0;
        }
        iVar13 = iVar13 + 1;
        __s1 = __s1 + 1;
      } while (iVar13 != iVar3);
    }
  }
  return 1;
}



// WARNING: Unknown calling convention

int BuildTlvInfoBuffer(char *buffer_out,TlvInfo *pkTlvInfo)

{
  void *pvVar1;
  
  pvVar1 = memcpy(buffer_out,pkTlvInfo->sData,(long)pkTlvInfo->nLength);
  *(undefined1 *)((long)pvVar1 + (long)pkTlvInfo->nLength) = 0;
  return pkTlvInfo->nLength;
}



// WARNING: Unknown calling convention

void DumpTlvInfo(TlvInfo *pkTlvInfo)

{
  int iVar1;
  TlvInfoProperties *pTVar2;
  long lVar3;
  char *pcVar4;
  int iVar5;
  int local_a54;
  int nLen;
  char sLine [512];
  char szField [1024];
  char szFieldAdd [1024];
  
  iVar5 = 0;
  local_a54 = 0;
  pcVar4 = sLine;
  for (lVar3 = 0x40; lVar3 != 0; lVar3 = lVar3 + -1) {
    pcVar4[0] = '\0';
    pcVar4[1] = '\0';
    pcVar4[2] = '\0';
    pcVar4[3] = '\0';
    pcVar4[4] = '\0';
    pcVar4[5] = '\0';
    pcVar4[6] = '\0';
    pcVar4[7] = '\0';
    pcVar4 = pcVar4 + 8;
  }
  pcVar4 = szField;
  for (lVar3 = 0x80; lVar3 != 0; lVar3 = lVar3 + -1) {
    pcVar4[0] = '\0';
    pcVar4[1] = '\0';
    pcVar4[2] = '\0';
    pcVar4[3] = '\0';
    pcVar4[4] = '\0';
    pcVar4[5] = '\0';
    pcVar4[6] = '\0';
    pcVar4[7] = '\0';
    pcVar4 = pcVar4 + 8;
  }
  pTVar2 = pkTlvInfo->pkProperties;
  do {
    while( true ) {
      if (pTVar2->nNbFields <= iVar5) {
        return;
      }
      while( true ) {
        if (pTVar2->tabFieldsInfo[iVar5].eIsRepeatable == IS_REPEATABLE) break;
        iVar1 = GetTlvInfoField(pTVar2->tabFieldsInfo[iVar5].szTag,pkTlvInfo,szField,&nLen);
        if (iVar1 == 0) goto LAB_0043e8a5;
        pTVar2 = pkTlvInfo->pkProperties;
        iVar5 = iVar5 + 1;
        if (pTVar2->nNbFields <= iVar5) {
          return;
        }
      }
      iVar1 = GetTlvInfoNextField(pTVar2->tabFieldsInfo[iVar5].szTag,pkTlvInfo,szField,&nLen,
                                  local_a54);
      if (iVar1 == 0) break;
      iVar5 = iVar5 + 1;
      pTVar2 = pkTlvInfo->pkProperties;
      local_a54 = 0;
    }
    local_a54 = local_a54 + 1;
LAB_0043e8a5:
    pcVar4 = szFieldAdd;
    if (pkTlvInfo->pkProperties->tabFieldsInfo[iVar5].field_info.eFormatType != FF_BIN) {
      pcVar4 = szField;
    }
    sprintf(sLine,"- TAG (%s) : (%03d) : [%s] ",pkTlvInfo->pkProperties->tabFieldsInfo + iVar5,
            (ulong)(uint)nLen,pcVar4);
    trace_event(sLine,4);
    pTVar2 = pkTlvInfo->pkProperties;
    iVar5 = iVar5 + (uint)(pTVar2->tabFieldsInfo[iVar5].eIsRepeatable != IS_REPEATABLE);
  } while( true );
}



// WARNING: Restarted to delay deadcode elimination for space: stack
// WARNING: Unknown calling convention

int GetResources(int nIndiceCtx,TSResources *resources)

{
  long lVar1;
  ushort uVar2;
  char *pcVar3;
  ulong uVar4;
  uint uVar5;
  uchar *puVar6;
  bool bVar7;
  byte bVar8;
  uchar auStack_2d04 [48];
  uchar auStack_2cd4 [48];
  uchar auStack_2ca4 [64];
  uchar auStack_2c64 [64];
  uchar auStack_2c24 [64];
  uchar auStack_2be4 [64];
  uchar auStack_2ba4 [80];
  uchar auStack_2b54 [80];
  uchar auStack_2b04 [80];
  uchar auStack_2ab4 [80];
  uchar auStack_2a64 [7068];
  char STATUS [2];
  char SUBJECT_OF_SUPERVISE [2];
  char PRIS_SUBJECT_OF_AUTO_START [2];
  char PRIS_SUPPORT_ADM_MESSAGE [2];
  char PRIS_CONNECT_MODE [2];
  char PRIS_TRACE_LEVEL [2];
  char PRIS_GEN_REVERSAL_TIMEOUT_LATE [2];
  char RESOURCE_LIVE [2];
  char RESOURCE_CODE [3];
  char PRIS_COMMS_ID [3];
  char PRIS_PROTOCOL_ID [3];
  char PRIS_PROCESSING_STEP [4];
  int PRIS_LOG_MAX_SIZE;
  int PRIS_START_CYCLE;
  int PRIS_END_CYCLE;
  int PRIS_NB_STATIC_THREADS;
  int PRIS_NB_USER_THREADS_VS_KERNEL;
  int PRIS_TIMER_ACQUIRER;
  int PRIS_DELTA_TIMER_ISS_ACQ;
  int PRIS_TRANSACTION_SIM_MAX;
  int PRIS_CURRENT_CYCLE;
  pid_t PRIS_PID;
  int PRIS_MIN_TROUBLES_IND;
  int PRIS_MAX_TROUBLES_IND;
  int response_code;
  char RESOURCE_ID [7];
  char PRIS_BANK_CODE [7];
  anon_struct_8_2_43c7b5cf COMPONENT_TYPE;
  long PRIS_ECHO_TEST_TIMER;
  anon_struct_20_2_43c7b5cf RESOURCE_NAME;
  anon_struct_24_2_43c7b5cf PRIS_LOG_FILE_NAME;
  anon_struct_36_2_43c7b5cf PRIS_INTERNAL_ID;
  anon_struct_44_2_43c7b5cf PRIS_START_SCRIPT_NAME;
  anon_struct_44_2_43c7b5cf PRIS_STOP_SCRIPT_NAME;
  anon_struct_64_2_43c7b5cf OBJECT_NAME;
  anon_struct_64_2_43c7b5cf PRIS_OBJECT_PATH;
  anon_struct_64_2_43c7b5cf PRIS_START_SCRIPT_PATH;
  anon_struct_64_2_43c7b5cf PRIS_STOP_SCRIPT_PATH;
  anon_struct_68_2_43c7b5cf PRIS_DEVICE_NAME;
  anon_struct_68_2_43c7b5cf PRIS_REMOTE_APPLICATION_NAME;
  anon_struct_68_2_43c7b5cf PRIS_REMOTE_APPLICATION_ID;
  anon_struct_68_2_43c7b5cf PRIS_LOCAL_APPLICATION_NAME;
  anon_struct_68_2_43c7b5cf PRIS_LOCAL_APPLICATION_ID;
  sqlca sqlca;
  char detail [512];
  undefined8 local_7b0;
  undefined8 local_7a8;
  undefined8 local_7a0;
  undefined8 local_798;
  undefined8 local_790;
  undefined8 local_788;
  undefined8 local_780;
  undefined8 local_778;
  undefined8 local_770;
  undefined8 local_768;
  undefined8 local_760;
  undefined8 local_758;
  undefined8 local_750;
  undefined8 local_748;
  undefined8 local_740;
  undefined8 local_738;
  undefined8 local_730;
  undefined8 local_728;
  undefined8 local_720;
  undefined8 local_718;
  undefined8 local_710;
  undefined8 local_708;
  undefined8 local_700;
  undefined8 local_6f8;
  undefined8 local_6f0;
  undefined8 local_6e8;
  undefined8 local_6e0;
  undefined8 local_6d8;
  undefined8 local_6d0;
  undefined8 local_6c8;
  undefined8 local_6c0;
  undefined8 local_6b8;
  undefined8 local_6b0;
  undefined8 local_6a8;
  undefined8 local_6a0;
  undefined8 local_698;
  undefined8 local_690;
  undefined8 local_688;
  undefined8 local_680;
  undefined8 local_678;
  undefined8 local_670;
  undefined8 local_668;
  undefined8 local_660;
  undefined4 local_658;
  undefined4 local_654;
  undefined4 local_650;
  undefined4 local_64c;
  undefined4 local_648;
  undefined4 local_644;
  undefined4 local_640;
  undefined4 local_63c;
  undefined4 local_638;
  undefined4 local_634;
  undefined4 local_630;
  undefined4 local_62c;
  undefined4 local_628;
  undefined4 local_624;
  undefined4 local_620;
  undefined4 local_61c;
  undefined4 local_618;
  undefined4 local_614;
  undefined4 local_610;
  undefined4 local_60c;
  undefined4 local_608;
  undefined4 local_604;
  undefined4 local_600;
  undefined4 local_5fc;
  undefined4 local_5f8;
  undefined4 local_5f4;
  undefined4 local_5f0;
  undefined4 local_5ec;
  undefined4 local_5e8;
  undefined4 local_5e4;
  undefined4 local_5e0;
  undefined4 local_5dc;
  undefined4 local_5d8;
  undefined4 local_5d4;
  undefined4 local_5d0;
  undefined4 local_5cc;
  undefined4 local_5c8;
  undefined4 local_5c4;
  undefined4 local_5c0;
  undefined4 local_5bc;
  undefined4 local_5b8;
  undefined4 local_5b4;
  undefined4 local_5b0;
  undefined8 local_5a8;
  undefined8 local_5a0;
  undefined8 local_598;
  undefined8 local_590;
  undefined8 local_588;
  undefined8 local_580;
  undefined8 local_578;
  undefined8 local_570;
  undefined8 local_568;
  undefined8 local_560;
  undefined8 local_558;
  undefined8 local_550;
  undefined8 local_548;
  undefined8 local_540;
  undefined8 local_538;
  undefined8 local_530;
  undefined8 local_528;
  undefined8 local_520;
  undefined8 local_518;
  undefined8 local_510;
  undefined8 local_508;
  undefined8 local_500;
  undefined8 local_4f8;
  undefined8 local_4f0;
  undefined8 local_4e8;
  undefined8 local_4e0;
  undefined8 local_4d8;
  undefined8 local_4d0;
  undefined8 local_4c8;
  undefined8 local_4c0;
  undefined8 local_4b8;
  undefined8 local_4b0;
  undefined8 local_4a8;
  undefined8 local_4a0;
  undefined8 local_498;
  undefined8 local_490;
  undefined8 local_488;
  undefined8 local_480;
  undefined8 local_478;
  undefined8 local_470;
  undefined8 local_468;
  undefined8 local_460;
  undefined8 local_458;
  undefined4 local_450;
  undefined4 local_44c;
  undefined4 local_448;
  undefined4 local_444;
  undefined4 local_440;
  undefined4 local_43c;
  undefined4 local_438;
  undefined4 local_434;
  undefined4 local_430;
  undefined4 local_42c;
  undefined4 local_428;
  undefined4 local_424;
  undefined4 local_420;
  undefined4 local_41c;
  undefined4 local_418;
  undefined4 local_414;
  undefined4 local_410;
  undefined4 local_40c;
  undefined4 local_408;
  undefined4 local_404;
  undefined4 local_400;
  undefined4 local_3fc;
  undefined4 local_3f8;
  undefined4 local_3f4;
  undefined4 local_3f0;
  undefined4 local_3ec;
  undefined4 local_3e8;
  undefined4 local_3e4;
  undefined4 local_3e0;
  undefined4 local_3dc;
  undefined4 local_3d8;
  undefined4 local_3d4;
  undefined4 local_3d0;
  undefined4 local_3cc;
  undefined4 local_3c8;
  undefined4 local_3c4;
  undefined4 local_3c0;
  undefined4 local_3bc;
  undefined4 local_3b8;
  undefined4 local_3b4;
  undefined4 local_3b0;
  undefined4 local_3ac;
  undefined4 local_3a8;
  undefined8 local_3a0;
  undefined8 local_398;
  undefined8 local_390;
  undefined8 local_388;
  undefined8 local_380;
  undefined8 local_378;
  undefined8 local_370;
  undefined8 local_368;
  undefined8 local_360;
  undefined8 local_358;
  undefined8 local_350;
  undefined8 local_348;
  undefined8 local_340;
  undefined8 local_338;
  undefined8 local_330;
  undefined8 local_328;
  undefined8 local_320;
  undefined8 local_318;
  undefined8 local_310;
  undefined8 local_308;
  undefined8 local_300;
  undefined8 local_2f8;
  undefined8 local_2f0;
  undefined8 local_2e8;
  undefined8 local_2e0;
  undefined8 local_2d8;
  undefined8 local_2d0;
  undefined8 local_2c8;
  undefined8 local_2c0;
  undefined8 local_2b8;
  undefined8 local_2b0;
  undefined8 local_2a8;
  undefined8 local_2a0;
  undefined8 local_298;
  undefined8 local_290;
  undefined8 local_288;
  undefined8 local_280;
  undefined8 local_278;
  undefined8 local_270;
  undefined8 local_268;
  undefined8 local_260;
  undefined8 local_258;
  undefined8 local_250;
  undefined1 local_248 [344];
  undefined2 local_f0;
  undefined2 local_ee;
  undefined2 local_ec;
  undefined2 local_ea;
  undefined2 local_e8;
  undefined2 local_e6;
  undefined2 local_e4;
  undefined2 local_e2;
  undefined2 local_e0;
  undefined2 local_de;
  undefined2 local_dc;
  undefined2 local_da;
  undefined2 local_d8;
  undefined2 local_d6;
  undefined2 local_d4;
  undefined2 local_d2;
  undefined2 local_d0;
  undefined2 local_ce;
  undefined2 local_cc;
  undefined2 local_ca;
  undefined2 local_c8;
  undefined2 local_c6;
  undefined2 local_c4;
  undefined2 local_c2;
  undefined2 local_c0;
  undefined2 local_be;
  undefined2 local_bc;
  undefined2 local_ba;
  undefined2 local_b8;
  undefined2 local_b6;
  undefined2 local_b4;
  undefined2 local_b2;
  undefined2 local_b0;
  undefined2 local_ae;
  undefined2 local_ac;
  undefined2 local_aa;
  undefined2 local_a8;
  undefined2 local_a6;
  undefined2 local_a4;
  undefined2 local_a2;
  undefined2 local_a0;
  undefined2 local_9e;
  undefined2 local_9c;
  undefined2 local_9a;
  undefined2 local_98;
  undefined2 local_96;
  undefined2 local_94;
  undefined2 local_92;
  undefined2 local_90;
  undefined2 local_8e;
  undefined2 local_8c;
  undefined2 local_8a;
  undefined2 local_88;
  undefined2 local_86;
  undefined2 local_84;
  undefined2 local_82;
  undefined2 local_80;
  undefined2 local_7e;
  undefined2 local_7c;
  undefined2 local_7a;
  undefined2 local_78;
  undefined2 local_76;
  undefined2 local_74;
  undefined2 local_72;
  undefined2 local_70;
  undefined2 local_6e;
  undefined2 local_6c;
  undefined2 local_6a;
  undefined2 local_68;
  undefined2 local_66;
  undefined2 local_64;
  undefined2 local_62;
  undefined2 local_60;
  undefined2 local_5e;
  undefined2 local_5c;
  undefined2 local_5a;
  undefined2 local_58;
  undefined2 local_56;
  undefined2 local_54;
  undefined2 local_52;
  undefined2 local_50;
  undefined2 local_4e;
  undefined2 local_4c;
  undefined2 local_4a;
  undefined2 local_48;
  undefined2 local_46;
  
  bVar8 = 0;
  fwrite("Start GetResources() \n",1,0x16,stderr);
  puVar6 = OBJECT_NAME.arr + 2;
  bVar7 = ((ulong)puVar6 & 4) != 0;
  RESOURCE_ID[6] = '\0';
  RESOURCE_CODE[0] = '\0';
  RESOURCE_CODE[1] = '\0';
  uVar5 = 0x3b;
  RESOURCE_CODE[2] = '\0';
  COMPONENT_TYPE.len = 0;
  COMPONENT_TYPE.arr[0] = '\0';
  COMPONENT_TYPE.arr[1] = '\0';
  COMPONENT_TYPE.arr[2] = '\0';
  COMPONENT_TYPE.arr[3] = '\0';
  COMPONENT_TYPE.arr[4] = '\0';
  RESOURCE_NAME.len = 0;
  RESOURCE_NAME.arr[0] = '\0';
  RESOURCE_NAME.arr[1] = '\0';
  RESOURCE_NAME.arr[2] = '\0';
  RESOURCE_NAME.arr[3] = '\0';
  RESOURCE_NAME.arr[4] = '\0';
  RESOURCE_NAME.arr[5] = '\0';
  RESOURCE_NAME.arr[6] = '\0';
  RESOURCE_NAME.arr[7] = '\0';
  RESOURCE_NAME.arr[8] = '\0';
  RESOURCE_NAME.arr[9] = '\0';
  RESOURCE_NAME.arr[10] = '\0';
  RESOURCE_NAME.arr[0xb] = '\0';
  RESOURCE_NAME.arr[0xc] = '\0';
  RESOURCE_NAME.arr[0xd] = '\0';
  RESOURCE_NAME.arr[0xe] = '\0';
  RESOURCE_NAME.arr[0xf] = '\0';
  RESOURCE_NAME.arr[0x10] = '\0';
  STATUS[0] = '\0';
  STATUS[1] = '\0';
  SUBJECT_OF_SUPERVISE[0] = '\0';
  SUBJECT_OF_SUPERVISE[1] = '\0';
  OBJECT_NAME.arr[0] = '\0';
  OBJECT_NAME.arr[1] = '\0';
  if (bVar7) {
    OBJECT_NAME.arr[2] = '\0';
    OBJECT_NAME.arr[3] = '\0';
    OBJECT_NAME.arr[4] = '\0';
    OBJECT_NAME.arr[5] = '\0';
    uVar5 = 0x37;
    puVar6 = OBJECT_NAME.arr + 6;
  }
  for (uVar4 = (ulong)(uVar5 >> 3); uVar4 != 0; uVar4 = uVar4 - 1) {
    puVar6[0] = '\0';
    puVar6[1] = '\0';
    puVar6[2] = '\0';
    puVar6[3] = '\0';
    puVar6[4] = '\0';
    puVar6[5] = '\0';
    puVar6[6] = '\0';
    puVar6[7] = '\0';
    puVar6 = puVar6 + (ulong)bVar8 * -0x10 + 8;
  }
  if (bVar7) {
    puVar6[0] = '\0';
    puVar6[1] = '\0';
    puVar6[2] = '\0';
    puVar6[3] = '\0';
    puVar6 = puVar6 + 4;
  }
  puVar6[0] = '\0';
  puVar6[1] = '\0';
  puVar6[2] = '\0';
  PRIS_OBJECT_PATH.arr[0] = '\0';
  PRIS_OBJECT_PATH.arr[1] = '\0';
  puVar6 = PRIS_OBJECT_PATH.arr + 2;
  OBJECT_NAME.len = 0;
  uVar5 = 0x3b;
  bVar7 = ((ulong)puVar6 & 4) != 0;
  if (bVar7) {
    PRIS_OBJECT_PATH.arr[2] = '\0';
    PRIS_OBJECT_PATH.arr[3] = '\0';
    PRIS_OBJECT_PATH.arr[4] = '\0';
    PRIS_OBJECT_PATH.arr[5] = '\0';
    uVar5 = 0x37;
    puVar6 = PRIS_OBJECT_PATH.arr + 6;
  }
  for (uVar4 = (ulong)(uVar5 >> 3); uVar4 != 0; uVar4 = uVar4 - 1) {
    puVar6[0] = '\0';
    puVar6[1] = '\0';
    puVar6[2] = '\0';
    puVar6[3] = '\0';
    puVar6[4] = '\0';
    puVar6[5] = '\0';
    puVar6[6] = '\0';
    puVar6[7] = '\0';
    puVar6 = puVar6 + (ulong)bVar8 * -0x10 + 8;
  }
  if (bVar7) {
    puVar6[0] = '\0';
    puVar6[1] = '\0';
    puVar6[2] = '\0';
    puVar6[3] = '\0';
    puVar6 = puVar6 + 4;
  }
  puVar6[0] = '\0';
  puVar6[1] = '\0';
  puVar6[2] = '\0';
  puVar6 = PRIS_START_SCRIPT_NAME.arr + 2;
  uVar5 = 0x27;
  PRIS_OBJECT_PATH.len = 0;
  PRIS_START_SCRIPT_NAME.len = 0;
  bVar7 = ((ulong)puVar6 & 4) != 0;
  PRIS_START_SCRIPT_NAME.arr[0] = '\0';
  PRIS_START_SCRIPT_NAME.arr[1] = '\0';
  if (bVar7) {
    PRIS_START_SCRIPT_NAME.arr[2] = '\0';
    PRIS_START_SCRIPT_NAME.arr[3] = '\0';
    PRIS_START_SCRIPT_NAME.arr[4] = '\0';
    PRIS_START_SCRIPT_NAME.arr[5] = '\0';
    uVar5 = 0x23;
    puVar6 = PRIS_START_SCRIPT_NAME.arr + 6;
  }
  for (uVar4 = (ulong)(uVar5 >> 3); uVar4 != 0; uVar4 = uVar4 - 1) {
    puVar6[0] = '\0';
    puVar6[1] = '\0';
    puVar6[2] = '\0';
    puVar6[3] = '\0';
    puVar6[4] = '\0';
    puVar6[5] = '\0';
    puVar6[6] = '\0';
    puVar6[7] = '\0';
    puVar6 = puVar6 + (ulong)bVar8 * -0x10 + 8;
  }
  if (!bVar7) {
    puVar6[0] = '\0';
    puVar6[1] = '\0';
    puVar6[2] = '\0';
    puVar6[3] = '\0';
    puVar6 = puVar6 + 4;
  }
  puVar6[0] = '\0';
  puVar6[1] = '\0';
  puVar6[2] = '\0';
  puVar6 = PRIS_START_SCRIPT_PATH.arr + 2;
  uVar5 = 0x3b;
  PRIS_START_SCRIPT_PATH.len = 0;
  bVar7 = ((ulong)puVar6 & 4) != 0;
  PRIS_START_SCRIPT_PATH.arr[0] = '\0';
  PRIS_START_SCRIPT_PATH.arr[1] = '\0';
  if (bVar7) {
    PRIS_START_SCRIPT_PATH.arr[2] = '\0';
    PRIS_START_SCRIPT_PATH.arr[3] = '\0';
    PRIS_START_SCRIPT_PATH.arr[4] = '\0';
    PRIS_START_SCRIPT_PATH.arr[5] = '\0';
    uVar5 = 0x37;
    puVar6 = PRIS_START_SCRIPT_PATH.arr + 6;
  }
  for (uVar4 = (ulong)(uVar5 >> 3); uVar4 != 0; uVar4 = uVar4 - 1) {
    puVar6[0] = '\0';
    puVar6[1] = '\0';
    puVar6[2] = '\0';
    puVar6[3] = '\0';
    puVar6[4] = '\0';
    puVar6[5] = '\0';
    puVar6[6] = '\0';
    puVar6[7] = '\0';
    puVar6 = puVar6 + (ulong)bVar8 * -0x10 + 8;
  }
  if (bVar7) {
    puVar6[0] = '\0';
    puVar6[1] = '\0';
    puVar6[2] = '\0';
    puVar6[3] = '\0';
    puVar6 = puVar6 + 4;
  }
  puVar6[0] = '\0';
  puVar6[1] = '\0';
  puVar6[2] = '\0';
  puVar6 = PRIS_STOP_SCRIPT_NAME.arr + 2;
  PRIS_STOP_SCRIPT_NAME.len = 0;
  uVar5 = 0x27;
  bVar7 = ((ulong)puVar6 & 4) != 0;
  PRIS_STOP_SCRIPT_NAME.arr[0] = '\0';
  PRIS_STOP_SCRIPT_NAME.arr[1] = '\0';
  if (bVar7) {
    PRIS_STOP_SCRIPT_NAME.arr[2] = '\0';
    PRIS_STOP_SCRIPT_NAME.arr[3] = '\0';
    PRIS_STOP_SCRIPT_NAME.arr[4] = '\0';
    PRIS_STOP_SCRIPT_NAME.arr[5] = '\0';
    uVar5 = 0x23;
    puVar6 = PRIS_STOP_SCRIPT_NAME.arr + 6;
  }
  for (uVar4 = (ulong)(uVar5 >> 3); uVar4 != 0; uVar4 = uVar4 - 1) {
    puVar6[0] = '\0';
    puVar6[1] = '\0';
    puVar6[2] = '\0';
    puVar6[3] = '\0';
    puVar6[4] = '\0';
    puVar6[5] = '\0';
    puVar6[6] = '\0';
    puVar6[7] = '\0';
    puVar6 = puVar6 + (ulong)bVar8 * -0x10 + 8;
  }
  if (!bVar7) {
    puVar6[0] = '\0';
    puVar6[1] = '\0';
    puVar6[2] = '\0';
    puVar6[3] = '\0';
    puVar6 = puVar6 + 4;
  }
  puVar6[0] = '\0';
  puVar6[1] = '\0';
  puVar6[2] = '\0';
  puVar6 = PRIS_STOP_SCRIPT_PATH.arr + 2;
  PRIS_STOP_SCRIPT_PATH.len = 0;
  uVar5 = 0x3b;
  bVar7 = ((ulong)puVar6 & 4) != 0;
  PRIS_STOP_SCRIPT_PATH.arr[0] = '\0';
  PRIS_STOP_SCRIPT_PATH.arr[1] = '\0';
  if (bVar7) {
    PRIS_STOP_SCRIPT_PATH.arr[2] = '\0';
    PRIS_STOP_SCRIPT_PATH.arr[3] = '\0';
    PRIS_STOP_SCRIPT_PATH.arr[4] = '\0';
    PRIS_STOP_SCRIPT_PATH.arr[5] = '\0';
    uVar5 = 0x37;
    puVar6 = PRIS_STOP_SCRIPT_PATH.arr + 6;
  }
  for (uVar4 = (ulong)(uVar5 >> 3); uVar4 != 0; uVar4 = uVar4 - 1) {
    puVar6[0] = '\0';
    puVar6[1] = '\0';
    puVar6[2] = '\0';
    puVar6[3] = '\0';
    puVar6[4] = '\0';
    puVar6[5] = '\0';
    puVar6[6] = '\0';
    puVar6[7] = '\0';
    puVar6 = puVar6 + (ulong)bVar8 * -0x10 + 8;
  }
  if (bVar7) {
    puVar6[0] = '\0';
    puVar6[1] = '\0';
    puVar6[2] = '\0';
    puVar6[3] = '\0';
    puVar6 = puVar6 + 4;
  }
  puVar6[0] = '\0';
  puVar6[1] = '\0';
  puVar6[2] = '\0';
  PRIS_DEVICE_NAME.len = 0;
  puVar6 = PRIS_DEVICE_NAME.arr + 2;
  PRIS_SUBJECT_OF_AUTO_START[0] = '\0';
  PRIS_SUBJECT_OF_AUTO_START[1] = '\0';
  bVar7 = ((ulong)puVar6 & 4) != 0;
  PRIS_SUPPORT_ADM_MESSAGE[0] = '\0';
  PRIS_SUPPORT_ADM_MESSAGE[1] = '\0';
  PRIS_COMMS_ID[0] = '\0';
  PRIS_COMMS_ID[1] = '\0';
  PRIS_COMMS_ID[2] = '\0';
  uVar5 = 0x3f;
  PRIS_CONNECT_MODE[0] = '\0';
  PRIS_CONNECT_MODE[1] = '\0';
  PRIS_DEVICE_NAME.arr[0] = '\0';
  PRIS_DEVICE_NAME.arr[1] = '\0';
  if (bVar7) {
    PRIS_DEVICE_NAME.arr[2] = '\0';
    PRIS_DEVICE_NAME.arr[3] = '\0';
    PRIS_DEVICE_NAME.arr[4] = '\0';
    PRIS_DEVICE_NAME.arr[5] = '\0';
    uVar5 = 0x3b;
    puVar6 = PRIS_DEVICE_NAME.arr + 6;
  }
  for (uVar4 = (ulong)(uVar5 >> 3); uVar4 != 0; uVar4 = uVar4 - 1) {
    puVar6[0] = '\0';
    puVar6[1] = '\0';
    puVar6[2] = '\0';
    puVar6[3] = '\0';
    puVar6[4] = '\0';
    puVar6[5] = '\0';
    puVar6[6] = '\0';
    puVar6[7] = '\0';
    puVar6 = puVar6 + (ulong)bVar8 * -0x10 + 8;
  }
  if (!bVar7) {
    puVar6[0] = '\0';
    puVar6[1] = '\0';
    puVar6[2] = '\0';
    puVar6[3] = '\0';
    puVar6 = puVar6 + 4;
  }
  puVar6[0] = '\0';
  puVar6[1] = '\0';
  puVar6[2] = '\0';
  puVar6 = PRIS_REMOTE_APPLICATION_NAME.arr + 2;
  uVar5 = 0x3f;
  PRIS_REMOTE_APPLICATION_NAME.len = 0;
  bVar7 = ((ulong)puVar6 & 4) != 0;
  PRIS_REMOTE_APPLICATION_NAME.arr[0] = '\0';
  PRIS_REMOTE_APPLICATION_NAME.arr[1] = '\0';
  if (bVar7) {
    PRIS_REMOTE_APPLICATION_NAME.arr[2] = '\0';
    PRIS_REMOTE_APPLICATION_NAME.arr[3] = '\0';
    PRIS_REMOTE_APPLICATION_NAME.arr[4] = '\0';
    PRIS_REMOTE_APPLICATION_NAME.arr[5] = '\0';
    uVar5 = 0x3b;
    puVar6 = PRIS_REMOTE_APPLICATION_NAME.arr + 6;
  }
  for (uVar4 = (ulong)(uVar5 >> 3); uVar4 != 0; uVar4 = uVar4 - 1) {
    puVar6[0] = '\0';
    puVar6[1] = '\0';
    puVar6[2] = '\0';
    puVar6[3] = '\0';
    puVar6[4] = '\0';
    puVar6[5] = '\0';
    puVar6[6] = '\0';
    puVar6[7] = '\0';
    puVar6 = puVar6 + (ulong)bVar8 * -0x10 + 8;
  }
  if (!bVar7) {
    puVar6[0] = '\0';
    puVar6[1] = '\0';
    puVar6[2] = '\0';
    puVar6[3] = '\0';
    puVar6 = puVar6 + 4;
  }
  puVar6[0] = '\0';
  puVar6[1] = '\0';
  puVar6[2] = '\0';
  puVar6 = PRIS_REMOTE_APPLICATION_ID.arr + 2;
  PRIS_REMOTE_APPLICATION_ID.len = 0;
  uVar5 = 0x3f;
  bVar7 = ((ulong)puVar6 & 4) != 0;
  PRIS_REMOTE_APPLICATION_ID.arr[0] = '\0';
  PRIS_REMOTE_APPLICATION_ID.arr[1] = '\0';
  if (bVar7) {
    PRIS_REMOTE_APPLICATION_ID.arr[2] = '\0';
    PRIS_REMOTE_APPLICATION_ID.arr[3] = '\0';
    PRIS_REMOTE_APPLICATION_ID.arr[4] = '\0';
    PRIS_REMOTE_APPLICATION_ID.arr[5] = '\0';
    uVar5 = 0x3b;
    puVar6 = PRIS_REMOTE_APPLICATION_ID.arr + 6;
  }
  for (uVar4 = (ulong)(uVar5 >> 3); uVar4 != 0; uVar4 = uVar4 - 1) {
    puVar6[0] = '\0';
    puVar6[1] = '\0';
    puVar6[2] = '\0';
    puVar6[3] = '\0';
    puVar6[4] = '\0';
    puVar6[5] = '\0';
    puVar6[6] = '\0';
    puVar6[7] = '\0';
    puVar6 = puVar6 + (ulong)bVar8 * -0x10 + 8;
  }
  if (!bVar7) {
    puVar6[0] = '\0';
    puVar6[1] = '\0';
    puVar6[2] = '\0';
    puVar6[3] = '\0';
    puVar6 = puVar6 + 4;
  }
  puVar6[0] = '\0';
  puVar6[1] = '\0';
  puVar6[2] = '\0';
  puVar6 = PRIS_LOCAL_APPLICATION_NAME.arr + 2;
  PRIS_LOCAL_APPLICATION_NAME.len = 0;
  uVar5 = 0x3f;
  bVar7 = ((ulong)puVar6 & 4) != 0;
  PRIS_LOCAL_APPLICATION_NAME.arr[0] = '\0';
  PRIS_LOCAL_APPLICATION_NAME.arr[1] = '\0';
  if (bVar7) {
    PRIS_LOCAL_APPLICATION_NAME.arr[2] = '\0';
    PRIS_LOCAL_APPLICATION_NAME.arr[3] = '\0';
    PRIS_LOCAL_APPLICATION_NAME.arr[4] = '\0';
    PRIS_LOCAL_APPLICATION_NAME.arr[5] = '\0';
    uVar5 = 0x3b;
    puVar6 = PRIS_LOCAL_APPLICATION_NAME.arr + 6;
  }
  for (uVar4 = (ulong)(uVar5 >> 3); uVar4 != 0; uVar4 = uVar4 - 1) {
    puVar6[0] = '\0';
    puVar6[1] = '\0';
    puVar6[2] = '\0';
    puVar6[3] = '\0';
    puVar6[4] = '\0';
    puVar6[5] = '\0';
    puVar6[6] = '\0';
    puVar6[7] = '\0';
    puVar6 = puVar6 + (ulong)bVar8 * -0x10 + 8;
  }
  if (!bVar7) {
    puVar6[0] = '\0';
    puVar6[1] = '\0';
    puVar6[2] = '\0';
    puVar6[3] = '\0';
    puVar6 = puVar6 + 4;
  }
  puVar6[0] = '\0';
  puVar6[1] = '\0';
  puVar6[2] = '\0';
  puVar6 = PRIS_LOCAL_APPLICATION_ID.arr + 2;
  PRIS_LOCAL_APPLICATION_ID.len = 0;
  uVar5 = 0x3f;
  bVar7 = ((ulong)puVar6 & 4) != 0;
  PRIS_LOCAL_APPLICATION_ID.arr[0] = '\0';
  PRIS_LOCAL_APPLICATION_ID.arr[1] = '\0';
  if (bVar7) {
    PRIS_LOCAL_APPLICATION_ID.arr[2] = '\0';
    PRIS_LOCAL_APPLICATION_ID.arr[3] = '\0';
    PRIS_LOCAL_APPLICATION_ID.arr[4] = '\0';
    PRIS_LOCAL_APPLICATION_ID.arr[5] = '\0';
    uVar5 = 0x3b;
    puVar6 = PRIS_LOCAL_APPLICATION_ID.arr + 6;
  }
  for (uVar4 = (ulong)(uVar5 >> 3); uVar4 != 0; uVar4 = uVar4 - 1) {
    puVar6[0] = '\0';
    puVar6[1] = '\0';
    puVar6[2] = '\0';
    puVar6[3] = '\0';
    puVar6[4] = '\0';
    puVar6[5] = '\0';
    puVar6[6] = '\0';
    puVar6[7] = '\0';
    puVar6 = puVar6 + (ulong)bVar8 * -0x10 + 8;
  }
  if (!bVar7) {
    puVar6[0] = '\0';
    puVar6[1] = '\0';
    puVar6[2] = '\0';
    puVar6[3] = '\0';
    puVar6 = puVar6 + 4;
  }
  puVar6[0] = '\0';
  puVar6[1] = '\0';
  puVar6[2] = '\0';
  PRIS_LOG_FILE_NAME.len = 0;
  PRIS_INTERNAL_ID.len = 0;
  PRIS_TRACE_LEVEL[0] = '\0';
  PRIS_TRACE_LEVEL[1] = '\0';
  PRIS_BANK_CODE[4] = '\0';
  PRIS_BANK_CODE[5] = '\0';
  PRIS_GEN_REVERSAL_TIMEOUT_LATE[0] = '\0';
  PRIS_GEN_REVERSAL_TIMEOUT_LATE[1] = '\0';
  RESOURCE_LIVE[0] = '\0';
  RESOURCE_LIVE[1] = '\0';
  PRIS_LOG_FILE_NAME.arr[0] = '\0';
  PRIS_LOG_FILE_NAME.arr[1] = '\0';
  PRIS_LOG_FILE_NAME.arr[2] = '\0';
  PRIS_LOG_FILE_NAME.arr[3] = '\0';
  PRIS_LOG_FILE_NAME.arr[4] = '\0';
  PRIS_LOG_FILE_NAME.arr[5] = '\0';
  PRIS_LOG_FILE_NAME.arr[6] = '\0';
  PRIS_LOG_FILE_NAME.arr[7] = '\0';
  PRIS_LOG_FILE_NAME.arr[8] = '\0';
  PRIS_LOG_FILE_NAME.arr[9] = '\0';
  PRIS_LOG_FILE_NAME.arr[10] = '\0';
  PRIS_LOG_FILE_NAME.arr[0xb] = '\0';
  PRIS_LOG_FILE_NAME.arr[0xc] = '\0';
  PRIS_LOG_FILE_NAME.arr[0xd] = '\0';
  PRIS_LOG_FILE_NAME.arr[0xe] = '\0';
  PRIS_LOG_FILE_NAME.arr[0xf] = '\0';
  PRIS_LOG_FILE_NAME.arr[0x10] = '\0';
  PRIS_LOG_FILE_NAME.arr[0x11] = '\0';
  PRIS_LOG_FILE_NAME.arr[0x12] = '\0';
  PRIS_LOG_FILE_NAME.arr[0x13] = '\0';
  PRIS_LOG_FILE_NAME.arr[0x14] = '\0';
  PRIS_LOG_MAX_SIZE = 0;
  PRIS_START_CYCLE = 0;
  PRIS_END_CYCLE = 0;
  PRIS_NB_STATIC_THREADS = 0;
  PRIS_NB_USER_THREADS_VS_KERNEL = 0;
  PRIS_TIMER_ACQUIRER = 0;
  PRIS_DELTA_TIMER_ISS_ACQ = 0;
  PRIS_ECHO_TEST_TIMER = 0;
  PRIS_TRANSACTION_SIM_MAX = 0;
  PRIS_CURRENT_CYCLE = 0;
  PRIS_PROCESSING_STEP[0] = '\0';
  PRIS_PROCESSING_STEP[1] = '\0';
  PRIS_PROCESSING_STEP[2] = '\0';
  PRIS_PROCESSING_STEP[3] = '\0';
  PRIS_INTERNAL_ID.arr[0] = '\0';
  PRIS_INTERNAL_ID.arr[1] = '\0';
  PRIS_INTERNAL_ID.arr[2] = '\0';
  PRIS_INTERNAL_ID.arr[3] = '\0';
  PRIS_INTERNAL_ID.arr[4] = '\0';
  PRIS_INTERNAL_ID.arr[5] = '\0';
  PRIS_INTERNAL_ID.arr[6] = '\0';
  PRIS_INTERNAL_ID.arr[7] = '\0';
  PRIS_INTERNAL_ID.arr[8] = '\0';
  PRIS_INTERNAL_ID.arr[9] = '\0';
  PRIS_INTERNAL_ID.arr[10] = '\0';
  PRIS_INTERNAL_ID.arr[0xb] = '\0';
  PRIS_INTERNAL_ID.arr[0xc] = '\0';
  PRIS_INTERNAL_ID.arr[0xd] = '\0';
  PRIS_INTERNAL_ID.arr[0xe] = '\0';
  PRIS_INTERNAL_ID.arr[0xf] = '\0';
  PRIS_INTERNAL_ID.arr[0x10] = '\0';
  PRIS_INTERNAL_ID.arr[0x11] = '\0';
  PRIS_INTERNAL_ID.arr[0x12] = '\0';
  PRIS_INTERNAL_ID.arr[0x13] = '\0';
  PRIS_INTERNAL_ID.arr[0x14] = '\0';
  PRIS_INTERNAL_ID.arr[0x15] = '\0';
  PRIS_INTERNAL_ID.arr[0x16] = '\0';
  PRIS_INTERNAL_ID.arr[0x17] = '\0';
  PRIS_INTERNAL_ID.arr[0x18] = '\0';
  PRIS_INTERNAL_ID.arr[0x19] = '\0';
  PRIS_INTERNAL_ID.arr[0x1a] = '\0';
  PRIS_INTERNAL_ID.arr[0x1b] = '\0';
  PRIS_INTERNAL_ID.arr[0x1c] = '\0';
  PRIS_INTERNAL_ID.arr[0x1d] = '\0';
  PRIS_INTERNAL_ID.arr[0x1e] = '\0';
  PRIS_INTERNAL_ID.arr[0x1f] = '\0';
  PRIS_INTERNAL_ID.arr[0x20] = '\0';
  PRIS_BANK_CODE[0] = '\0';
  PRIS_BANK_CODE[1] = '\0';
  PRIS_BANK_CODE[2] = '\0';
  PRIS_BANK_CODE[3] = '\0';
  PRIS_BANK_CODE[6] = '\0';
  RESOURCE_ID._0_4_ = *(undefined4 *)resources->resource_id;
  detail._64_8_ = &sqltds;
  detail._56_8_ = &sqladt;
  PRIS_PID = 0;
  RESOURCE_ID._4_2_ = *(undefined2 *)(resources->resource_id + 4);
  PRIS_MIN_TROUBLES_IND = 0;
  PRIS_MAX_TROUBLES_IND = 0;
  response_code = 0x38d;
  detail[0] = '\f';
  detail[1] = '\0';
  detail[2] = '\0';
  detail[3] = '\0';
  detail[4] = '\0';
  detail[5] = '\0';
  detail[6] = '\0';
  detail[7] = '\0';
  lVar1 = (long)nIndiceCtx * 0x10 + 0x713948;
  detail[8] = '+';
  detail[9] = '\0';
  detail[10] = '\0';
  detail[0xb] = '\0';
  sqlbuft(lVar1,
          "declare T_RESOURCES RESOURCES % ROWTYPE ; BEGIN :response_code := PCRD_GET_PARAM_GENERAL_ROWS . GET_RESOURCES ( :RESOURCE_ID , T_RESOURCES ) ; IF :response_code = 0 THEN :RESOURCE_CODE := NVL ( T_RESOURCES . RESOURCE_CODE , LPAD ( \' \' , 2 ) ) ; :RESOURCE_NAME := NVL ( T_RESOURCES . ABRV_WORDING , LPAD ( \' \' , 16 ) ) ; :COMPONENT_TYPE := NVL ( T_RESOURCES . COMPONENT_TYPE , LPAD ( \' \' , 4 ) ) ; :STATUS := NVL ( T_RESOURCES . STATUS , LPAD ( \' \' , 1 ) ) ; :SUBJECT_OF_SUPERVISE := NVL ( T_RESOURCES . SUBJECT_OF_SUPERVISE , LPAD ( \' \' , 1 ) ) ; :OBJECT_NAME := NVL ( T_RESOURCES . OBJECT_NAME , LPAD ( \' \' , 60 ) ) ; :PRIS_OBJECT_PATH := NVL ( T_RESOURCES . PRIS_OBJECT_PATH , LPAD ( \' \' , 60 ) ) ; :PRIS_START_SCRIPT_NAME := NVL ( T_RESOURCES . PRIS_START_SCRIPT_NAME , LPAD ( \' \' , 40 ) ) ; :PRIS_START_SCRIPT_PATH := NVL ( T_RESOURCES . PRIS_START_SCRIPT_PATH , LPAD ( \' \' , 60 ) ) ; :PRIS_STOP_SCRIPT_NAME := NVL ( T_RESOURCES . PRIS_STOP_SCRIPT_NAME , LPAD ( \' \' , 40 ) ) ; :PRIS_STOP_SCRIPT_PATH := NVL ( T_RESOURCES"
         );
  sqlbuft(lVar1,
          " . PRIS_STOP_SCRIPT_PATH , LPAD ( \' \' , 60 ) ) ; :PRIS_SUBJECT_OF_AUTO_START := NVL ( T_RESOURCES . PRIS_SUBJECT_OF_AUTO_START , LPAD ( \' \' , 1 ) ) ; :PRIS_SUPPORT_ADM_MESSAGE := NVL ( T_RESOURCES . PRIS_SUPPORT_ADM_MESSAGE , LPAD ( \' \' , 1 ) ) ; :PRIS_START_CYCLE := NVL ( T_RESOURCES . PRIS_START_CYCLE , -1 ) ; :PRIS_END_CYCLE := NVL ( T_RESOURCES . PRIS_END_CYCLE , -1 ) ; :PRIS_ECHO_TEST_TIMER := NVL ( T_RESOURCES . PRIS_ECHO_TEST_TIMER , -1 ) ; :PRIS_TRANSACTION_SIM_MAX := NVL ( T_RESOURCES . PRIS_TRANSACTION_SIM_MAX , -1 ) ; :PRIS_CURRENT_CYCLE := NVL ( T_RESOURCES . PRIS_CURRENT_CYCLE , -1 ) ; :PRIS_INTERNAL_ID := NVL ( T_RESOURCES . PRIS_INTERNAL_ID , LPAD ( \' \' , 32 ) ) ; :PRIS_LOG_FILE_NAME := NVL ( T_RESOURCES . PRIS_LOG_FILE_NAME , LPAD ( \' \' , 20 ) ) ; :PRIS_LOG_MAX_SIZE := NVL ( T_RESOURCES . PRIS_LOG_MAX_SIZE , 1024 ) ; :PRIS_TRACE_LEVEL := NVL ( T_RESOURCES . PRIS_TRACE_LEVEL , LPAD ( \' \' , 1 ) ) ; :PRIS_COMMS_ID := NVL ( T_RESOURCES . PRIS_COMMS_ID , LPAD ( \' \' , 2 ) ) ; :PRIS_CONNECT_MODE := N"
         );
  sqlbuft(lVar1,
          "VL ( T_RESOURCES . PRIS_CONNECT_MODE , LPAD ( \' \' , 1 ) ) ; :PRIS_DEVICE_NAME := NVL ( T_RESOURCES . PRIS_DEVICE_NAME , LPAD ( \' \' , 64 ) ) ; :PRIS_REMOTE_APPLICATION_NAME := NVL ( T_RESOURCES . PRIS_REMOTE_APPLICATION_NAME , LPAD ( \' \' , 64 ) ) ; :PRIS_REMOTE_APPLICATION_ID := NVL ( T_RESOURCES . PRIS_REMOTE_APPLICATION_ID , LPAD ( \' \' , 64 ) ) ; :PRIS_LOCAL_APPLICATION_NAME := NVL ( T_RESOURCES . PRIS_LOCAL_APPLICATION_NAME , LPAD ( \' \' , 64 ) ) ; :PRIS_LOCAL_APPLICATION_ID := NVL ( T_RESOURCES . PRIS_LOCAL_APPLICATION_ID , LPAD ( \' \' , 64 ) ) ; :PRIS_NB_STATIC_THREADS := NVL ( T_RESOURCES . PRIS_NB_STATIC_THREADS , -1 ) ; :PRIS_NB_USER_THREADS_VS_KERNEL := NVL ( T_RESOURCES . PRIS_NB_USER_THREADS_VS_KERNEL , -1 ) ; :PRIS_TIMER_ACQUIRER := NVL ( T_RESOURCES . PRIS_TIMER_ACQUIRER , -1 ) ; :PRIS_DELTA_TIMER_ISS_ACQ := NVL ( T_RESOURCES . PRIS_DELTA_TIMER_ISS_ACQ , -1 ) ; :PRIS_GEN_REVERSAL_TIMEOUT_LATE := NVL ( T_RESOURCES . PRIS_GEN_REVERSAL_TIMEOUT_LATE , LPAD ( \' \' , 1 ) ) ; :RESOURCE_LIVE := NVL ( T_RESOU"
         );
  detail._176_8_ = &response_code;
  detail._40_8_ = &sqlca;
  local_f0 = 0;
  local_9a = 0;
  local_ee = 0;
  detail._192_8_ = RESOURCE_CODE;
  local_98 = 0;
  local_ec = 0;
  detail._48_8_ = s_RCES___RESOURCE_LIVE___LPAD_______004c6188;
  detail._32_8_ = sqlcud0;
  detail[0x16] = '\0';
  detail[0x17] = '\x11';
  detail[0xc] = '\x01';
  detail[0xd] = '\0';
  detail[0xe] = '\0';
  detail[0xf] = '\0';
  detail[0x10] = '\x05';
  detail[0x11] = '\0';
  detail[0x12] = '\0';
  detail[0x13] = '\0';
  detail[0x18] = '\0';
  detail[0x19] = '\0';
  detail[0x1a] = '\0';
  detail[0x1b] = '\0';
  local_7b0 = 4;
  local_658 = 0;
  local_5a8 = 0;
  local_450 = 0;
  local_3a0 = 0;
  local_7a8 = 7;
  local_654 = 0;
  local_5a0 = 0;
  local_44c = 0;
  local_398 = 0;
  local_7a0 = 3;
  local_650 = 0;
  local_598 = 0;
  local_448 = 0;
  local_390 = 0;
  local_96 = 0;
  local_ea = 0;
  detail._216_8_ = STATUS;
  local_e8 = 0;
  local_e6 = 0;
  local_90 = 0;
  detail._224_8_ = SUBJECT_OF_SUPERVISE;
  local_94 = 0;
  local_92 = 0;
  local_e4 = 0;
  local_798 = 0x13;
  local_64c = 0;
  local_590 = 0;
  local_444 = 0;
  local_388 = 0;
  local_790 = 7;
  local_648 = 0;
  local_588 = 0;
  local_440 = 0;
  local_380 = 0;
  local_788 = 2;
  local_644 = 0;
  local_580 = 0;
  local_43c = 0;
  local_378 = 0;
  local_780 = 2;
  local_640 = 0;
  local_578 = 0;
  local_438 = 0;
  local_370 = 0;
  local_8e = 0;
  local_e0 = 0;
  local_8a = 0;
  local_e2 = 0;
  local_de = 0;
  local_8c = 0;
  local_88 = 0;
  local_778 = 0x3f;
  local_63c = 0;
  local_570 = 0;
  local_434 = 0;
  local_368 = 0;
  local_770 = 0x3f;
  local_638 = 0;
  local_568 = 0;
  local_430 = 0;
  local_360 = 0;
  local_768 = 0x2b;
  local_634 = 0;
  local_560 = 0;
  local_42c = 0;
  local_358 = 0;
  local_760 = 0x3f;
  local_630 = 0;
  local_558 = 0;
  local_428 = 0;
  local_350 = 0;
  local_dc = 0;
  local_86 = 0;
  detail._280_8_ = PRIS_SUBJECT_OF_AUTO_START;
  local_84 = 0;
  detail._288_8_ = PRIS_SUPPORT_ADM_MESSAGE;
  local_82 = 0;
  local_d6 = 0;
  detail._296_8_ = &PRIS_START_CYCLE;
  local_da = 0;
  local_80 = 0;
  local_d8 = 0;
  local_758 = 0x2b;
  local_62c = 0;
  local_550 = 0;
  local_424 = 0;
  local_348 = 0;
  local_750 = 0x3f;
  local_628 = 0;
  local_548 = 0;
  local_420 = 0;
  local_340 = 0;
  local_748 = 2;
  local_624 = 0;
  local_540 = 0;
  local_41c = 0;
  local_338 = 0;
  local_740 = 2;
  local_620 = 0;
  local_538 = 0;
  local_418 = 0;
  local_330 = 0;
  local_7c = 0;
  detail._304_8_ = &PRIS_END_CYCLE;
  local_d4 = 0;
  local_7e = 0;
  local_d2 = 0;
  local_738 = 4;
  local_d0 = 0;
  local_61c = 0;
  local_7a = 0;
  detail._312_8_ = &PRIS_ECHO_TEST_TIMER;
  local_530 = 0;
  local_414 = 0;
  local_328 = 0;
  local_730 = 4;
  local_ce = 0;
  local_618 = 0;
  local_78 = 0;
  detail._320_8_ = &PRIS_TRANSACTION_SIM_MAX;
  local_528 = 0;
  local_410 = 0;
  local_320 = 0;
  local_728 = 8;
  local_cc = 0;
  detail._328_8_ = &PRIS_CURRENT_CYCLE;
  local_614 = 0;
  local_520 = 0;
  local_40c = 0;
  local_318 = 0;
  local_720 = 4;
  local_610 = 0;
  local_518 = 0;
  local_408 = 0;
  local_310 = 0;
  local_76 = 0;
  local_ca = 0;
  detail._352_8_ = &PRIS_LOG_MAX_SIZE;
  local_74 = 0;
  local_c8 = 0;
  local_72 = 0;
  local_c6 = 0;
  local_70 = 0;
  local_c4 = 0;
  local_6e = 0;
  local_718 = 4;
  local_60c = 0;
  local_510 = 0;
  local_404 = 0;
  local_308 = 0;
  local_710 = 0x23;
  local_608 = 0;
  local_508 = 0;
  local_400 = 0;
  local_300 = 0;
  local_708 = 0x17;
  local_604 = 0;
  local_500 = 0;
  local_3fc = 0;
  local_2f8 = 0;
  local_700 = 4;
  local_600 = 0;
  local_4f8 = 0;
  local_3f8 = 0;
  local_2f0 = 0;
  local_6c = 0;
  local_c0 = 0;
  local_6a = 0;
  detail._376_8_ = PRIS_CONNECT_MODE;
  local_c2 = 0;
  detail._368_8_ = PRIS_COMMS_ID;
  local_6f8 = 2;
  local_5fc = 0;
  local_be = 0;
  local_68 = 0;
  local_66 = 0;
  local_bc = 0;
  local_4f0 = 0;
  detail._424_8_ = &PRIS_NB_STATIC_THREADS;
  local_3f4 = 0;
  local_2e8 = 0;
  local_6f0 = 3;
  local_5f8 = 0;
  local_4e8 = 0;
  local_3f0 = 0;
  local_2e0 = 0;
  local_6e8 = 2;
  local_5f4 = 0;
  local_4e0 = 0;
  local_3ec = 0;
  local_2d8 = 0;
  local_6e0 = 0x43;
  local_5f0 = 0;
  local_4d8 = 0;
  local_3e8 = 0;
  local_2d0 = 0;
  local_64 = 0;
  local_ba = 0;
  local_b8 = 0;
  local_62 = 0;
  local_b6 = 0;
  local_60 = 0;
  local_b4 = 0;
  local_6d8 = 0x43;
  local_5ec = 0;
  local_4d0 = 0;
  local_3e4 = 0;
  local_2c8 = 0;
  local_6d0 = 0x43;
  local_5e8 = 0;
  local_4c8 = 0;
  local_3e0 = 0;
  local_2c0 = 0;
  local_6c8 = 0x43;
  local_5e4 = 0;
  local_4c0 = 0;
  local_3dc = 0;
  local_2b8 = 0;
  local_6c0 = 0x43;
  local_5e0 = 0;
  local_4b8 = 0;
  local_3d8 = 0;
  local_2b0 = 0;
  local_5e = 0;
  local_b2 = 0;
  local_ac = 0;
  local_5c = 0;
  detail._432_8_ = &PRIS_NB_USER_THREADS_VS_KERNEL;
  local_56 = 0;
  local_6b8 = 4;
  local_5dc = 0;
  local_4b0 = 0;
  local_b0 = 0;
  local_3d4 = 0;
  local_5a = 0;
  detail._440_8_ = &PRIS_TIMER_ACQUIRER;
  local_2a8 = 0;
  local_6b0 = 4;
  local_5d8 = 0;
  local_4a8 = 0;
  local_ae = 0;
  local_3d0 = 0;
  local_58 = 0;
  detail._448_8_ = &PRIS_DELTA_TIMER_ISS_ACQ;
  local_2a0 = 0;
  local_6a8 = 4;
  local_5d4 = 0;
  local_4a0 = 0;
  local_3cc = 0;
  local_298 = 0;
  local_6a0 = 4;
  local_5d0 = 0;
  local_498 = 0;
  local_3c8 = 0;
  local_290 = 0;
  detail._480_8_ = &PRIS_PID;
  local_50 = 0;
  local_aa = 0;
  local_54 = 0;
  local_4e = 0;
  local_a8 = 0;
  local_52 = 0;
  local_a6 = 0;
  local_a4 = 0;
  local_698 = 2;
  local_5cc = 0;
  local_490 = 0;
  local_3c4 = 0;
  local_288 = 0;
  local_690 = 2;
  local_5c8 = 0;
  local_488 = 0;
  local_3c0 = 0;
  local_280 = 0;
  local_688 = 4;
  local_5c4 = 0;
  local_480 = 0;
  local_3bc = 0;
  local_278 = 0;
  local_680 = 4;
  local_5c0 = 0;
  local_478 = 0;
  local_3b8 = 0;
  local_270 = 0;
  local_678 = 7;
  local_a2 = 0;
  local_4c = 0;
  detail._496_8_ = &PRIS_MIN_TROUBLES_IND;
  local_48 = 0;
  local_5bc = 0;
  local_470 = 0;
  local_3b4 = 0;
  local_a0 = 0;
  local_268 = 0;
  local_4a = 0;
  detail._504_8_ = &PRIS_MAX_TROUBLES_IND;
  local_670 = 4;
  local_5b8 = 0;
  local_468 = 0;
  local_9e = 0;
  detail._72_8_ = detail + 0xb0;
  local_9c = 0;
  local_46 = 0;
  detail._80_8_ = &local_7b0;
  local_3b0 = 0;
  local_260 = 0;
  local_668 = 4;
  detail._88_8_ = &local_658;
  local_5b4 = 0;
  local_460 = 0;
  local_3ac = 0;
  detail._96_8_ = &local_5a8;
  local_258 = 0;
  local_660 = 3;
  local_5b0 = 0;
  local_458 = 0;
  local_3a8 = 0;
  local_250 = 0;
  detail._104_8_ = &local_450;
  detail._112_8_ = &local_3a0;
  detail._120_8_ = local_248;
  detail._128_8_ = &local_f0;
  detail._136_8_ = &local_9a;
  detail._184_8_ = RESOURCE_ID;
  detail._200_8_ = &RESOURCE_NAME;
  detail._208_8_ = &COMPONENT_TYPE;
  detail._232_8_ = &OBJECT_NAME;
  detail._240_8_ = &PRIS_OBJECT_PATH;
  detail._248_8_ = &PRIS_START_SCRIPT_NAME;
  detail._256_8_ = &PRIS_START_SCRIPT_PATH;
  detail._264_8_ = &PRIS_STOP_SCRIPT_NAME;
  detail._272_8_ = &PRIS_STOP_SCRIPT_PATH;
  detail._336_8_ = &PRIS_INTERNAL_ID;
  detail._344_8_ = &PRIS_LOG_FILE_NAME;
  detail._360_8_ = PRIS_TRACE_LEVEL;
  detail._384_8_ = &PRIS_DEVICE_NAME;
  detail._392_8_ = &PRIS_REMOTE_APPLICATION_NAME;
  detail._400_8_ = &PRIS_REMOTE_APPLICATION_ID;
  detail._408_8_ = &PRIS_LOCAL_APPLICATION_NAME;
  detail._416_8_ = &PRIS_LOCAL_APPLICATION_ID;
  detail._456_8_ = PRIS_GEN_REVERSAL_TIMEOUT_LATE;
  detail._464_8_ = RESOURCE_LIVE;
  detail._472_8_ = PRIS_PROCESSING_STEP;
  detail._488_8_ = PRIS_BANK_CODE;
  sqlcxt(lVar1,&sqlctx,detail,&sqlfpn);
  if (sqlca.sqlcode < 0) {
    strcpy(detail,sqlca.sqlerrm.sqlerrmc);
  }
  else if (response_code == 0) {
    uVar4 = (ulong)RESOURCE_NAME.len;
    *(undefined2 *)resources->resource_code = RESOURCE_CODE._0_2_;
    memcpy(resources->resource_name,RESOURCE_NAME.arr,uVar4);
    resources->resource_name[uVar4] = '\0';
    uVar4 = (ulong)COMPONENT_TYPE.len;
    memcpy(resources->component_type,COMPONENT_TYPE.arr,uVar4);
    resources->component_type[uVar4] = '\0';
    uVar4 = (ulong)OBJECT_NAME.len;
    resources->status[0] = STATUS[0];
    resources->subject_of_supervise[0] = SUBJECT_OF_SUPERVISE[0];
    memcpy(resources->object_name,OBJECT_NAME.arr,uVar4);
    resources->object_name[uVar4] = '\0';
    uVar4 = (ulong)PRIS_OBJECT_PATH.len;
    memcpy(resources->pris_object_path,PRIS_OBJECT_PATH.arr,uVar4);
    resources->pris_object_path[uVar4] = '\0';
    uVar4 = (ulong)PRIS_START_SCRIPT_NAME.len;
    resources->ipc_critical_level_nb_msg = 0;
    resources->ipc_critical_percent_freespace = 0;
    resources->ufs_critical_percent_freespace = 0;
    resources->ufs_critical_size_freespace = 0;
    resources->dbts_critical_count_extent = 0;
    memcpy(resources->pris_start_script_name,PRIS_START_SCRIPT_NAME.arr,uVar4);
    resources->pris_start_script_name[uVar4] = '\0';
    uVar4 = (ulong)PRIS_START_SCRIPT_PATH.len;
    memcpy(resources->pris_start_script_path,PRIS_START_SCRIPT_PATH.arr,uVar4);
    resources->pris_start_script_path[uVar4] = '\0';
    uVar4 = (ulong)PRIS_STOP_SCRIPT_NAME.len;
    memcpy(resources->pris_stop_script_name,PRIS_STOP_SCRIPT_NAME.arr,uVar4);
    resources->pris_stop_script_name[uVar4] = '\0';
    uVar4 = (ulong)PRIS_STOP_SCRIPT_PATH.len;
    memcpy(resources->pris_stop_script_path,PRIS_STOP_SCRIPT_PATH.arr,uVar4);
    uVar2 = PRIS_DEVICE_NAME.len;
    resources->pris_stop_script_path[uVar4] = '\0';
    resources->pris_subject_of_auto_start[0] = PRIS_SUBJECT_OF_AUTO_START[0];
    resources->pris_support_adm_message[0] = PRIS_SUPPORT_ADM_MESSAGE[0];
    *(undefined2 *)resources->pris_comms_id = PRIS_COMMS_ID._0_2_;
    resources->pris_connect_mode[0] = PRIS_CONNECT_MODE[0];
    pcVar3 = (char *)memcpy(resources->pris_device_name,PRIS_DEVICE_NAME.arr,
                            (ulong)PRIS_DEVICE_NAME.len);
    resources->pris_device_name[(int)(uint)uVar2] = '\0';
    trim(pcVar3,(uint)uVar2);
    uVar2 = PRIS_REMOTE_APPLICATION_NAME.len;
    pcVar3 = (char *)memcpy(resources->pris_remote_application_name,PRIS_REMOTE_APPLICATION_NAME.arr
                            ,(ulong)PRIS_REMOTE_APPLICATION_NAME.len);
    resources->pris_remote_application_name[(int)(uint)uVar2] = '\0';
    trim(pcVar3,(uint)uVar2);
    uVar2 = PRIS_REMOTE_APPLICATION_ID.len;
    pcVar3 = (char *)memcpy(resources->pris_remote_application_id,PRIS_REMOTE_APPLICATION_ID.arr,
                            (ulong)PRIS_REMOTE_APPLICATION_ID.len);
    resources->pris_remote_application_id[(int)(uint)uVar2] = '\0';
    trim(pcVar3,(uint)uVar2);
    uVar2 = PRIS_LOCAL_APPLICATION_NAME.len;
    pcVar3 = (char *)memcpy(resources->pris_local_application_name,PRIS_LOCAL_APPLICATION_NAME.arr,
                            (ulong)PRIS_LOCAL_APPLICATION_NAME.len);
    resources->pris_local_application_name[(int)(uint)uVar2] = '\0';
    trim(pcVar3,(uint)uVar2);
    uVar2 = PRIS_LOCAL_APPLICATION_ID.len;
    pcVar3 = (char *)memcpy(resources->pris_local_application_id,PRIS_LOCAL_APPLICATION_ID.arr,
                            (ulong)PRIS_LOCAL_APPLICATION_ID.len);
    resources->pris_local_application_id[(int)(uint)uVar2] = '\0';
    trim(pcVar3,(uint)uVar2);
    uVar4 = (ulong)PRIS_LOG_FILE_NAME.len;
    memcpy(resources->pris_log_file_name,PRIS_LOG_FILE_NAME.arr,uVar4);
    resources->pris_log_file_name[uVar4] = '\0';
    uVar4 = (ulong)PRIS_INTERNAL_ID.len;
    resources->pris_log_max_size = PRIS_LOG_MAX_SIZE;
    resources->pris_start_cycle = PRIS_START_CYCLE;
    resources->pris_end_cycle = PRIS_END_CYCLE;
    resources->pris_trace_level[0] = PRIS_TRACE_LEVEL[0];
    resources->pris_nb_static_threads = PRIS_NB_STATIC_THREADS;
    resources->pris_nb_user_threads_vs_kernel = PRIS_NB_USER_THREADS_VS_KERNEL;
    resources->pris_timer_acquirer = PRIS_TIMER_ACQUIRER;
    resources->pris_delta_timer_iss_acq = PRIS_DELTA_TIMER_ISS_ACQ;
    resources->pris_echo_test_timer = PRIS_ECHO_TEST_TIMER;
    resources->pris_transaction_sim_max = PRIS_TRANSACTION_SIM_MAX;
    resources->pris_gen_reversal_timeout_late[0] = PRIS_GEN_REVERSAL_TIMEOUT_LATE[0];
    resources->pris_current_cycle = PRIS_CURRENT_CYCLE;
    resources->resource_live[0] = RESOURCE_LIVE[0];
    *(undefined2 *)resources->pris_processing_step = PRIS_PROCESSING_STEP._0_2_;
    resources->pris_processing_step[2] = PRIS_PROCESSING_STEP[2];
    memcpy(resources->pris_internal_id,PRIS_INTERNAL_ID.arr,uVar4);
    *(undefined4 *)resources->pris_bank_code = PRIS_BANK_CODE._0_4_;
    *(undefined2 *)(resources->pris_bank_code + 4) = PRIS_BANK_CODE._4_2_;
    resources->pris_internal_id[uVar4] = '\0';
    resources->pris_pid = PRIS_PID;
    resources->pris_ppid = 0;
    resources->pris_min_troubles_ind = PRIS_MIN_TROUBLES_IND;
    resources->pris_max_troubles_ind = PRIS_MAX_TROUBLES_IND;
    resources->pris_protocol_id[0] = '\0';
    resources->pris_protocol_id[1] = '\0';
    EmptyQueue(nBalMsg,(ulong)(uint)PRIS_PID);
    EmptyQueue(nBalAdm,(ulong)(uint)resources->pris_pid);
    fwrite("End   GetResources(OK) \n",1,0x18,stderr);
    return 0;
  }
  fprintf(stderr,"End GetResources (NOK) :%s\n",sqlca.sqlerrm.sqlerrmc);
  return -1;
}



// WARNING: Removing unreachable block (ram,0x00440cc4)
// WARNING: Removing unreachable block (ram,0x00440c90)
// WARNING: Removing unreachable block (ram,0x00440ca4)
// WARNING: Removing unreachable block (ram,0x0044096b)
// WARNING: Unknown calling convention

int GetGlobalsVar(int nIndiceCtx,char *variable_name,char *variable_value)

{
  uchar *puVar1;
  uint uVar2;
  size_t __n;
  uchar *puVar3;
  ulong uVar4;
  uint uVar5;
  bool bVar6;
  byte bVar7;
  uchar auStack_2324 [8088];
  int response_code;
  anon_struct_34_2_43c7b5cf VARIABLE_NAME;
  anon_struct_132_2_43c7b5cf VARIABLE_VALUE;
  sqlca sqlca;
  char detail [512];
  
  bVar7 = 0;
  puts("Start GetGlobalsVar() ");
  trace_event("Start GetGlobalsVar() ",5);
  puVar3 = VARIABLE_NAME.arr + 2;
  uVar5 = 0x1d;
  VARIABLE_NAME.len = 0;
  VARIABLE_VALUE.len = 0;
  bVar6 = ((ulong)puVar3 & 4) != 0;
  VARIABLE_NAME.arr[0] = '\0';
  VARIABLE_NAME.arr[1] = '\0';
  if (bVar6) {
    VARIABLE_NAME.arr[2] = '\0';
    VARIABLE_NAME.arr[3] = '\0';
    VARIABLE_NAME.arr[4] = '\0';
    VARIABLE_NAME.arr[5] = '\0';
    uVar5 = 0x19;
    puVar3 = VARIABLE_NAME.arr + 6;
  }
  uVar4 = 0;
  do {
    uVar2 = (int)uVar4 + 8;
    puVar1 = puVar3 + uVar4;
    puVar1[0] = '\0';
    puVar1[1] = '\0';
    puVar1[2] = '\0';
    puVar1[3] = '\0';
    puVar1[4] = '\0';
    puVar1[5] = '\0';
    puVar1[6] = '\0';
    puVar1[7] = '\0';
    uVar4 = (ulong)uVar2;
  } while (uVar2 < (uVar5 & 0xfffffff8));
  puVar3 = puVar3 + uVar2;
  if (!bVar6) {
    puVar3[0] = '\0';
    puVar3[1] = '\0';
    puVar3[2] = '\0';
    puVar3[3] = '\0';
    puVar3 = puVar3 + 4;
  }
  *puVar3 = '\0';
  uVar5 = 0x7f;
  VARIABLE_VALUE.arr[0] = '\0';
  VARIABLE_VALUE.arr[1] = '\0';
  puVar3 = VARIABLE_VALUE.arr + 2;
  bVar6 = ((ulong)puVar3 & 4) != 0;
  if (bVar6) {
    VARIABLE_VALUE.arr[2] = '\0';
    VARIABLE_VALUE.arr[3] = '\0';
    VARIABLE_VALUE.arr[4] = '\0';
    VARIABLE_VALUE.arr[5] = '\0';
    uVar5 = 0x7b;
    puVar3 = VARIABLE_VALUE.arr + 6;
  }
  for (uVar4 = (ulong)(uVar5 >> 3); uVar4 != 0; uVar4 = uVar4 - 1) {
    puVar3[0] = '\0';
    puVar3[1] = '\0';
    puVar3[2] = '\0';
    puVar3[3] = '\0';
    puVar3[4] = '\0';
    puVar3[5] = '\0';
    puVar3[6] = '\0';
    puVar3[7] = '\0';
    puVar3 = puVar3 + (ulong)bVar7 * -0x10 + 8;
  }
  if (!bVar6) {
    puVar3[0] = '\0';
    puVar3[1] = '\0';
    puVar3[2] = '\0';
    puVar3[3] = '\0';
    puVar3 = puVar3 + 4;
  }
  puVar3[0] = '\0';
  puVar3[1] = '\0';
  puVar3[2] = '\0';
  __n = strlen(variable_name);
  VARIABLE_NAME.len = (ushort)__n;
  memcpy(VARIABLE_NAME.arr,variable_name,__n);
  detail._56_8_ = &sqladt;
  detail[0x16] = '\0';
  detail[0x17] = '\x11';
  detail[0x148] = '\0';
  detail[0x149] = '\0';
  detail[0x14e] = '\0';
  detail[0x14f] = '\0';
  detail._64_8_ = &sqltds;
  detail[0x14a] = '\0';
  detail[0x14b] = '\0';
  detail[0x150] = '\0';
  detail[0x151] = '\0';
  response_code = 0x38d;
  detail._48_8_ = s_declare_T_GLOBALS_VAR_POWERCARD__004c63d8;
  detail[0] = '\f';
  detail[1] = '\0';
  detail[2] = '\0';
  detail[3] = '\0';
  detail[4] = '\0';
  detail[5] = '\0';
  detail[6] = '\0';
  detail[7] = '\0';
  detail[8] = '\x03';
  detail[9] = '\0';
  detail[10] = '\0';
  detail[0xb] = '\0';
  detail[0xc] = '\x01';
  detail[0xd] = '\0';
  detail[0xe] = '\0';
  detail[0xf] = '\0';
  detail._32_8_ = sqlcud0;
  detail._176_8_ = &response_code;
  detail[0x10] = '\x05';
  detail[0x11] = '\0';
  detail[0x12] = '\0';
  detail[0x13] = '\0';
  detail[0x18] = '\0';
  detail[0x19] = '\0';
  detail[0x1a] = '\0';
  detail[0x1b] = '\0';
  detail._72_8_ = detail + 0xb0;
  detail[200] = '\x04';
  detail[0xc9] = '\0';
  detail[0xca] = '\0';
  detail[0xcb] = '\0';
  detail[0xcc] = '\0';
  detail[0xcd] = '\0';
  detail[0xce] = '\0';
  detail[0xcf] = '\0';
  detail[0xe0] = '\0';
  detail[0xe1] = '\0';
  detail[0xe2] = '\0';
  detail[0xe3] = '\0';
  detail[0xf0] = '\0';
  detail[0xf1] = '\0';
  detail[0xf2] = '\0';
  detail[0xf3] = '\0';
  detail[0xf4] = '\0';
  detail[0xf5] = '\0';
  detail[0xf6] = '\0';
  detail[0xf7] = '\0';
  detail[0x108] = '\0';
  detail[0x109] = '\0';
  detail[0x10a] = '\0';
  detail[0x10b] = '\0';
  detail[0x118] = '\0';
  detail[0x119] = '\0';
  detail[0x11a] = '\0';
  detail[0x11b] = '\0';
  detail[0x11c] = '\0';
  detail[0x11d] = '\0';
  detail[0x11e] = '\0';
  detail[0x11f] = '\0';
  detail[0xd0] = '!';
  detail[0xd1] = '\0';
  detail[0xd2] = '\0';
  detail[0xd3] = '\0';
  detail[0xd4] = '\0';
  detail[0xd5] = '\0';
  detail[0xd6] = '\0';
  detail[0xd7] = '\0';
  detail[0xe4] = '\0';
  detail[0xe5] = '\0';
  detail[0xe6] = '\0';
  detail[0xe7] = '\0';
  detail[0xf8] = '\0';
  detail[0xf9] = '\0';
  detail[0xfa] = '\0';
  detail[0xfb] = '\0';
  detail[0xfc] = '\0';
  detail[0xfd] = '\0';
  detail[0xfe] = '\0';
  detail[0xff] = '\0';
  detail[0x10c] = '\0';
  detail[0x10d] = '\0';
  detail[0x10e] = '\0';
  detail[0x10f] = '\0';
  detail[0x120] = '\0';
  detail[0x121] = '\0';
  detail[0x122] = '\0';
  detail[0x123] = '\0';
  detail[0x124] = '\0';
  detail[0x125] = '\0';
  detail[0x126] = '\0';
  detail[0x127] = '\0';
  detail[0xd8] = -0x7d;
  detail[0xd9] = '\0';
  detail[0xda] = '\0';
  detail[0xdb] = '\0';
  detail[0xdc] = '\0';
  detail[0xdd] = '\0';
  detail[0xde] = '\0';
  detail[0xdf] = '\0';
  detail[0xe8] = '\0';
  detail[0xe9] = '\0';
  detail[0xea] = '\0';
  detail[0xeb] = '\0';
  detail[0x100] = '\0';
  detail[0x101] = '\0';
  detail[0x102] = '\0';
  detail[0x103] = '\0';
  detail[0x104] = '\0';
  detail[0x105] = '\0';
  detail[0x106] = '\0';
  detail[0x107] = '\0';
  detail[0x110] = '\0';
  detail[0x111] = '\0';
  detail[0x112] = '\0';
  detail[0x113] = '\0';
  detail[0x128] = '\0';
  detail[0x129] = '\0';
  detail[0x12a] = '\0';
  detail[299] = '\0';
  detail[300] = '\0';
  detail[0x12d] = '\0';
  detail[0x12e] = '\0';
  detail[0x12f] = '\0';
  detail._80_8_ = detail + 200;
  detail[0x14c] = '\0';
  detail[0x14d] = '\0';
  detail[0x152] = '\0';
  detail[0x153] = '\0';
  detail._88_8_ = detail + 0xe0;
  detail._96_8_ = detail + 0xf0;
  detail._104_8_ = detail + 0x108;
  detail._112_8_ = detail + 0x118;
  detail._120_8_ = detail + 0x130;
  detail._128_8_ = detail + 0x148;
  detail._136_8_ = detail + 0x14e;
  detail._40_8_ = &sqlca;
  detail._184_8_ = &VARIABLE_NAME;
  detail._192_8_ = &VARIABLE_VALUE;
  sqlcxt((long)nIndiceCtx * 0x10 + 0x713948,&sqlctx,detail,&sqlfpn);
  if (sqlca.sqlcode < 0) {
    strcpy(detail,sqlca.sqlerrm.sqlerrmc);
    trace_event(detail,1);
  }
  else if (response_code == 0) {
    memcpy(variable_value,VARIABLE_VALUE.arr,(ulong)VARIABLE_VALUE.len);
    trace_event("End GetGlobalsVar( OK ) ",5);
    return 0;
  }
  trace_event("End GetGlobalsVar( NOK ) ",5);
  return -1;
}



// WARNING: Type propagation algorithm not settling
// WARNING: Unknown calling convention

void InitTlvPrivate(TSTlvPrivate *tlvInfo)

{
  ulong uVar1;
  int *piVar2;
  int *piVar3;
  TSTlvPrivate *pTVar4;
  TSTlvPrivate *pTVar5;
  char *pcVar6;
  char *pcVar7;
  int iVar8;
  uint uVar9;
  bool bVar11;
  ulong uVar10;
  
  piVar2 = tlvInfo->nPosTlv;
  uVar10 = 0xf9c;
  iVar8 = 0xf9c;
  bVar11 = ((ulong)piVar2 & 1) != 0;
  if (bVar11) {
    piVar2 = (int *)((long)tlvInfo->nPosTlv + 1);
    *(undefined1 *)tlvInfo->nPosTlv = 0;
    uVar10 = 0xf9b;
    iVar8 = 0xf9b;
  }
  if (((ulong)piVar2 & 2) == 0) {
    uVar9 = (uint)uVar10;
  }
  else {
    uVar9 = iVar8 - 2;
    uVar10 = (ulong)uVar9;
    *(undefined2 *)piVar2 = 0;
    piVar2 = (int *)((long)piVar2 + 2);
  }
  if (((ulong)piVar2 & 4) != 0) {
    *piVar2 = 0;
    uVar10 = (ulong)(uVar9 - 4);
    piVar2 = piVar2 + 1;
  }
  for (uVar1 = uVar10 >> 3; uVar1 != 0; uVar1 = uVar1 - 1) {
    piVar2[0] = 0;
    piVar2[1] = 0;
    piVar2 = piVar2 + 2;
  }
  if ((uVar10 & 4) != 0) {
    *piVar2 = 0;
    piVar2 = piVar2 + 1;
  }
  piVar3 = piVar2;
  if ((uVar10 & 2) != 0) {
    piVar3 = (int *)((long)piVar2 + 2);
    *(undefined2 *)piVar2 = 0;
  }
  if (bVar11) {
    *(undefined1 *)piVar3 = 0;
  }
  bVar11 = ((ulong)tlvInfo & 1) != 0;
  uVar10 = 0xf9c;
  iVar8 = 0xf9c;
  if (bVar11) {
    pTVar4 = (TSTlvPrivate *)((long)tlvInfo->nPresent + 1);
    *(undefined1 *)tlvInfo->nPresent = 0xff;
    uVar10 = 0xf9b;
    iVar8 = 0xf9b;
    uVar1 = (ulong)pTVar4 & 2;
  }
  else {
    uVar1 = (ulong)tlvInfo & 2;
    pTVar4 = tlvInfo;
  }
  if (uVar1 == 0) {
    uVar9 = (uint)uVar10;
  }
  else {
    uVar9 = iVar8 - 2;
    uVar10 = (ulong)uVar9;
    *(undefined2 *)pTVar4->nPresent = 0xffff;
    pTVar4 = (TSTlvPrivate *)((long)pTVar4->nPresent + 2);
  }
  if (((ulong)pTVar4 & 4) != 0) {
    pTVar4->nPresent[0] = -1;
    uVar10 = (ulong)(uVar9 - 4);
    pTVar4 = (TSTlvPrivate *)(pTVar4->nPresent + 1);
  }
  for (uVar1 = uVar10 >> 3; uVar1 != 0; uVar1 = uVar1 - 1) {
    pTVar4->nPresent[0] = -1;
    pTVar4->nPresent[1] = -1;
    pTVar4 = (TSTlvPrivate *)(pTVar4->nPresent + 2);
  }
  if ((uVar10 & 4) != 0) {
    pTVar4->nPresent[0] = -1;
    pTVar4 = (TSTlvPrivate *)(pTVar4->nPresent + 1);
  }
  pTVar5 = pTVar4;
  if ((uVar10 & 2) != 0) {
    pTVar5 = (TSTlvPrivate *)((long)pTVar4->nPresent + 2);
    *(undefined2 *)pTVar4->nPresent = 0xffff;
  }
  if (bVar11) {
    *(undefined1 *)pTVar5->nPresent = 0xff;
  }
  pcVar7 = tlvInfo->sTlvData;
  tlvInfo->nLength = 0;
  uVar10 = 0x800;
  iVar8 = 0x800;
  bVar11 = ((ulong)pcVar7 & 1) != 0;
  if (bVar11) {
    pcVar7 = tlvInfo->sTlvData + 1;
    tlvInfo->sTlvData[0] = '\0';
    uVar10 = 0x7ff;
    iVar8 = 0x7ff;
  }
  if (((ulong)pcVar7 & 2) == 0) {
    uVar9 = (uint)uVar10;
    pcVar6 = pcVar7;
  }
  else {
    pcVar6 = pcVar7 + 2;
    uVar9 = iVar8 - 2;
    uVar10 = (ulong)uVar9;
    pcVar7[0] = '\0';
    pcVar7[1] = '\0';
  }
  if (((ulong)pcVar6 & 4) != 0) {
    pcVar6[0] = '\0';
    pcVar6[1] = '\0';
    pcVar6[2] = '\0';
    pcVar6[3] = '\0';
    uVar10 = (ulong)(uVar9 - 4);
    pcVar6 = pcVar6 + 4;
  }
  for (uVar1 = uVar10 >> 3; uVar1 != 0; uVar1 = uVar1 - 1) {
    pcVar6[0] = '\0';
    pcVar6[1] = '\0';
    pcVar6[2] = '\0';
    pcVar6[3] = '\0';
    pcVar6[4] = '\0';
    pcVar6[5] = '\0';
    pcVar6[6] = '\0';
    pcVar6[7] = '\0';
    pcVar6 = pcVar6 + 8;
  }
  if ((uVar10 & 4) != 0) {
    pcVar6[0] = '\0';
    pcVar6[1] = '\0';
    pcVar6[2] = '\0';
    pcVar6[3] = '\0';
    pcVar6 = pcVar6 + 4;
  }
  pcVar7 = pcVar6;
  if ((uVar10 & 2) != 0) {
    pcVar7 = pcVar6 + 2;
    pcVar6[0] = '\0';
    pcVar6[1] = '\0';
  }
  if (bVar11) {
    *pcVar7 = '\0';
  }
  return;
}



// WARNING: Unknown calling convention

int GetTlvPrivateIndice(char *szTlvName)

{
  int iVar1;
  int iVar2;
  tlv_info_t *__s2;
  
  __s2 = tab_TlvPrivateInfo;
  iVar2 = 0;
  do {
    iVar1 = memcmp(szTlvName,__s2,3);
    if (iVar1 == 0) {
      return iVar2;
    }
    iVar2 = iVar2 + 1;
    __s2 = __s2 + 1;
  } while (iVar2 != 0xa5);
  return -1;
}



// WARNING: Unknown calling convention

int GetTlvPrivateType(int nIndice)

{
  return tab_TlvPrivateInfo[nIndice].nType;
}



// WARNING: Unknown calling convention

int GetTlvPrivateLength(int nIndice)

{
  return tab_TlvPrivateInfo[nIndice].nLength;
}



// WARNING: Unknown calling convention

void AdjustTlvPrivate(TSTlvPrivate *tlvInfo,int nIndice,int nLength)

{
  int *piVar1;
  
  if (nIndice < 999) {
    do {
      piVar1 = tlvInfo->nPresent + nIndice;
      if (*piVar1 == 0) {
        piVar1[999] = piVar1[999] + nLength;
      }
      nIndice = nIndice + 1;
    } while (nIndice != 999);
  }
  return;
}



// WARNING: Unknown calling convention

int AnalyseTlvPrivate(char *buffer,int nLength,TSTlvPrivate *tlvInfo)

{
  int iVar1;
  long lVar2;
  int iVar3;
  char szTlvName [5];
  char szTlvValueLen [5];
  
  InitTlvPrivate(tlvInfo);
  tlvInfo->nLength = nLength;
  memcpy(tlvInfo->sTlvData,buffer,(long)nLength);
  if (0 < nLength) {
    iVar3 = 0;
    do {
      szTlvName[3] = '0';
      szTlvName._0_3_ = *(undefined3 *)buffer;
      szTlvValueLen[3] = '\0';
      szTlvValueLen._0_3_ = *(uint3 *)(buffer + 3);
      lVar2 = strtol(szTlvValueLen,(char **)0x0,10);
      iVar1 = GetTlvPrivateIndice(szTlvName);
      if (-1 < iVar1) {
        (tlvInfo->nPresent + iVar1)[999] = iVar3;
        tlvInfo->nPresent[iVar1] = 0;
      }
      iVar1 = (int)lVar2 + 6;
      iVar3 = iVar3 + iVar1;
      buffer = buffer + iVar1;
    } while (iVar3 < nLength);
  }
  return 0;
}



// WARNING: Unknown calling convention

int GetTlvPrivate(char *tlv_name,TSTlvPrivate *tlvInfo,char *data,int *length)

{
  int *piVar1;
  int nIndice;
  uint uVar2;
  long lVar3;
  char szAscTlvLen [4];
  
  szAscTlvLen[0] = '\0';
  szAscTlvLen[1] = '\0';
  szAscTlvLen[2] = '\0';
  szAscTlvLen[3] = '\0';
  nIndice = GetTlvPrivateIndice(tlv_name);
  if (nIndice != -1) {
    uVar2 = GetTlvPrivateType(nIndice);
    piVar1 = tlvInfo->nPresent + nIndice;
    GetTlvPrivateLength(nIndice);
    if (*piVar1 != -1) {
      szAscTlvLen._0_3_ = *(undefined3 *)(tlvInfo->sTlvData + (long)piVar1[999] + 3);
      lVar3 = strtol(szAscTlvLen,(char **)0x0,10);
      *length = (int)lVar3;
      if (1 < uVar2) {
        return 0;
      }
      memcpy(data,tlvInfo->sTlvData + (long)piVar1[999] + 6,(long)(int)lVar3);
      return 0;
    }
  }
  return -1;
}



// WARNING: Unknown calling convention

int AddTlvPrivate(char *tlv_name,TSTlvPrivate *tlvInfo,char *data,int length)

{
  int *piVar1;
  int iVar2;
  uint uVar3;
  char szAscTlvLen [4];
  
  szAscTlvLen[0] = '\0';
  szAscTlvLen[1] = '\0';
  szAscTlvLen[2] = '\0';
  szAscTlvLen[3] = '\0';
  iVar2 = GetTlvPrivateIndice(tlv_name);
  if (iVar2 != -1) {
    uVar3 = GetTlvPrivateType(iVar2);
    GetTlvPrivateLength(iVar2);
    piVar1 = tlvInfo->nPresent + iVar2;
    sprintf(szAscTlvLen,"%.3d",(ulong)(uint)length);
    if (*piVar1 != 0) {
      if (uVar3 < 2) {
        memcpy(tlvInfo->sTlvData + (long)tlvInfo->nLength + 6,data,(long)length);
      }
      iVar2 = tlvInfo->nLength;
      *(undefined2 *)(tlvInfo->sTlvData + iVar2) = *(undefined2 *)tlv_name;
      tlvInfo->sTlvData[(long)iVar2 + 2] = tlv_name[2];
      iVar2 = tlvInfo->nLength;
      *(undefined2 *)(tlvInfo->sTlvData + (long)iVar2 + 3) = szAscTlvLen._0_2_;
      tlvInfo->sTlvData[(long)iVar2 + 5] = szAscTlvLen[2];
      iVar2 = tlvInfo->nLength;
      *piVar1 = 0;
      piVar1[999] = iVar2;
      tlvInfo->nLength = iVar2 + 6 + length;
      return 0;
    }
  }
  return -1;
}



// WARNING: Unknown calling convention

int PutTlvPrivate(char *tlv_name,TSTlvPrivate *tlvInfo,char *data,int length)

{
  int *piVar1;
  int iVar2;
  uint uVar3;
  long lVar4;
  int iVar5;
  char *pcVar6;
  long lVar7;
  byte bVar8;
  char szAscTlvLen [4];
  char szOldTlvLen [4];
  char szLastPart [2048];
  
  bVar8 = 0;
  szAscTlvLen[0] = '\0';
  szAscTlvLen[1] = '\0';
  szAscTlvLen[2] = '\0';
  szAscTlvLen[3] = '\0';
  szOldTlvLen[0] = '\0';
  szOldTlvLen[1] = '\0';
  szOldTlvLen[2] = '\0';
  szOldTlvLen[3] = '\0';
  iVar2 = GetTlvPrivateIndice(tlv_name);
  if (iVar2 == -1) {
    iVar2 = -1;
  }
  else {
    uVar3 = GetTlvPrivateType(iVar2);
    GetTlvPrivateLength(iVar2);
    sprintf(szAscTlvLen,"%.3d",(ulong)(uint)length);
    pcVar6 = szLastPart;
    for (lVar4 = 0x100; lVar4 != 0; lVar4 = lVar4 + -1) {
      pcVar6[0] = '\0';
      pcVar6[1] = '\0';
      pcVar6[2] = '\0';
      pcVar6[3] = '\0';
      pcVar6[4] = '\0';
      pcVar6[5] = '\0';
      pcVar6[6] = '\0';
      pcVar6[7] = '\0';
      pcVar6 = pcVar6 + (ulong)bVar8 * -0x10 + 8;
    }
    piVar1 = tlvInfo->nPresent + iVar2;
    if (*piVar1 == 0) {
      if (uVar3 < 2) {
                    // WARNING: Ignoring partial resolution of indirect
        szOldTlvLen._0_2_ = *(undefined2 *)(tlvInfo->sTlvData + (long)piVar1[999] + 3);
        lVar4 = strtol(szOldTlvLen,(char **)0x0,10);
        lVar7 = (long)piVar1[999];
        iVar5 = (int)lVar4;
        memcpy(szLastPart,tlvInfo->sTlvData + lVar7 + iVar5 + 6,
               (long)(((tlvInfo->nLength - piVar1[999]) + -6) - iVar5));
        *(undefined2 *)(tlvInfo->sTlvData + lVar7 + 3) = szAscTlvLen._0_2_;
        tlvInfo->sTlvData[lVar7 + 5] = szAscTlvLen[2];
        memcpy(tlvInfo->sTlvData + (long)piVar1[999] + 6,data,(long)length);
        memcpy(tlvInfo->sTlvData + (long)length + (long)piVar1[999] + 6,szLastPart,
               (long)(((tlvInfo->nLength - piVar1[999]) + -6) - iVar5));
        tlvInfo->nLength = tlvInfo->nLength + (length - iVar5);
        AdjustTlvPrivate(tlvInfo,iVar2 + 1,length - iVar5);
      }
      trace_event("End   PutTlvPrivate (SUCCES)",5);
      iVar2 = 0;
    }
    else {
      if (uVar3 < 2) {
        memcpy(tlvInfo->sTlvData + (long)tlvInfo->nLength + 6,data,(long)length);
      }
      iVar5 = tlvInfo->nLength;
      iVar2 = 0;
      *(undefined2 *)(tlvInfo->sTlvData + iVar5) = *(undefined2 *)tlv_name;
      tlvInfo->sTlvData[(long)iVar5 + 2] = tlv_name[2];
      iVar5 = tlvInfo->nLength;
      *(undefined2 *)(tlvInfo->sTlvData + (long)iVar5 + 3) = szAscTlvLen._0_2_;
      tlvInfo->sTlvData[(long)iVar5 + 5] = szAscTlvLen[2];
      iVar5 = tlvInfo->nLength;
      *piVar1 = 0;
      piVar1[999] = iVar5;
      tlvInfo->nLength = iVar5 + 6 + length;
    }
  }
  return iVar2;
}



// WARNING: Unknown calling convention

int PrivateBuildTlv(char *buffer_snd,TSTlvPrivate *tlvInfo)

{
  memcpy(buffer_snd,tlvInfo->sTlvData,(long)tlvInfo->nLength);
  return tlvInfo->nLength;
}



// WARNING: Unknown calling convention

int PutEvent(char *sTlvData,char *sEvent,char *sMsg)

{
  size_t sVar1;
  long lVar2;
  char *pcVar3;
  byte bVar4;
  int nLen;
  char sAddDataPriv [256];
  char sLine [512];
  TSTlvPrivate sTlvPrivateInfo;
  
  bVar4 = 0;
  nLen = 0;
  sVar1 = strlen(sTlvData);
  sprintf(sLine,"Start PutEvent(%.20s,%s,%s,%d)",sTlvData,sEvent,sMsg,sVar1);
  trace_event(sLine,5);
  InitTlvPrivate(&sTlvPrivateInfo);
  PutTlvBuffer("203",sTlvData,sEvent,3);
  pcVar3 = sAddDataPriv;
  for (lVar2 = 0x20; lVar2 != 0; lVar2 = lVar2 + -1) {
    pcVar3[0] = '\0';
    pcVar3[1] = '\0';
    pcVar3[2] = '\0';
    pcVar3[3] = '\0';
    pcVar3[4] = '\0';
    pcVar3[5] = '\0';
    pcVar3[6] = '\0';
    pcVar3[7] = '\0';
    pcVar3 = pcVar3 + (ulong)bVar4 * -0x10 + 8;
  }
  GetTlvBuffer("048",sTlvData,sAddDataPriv,&nLen);
  AnalyseTlvPrivate(sAddDataPriv,nLen,&sTlvPrivateInfo);
  sVar1 = strlen(sMsg);
  PutTlvPrivate("P02",&sTlvPrivateInfo,sMsg,(int)sVar1);
  pcVar3 = sAddDataPriv;
  for (lVar2 = 0x20; lVar2 != 0; lVar2 = lVar2 + -1) {
    pcVar3[0] = '\0';
    pcVar3[1] = '\0';
    pcVar3[2] = '\0';
    pcVar3[3] = '\0';
    pcVar3[4] = '\0';
    pcVar3[5] = '\0';
    pcVar3[6] = '\0';
    pcVar3[7] = '\0';
    pcVar3 = pcVar3 + (ulong)bVar4 * -0x10 + 8;
  }
  nLen = PrivateBuildTlv(sAddDataPriv,&sTlvPrivateInfo);
  PutTlvBuffer("048",sTlvData,sAddDataPriv,nLen);
  PrintTlvBuffer(sTlvData);
  trace_event("End   PutEvent(OK)",5);
  return 0;
}



// WARNING: Removing unreachable block (ram,0x0044180b)
// WARNING: Restarted to delay deadcode elimination for space: stack
// WARNING: Unknown calling convention

int GetSafData(int nIndiceCtx,char *sDestResource,char cManageType,char DeclineAdviceFlag,char *sMti
              ,char *sStan,char *sSrcResource,int *nSendCounter,char *sResponseCode,
              char *sCardNumber,char *sTlvBuffer)

{
  int iVar1;
  size_t __n;
  char *pcVar2;
  ulong uVar3;
  uint uVar4;
  uchar *puVar5;
  bool bVar6;
  byte bVar7;
  char T_DECLINE_ADVICE_FLAG;
  char T_MANAGE_TYPE;
  int T_SEND_COUNTER;
  int response_code;
  char T_MTI [5];
  anon_struct_6_2_43c7b5cf T_RESPONSE_CODE;
  char T_DEST_RESOURCE [7];
  char T_SRC_RESOURCE [7];
  char T_STAN [7];
  anon_struct_26_2_43c7b5cf T_CARD_NUMBER;
  sqlca sqlca;
  char detail [512];
  undefined8 local_3840;
  undefined8 local_3838;
  undefined8 local_3830;
  undefined8 local_3828;
  undefined8 local_3820;
  undefined8 local_3818;
  undefined8 local_3810;
  undefined8 local_3808;
  undefined8 local_3800;
  undefined8 local_37f8;
  undefined8 local_37f0;
  undefined1 local_37e8 [88];
  undefined2 local_3790;
  undefined2 local_378e;
  undefined2 local_378c;
  undefined2 local_378a;
  undefined2 local_3788;
  undefined2 local_3786;
  undefined2 local_3784;
  undefined2 local_3782;
  undefined2 local_3780;
  undefined2 local_377e;
  undefined2 local_377c;
  undefined2 local_377a;
  undefined2 local_3778;
  undefined2 local_3776;
  undefined2 local_3774;
  undefined2 local_3772;
  undefined2 local_3770;
  undefined2 local_376e;
  undefined2 local_376c;
  undefined2 local_376a;
  undefined2 local_3768;
  undefined2 local_3766;
  anon_struct_2002_2_43c7b5cf T_TLV_BUFFER;
  TSTlvAutho sTlvInfo;
  
  bVar7 = 0;
  InitTlvAutho(&sTlvInfo);
  T_DEST_RESOURCE[4] = '\0';
  T_DEST_RESOURCE[5] = '\0';
  T_DEST_RESOURCE[0] = '\0';
  T_DEST_RESOURCE[1] = '\0';
  T_DEST_RESOURCE[2] = '\0';
  T_DEST_RESOURCE[3] = '\0';
  T_DEST_RESOURCE[6] = '\0';
  uVar4 = 0x7ce;
  sTlvBuffer[0] = '\0';
  sTlvBuffer[1] = '\0';
  sTlvBuffer[2] = '\0';
  sTlvBuffer[3] = '\0';
  sTlvBuffer[4] = '\0';
  sTlvBuffer[5] = '\0';
  sTlvBuffer[6] = '\0';
  sTlvBuffer[7] = '\0';
  T_TLV_BUFFER.arr[0] = '\0';
  T_TLV_BUFFER.arr[1] = '\0';
  puVar5 = T_TLV_BUFFER.arr + 2;
  T_MTI[0] = '\0';
  T_MTI[1] = '\0';
  T_MTI[2] = '\0';
  T_MTI[3] = '\0';
  T_MTI[4] = '\0';
  bVar6 = ((ulong)puVar5 & 4) != 0;
  T_STAN[0] = '\0';
  T_STAN[1] = '\0';
  T_STAN[2] = '\0';
  T_STAN[3] = '\0';
  T_STAN[4] = '\0';
  T_STAN[5] = '\0';
  T_STAN[6] = '\0';
  T_SRC_RESOURCE[0] = '\0';
  T_SRC_RESOURCE[1] = '\0';
  T_SRC_RESOURCE[2] = '\0';
  T_SRC_RESOURCE[3] = '\0';
  T_SRC_RESOURCE[4] = '\0';
  T_SRC_RESOURCE[5] = '\0';
  T_SRC_RESOURCE[6] = '\0';
  if (bVar6) {
    T_TLV_BUFFER.arr[2] = '\0';
    T_TLV_BUFFER.arr[3] = '\0';
    T_TLV_BUFFER.arr[4] = '\0';
    T_TLV_BUFFER.arr[5] = '\0';
    uVar4 = 0x7ca;
    puVar5 = T_TLV_BUFFER.arr + 6;
  }
  for (uVar3 = (ulong)(uVar4 >> 3); uVar3 != 0; uVar3 = uVar3 - 1) {
    puVar5[0] = '\0';
    puVar5[1] = '\0';
    puVar5[2] = '\0';
    puVar5[3] = '\0';
    puVar5[4] = '\0';
    puVar5[5] = '\0';
    puVar5[6] = '\0';
    puVar5[7] = '\0';
    puVar5 = puVar5 + (ulong)bVar7 * -0x10 + 8;
  }
  if (!bVar6) {
    puVar5[0] = '\0';
    puVar5[1] = '\0';
    puVar5[2] = '\0';
    puVar5[3] = '\0';
    puVar5 = puVar5 + 4;
  }
  puVar5[0] = '\0';
  puVar5[1] = '\0';
  T_CARD_NUMBER.len = 0;
  T_CARD_NUMBER.arr[0] = '\0';
  T_CARD_NUMBER.arr[1] = '\0';
  T_CARD_NUMBER.arr[2] = '\0';
  T_CARD_NUMBER.arr[3] = '\0';
  T_CARD_NUMBER.arr[4] = '\0';
  T_CARD_NUMBER.arr[5] = '\0';
  T_CARD_NUMBER.arr[6] = '\0';
  T_CARD_NUMBER.arr[7] = '\0';
  T_TLV_BUFFER.len = 0;
  T_CARD_NUMBER.arr[0x14] = '\0';
  T_CARD_NUMBER.arr[0x15] = '\0';
  T_RESPONSE_CODE.len = 0;
  T_RESPONSE_CODE.arr[0] = '\0';
  T_RESPONSE_CODE.arr[1] = '\0';
  T_RESPONSE_CODE.arr[2] = '\0';
  T_RESPONSE_CODE.arr[3] = '\0';
  T_CARD_NUMBER.arr[8] = '\0';
  T_CARD_NUMBER.arr[9] = '\0';
  T_CARD_NUMBER.arr[10] = '\0';
  T_CARD_NUMBER.arr[0xb] = '\0';
  T_CARD_NUMBER.arr[0xc] = '\0';
  T_CARD_NUMBER.arr[0xd] = '\0';
  T_CARD_NUMBER.arr[0xe] = '\0';
  T_CARD_NUMBER.arr[0xf] = '\0';
  T_CARD_NUMBER.arr[0x10] = '\0';
  T_CARD_NUMBER.arr[0x11] = '\0';
  T_CARD_NUMBER.arr[0x12] = '\0';
  T_CARD_NUMBER.arr[0x13] = '\0';
  T_CARD_NUMBER.arr[0x16] = '\0';
  T_DECLINE_ADVICE_FLAG = '\0';
  T_SEND_COUNTER = 0;
  T_MANAGE_TYPE = '\0';
  __n = strlen(sDestResource);
  detail._184_8_ = memcpy(T_DEST_RESOURCE,sDestResource,__n);
  detail._40_8_ = &sqlca;
  detail._56_8_ = &sqladt;
  detail._64_8_ = &sqltds;
  detail[0x16] = '\0';
  detail[0x17] = '\x11';
  local_3790 = 0;
  local_377a = 0;
  detail._48_8_ = s_begin__response_code____PCRD_SAF_004c6530;
  local_378e = 0;
  local_3778 = 0;
  detail._208_8_ = T_MTI;
  detail._32_8_ = sqlcud0;
  detail._176_8_ = &response_code;
  response_code = 0x38d;
  detail[0] = '\f';
  detail[1] = '\0';
  detail[2] = '\0';
  detail[3] = '\0';
  detail[4] = '\0';
  detail[5] = '\0';
  detail[6] = '\0';
  detail[7] = '\0';
  detail[8] = '\v';
  detail[9] = '\0';
  detail[10] = '\0';
  detail[0xb] = '\0';
  detail._216_8_ = T_STAN;
  detail._192_8_ = &T_MANAGE_TYPE;
  detail[0xc] = '\x01';
  detail[0xd] = '\0';
  detail[0xe] = '\0';
  detail[0xf] = '\0';
  detail[0x10] = '\x05';
  detail[0x11] = '\0';
  detail[0x12] = '\0';
  detail[0x13] = '\0';
  detail[0x18] = '\0';
  detail[0x19] = '\0';
  detail[0x1a] = '\0';
  detail[0x1b] = '\0';
  detail._224_8_ = T_SRC_RESOURCE;
  detail[0x108] = '\x04';
  detail[0x109] = '\0';
  detail[0x10a] = '\0';
  detail[0x10b] = '\0';
  detail[0x10c] = '\0';
  detail[0x10d] = '\0';
  detail[0x10e] = '\0';
  detail[0x10f] = '\0';
  detail[0x160] = '\0';
  detail[0x161] = '\0';
  detail[0x162] = '\0';
  detail[0x163] = '\0';
  detail[400] = '\0';
  detail[0x191] = '\0';
  detail[0x192] = '\0';
  detail[0x193] = '\0';
  detail[0x194] = '\0';
  detail[0x195] = '\0';
  detail[0x196] = '\0';
  detail[0x197] = '\0';
  detail[0x1e8] = '\0';
  detail[0x1e9] = '\0';
  detail[0x1ea] = '\0';
  detail[0x1eb] = '\0';
  local_3840 = 0;
  detail[0x110] = '\a';
  detail[0x111] = '\0';
  detail[0x112] = '\0';
  detail[0x113] = '\0';
  detail[0x114] = '\0';
  detail[0x115] = '\0';
  detail[0x116] = '\0';
  detail[0x117] = '\0';
  detail[0x164] = '\0';
  detail[0x165] = '\0';
  detail[0x166] = '\0';
  detail[0x167] = '\0';
  detail[0x198] = '\0';
  detail[0x199] = '\0';
  detail[0x19a] = '\0';
  detail[0x19b] = '\0';
  detail[0x19c] = '\0';
  detail[0x19d] = '\0';
  detail[0x19e] = '\0';
  detail[0x19f] = '\0';
  detail[0x1ec] = '\0';
  detail[0x1ed] = '\0';
  detail[0x1ee] = '\0';
  detail[0x1ef] = '\0';
  local_3838 = 0;
  detail[0x118] = '\x01';
  detail[0x119] = '\0';
  detail[0x11a] = '\0';
  detail[0x11b] = '\0';
  detail[0x11c] = '\0';
  detail[0x11d] = '\0';
  detail[0x11e] = '\0';
  detail[0x11f] = '\0';
  detail[0x168] = '\0';
  detail[0x169] = '\0';
  detail[0x16a] = '\0';
  detail[0x16b] = '\0';
  detail[0x1a0] = '\0';
  detail[0x1a1] = '\0';
  detail[0x1a2] = '\0';
  detail[0x1a3] = '\0';
  detail[0x1a4] = '\0';
  detail[0x1a5] = '\0';
  detail[0x1a6] = '\0';
  detail[0x1a7] = '\0';
  local_378c = 0;
  local_3776 = 0;
  detail._200_8_ = &T_DECLINE_ADVICE_FLAG;
  local_3786 = 0;
  local_3770 = 0;
  detail[0x1f0] = '\0';
  detail[0x1f1] = '\0';
  detail[0x1f2] = '\0';
  detail[499] = '\0';
  local_378a = 0;
  local_3830 = 0;
  local_3774 = 0;
  detail[0x120] = '\x01';
  detail[0x121] = '\0';
  detail[0x122] = '\0';
  detail[0x123] = '\0';
  detail[0x124] = '\0';
  detail[0x125] = '\0';
  detail[0x126] = '\0';
  detail[0x127] = '\0';
  local_3788 = 0;
  detail[0x16c] = '\0';
  detail[0x16d] = '\0';
  detail[0x16e] = '\0';
  detail[0x16f] = '\0';
  local_3772 = 0;
  detail._232_8_ = &T_SEND_COUNTER;
  detail[0x1a8] = '\0';
  detail[0x1a9] = '\0';
  detail[0x1aa] = '\0';
  detail[0x1ab] = '\0';
  detail[0x1ac] = '\0';
  detail[0x1ad] = '\0';
  detail[0x1ae] = '\0';
  detail[0x1af] = '\0';
  detail[500] = '\0';
  detail[0x1f5] = '\0';
  detail[0x1f6] = '\0';
  detail[0x1f7] = '\0';
  local_3828 = 0;
  detail[0x128] = '\x05';
  detail[0x129] = '\0';
  detail[0x12a] = '\0';
  detail[299] = '\0';
  detail[300] = '\0';
  detail[0x12d] = '\0';
  detail[0x12e] = '\0';
  detail[0x12f] = '\0';
  detail[0x170] = '\0';
  detail[0x171] = '\0';
  detail[0x172] = '\0';
  detail[0x173] = '\0';
  detail[0x1b0] = '\0';
  detail[0x1b1] = '\0';
  detail[0x1b2] = '\0';
  detail[0x1b3] = '\0';
  detail[0x1b4] = '\0';
  detail[0x1b5] = '\0';
  detail[0x1b6] = '\0';
  detail[0x1b7] = '\0';
  detail[0x1f8] = '\0';
  detail[0x1f9] = '\0';
  detail[0x1fa] = '\0';
  detail[0x1fb] = '\0';
  local_3820 = 0;
  detail[0x130] = '\a';
  detail[0x131] = '\0';
  detail[0x132] = '\0';
  detail[0x133] = '\0';
  detail[0x134] = '\0';
  detail[0x135] = '\0';
  detail[0x136] = '\0';
  detail[0x137] = '\0';
  detail[0x174] = '\0';
  detail[0x175] = '\0';
  detail[0x176] = '\0';
  detail[0x177] = '\0';
  detail[0x1b8] = '\0';
  detail[0x1b9] = '\0';
  detail[0x1ba] = '\0';
  detail[0x1bb] = '\0';
  detail[0x1bc] = '\0';
  detail[0x1bd] = '\0';
  detail[0x1be] = '\0';
  detail[0x1bf] = '\0';
  detail[0x1fc] = '\0';
  detail[0x1fd] = '\0';
  detail[0x1fe] = '\0';
  detail[0x1ff] = '\0';
  local_3818 = 0;
  detail[0x138] = '\a';
  detail[0x139] = '\0';
  detail[0x13a] = '\0';
  detail[0x13b] = '\0';
  detail[0x13c] = '\0';
  detail[0x13d] = '\0';
  detail[0x13e] = '\0';
  detail[0x13f] = '\0';
  detail[0x178] = '\0';
  detail[0x179] = '\0';
  detail[0x17a] = '\0';
  detail[0x17b] = '\0';
  detail[0x1c0] = '\0';
  detail[0x1c1] = '\0';
  detail[0x1c2] = '\0';
  detail[0x1c3] = '\0';
  detail[0x1c4] = '\0';
  detail[0x1c5] = '\0';
  detail[0x1c6] = '\0';
  detail[0x1c7] = '\0';
  local_3782 = 0;
  local_377e = 0;
  local_3768 = 0;
  local_3780 = 0;
  local_3784 = 0;
  local_376e = 0;
  local_376c = 0;
  local_376a = 0;
  local_3810 = 0;
  detail[0x140] = '\x04';
  detail[0x141] = '\0';
  detail[0x142] = '\0';
  detail[0x143] = '\0';
  detail[0x144] = '\0';
  detail[0x145] = '\0';
  detail[0x146] = '\0';
  detail[0x147] = '\0';
  detail[0x17c] = '\0';
  detail[0x17d] = '\0';
  detail[0x17e] = '\0';
  detail[0x17f] = '\0';
  detail[0x1c8] = '\0';
  detail[0x1c9] = '\0';
  detail[0x1ca] = '\0';
  detail[0x1cb] = '\0';
  detail[0x1cc] = '\0';
  detail[0x1cd] = '\0';
  detail[0x1ce] = '\0';
  detail[0x1cf] = '\0';
  local_3808 = 0;
  detail[0x148] = '\x06';
  detail[0x149] = '\0';
  detail[0x14a] = '\0';
  detail[0x14b] = '\0';
  detail[0x14c] = '\0';
  detail[0x14d] = '\0';
  detail[0x14e] = '\0';
  detail[0x14f] = '\0';
  detail[0x180] = '\0';
  detail[0x181] = '\0';
  detail[0x182] = '\0';
  detail[0x183] = '\0';
  detail[0x1d0] = '\0';
  detail[0x1d1] = '\0';
  detail[0x1d2] = '\0';
  detail[0x1d3] = '\0';
  detail[0x1d4] = '\0';
  detail[0x1d5] = '\0';
  detail[0x1d6] = '\0';
  detail[0x1d7] = '\0';
  local_3800 = 0;
  detail[0x150] = -0x2e;
  detail[0x151] = '\a';
  detail[0x152] = '\0';
  detail[0x153] = '\0';
  detail[0x154] = '\0';
  detail[0x155] = '\0';
  detail[0x156] = '\0';
  detail[0x157] = '\0';
  detail[0x184] = '\0';
  detail[0x185] = '\0';
  detail[0x186] = '\0';
  detail[0x187] = '\0';
  detail[0x1d8] = '\0';
  detail[0x1d9] = '\0';
  detail[0x1da] = '\0';
  detail[0x1db] = '\0';
  detail[0x1dc] = '\0';
  detail[0x1dd] = '\0';
  detail[0x1de] = '\0';
  detail[0x1df] = '\0';
  local_37f8 = 0;
  detail[0x158] = '\x19';
  detail[0x159] = '\0';
  detail[0x15a] = '\0';
  detail[0x15b] = '\0';
  detail[0x15c] = '\0';
  detail[0x15d] = '\0';
  detail[0x15e] = '\0';
  detail[0x15f] = '\0';
  detail[0x188] = '\0';
  detail[0x189] = '\0';
  detail[0x18a] = '\0';
  detail[0x18b] = '\0';
  detail[0x1e0] = '\0';
  detail[0x1e1] = '\0';
  detail[0x1e2] = '\0';
  detail[0x1e3] = '\0';
  detail[0x1e4] = '\0';
  detail[0x1e5] = '\0';
  detail[0x1e6] = '\0';
  detail[0x1e7] = '\0';
  local_37f0 = 0;
  local_377c = 0;
  local_3766 = 0;
  detail._72_8_ = detail + 0xb0;
  detail._80_8_ = detail + 0x108;
  detail._88_8_ = detail + 0x160;
  detail._96_8_ = detail + 400;
  detail._104_8_ = detail + 0x1e8;
  detail._112_8_ = &local_3840;
  detail._120_8_ = local_37e8;
  detail._128_8_ = &local_3790;
  detail._136_8_ = &local_377a;
  T_MANAGE_TYPE = cManageType;
  detail._240_8_ = &T_RESPONSE_CODE;
  detail._248_8_ = &T_TLV_BUFFER;
  detail._256_8_ = &T_CARD_NUMBER;
  sqlcxt((long)nIndiceCtx * 0x10 + 0x713948,&sqlctx,detail,&sqlfpn);
  if (sqlca.sqlcode < 0) {
    pcVar2 = strcpy(detail,sqlca.sqlerrm.sqlerrmc);
    iVar1 = memcmp(pcVar2,"ORA-01405",9);
    if (iVar1 != 0) {
      trace_event(pcVar2,1);
      trace_event("End GetSafData( MALFUNCTION ) ",5);
    }
    iVar1 = -1;
  }
  else if (response_code == 0) {
    *nSendCounter = T_SEND_COUNTER;
    *(undefined4 *)sMti = T_MTI._0_4_;
    *(undefined4 *)sStan = T_STAN._0_4_;
    *(undefined2 *)(sStan + 4) = T_STAN._4_2_;
    *(undefined4 *)sSrcResource = T_SRC_RESOURCE._0_4_;
    *(undefined2 *)(sSrcResource + 4) = T_SRC_RESOURCE._4_2_;
    memcpy(sResponseCode,T_RESPONSE_CODE.arr,(ulong)T_RESPONSE_CODE.len);
    memcpy(sCardNumber,T_CARD_NUMBER.arr,(ulong)T_CARD_NUMBER.len);
    memcpy(sTlvBuffer,T_TLV_BUFFER.arr,(ulong)T_TLV_BUFFER.len);
    trace_event("End GetSafData( OK ) ",5);
    iVar1 = 0;
  }
  else {
    pcVar2 = strcpy(detail,sqlca.sqlerrm.sqlerrmc);
    trace_event(pcVar2,1);
    trace_event("End GetSafData( NOK ) ",5);
    iVar1 = -1;
  }
  return iVar1;
}



// WARNING: Unknown calling convention

int CardInSaf(int nIndiceCtx,char *sCard)

{
  int iVar1;
  size_t __n;
  int response_code;
  anon_struct_26_2_43c7b5cf T_CARD_NUMBER;
  sqlca sqlca;
  char detail [512];
  undefined8 local_110;
  undefined8 local_108;
  undefined1 local_b8 [88];
  undefined2 local_60;
  undefined2 local_5e;
  undefined2 local_4a;
  undefined2 local_48;
  
  trace_event("Card In Saf Checking Start()",5);
  T_CARD_NUMBER.len = 0;
  T_CARD_NUMBER.arr[0x14] = '\0';
  T_CARD_NUMBER.arr[0x15] = '\0';
  T_CARD_NUMBER.arr[0] = '\0';
  T_CARD_NUMBER.arr[1] = '\0';
  T_CARD_NUMBER.arr[2] = '\0';
  T_CARD_NUMBER.arr[3] = '\0';
  T_CARD_NUMBER.arr[4] = '\0';
  T_CARD_NUMBER.arr[5] = '\0';
  T_CARD_NUMBER.arr[6] = '\0';
  T_CARD_NUMBER.arr[7] = '\0';
  T_CARD_NUMBER.arr[8] = '\0';
  T_CARD_NUMBER.arr[9] = '\0';
  T_CARD_NUMBER.arr[10] = '\0';
  T_CARD_NUMBER.arr[0xb] = '\0';
  T_CARD_NUMBER.arr[0xc] = '\0';
  T_CARD_NUMBER.arr[0xd] = '\0';
  T_CARD_NUMBER.arr[0xe] = '\0';
  T_CARD_NUMBER.arr[0xf] = '\0';
  T_CARD_NUMBER.arr[0x10] = '\0';
  T_CARD_NUMBER.arr[0x11] = '\0';
  T_CARD_NUMBER.arr[0x12] = '\0';
  T_CARD_NUMBER.arr[0x13] = '\0';
  T_CARD_NUMBER.arr[0x16] = '\0';
  __n = strlen(sCard);
  memcpy(T_CARD_NUMBER.arr,sCard,__n);
  detail._56_8_ = &sqladt;
  detail[0x16] = '\0';
  detail[0x17] = '\x11';
  local_60 = 0;
  local_4a = 0;
  detail._64_8_ = &sqltds;
  local_5e = 0;
  local_48 = 0;
  T_CARD_NUMBER.len = (ushort)__n;
  detail._48_8_ = s_begin__response_code____PCRD_SAF_004c6640;
  response_code = 0x38d;
  detail[0] = '\f';
  detail[1] = '\0';
  detail[2] = '\0';
  detail[3] = '\0';
  detail[4] = '\0';
  detail[5] = '\0';
  detail[6] = '\0';
  detail[7] = '\0';
  detail[8] = '\v';
  detail[9] = '\0';
  detail[10] = '\0';
  detail[0xb] = '\0';
  detail._32_8_ = sqlcud0;
  detail._176_8_ = &response_code;
  detail[0xc] = '\x01';
  detail[0xd] = '\0';
  detail[0xe] = '\0';
  detail[0xf] = '\0';
  detail[0x10] = '@';
  detail[0x11] = '\0';
  detail[0x12] = '\0';
  detail[0x13] = '\0';
  detail._72_8_ = detail + 0xb0;
  detail[0x18] = '\0';
  detail[0x19] = '\0';
  detail[0x1a] = '\0';
  detail[0x1b] = '\0';
  detail[0x108] = '\x04';
  detail[0x109] = '\0';
  detail[0x10a] = '\0';
  detail[0x10b] = '\0';
  detail[0x10c] = '\0';
  detail[0x10d] = '\0';
  detail[0x10e] = '\0';
  detail[0x10f] = '\0';
  detail[0x160] = '\0';
  detail[0x161] = '\0';
  detail[0x162] = '\0';
  detail[0x163] = '\0';
  detail._80_8_ = detail + 0x108;
  detail[400] = '\0';
  detail[0x191] = '\0';
  detail[0x192] = '\0';
  detail[0x193] = '\0';
  detail[0x194] = '\0';
  detail[0x195] = '\0';
  detail[0x196] = '\0';
  detail[0x197] = '\0';
  detail[0x1e8] = '\0';
  detail[0x1e9] = '\0';
  detail[0x1ea] = '\0';
  detail[0x1eb] = '\0';
  local_110 = 0;
  detail._88_8_ = detail + 0x160;
  detail[0x110] = '\x19';
  detail[0x111] = '\0';
  detail[0x112] = '\0';
  detail[0x113] = '\0';
  detail[0x114] = '\0';
  detail[0x115] = '\0';
  detail[0x116] = '\0';
  detail[0x117] = '\0';
  detail[0x164] = '\0';
  detail[0x165] = '\0';
  detail[0x166] = '\0';
  detail[0x167] = '\0';
  detail._96_8_ = detail + 400;
  detail[0x198] = '\0';
  detail[0x199] = '\0';
  detail[0x19a] = '\0';
  detail[0x19b] = '\0';
  detail[0x19c] = '\0';
  detail[0x19d] = '\0';
  detail[0x19e] = '\0';
  detail[0x19f] = '\0';
  detail[0x1ec] = '\0';
  detail[0x1ed] = '\0';
  detail[0x1ee] = '\0';
  detail[0x1ef] = '\0';
  local_108 = 0;
  detail._104_8_ = detail + 0x1e8;
  detail._112_8_ = &local_110;
  detail._120_8_ = local_b8;
  detail._128_8_ = &local_60;
  detail._136_8_ = &local_4a;
  detail._40_8_ = &sqlca;
  detail._184_8_ = &T_CARD_NUMBER;
  sqlcxt((long)nIndiceCtx * 0x10 + 0x713948,&sqlctx,detail,&sqlfpn);
  if (sqlca.sqlcode < 0) {
    strcpy(detail,sqlca.sqlerrm.sqlerrmc);
    iVar1 = memcmp(detail,"ORA-01405",9);
    if (iVar1 != 0) {
      trace_event(detail,1);
      trace_event("End CardInSaf ( MALFUNCTION ) ",5);
    }
  }
  else {
    if (response_code == 0) {
      trace_event("End CardInSaf( OK ) ",5);
      return 0;
    }
    strcpy(detail,sqlca.sqlerrm.sqlerrmc);
    iVar1 = memcmp(detail,"ORA-01405",9);
    if (iVar1 != 0) {
      trace_event(detail,1);
      trace_event("End CardInSaf ( NOK ) ",5);
      return -1;
    }
  }
  return -1;
}



// WARNING: Removing unreachable block (ram,0x00442413)
// WARNING: Unknown calling convention

int InsertSafData(int nIndiceCtx,char *sMti,char cManageType,char *sStan,char *sSourceResource,
                 char *sDestResource,int nSendCounter,char *sResponseCode,char *sTlvBuffer,
                 char *sCardNumber)

{
  int iVar1;
  size_t __n;
  size_t __n_00;
  size_t __n_01;
  ulong uVar2;
  uint uVar3;
  uchar *puVar4;
  bool bVar5;
  byte bVar6;
  char T_MANAGE_TYPE;
  int T_SEND_COUNTER;
  int response_code;
  char T_MTI [5];
  anon_struct_6_2_43c7b5cf T_RESPONSE_CODE;
  char T_STAN [7];
  char T_DEST_RESOURCE [7];
  char T_SRC_RESOURCE [7];
  anon_struct_26_2_43c7b5cf T_CARD_NUMBER;
  sqlca sqlca;
  char detail [512];
  undefined8 local_900;
  undefined8 local_8f8;
  undefined8 local_8f0;
  undefined8 local_8e8;
  undefined8 local_8e0;
  undefined8 local_8d8;
  undefined8 local_8d0;
  undefined8 local_8c8;
  undefined8 local_8c0;
  undefined8 local_8b8;
  undefined1 local_8a8 [88];
  undefined2 local_850;
  undefined2 local_84e;
  undefined2 local_84c;
  undefined2 local_84a;
  undefined2 local_848;
  undefined2 local_846;
  undefined2 local_844;
  undefined2 local_842;
  undefined2 local_840;
  undefined2 local_83e;
  undefined2 local_83a;
  undefined2 local_838;
  undefined2 local_836;
  undefined2 local_834;
  undefined2 local_832;
  undefined2 local_830;
  undefined2 local_82e;
  undefined2 local_82c;
  undefined2 local_82a;
  undefined2 local_828;
  anon_struct_2002_2_43c7b5cf T_TLV_BUFFER;
  
  bVar6 = 0;
  trace_event("Start InsertSafData() ",5);
  puVar4 = T_TLV_BUFFER.arr + 2;
  T_MTI[4] = '\0';
  T_STAN[6] = '\0';
  bVar5 = ((ulong)puVar4 & 4) != 0;
  T_DEST_RESOURCE[6] = '\0';
  uVar3 = 0x7ce;
  T_SRC_RESOURCE[6] = '\0';
  T_RESPONSE_CODE.arr[0] = '\0';
  T_RESPONSE_CODE.arr[1] = '\0';
  T_RESPONSE_CODE.arr[2] = '\0';
  T_RESPONSE_CODE.arr[3] = '\0';
  T_TLV_BUFFER.arr[0] = '\0';
  T_TLV_BUFFER.arr[1] = '\0';
  if (bVar5) {
    T_TLV_BUFFER.arr[2] = '\0';
    T_TLV_BUFFER.arr[3] = '\0';
    T_TLV_BUFFER.arr[4] = '\0';
    T_TLV_BUFFER.arr[5] = '\0';
    uVar3 = 0x7ca;
    puVar4 = T_TLV_BUFFER.arr + 6;
  }
  for (uVar2 = (ulong)(uVar3 >> 3); uVar2 != 0; uVar2 = uVar2 - 1) {
    puVar4[0] = '\0';
    puVar4[1] = '\0';
    puVar4[2] = '\0';
    puVar4[3] = '\0';
    puVar4[4] = '\0';
    puVar4[5] = '\0';
    puVar4[6] = '\0';
    puVar4[7] = '\0';
    puVar4 = puVar4 + (ulong)bVar6 * -0x10 + 8;
  }
  if (!bVar5) {
    puVar4[0] = '\0';
    puVar4[1] = '\0';
    puVar4[2] = '\0';
    puVar4[3] = '\0';
    puVar4 = puVar4 + 4;
  }
  puVar4[0] = '\0';
  puVar4[1] = '\0';
  T_MTI._0_4_ = *(undefined4 *)sMti;
  T_TLV_BUFFER.len = 2000;
  T_RESPONSE_CODE.len = 0;
  T_STAN._0_4_ = *(undefined4 *)sStan;
  T_CARD_NUMBER.arr[0x14] = '\0';
  T_CARD_NUMBER.arr[0x15] = '\0';
  T_STAN._4_2_ = *(undefined2 *)(sStan + 4);
  T_CARD_NUMBER.len = 0;
  T_CARD_NUMBER.arr[0] = '\0';
  T_CARD_NUMBER.arr[1] = '\0';
  T_CARD_NUMBER.arr[2] = '\0';
  T_CARD_NUMBER.arr[3] = '\0';
  T_CARD_NUMBER.arr[4] = '\0';
  T_CARD_NUMBER.arr[5] = '\0';
  T_CARD_NUMBER.arr[6] = '\0';
  T_CARD_NUMBER.arr[7] = '\0';
  T_CARD_NUMBER.arr[8] = '\0';
  T_CARD_NUMBER.arr[9] = '\0';
  T_CARD_NUMBER.arr[10] = '\0';
  T_CARD_NUMBER.arr[0xb] = '\0';
  T_CARD_NUMBER.arr[0xc] = '\0';
  T_CARD_NUMBER.arr[0xd] = '\0';
  T_CARD_NUMBER.arr[0xe] = '\0';
  T_CARD_NUMBER.arr[0xf] = '\0';
  T_CARD_NUMBER.arr[0x10] = '\0';
  T_CARD_NUMBER.arr[0x11] = '\0';
  T_CARD_NUMBER.arr[0x12] = '\0';
  T_CARD_NUMBER.arr[0x13] = '\0';
  T_CARD_NUMBER.arr[0x16] = '\0';
  T_SEND_COUNTER = 0;
  T_DEST_RESOURCE._0_4_ = *(undefined4 *)sDestResource;
  T_MANAGE_TYPE = '\0';
  T_DEST_RESOURCE._4_2_ = *(undefined2 *)(sDestResource + 4);
  T_SRC_RESOURCE._0_4_ = *(undefined4 *)sSourceResource;
  T_SRC_RESOURCE._4_2_ = *(undefined2 *)(sSourceResource + 4);
  __n = strlen(sResponseCode);
  memcpy(T_RESPONSE_CODE.arr,sResponseCode,__n);
  __n_00 = strlen(sCardNumber);
  memcpy(T_CARD_NUMBER.arr,sCardNumber,__n_00);
  __n_01 = strlen(sTlvBuffer);
  memcpy(T_TLV_BUFFER.arr,sTlvBuffer,__n_01);
  local_83a = 0;
  T_CARD_NUMBER.len = (ushort)__n_00;
  detail._40_8_ = &sqlca;
  T_SEND_COUNTER = nSendCounter;
  T_RESPONSE_CODE.len = (ushort)__n;
  T_TLV_BUFFER.len = (ushort)__n_01;
  detail._56_8_ = &sqladt;
  detail[0x16] = '\0';
  detail[0x17] = '\x11';
  local_850 = 0;
  detail._64_8_ = &sqltds;
  response_code = 0x38d;
  detail[0] = '\f';
  detail[1] = '\0';
  detail[2] = '\0';
  detail[3] = '\0';
  detail[4] = '\0';
  detail[5] = '\0';
  detail[6] = '\0';
  detail[7] = '\0';
  detail[8] = '\v';
  detail[9] = '\0';
  detail[10] = '\0';
  detail[0xb] = '\0';
  detail._48_8_ = s_begin__response_code____PCRD_SAF_004c66b8;
  detail[0xc] = '\x01';
  detail[0xd] = '\0';
  detail[0xe] = '\0';
  detail[0xf] = '\0';
  detail[0x10] = 'W';
  detail[0x11] = '\0';
  detail[0x12] = '\0';
  detail[0x13] = '\0';
  detail._32_8_ = sqlcud0;
  detail._176_8_ = &response_code;
  detail[0x18] = '\0';
  detail[0x19] = '\0';
  detail[0x1a] = '\0';
  detail[0x1b] = '\0';
  detail[0x108] = '\x04';
  detail[0x109] = '\0';
  detail[0x10a] = '\0';
  detail[0x10b] = '\0';
  detail[0x10c] = '\0';
  detail[0x10d] = '\0';
  detail[0x10e] = '\0';
  detail[0x10f] = '\0';
  detail[0x160] = '\0';
  detail[0x161] = '\0';
  detail[0x162] = '\0';
  detail[0x163] = '\0';
  detail._192_8_ = &T_MANAGE_TYPE;
  detail[400] = '\0';
  detail[0x191] = '\0';
  detail[0x192] = '\0';
  detail[0x193] = '\0';
  detail[0x194] = '\0';
  detail[0x195] = '\0';
  detail[0x196] = '\0';
  detail[0x197] = '\0';
  detail[0x1e8] = '\0';
  detail[0x1e9] = '\0';
  detail[0x1ea] = '\0';
  detail[0x1eb] = '\0';
  local_900 = 0;
  detail[0x110] = '\x05';
  detail[0x111] = '\0';
  detail[0x112] = '\0';
  detail[0x113] = '\0';
  detail[0x114] = '\0';
  detail[0x115] = '\0';
  detail[0x116] = '\0';
  detail[0x117] = '\0';
  detail[0x164] = '\0';
  detail[0x165] = '\0';
  detail[0x166] = '\0';
  detail[0x167] = '\0';
  detail[0x198] = '\0';
  detail[0x199] = '\0';
  detail[0x19a] = '\0';
  detail[0x19b] = '\0';
  detail[0x19c] = '\0';
  detail[0x19d] = '\0';
  detail[0x19e] = '\0';
  detail[0x19f] = '\0';
  detail[0x1ec] = '\0';
  detail[0x1ed] = '\0';
  detail[0x1ee] = '\0';
  detail[0x1ef] = '\0';
  local_8f8 = 0;
  local_836 = 0;
  local_84a = 0;
  local_834 = 0;
  local_848 = 0;
  local_84e = 0;
  local_832 = 0;
  local_838 = 0;
  detail[0x118] = '\x01';
  detail[0x119] = '\0';
  detail[0x11a] = '\0';
  detail[0x11b] = '\0';
  detail[0x11c] = '\0';
  detail[0x11d] = '\0';
  detail[0x11e] = '\0';
  detail[0x11f] = '\0';
  detail[0x168] = '\0';
  detail[0x169] = '\0';
  detail[0x16a] = '\0';
  detail[0x16b] = '\0';
  detail[0x1a0] = '\0';
  detail[0x1a1] = '\0';
  detail[0x1a2] = '\0';
  detail[0x1a3] = '\0';
  detail[0x1a4] = '\0';
  detail[0x1a5] = '\0';
  detail[0x1a6] = '\0';
  detail[0x1a7] = '\0';
  detail[0x1f0] = '\0';
  detail[0x1f1] = '\0';
  detail[0x1f2] = '\0';
  detail[499] = '\0';
  local_8f0 = 0;
  local_84c = 0;
  detail[0x120] = '\a';
  detail[0x121] = '\0';
  detail[0x122] = '\0';
  detail[0x123] = '\0';
  detail[0x124] = '\0';
  detail[0x125] = '\0';
  detail[0x126] = '\0';
  detail[0x127] = '\0';
  detail[0x16c] = '\0';
  detail[0x16d] = '\0';
  detail[0x16e] = '\0';
  detail[0x16f] = '\0';
  detail[0x1a8] = '\0';
  detail[0x1a9] = '\0';
  detail[0x1aa] = '\0';
  detail[0x1ab] = '\0';
  detail[0x1ac] = '\0';
  detail[0x1ad] = '\0';
  detail[0x1ae] = '\0';
  detail[0x1af] = '\0';
  detail[500] = '\0';
  detail[0x1f5] = '\0';
  detail[0x1f6] = '\0';
  detail[0x1f7] = '\0';
  local_8e8 = 0;
  detail[0x128] = '\a';
  detail[0x129] = '\0';
  detail[0x12a] = '\0';
  detail[299] = '\0';
  detail[300] = '\0';
  detail[0x12d] = '\0';
  detail[0x12e] = '\0';
  detail[0x12f] = '\0';
  detail[0x170] = '\0';
  detail[0x171] = '\0';
  detail[0x172] = '\0';
  detail[0x173] = '\0';
  detail[0x1b0] = '\0';
  detail[0x1b1] = '\0';
  detail[0x1b2] = '\0';
  detail[0x1b3] = '\0';
  detail[0x1b4] = '\0';
  detail[0x1b5] = '\0';
  detail[0x1b6] = '\0';
  detail[0x1b7] = '\0';
  detail[0x1f8] = '\0';
  detail[0x1f9] = '\0';
  detail[0x1fa] = '\0';
  detail[0x1fb] = '\0';
  local_8e0 = 0;
  detail[0x130] = '\a';
  detail[0x131] = '\0';
  detail[0x132] = '\0';
  detail[0x133] = '\0';
  detail[0x134] = '\0';
  detail[0x135] = '\0';
  detail[0x136] = '\0';
  detail[0x137] = '\0';
  detail[0x174] = '\0';
  detail[0x175] = '\0';
  detail[0x176] = '\0';
  detail[0x177] = '\0';
  detail[0x1b8] = '\0';
  detail[0x1b9] = '\0';
  detail[0x1ba] = '\0';
  detail[0x1bb] = '\0';
  detail[0x1bc] = '\0';
  detail[0x1bd] = '\0';
  detail[0x1be] = '\0';
  detail[0x1bf] = '\0';
  detail[0x1fc] = '\0';
  detail[0x1fd] = '\0';
  detail[0x1fe] = '\0';
  detail[0x1ff] = '\0';
  local_846 = 0;
  detail._224_8_ = &T_SEND_COUNTER;
  local_830 = 0;
  local_844 = 0;
  local_82e = 0;
  local_842 = 0;
  local_82c = 0;
  local_840 = 0;
  local_82a = 0;
  local_8d8 = 0;
  detail[0x138] = '\x04';
  detail[0x139] = '\0';
  detail[0x13a] = '\0';
  detail[0x13b] = '\0';
  detail[0x13c] = '\0';
  detail[0x13d] = '\0';
  detail[0x13e] = '\0';
  detail[0x13f] = '\0';
  detail[0x178] = '\0';
  detail[0x179] = '\0';
  detail[0x17a] = '\0';
  detail[0x17b] = '\0';
  detail[0x1c0] = '\0';
  detail[0x1c1] = '\0';
  detail[0x1c2] = '\0';
  detail[0x1c3] = '\0';
  detail[0x1c4] = '\0';
  detail[0x1c5] = '\0';
  detail[0x1c6] = '\0';
  detail[0x1c7] = '\0';
  local_8d0 = 0;
  detail[0x140] = '\x06';
  detail[0x141] = '\0';
  detail[0x142] = '\0';
  detail[0x143] = '\0';
  detail[0x144] = '\0';
  detail[0x145] = '\0';
  detail[0x146] = '\0';
  detail[0x147] = '\0';
  detail[0x17c] = '\0';
  detail[0x17d] = '\0';
  detail[0x17e] = '\0';
  detail[0x17f] = '\0';
  detail[0x1c8] = '\0';
  detail[0x1c9] = '\0';
  detail[0x1ca] = '\0';
  detail[0x1cb] = '\0';
  detail[0x1cc] = '\0';
  detail[0x1cd] = '\0';
  detail[0x1ce] = '\0';
  detail[0x1cf] = '\0';
  local_8c8 = 0;
  detail[0x148] = -0x2e;
  detail[0x149] = '\a';
  detail[0x14a] = '\0';
  detail[0x14b] = '\0';
  detail[0x14c] = '\0';
  detail[0x14d] = '\0';
  detail[0x14e] = '\0';
  detail[0x14f] = '\0';
  detail[0x180] = '\0';
  detail[0x181] = '\0';
  detail[0x182] = '\0';
  detail[0x183] = '\0';
  detail[0x1d0] = '\0';
  detail[0x1d1] = '\0';
  detail[0x1d2] = '\0';
  detail[0x1d3] = '\0';
  detail[0x1d4] = '\0';
  detail[0x1d5] = '\0';
  detail[0x1d6] = '\0';
  detail[0x1d7] = '\0';
  local_8c0 = 0;
  detail[0x150] = '\x19';
  detail[0x151] = '\0';
  detail[0x152] = '\0';
  detail[0x153] = '\0';
  detail[0x154] = '\0';
  detail[0x155] = '\0';
  detail[0x156] = '\0';
  detail[0x157] = '\0';
  detail[0x184] = '\0';
  detail[0x185] = '\0';
  detail[0x186] = '\0';
  detail[0x187] = '\0';
  detail[0x1d8] = '\0';
  detail[0x1d9] = '\0';
  detail[0x1da] = '\0';
  detail[0x1db] = '\0';
  detail[0x1dc] = '\0';
  detail[0x1dd] = '\0';
  detail[0x1de] = '\0';
  detail[0x1df] = '\0';
  local_8b8 = 0;
  local_83e = 0;
  local_828 = 0;
  detail._72_8_ = detail + 0xb0;
  detail._80_8_ = detail + 0x108;
  detail._88_8_ = detail + 0x160;
  detail._96_8_ = detail + 400;
  detail._104_8_ = detail + 0x1e8;
  detail._112_8_ = &local_900;
  detail._120_8_ = local_8a8;
  detail._128_8_ = &local_850;
  detail._136_8_ = &local_83a;
  T_MANAGE_TYPE = cManageType;
  detail._184_8_ = T_MTI;
  detail._200_8_ = T_STAN;
  detail._208_8_ = T_SRC_RESOURCE;
  detail._216_8_ = T_DEST_RESOURCE;
  detail._232_8_ = &T_RESPONSE_CODE;
  detail._240_8_ = &T_TLV_BUFFER;
  detail._248_8_ = &T_CARD_NUMBER;
  sqlcxt((long)nIndiceCtx * 0x10 + 0x713948,&sqlctx,detail,&sqlfpn);
  if (sqlca.sqlcode < 0) {
    strcpy(detail,sqlca.sqlerrm.sqlerrmc);
    trace_event(detail,1);
    trace_event("End InsertSafData( MALFUNCTION ) ",5);
    iVar1 = -1;
  }
  else if (response_code == 0) {
    trace_event("End InsertSafData( OK ) ",5);
    iVar1 = 0;
  }
  else {
    trace_event("End InsertSafData( NOK ) ",5);
    iVar1 = -1;
  }
  return iVar1;
}



// WARNING: Unknown calling convention

int UpdateSafData(int nIndiceCtx,char *sMti,char cManageType,char *sStan,char *sSrcResource,
                 char *sDestResource)

{
  int iVar1;
  char T_MANAGE_TYPE;
  int response_code;
  char T_MTI [5];
  char T_STAN [7];
  char T_DEST_RESOURCE [7];
  char T_SRC_RESOURCE [7];
  sqlca sqlca;
  char detail [512];
  undefined8 local_120;
  undefined8 local_118;
  undefined8 local_110;
  undefined8 local_108;
  undefined8 local_100;
  undefined8 local_f8;
  undefined1 local_c8 [88];
  undefined2 local_70;
  undefined2 local_6e;
  undefined2 local_6c;
  undefined2 local_6a;
  undefined2 local_68;
  undefined2 local_66;
  undefined2 local_5a;
  undefined2 local_58;
  undefined2 local_56;
  undefined2 local_54;
  undefined2 local_52;
  undefined2 local_50;
  
  trace_event("Start UpdateSafData() ",5);
  T_MTI._0_4_ = *(undefined4 *)sMti;
  detail._184_8_ = T_MTI;
  detail._200_8_ = T_STAN;
  detail._216_8_ = T_DEST_RESOURCE;
  detail._208_8_ = T_SRC_RESOURCE;
  T_MTI[4] = '\0';
  T_STAN[6] = '\0';
  T_STAN._0_4_ = *(undefined4 *)sStan;
  T_DEST_RESOURCE[6] = '\0';
  T_SRC_RESOURCE[6] = '\0';
  response_code = 0x38d;
  detail[0] = '\f';
  detail[1] = '\0';
  detail[2] = '\0';
  detail[3] = '\0';
  detail[4] = '\0';
  detail[5] = '\0';
  detail[6] = '\0';
  detail[7] = '\0';
  T_STAN._4_2_ = *(undefined2 *)(sStan + 4);
  detail[8] = '\v';
  detail[9] = '\0';
  detail[10] = '\0';
  detail[0xb] = '\0';
  detail[0xc] = '\x01';
  detail[0xd] = '\0';
  detail[0xe] = '\0';
  detail[0xf] = '\0';
  detail._56_8_ = &sqladt;
  detail[0x10] = -0x72;
  detail[0x11] = '\0';
  detail[0x12] = '\0';
  detail[0x13] = '\0';
  detail[0x18] = '\0';
  detail[0x19] = '\0';
  detail[0x1a] = '\0';
  detail[0x1b] = '\0';
  detail[0x108] = '\x04';
  detail[0x109] = '\0';
  detail[0x10a] = '\0';
  detail[0x10b] = '\0';
  detail[0x10c] = '\0';
  detail[0x10d] = '\0';
  detail[0x10e] = '\0';
  detail[0x10f] = '\0';
  T_DEST_RESOURCE._0_4_ = *(undefined4 *)sDestResource;
  detail._64_8_ = &sqltds;
  T_DEST_RESOURCE._4_2_ = *(undefined2 *)(sDestResource + 4);
  detail._48_8_ = s_begin__response_code____PCRD_SAF_004c67b8;
  detail._32_8_ = sqlcud0;
  T_SRC_RESOURCE._0_4_ = *(undefined4 *)sSrcResource;
  T_SRC_RESOURCE._4_2_ = *(undefined2 *)(sSrcResource + 4);
  detail._40_8_ = &sqlca;
  detail[0x16] = '\0';
  detail[0x17] = '\x11';
  detail._176_8_ = &response_code;
  detail[0x160] = '\0';
  detail[0x161] = '\0';
  detail[0x162] = '\0';
  detail[0x163] = '\0';
  local_6c = 0;
  detail._192_8_ = &T_MANAGE_TYPE;
  local_70 = 0;
  local_5a = 0;
  local_6e = 0;
  local_58 = 0;
  detail[400] = '\0';
  detail[0x191] = '\0';
  detail[0x192] = '\0';
  detail[0x193] = '\0';
  detail[0x194] = '\0';
  detail[0x195] = '\0';
  detail[0x196] = '\0';
  detail[0x197] = '\0';
  detail[0x1e8] = '\0';
  detail[0x1e9] = '\0';
  detail[0x1ea] = '\0';
  detail[0x1eb] = '\0';
  local_120 = 0;
  detail[0x110] = '\x05';
  detail[0x111] = '\0';
  detail[0x112] = '\0';
  detail[0x113] = '\0';
  detail[0x114] = '\0';
  detail[0x115] = '\0';
  detail[0x116] = '\0';
  detail[0x117] = '\0';
  detail[0x164] = '\0';
  detail[0x165] = '\0';
  detail[0x166] = '\0';
  detail[0x167] = '\0';
  detail[0x198] = '\0';
  detail[0x199] = '\0';
  detail[0x19a] = '\0';
  detail[0x19b] = '\0';
  detail[0x19c] = '\0';
  detail[0x19d] = '\0';
  detail[0x19e] = '\0';
  detail[0x19f] = '\0';
  detail[0x1ec] = '\0';
  detail[0x1ed] = '\0';
  detail[0x1ee] = '\0';
  detail[0x1ef] = '\0';
  local_118 = 0;
  detail[0x118] = '\x01';
  detail[0x119] = '\0';
  detail[0x11a] = '\0';
  detail[0x11b] = '\0';
  detail[0x11c] = '\0';
  detail[0x11d] = '\0';
  detail[0x11e] = '\0';
  detail[0x11f] = '\0';
  detail[0x168] = '\0';
  detail[0x169] = '\0';
  detail[0x16a] = '\0';
  detail[0x16b] = '\0';
  detail[0x1a0] = '\0';
  detail[0x1a1] = '\0';
  detail[0x1a2] = '\0';
  detail[0x1a3] = '\0';
  detail[0x1a4] = '\0';
  detail[0x1a5] = '\0';
  detail[0x1a6] = '\0';
  detail[0x1a7] = '\0';
  detail[0x1f0] = '\0';
  detail[0x1f1] = '\0';
  detail[0x1f2] = '\0';
  detail[499] = '\0';
  local_110 = 0;
  local_56 = 0;
  detail[0x120] = '\a';
  detail[0x121] = '\0';
  detail[0x122] = '\0';
  detail[0x123] = '\0';
  detail[0x124] = '\0';
  detail[0x125] = '\0';
  detail[0x126] = '\0';
  detail[0x127] = '\0';
  detail[0x16c] = '\0';
  detail[0x16d] = '\0';
  detail[0x16e] = '\0';
  detail[0x16f] = '\0';
  detail[0x1a8] = '\0';
  detail[0x1a9] = '\0';
  detail[0x1aa] = '\0';
  detail[0x1ab] = '\0';
  detail[0x1ac] = '\0';
  detail[0x1ad] = '\0';
  detail[0x1ae] = '\0';
  detail[0x1af] = '\0';
  detail[500] = '\0';
  detail[0x1f5] = '\0';
  detail[0x1f6] = '\0';
  detail[0x1f7] = '\0';
  local_108 = 0;
  local_6a = 0;
  local_54 = 0;
  detail[0x128] = '\a';
  detail[0x129] = '\0';
  detail[0x12a] = '\0';
  detail[299] = '\0';
  detail[300] = '\0';
  detail[0x12d] = '\0';
  detail[0x12e] = '\0';
  detail[0x12f] = '\0';
  detail[0x170] = '\0';
  detail[0x171] = '\0';
  detail[0x172] = '\0';
  detail[0x173] = '\0';
  detail[0x1b0] = '\0';
  detail[0x1b1] = '\0';
  detail[0x1b2] = '\0';
  detail[0x1b3] = '\0';
  detail[0x1b4] = '\0';
  detail[0x1b5] = '\0';
  detail[0x1b6] = '\0';
  detail[0x1b7] = '\0';
  detail[0x1f8] = '\0';
  detail[0x1f9] = '\0';
  detail[0x1fa] = '\0';
  detail[0x1fb] = '\0';
  detail._72_8_ = detail + 0xb0;
  local_50 = 0;
  local_52 = 0;
  local_66 = 0;
  detail._80_8_ = detail + 0x108;
  detail._88_8_ = detail + 0x160;
  local_68 = 0;
  local_100 = 0;
  detail[0x130] = '\a';
  detail[0x131] = '\0';
  detail[0x132] = '\0';
  detail[0x133] = '\0';
  detail[0x134] = '\0';
  detail[0x135] = '\0';
  detail[0x136] = '\0';
  detail[0x137] = '\0';
  detail._96_8_ = detail + 400;
  detail[0x174] = '\0';
  detail[0x175] = '\0';
  detail[0x176] = '\0';
  detail[0x177] = '\0';
  detail[0x1b8] = '\0';
  detail[0x1b9] = '\0';
  detail[0x1ba] = '\0';
  detail[0x1bb] = '\0';
  detail[0x1bc] = '\0';
  detail[0x1bd] = '\0';
  detail[0x1be] = '\0';
  detail[0x1bf] = '\0';
  detail[0x1fc] = '\0';
  detail[0x1fd] = '\0';
  detail[0x1fe] = '\0';
  detail[0x1ff] = '\0';
  detail._104_8_ = detail + 0x1e8;
  local_f8 = 0;
  detail._112_8_ = &local_120;
  detail._120_8_ = local_c8;
  detail._128_8_ = &local_70;
  detail._136_8_ = &local_5a;
  T_MANAGE_TYPE = cManageType;
  sqlcxt((long)nIndiceCtx * 0x10 + 0x713948,&sqlctx,detail,&sqlfpn);
  if (sqlca.sqlcode < 0) {
    strcpy(detail,sqlca.sqlerrm.sqlerrmc);
    trace_event(detail,1);
    trace_event("End UpdateSafData( MALFUNCTION ) ",5);
    iVar1 = -1;
  }
  else if (response_code == 0) {
    trace_event("End UpdateSafData( OK ) ",5);
    iVar1 = 0;
  }
  else {
    trace_event("End UpdateSafData( NOK ) ",5);
    iVar1 = -1;
  }
  return iVar1;
}



// WARNING: Unknown calling convention

int DeleteSafData(int nIndiceCtx,char *sPan,char *sMti,char cManageType,char *sStan,
                 char *sSrcResource,char *sDestResource,char *sSlfMti,char *sSlfResponseCode)

{
  int iVar1;
  size_t sVar2;
  char T_MANAGE_TYPE;
  int response_code;
  char T_MTI [5];
  char T_SLF_MTI [5];
  anon_struct_6_2_43c7b5cf T_SLF_RESPONSE_CODE;
  char T_STAN [7];
  char T_DEST_RESOURCE [7];
  char T_SRC_RESOURCE [7];
  char T_PAN [20];
  sqlca sqlca;
  char detail [512];
  sqlexd_conflict5 sqlstm;
  
  trace_event("Start DeleteSafData() ",5);
  T_STAN[4] = '\0';
  T_STAN[5] = '\0';
  T_DEST_RESOURCE[4] = '\0';
  T_DEST_RESOURCE[5] = '\0';
  T_MTI._0_4_ = *(undefined4 *)sMti;
  T_SLF_RESPONSE_CODE.len = 0;
  T_SRC_RESOURCE[4] = '\0';
  T_SRC_RESOURCE[5] = '\0';
  T_MTI[4] = '\0';
  T_PAN[0] = '\0';
  T_PAN[1] = '\0';
  T_PAN[2] = '\0';
  T_PAN[3] = '\0';
  T_PAN[4] = '\0';
  T_PAN[5] = '\0';
  T_PAN[6] = '\0';
  T_PAN[7] = '\0';
  T_PAN[8] = '\0';
  T_PAN[9] = '\0';
  T_PAN[10] = '\0';
  T_PAN[0xb] = '\0';
  T_PAN[0xc] = '\0';
  T_PAN[0xd] = '\0';
  T_PAN[0xe] = '\0';
  T_PAN[0xf] = '\0';
  T_PAN[0x10] = '\0';
  T_PAN[0x11] = '\0';
  T_PAN[0x12] = '\0';
  T_PAN[0x13] = '\0';
  T_STAN[0] = '\0';
  T_STAN[1] = '\0';
  T_STAN[2] = '\0';
  T_STAN[3] = '\0';
  T_STAN[6] = '\0';
  T_DEST_RESOURCE[0] = '\0';
  T_DEST_RESOURCE[1] = '\0';
  T_DEST_RESOURCE[2] = '\0';
  T_DEST_RESOURCE[3] = '\0';
  T_DEST_RESOURCE[6] = '\0';
  T_SRC_RESOURCE[0] = '\0';
  T_SRC_RESOURCE[1] = '\0';
  T_SRC_RESOURCE[2] = '\0';
  T_SRC_RESOURCE[3] = '\0';
  T_SRC_RESOURCE[6] = '\0';
  T_SLF_MTI[0] = '\0';
  T_SLF_MTI[1] = '\0';
  T_SLF_MTI[2] = '\0';
  T_SLF_MTI[3] = '\0';
  T_SLF_MTI[4] = '\0';
  T_SLF_RESPONSE_CODE.arr[0] = '\0';
  T_SLF_RESPONSE_CODE.arr[1] = '\0';
  T_SLF_RESPONSE_CODE.arr[2] = '\0';
  T_SLF_RESPONSE_CODE.arr[3] = '\0';
  T_MANAGE_TYPE = '\0';
  sVar2 = strlen(sPan);
  memcpy(T_PAN,sPan,sVar2);
  sprintf(detail,"sStan=[%s]",sStan);
  trace_event(detail,1);
  T_STAN._0_4_ = *(undefined4 *)sStan;
  T_STAN._4_2_ = *(undefined2 *)(sStan + 4);
  T_DEST_RESOURCE._0_4_ = *(undefined4 *)sDestResource;
  T_DEST_RESOURCE._4_2_ = *(undefined2 *)(sDestResource + 4);
  T_SRC_RESOURCE._0_4_ = *(undefined4 *)sSrcResource;
  T_SRC_RESOURCE._4_2_ = *(undefined2 *)(sSrcResource + 4);
  T_SLF_MTI._0_4_ = *(undefined4 *)sSlfMti;
  sprintf(detail,"Start Calling response 4=[%s]",sSlfResponseCode);
  trace_event(detail,1);
  sVar2 = strlen(sSlfResponseCode);
  memcpy(T_SLF_RESPONSE_CODE.arr,sSlfResponseCode,sVar2);
  T_SLF_RESPONSE_CODE.len = (ushort)sVar2;
  sprintf(detail,"Start Calling Function 4=[%s]",sStan);
  trace_event(detail,1);
  T_MANAGE_TYPE = cManageType;
  sprintf(detail,"Start Calling Function =[%s]",sStan);
  trace_event(detail,1);
  sqlstm.sqhstv[0] = (uchar *)&response_code;
  sqlstm.sqtdso[0] = 0;
  sqlstm.sqladtp = &sqladt;
  sqlstm.sqltdsp = &sqltds;
  sqlstm.sqlety = 0x1100;
  sqlstm.sqadto[0] = 0;
  sqlstm.stmt = 
  "begin :response_code := PCRD_SAF_MANAGE . DELETE_SAF_DATA ( :T_MTI , :T_PAN , :T_MANAGE_TYPE , :T_STAN , :T_SRC_RESOURCE , :T_DEST_RESOURCE , :T_SLF_MTI , :T_SLF_RESPONSE_CODE ) ; END ;"
  ;
  sqlstm.sqadto[1] = 0;
  response_code = 0x38d;
  sqlstm.sqlvsn = 0xc;
  sqlstm.cud = sqlcud0;
  sqlstm.arrsiz = 0xb;
  sqlstm.iters = 1;
  sqlstm.offset = 0xb5;
  sqlstm.occurs = 0;
  sqlstm.sqhstl[0] = 4;
  sqlstm.sqhsts[0] = 0;
  sqlstm.sqindv[0] = (short *)0x0;
  sqlstm.sqinds[0] = 0;
  sqlstm.sqharm[0] = 0;
  sqlstm.sqhstl[1] = 5;
  sqlstm.sqhsts[1] = 0;
  sqlstm.sqindv[1] = (short *)0x0;
  sqlstm.sqinds[1] = 0;
  sqlstm.sqharm[1] = 0;
  sqlstm.sqtdso[1] = 0;
  sqlstm.sqhstl[2] = 0x14;
  sqlstm.sqhsts[2] = 0;
  sqlstm.sqindv[2] = (short *)0x0;
  sqlstm.sqinds[2] = 0;
  sqlstm.sqtdso[2] = 0;
  sqlstm.sqhstv[3] = (uchar *)&T_MANAGE_TYPE;
  sqlstm.sqadto[3] = 0;
  sqlstm.sqtdso[3] = 0;
  sqlstm.sqadto[4] = 0;
  sqlstm.sqtdso[4] = 0;
  sqlstm.sqtdso[5] = 0;
  sqlstm.sqadto[5] = 0;
  sqlstm.sqharm[2] = 0;
  sqlstm.sqadto[2] = 0;
  sqlstm.sqhstl[3] = 1;
  sqlstm.sqhsts[3] = 0;
  sqlstm.sqindv[3] = (short *)0x0;
  sqlstm.sqinds[3] = 0;
  sqlstm.sqharm[3] = 0;
  sqlstm.sqhstl[4] = 7;
  sqlstm.sqhsts[4] = 0;
  sqlstm.sqindv[4] = (short *)0x0;
  sqlstm.sqinds[4] = 0;
  sqlstm.sqharm[4] = 0;
  sqlstm.sqhstl[5] = 7;
  sqlstm.sqhsts[5] = 0;
  sqlstm.sqindv[5] = (short *)0x0;
  sqlstm.sqinds[5] = 0;
  sqlstm.sqharm[5] = 0;
  sqlstm.sqhstl[6] = 7;
  sqlstm.sqhsts[6] = 0;
  sqlstm.sqindv[6] = (short *)0x0;
  sqlstm.sqadto[7] = 0;
  sqlstm.sqadto[6] = 0;
  sqlstm.sqtdso[6] = 0;
  sqlstm.sqphsv = sqlstm.sqhstv;
  sqlstm.sqinds[6] = 0;
  sqlstm.sqharm[6] = 0;
  sqlstm.sqphsl = sqlstm.sqhstl;
  sqlstm.sqhstl[7] = 5;
  sqlstm.sqphss = sqlstm.sqhsts;
  sqlstm.sqhsts[7] = 0;
  sqlstm.sqindv[7] = (short *)0x0;
  sqlstm.sqinds[7] = 0;
  sqlstm.sqpind = sqlstm.sqindv;
  sqlstm.sqharm[7] = 0;
  sqlstm.sqtdso[7] = 0;
  sqlstm.sqpins = sqlstm.sqinds;
  sqlstm.sqhstl[8] = 6;
  sqlstm.sqhsts[8] = 0;
  sqlstm.sqindv[8] = (short *)0x0;
  sqlstm.sqparm = sqlstm.sqharm;
  sqlstm.sqinds[8] = 0;
  sqlstm.sqharm[8] = 0;
  sqlstm.sqadto[8] = 0;
  sqlstm.sqparc = sqlstm.sqharc;
  sqlstm.sqtdso[8] = 0;
  sqlstm.sqpadto = sqlstm.sqadto;
  sqlstm.sqptdso = sqlstm.sqtdso;
  sqlstm.sqlest = (uchar *)&sqlca;
  sqlstm.sqhstv[1] = (uchar *)T_MTI;
  sqlstm.sqhstv[2] = (uchar *)T_PAN;
  sqlstm.sqhstv[4] = (uchar *)T_STAN;
  sqlstm.sqhstv[5] = (uchar *)T_SRC_RESOURCE;
  sqlstm.sqhstv[6] = (uchar *)T_DEST_RESOURCE;
  sqlstm.sqhstv[7] = (uchar *)T_SLF_MTI;
  sqlstm.sqhstv[8] = (uchar *)&T_SLF_RESPONSE_CODE;
  sqlcxt((long)nIndiceCtx * 0x10 + 0x713948,&sqlctx,&sqlstm,&sqlfpn);
  if (sqlca.sqlcode < 0) {
    strcpy(detail,sqlca.sqlerrm.sqlerrmc);
    trace_event(detail,1);
    trace_event("End DeleteSafData( MALFUNCTION ) ",5);
    iVar1 = -1;
  }
  else if (response_code == 0) {
    trace_event("End DeleteSafData( OK ) ",5);
    iVar1 = 0;
  }
  else {
    trace_event("End DeleteSafData( NOK ) ",5);
    iVar1 = -1;
  }
  return iVar1;
}



// WARNING: Unknown calling convention

int InsertionSaf(int nIndiceCtx,char *sTlvInBuffer,char *sSourceResource,char *sDestResource)

{
  int iVar1;
  int iVar2;
  size_t __n;
  long lVar3;
  char *pcVar4;
  byte bVar5;
  uint local_12e4;
  uint local_12e0;
  int nLength;
  char sMti [5];
  char sResponseCode [5];
  char sStan [7];
  char sSrcResource [7];
  char sCaptureCode [7];
  char sCardNumber [23];
  char sProcCode [30];
  char sLine [512];
  char sTlvBuffer [4096];
  
  bVar5 = 0;
  trace_event("Insertion In SToreAndForward Table (Start)",5);
  pcVar4 = sTlvBuffer;
  for (lVar3 = 0x200; lVar3 != 0; lVar3 = lVar3 + -1) {
    pcVar4[0] = '\0';
    pcVar4[1] = '\0';
    pcVar4[2] = '\0';
    pcVar4[3] = '\0';
    pcVar4[4] = '\0';
    pcVar4[5] = '\0';
    pcVar4[6] = '\0';
    pcVar4[7] = '\0';
    pcVar4 = pcVar4 + (ulong)bVar5 * -0x10 + 8;
  }
  sStan[4] = '\0';
  sStan[5] = '\0';
  sCardNumber[0x14] = '\0';
  sCardNumber[0x15] = '\0';
  sCardNumber[0] = '\0';
  sCardNumber[1] = '\0';
  sCardNumber[2] = '\0';
  sCardNumber[3] = '\0';
  sCardNumber[4] = '\0';
  sCardNumber[5] = '\0';
  sCardNumber[6] = '\0';
  sCardNumber[7] = '\0';
  sCardNumber[8] = '\0';
  sCardNumber[9] = '\0';
  sCardNumber[10] = '\0';
  sCardNumber[0xb] = '\0';
  sCardNumber[0xc] = '\0';
  sCardNumber[0xd] = '\0';
  sCardNumber[0xe] = '\0';
  sCardNumber[0xf] = '\0';
  sCardNumber[0x10] = '\0';
  sCardNumber[0x11] = '\0';
  sCardNumber[0x12] = '\0';
  sCardNumber[0x13] = '\0';
  sCardNumber[0x16] = '\0';
  sMti[0] = '\0';
  sMti[1] = '\0';
  sMti[2] = '\0';
  sMti[3] = '\0';
  sMti[4] = '\0';
  sStan[0] = '\0';
  sStan[1] = '\0';
  sStan[2] = '\0';
  sStan[3] = '\0';
  sStan[6] = '\0';
  sResponseCode[0] = '\0';
  sResponseCode[1] = '\0';
  sResponseCode[2] = '\0';
  sResponseCode[3] = '\0';
  sResponseCode[4] = '\0';
  __n = strlen(sTlvInBuffer);
  memcpy(sTlvBuffer,sTlvInBuffer,__n);
  sProcCode[0x1c] = '\0';
  sProcCode[0x1d] = '\0';
  sCaptureCode[4] = '\0';
  sCaptureCode[5] = '\0';
  sProcCode[0] = '\0';
  sProcCode[1] = '\0';
  sProcCode[2] = '\0';
  sProcCode[3] = '\0';
  sProcCode[4] = '\0';
  sProcCode[5] = '\0';
  sProcCode[6] = '\0';
  sProcCode[7] = '\0';
  sProcCode[8] = '\0';
  sProcCode[9] = '\0';
  sProcCode[10] = '\0';
  sProcCode[0xb] = '\0';
  sProcCode[0xc] = '\0';
  sProcCode[0xd] = '\0';
  sProcCode[0xe] = '\0';
  sProcCode[0xf] = '\0';
  sProcCode[0x10] = '\0';
  sProcCode[0x11] = '\0';
  sProcCode[0x12] = '\0';
  sProcCode[0x13] = '\0';
  sProcCode[0x14] = '\0';
  sProcCode[0x15] = '\0';
  sProcCode[0x16] = '\0';
  sProcCode[0x17] = '\0';
  sProcCode[0x18] = '\0';
  sProcCode[0x19] = '\0';
  sProcCode[0x1a] = '\0';
  sProcCode[0x1b] = '\0';
  sCaptureCode[0] = '\0';
  sCaptureCode[1] = '\0';
  sCaptureCode[2] = '\0';
  sCaptureCode[3] = '\0';
  sCaptureCode[6] = '\0';
  GetTlvBuffer("201",sTlvBuffer,sCaptureCode,&nLength);
  GetTlvBuffer("003",sTlvBuffer,sProcCode,&nLength);
  iVar1 = GetTlvBuffer("300",sTlvBuffer,sMti,&nLength);
  if (iVar1 != 0) {
    trace_event("Message does not contain Mtype",5);
    return -1;
  }
  iVar1 = atoi(sMti);
  if (iVar1 == 0x582) {
LAB_00443d0b:
    builtin_strncpy(sMti,"1400",4);
    local_12e4 = (uint)(iVar1 == 0x579);
    local_12e0 = 0x41;
    goto LAB_004439d8;
  }
  if (iVar1 < 0x583) {
    if (iVar1 == 0x4ba) {
LAB_00443d58:
      builtin_strncpy(sMti,"1220",4);
      local_12e4 = (uint)(iVar1 == 0x4b1);
      local_12e0 = 0x41;
      goto LAB_004439d8;
    }
    if (iVar1 < 0x4bb) {
      if (iVar1 == 0x456) {
LAB_0044397d:
        iVar2 = memcmp(sCaptureCode,&DAT_004d475e,2);
        if ((iVar2 == 0) && (iVar2 = memcmp(sProcCode + 6,&DAT_004a671d,2), iVar2 == 0)) {
          builtin_strncpy(sMti,"1420",4);
        }
        else {
          builtin_strncpy(sMti,"1120",4);
        }
        local_12e0 = 0x41;
        local_12e4 = (uint)(iVar1 == 0x44d);
        goto LAB_004439d8;
      }
      if (iVar1 < 0x457) {
        if (iVar1 - 0x44cU < 2) goto LAB_0044397d;
      }
      else if (iVar1 - 0x4b0U < 2) goto LAB_00443d58;
    }
    else {
      if (iVar1 == 0x536) {
LAB_00443c64:
        builtin_strncpy(sMti,"1324",4);
        local_12e4 = (uint)(iVar1 == 0x52d);
        local_12e0 = 0x41;
        goto LAB_004439d8;
      }
      if (iVar1 < 0x537) {
        if (iVar1 - 0x52cU < 2) goto LAB_00443c64;
      }
      else if (iVar1 - 0x578U < 2) goto LAB_00443d0b;
    }
    goto LAB_00443d40;
  }
  if (iVar1 < 0x5f4) {
    if (0x5f1 < iVar1) {
LAB_00443c1c:
      builtin_strncpy(sMti,"1522",4);
      local_12e4 = (uint)(iVar1 == 0x5f3);
      local_12e0 = 0x52;
      goto LAB_004439d8;
    }
    if (iVar1 == 0x596) {
LAB_0044392b:
      builtin_strncpy(sMti,"1420",4);
      local_12e4 = (uint)(iVar1 == 0x58d);
      local_12e0 = 0x41;
      goto LAB_004439d8;
    }
    if (iVar1 < 0x597) {
      if (iVar1 - 0x58cU < 2) goto LAB_0044392b;
    }
    else if (0x5ef < iVar1) goto LAB_00443d87;
  }
  else if (iVar1 < 0x71e) {
    if (0x71b < iVar1) {
LAB_00443c9b:
      builtin_strncpy(sMti,"1820",4);
      local_12e4 = (uint)(iVar1 == 0x71d);
      local_12e0 = 0x52;
      goto LAB_004439d8;
    }
    if (iVar1 == 0x5fa) {
LAB_00443d87:
      builtin_strncpy(sMti,"1520",4);
      local_12e4 = (uint)(iVar1 == 0x5f1);
      local_12e0 = 0x52;
      goto LAB_004439d8;
    }
    if (iVar1 == 0x5fc) goto LAB_00443c1c;
  }
  else if (iVar1 == 0x726) goto LAB_00443c9b;
LAB_00443d40:
  local_12e0 = 0x41;
  local_12e4 = 0;
LAB_004439d8:
  PutTlvBuffer("300",sTlvBuffer,sMti,4);
  GetTlvBuffer("011",sTlvBuffer,sStan,&nLength);
  GetTlvBuffer("002",sTlvBuffer,sCardNumber,&nLength);
  sResponseCode[0] = '\0';
  sResponseCode[1] = '\0';
  sResponseCode[2] = '\0';
  sResponseCode[3] = '\0';
  sResponseCode[4] = '\0';
  iVar1 = GetTlvBuffer("039",sTlvBuffer,sResponseCode,&nLength);
  if (iVar1 != 0) {
    sResponseCode[0] = '\0';
    sResponseCode[1] = '\0';
    sResponseCode[2] = 'X';
    sResponseCode[0] = 'X';
    sResponseCode[1] = 'X';
  }
  trace_event("Insertion Saf Params",5);
  trace_event("========= === ======",5);
  if (debug_option == 1) {
    sprintf(sLine,"sCardNumber ... = [%s] ",sCardNumber);
    trace_event(sLine,5);
  }
  sprintf(sLine,"sMti ... .......= [%s] ",sMti);
  trace_event(sLine,5);
  sprintf(sLine,"cManageType ... = [%c] ",(ulong)local_12e0);
  trace_event(sLine,5);
  sprintf(sLine,"sStan ......... = [%s] ",sStan);
  trace_event(sLine,5);
  sprintf(sLine,"sSourceResource.= [%s] ",sSourceResource);
  trace_event(sLine,5);
  sprintf(sLine,"sDestResource ..= [%s] ",sDestResource);
  trace_event(sLine,5);
  sprintf(sLine,"nSendCounter  ..= [%d] ",(ulong)local_12e4);
  trace_event(sLine,5);
  sprintf(sLine,"sResponseCode ..= [%s] ",sResponseCode);
  trace_event(sLine,5);
  iVar1 = InsertSafData(nIndiceCtx,sMti,(char)local_12e0,sStan,sSourceResource,sDestResource,
                        local_12e4,sResponseCode,sTlvBuffer,sCardNumber);
  trace_event("Insertion In SToreAndForward Table (End)",5);
  return iVar1;
}



// WARNING: Variable defined which should be unmapped: T_resource
// WARNING: Unknown calling convention

int ResetSafAllocation(int nIndiceCtx,char *pResource)

{
  undefined4 uVar1;
  int iVar2;
  long lVar3;
  char *pcVar4;
  undefined8 in_R8;
  undefined8 in_R9;
  byte bVar5;
  char T_resource [7];
  char hostname [64];
  sqlca sqlca;
  char sLine [512];
  
  bVar5 = 0;
  trace_event("Start ResetSafAllocation()",5);
  uVar1 = *(undefined4 *)pResource;
  pcVar4 = hostname;
  for (lVar3 = 8; lVar3 != 0; lVar3 = lVar3 + -1) {
    pcVar4[0] = '\0';
    pcVar4[1] = '\0';
    pcVar4[2] = '\0';
    pcVar4[3] = '\0';
    pcVar4[4] = '\0';
    pcVar4[5] = '\0';
    pcVar4[6] = '\0';
    pcVar4[7] = '\0';
    pcVar4 = pcVar4 + (ulong)bVar5 * -0x10 + 8;
  }
  gethostname(hostname,0x40);
  sLine[0] = '\f';
  sLine[1] = '\0';
  sLine[2] = '\0';
  sLine[3] = '\0';
  sLine[4] = '\0';
  sLine[5] = '\0';
  sLine[6] = '\0';
  sLine[7] = '\0';
  sLine._56_8_ = &sqladt;
  sLine[8] = '\v';
  sLine[9] = '\0';
  sLine[10] = '\0';
  sLine[0xb] = '\0';
  sLine[0xc] = '\x01';
  sLine[0xd] = '\0';
  sLine[0xe] = '\0';
  sLine[0xf] = '\0';
  sLine[0x10] = -0x18;
  sLine[0x11] = '\0';
  sLine[0x12] = '\0';
  sLine[0x13] = '\0';
  sLine._64_8_ = &sqltds;
  sLine[0x18] = '\0';
  sLine[0x19] = '\0';
  sLine[0x1a] = '\0';
  sLine[0x1b] = '\0';
  sLine._48_8_ = s_begin_COMMIT___END___004c6c69;
  sLine._32_8_ = sqlcud0;
  sLine[0x16] = '\0';
  sLine[0x17] = '\x11';
  sLine._40_8_ = &sqlca;
  sqlcxt((long)nIndiceCtx * 0x10 + 0x713948,&sqlctx,sLine,&sqlfpn,in_R8,in_R9,uVar1);
  if (sqlca.sqlcode < 0) {
    sprintf(sLine,"End ResetSafAllocation(MALFUNCTION)|%s",sqlca.sqlerrm.sqlerrmc);
    trace_event(sLine,5);
    iVar2 = -1;
  }
  else {
    builtin_strncpy(sLine,"End ResetSafAllocation(O",0x18);
    builtin_strncpy(sLine + 0x18,"K )",4);
    trace_event(sLine,5);
    iVar2 = 0;
  }
  return iVar2;
}



// WARNING: Unknown calling convention

int CheckResourceServices(int nIndiceCtx,char *sResourceId,TSService *rpService)

{
  size_t sVar1;
  char T_proc_code [3];
  char T_src_account [3];
  char T_dest_account [3];
  char T_fct_code [4];
  int response_code;
  char T_mti [5];
  char T_resource_id [7];
  sqlca sqlca;
  char sLine [512];
  sqlexd_conflict6 sqlstm;
  
  trace_event("Start CheckResourceServices() ",5);
  T_resource_id[4] = '\0';
  T_resource_id[5] = '\0';
  T_src_account[0] = '\0';
  T_src_account[1] = '\0';
  T_proc_code[0] = '\0';
  T_proc_code[1] = '\0';
  T_dest_account[0] = '\0';
  T_dest_account[1] = '\0';
  T_resource_id[0] = '\0';
  T_resource_id[1] = '\0';
  T_resource_id[2] = '\0';
  T_resource_id[3] = '\0';
  T_resource_id[6] = '\0';
  T_mti[0] = '\0';
  T_mti[1] = '\0';
  T_mti[2] = '\0';
  T_mti[3] = '\0';
  T_mti[4] = '\0';
  T_proc_code[2] = '\0';
  T_fct_code[0] = '\0';
  T_fct_code[1] = '\0';
  T_fct_code[2] = '\0';
  T_fct_code[3] = '\0';
  T_src_account[2] = '\0';
  T_dest_account[2] = '\0';
  sVar1 = strlen(sResourceId);
  memcpy(T_resource_id,sResourceId,sVar1);
  sVar1 = strlen(rpService->szMti);
  memcpy(T_mti,rpService,sVar1);
  sVar1 = strlen(rpService->szProcCode);
  memcpy(T_proc_code,rpService->szProcCode,sVar1);
  sVar1 = strlen(rpService->szFctCode);
  memcpy(T_fct_code,rpService->szFctCode,sVar1);
  sVar1 = strlen(rpService->szSrcAcc);
  memcpy(T_src_account,rpService->szSrcAcc,sVar1);
  sVar1 = strlen(rpService->szDestAcc);
  memcpy(T_dest_account,rpService->szDestAcc,sVar1);
  sprintf(sLine,"Resource Id  : %s",T_resource_id);
  trace_event(sLine,6);
  sprintf(sLine,"Mti          : %s",T_mti);
  trace_event(sLine,6);
  sprintf(sLine,"Proc Code    : %s",T_proc_code);
  trace_event(sLine,6);
  sprintf(sLine,"Fct Code     : %s",T_fct_code);
  trace_event(sLine,6);
  sprintf(sLine,"Src  Account : %s",T_src_account);
  trace_event(sLine,6);
  sprintf(sLine,"Dest Account : %s",T_dest_account);
  trace_event(sLine,6);
  sqlstm.sqlest = (uchar *)&sqlca;
  sqlstm.sqhstv[0] = (uchar *)&response_code;
  sqlstm.sqladtp = &sqladt;
  sqlstm.sqltdsp = &sqltds;
  sqlstm.sqadto[0] = 0;
  sqlstm.sqlety = 0x1100;
  sqlstm.stmt = 
  "begin :response_code := PCRD_P7_CTRL_RESOURCE_SERVICES . CTRL_SERVICES ( :T_resource_id , :T_mti , :T_proc_code , :T_fct_code , :T_src_account , :T_dest_account ) ; END ;"
  ;
  sqlstm.sqtdso[0] = 0;
  sqlstm.sqadto[1] = 0;
  sqlstm.cud = sqlcud0;
  sqlstm.sqtdso[1] = 0;
  response_code = 0x38d;
  sqlstm.sqlvsn = 0xc;
  sqlstm.arrsiz = 7;
  sqlstm.iters = 1;
  sqlstm.offset = 5;
  sqlstm.occurs = 0;
  sqlstm.sqhstl[0] = 4;
  sqlstm.sqhsts[0] = 0;
  sqlstm.sqindv[0] = (short *)0x0;
  sqlstm.sqinds[0] = 0;
  sqlstm.sqharm[0] = 0;
  sqlstm.sqhstl[1] = 7;
  sqlstm.sqhsts[1] = 0;
  sqlstm.sqindv[1] = (short *)0x0;
  sqlstm.sqinds[1] = 0;
  sqlstm.sqharm[1] = 0;
  sqlstm.sqhstl[2] = 5;
  sqlstm.sqhsts[2] = 0;
  sqlstm.sqindv[2] = (short *)0x0;
  sqlstm.sqinds[2] = 0;
  sqlstm.sqadto[3] = 0;
  sqlstm.sqtdso[3] = 0;
  sqlstm.sqharm[2] = 0;
  sqlstm.sqadto[4] = 0;
  sqlstm.sqadto[2] = 0;
  sqlstm.sqtdso[4] = 0;
  sqlstm.sqtdso[2] = 0;
  sqlstm.sqadto[5] = 0;
  sqlstm.sqtdso[5] = 0;
  sqlstm.sqhstl[3] = 3;
  sqlstm.sqhsts[3] = 0;
  sqlstm.sqindv[3] = (short *)0x0;
  sqlstm.sqinds[3] = 0;
  sqlstm.sqharm[3] = 0;
  sqlstm.sqhstl[4] = 4;
  sqlstm.sqhsts[4] = 0;
  sqlstm.sqindv[4] = (short *)0x0;
  sqlstm.sqinds[4] = 0;
  sqlstm.sqharm[4] = 0;
  sqlstm.sqhstl[5] = 3;
  sqlstm.sqhsts[5] = 0;
  sqlstm.sqindv[5] = (short *)0x0;
  sqlstm.sqinds[5] = 0;
  sqlstm.sqharm[5] = 0;
  sqlstm.sqhstl[6] = 3;
  sqlstm.sqhsts[6] = 0;
  sqlstm.sqindv[6] = (short *)0x0;
  sqlstm.sqinds[6] = 0;
  sqlstm.sqharm[6] = 0;
  sqlstm.sqadto[6] = 0;
  sqlstm.sqtdso[6] = 0;
  sqlstm.sqphsv = sqlstm.sqhstv;
  sqlstm.sqphsl = sqlstm.sqhstl;
  sqlstm.sqphss = sqlstm.sqhsts;
  sqlstm.sqpind = sqlstm.sqindv;
  sqlstm.sqpins = sqlstm.sqinds;
  sqlstm.sqparm = sqlstm.sqharm;
  sqlstm.sqparc = sqlstm.sqharc;
  sqlstm.sqpadto = sqlstm.sqadto;
  sqlstm.sqptdso = sqlstm.sqtdso;
  sqlstm.sqhstv[1] = (uchar *)T_resource_id;
  sqlstm.sqhstv[2] = (uchar *)T_mti;
  sqlstm.sqhstv[3] = (uchar *)T_proc_code;
  sqlstm.sqhstv[4] = (uchar *)T_fct_code;
  sqlstm.sqhstv[5] = (uchar *)T_src_account;
  sqlstm.sqhstv[6] = (uchar *)T_dest_account;
  sqlcxt((long)nIndiceCtx * 0x10 + 0x713948,&sqlctx,&sqlstm,&sqlfpn);
  if (sqlca.sqlcode < 0) {
    sprintf(sLine,"%.40s",sqlca.sqlerrm.sqlerrmc);
    trace_event(sLine,1);
    trace_event("End CheckResourceServices(SYSTEM_MALFUNCTION)",5);
    response_code = 0x38d;
  }
  else {
    sprintf(sLine,"End CheckResourceServices(%d)",(ulong)(uint)response_code);
    trace_event(sLine,5);
  }
  return response_code;
}



// WARNING: Unknown calling convention

int CheckResource(int nIndiceCtx,char *sResourceId,pid_t *nPid)

{
  pid_t T_pid;
  int response_code;
  char T_resource_id [7];
  sqlca sqlca;
  sqlexd_conflict sqlstm;
  char sLine [512];
  
  trace_event("Start CheckResource() ",5);
  T_resource_id._0_4_ = *(undefined4 *)sResourceId;
  T_resource_id[6] = '\0';
  T_pid = -1;
  T_resource_id._4_2_ = *(undefined2 *)(sResourceId + 4);
  sprintf(sLine,"Resource Id  : %s",T_resource_id);
  trace_event(sLine,6);
  sqlstm.sqadto[0] = 0;
  sqlstm.sqphsv = sqlstm.sqhstv;
  sqlstm.sqladtp = &sqladt;
  sqlstm.sqtdso[0] = 0;
  sqlstm.sqadto[1] = 0;
  sqlstm.sqltdsp = &sqltds;
  sqlstm.sqtdso[1] = 0;
  response_code = 0x38d;
  sqlstm.sqlvsn = 0xc;
  sqlstm.stmt = 
  "begin :response_code := PCRD_P7_FUNCTION_TOOLS . CHECK_RESOURCE ( :T_resource_id , :T_pid ) ; END ;"
  ;
  sqlstm.arrsiz = 3;
  sqlstm.iters = 1;
  sqlstm.offset = 5;
  sqlstm.cud = sqlcud0;
  sqlstm.sqlety = 0x1100;
  sqlstm.sqhstv[0] = (uchar *)&response_code;
  sqlstm.occurs = 0;
  sqlstm.sqhstl[0] = 4;
  sqlstm.sqhsts[0] = 0;
  sqlstm.sqhstv[2] = (uchar *)&T_pid;
  sqlstm.sqindv[0] = (short *)0x0;
  sqlstm.sqinds[0] = 0;
  sqlstm.sqharm[0] = 0;
  sqlstm.sqhstl[1] = 7;
  sqlstm.sqhsts[1] = 0;
  sqlstm.sqindv[1] = (short *)0x0;
  sqlstm.sqinds[1] = 0;
  sqlstm.sqharm[1] = 0;
  sqlstm.sqhstl[2] = 4;
  sqlstm.sqhsts[2] = 0;
  sqlstm.sqindv[2] = (short *)0x0;
  sqlstm.sqinds[2] = 0;
  sqlstm.sqharm[2] = 0;
  sqlstm.sqphsl = sqlstm.sqhstl;
  sqlstm.sqadto[2] = 0;
  sqlstm.sqtdso[2] = 0;
  sqlstm.sqphss = sqlstm.sqhsts;
  sqlstm.sqpind = sqlstm.sqindv;
  sqlstm.sqpins = sqlstm.sqinds;
  sqlstm.sqparm = sqlstm.sqharm;
  sqlstm.sqparc = sqlstm.sqharc;
  sqlstm.sqpadto = sqlstm.sqadto;
  sqlstm.sqptdso = sqlstm.sqtdso;
  sqlstm.sqlest = (uchar *)&sqlca;
  sqlstm.sqhstv[1] = (uchar *)T_resource_id;
  sqlcxt((long)nIndiceCtx * 0x10 + 0x713948,&sqlctx,&sqlstm,&sqlfpn);
  if (-1 < sqlca.sqlcode) {
    *nPid = T_pid;
    sprintf(sLine,"End CheckResource(%d), Pid = [%d]",(ulong)(uint)response_code);
    trace_event(sLine,5);
    return response_code;
  }
  *nPid = T_pid;
  sprintf(sLine,"%.40s",sqlca.sqlerrm.sqlerrmc);
  trace_event(sLine,1);
  trace_event("End CheckResource(SYSTEM_MALFUNCTION)",5);
  return 0x38d;
}



// WARNING: Unknown calling convention

int PreControl(int nIndiceCtx,char *sTlvBuffer)

{
  size_t __n;
  ulong uVar1;
  uchar *puVar2;
  uint uVar3;
  bool bVar4;
  byte bVar5;
  uchar auStack_3004 [7480];
  int response_code;
  sqlca sqlca;
  char sLine [512];
  anon_struct_4100_2_43c7b5cf T_tlv_auth;
  
  bVar5 = 0;
  trace_event("Start PreControl() ",5);
  trace_event("Start RRM1 PreControl() ",5);
  puVar2 = T_tlv_auth.arr + 2;
  T_tlv_auth.arr[0] = '\0';
  T_tlv_auth.arr[1] = '\0';
  uVar3 = 0xfff;
  bVar4 = ((ulong)puVar2 & 4) != 0;
  if (bVar4) {
    T_tlv_auth.arr[2] = '\0';
    T_tlv_auth.arr[3] = '\0';
    T_tlv_auth.arr[4] = '\0';
    T_tlv_auth.arr[5] = '\0';
    uVar3 = 0xffb;
    puVar2 = T_tlv_auth.arr + 6;
  }
  for (uVar1 = (ulong)(uVar3 >> 3); uVar1 != 0; uVar1 = uVar1 - 1) {
    puVar2[0] = '\0';
    puVar2[1] = '\0';
    puVar2[2] = '\0';
    puVar2[3] = '\0';
    puVar2[4] = '\0';
    puVar2[5] = '\0';
    puVar2[6] = '\0';
    puVar2[7] = '\0';
    puVar2 = puVar2 + (ulong)bVar5 * -0x10 + 8;
  }
  if (!bVar4) {
    puVar2[0] = '\0';
    puVar2[1] = '\0';
    puVar2[2] = '\0';
    puVar2[3] = '\0';
    puVar2 = puVar2 + 4;
  }
  puVar2[0] = '\0';
  puVar2[1] = '\0';
  puVar2[2] = '\0';
  puVar2 = T_tlv_auth.arr;
  T_tlv_auth.len = 0;
  __n = strlen(sTlvBuffer);
  memcpy(puVar2,sTlvBuffer,__n);
  T_tlv_auth.len = (ushort)__n;
  sLine._40_8_ = &sqlca;
  sLine._56_8_ = &sqladt;
  sLine._64_8_ = &sqltds;
  sLine[0x16] = '\0';
  sLine[0x17] = '\x11';
  sLine[0x110] = '\0';
  sLine[0x111] = '\0';
  sLine[0x114] = '\0';
  sLine[0x115] = '\0';
  sLine._48_8_ = s_begin__response_code____PCRD_P7__004c6f30;
  sLine[0x112] = '\0';
  sLine[0x113] = '\0';
  sLine[0x116] = '\0';
  sLine[0x117] = '\0';
  response_code = 0x38d;
  sLine._32_8_ = sqlcud0;
  sLine._176_8_ = &response_code;
  sLine[0] = '\f';
  sLine[1] = '\0';
  sLine[2] = '\0';
  sLine[3] = '\0';
  sLine[4] = '\0';
  sLine[5] = '\0';
  sLine[6] = '\0';
  sLine[7] = '\0';
  sLine[8] = '\x02';
  sLine[9] = '\0';
  sLine[10] = '\0';
  sLine[0xb] = '\0';
  sLine[0xc] = '\x01';
  sLine[0xd] = '\0';
  sLine[0xe] = '\0';
  sLine[0xf] = '\0';
  sLine._72_8_ = sLine + 0xb0;
  sLine[0x10] = '\x05';
  sLine[0x11] = '\0';
  sLine[0x12] = '\0';
  sLine[0x13] = '\0';
  sLine[0x18] = '\0';
  sLine[0x19] = '\0';
  sLine[0x1a] = '\0';
  sLine[0x1b] = '\0';
  sLine._80_8_ = sLine + 0xc0;
  sLine[0xc0] = '\x04';
  sLine[0xc1] = '\0';
  sLine[0xc2] = '\0';
  sLine[0xc3] = '\0';
  sLine[0xc4] = '\0';
  sLine[0xc5] = '\0';
  sLine[0xc6] = '\0';
  sLine[199] = '\0';
  sLine[0xd0] = '\0';
  sLine[0xd1] = '\0';
  sLine[0xd2] = '\0';
  sLine[0xd3] = '\0';
  sLine[0xd8] = '\0';
  sLine[0xd9] = '\0';
  sLine[0xda] = '\0';
  sLine[0xdb] = '\0';
  sLine[0xdc] = '\0';
  sLine[0xdd] = '\0';
  sLine[0xde] = '\0';
  sLine[0xdf] = '\0';
  sLine._88_8_ = sLine + 0xd0;
  sLine[0xe8] = '\0';
  sLine[0xe9] = '\0';
  sLine[0xea] = '\0';
  sLine[0xeb] = '\0';
  sLine[0xf0] = '\0';
  sLine[0xf1] = '\0';
  sLine[0xf2] = '\0';
  sLine[0xf3] = '\0';
  sLine[0xf4] = '\0';
  sLine[0xf5] = '\0';
  sLine[0xf6] = '\0';
  sLine[0xf7] = '\0';
  sLine[200] = '\x03';
  sLine[0xc9] = '\x10';
  sLine[0xca] = '\0';
  sLine[0xcb] = '\0';
  sLine[0xcc] = '\0';
  sLine[0xcd] = '\0';
  sLine[0xce] = '\0';
  sLine[0xcf] = '\0';
  sLine._96_8_ = sLine + 0xd8;
  sLine[0xd4] = '\0';
  sLine[0xd5] = '\0';
  sLine[0xd6] = '\0';
  sLine[0xd7] = '\0';
  sLine[0xe0] = '\0';
  sLine[0xe1] = '\0';
  sLine[0xe2] = '\0';
  sLine[0xe3] = '\0';
  sLine[0xe4] = '\0';
  sLine[0xe5] = '\0';
  sLine[0xe6] = '\0';
  sLine[0xe7] = '\0';
  sLine[0xec] = '\0';
  sLine[0xed] = '\0';
  sLine[0xee] = '\0';
  sLine[0xef] = '\0';
  sLine._104_8_ = sLine + 0xe8;
  sLine[0xf8] = '\0';
  sLine[0xf9] = '\0';
  sLine[0xfa] = '\0';
  sLine[0xfb] = '\0';
  sLine[0xfc] = '\0';
  sLine[0xfd] = '\0';
  sLine[0xfe] = '\0';
  sLine[0xff] = '\0';
  sLine._112_8_ = sLine + 0xf0;
  sLine._120_8_ = sLine + 0x100;
  sLine._128_8_ = sLine + 0x110;
  sLine._136_8_ = sLine + 0x114;
  sLine._184_8_ = &T_tlv_auth;
  sqlcxt((long)nIndiceCtx * 0x10 + 0x713948,&sqlctx,sLine,&sqlfpn);
  if (-1 < sqlca.sqlcode) {
    if (response_code != 0) {
      tlvcpy(sTlvBuffer,(char *)puVar2,(uint)T_tlv_auth.len);
      sprintf(sLine,"End PreControl(%d)",(ulong)(uint)response_code);
      trace_event(sLine,5);
      return response_code;
    }
    tlvcpy(sTlvBuffer,(char *)puVar2,(uint)T_tlv_auth.len);
    trace_event("End PreControl(OK)",5);
    return 0;
  }
  tlvcpy(sTlvBuffer,(char *)puVar2,(uint)T_tlv_auth.len);
  sprintf(sLine,"%.40s",sqlca.sqlerrm.sqlerrmc);
  trace_event(sLine,1);
  trace_event("End PreControl(SYSTEM_MALFUNCTION)",5);
  return 0x38d;
}



// WARNING: Unknown calling convention

int LoadIssuerData(int nIndiceCtx,char *sTlvBuffer,char *sInternationalCheck,char *sPrimaryResource,
                  char *sSecondaryResource)

{
  int iVar1;
  size_t __n;
  ulong uVar2;
  long lVar3;
  uint uVar4;
  uchar *puVar5;
  char *pcVar6;
  bool bVar7;
  byte bVar8;
  char T_international_check;
  int response_code;
  int nTmpLen;
  char T_primary_resource [7];
  char T_secondary_resource [7];
  sqlca sqlca;
  char sEventCode [4096];
  char sLine [512];
  anon_struct_4100_2_43c7b5cf T_tlv_auth;
  
  bVar8 = 0;
  trace_event("Start LoadIssuerData() ",5);
  puVar5 = T_tlv_auth.arr + 2;
  uVar4 = 0xfff;
  T_tlv_auth.arr[0] = '\0';
  T_tlv_auth.arr[1] = '\0';
  bVar7 = ((ulong)puVar5 & 4) != 0;
  if (bVar7) {
    T_tlv_auth.arr[2] = '\0';
    T_tlv_auth.arr[3] = '\0';
    T_tlv_auth.arr[4] = '\0';
    T_tlv_auth.arr[5] = '\0';
    uVar4 = 0xffb;
    puVar5 = T_tlv_auth.arr + 6;
  }
  for (uVar2 = (ulong)(uVar4 >> 3); uVar2 != 0; uVar2 = uVar2 - 1) {
    puVar5[0] = '\0';
    puVar5[1] = '\0';
    puVar5[2] = '\0';
    puVar5[3] = '\0';
    puVar5[4] = '\0';
    puVar5[5] = '\0';
    puVar5[6] = '\0';
    puVar5[7] = '\0';
    puVar5 = puVar5 + (ulong)bVar8 * -0x10 + 8;
  }
  if (!bVar7) {
    puVar5[0] = '\0';
    puVar5[1] = '\0';
    puVar5[2] = '\0';
    puVar5[3] = '\0';
    puVar5 = puVar5 + 4;
  }
  puVar5[0] = '\0';
  puVar5[1] = '\0';
  puVar5[2] = '\0';
  T_international_check = *sInternationalCheck;
  T_primary_resource[4] = '\0';
  T_primary_resource[5] = '\0';
  T_tlv_auth.len = 0;
  T_secondary_resource[4] = '\0';
  T_secondary_resource[5] = '\0';
  T_primary_resource[0] = '\0';
  T_primary_resource[1] = '\0';
  T_primary_resource[2] = '\0';
  T_primary_resource[3] = '\0';
  T_primary_resource[6] = '\0';
  T_secondary_resource[0] = '\0';
  T_secondary_resource[1] = '\0';
  T_secondary_resource[2] = '\0';
  T_secondary_resource[3] = '\0';
  T_secondary_resource[6] = '\0';
  __n = strlen(sTlvBuffer);
  puVar5 = T_tlv_auth.arr;
  memcpy(puVar5,sTlvBuffer,__n);
  T_tlv_auth.len = (ushort)__n;
  sLine._40_8_ = &sqlca;
  sLine._56_8_ = &sqladt;
  sLine[0x1aa] = '\0';
  sLine[0x1ab] = '\0';
  sLine[0x1a8] = '\0';
  sLine[0x1a9] = '\0';
  sLine._64_8_ = &sqltds;
  sLine[0x16] = '\0';
  sLine[0x17] = '\x11';
  sLine[0x1b2] = '\0';
  sLine[0x1b3] = '\0';
  sLine._48_8_ = s_begin__response_code____PCRD_P7__004c6ff0;
  sLine[0x1b4] = '\0';
  sLine[0x1b5] = '\0';
  response_code = 0x38d;
  sLine[0] = '\f';
  sLine[1] = '\0';
  sLine[2] = '\0';
  sLine[3] = '\0';
  sLine[4] = '\0';
  sLine[5] = '\0';
  sLine[6] = '\0';
  sLine[7] = '\0';
  sLine._32_8_ = sqlcud0;
  sLine._176_8_ = &response_code;
  sLine[8] = '\x05';
  sLine[9] = '\0';
  sLine[10] = '\0';
  sLine[0xb] = '\0';
  sLine[0xc] = '\x01';
  sLine[0xd] = '\0';
  sLine[0xe] = '\0';
  sLine[0xf] = '\0';
  sLine[0x10] = '\x05';
  sLine[0x11] = '\0';
  sLine[0x12] = '\0';
  sLine[0x13] = '\0';
  sLine._192_8_ = &T_international_check;
  sLine[0x18] = '\0';
  sLine[0x19] = '\0';
  sLine[0x1a] = '\0';
  sLine[0x1b] = '\0';
  sLine[0xd8] = '\x04';
  sLine[0xd9] = '\0';
  sLine[0xda] = '\0';
  sLine[0xdb] = '\0';
  sLine[0xdc] = '\0';
  sLine[0xdd] = '\0';
  sLine[0xde] = '\0';
  sLine[0xdf] = '\0';
  sLine[0x100] = '\0';
  sLine[0x101] = '\0';
  sLine[0x102] = '\0';
  sLine[0x103] = '\0';
  sLine[0x118] = '\0';
  sLine[0x119] = '\0';
  sLine[0x11a] = '\0';
  sLine[0x11b] = '\0';
  sLine[0x11c] = '\0';
  sLine[0x11d] = '\0';
  sLine[0x11e] = '\0';
  sLine[0x11f] = '\0';
  sLine[0x140] = '\0';
  sLine[0x141] = '\0';
  sLine[0x142] = '\0';
  sLine[0x143] = '\0';
  sLine[0x158] = '\0';
  sLine[0x159] = '\0';
  sLine[0x15a] = '\0';
  sLine[0x15b] = '\0';
  sLine[0x15c] = '\0';
  sLine[0x15d] = '\0';
  sLine[0x15e] = '\0';
  sLine[0x15f] = '\0';
  sLine[0xe0] = '\x03';
  sLine[0xe1] = '\x10';
  sLine[0xe2] = '\0';
  sLine[0xe3] = '\0';
  sLine[0xe4] = '\0';
  sLine[0xe5] = '\0';
  sLine[0xe6] = '\0';
  sLine[0xe7] = '\0';
  sLine[0x104] = '\0';
  sLine[0x105] = '\0';
  sLine[0x106] = '\0';
  sLine[0x107] = '\0';
  sLine[0x120] = '\0';
  sLine[0x121] = '\0';
  sLine[0x122] = '\0';
  sLine[0x123] = '\0';
  sLine[0x124] = '\0';
  sLine[0x125] = '\0';
  sLine[0x126] = '\0';
  sLine[0x127] = '\0';
  sLine[0x144] = '\0';
  sLine[0x145] = '\0';
  sLine[0x146] = '\0';
  sLine[0x147] = '\0';
  sLine[0x160] = '\0';
  sLine[0x161] = '\0';
  sLine[0x162] = '\0';
  sLine[0x163] = '\0';
  sLine[0x164] = '\0';
  sLine[0x165] = '\0';
  sLine[0x166] = '\0';
  sLine[0x167] = '\0';
  sLine[0xe8] = '\x01';
  sLine[0xe9] = '\0';
  sLine[0xea] = '\0';
  sLine[0xeb] = '\0';
  sLine[0xec] = '\0';
  sLine[0xed] = '\0';
  sLine[0xee] = '\0';
  sLine[0xef] = '\0';
  sLine[0x108] = '\0';
  sLine[0x109] = '\0';
  sLine[0x10a] = '\0';
  sLine[0x10b] = '\0';
  sLine[0x128] = '\0';
  sLine[0x129] = '\0';
  sLine[0x12a] = '\0';
  sLine[299] = '\0';
  sLine[300] = '\0';
  sLine[0x12d] = '\0';
  sLine[0x12e] = '\0';
  sLine[0x12f] = '\0';
  sLine[0x148] = '\0';
  sLine[0x149] = '\0';
  sLine[0x14a] = '\0';
  sLine[0x14b] = '\0';
  sLine[0x1b6] = '\0';
  sLine[0x1b7] = '\0';
  sLine[0x1ac] = '\0';
  sLine[0x1ad] = '\0';
  sLine[0x1ae] = '\0';
  sLine[0x1af] = '\0';
  sLine[0x1b8] = '\0';
  sLine[0x1b9] = '\0';
  sLine[0x168] = '\0';
  sLine[0x169] = '\0';
  sLine[0x16a] = '\0';
  sLine[0x16b] = '\0';
  sLine[0x16c] = '\0';
  sLine[0x16d] = '\0';
  sLine[0x16e] = '\0';
  sLine[0x16f] = '\0';
  sLine[0x1b0] = '\0';
  sLine[0x1b1] = '\0';
  sLine[0x1ba] = '\0';
  sLine[0x1bb] = '\0';
  sLine._72_8_ = sLine + 0xb0;
  sLine[0xf0] = '\a';
  sLine[0xf1] = '\0';
  sLine[0xf2] = '\0';
  sLine[0xf3] = '\0';
  sLine[0xf4] = '\0';
  sLine[0xf5] = '\0';
  sLine[0xf6] = '\0';
  sLine[0xf7] = '\0';
  sLine[0x10c] = '\0';
  sLine[0x10d] = '\0';
  sLine[0x10e] = '\0';
  sLine[0x10f] = '\0';
  sLine._80_8_ = sLine + 0xd8;
  sLine[0x130] = '\0';
  sLine[0x131] = '\0';
  sLine[0x132] = '\0';
  sLine[0x133] = '\0';
  sLine[0x134] = '\0';
  sLine[0x135] = '\0';
  sLine[0x136] = '\0';
  sLine[0x137] = '\0';
  sLine[0x14c] = '\0';
  sLine[0x14d] = '\0';
  sLine[0x14e] = '\0';
  sLine[0x14f] = '\0';
  sLine[0x170] = '\0';
  sLine[0x171] = '\0';
  sLine[0x172] = '\0';
  sLine[0x173] = '\0';
  sLine[0x174] = '\0';
  sLine[0x175] = '\0';
  sLine[0x176] = '\0';
  sLine[0x177] = '\0';
  sLine._88_8_ = sLine + 0x100;
  sLine[0xf8] = '\a';
  sLine[0xf9] = '\0';
  sLine[0xfa] = '\0';
  sLine[0xfb] = '\0';
  sLine[0xfc] = '\0';
  sLine[0xfd] = '\0';
  sLine[0xfe] = '\0';
  sLine[0xff] = '\0';
  sLine[0x110] = '\0';
  sLine[0x111] = '\0';
  sLine[0x112] = '\0';
  sLine[0x113] = '\0';
  sLine._96_8_ = sLine + 0x118;
  sLine[0x138] = '\0';
  sLine[0x139] = '\0';
  sLine[0x13a] = '\0';
  sLine[0x13b] = '\0';
  sLine[0x13c] = '\0';
  sLine[0x13d] = '\0';
  sLine[0x13e] = '\0';
  sLine[0x13f] = '\0';
  sLine[0x150] = '\0';
  sLine[0x151] = '\0';
  sLine[0x152] = '\0';
  sLine[0x153] = '\0';
  sLine[0x178] = '\0';
  sLine[0x179] = '\0';
  sLine[0x17a] = '\0';
  sLine[0x17b] = '\0';
  sLine[0x17c] = '\0';
  sLine[0x17d] = '\0';
  sLine[0x17e] = '\0';
  sLine[0x17f] = '\0';
  sLine._104_8_ = sLine + 0x140;
  sLine._112_8_ = sLine + 0x158;
  sLine._120_8_ = sLine + 0x180;
  sLine._128_8_ = sLine + 0x1a8;
  sLine._136_8_ = sLine + 0x1b2;
  sLine._184_8_ = &T_tlv_auth;
  sLine._200_8_ = T_primary_resource;
  sLine._208_8_ = T_secondary_resource;
  sqlcxt((long)nIndiceCtx * 0x10 + 0x713948,&sqlctx,sLine,&sqlfpn);
  if (sqlca.sqlcode < 0) {
    tlvcpy(sTlvBuffer,(char *)puVar5,(uint)T_tlv_auth.len);
    sprintf(sLine,"%.40s",sqlca.sqlerrm.sqlerrmc);
    trace_event(sLine,1);
    trace_event("End LoadIssuerData(SYSTEM_MALFUNCTION)",5);
    response_code = 0x38d;
  }
  else if (response_code == 0) {
    tlvcpy(sTlvBuffer,(char *)puVar5,(uint)T_tlv_auth.len);
    *(undefined4 *)sPrimaryResource = T_primary_resource._0_4_;
    *(undefined2 *)(sPrimaryResource + 4) = T_primary_resource._4_2_;
    *(undefined4 *)sSecondaryResource = T_secondary_resource._0_4_;
    *(undefined2 *)(sSecondaryResource + 4) = T_secondary_resource._4_2_;
    pcVar6 = sLine;
    for (lVar3 = 0x200; lVar3 != 0; lVar3 = lVar3 + -1) {
      pcVar6[0] = '\0';
      pcVar6[1] = '\0';
      pcVar6[2] = '\0';
      pcVar6[3] = '\0';
      pcVar6[4] = '\0';
      pcVar6[5] = '\0';
      pcVar6[6] = '\0';
      pcVar6[7] = '\0';
      pcVar6 = pcVar6 + (ulong)bVar8 * -0x10 + 8;
    }
    pcVar6 = sEventCode;
    for (lVar3 = 0x200; lVar3 != 0; lVar3 = lVar3 + -1) {
      pcVar6[0] = '\0';
      pcVar6[1] = '\0';
      pcVar6[2] = '\0';
      pcVar6[3] = '\0';
      pcVar6[4] = '\0';
      pcVar6[5] = '\0';
      pcVar6[6] = '\0';
      pcVar6[7] = '\0';
      pcVar6 = pcVar6 + (ulong)bVar8 * -0x10 + 8;
    }
    iVar1 = memcmp(sPrimaryResource,"000001",6);
    if (((iVar1 == 0) ||
        ((iVar1 = GetTlvBuffer("203",sTlvBuffer,sEventCode,&nTmpLen), iVar1 == 0 &&
         (iVar1 = memcmp(sEventCode,&DAT_004caed9,3), iVar1 != 0)))) &&
       (iVar1 = GetTlvBuffer("055",sTlvBuffer,sLine,&nTmpLen), iVar1 == 0)) {
      pcVar6 = sLine;
      for (lVar3 = 0x200; lVar3 != 0; lVar3 = lVar3 + -1) {
        pcVar6[0] = '\0';
        pcVar6[1] = '\0';
        pcVar6[2] = '\0';
        pcVar6[3] = '\0';
        pcVar6[4] = '\0';
        pcVar6[5] = '\0';
        pcVar6[6] = '\0';
        pcVar6[7] = '\0';
        pcVar6 = pcVar6 + (ulong)bVar8 * -0x10 + 8;
      }
      response_code = gen_iss_script_data(nIndiceCtx,sTlvBuffer,sLine);
    }
    trace_event("End   LoadIssuerData() ",5);
    response_code = 0;
  }
  else {
    tlvcpy(sTlvBuffer,(char *)puVar5,(uint)T_tlv_auth.len);
    dump_buffer((uchar *)sTlvBuffer,(uint)T_tlv_auth.len,'A','X','X');
    sprintf(sLine,"End LoadIssuerData(%d)",(ulong)(uint)response_code);
    trace_event(sLine,5);
  }
  return response_code;
}



// WARNING: Unknown calling convention

int GetOriginalDataElements
              (int nIndiceCtx,char *sRoutCaptureMode,char *sTlvBuffer,char *sRoutingCode)

{
  ushort uVar1;
  size_t __n;
  ulong uVar2;
  uint uVar3;
  uchar *puVar4;
  bool bVar5;
  byte bVar6;
  uchar auStack_3014 [7451];
  char T_auth_flag;
  char T_rout_capture_mode [2];
  int response_code;
  char T_ROUTING_CODE [7];
  sqlca sqlca;
  char sLine [512];
  anon_struct_4100_2_43c7b5cf T_tlv_auth;
  
  bVar6 = 0;
  trace_event("Start GetOriginalDataElements() ",5);
  uVar3 = 0xfff;
  sLine._192_8_ = &T_tlv_auth;
  puVar4 = T_tlv_auth.arr + 2;
  T_rout_capture_mode[1] = '\0';
  T_rout_capture_mode[0] = *sRoutCaptureMode;
  bVar5 = ((ulong)puVar4 & 4) != 0;
  T_tlv_auth.arr[0] = '\0';
  T_tlv_auth.arr[1] = '\0';
  if (bVar5) {
    T_tlv_auth.arr[2] = '\0';
    T_tlv_auth.arr[3] = '\0';
    T_tlv_auth.arr[4] = '\0';
    T_tlv_auth.arr[5] = '\0';
    uVar3 = 0xffb;
    puVar4 = T_tlv_auth.arr + 6;
  }
  for (uVar2 = (ulong)(uVar3 >> 3); uVar2 != 0; uVar2 = uVar2 - 1) {
    puVar4[0] = '\0';
    puVar4[1] = '\0';
    puVar4[2] = '\0';
    puVar4[3] = '\0';
    puVar4[4] = '\0';
    puVar4[5] = '\0';
    puVar4[6] = '\0';
    puVar4[7] = '\0';
    puVar4 = puVar4 + (ulong)bVar6 * -0x10 + 8;
  }
  if (!bVar5) {
    puVar4[0] = '\0';
    puVar4[1] = '\0';
    puVar4[2] = '\0';
    puVar4[3] = '\0';
    puVar4 = puVar4 + 4;
  }
  puVar4[0] = '\0';
  puVar4[1] = '\0';
  puVar4[2] = '\0';
  puVar4 = T_tlv_auth.arr;
  T_tlv_auth.len = 0;
  T_auth_flag = '\0';
  __n = strlen(sTlvBuffer);
  memcpy(puVar4,sTlvBuffer,__n);
  T_tlv_auth.len = (ushort)__n;
  sLine._40_8_ = &sqlca;
  sLine._56_8_ = &sqladt;
  sLine._64_8_ = &sqltds;
  sLine[0x16] = '\0';
  sLine[0x17] = '\x11';
  sLine[0x170] = '\0';
  sLine[0x171] = '\0';
  sLine[0x178] = '\0';
  sLine[0x179] = '\0';
  sLine._48_8_ = s_begin__response_code____PCRD_P7__004c70e8;
  sLine[0x172] = '\0';
  sLine[0x173] = '\0';
  sLine[0x17a] = '\0';
  sLine[0x17b] = '\0';
  response_code = 0x38d;
  sLine._32_8_ = sqlcud0;
  sLine._176_8_ = &response_code;
  sLine[0] = '\f';
  sLine[1] = '\0';
  sLine[2] = '\0';
  sLine[3] = '\0';
  sLine[4] = '\0';
  sLine[5] = '\0';
  sLine[6] = '\0';
  sLine[7] = '\0';
  sLine[8] = '\x04';
  sLine[9] = '\0';
  sLine[10] = '\0';
  sLine[0xb] = '\0';
  sLine[0xc] = '\x01';
  sLine[0xd] = '\0';
  sLine[0xe] = '\0';
  sLine[0xf] = '\0';
  sLine._184_8_ = T_rout_capture_mode;
  sLine[0x10] = '\x05';
  sLine[0x11] = '\0';
  sLine[0x12] = '\0';
  sLine[0x13] = '\0';
  sLine[0x18] = '\0';
  sLine[0x19] = '\0';
  sLine[0x1a] = '\0';
  sLine[0x1b] = '\0';
  sLine[0xd0] = '\x04';
  sLine[0xd1] = '\0';
  sLine[0xd2] = '\0';
  sLine[0xd3] = '\0';
  sLine[0xd4] = '\0';
  sLine[0xd5] = '\0';
  sLine[0xd6] = '\0';
  sLine[0xd7] = '\0';
  sLine._200_8_ = &T_auth_flag;
  sLine[0xf0] = '\0';
  sLine[0xf1] = '\0';
  sLine[0xf2] = '\0';
  sLine[0xf3] = '\0';
  sLine[0x100] = '\0';
  sLine[0x101] = '\0';
  sLine[0x102] = '\0';
  sLine[0x103] = '\0';
  sLine[0x104] = '\0';
  sLine[0x105] = '\0';
  sLine[0x106] = '\0';
  sLine[0x107] = '\0';
  sLine[0x120] = '\0';
  sLine[0x121] = '\0';
  sLine[0x122] = '\0';
  sLine[0x123] = '\0';
  sLine[0x130] = '\0';
  sLine[0x131] = '\0';
  sLine[0x132] = '\0';
  sLine[0x133] = '\0';
  sLine[0x134] = '\0';
  sLine[0x135] = '\0';
  sLine[0x136] = '\0';
  sLine[0x137] = '\0';
  sLine[0xd8] = '\x02';
  sLine[0xd9] = '\0';
  sLine[0xda] = '\0';
  sLine[0xdb] = '\0';
  sLine[0xdc] = '\0';
  sLine[0xdd] = '\0';
  sLine[0xde] = '\0';
  sLine[0xdf] = '\0';
  sLine[0xf4] = '\0';
  sLine[0xf5] = '\0';
  sLine[0xf6] = '\0';
  sLine[0xf7] = '\0';
  sLine[0x108] = '\0';
  sLine[0x109] = '\0';
  sLine[0x10a] = '\0';
  sLine[0x10b] = '\0';
  sLine[0x10c] = '\0';
  sLine[0x10d] = '\0';
  sLine[0x10e] = '\0';
  sLine[0x10f] = '\0';
  sLine[0x124] = '\0';
  sLine[0x125] = '\0';
  sLine[0x126] = '\0';
  sLine[0x127] = '\0';
  sLine[0x138] = '\0';
  sLine[0x139] = '\0';
  sLine[0x13a] = '\0';
  sLine[0x13b] = '\0';
  sLine[0x13c] = '\0';
  sLine[0x13d] = '\0';
  sLine[0x13e] = '\0';
  sLine[0x13f] = '\0';
  sLine[0xe0] = '\x03';
  sLine[0xe1] = '\x10';
  sLine[0xe2] = '\0';
  sLine[0xe3] = '\0';
  sLine[0xe4] = '\0';
  sLine[0xe5] = '\0';
  sLine[0xe6] = '\0';
  sLine[0xe7] = '\0';
  sLine[0xf8] = '\0';
  sLine[0xf9] = '\0';
  sLine[0xfa] = '\0';
  sLine[0xfb] = '\0';
  sLine[0x110] = '\0';
  sLine[0x111] = '\0';
  sLine[0x112] = '\0';
  sLine[0x113] = '\0';
  sLine[0x114] = '\0';
  sLine[0x115] = '\0';
  sLine[0x116] = '\0';
  sLine[0x117] = '\0';
  sLine[0x128] = '\0';
  sLine[0x129] = '\0';
  sLine[0x12a] = '\0';
  sLine[299] = '\0';
  sLine[0x17e] = '\0';
  sLine[0x17f] = '\0';
  sLine._72_8_ = sLine + 0xb0;
  sLine[0x140] = '\0';
  sLine[0x141] = '\0';
  sLine[0x142] = '\0';
  sLine[0x143] = '\0';
  sLine[0x144] = '\0';
  sLine[0x145] = '\0';
  sLine[0x146] = '\0';
  sLine[0x147] = '\0';
  sLine[0x174] = '\0';
  sLine[0x175] = '\0';
  sLine[0x17c] = '\0';
  sLine[0x17d] = '\0';
  sLine._80_8_ = sLine + 0xd0;
  sLine[0xe8] = '\x01';
  sLine[0xe9] = '\0';
  sLine[0xea] = '\0';
  sLine[0xeb] = '\0';
  sLine[0xec] = '\0';
  sLine[0xed] = '\0';
  sLine[0xee] = '\0';
  sLine[0xef] = '\0';
  sLine[0xfc] = '\0';
  sLine[0xfd] = '\0';
  sLine[0xfe] = '\0';
  sLine[0xff] = '\0';
  sLine[0x118] = '\0';
  sLine[0x119] = '\0';
  sLine[0x11a] = '\0';
  sLine[0x11b] = '\0';
  sLine[0x11c] = '\0';
  sLine[0x11d] = '\0';
  sLine[0x11e] = '\0';
  sLine[0x11f] = '\0';
  sLine._88_8_ = sLine + 0xf0;
  sLine[300] = '\0';
  sLine[0x12d] = '\0';
  sLine[0x12e] = '\0';
  sLine[0x12f] = '\0';
  sLine[0x148] = '\0';
  sLine[0x149] = '\0';
  sLine[0x14a] = '\0';
  sLine[0x14b] = '\0';
  sLine[0x14c] = '\0';
  sLine[0x14d] = '\0';
  sLine[0x14e] = '\0';
  sLine[0x14f] = '\0';
  sLine[0x176] = '\0';
  sLine[0x177] = '\0';
  sLine._96_8_ = sLine + 0x100;
  sLine._104_8_ = sLine + 0x120;
  sLine._112_8_ = sLine + 0x130;
  sLine._120_8_ = sLine + 0x150;
  sLine._128_8_ = sLine + 0x170;
  sLine._136_8_ = sLine + 0x178;
  sqlcxt((long)nIndiceCtx * 0x10 + 0x713948,&sqlctx,sLine,&sqlfpn);
  uVar1 = T_tlv_auth.len;
  if (sqlca.sqlcode < 0) {
    tlvcpy(sTlvBuffer,(char *)puVar4,(uint)T_tlv_auth.len);
    sprintf(sLine,"%.40s",sqlca.sqlerrm.sqlerrmc);
    trace_event(sLine,1);
    trace_event("End GetOriginalDataElements(SYSTEM_MALFUNCTION)",5);
    response_code = 0x38d;
  }
  else {
    memcpy(sTlvBuffer,puVar4,(ulong)T_tlv_auth.len);
    *(undefined4 *)sRoutingCode = T_ROUTING_CODE._0_4_;
    *(undefined2 *)(sRoutingCode + 4) = T_ROUTING_CODE._4_2_;
    if (T_auth_flag == 'R') {
      tlvcpy(sTlvBuffer,(char *)puVar4,(uint)uVar1);
      sprintf(sLine,"End GetOriginalDataElements(%d)",(ulong)(uint)response_code);
      trace_event(sLine,5);
      response_code = -1;
    }
    else {
      tlvcpy(sTlvBuffer,(char *)puVar4,(uint)uVar1);
      sprintf(sLine,"End GetOriginalDataElements(%d)",(ulong)(uint)response_code);
      trace_event(sLine,5);
    }
  }
  return response_code;
}



// WARNING: Unknown calling convention

int GetOriginalPctDataElements
              (int nIndiceCtx,char *sRoutCaptureMode,char *sTlvBuffer,char *sRoutingCode)

{
  ushort uVar1;
  size_t __n;
  ulong uVar2;
  uint uVar3;
  uchar *puVar4;
  bool bVar5;
  byte bVar6;
  uchar auStack_3014 [7452];
  char T_rout_capture_mode [2];
  int response_code;
  char T_ROUTING_CODE [7];
  sqlca sqlca;
  char sLine [512];
  anon_struct_4100_2_43c7b5cf T_tlv_auth;
  
  bVar6 = 0;
  trace_event("Start GetOriginalPctDataElements() ",5);
  sLine._184_8_ = &T_tlv_auth;
  T_tlv_auth.arr[0] = '\0';
  T_tlv_auth.arr[1] = '\0';
  uVar3 = 0xfff;
  puVar4 = T_tlv_auth.arr + 2;
  bVar5 = ((ulong)puVar4 & 4) != 0;
  if (bVar5) {
    T_tlv_auth.arr[2] = '\0';
    T_tlv_auth.arr[3] = '\0';
    T_tlv_auth.arr[4] = '\0';
    T_tlv_auth.arr[5] = '\0';
    uVar3 = 0xffb;
    puVar4 = T_tlv_auth.arr + 6;
  }
  for (uVar2 = (ulong)(uVar3 >> 3); uVar2 != 0; uVar2 = uVar2 - 1) {
    puVar4[0] = '\0';
    puVar4[1] = '\0';
    puVar4[2] = '\0';
    puVar4[3] = '\0';
    puVar4[4] = '\0';
    puVar4[5] = '\0';
    puVar4[6] = '\0';
    puVar4[7] = '\0';
    puVar4 = puVar4 + (ulong)bVar6 * -0x10 + 8;
  }
  if (!bVar5) {
    puVar4[0] = '\0';
    puVar4[1] = '\0';
    puVar4[2] = '\0';
    puVar4[3] = '\0';
    puVar4 = puVar4 + 4;
  }
  puVar4[0] = '\0';
  puVar4[1] = '\0';
  puVar4[2] = '\0';
  puVar4 = T_tlv_auth.arr;
  T_tlv_auth.len = 0;
  __n = strlen(sTlvBuffer);
  memcpy(puVar4,sTlvBuffer,__n);
  T_tlv_auth.len = (ushort)__n;
  sLine._40_8_ = &sqlca;
  sLine._56_8_ = &sqladt;
  sLine._64_8_ = &sqltds;
  sLine[0x16] = '\0';
  sLine[0x17] = '\x11';
  sLine[0x170] = '\0';
  sLine[0x171] = '\0';
  sLine[0x178] = '\0';
  sLine[0x179] = '\0';
  sLine._48_8_ = s_begin__response_code____PCRD_P7__004c71e8;
  sLine[0x172] = '\0';
  sLine[0x173] = '\0';
  sLine[0x17a] = '\0';
  sLine[0x17b] = '\0';
  response_code = 0x38d;
  sLine._32_8_ = sqlcud0;
  sLine._176_8_ = &response_code;
  sLine[0] = '\f';
  sLine[1] = '\0';
  sLine[2] = '\0';
  sLine[3] = '\0';
  sLine[4] = '\0';
  sLine[5] = '\0';
  sLine[6] = '\0';
  sLine[7] = '\0';
  sLine[8] = '\x04';
  sLine[9] = '\0';
  sLine[10] = '\0';
  sLine[0xb] = '\0';
  sLine[0xc] = '\x01';
  sLine[0xd] = '\0';
  sLine[0xe] = '\0';
  sLine[0xf] = '\0';
  sLine._72_8_ = sLine + 0xb0;
  sLine[0x10] = '$';
  sLine[0x11] = '\0';
  sLine[0x12] = '\0';
  sLine[0x13] = '\0';
  sLine[0x18] = '\0';
  sLine[0x19] = '\0';
  sLine[0x1a] = '\0';
  sLine[0x1b] = '\0';
  sLine._80_8_ = sLine + 0xd0;
  sLine[0xd0] = '\x04';
  sLine[0xd1] = '\0';
  sLine[0xd2] = '\0';
  sLine[0xd3] = '\0';
  sLine[0xd4] = '\0';
  sLine[0xd5] = '\0';
  sLine[0xd6] = '\0';
  sLine[0xd7] = '\0';
  sLine[0xf0] = '\0';
  sLine[0xf1] = '\0';
  sLine[0xf2] = '\0';
  sLine[0xf3] = '\0';
  sLine[0x100] = '\0';
  sLine[0x101] = '\0';
  sLine[0x102] = '\0';
  sLine[0x103] = '\0';
  sLine[0x104] = '\0';
  sLine[0x105] = '\0';
  sLine[0x106] = '\0';
  sLine[0x107] = '\0';
  sLine._88_8_ = sLine + 0xf0;
  sLine[0x120] = '\0';
  sLine[0x121] = '\0';
  sLine[0x122] = '\0';
  sLine[0x123] = '\0';
  sLine[0x130] = '\0';
  sLine[0x131] = '\0';
  sLine[0x132] = '\0';
  sLine[0x133] = '\0';
  sLine[0x134] = '\0';
  sLine[0x135] = '\0';
  sLine[0x136] = '\0';
  sLine[0x137] = '\0';
  sLine[0xd8] = '\x03';
  sLine[0xd9] = '\x10';
  sLine[0xda] = '\0';
  sLine[0xdb] = '\0';
  sLine[0xdc] = '\0';
  sLine[0xdd] = '\0';
  sLine[0xde] = '\0';
  sLine[0xdf] = '\0';
  sLine._96_8_ = sLine + 0x100;
  sLine[0xf4] = '\0';
  sLine[0xf5] = '\0';
  sLine[0xf6] = '\0';
  sLine[0xf7] = '\0';
  sLine[0x108] = '\0';
  sLine[0x109] = '\0';
  sLine[0x10a] = '\0';
  sLine[0x10b] = '\0';
  sLine[0x10c] = '\0';
  sLine[0x10d] = '\0';
  sLine[0x10e] = '\0';
  sLine[0x10f] = '\0';
  sLine[0x124] = '\0';
  sLine[0x125] = '\0';
  sLine[0x126] = '\0';
  sLine[0x127] = '\0';
  sLine._104_8_ = sLine + 0x120;
  sLine[0x138] = '\0';
  sLine[0x139] = '\0';
  sLine[0x13a] = '\0';
  sLine[0x13b] = '\0';
  sLine[0x13c] = '\0';
  sLine[0x13d] = '\0';
  sLine[0x13e] = '\0';
  sLine[0x13f] = '\0';
  sLine._112_8_ = sLine + 0x130;
  sLine._120_8_ = sLine + 0x150;
  sLine._128_8_ = sLine + 0x170;
  sLine._136_8_ = sLine + 0x178;
  sqlcxt((long)nIndiceCtx * 0x10 + 0x713948,&sqlctx,sLine,&sqlfpn);
  uVar1 = T_tlv_auth.len;
  if (sqlca.sqlcode < 0) {
    tlvcpy(sTlvBuffer,(char *)puVar4,(uint)T_tlv_auth.len);
    sprintf(sLine,"%.40s",sqlca.sqlerrm.sqlerrmc);
    trace_event(sLine,1);
    trace_event("End GetOriginalPctDataElements(SYSTEM_MALFUNCTION)",5);
    response_code = 0x38d;
  }
  else {
    memcpy(sTlvBuffer,puVar4,(ulong)T_tlv_auth.len);
    *(undefined4 *)sRoutingCode = T_ROUTING_CODE._0_4_;
    *(undefined2 *)(sRoutingCode + 4) = T_ROUTING_CODE._4_2_;
    tlvcpy(sTlvBuffer,(char *)puVar4,(uint)uVar1);
    sprintf(sLine,"End GetOriginalPctDataElements(%d)",(ulong)(uint)response_code);
    trace_event(sLine,5);
  }
  return response_code;
}



// WARNING: Unknown calling convention

int GetSecurityFlags(int nIndiceCtx,char *sTlvAuth,char *sOnOffFlag)

{
  size_t sVar1;
  ulong uVar2;
  uchar *puVar3;
  uint uVar4;
  bool bVar5;
  byte bVar6;
  uchar auStack_3014 [7468];
  char T_on_off_flag [4];
  int response_code;
  sqlca sqlca;
  char sLine [512];
  anon_struct_4100_2_43c7b5cf T_tlv_auth;
  
  bVar6 = 0;
  trace_event("Start GetSecurityFlags() ",5);
  puVar3 = T_tlv_auth.arr + 2;
  uVar4 = 0xfff;
  T_tlv_auth.arr[0] = '\0';
  T_tlv_auth.arr[1] = '\0';
  bVar5 = ((ulong)puVar3 & 4) != 0;
  if (bVar5) {
    T_tlv_auth.arr[2] = '\0';
    T_tlv_auth.arr[3] = '\0';
    T_tlv_auth.arr[4] = '\0';
    T_tlv_auth.arr[5] = '\0';
    uVar4 = 0xffb;
    puVar3 = T_tlv_auth.arr + 6;
  }
  for (uVar2 = (ulong)(uVar4 >> 3); uVar2 != 0; uVar2 = uVar2 - 1) {
    puVar3[0] = '\0';
    puVar3[1] = '\0';
    puVar3[2] = '\0';
    puVar3[3] = '\0';
    puVar3[4] = '\0';
    puVar3[5] = '\0';
    puVar3[6] = '\0';
    puVar3[7] = '\0';
    puVar3 = puVar3 + (ulong)bVar6 * -0x10 + 8;
  }
  if (!bVar5) {
    puVar3[0] = '\0';
    puVar3[1] = '\0';
    puVar3[2] = '\0';
    puVar3[3] = '\0';
    puVar3 = puVar3 + 4;
  }
  puVar3[0] = '\0';
  puVar3[1] = '\0';
  puVar3[2] = '\0';
  puVar3 = T_tlv_auth.arr;
  T_tlv_auth.len = 0;
  T_on_off_flag[0] = '\0';
  T_on_off_flag[1] = '\0';
  T_on_off_flag[2] = '\0';
  T_on_off_flag[3] = '\0';
  sVar1 = strlen(sTlvAuth);
  memcpy(puVar3,sTlvAuth,sVar1);
  T_tlv_auth.len = (ushort)sVar1;
  sVar1 = strlen(sOnOffFlag);
  memcpy(T_on_off_flag,sOnOffFlag,sVar1);
  sLine._40_8_ = &sqlca;
  sLine._56_8_ = &sqladt;
  sLine[0x148] = '\0';
  sLine[0x149] = '\0';
  sLine._64_8_ = &sqltds;
  sLine[0x16] = '\0';
  sLine[0x17] = '\x11';
  sLine[0x14e] = '\0';
  sLine[0x14f] = '\0';
  sLine[0x14a] = '\0';
  sLine[0x14b] = '\0';
  sLine._48_8_ = s_begin__response_code____PCRD_P7__004c72f8;
  sLine[0x150] = '\0';
  sLine[0x151] = '\0';
  response_code = 0x38d;
  sLine._32_8_ = sqlcud0;
  sLine._176_8_ = &response_code;
  sLine[0] = '\f';
  sLine[1] = '\0';
  sLine[2] = '\0';
  sLine[3] = '\0';
  sLine[4] = '\0';
  sLine[5] = '\0';
  sLine[6] = '\0';
  sLine[7] = '\0';
  sLine[8] = '\x03';
  sLine[9] = '\0';
  sLine[10] = '\0';
  sLine[0xb] = '\0';
  sLine[0xc] = '\x01';
  sLine[0xd] = '\0';
  sLine[0xe] = '\0';
  sLine[0xf] = '\0';
  sLine._72_8_ = sLine + 0xb0;
  sLine[0x10] = '\x05';
  sLine[0x11] = '\0';
  sLine[0x12] = '\0';
  sLine[0x13] = '\0';
  sLine[0x18] = '\0';
  sLine[0x19] = '\0';
  sLine[0x1a] = '\0';
  sLine[0x1b] = '\0';
  sLine[200] = '\x04';
  sLine[0xc9] = '\0';
  sLine[0xca] = '\0';
  sLine[0xcb] = '\0';
  sLine[0xcc] = '\0';
  sLine[0xcd] = '\0';
  sLine[0xce] = '\0';
  sLine[0xcf] = '\0';
  sLine[0xe0] = '\0';
  sLine[0xe1] = '\0';
  sLine[0xe2] = '\0';
  sLine[0xe3] = '\0';
  sLine[0xf0] = '\0';
  sLine[0xf1] = '\0';
  sLine[0xf2] = '\0';
  sLine[0xf3] = '\0';
  sLine[0xf4] = '\0';
  sLine[0xf5] = '\0';
  sLine[0xf6] = '\0';
  sLine[0xf7] = '\0';
  sLine[0x108] = '\0';
  sLine[0x109] = '\0';
  sLine[0x10a] = '\0';
  sLine[0x10b] = '\0';
  sLine[0x118] = '\0';
  sLine[0x119] = '\0';
  sLine[0x11a] = '\0';
  sLine[0x11b] = '\0';
  sLine[0x11c] = '\0';
  sLine[0x11d] = '\0';
  sLine[0x11e] = '\0';
  sLine[0x11f] = '\0';
  sLine[0xd0] = '\x03';
  sLine[0xd1] = '\x10';
  sLine[0xd2] = '\0';
  sLine[0xd3] = '\0';
  sLine[0xd4] = '\0';
  sLine[0xd5] = '\0';
  sLine[0xd6] = '\0';
  sLine[0xd7] = '\0';
  sLine[0xe4] = '\0';
  sLine[0xe5] = '\0';
  sLine[0xe6] = '\0';
  sLine[0xe7] = '\0';
  sLine[0xf8] = '\0';
  sLine[0xf9] = '\0';
  sLine[0xfa] = '\0';
  sLine[0xfb] = '\0';
  sLine[0xfc] = '\0';
  sLine[0xfd] = '\0';
  sLine[0xfe] = '\0';
  sLine[0xff] = '\0';
  sLine[0x10c] = '\0';
  sLine[0x10d] = '\0';
  sLine[0x10e] = '\0';
  sLine[0x10f] = '\0';
  sLine[0x120] = '\0';
  sLine[0x121] = '\0';
  sLine[0x122] = '\0';
  sLine[0x123] = '\0';
  sLine[0x124] = '\0';
  sLine[0x125] = '\0';
  sLine[0x126] = '\0';
  sLine[0x127] = '\0';
  sLine[0xd8] = '\x04';
  sLine[0xd9] = '\0';
  sLine[0xda] = '\0';
  sLine[0xdb] = '\0';
  sLine[0xdc] = '\0';
  sLine[0xdd] = '\0';
  sLine[0xde] = '\0';
  sLine[0xdf] = '\0';
  sLine[0xe8] = '\0';
  sLine[0xe9] = '\0';
  sLine[0xea] = '\0';
  sLine[0xeb] = '\0';
  sLine[0x100] = '\0';
  sLine[0x101] = '\0';
  sLine[0x102] = '\0';
  sLine[0x103] = '\0';
  sLine[0x104] = '\0';
  sLine[0x105] = '\0';
  sLine[0x106] = '\0';
  sLine[0x107] = '\0';
  sLine[0x110] = '\0';
  sLine[0x111] = '\0';
  sLine[0x112] = '\0';
  sLine[0x113] = '\0';
  sLine[0x128] = '\0';
  sLine[0x129] = '\0';
  sLine[0x12a] = '\0';
  sLine[299] = '\0';
  sLine[300] = '\0';
  sLine[0x12d] = '\0';
  sLine[0x12e] = '\0';
  sLine[0x12f] = '\0';
  sLine._80_8_ = sLine + 200;
  sLine[0x14c] = '\0';
  sLine[0x14d] = '\0';
  sLine[0x152] = '\0';
  sLine[0x153] = '\0';
  sLine._88_8_ = sLine + 0xe0;
  sLine._96_8_ = sLine + 0xf0;
  sLine._104_8_ = sLine + 0x108;
  sLine._112_8_ = sLine + 0x118;
  sLine._120_8_ = sLine + 0x130;
  sLine._128_8_ = sLine + 0x148;
  sLine._136_8_ = sLine + 0x14e;
  sLine._184_8_ = &T_tlv_auth;
  sLine._192_8_ = T_on_off_flag;
  sqlcxt((long)nIndiceCtx * 0x10 + 0x713948,&sqlctx,sLine,&sqlfpn);
  if (sqlca.sqlcode < 0) {
    tlvcpy(sTlvAuth,(char *)puVar3,(uint)T_tlv_auth.len);
    sprintf(sLine,"%.40s",sqlca.sqlerrm.sqlerrmc);
    trace_event(sLine,1);
    trace_event("End GetSecurityFlags(SYSTEM_MALFUNCTION)",5);
    response_code = 0x38d;
  }
  else if (response_code == 0) {
    tlvcpy(sTlvAuth,(char *)puVar3,(uint)T_tlv_auth.len);
    trace_event("End GetSecurityFlags( OK )",5);
    response_code = 0;
  }
  else {
    tlvcpy(sTlvAuth,(char *)puVar3,(uint)T_tlv_auth.len);
    sprintf(sLine,"End GetSecurityFlags( %d )",(ulong)(uint)response_code);
    trace_event(sLine,5);
  }
  return response_code;
}



// WARNING: Unknown calling convention

int CheckAccAvailable(int nIndiceCtx,char *sTlvBuffer)

{
  uchar *source;
  size_t __n;
  int response_code;
  sqlca sqlca;
  char sLine [512];
  anon_struct_4100_2_43c7b5cf T_tlv_auth;
  
  source = T_tlv_auth.arr;
  trace_event("Start CheckAccAvailable() ",5);
  __n = strlen(sTlvBuffer);
  memcpy(source,sTlvBuffer,__n);
  sLine._56_8_ = &sqladt;
  sLine[0x110] = '\0';
  sLine[0x111] = '\0';
  sLine[0x114] = '\0';
  sLine[0x115] = '\0';
  sLine._64_8_ = &sqltds;
  sLine[0x16] = '\0';
  sLine[0x17] = '\x11';
  sLine[0x112] = '\0';
  sLine[0x113] = '\0';
  sLine[0x116] = '\0';
  sLine[0x117] = '\0';
  sLine._48_8_ = s_begin__response_code____PCRD_P7__004c73e0;
  T_tlv_auth.len = (ushort)__n;
  response_code = 0x38d;
  sLine[0] = '\f';
  sLine[1] = '\0';
  sLine[2] = '\0';
  sLine[3] = '\0';
  sLine[4] = '\0';
  sLine[5] = '\0';
  sLine[6] = '\0';
  sLine[7] = '\0';
  sLine._32_8_ = sqlcud0;
  sLine._40_8_ = &sqlca;
  sLine[8] = '\x02';
  sLine[9] = '\0';
  sLine[10] = '\0';
  sLine[0xb] = '\0';
  sLine[0xc] = '\x01';
  sLine[0xd] = '\0';
  sLine[0xe] = '\0';
  sLine[0xf] = '\0';
  sLine[0x10] = '\x05';
  sLine[0x11] = '\0';
  sLine[0x12] = '\0';
  sLine[0x13] = '\0';
  sLine._176_8_ = &response_code;
  sLine[0x18] = '\0';
  sLine[0x19] = '\0';
  sLine[0x1a] = '\0';
  sLine[0x1b] = '\0';
  sLine[0xc0] = '\x04';
  sLine[0xc1] = '\0';
  sLine[0xc2] = '\0';
  sLine[0xc3] = '\0';
  sLine[0xc4] = '\0';
  sLine[0xc5] = '\0';
  sLine[0xc6] = '\0';
  sLine[199] = '\0';
  sLine[0xd0] = '\0';
  sLine[0xd1] = '\0';
  sLine[0xd2] = '\0';
  sLine[0xd3] = '\0';
  sLine._72_8_ = sLine + 0xb0;
  sLine[0xd8] = '\0';
  sLine[0xd9] = '\0';
  sLine[0xda] = '\0';
  sLine[0xdb] = '\0';
  sLine[0xdc] = '\0';
  sLine[0xdd] = '\0';
  sLine[0xde] = '\0';
  sLine[0xdf] = '\0';
  sLine[0xe8] = '\0';
  sLine[0xe9] = '\0';
  sLine[0xea] = '\0';
  sLine[0xeb] = '\0';
  sLine[0xf0] = '\0';
  sLine[0xf1] = '\0';
  sLine[0xf2] = '\0';
  sLine[0xf3] = '\0';
  sLine[0xf4] = '\0';
  sLine[0xf5] = '\0';
  sLine[0xf6] = '\0';
  sLine[0xf7] = '\0';
  sLine._80_8_ = sLine + 0xc0;
  sLine[200] = '\x03';
  sLine[0xc9] = '\x10';
  sLine[0xca] = '\0';
  sLine[0xcb] = '\0';
  sLine[0xcc] = '\0';
  sLine[0xcd] = '\0';
  sLine[0xce] = '\0';
  sLine[0xcf] = '\0';
  sLine[0xd4] = '\0';
  sLine[0xd5] = '\0';
  sLine[0xd6] = '\0';
  sLine[0xd7] = '\0';
  sLine[0xe0] = '\0';
  sLine[0xe1] = '\0';
  sLine[0xe2] = '\0';
  sLine[0xe3] = '\0';
  sLine[0xe4] = '\0';
  sLine[0xe5] = '\0';
  sLine[0xe6] = '\0';
  sLine[0xe7] = '\0';
  sLine._88_8_ = sLine + 0xd0;
  sLine[0xec] = '\0';
  sLine[0xed] = '\0';
  sLine[0xee] = '\0';
  sLine[0xef] = '\0';
  sLine[0xf8] = '\0';
  sLine[0xf9] = '\0';
  sLine[0xfa] = '\0';
  sLine[0xfb] = '\0';
  sLine[0xfc] = '\0';
  sLine[0xfd] = '\0';
  sLine[0xfe] = '\0';
  sLine[0xff] = '\0';
  sLine._96_8_ = sLine + 0xd8;
  sLine._104_8_ = sLine + 0xe8;
  sLine._112_8_ = sLine + 0xf0;
  sLine._120_8_ = sLine + 0x100;
  sLine._128_8_ = sLine + 0x110;
  sLine._136_8_ = sLine + 0x114;
  sLine._184_8_ = &T_tlv_auth;
  sqlcxt((long)nIndiceCtx * 0x10 + 0x713948,&sqlctx,sLine,&sqlfpn);
  if ((-1 < sqlca.sqlcode) && (response_code == 0)) {
    tlvcpy(sTlvBuffer,(char *)source,(uint)T_tlv_auth.len);
    trace_event("End CheckAccAvailable(OK)",5);
    return 0;
  }
  tlvcpy(sTlvBuffer,(char *)source,(uint)T_tlv_auth.len);
  sprintf(sLine,"End CheckAccAvailable(%d)",(ulong)(uint)response_code);
  trace_event(sLine,5);
  return response_code;
}



// WARNING: Unknown calling convention

int AuthorLocal(int nIndiceCtx,char *sTlvBuffer,TSIsoInfo *sIsoMsg,char *sMyResource,
               char *sPrimResource,char SafIndicator)

{
  int iVar1;
  uint uVar2;
  int iVar3;
  char *pcVar4;
  long lVar5;
  byte bVar6;
  uint local_6dd8;
  char PosCond [3];
  char sActionCode [4];
  char sCurrency [4];
  char sEventCode [4];
  int nLength;
  char sMsgType [5];
  timeval time_s_aut;
  char sAmount [19];
  char AddPos [27];
  char sProcCode [56];
  char szWork [512];
  char tag_AVS [512];
  char sLine [513];
  char tmpField [4099];
  TSTlvPrivate TlvInfo;
  TSTlvAutho sTlvInfo;
  
  bVar6 = 0;
  trace_event("START AUTHORLOCAL",0);
  pcVar4 = tag_AVS;
  for (lVar5 = 0x40; lVar5 != 0; lVar5 = lVar5 + -1) {
    pcVar4[0] = '\0';
    pcVar4[1] = '\0';
    pcVar4[2] = '\0';
    pcVar4[3] = '\0';
    pcVar4[4] = '\0';
    pcVar4[5] = '\0';
    pcVar4[6] = '\0';
    pcVar4[7] = '\0';
    pcVar4 = pcVar4 + (ulong)bVar6 * -0x10 + 8;
  }
  sActionCode[0] = '\0';
  sActionCode[1] = '\0';
  sActionCode[2] = '\0';
  sActionCode[3] = '\0';
  AddPos[0] = '\0';
  AddPos[1] = '\0';
  AddPos[2] = '\0';
  AddPos[3] = '\0';
  AddPos[4] = '\0';
  AddPos[5] = '\0';
  AddPos[6] = '\0';
  AddPos[7] = '\0';
  AddPos[8] = '\0';
  AddPos[9] = '\0';
  AddPos[10] = '\0';
  AddPos[0xb] = '\0';
  AddPos[0xc] = '\0';
  AddPos[0xd] = '\0';
  AddPos[0xe] = '\0';
  AddPos[0xf] = '\0';
  AddPos[0x10] = '\0';
  AddPos[0x11] = '\0';
  AddPos[0x12] = '\0';
  AddPos[0x13] = '\0';
  AddPos[0x14] = '\0';
  AddPos[0x15] = '\0';
  AddPos[0x16] = '\0';
  AddPos[0x17] = '\0';
  AddPos[0x18] = '\0';
  AddPos[0x19] = '\0';
  AddPos[0x1a] = '\0';
  pcVar4 = tmpField;
  for (lVar5 = 0x200; lVar5 != 0; lVar5 = lVar5 + -1) {
    pcVar4[0] = '\0';
    pcVar4[1] = '\0';
    pcVar4[2] = '\0';
    pcVar4[3] = '\0';
    pcVar4[4] = '\0';
    pcVar4[5] = '\0';
    pcVar4[6] = '\0';
    pcVar4[7] = '\0';
    pcVar4 = pcVar4 + (ulong)bVar6 * -0x10 + 8;
  }
  pcVar4[0] = '\0';
  pcVar4[1] = '\0';
  pcVar4[2] = '\0';
  pcVar4 = sLine;
  for (lVar5 = 0x40; lVar5 != 0; lVar5 = lVar5 + -1) {
    pcVar4[0] = '\0';
    pcVar4[1] = '\0';
    pcVar4[2] = '\0';
    pcVar4[3] = '\0';
    pcVar4[4] = '\0';
    pcVar4[5] = '\0';
    pcVar4[6] = '\0';
    pcVar4[7] = '\0';
    pcVar4 = pcVar4 + (ulong)bVar6 * -0x10 + 8;
  }
  *pcVar4 = '\0';
  pcVar4 = szWork;
  for (lVar5 = 0x40; lVar5 != 0; lVar5 = lVar5 + -1) {
    pcVar4[0] = '\0';
    pcVar4[1] = '\0';
    pcVar4[2] = '\0';
    pcVar4[3] = '\0';
    pcVar4[4] = '\0';
    pcVar4[5] = '\0';
    pcVar4[6] = '\0';
    pcVar4[7] = '\0';
    pcVar4 = pcVar4 + (ulong)bVar6 * -0x10 + 8;
  }
  pcVar4 = sProcCode;
  for (lVar5 = 7; lVar5 != 0; lVar5 = lVar5 + -1) {
    pcVar4[0] = '\0';
    pcVar4[1] = '\0';
    pcVar4[2] = '\0';
    pcVar4[3] = '\0';
    pcVar4[4] = '\0';
    pcVar4[5] = '\0';
    pcVar4[6] = '\0';
    pcVar4[7] = '\0';
    pcVar4 = pcVar4 + (ulong)bVar6 * -0x10 + 8;
  }
  iVar1 = GetTlvBuffer("200",sTlvBuffer,tmpField,&nLength);
  if (iVar1 != 0) {
    PutTlvBuffer("200",sTlvBuffer,"000001",6);
  }
  PutTlvBuffer("277",sTlvBuffer,"P",1);
  PutTlvBuffer("255",sTlvBuffer,"E2",2);
  PosCond[0] = '\0';
  PosCond[1] = '\0';
  PosCond[2] = '\0';
  iVar1 = GetTlvBuffer("061",sTlvBuffer,tmpField,&nLength);
  local_6dd8 = 0xffffffff;
  if (iVar1 == 0) {
    InitTlvPrivate(&TlvInfo);
    AnalyseTlvPrivate(tmpField,nLength,&TlvInfo);
    iVar1 = GetTlvPrivate("025",&TlvInfo,PosCond,&nLength);
    if (iVar1 == 0) {
      iVar1 = memcmp(PosCond,&DAT_004a908d,2);
      local_6dd8 = -(uint)(iVar1 != 0);
      sprintf(sLine,"ACCOUNT VERIFICATION2 ENH8.2 ...%d ",(ulong)local_6dd8);
      trace_event(sLine,5);
    }
    iVar1 = GetTlvPrivate("061",&TlvInfo,AddPos,&nLength);
    if (iVar1 == 0) {
      uVar2 = 0;
      if (AddPos[6] != '8') {
        uVar2 = local_6dd8;
      }
      sprintf(sLine,"MasterCard Account Status Inquiry ...%d ",(ulong)uVar2);
      trace_event(sLine,5);
      local_6dd8 = uVar2;
    }
  }
  iVar1 = GetActionCode(nIndiceCtx,sTlvBuffer,sActionCode);
  if (iVar1 == 0) {
    iVar1 = memcmp(sActionCode,"000",3);
    if (iVar1 == 0 && local_6dd8 == 0) {
      PutTlvBuffer("039",sTlvBuffer,"085",3);
    }
    else {
      PutTlvBuffer("039",sTlvBuffer,sActionCode,3);
    }
  }
  else {
    PutTlvBuffer("039",sTlvBuffer,"909",3);
  }
  iVar1 = GetTlvBuffer("072",sTlvBuffer,tmpField,&nLength);
  if (iVar1 == 0) {
    gettimeofday((timeval *)&time_s_aut,(__timezone_ptr_t)0x0);
    sprintf(szWork,"%010ld%06d",time_s_aut.tv_sec,time_s_aut.tv_usec);
    tmpField[0x10] = szWork[0];
    tmpField[0x11] = szWork[1];
    tmpField[0x12] = szWork[2];
    tmpField[0x13] = szWork[3];
    tmpField[0x14] = szWork[4];
    tmpField[0x15] = szWork[5];
    tmpField[0x16] = szWork[6];
    tmpField[0x17] = szWork[7];
    tmpField[0x18] = szWork[8];
    tmpField[0x19] = szWork[9];
    tmpField[0x1a] = szWork[10];
    tmpField[0x1b] = szWork[0xb];
    tmpField[0x1c] = szWork[0xc];
    tmpField[0x1d] = szWork[0xd];
    tmpField[0x1e] = szWork[0xe];
    tmpField[0x1f] = szWork[0xf];
    PutTlvBuffer("072",sTlvBuffer,tmpField,nLength);
  }
  uVar2 = InsertionAuthoActivity(nIndiceCtx,sTlvBuffer);
  if (uVar2 != 0) {
    trace_event("Can Not Write In Authorisation table !!!",0);
    PutTlvBuffer("288",sTlvBuffer,"SAF",3);
    iVar1 = InsertionAuthoActivity(nIndiceCtx,sTlvBuffer);
    if (iVar1 != 0) {
      trace_event("Can Not Write In Authorisation SAF table !!!",0);
    }
    PutTlvBuffer("203",sTlvBuffer,"902",3);
    PutTlvBuffer("039",sTlvBuffer,"909",3);
    iVar1 = GetActionCode(nIndiceCtx,sTlvBuffer,sActionCode);
    if (iVar1 == 0) {
      uVar2 = 0xfffffff7;
      PutTlvBuffer("039",sTlvBuffer,sActionCode,3);
    }
    else {
      uVar2 = 0xfffffff7;
      PutTlvBuffer("039",sTlvBuffer,"909",3);
    }
  }
  iVar1 = GetTlvBuffer("048",sTlvBuffer,tmpField,&nLength);
  if (iVar1 == 0) {
    InitTlvPrivate(&TlvInfo);
    AnalyseTlvPrivate(tmpField,nLength,&TlvInfo);
    iVar1 = GetTlvPrivate("P82",&TlvInfo,tag_AVS,&nLength);
    if ((iVar1 == 0) && (iVar1 = memcmp(tag_AVS,&DAT_004c764a,2), iVar1 == 0)) {
      pcVar4 = tmpField;
      for (lVar5 = 0x200; lVar5 != 0; lVar5 = lVar5 + -1) {
        pcVar4[0] = '\0';
        pcVar4[1] = '\0';
        pcVar4[2] = '\0';
        pcVar4[3] = '\0';
        pcVar4[4] = '\0';
        pcVar4[5] = '\0';
        pcVar4[6] = '\0';
        pcVar4[7] = '\0';
        pcVar4 = pcVar4 + (ulong)bVar6 * -0x10 + 8;
      }
      pcVar4[0] = '\0';
      pcVar4[1] = '\0';
      pcVar4[2] = '\0';
      iVar1 = GetIsoField(0x2f,sIsoMsg,tmpField,&nLength);
      if (iVar1 == 0) {
        InitTlvPrivate(&TlvInfo);
        AnalyseTlvPrivate(tmpField,nLength,&TlvInfo);
        iVar1 = GetTlvPrivate("P83",&TlvInfo,tmpField,&nLength);
        if ((iVar1 == 0) && (iVar1 = memcmp(sActionCode,"000",3), iVar1 == 0)) {
          PutTlvBuffer("039",sTlvBuffer,"085",3);
          goto LAB_004465d9;
        }
      }
      PutTlvBuffer("039",sTlvBuffer,"100",3);
    }
  }
LAB_004465d9:
  if (local_6dd8 != 0) {
    iVar1 = memcmp(sActionCode,"000",3);
    if ((iVar1 == 0) || (iVar1 = memcmp(sActionCode,&DAT_004d1e2a,3), iVar1 == 0)) {
      uVar2 = UpdateCardActivity(nIndiceCtx,'2',sTlvBuffer);
      trace_event("Here 2",5);
    }
    else {
      trace_event("Here 1",5);
      iVar1 = memcmp(sActionCode,&DAT_004c7467,3);
      if (iVar1 == 0) {
        trace_event("Here",5);
        uVar2 = UpdateCardActivity(nIndiceCtx,'0',sTlvBuffer);
      }
      else {
        uVar2 = UpdateCardActivity(nIndiceCtx,'1',sTlvBuffer);
      }
    }
    if (uVar2 != 0) {
      trace_event("Can Not Update Card Activity  !!!",0);
    }
    iVar1 = GetIsoField(2,sIsoMsg,sProcCode,&nLength);
    if ((iVar1 == 0) && (iVar1 = memcmp(sProcCode,&DAT_004aac5d,2), iVar1 == 0)) {
      InitTlvAutho(&sTlvInfo);
      AnalyseTlvAutho(sTlvBuffer,&sTlvInfo);
      TlvToIso(nIndiceCtx,&sTlvInfo,sIsoMsg,'\x01');
      sprintf(sLine,"End   AuthorLocal(PIN CHANGE  %d)",(ulong)uVar2);
      trace_event(sLine,5);
      return 0;
    }
    iVar1 = memcmp(sActionCode,"000",3);
    if ((iVar1 == 0) || (iVar3 = memcmp(sActionCode,&DAT_004d1e2a,3), iVar3 == 0)) {
      iVar3 = memcmp(sProcCode,&DAT_004c9c2d,2);
      if (iVar3 != 0) {
        uVar2 = UpdateBalance(nIndiceCtx,'2',sTlvBuffer);
        if (uVar2 != 0) {
          trace_event("Can Not Update Balance  !!!",0);
        }
        iVar1 = memcmp(sActionCode,"000",3);
      }
      if (iVar1 == 0) {
        UpdateSettlement(nIndiceCtx,sTlvBuffer);
      }
    }
    PrintTlvBuffer(sTlvBuffer);
    if (SafIndicator == 'S') {
      uVar2 = AutSafProcessing(nIndiceCtx,sTlvBuffer,sMyResource,sPrimResource);
    }
  }
  pcVar4 = strstr(sMsgType,"100");
  if (((pcVar4 != (char *)0x0) || (pcVar4 = strstr(sMsgType,"200"), pcVar4 != (char *)0x0)) ||
     (pcVar4 = strstr(sMsgType,"400"), pcVar4 != (char *)0x0)) {
    sMsgType[2] = '1';
    sMsgType[3] = '0';
    PutTlvBuffer("300",sTlvBuffer,sMsgType,4);
    sprintf(sLine,"Converting MTI [%s] -> [%s]",sMsgType,sMsgType);
    trace_event(sLine,5);
  }
  InitTlvAutho(&sTlvInfo);
  AnalyseTlvAutho(sTlvBuffer,&sTlvInfo);
  TlvToIso(nIndiceCtx,&sTlvInfo,sIsoMsg,'\x01');
  sprintf(sLine,"End   AuthorLocal :=>: (%d)",(ulong)uVar2);
  trace_event(sLine,5);
  return uVar2;
}



// WARNING: Unknown calling convention

int AuthorUpdate(int nIndiceCtx,char *sTlvBuffer,TSIsoInfo *sIsoMsg,char *sMyResource,
                char *sMsgReason,char SafIndicator)

{
  int iVar1;
  int iVar2;
  int iVar3;
  long lVar4;
  char *pcVar5;
  char sActionCode [4];
  char sCurrency [4];
  char sEventCode [4];
  int nLength;
  char sPrimResource [7];
  timeval time_s_aut;
  char sAmount [19];
  char tmpField [256];
  char szWork [256];
  char sTimeField [256];
  TSTlvAutho sTlvInfo;
  
  sPrimResource[4] = '\0';
  sPrimResource[5] = '\0';
  sPrimResource[0] = '\0';
  sPrimResource[1] = '\0';
  sPrimResource[2] = '\0';
  sPrimResource[3] = '\0';
  pcVar5 = szWork;
  for (lVar4 = 0x20; lVar4 != 0; lVar4 = lVar4 + -1) {
    pcVar5[0] = '\0';
    pcVar5[1] = '\0';
    pcVar5[2] = '\0';
    pcVar5[3] = '\0';
    pcVar5[4] = '\0';
    pcVar5[5] = '\0';
    pcVar5[6] = '\0';
    pcVar5[7] = '\0';
    pcVar5 = pcVar5 + 8;
  }
  sPrimResource[6] = '\0';
  sActionCode[0] = '\0';
  sActionCode[1] = '\0';
  sActionCode[2] = '\0';
  sActionCode[3] = '\0';
  pcVar5 = tmpField;
  for (lVar4 = 0x20; lVar4 != 0; lVar4 = lVar4 + -1) {
    pcVar5[0] = '\0';
    pcVar5[1] = '\0';
    pcVar5[2] = '\0';
    pcVar5[3] = '\0';
    pcVar5[4] = '\0';
    pcVar5[5] = '\0';
    pcVar5[6] = '\0';
    pcVar5[7] = '\0';
    pcVar5 = pcVar5 + 8;
  }
  pcVar5 = sTimeField;
  for (lVar4 = 0x20; lVar4 != 0; lVar4 = lVar4 + -1) {
    pcVar5[0] = '\0';
    pcVar5[1] = '\0';
    pcVar5[2] = '\0';
    pcVar5[3] = '\0';
    pcVar5[4] = '\0';
    pcVar5[5] = '\0';
    pcVar5[6] = '\0';
    pcVar5[7] = '\0';
    pcVar5 = pcVar5 + 8;
  }
  PutTlvBuffer("277",sTlvBuffer,"P",1);
  PutTlvBuffer("255",sTlvBuffer,"E2",2);
  GetTlvBuffer("200",sTlvBuffer,sPrimResource,&nLength);
  PutTlvBuffer("025",sTlvBuffer,sMsgReason,4);
  iVar1 = GetActionCode(nIndiceCtx,sTlvBuffer,sActionCode);
  if (iVar1 == 0) {
    PutTlvBuffer("039",sTlvBuffer,sActionCode,3);
  }
  else {
    PutTlvBuffer("039",sTlvBuffer,"909",3);
  }
  iVar1 = 0;
  iVar2 = GetTlvBuffer("072",sTlvBuffer,tmpField,&nLength);
  if (iVar2 == 0) {
    gettimeofday((timeval *)&time_s_aut,(__timezone_ptr_t)0x0);
    sprintf(szWork,"%010ld%06d",time_s_aut.tv_sec,time_s_aut.tv_usec);
    tmpField[0x20] = szWork[0];
    tmpField[0x21] = szWork[1];
    tmpField[0x22] = szWork[2];
    tmpField[0x23] = szWork[3];
    tmpField[0x24] = szWork[4];
    tmpField[0x25] = szWork[5];
    tmpField[0x26] = szWork[6];
    tmpField[0x27] = szWork[7];
    tmpField[0x28] = szWork[8];
    tmpField[0x29] = szWork[9];
    tmpField[0x2a] = szWork[10];
    tmpField[0x2b] = szWork[0xb];
    tmpField[0x2c] = szWork[0xc];
    tmpField[0x2d] = szWork[0xd];
    tmpField[0x2e] = szWork[0xe];
    tmpField[0x2f] = szWork[0xf];
    PutTlvBuffer("072",sTlvBuffer,tmpField,nLength);
    memcpy(sTimeField,tmpField,(long)nLength);
    sTimeField[nLength] = '\0';
    iVar2 = UpdateAuthoActivity(nIndiceCtx,sTlvBuffer);
    iVar1 = nLength;
  }
  else {
    iVar2 = UpdateAuthoActivity(nIndiceCtx,sTlvBuffer);
  }
  if (iVar2 != 0) {
    trace_event("Can Not Write In Authorisation table !!!",0);
    PutTlvBuffer("288",sTlvBuffer,"SAF",3);
    iVar2 = InsertionAuthoActivity(nIndiceCtx,sTlvBuffer);
    if (iVar2 != 0) {
      trace_event("Can Not Write In Authorisation SAF table !!!",0);
    }
    PutTlvBuffer("203",sTlvBuffer,"902",3);
    PutTlvBuffer("039",sTlvBuffer,"909",3);
    iVar2 = GetActionCode(nIndiceCtx,sTlvBuffer,sActionCode);
    if (iVar2 == 0) {
      PutTlvBuffer("039",sTlvBuffer,sActionCode,3);
    }
    else {
      PutTlvBuffer("039",sTlvBuffer,"909",3);
    }
  }
  iVar2 = memcmp(sActionCode,"000",3);
  if (iVar2 == 0) {
    iVar2 = UpdateCardActivity(nIndiceCtx,'2',sTlvBuffer);
  }
  else {
    iVar2 = UpdateCardActivity(nIndiceCtx,'1',sTlvBuffer);
  }
  if (iVar2 != 0) {
    trace_event("Can Not Update Card Activity  !!!",0);
  }
  iVar3 = memcmp(sActionCode,"000",3);
  if (iVar3 != 0) {
    iVar2 = UpdateBalance(nIndiceCtx,'2',sTlvBuffer);
    if (iVar2 != 0) {
      trace_event("Can Not Update Balance  !!!",0);
    }
    iVar3 = memcmp(sActionCode,"000",3);
    if (iVar3 != 0) goto LAB_00446f77;
  }
  UpdateSettlement(nIndiceCtx,sTlvBuffer);
LAB_00446f77:
  InitTlvAutho(&sTlvInfo);
  AnalyseTlvAutho(sTlvBuffer,&sTlvInfo);
  TlvToIso(nIndiceCtx,&sTlvInfo,sIsoMsg,'\x01');
  if (0 < iVar1) {
    PutIsoField(0x47,sIsoMsg,sTimeField,iVar1);
  }
  trace_event("Autho Local Update () ",5);
  return iVar2;
}



// WARNING: Unknown calling convention

int AuthorRouting(int nIndiceCtx,char *sTlvBuffer,char *sResource,pid_t nPrisPid,TSIsoInfo *sIsoInfo
                 )

{
  int iVar1;
  long lVar2;
  char *pcVar3;
  byte bVar4;
  char sActionCode [4];
  int nLength;
  char sPid [9];
  timeval time_s_aut;
  char szWork [256];
  char tmpField [256];
  char sLine [513];
  char sSecurData [4096];
  TSTlvAutho sTlvInfo;
  
  bVar4 = 0;
  trace_event("Start Authr Routing",5);
  sActionCode[0] = '\0';
  sActionCode[1] = '\0';
  sActionCode[2] = '\0';
  sActionCode[3] = '\0';
  sPid[0] = '\0';
  sPid[1] = '\0';
  sPid[2] = '\0';
  sPid[3] = '\0';
  sPid[4] = '\0';
  sPid[5] = '\0';
  sPid[6] = '\0';
  sPid[7] = '\0';
  pcVar3 = sLine;
  for (lVar2 = 0x40; lVar2 != 0; lVar2 = lVar2 + -1) {
    pcVar3[0] = '\0';
    pcVar3[1] = '\0';
    pcVar3[2] = '\0';
    pcVar3[3] = '\0';
    pcVar3[4] = '\0';
    pcVar3[5] = '\0';
    pcVar3[6] = '\0';
    pcVar3[7] = '\0';
    pcVar3 = pcVar3 + (ulong)bVar4 * -0x10 + 8;
  }
  sPid[8] = '\0';
  *pcVar3 = '\0';
  pcVar3 = szWork;
  for (lVar2 = 0x20; lVar2 != 0; lVar2 = lVar2 + -1) {
    pcVar3[0] = '\0';
    pcVar3[1] = '\0';
    pcVar3[2] = '\0';
    pcVar3[3] = '\0';
    pcVar3[4] = '\0';
    pcVar3[5] = '\0';
    pcVar3[6] = '\0';
    pcVar3[7] = '\0';
    pcVar3 = pcVar3 + (ulong)bVar4 * -0x10 + 8;
  }
  pcVar3 = tmpField;
  for (lVar2 = 0x20; lVar2 != 0; lVar2 = lVar2 + -1) {
    pcVar3[0] = '\0';
    pcVar3[1] = '\0';
    pcVar3[2] = '\0';
    pcVar3[3] = '\0';
    pcVar3[4] = '\0';
    pcVar3[5] = '\0';
    pcVar3[6] = '\0';
    pcVar3[7] = '\0';
    pcVar3 = pcVar3 + (ulong)bVar4 * -0x10 + 8;
  }
  pcVar3 = sSecurData;
  for (lVar2 = 0x200; lVar2 != 0; lVar2 = lVar2 + -1) {
    pcVar3[0] = '\0';
    pcVar3[1] = '\0';
    pcVar3[2] = '\0';
    pcVar3[3] = '\0';
    pcVar3[4] = '\0';
    pcVar3[5] = '\0';
    pcVar3[6] = '\0';
    pcVar3[7] = '\0';
    pcVar3 = pcVar3 + (ulong)bVar4 * -0x10 + 8;
  }
  PutTlvBuffer("200",sTlvBuffer,sResource,6);
  PutTlvBuffer("277",sTlvBuffer,"R",1);
  sprintf(sPid,"%08d",nPrisPid);
  iVar1 = GetTlvBuffer("072",sTlvBuffer,tmpField,&nLength);
  if (iVar1 == 0) {
    gettimeofday((timeval *)&time_s_aut,(__timezone_ptr_t)0x0);
    sprintf(szWork,"%010ld%06d",time_s_aut.tv_sec,time_s_aut.tv_usec);
    tmpField[0x10] = szWork[0];
    tmpField[0x11] = szWork[1];
    tmpField[0x12] = szWork[2];
    tmpField[0x13] = szWork[3];
    tmpField[0x14] = szWork[4];
    tmpField[0x15] = szWork[5];
    tmpField[0x16] = szWork[6];
    tmpField[0x17] = szWork[7];
    tmpField[0x18] = szWork[8];
    tmpField[0x19] = szWork[9];
    tmpField[0x1a] = szWork[10];
    tmpField[0x1b] = szWork[0xb];
    tmpField[0x1c] = szWork[0xc];
    tmpField[0x1d] = szWork[0xd];
    tmpField[0x1e] = szWork[0xe];
    tmpField[0x1f] = szWork[0xf];
    PutTlvBuffer("072",sTlvBuffer,tmpField,nLength);
  }
  iVar1 = InsertionAuthoActivity(nIndiceCtx,sTlvBuffer);
  if (iVar1 == 0) {
    fprintf(stderr," sSecurData =%s\n",sSecurData);
    fprintf(stderr," sPid =%s\n",sPid);
    fprintf(stderr," sResource =%s\n",sResource);
    GetTlvBuffer("053",sTlvBuffer,sSecurData,&nLength);
    PutSecurityData(6,sSecurData,sPid,8);
    PutSecurityData(7,sSecurData,sResource,6);
    PutTlvBuffer("053",sTlvBuffer,sSecurData,nLength);
    InitTlvAutho(&sTlvInfo);
    iVar1 = 5;
    AnalyseTlvAutho(sTlvBuffer,&sTlvInfo);
    TlvToIso(nIndiceCtx,&sTlvInfo,sIsoInfo,'\0');
  }
  else {
    trace_event("Can Not Write In Authorisation table !!!",0);
    PutTlvBuffer("288",sTlvBuffer,"SAF",3);
    iVar1 = InsertionAuthoActivity(nIndiceCtx,sTlvBuffer);
    if (iVar1 != 0) {
      trace_event("Can Not Write In Authorisation SAF table !!!",0);
    }
    PutTlvBuffer("203",sTlvBuffer,"902",3);
    iVar1 = GetActionCode(nIndiceCtx,sTlvBuffer,sActionCode);
    if (iVar1 == 0) {
      iVar1 = -9;
      PutTlvBuffer("039",sTlvBuffer,sActionCode,3);
    }
    else {
      iVar1 = -9;
      PutTlvBuffer("039",sTlvBuffer,"909",3);
    }
  }
  trace_event("Autho Routing End () ",5);
  return iVar1;
}



// WARNING: Unknown calling convention

int AuthorLog(int nIndiceCtx,TSIsoInfo *sIsoMsg,char *sCaptureCode,char *sRoutingCode,
             char *sAuthoTable)

{
  int iVar1;
  long lVar2;
  char *pcVar3;
  byte bVar4;
  char sTlvBuffer [4097];
  TSTlvAutho sTlvInfo;
  
  bVar4 = 0;
  trace_event("Start AuthorLogInsertion()",5);
  pcVar3 = sTlvBuffer;
  for (lVar2 = 0x200; lVar2 != 0; lVar2 = lVar2 + -1) {
    pcVar3[0] = '\0';
    pcVar3[1] = '\0';
    pcVar3[2] = '\0';
    pcVar3[3] = '\0';
    pcVar3[4] = '\0';
    pcVar3[5] = '\0';
    pcVar3[6] = '\0';
    pcVar3[7] = '\0';
    pcVar3 = pcVar3 + (ulong)bVar4 * -0x10 + 8;
  }
  *pcVar3 = '\0';
  InitTlvAutho(&sTlvInfo);
  IsoToTlv(nIndiceCtx,sIsoMsg,&sTlvInfo);
  PutTlvAutho("200",&sTlvInfo,sRoutingCode,6);
  PutTlvAutho("201",&sTlvInfo,sCaptureCode,6);
  PutTlvAutho("288",&sTlvInfo,sAuthoTable,3);
  PutTlvAutho("277",&sTlvInfo,"P",1);
  PutTlvAutho("255",&sTlvInfo,"E2",2);
  AuthoBuildTlv(sTlvBuffer,&sTlvInfo);
  iVar1 = InsertionAuthoActivity(nIndiceCtx,sTlvBuffer);
  if (iVar1 != 0) {
    PutTlvBuffer("288",sTlvBuffer,"SAF",3);
    iVar1 = InsertionAuthoActivity(nIndiceCtx,sTlvBuffer);
    if (iVar1 != 0) {
      trace_event("SEVERE ERROR !!!!!",5);
      trace_event("Can Not Insert Autho Activity File ",5);
      return -9;
    }
  }
  trace_event("End AuthorLogInsertion()",5);
  return 0;
}



// WARNING: Unknown calling convention

int CheckReqTlvFields(int nIndiceCtx,char *sTlvBuffer)

{
  int iVar1;
  long lVar2;
  char *pcVar3;
  byte bVar4;
  char sCvv1 [4];
  char sServiceCode [4];
  int nLength;
  char sMcc [5];
  char sExpiryDate [5];
  char sTrackIIExpDate [5];
  char sPvv [5];
  char sIsoPosData [13];
  char sPosCond [13];
  char sPan [25];
  char sCardPan [25];
  char sPCode [30];
  char sProcCode [56];
  char sTrackII [256];
  char sNwPosData [257];
  char sPinData [257];
  char sWork [257];
  char sUser [257];
  char sLine [512];
  TSTlvPrivate sTlvPrivateInfo;
  
  bVar4 = 0;
  trace_event("Start CheckReqTlvFields()",5);
  sPCode[0x1c] = '\0';
  sPCode[0x1d] = '\0';
  pcVar3 = sTrackII;
  for (lVar2 = 0x20; lVar2 != 0; lVar2 = lVar2 + -1) {
    pcVar3[0] = '\0';
    pcVar3[1] = '\0';
    pcVar3[2] = '\0';
    pcVar3[3] = '\0';
    pcVar3[4] = '\0';
    pcVar3[5] = '\0';
    pcVar3[6] = '\0';
    pcVar3[7] = '\0';
    pcVar3 = pcVar3 + (ulong)bVar4 * -0x10 + 8;
  }
  sPCode[0] = '\0';
  sPCode[1] = '\0';
  sPCode[2] = '\0';
  sPCode[3] = '\0';
  sPCode[4] = '\0';
  sPCode[5] = '\0';
  sPCode[6] = '\0';
  sPCode[7] = '\0';
  sPCode[8] = '\0';
  sPCode[9] = '\0';
  sPCode[10] = '\0';
  sPCode[0xb] = '\0';
  sPCode[0xc] = '\0';
  sPCode[0xd] = '\0';
  sPCode[0xe] = '\0';
  sPCode[0xf] = '\0';
  sPCode[0x10] = '\0';
  sPCode[0x11] = '\0';
  sPCode[0x12] = '\0';
  sPCode[0x13] = '\0';
  sPCode[0x14] = '\0';
  sPCode[0x15] = '\0';
  sPCode[0x16] = '\0';
  sPCode[0x17] = '\0';
  sPCode[0x18] = '\0';
  sPCode[0x19] = '\0';
  sPCode[0x1a] = '\0';
  sPCode[0x1b] = '\0';
  sMcc[0] = '\0';
  sMcc[1] = '\0';
  sMcc[2] = '\0';
  sMcc[3] = '\0';
  sMcc[4] = '\0';
  sIsoPosData[0] = '\0';
  sIsoPosData[1] = '\0';
  sIsoPosData[2] = '\0';
  sIsoPosData[3] = '\0';
  sIsoPosData[4] = '\0';
  sIsoPosData[5] = '\0';
  sIsoPosData[6] = '\0';
  sIsoPosData[7] = '\0';
  pcVar3 = sNwPosData;
  for (lVar2 = 0x20; lVar2 != 0; lVar2 = lVar2 + -1) {
    pcVar3[0] = '\0';
    pcVar3[1] = '\0';
    pcVar3[2] = '\0';
    pcVar3[3] = '\0';
    pcVar3[4] = '\0';
    pcVar3[5] = '\0';
    pcVar3[6] = '\0';
    pcVar3[7] = '\0';
    pcVar3 = pcVar3 + (ulong)bVar4 * -0x10 + 8;
  }
  sIsoPosData[8] = '\0';
  sIsoPosData[9] = '\0';
  sIsoPosData[10] = '\0';
  sIsoPosData[0xb] = '\0';
  sIsoPosData[0xc] = '\0';
  sExpiryDate[0] = '\0';
  sExpiryDate[1] = '\0';
  sExpiryDate[2] = '\0';
  sExpiryDate[3] = '\0';
  sExpiryDate[4] = '\0';
  sTrackIIExpDate[0] = '\0';
  sTrackIIExpDate[1] = '\0';
  sTrackIIExpDate[2] = '\0';
  sTrackIIExpDate[3] = '\0';
  sTrackIIExpDate[4] = '\0';
  sPan[0] = '\0';
  sPan[1] = '\0';
  sPan[2] = '\0';
  sPan[3] = '\0';
  sPan[4] = '\0';
  sPan[5] = '\0';
  sPan[6] = '\0';
  sPan[7] = '\0';
  sPan[8] = '\0';
  sPan[9] = '\0';
  sPan[10] = '\0';
  sPan[0xb] = '\0';
  sPan[0xc] = '\0';
  sPan[0xd] = '\0';
  sPan[0xe] = '\0';
  sPan[0xf] = '\0';
  sPan[0x10] = '\0';
  sPan[0x11] = '\0';
  sPan[0x12] = '\0';
  sPan[0x13] = '\0';
  sPan[0x14] = '\0';
  sPan[0x15] = '\0';
  sPan[0x16] = '\0';
  sPan[0x17] = '\0';
  sPan[0x18] = '\0';
  sCardPan[0] = '\0';
  sCardPan[1] = '\0';
  sCardPan[2] = '\0';
  sCardPan[3] = '\0';
  sCardPan[4] = '\0';
  sCardPan[5] = '\0';
  sCardPan[6] = '\0';
  sCardPan[7] = '\0';
  sCardPan[8] = '\0';
  sCardPan[9] = '\0';
  sCardPan[10] = '\0';
  sCardPan[0xb] = '\0';
  sCardPan[0xc] = '\0';
  sCardPan[0xd] = '\0';
  sCardPan[0xe] = '\0';
  sCardPan[0xf] = '\0';
  sCardPan[0x10] = '\0';
  sCardPan[0x11] = '\0';
  sCardPan[0x12] = '\0';
  sCardPan[0x13] = '\0';
  sCardPan[0x14] = '\0';
  sCardPan[0x15] = '\0';
  sCardPan[0x16] = '\0';
  sCardPan[0x17] = '\0';
  sCardPan[0x18] = '\0';
  sCvv1[0] = '\0';
  sCvv1[1] = '\0';
  sCvv1[2] = '\0';
  sCvv1[3] = '\0';
  sPvv[0] = '\0';
  sPvv[1] = '\0';
  sPvv[2] = '\0';
  sPvv[3] = '\0';
  sPvv[4] = '\0';
  sServiceCode[0] = '\0';
  sServiceCode[1] = '\0';
  sServiceCode[2] = '\0';
  sServiceCode[3] = '\0';
  *pcVar3 = '\0';
  sPosCond[0] = '\0';
  sPosCond[1] = '\0';
  sPosCond[2] = '\0';
  sPosCond[3] = '\0';
  sPosCond[4] = '\0';
  sPosCond[5] = '\0';
  sPosCond[6] = '\0';
  sPosCond[7] = '\0';
  sPosCond[8] = '\0';
  sPosCond[9] = '\0';
  sPosCond[10] = '\0';
  sPosCond[0xb] = '\0';
  sPosCond[0xc] = '\0';
  pcVar3 = sUser;
  for (lVar2 = 0x20; lVar2 != 0; lVar2 = lVar2 + -1) {
    pcVar3[0] = '\0';
    pcVar3[1] = '\0';
    pcVar3[2] = '\0';
    pcVar3[3] = '\0';
    pcVar3[4] = '\0';
    pcVar3[5] = '\0';
    pcVar3[6] = '\0';
    pcVar3[7] = '\0';
    pcVar3 = pcVar3 + (ulong)bVar4 * -0x10 + 8;
  }
  *pcVar3 = '\0';
  pcVar3 = sProcCode;
  for (lVar2 = 7; lVar2 != 0; lVar2 = lVar2 + -1) {
    pcVar3[0] = '\0';
    pcVar3[1] = '\0';
    pcVar3[2] = '\0';
    pcVar3[3] = '\0';
    pcVar3[4] = '\0';
    pcVar3[5] = '\0';
    pcVar3[6] = '\0';
    pcVar3[7] = '\0';
    pcVar3 = pcVar3 + (ulong)bVar4 * -0x10 + 8;
  }
  iVar1 = GetTlvBuffer("002",sTlvBuffer,sCardPan,&nLength);
  if ((iVar1 == 0) && (iVar1 = GetTlvBuffer("035",sTlvBuffer,sTrackII,&nLength), iVar1 == 0)) {
    GetTrack2Data(sTrackII,sPan,sTrackIIExpDate,sServiceCode,sPvv,sCvv1);
    iVar1 = memcmp(sCardPan,sPan,0x10);
    if (iVar1 == 0) goto LAB_00447917;
    PutEvent(sTlvBuffer,"030","Card Number In TrackII Diff Than Field 2");
    PutTlvBuffer("039",sTlvBuffer,"902",3);
    pcVar3 = "Check PAN  == TRACK II PAN  (NOK)";
LAB_00447f63:
    trace_event(pcVar3,4);
    trace_event("End   CheckReqTlvFields(NOK)",5);
    iVar1 = -1;
  }
  else {
LAB_00447917:
    iVar1 = GetTlvBuffer("014",sTlvBuffer,sExpiryDate,&nLength);
    if ((iVar1 == 0) && (iVar1 = GetTlvBuffer("035",sTlvBuffer,sTrackII,&nLength), iVar1 == 0)) {
      GetTrack2Data(sTrackII,sPan,sTrackIIExpDate,sServiceCode,sPvv,sCvv1);
      iVar1 = memcmp(sExpiryDate,sTrackIIExpDate,4);
      if (iVar1 != 0) {
        PutEvent(sTlvBuffer,"030","Expiry Date In TrackII Diff Than Field 14");
        PutTlvBuffer("039",sTlvBuffer,"902",3);
        pcVar3 = "Check EXP DATE == TRACK II EXP DATE  (NOK)";
        goto LAB_00447f63;
      }
    }
    pcVar3 = sNwPosData;
    for (lVar2 = 0x20; lVar2 != 0; lVar2 = lVar2 + -1) {
      pcVar3[0] = '\0';
      pcVar3[1] = '\0';
      pcVar3[2] = '\0';
      pcVar3[3] = '\0';
      pcVar3[4] = '\0';
      pcVar3[5] = '\0';
      pcVar3[6] = '\0';
      pcVar3[7] = '\0';
      pcVar3 = pcVar3 + (ulong)bVar4 * -0x10 + 8;
    }
    sPosCond[0] = '\0';
    sPosCond[1] = '\0';
    sPosCond[2] = '\0';
    sPosCond[3] = '\0';
    sPosCond[4] = '\0';
    sPosCond[5] = '\0';
    sPosCond[6] = '\0';
    sPosCond[7] = '\0';
    sPosCond[8] = '\0';
    sPosCond[9] = '\0';
    sPosCond[10] = '\0';
    sPosCond[0xb] = '\0';
    sPosCond[0xc] = '\0';
    *pcVar3 = '\0';
    iVar1 = GetTlvBuffer("061",sTlvBuffer,sNwPosData,&nLength);
    if (iVar1 == 0) {
      InitTlvPrivate(&sTlvPrivateInfo);
      AnalyseTlvPrivate(sNwPosData,nLength,&sTlvPrivateInfo);
      iVar1 = GetTlvPrivate("025",&sTlvPrivateInfo,sPosCond,&nLength);
      if ((iVar1 == 0) && (iVar1 = memcmp(sPosCond,&DAT_004d1dfe,2), iVar1 == 0)) {
        PutEvent(sTlvBuffer,"320","Merchant Suspicious");
        PutTlvBuffer("039",sTlvBuffer,"100",3);
        pcVar3 = "Check  NETWORK POS DATA (NOK)";
        goto LAB_00447f63;
      }
    }
    trace_event("-->AUTO_NETWORK_POS_DATA OK<--",5);
    iVar1 = GetTlvBuffer("022",sTlvBuffer,sIsoPosData,&nLength);
    if ((((iVar1 == 0) && (sIsoPosData[4] == '0')) && (sIsoPosData[5] == '0')) &&
       (sIsoPosData[6] != '1')) {
      GetTlvBuffer("130",sTlvBuffer,sUser,&nLength);
      iVar1 = memcmp(sUser,&DAT_004c75f4,3);
      if (iVar1 != 0) {
        PutEvent(sTlvBuffer,"320","Pos Data Invalid:Cardholder present and Card Not present");
        PutTlvBuffer("039",sTlvBuffer,"108",3);
        pcVar3 = "Check  POS DATA (NOK)";
        goto LAB_00447f63;
      }
    }
    trace_event("-->AUTO_POS_DATA OK<--",5);
    GetTlvBuffer("003",sTlvBuffer,sProcCode,&nLength);
    iVar1 = GetTlvBuffer("022",sTlvBuffer,sIsoPosData,&nLength);
    if (iVar1 == 0) {
      iVar1 = GetTlvBuffer("018",sTlvBuffer,sMcc,&nLength);
      if (((iVar1 == 0) && (iVar1 = memcmp(sMcc,&DAT_004a4ee6,4), iVar1 == 0)) &&
         ((sIsoPosData[7] != '1' && (iVar1 = memcmp(sProcCode + 6,&DAT_004a554a,2), iVar1 != 0)))) {
        PutEvent(sTlvBuffer,"320","Pos Data Invalid:MCC 6011 and PIN Metchod Diff than PIN ");
        PutTlvBuffer("039",sTlvBuffer,"109",3);
        pcVar3 = "Check MCC == POS DATA (NOK)";
        goto LAB_00447f63;
      }
    }
    trace_event("-->AUTO_POS_DATA OK<--",5);
    pcVar3 = sWork;
    for (lVar2 = 0x20; lVar2 != 0; lVar2 = lVar2 + -1) {
      pcVar3[0] = '\0';
      pcVar3[1] = '\0';
      pcVar3[2] = '\0';
      pcVar3[3] = '\0';
      pcVar3[4] = '\0';
      pcVar3[5] = '\0';
      pcVar3[6] = '\0';
      pcVar3[7] = '\0';
      pcVar3 = pcVar3 + (ulong)bVar4 * -0x10 + 8;
    }
    *pcVar3 = '\0';
    pcVar3 = sPinData;
    for (lVar2 = 0x20; lVar2 != 0; lVar2 = lVar2 + -1) {
      pcVar3[0] = '\0';
      pcVar3[1] = '\0';
      pcVar3[2] = '\0';
      pcVar3[3] = '\0';
      pcVar3[4] = '\0';
      pcVar3[5] = '\0';
      pcVar3[6] = '\0';
      pcVar3[7] = '\0';
      pcVar3 = pcVar3 + (ulong)bVar4 * -0x10 + 8;
    }
    *pcVar3 = '\0';
    iVar1 = GetTlvBuffer("003",sTlvBuffer,sPCode,&nLength);
    if (iVar1 != 0) {
      return 0;
    }
    iVar1 = memcmp(sPCode + 6,&DAT_004a6713,2);
    if (iVar1 == 0) {
      return 0;
    }
    iVar1 = memcmp(sPCode + 6,&DAT_004a554a,2);
    if (iVar1 == 0) {
      return 0;
    }
    iVar1 = memcmp(sMcc,&DAT_004a4ee6,4);
    if ((iVar1 == 0) && (iVar1 = GetTlvBuffer("052",sTlvBuffer,sPinData,&nLength), iVar1 != 0)) {
      PutEvent(sTlvBuffer,"109","MCC 6011 and PIN Does Not Exist");
      PutTlvBuffer("039",sTlvBuffer,"109",3);
      trace_event("PIN MISSING(NOK)",1);
      trace_event("End   CheckReqTlvFields(NOK)",1);
    }
    iVar1 = GetTlvBuffer("003",sTlvBuffer,sPCode,&nLength);
    if ((iVar1 == 0) && (iVar1 = GetTlvBuffer("018",sTlvBuffer,sMcc,&nLength), iVar1 == 0)) {
      sprintf(sLine,"Check MCC %s == PROCESSING CODE  %s",sMcc,sPCode);
      trace_event(sLine,4);
      iVar1 = memcmp(sMcc,&DAT_004a4ee6,4);
      if (iVar1 == 0) {
        pcVar3 = sPCode + 6;
        iVar1 = memcmp(pcVar3,"01",2);
        if ((((((iVar1 != 0) && (iVar1 = memcmp(pcVar3,&DAT_004c759e,2), iVar1 != 0)) &&
              (iVar1 = memcmp(pcVar3,&DAT_004c9c21,2), iVar1 != 0)) &&
             (((iVar1 = memcmp(pcVar3,&DAT_004a7da4,2), iVar1 != 0 &&
               (iVar1 = memcmp(pcVar3,&DAT_004a3182,2), iVar1 != 0)) &&
              ((iVar1 = memcmp(pcVar3,"40",2), iVar1 != 0 &&
               ((iVar1 = memcmp(pcVar3,&DAT_004a8fd3,2), iVar1 != 0 &&
                (iVar1 = memcmp(pcVar3,&DAT_004d44e6,2), iVar1 != 0)))))))) &&
            (iVar1 = memcmp(pcVar3,&DAT_004a9056,2), iVar1 != 0)) &&
           ((((iVar1 = memcmp(pcVar3,&DAT_004aac5d,2), iVar1 != 0 &&
              (iVar1 = memcmp(pcVar3,&DAT_004a4d27,2), iVar1 != 0)) &&
             (iVar1 = memcmp(pcVar3,&DAT_004a4d63,2), iVar1 != 0)) &&
            ((iVar1 = memcmp(pcVar3,&DAT_004a554a,2), iVar1 != 0 &&
             (iVar1 = memcmp(pcVar3,&DAT_004a5543,2), iVar1 != 0)))))) {
          iVar1 = memcmp(pcVar3,&DAT_004a6713,2);
          pcVar3 = "Mcc 6011 and Processing Code != Withdrawal 01";
          if (iVar1 != 0) goto LAB_0044821f;
        }
        iVar1 = memcmp(sMcc,&DAT_004c7698,4);
        if (iVar1 == 0) goto LAB_0044800c;
      }
      else {
        iVar1 = memcmp(sMcc,&DAT_004c7698,4);
        if (iVar1 == 0) {
LAB_0044800c:
          iVar1 = memcmp(sPCode + 6,&DAT_004a670e,2);
          if ((iVar1 != 0) && (iVar1 = memcmp(sPCode + 6,"01",2), iVar1 != 0)) {
            PutEvent(sTlvBuffer,"320","Mcc 6010 and Processing Code != Cash Adavnce 17/01");
            PutTlvBuffer("039",sTlvBuffer,"109",3);
            pcVar3 = " 1 Check MCC == PROCESSING CODE (NOK)";
            goto LAB_00447f63;
          }
          goto LAB_00447b8c;
        }
        iVar1 = memcmp(sPCode + 6,"01",2);
        if (iVar1 == 0) {
          pcVar3 = "Mcc != 6010 and 6011 and Processing Code = 01";
LAB_0044821f:
          PutEvent(sTlvBuffer,"320",pcVar3);
          PutTlvBuffer("039",sTlvBuffer,"109",3);
          pcVar3 = "Check MCC == PROCESSING CODE (NOK)";
          goto LAB_00447f63;
        }
      }
      iVar1 = memcmp(sPCode + 6,&DAT_004a670e,2);
      if (iVar1 == 0) {
        PutEvent(sTlvBuffer,"320","Mcc != 6010 and Processing Code = 17");
        PutTlvBuffer("039",sTlvBuffer,"109",3);
        pcVar3 = " 2 Check MCC == PROCESSING CODE (NOK)";
        goto LAB_00447f63;
      }
    }
LAB_00447b8c:
    trace_event("-->AUTO_PROCESSING_CODE OK<--",5);
    trace_event("End   CheckReqTlvFields(OK)",5);
    iVar1 = 0;
  }
  return iVar1;
}



// WARNING: Unknown calling convention

int CheckAdvTlvFields(int nIndiceCtx,char *sTlvBuffer)

{
  int iVar1;
  long lVar2;
  char *pcVar3;
  byte bVar4;
  char sCvv1 [4];
  char sServiceCode [4];
  int nLength;
  char sMcc [5];
  char sExpiryDate [5];
  char sTrackIIExpDate [5];
  char sPvv [5];
  char sIsoPosData [13];
  char sPan [25];
  char sCardPan [25];
  char sPCode [30];
  char sTrackII [256];
  char sLine [512];
  
  bVar4 = 0;
  trace_event("Start CheckAdvTlvFields()",5);
  sPCode[0x1c] = '\0';
  sPCode[0x1d] = '\0';
  pcVar3 = sTrackII;
  for (lVar2 = 0x20; lVar2 != 0; lVar2 = lVar2 + -1) {
    pcVar3[0] = '\0';
    pcVar3[1] = '\0';
    pcVar3[2] = '\0';
    pcVar3[3] = '\0';
    pcVar3[4] = '\0';
    pcVar3[5] = '\0';
    pcVar3[6] = '\0';
    pcVar3[7] = '\0';
    pcVar3 = pcVar3 + (ulong)bVar4 * -0x10 + 8;
  }
  sPCode[0] = '\0';
  sPCode[1] = '\0';
  sPCode[2] = '\0';
  sPCode[3] = '\0';
  sPCode[4] = '\0';
  sPCode[5] = '\0';
  sPCode[6] = '\0';
  sPCode[7] = '\0';
  sPCode[8] = '\0';
  sPCode[9] = '\0';
  sPCode[10] = '\0';
  sPCode[0xb] = '\0';
  sPCode[0xc] = '\0';
  sPCode[0xd] = '\0';
  sPCode[0xe] = '\0';
  sPCode[0xf] = '\0';
  sPCode[0x10] = '\0';
  sPCode[0x11] = '\0';
  sPCode[0x12] = '\0';
  sPCode[0x13] = '\0';
  sPCode[0x14] = '\0';
  sPCode[0x15] = '\0';
  sPCode[0x16] = '\0';
  sPCode[0x17] = '\0';
  sPCode[0x18] = '\0';
  sPCode[0x19] = '\0';
  sPCode[0x1a] = '\0';
  sPCode[0x1b] = '\0';
  sMcc[0] = '\0';
  sMcc[1] = '\0';
  sMcc[2] = '\0';
  sMcc[3] = '\0';
  sMcc[4] = '\0';
  sExpiryDate[0] = '\0';
  sExpiryDate[1] = '\0';
  sExpiryDate[2] = '\0';
  sExpiryDate[3] = '\0';
  sExpiryDate[4] = '\0';
  sTrackIIExpDate[0] = '\0';
  sTrackIIExpDate[1] = '\0';
  sTrackIIExpDate[2] = '\0';
  sTrackIIExpDate[3] = '\0';
  sTrackIIExpDate[4] = '\0';
  sPan[0] = '\0';
  sPan[1] = '\0';
  sPan[2] = '\0';
  sPan[3] = '\0';
  sPan[4] = '\0';
  sPan[5] = '\0';
  sPan[6] = '\0';
  sPan[7] = '\0';
  sPan[8] = '\0';
  sPan[9] = '\0';
  sPan[10] = '\0';
  sPan[0xb] = '\0';
  sPan[0xc] = '\0';
  sPan[0xd] = '\0';
  sPan[0xe] = '\0';
  sPan[0xf] = '\0';
  sPan[0x10] = '\0';
  sPan[0x11] = '\0';
  sPan[0x12] = '\0';
  sPan[0x13] = '\0';
  sPan[0x14] = '\0';
  sPan[0x15] = '\0';
  sPan[0x16] = '\0';
  sPan[0x17] = '\0';
  sPan[0x18] = '\0';
  sCvv1[0] = '\0';
  sCvv1[1] = '\0';
  sCvv1[2] = '\0';
  sCvv1[3] = '\0';
  sPvv[0] = '\0';
  sPvv[1] = '\0';
  sPvv[2] = '\0';
  sPvv[3] = '\0';
  sPvv[4] = '\0';
  sServiceCode[0] = '\0';
  sServiceCode[1] = '\0';
  sServiceCode[2] = '\0';
  sServiceCode[3] = '\0';
  sCardPan[0] = '\0';
  sCardPan[1] = '\0';
  sCardPan[2] = '\0';
  sCardPan[3] = '\0';
  sCardPan[4] = '\0';
  sCardPan[5] = '\0';
  sCardPan[6] = '\0';
  sCardPan[7] = '\0';
  sCardPan[8] = '\0';
  sCardPan[9] = '\0';
  sCardPan[10] = '\0';
  sCardPan[0xb] = '\0';
  sCardPan[0xc] = '\0';
  sCardPan[0xd] = '\0';
  sCardPan[0xe] = '\0';
  sCardPan[0xf] = '\0';
  sCardPan[0x10] = '\0';
  sCardPan[0x11] = '\0';
  sCardPan[0x12] = '\0';
  sCardPan[0x13] = '\0';
  sCardPan[0x14] = '\0';
  sCardPan[0x15] = '\0';
  sCardPan[0x16] = '\0';
  sCardPan[0x17] = '\0';
  sCardPan[0x18] = '\0';
  iVar1 = GetTlvBuffer("002",sTlvBuffer,sCardPan,&nLength);
  if ((iVar1 == 0) && (iVar1 = GetTlvBuffer("035",sTlvBuffer,sTrackII,&nLength), iVar1 == 0)) {
    GetTrack2Data(sTrackII,sPan,sTrackIIExpDate,sServiceCode,sPvv,sCvv1);
    if (debug_option == 1) {
      sprintf(sLine,"Check Crad Num   %s == TrackII Crad Num   %s",sCardPan,sPan);
      trace_event(sLine,4);
    }
    iVar1 = memcmp(sCardPan,sPan,0x10);
    if (iVar1 == 0) goto LAB_0044840f;
    PutTlvBuffer("039",sTlvBuffer,"902",3);
    pcVar3 = "Check PAN  == TRACK II PAN  (NOK)";
LAB_0044872d:
    trace_event(pcVar3,4);
    trace_event("End   CheckReqTlvFields(NOK)",5);
    iVar1 = -1;
  }
  else {
LAB_0044840f:
    iVar1 = GetTlvBuffer("014",sTlvBuffer,sExpiryDate,&nLength);
    if ((iVar1 == 0) && (iVar1 = GetTlvBuffer("035",sTlvBuffer,sTrackII,&nLength), iVar1 == 0)) {
      GetTrack2Data(sTrackII,sPan,sTrackIIExpDate,sServiceCode,sPvv,sCvv1);
      sprintf(sLine,"Check ExpiryDate %s == TrackII ExpiryDate %s",sExpiryDate,sTrackIIExpDate);
      trace_event(sLine,4);
      iVar1 = memcmp(sExpiryDate,sTrackIIExpDate,4);
      if (iVar1 != 0) {
        PutTlvBuffer("039",sTlvBuffer,"902",3);
        pcVar3 = "Check EXP DATE == TRACK II EXP DATE  (NOK)";
        goto LAB_00448669;
      }
    }
    iVar1 = GetTlvBuffer("003",sTlvBuffer,sPCode,&nLength);
    if (iVar1 == 0) {
      iVar1 = GetTlvBuffer("018",sTlvBuffer,sMcc,&nLength);
      if (iVar1 == 0) {
        sprintf(sLine,"Check MCC %s == PROCESSING CODE  %s",sMcc,sPCode);
        trace_event(sLine,4);
        iVar1 = memcmp(sMcc,&DAT_004a4ee6,4);
        if (iVar1 == 0) {
          iVar1 = memcmp(sPCode + 6,"01",2);
          if (iVar1 != 0) {
            PutTlvBuffer("039",sTlvBuffer,"109",3);
            pcVar3 = "Check MCC == PROCESSING CODE (NOK)";
LAB_00448669:
            trace_event(pcVar3,4);
            trace_event("End   CheckAdvTlvFields(NOK)",5);
            return -1;
          }
          iVar1 = memcmp(sMcc,&DAT_004c7698,4);
          if (iVar1 == 0) goto LAB_004486ca;
        }
        else {
          iVar1 = memcmp(sMcc,&DAT_004c7698,4);
          if (iVar1 == 0) {
LAB_004486ca:
            iVar1 = memcmp(sPCode + 6,&DAT_004a670e,2);
            if ((iVar1 != 0) && (iVar1 = memcmp(sPCode + 6,"01",2), iVar1 != 0)) {
              PutTlvBuffer("039",sTlvBuffer,"109",3);
              pcVar3 = " 3 Check MCC == PROCESSING CODE (NOK)";
              goto LAB_0044872d;
            }
            goto LAB_0044846f;
          }
          iVar1 = memcmp(sPCode + 6,"01",2);
          if (iVar1 == 0) {
            PutTlvBuffer("039",sTlvBuffer,"109",3);
            pcVar3 = "Check MCC == PROCESSING CODE (NOK)";
            goto LAB_0044872d;
          }
        }
        iVar1 = memcmp(sPCode + 6,&DAT_004a670e,2);
        if (iVar1 == 0) {
          PutTlvBuffer("039",sTlvBuffer,"109",3);
          pcVar3 = " 4 Check MCC == PROCESSING CODE (NOK)";
          goto LAB_0044872d;
        }
      }
    }
LAB_0044846f:
    trace_event("End   CheckAdvTlvFields(OK)",5);
    iVar1 = 0;
  }
  return iVar1;
}



// WARNING: Unknown calling convention

int RefundProcessing(int nIndiceCtx,char *sTlvBuffer,TSIsoInfo *sIsoMsg)

{
  int iVar1;
  char sActionCode [4];
  char sCurrency [4];
  char sEventCode [4];
  char sAmount [19];
  TSTlvAutho sTlvInfo;
  
  trace_event("Start RefundProcessing () ",5);
  sActionCode[0] = '\0';
  sActionCode[1] = '\0';
  sActionCode[2] = '\0';
  sActionCode[3] = '\0';
  PutTlvBuffer("200",sTlvBuffer,"000001",6);
  PutTlvBuffer("277",sTlvBuffer,"P",1);
  PutTlvBuffer("255",sTlvBuffer,"E2",2);
  PutTlvBuffer("039",sTlvBuffer,"000",3);
  GetAuthNumber(nIndiceCtx,sTlvBuffer);
  iVar1 = InsertionAuthoActivity(nIndiceCtx,sTlvBuffer);
  if (iVar1 != 0) {
    trace_event("Can Not Write In Authorisation table !!!",0);
    PutTlvBuffer("288",sTlvBuffer,"SAF",3);
    iVar1 = InsertionAuthoActivity(nIndiceCtx,sTlvBuffer);
    if (iVar1 != 0) {
      trace_event("Can Not Write In Authorisation SAF table !!!",0);
    }
    PutTlvBuffer("203",sTlvBuffer,"902",3);
    PutTlvBuffer("039",sTlvBuffer,"909",3);
    iVar1 = GetActionCode(nIndiceCtx,sTlvBuffer,sActionCode);
    if (iVar1 == 0) {
      iVar1 = -9;
      PutTlvBuffer("039",sTlvBuffer,sActionCode,3);
    }
    else {
      iVar1 = -9;
      PutTlvBuffer("039",sTlvBuffer,"909",3);
    }
  }
  InitTlvAutho(&sTlvInfo);
  AnalyseTlvAutho(sTlvBuffer,&sTlvInfo);
  TlvToIso(nIndiceCtx,&sTlvInfo,sIsoMsg,'\x01');
  trace_event("End   RefundProcessing (OK) ",5);
  return iVar1;
}



// WARNING: Unknown calling convention

int AuthorLocalAdm(int nIndiceCtx,char *sTlvBuffer,TSIsoInfo *sIsoMsg,char *sMyResource,
                  char *sPrimResource,char SafIndicator)

{
  int iVar1;
  int iVar2;
  long lVar3;
  char *pcVar4;
  byte bVar5;
  char sActionCode [4];
  char sCurrency [4];
  char sEventCode [4];
  int nLength;
  char sAmount [19];
  char sPCode [4096];
  TSTlvAutho sTlvInfo;
  
  bVar5 = 0;
  trace_event("Start AuthorLocalAdm()",5);
  pcVar4 = sPCode;
  for (lVar3 = 0x200; lVar3 != 0; lVar3 = lVar3 + -1) {
    pcVar4[0] = '\0';
    pcVar4[1] = '\0';
    pcVar4[2] = '\0';
    pcVar4[3] = '\0';
    pcVar4[4] = '\0';
    pcVar4[5] = '\0';
    pcVar4[6] = '\0';
    pcVar4[7] = '\0';
    pcVar4 = pcVar4 + (ulong)bVar5 * -0x10 + 8;
  }
  sActionCode[0] = '\0';
  sActionCode[1] = '\0';
  sActionCode[2] = '\0';
  sActionCode[3] = '\0';
  sAmount[0] = '\0';
  sAmount[1] = '\0';
  sAmount[2] = '\0';
  sAmount[3] = '\0';
  sAmount[4] = '\0';
  sAmount[5] = '\0';
  sAmount[6] = '\0';
  sAmount[7] = '\0';
  sAmount[8] = '\0';
  sAmount[9] = '\0';
  sAmount[10] = '\0';
  sAmount[0xb] = '\0';
  sAmount[0xc] = '\0';
  sAmount[0xd] = '\0';
  sAmount[0xe] = '\0';
  sAmount[0xf] = '\0';
  sAmount[0x10] = '\0';
  sAmount[0x11] = '\0';
  sAmount[0x12] = '\0';
  PutTlvBuffer("200",sTlvBuffer,"000001",6);
  PutTlvBuffer("277",sTlvBuffer,"P",1);
  PutTlvBuffer("255",sTlvBuffer,"E2",2);
  iVar1 = GetActionCode(nIndiceCtx,sTlvBuffer,sActionCode);
  if (iVar1 == 0) {
    PutTlvBuffer("039",sTlvBuffer,sActionCode,3);
  }
  else {
    PutTlvBuffer("039",sTlvBuffer,"909",3);
  }
  iVar1 = InsertionAuthoActivity(nIndiceCtx,sTlvBuffer);
  if (iVar1 != 0) {
    trace_event("Can Not Write In Authorisation table !!!",0);
    PutTlvBuffer("288",sTlvBuffer,"SAF",3);
    iVar1 = InsertionAuthoActivity(nIndiceCtx,sTlvBuffer);
    if (iVar1 != 0) {
      trace_event("Can Not Write In Authorisation SAF table !!!",0);
    }
    PutTlvBuffer("203",sTlvBuffer,"902",3);
    PutTlvBuffer("039",sTlvBuffer,"909",3);
    iVar1 = GetActionCode(nIndiceCtx,sTlvBuffer,sActionCode);
    if (iVar1 == 0) {
      iVar1 = -9;
      PutTlvBuffer("039",sTlvBuffer,sActionCode,3);
    }
    else {
      iVar1 = -9;
      PutTlvBuffer("039",sTlvBuffer,"909",3);
    }
  }
  iVar2 = GetTlvBuffer("003",sTlvBuffer,sPCode,&nLength);
  if (iVar2 != 0) {
    trace_event("Get Processing Code Fieled ",5);
  }
  iVar2 = memcmp(sActionCode,"000",3);
  if ((iVar2 == 0) || (iVar2 = memcmp(sActionCode,&DAT_004d1e2a,3), iVar2 == 0)) {
    iVar2 = memcmp(sPCode + 6,&DAT_004c759e,2);
    if (iVar2 != 0) {
      iVar1 = UpdateCardActivity(nIndiceCtx,'2',sTlvBuffer);
    }
  }
  else {
    iVar1 = UpdateCardActivity(nIndiceCtx,'1',sTlvBuffer);
  }
  if (iVar1 != 0) {
    trace_event("Can Not Update Card Activity  !!!",0);
    PrintTlvBuffer(sTlvBuffer);
  }
  if (SafIndicator == 'S') {
    InsertionSaf(nIndiceCtx,sTlvBuffer,sMyResource,sPrimResource);
  }
  InitTlvAutho(&sTlvInfo);
  AnalyseTlvAutho(sTlvBuffer,&sTlvInfo);
  TlvToIso(nIndiceCtx,&sTlvInfo,sIsoMsg,'\x01');
  trace_event("End AuthorLocalAdm () ",5);
  return iVar1;
}



// WARNING: Unknown calling convention

int OctAuthorLocal(int nIndiceCtx,char *sTlvBuffer,TSIsoInfo *sIsoMsg,char *sMyResource,
                  char *sPrimResource,char SafIndicator)

{
  int iVar1;
  uint uVar2;
  long lVar3;
  char *pcVar4;
  char sActionCode [4];
  char sEventCode [4];
  int nLength;
  timeval time_s_aut;
  char szWork [256];
  char sLine [513];
  char tmpField [513];
  char sTlvVOutlet [4097];
  TSTlvAutho sTlvInfo;
  
  pcVar4 = tmpField;
  for (lVar3 = 0x40; lVar3 != 0; lVar3 = lVar3 + -1) {
    pcVar4[0] = '\0';
    pcVar4[1] = '\0';
    pcVar4[2] = '\0';
    pcVar4[3] = '\0';
    pcVar4[4] = '\0';
    pcVar4[5] = '\0';
    pcVar4[6] = '\0';
    pcVar4[7] = '\0';
    pcVar4 = pcVar4 + 8;
  }
  sActionCode[0] = '\0';
  sActionCode[1] = '\0';
  sActionCode[2] = '\0';
  sActionCode[3] = '\0';
  time_s_aut.tv_sec = 0;
  time_s_aut.tv_usec = 0;
  *pcVar4 = '\0';
  pcVar4 = sLine;
  for (lVar3 = 0x40; lVar3 != 0; lVar3 = lVar3 + -1) {
    pcVar4[0] = '\0';
    pcVar4[1] = '\0';
    pcVar4[2] = '\0';
    pcVar4[3] = '\0';
    pcVar4[4] = '\0';
    pcVar4[5] = '\0';
    pcVar4[6] = '\0';
    pcVar4[7] = '\0';
    pcVar4 = pcVar4 + 8;
  }
  *pcVar4 = '\0';
  pcVar4 = szWork;
  for (lVar3 = 0x20; lVar3 != 0; lVar3 = lVar3 + -1) {
    pcVar4[0] = '\0';
    pcVar4[1] = '\0';
    pcVar4[2] = '\0';
    pcVar4[3] = '\0';
    pcVar4[4] = '\0';
    pcVar4[5] = '\0';
    pcVar4[6] = '\0';
    pcVar4[7] = '\0';
    pcVar4 = pcVar4 + 8;
  }
  pcVar4 = sTlvVOutlet;
  for (lVar3 = 0x200; lVar3 != 0; lVar3 = lVar3 + -1) {
    pcVar4[0] = '\0';
    pcVar4[1] = '\0';
    pcVar4[2] = '\0';
    pcVar4[3] = '\0';
    pcVar4[4] = '\0';
    pcVar4[5] = '\0';
    pcVar4[6] = '\0';
    pcVar4[7] = '\0';
    pcVar4 = pcVar4 + 8;
  }
  *pcVar4 = '\0';
  iVar1 = GetTlvBuffer("200",sTlvBuffer,tmpField,&nLength);
  if (iVar1 != 0) {
    PutTlvBuffer("200",sTlvBuffer,"000001",6);
  }
  PutTlvBuffer("277",sTlvBuffer,"P",1);
  PutTlvBuffer("255",sTlvBuffer,"E2",2);
  iVar1 = GetActionCode(nIndiceCtx,sTlvBuffer,sActionCode);
  if (iVar1 == 0) {
    PutTlvBuffer("039",sTlvBuffer,sActionCode,3);
  }
  else {
    PutTlvBuffer("039",sTlvBuffer,"909",3);
  }
  iVar1 = GetTlvBuffer("072",sTlvBuffer,tmpField,&nLength);
  if (iVar1 == 0) {
    gettimeofday((timeval *)&time_s_aut,(__timezone_ptr_t)0x0);
    sprintf(szWork,"%010ld%06ld",time_s_aut.tv_sec,time_s_aut.tv_usec);
    tmpField[0x10] = szWork[0];
    tmpField[0x11] = szWork[1];
    tmpField[0x12] = szWork[2];
    tmpField[0x13] = szWork[3];
    tmpField[0x14] = szWork[4];
    tmpField[0x15] = szWork[5];
    tmpField[0x16] = szWork[6];
    tmpField[0x17] = szWork[7];
    tmpField[0x18] = szWork[8];
    tmpField[0x19] = szWork[9];
    tmpField[0x1a] = szWork[10];
    tmpField[0x1b] = szWork[0xb];
    tmpField[0x1c] = szWork[0xc];
    tmpField[0x1d] = szWork[0xd];
    tmpField[0x1e] = szWork[0xe];
    tmpField[0x1f] = szWork[0xf];
    PutTlvBuffer("072",sTlvBuffer,tmpField,nLength);
  }
  iVar1 = InsertionAuthoActivity(nIndiceCtx,sTlvBuffer);
  if (iVar1 != 0) {
    trace_event("Can Not Write In Authorisation table !!!",0);
    PutTlvBuffer("288",sTlvBuffer,"SAF",3);
    iVar1 = InsertionAuthoActivity(nIndiceCtx,sTlvBuffer);
    if (iVar1 != 0) {
      trace_event("Can Not Write In Authorisation SAF table !!!",0);
    }
    PutTlvBuffer("203",sTlvBuffer,"902",3);
    PutTlvBuffer("039",sTlvBuffer,"909",3);
    iVar1 = GetActionCode(nIndiceCtx,sTlvBuffer,sActionCode);
    if (iVar1 == 0) {
      PutTlvBuffer("039",sTlvBuffer,sActionCode,3);
    }
    else {
      PutTlvBuffer("039",sTlvBuffer,"909",3);
    }
  }
  iVar1 = memcmp(sActionCode,"000",3);
  if (iVar1 == 0) {
    uVar2 = UpdateCardActivity(nIndiceCtx,'2',sTlvBuffer);
  }
  else {
    uVar2 = UpdateCardActivity(nIndiceCtx,'1',sTlvBuffer);
  }
  if (uVar2 != 0) {
    trace_event("Can Not Update Card Activity  !!!",0);
  }
  iVar1 = memcmp(sActionCode,"000",3);
  if (iVar1 == 0) {
    iVar1 = OctAccountDeposit(nIndiceCtx,sTlvBuffer);
    if (iVar1 != 0) {
      trace_event("Error On  OctAccountDeposit!! ",5);
      return -1;
    }
    iVar1 = memcmp(sActionCode,"000",3);
    uVar2 = 0;
    if (iVar1 == 0) {
      UpdateSettlement(nIndiceCtx,sTlvBuffer);
    }
  }
  PrintTlvBuffer(sTlvBuffer);
  if (SafIndicator == 'S') {
    uVar2 = AutSafProcessing(nIndiceCtx,sTlvBuffer,sMyResource,sPrimResource);
  }
  InitTlvAutho(&sTlvInfo);
  AnalyseTlvAutho(sTlvBuffer,&sTlvInfo);
  iVar1 = TlvToIso(nIndiceCtx,&sTlvInfo,sIsoMsg,'\x01');
  if (iVar1 != 0) {
    uVar2 = 0xfffffff7;
    trace_event("TlvToIso Error ...",1);
    PutIsoField(0x26,sIsoMsg,"909",3);
  }
  sprintf(sLine,"End   OctAuthorLocal(%d)",(ulong)uVar2);
  trace_event(sLine,5);
  return uVar2;
}



// WARNING: Unknown calling convention

int AuthorRequestProcessing
              (int nIndiceCtx,char *sMyResource,char *sAuthoTable,char *sAcquirerBank,
              char *InternationalRoutCheck,char *sServGatewayFlag,char *sBillCalculFlag,
              char *sTlvBuffer,TSIsoInfo *IsoInfo)

{
  char acVar1 [4];
  undefined4 uVar2;
  int iVar3;
  uint uVar4;
  long lVar5;
  char *pcVar6;
  char *tlv_name;
  char SafIndicator;
  byte bVar7;
  int local_9c80;
  int local_9c58;
  uint local_9c44;
  char PosCond [3];
  char slFuncCode [4];
  char sEventCode [4];
  pid_t nPid;
  int nLength;
  char slProcCode [7];
  char sPrimResource [7];
  char sSecResource [7];
  char sInternalStan [7];
  char sCaptureCode [7];
  char sPid [9];
  char sSecurityResults [11];
  char sPosData [13];
  TSService rService;
  char slCardNumber [23];
  char slTransAmount [23];
  char AddPos [27];
  char sLine [512];
  char tmpField [513];
  char sSecurData [4096];
  char sAlternAmount [4097];
  char sTlvProcCode [4097];
  char sIsoProcCode [4097];
  TSTlvPrivate TlvInfo;
  TSTlvAutho sTlvInfo;
  
  bVar7 = 0;
  trace_event("Start AuthorRequestProcessing(::)",5);
  slCardNumber[0] = '\0';
  slCardNumber[1] = '\0';
  slCardNumber[2] = '\0';
  slCardNumber[3] = '\0';
  slCardNumber[4] = '\0';
  slCardNumber[5] = '\0';
  slCardNumber[6] = '\0';
  slCardNumber[7] = '\0';
  slCardNumber[8] = '\0';
  slCardNumber[9] = '\0';
  slCardNumber[10] = '\0';
  slCardNumber[0xb] = '\0';
  slCardNumber[0xc] = '\0';
  slCardNumber[0xd] = '\0';
  slCardNumber[0xe] = '\0';
  slCardNumber[0xf] = '\0';
  pcVar6 = sSecurData;
  for (lVar5 = 0x200; lVar5 != 0; lVar5 = lVar5 + -1) {
    pcVar6[0] = '\0';
    pcVar6[1] = '\0';
    pcVar6[2] = '\0';
    pcVar6[3] = '\0';
    pcVar6[4] = '\0';
    pcVar6[5] = '\0';
    pcVar6[6] = '\0';
    pcVar6[7] = '\0';
    pcVar6 = pcVar6 + (ulong)bVar7 * -0x10 + 8;
  }
  slCardNumber[0x14] = '\0';
  slCardNumber[0x15] = '\0';
  sCaptureCode[4] = '\0';
  sCaptureCode[5] = '\0';
  slProcCode[4] = '\0';
  slProcCode[5] = '\0';
  rService.szDestAcc[1] = '\0';
  rService.szDestAcc[2] = '\0';
  slCardNumber[0x10] = '\0';
  slCardNumber[0x11] = '\0';
  slCardNumber[0x12] = '\0';
  slCardNumber[0x13] = '\0';
  sPrimResource[4] = '\0';
  sPrimResource[5] = '\0';
  slCardNumber[0x16] = '\0';
  slProcCode[0] = '\0';
  slProcCode[1] = '\0';
  slProcCode[2] = '\0';
  slProcCode[3] = '\0';
  slProcCode[6] = '\0';
  slFuncCode[0] = '\0';
  slFuncCode[1] = '\0';
  slFuncCode[2] = '\0';
  slFuncCode[3] = '\0';
  sSecResource[4] = '\0';
  sSecResource[5] = '\0';
  rService.szMti[0] = '\0';
  rService.szMti[1] = '\0';
  rService.szMti[2] = '\0';
  rService.szMti[3] = '\0';
  rService.szMti[4] = '\0';
  rService.szProcCode[0] = '\0';
  rService.szProcCode[1] = '\0';
  rService.szProcCode[2] = '\0';
  rService.szFctCode[0] = '\0';
  rService.szFctCode[1] = '\0';
  rService.szFctCode[2] = '\0';
  rService.szFctCode[3] = '\0';
  rService.szSrcAcc[0] = '\0';
  rService.szSrcAcc[1] = '\0';
  rService.szSrcAcc[2] = '\0';
  rService.szDestAcc[0] = '\0';
  sEventCode[0] = '\0';
  sEventCode[1] = '\0';
  sEventCode[2] = '\0';
  sEventCode[3] = '\0';
  sPrimResource[0] = '\0';
  sPrimResource[1] = '\0';
  sPrimResource[2] = '\0';
  sPrimResource[3] = '\0';
  sPrimResource[6] = '\0';
  sSecResource[0] = '\0';
  sSecResource[1] = '\0';
  sSecResource[2] = '\0';
  sSecResource[3] = '\0';
  sSecResource[6] = '\0';
  sCaptureCode[0] = '\0';
  sCaptureCode[1] = '\0';
  sCaptureCode[2] = '\0';
  sCaptureCode[3] = '\0';
  sCaptureCode[6] = '\0';
  pcVar6 = sAlternAmount;
  for (lVar5 = 0x200; lVar5 != 0; lVar5 = lVar5 + -1) {
    pcVar6[0] = '\0';
    pcVar6[1] = '\0';
    pcVar6[2] = '\0';
    pcVar6[3] = '\0';
    pcVar6[4] = '\0';
    pcVar6[5] = '\0';
    pcVar6[6] = '\0';
    pcVar6[7] = '\0';
    pcVar6 = pcVar6 + (ulong)bVar7 * -0x10 + 8;
  }
  AddPos[0x18] = '\0';
  AddPos[0x19] = '\0';
  slTransAmount[0x14] = '\0';
  slTransAmount[0x15] = '\0';
  AddPos[0] = '\0';
  AddPos[1] = '\0';
  AddPos[2] = '\0';
  AddPos[3] = '\0';
  AddPos[4] = '\0';
  AddPos[5] = '\0';
  AddPos[6] = '\0';
  AddPos[7] = '\0';
  AddPos[8] = '\0';
  AddPos[9] = '\0';
  AddPos[10] = '\0';
  AddPos[0xb] = '\0';
  AddPos[0xc] = '\0';
  AddPos[0xd] = '\0';
  AddPos[0xe] = '\0';
  AddPos[0xf] = '\0';
  AddPos[0x10] = '\0';
  AddPos[0x11] = '\0';
  AddPos[0x12] = '\0';
  AddPos[0x13] = '\0';
  AddPos[0x14] = '\0';
  AddPos[0x15] = '\0';
  AddPos[0x16] = '\0';
  AddPos[0x17] = '\0';
  AddPos[0x1a] = '\0';
  slTransAmount[0] = '\0';
  slTransAmount[1] = '\0';
  slTransAmount[2] = '\0';
  slTransAmount[3] = '\0';
  slTransAmount[4] = '\0';
  slTransAmount[5] = '\0';
  slTransAmount[6] = '\0';
  slTransAmount[7] = '\0';
  slTransAmount[8] = '\0';
  slTransAmount[9] = '\0';
  slTransAmount[10] = '\0';
  slTransAmount[0xb] = '\0';
  slTransAmount[0xc] = '\0';
  slTransAmount[0xd] = '\0';
  slTransAmount[0xe] = '\0';
  slTransAmount[0xf] = '\0';
  slTransAmount[0x10] = '\0';
  slTransAmount[0x11] = '\0';
  slTransAmount[0x12] = '\0';
  slTransAmount[0x13] = '\0';
  slTransAmount[0x16] = '\0';
  *pcVar6 = '\0';
  sPosData[0] = '\0';
  sPosData[1] = '\0';
  sPosData[2] = '\0';
  sPosData[3] = '\0';
  sPosData[4] = '\0';
  sPosData[5] = '\0';
  sPosData[6] = '\0';
  sPosData[7] = '\0';
  sPosData[8] = '\0';
  sPosData[9] = '\0';
  sPosData[10] = '\0';
  sPosData[0xb] = '\0';
  sPosData[0xc] = '\0';
  InitTlvAutho(&sTlvInfo);
  iVar3 = IsoToTlv(nIndiceCtx,IsoInfo,&sTlvInfo);
  if (iVar3 != 0) {
    trace_event("IsoToTlv Error ...",1);
    InsertIsoField(0x26,IsoInfo,"909",3);
    return -1;
  }
  PutTlvAutho("288",&sTlvInfo,sAuthoTable,3);
  PutTlvAutho("201",&sTlvInfo,sMyResource,6);
  PutTlvAutho("253",&sTlvInfo,sAcquirerBank,6);
  PutTlvAutho("131",&sTlvInfo,InternationalRoutCheck,1);
  PutTlvAutho("200",&sTlvInfo,"000001",6);
  AuthoBuildTlv(sTlvBuffer,&sTlvInfo);
  PrintTlvBuffer(sTlvBuffer);
  iVar3 = GetOriginalDataElements(nIndiceCtx,"C",sTlvBuffer,sPrimResource);
  if (iVar3 == 0) {
    trace_event("Found a Duplicate Request. ",5);
    GetTlvBuffer("201",sTlvBuffer,sCaptureCode,&nLength);
    iVar3 = memcmp(sCaptureCode,&DAT_004d1efb,2);
    if (iVar3 != 0) {
      PutTlvBuffer("039",sTlvBuffer,"308",3);
      PutTlvBuffer("038",sTlvBuffer,"      ",6);
    }
    InitTlvAutho(&sTlvInfo);
    AnalyseTlvAutho(sTlvBuffer,&sTlvInfo);
    TlvToIso(nIndiceCtx,&sTlvInfo,IsoInfo,'\x01');
    trace_event("End AuthorRequestProcessing()",5);
    return 0;
  }
  iVar3 = CheckReqTlvFields(nIndiceCtx,sTlvBuffer);
  if (iVar3 != 0) {
LAB_00449ce8:
    SafIndicator = 'S';
    goto LAB_00449c9e;
  }
  PutTlvBuffer("203",sTlvBuffer,"902",3);
  builtin_strncpy(sLine,"TRACE 1",8);
  trace_event(sLine,5);
  iVar3 = LoadIssuerData(nIndiceCtx,sTlvBuffer,InternationalRoutCheck,sPrimResource,sSecResource);
  builtin_strncpy(sLine,"TRACE 2",8);
  trace_event(sLine,5);
  PrintTlvBuffer(sTlvBuffer);
  builtin_strncpy(sLine,"TRACE 3",8);
  trace_event(sLine,5);
  sprintf(sLine,"Primary Resource    ...%.6s ",sPrimResource);
  trace_event(sLine,5);
  sprintf(sLine,"Secondarry Resource ...%.6s ",sSecResource);
  trace_event(sLine,5);
  if (iVar3 == 0) {
    PutTlvBuffer("200",sTlvBuffer,sPrimResource,6);
    pcVar6 = sTlvProcCode;
    for (lVar5 = 0x200; lVar5 != 0; lVar5 = lVar5 + -1) {
      pcVar6[0] = '\0';
      pcVar6[1] = '\0';
      pcVar6[2] = '\0';
      pcVar6[3] = '\0';
      pcVar6[4] = '\0';
      pcVar6[5] = '\0';
      pcVar6[6] = '\0';
      pcVar6[7] = '\0';
      pcVar6 = pcVar6 + (ulong)bVar7 * -0x10 + 8;
    }
    *pcVar6 = '\0';
    pcVar6 = sIsoProcCode;
    for (lVar5 = 0x200; lVar5 != 0; lVar5 = lVar5 + -1) {
      pcVar6[0] = '\0';
      pcVar6[1] = '\0';
      pcVar6[2] = '\0';
      pcVar6[3] = '\0';
      pcVar6[4] = '\0';
      pcVar6[5] = '\0';
      pcVar6[6] = '\0';
      pcVar6[7] = '\0';
      pcVar6 = pcVar6 + (ulong)bVar7 * -0x10 + 8;
    }
    *pcVar6 = '\0';
    iVar3 = GetTlvBuffer("003",sTlvBuffer,sTlvProcCode,&nLength);
    if ((iVar3 == 0) && (iVar3 = GetIsoField(2,IsoInfo,sIsoProcCode,&nLength), iVar3 == 0)) {
      sprintf(sLine," PROCESSING CODE TLV %s",sTlvProcCode);
      trace_event(sLine,4);
      sprintf(sLine," PROCESSING CODE ISO %s",sIsoProcCode);
      trace_event(sLine,4);
      sIsoProcCode[0] = sTlvProcCode[6];
      sIsoProcCode[1] = sTlvProcCode[7];
      sprintf(sLine," PROCESSING CODE ISO %s",sIsoProcCode);
      trace_event(sLine,4);
      PutIsoField(2,IsoInfo,sIsoProcCode,6);
    }
    GetIsoField(1,IsoInfo,slCardNumber,&nLength);
    GetIsoField(2,IsoInfo,slProcCode,&nLength);
    GetIsoField(0x17,IsoInfo,slFuncCode,&nLength);
    GetIsoField(3,IsoInfo,slTransAmount,&nLength);
    sprintf(rService.szMti,"%04d",(ulong)(uint)IsoInfo->nMsgType);
    uVar2 = slProcCode._0_4_;
    acVar1 = slFuncCode;
    nLength = 4;
    rService.szProcCode[0] = slProcCode[0];
    rService.szProcCode[1] = slProcCode[1];
    slProcCode._2_2_ = SUB42(uVar2,2);
    rService.szSrcAcc[0] = slProcCode[2];
    rService.szSrcAcc[1] = slProcCode[3];
    rService.szDestAcc[0] = (char)slProcCode._4_2_;
    rService.szDestAcc[1] = SUB21(slProcCode._4_2_,1);
    rService.szFctCode[0] = slFuncCode[0];
    rService.szFctCode[1] = slFuncCode[1];
    slFuncCode[2] = acVar1[2];
    rService.szFctCode[2] = slFuncCode[2];
    slFuncCode = acVar1;
    slProcCode._0_4_ = uVar2;
    uVar4 = CheckResourceServices(nIndiceCtx,sMyResource,&rService);
    if (uVar4 == 0) {
      PosCond[0] = '\0';
      PosCond[1] = '\0';
      PosCond[2] = '\0';
      iVar3 = GetIsoField(0x3c,IsoInfo,tmpField,&nLength);
      local_9c44 = 0xffffffff;
      local_9c80 = -1;
      if (iVar3 == 0) {
        InitTlvPrivate(&TlvInfo);
        AnalyseTlvPrivate(tmpField,nLength,&TlvInfo);
        iVar3 = GetTlvPrivate("025",&TlvInfo,PosCond,&nLength);
        if (iVar3 == 0) {
          iVar3 = memcmp(PosCond,&DAT_004a908d,2);
          local_9c44 = -(uint)(iVar3 != 0);
          sprintf(sLine,"ACCOUNT VERIFICATION1 ENH8.2 ...%d ",(ulong)local_9c44);
          trace_event(sLine,5);
        }
        iVar3 = GetTlvPrivate("061",&TlvInfo,AddPos,&nLength);
        local_9c80 = -1;
        if (iVar3 == 0) {
          local_9c80 = -(uint)(AddPos[6] != '8');
          sprintf(sLine,"MasterCard Account Status Inquiry ...%d ",local_9c80);
          trace_event(sLine,5);
        }
      }
      iVar3 = memcmp(sPrimResource,"000001",6);
      if (iVar3 == 0) {
        trace_event("Prm : STAND_IN AUTHORISATION PROCESSING(CP)",5);
        iVar3 = GetSecurityFlags(nIndiceCtx,sTlvBuffer,"OFF");
        if (((iVar3 == 0) && (iVar3 = PreControl(nIndiceCtx,sTlvBuffer), iVar3 == 0)) &&
           (iVar3 = CheckSecurity(nIndiceCtx,sTlvBuffer), iVar3 == 0)) {
          iVar3 = memcmp(sIsoProcCode,&DAT_004a671d,2);
          if ((iVar3 == 0) || (local_9c44 == 0)) {
            if (local_9c80 == 0) {
LAB_00449a77:
              iVar3 = atoi(slTransAmount);
              if (((iVar3 != 0) && (iVar3 = memcmp(slProcCode,&DAT_004c9c1d,2), iVar3 == 0)) &&
                 (iVar3 = CheckLimits(nIndiceCtx,"OFF",sTlvBuffer,sAlternAmount), iVar3 != 0))
              goto LAB_00449c98;
            }
LAB_00449aa5:
            iVar3 = memcmp(sMyResource,&DAT_004a7e39,6);
            if ((iVar3 == 0) || (iVar3 = CheckFallBack(nIndiceCtx,"OFF",sTlvBuffer), iVar3 == 0)) {
              iVar3 = memcmp(sIsoProcCode,&DAT_004a671d,2);
              if (iVar3 == 0) {
LAB_00449ae1:
                builtin_strncpy(sLine,"going to get auth_number for Account_verif_trx...",0x32);
                trace_event(sLine,5);
                iVar3 = GetAuthNumber(nIndiceCtx,sTlvBuffer);
                if (iVar3 == 0) {
LAB_00449b80:
                  PutTlvBuffer("203",sTlvBuffer,"000",3);
                  iVar3 = GetIsoField(0x2f,IsoInfo,tmpField,&nLength);
                  if (iVar3 == 0) {
                    InitTlvPrivate(&TlvInfo);
                    AnalyseTlvPrivate(tmpField,nLength,&TlvInfo);
                    iVar3 = GetTlvPrivate("P95",&TlvInfo,tmpField,&nLength);
                    if (iVar3 == 0) {
                      GetIsoField(0x15,IsoInfo,sPosData,&nLength);
                      sprintf(sLine,"sPosData(%s) ",sPosData);
                      trace_event(sLine,5);
                      iVar3 = memcmp(sMyResource,&DAT_004d475e,2);
                      if ((iVar3 == 0) && (sPosData[0xb] == '0')) {
                        trace_event("check phone started  ecome ",5);
                        iVar3 = CheckPhone(nIndiceCtx,slCardNumber,sTlvBuffer);
                        if (iVar3 != 0) goto LAB_0044a020;
                      }
                    }
                  }
                }
                else {
                  trace_event("Retour GetAuthNumber NOK ",5);
                }
              }
              else {
                sprintf(sLine," AMA sIsoProcCode(%s) ",sIsoProcCode);
                trace_event(sLine,5);
                iVar3 = CheckAccAvailable(nIndiceCtx,sTlvBuffer);
                if (iVar3 == 0) {
                  iVar3 = memcmp(sIsoProcCode,&DAT_004a671d,2);
                  if (iVar3 == 0) goto LAB_00449ae1;
                  goto LAB_00449b80;
                }
              }
            }
          }
          else {
            iVar3 = AmountMng(nIndiceCtx,sServGatewayFlag,sBillCalculFlag,sTlvBuffer);
            if (iVar3 == 0) {
              PrintTlvBuffer(sTlvBuffer);
              if (local_9c80 == 0) goto LAB_00449a77;
              iVar3 = CheckLimits(nIndiceCtx,"OFF",sTlvBuffer,sAlternAmount);
              if (iVar3 == 0) goto LAB_00449aa5;
            }
            else {
              trace_event("Retour AmountMng NOK ",5);
              trace_event("End AuthorRequestProcessing()",5);
            }
          }
        }
      }
      else {
        iVar3 = GetTlvBuffer("203",sTlvBuffer,sEventCode,&nLength);
        if (iVar3 == 0) {
          iVar3 = CheckResource(nIndiceCtx,sPrimResource,&nPid);
          if ((iVar3 == 0) &&
             ((iVar3 = kill(nPid,0), iVar3 == 0 ||
              (iVar3 = memcmp(ResourceId,"050000",6), iVar3 == 0)))) {
            iVar3 = memcmp(sEventCode,&DAT_004caed9,3);
            if (iVar3 == 0) {
              local_9c58 = 0;
              goto LAB_0044a250;
            }
            iVar3 = GetSecurityFlags(nIndiceCtx,sTlvBuffer,"ON");
            if (((iVar3 == 0) && (iVar3 = PreControl(nIndiceCtx,sTlvBuffer), iVar3 == 0)) &&
               (iVar3 = CheckSecurity(nIndiceCtx,sTlvBuffer), iVar3 == 0)) {
              if (local_9c44 != 0) {
                iVar3 = AmountMng(nIndiceCtx,sServGatewayFlag,sBillCalculFlag,sTlvBuffer);
                if (iVar3 != 0) {
                  PutTlvBuffer("025",sTlvBuffer,"1006",4);
                  trace_event("Retour AmountMng NOK ",5);
                  SafIndicator = 'S';
                  goto LAB_00449c9e;
                }
                if ((local_9c80 != 0) &&
                   (iVar3 = CheckLimits(nIndiceCtx,"ON",sTlvBuffer,sAlternAmount), iVar3 != 0))
                goto LAB_0044a6df;
                PrintTlvBuffer(sTlvBuffer);
              }
              if ((local_9c80 == 0) ||
                 (iVar3 = CheckLimits(nIndiceCtx,"ON",sTlvBuffer,sAlternAmount), iVar3 == 0)) {
                PrintTlvBuffer(sTlvBuffer);
                iVar3 = memcmp(sMyResource,&DAT_004a7e39,6);
                if ((iVar3 == 0) || (iVar3 = CheckFallBack(nIndiceCtx,"OFF",sTlvBuffer), iVar3 == 0)
                   ) {
                  iVar3 = GetIsoField(0x2f,IsoInfo,tmpField,&nLength);
                  if (iVar3 == 0) {
                    InitTlvPrivate(&TlvInfo);
                    AnalyseTlvPrivate(tmpField,nLength,&TlvInfo);
                    iVar3 = GetTlvPrivate("P95",&TlvInfo,tmpField,&nLength);
                    if (iVar3 == 0) {
                      GetIsoField(0x15,IsoInfo,sPosData,&nLength);
                      sprintf(sLine,"sPosData(%s) ",sPosData);
                      trace_event(sLine,5);
                      iVar3 = memcmp(sMyResource,&DAT_004d475e,2);
                      if ((iVar3 == 0) && (sPosData[0xb] == '0')) {
                        trace_event("check phone started  ecome ",5);
                        iVar3 = CheckPhone(nIndiceCtx,slCardNumber,sTlvBuffer);
                        if (iVar3 != 0) goto LAB_0044a020;
                      }
                    }
                  }
                  goto LAB_0044a2a7;
                }
LAB_0044a02a:
                pcVar6 = "1006";
                tlv_name = "025";
                iVar3 = 4;
                goto LAB_0044a040;
              }
            }
LAB_0044a6df:
            PutTlvBuffer("025",sTlvBuffer,"1006",4);
            SafIndicator = 'S';
            goto LAB_00449c9e;
          }
          iVar3 = memcmp(sEventCode,&DAT_004caed9,3);
          if (iVar3 == 0) {
            local_9c58 = -1;
LAB_0044a250:
            if ((local_9c44 != 0) &&
               (iVar3 = AmountMng(nIndiceCtx,sServGatewayFlag,sBillCalculFlag,sTlvBuffer),
               iVar3 != 0)) {
              trace_event("Retour AmountMng NOK ",5);
              goto LAB_00449c98;
            }
            PrintTlvBuffer(sTlvBuffer);
            iVar3 = memcmp(sEventCode,&DAT_004caed9,3);
            if ((iVar3 != 0) && (local_9c58 == -1)) goto LAB_00449e04;
LAB_0044a2a7:
            iVar3 = CheckResource(nIndiceCtx,sPrimResource,&nPid);
            if ((iVar3 != 0) ||
               ((iVar3 = kill(nPid,0), iVar3 != 0 &&
                (iVar3 = memcmp(ResourceId,"050000",6), iVar3 != 0)))) goto LAB_00449e17;
            trace_event("Primary Ressource Up ",5);
            iVar3 = CardInSaf(nIndiceCtx,slCardNumber);
            if (iVar3 != 0) {
              PutTlvBuffer("203",sTlvBuffer,"000",3);
              iVar3 = AuthorRouting(nIndiceCtx,sTlvBuffer,sPrimResource,nPid,IsoInfo);
              return iVar3;
            }
            PutTlvBuffer("025",sTlvBuffer,"1005",4);
            if (debug_option == 1) {
              sprintf(sLine,"Card [%s] Found In Saf File ",slCardNumber);
              trace_event(sLine,5);
            }
          }
          else {
            iVar3 = memcmp(sEventCode,&DAT_004caed9,3);
            if (iVar3 == 0) goto LAB_0044a2a7;
LAB_00449e04:
            trace_event("PrimResUp is NOK",4);
LAB_00449e17:
            PutTlvBuffer("025",sTlvBuffer,"1004",4);
            trace_event("Primary Ressource Down ",5);
          }
          iVar3 = memcmp(sSecResource,"000000",6);
          if (iVar3 != 0) {
            iVar3 = memcmp(sSecResource,"000001",6);
            if (iVar3 == 0) {
              trace_event("Sec : STAND_IN AUTHORISATION PROCESSING",5);
              iVar3 = GetSecurityFlags(nIndiceCtx,sTlvBuffer,"OFF");
              if (((((iVar3 == 0) && (iVar3 = PreControl(nIndiceCtx,sTlvBuffer), iVar3 == 0)) &&
                   (iVar3 = CheckSecurity(nIndiceCtx,sTlvBuffer), iVar3 == 0)) &&
                  (((local_9c44 == 0 || (local_9c80 == 0)) ||
                   (iVar3 = CheckLimits(nIndiceCtx,"OFF",sTlvBuffer,sAlternAmount), iVar3 == 0))))
                 && (iVar3 = CheckAccAvailable(nIndiceCtx,sTlvBuffer), iVar3 == 0)) {
                PutTlvBuffer("203",sTlvBuffer,"000",3);
                iVar3 = GetIsoField(0x2f,IsoInfo,tmpField,&nLength);
                if (iVar3 == 0) {
                  InitTlvPrivate(&TlvInfo);
                  AnalyseTlvPrivate(tmpField,nLength,&TlvInfo);
                  iVar3 = GetTlvPrivate("P95",&TlvInfo,tmpField,&nLength);
                  if (iVar3 == 0) {
                    GetIsoField(0x15,IsoInfo,sPosData,&nLength);
                    sprintf(sLine,"sPosData(%s) ",sPosData);
                    trace_event(sLine,5);
                    iVar3 = memcmp(sMyResource,&DAT_004d475e,2);
                    if ((iVar3 == 0) && (sPosData[0xb] == '0')) {
                      trace_event("check phone started  ecome ",5);
                      iVar3 = CheckPhone(nIndiceCtx,slCardNumber,sTlvBuffer);
                      if (iVar3 != 0) {
LAB_0044a020:
                        PrintTlvBuffer(sTlvBuffer);
                        goto LAB_0044a02a;
                      }
                    }
                  }
                }
              }
              goto LAB_00449ce8;
            }
            iVar3 = CheckResource(nIndiceCtx,sSecResource,&nPid);
            if (iVar3 == 0) {
              PutTlvBuffer("203",sTlvBuffer,"000",3);
              iVar3 = AuthorRouting(nIndiceCtx,sTlvBuffer,sSecResource,nPid,IsoInfo);
              return iVar3;
            }
          }
          iVar3 = 3;
          pcVar6 = "801";
          tlv_name = "203";
LAB_0044a040:
          PutTlvBuffer(tlv_name,sTlvBuffer,pcVar6,iVar3);
        }
      }
    }
    else {
      sprintf(sLine,"Err CheckResourceServices, EventCode= [%d] ",(ulong)uVar4);
      trace_event(sLine,5);
      sprintf(sEventCode,"%03d",(ulong)uVar4);
      PutTlvBuffer("025",sTlvBuffer,"1006",4);
      PutTlvBuffer("203",sTlvBuffer,sEventCode,3);
      trace_event("End AuthorRequestProcessing()",5);
    }
  }
LAB_00449c98:
  SafIndicator = 'N';
LAB_00449c9e:
  iVar3 = AuthorLocal(nIndiceCtx,sTlvBuffer,IsoInfo,sMyResource,sPrimResource,SafIndicator);
  return iVar3;
}



// WARNING: Unknown calling convention

int AuthorReplyProcessing(int nIndiceCtx,TSIsoInfo *IsoInfo,char *sTlvBuffer)

{
  int iVar1;
  int iVar2;
  long lVar3;
  ulong uVar4;
  char *pcVar5;
  ulong uVar6;
  char *pcVar7;
  size_t __n;
  bool bVar8;
  byte bVar9;
  char vAuthorSrc [3];
  int nLength;
  char sActionCode [4];
  char TableIndicator [4];
  char sCaptureCode [7];
  char sProcessingCode [7];
  char sRoutingCode [7];
  timeval time_s_aut;
  char sTimeField [256];
  char tmpField [256];
  char sIssActionCode [257];
  char szWork [512];
  char sLine [512];
  TSTlvPrivate sTlvPrivateInfo;
  TSTlvAutho sTlvInfo;
  
  bVar9 = 0;
  nLength = 0;
  trace_event("Start AuthorReplyProcessing()",5);
  InitTlvAutho(&sTlvInfo);
  AnalyseTlvAutho(sTlvBuffer,&sTlvInfo);
  pcVar5 = sIssActionCode;
  for (lVar3 = 0x20; lVar3 != 0; lVar3 = lVar3 + -1) {
    pcVar5[0] = '\0';
    pcVar5[1] = '\0';
    pcVar5[2] = '\0';
    pcVar5[3] = '\0';
    pcVar5[4] = '\0';
    pcVar5[5] = '\0';
    pcVar5[6] = '\0';
    pcVar5[7] = '\0';
    pcVar5 = pcVar5 + (ulong)bVar9 * -0x10 + 8;
  }
  vAuthorSrc[0] = '\0';
  vAuthorSrc[1] = '\0';
  sCaptureCode[4] = '\0';
  sCaptureCode[5] = '\0';
  sProcessingCode[4] = '\0';
  sProcessingCode[5] = '\0';
  sRoutingCode[4] = '\0';
  sRoutingCode[5] = '\0';
  sActionCode[0] = '\0';
  sActionCode[1] = '\0';
  sActionCode[2] = '\0';
  sActionCode[3] = '\0';
  sCaptureCode[0] = '\0';
  sCaptureCode[1] = '\0';
  sCaptureCode[2] = '\0';
  sCaptureCode[3] = '\0';
  sCaptureCode[6] = '\0';
  sProcessingCode[0] = '\0';
  sProcessingCode[1] = '\0';
  sProcessingCode[2] = '\0';
  sProcessingCode[3] = '\0';
  sProcessingCode[6] = '\0';
  *pcVar5 = '\0';
  sRoutingCode[0] = '\0';
  sRoutingCode[1] = '\0';
  sRoutingCode[2] = '\0';
  sRoutingCode[3] = '\0';
  sRoutingCode[6] = '\0';
  TableIndicator[0] = '\0';
  TableIndicator[1] = '\0';
  TableIndicator[2] = '\0';
  TableIndicator[3] = '\0';
  pcVar5 = sTimeField;
  for (lVar3 = 0x20; lVar3 != 0; lVar3 = lVar3 + -1) {
    pcVar5[0] = '\0';
    pcVar5[1] = '\0';
    pcVar5[2] = '\0';
    pcVar5[3] = '\0';
    pcVar5[4] = '\0';
    pcVar5[5] = '\0';
    pcVar5[6] = '\0';
    pcVar5[7] = '\0';
    pcVar5 = pcVar5 + (ulong)bVar9 * -0x10 + 8;
  }
  vAuthorSrc[2] = '\0';
  pcVar5 = tmpField;
  for (lVar3 = 0x20; lVar3 != 0; lVar3 = lVar3 + -1) {
    pcVar5[0] = '\0';
    pcVar5[1] = '\0';
    pcVar5[2] = '\0';
    pcVar5[3] = '\0';
    pcVar5[4] = '\0';
    pcVar5[5] = '\0';
    pcVar5[6] = '\0';
    pcVar5[7] = '\0';
    pcVar5 = pcVar5 + (ulong)bVar9 * -0x10 + 8;
  }
  pcVar5 = szWork;
  for (lVar3 = 0x40; lVar3 != 0; lVar3 = lVar3 + -1) {
    pcVar5[0] = '\0';
    pcVar5[1] = '\0';
    pcVar5[2] = '\0';
    pcVar5[3] = '\0';
    pcVar5[4] = '\0';
    pcVar5[5] = '\0';
    pcVar5[6] = '\0';
    pcVar5[7] = '\0';
    pcVar5 = pcVar5 + (ulong)bVar9 * -0x10 + 8;
  }
  pcVar5 = sLine;
  for (lVar3 = 0x40; lVar3 != 0; lVar3 = lVar3 + -1) {
    pcVar5[0] = '\0';
    pcVar5[1] = '\0';
    pcVar5[2] = '\0';
    pcVar5[3] = '\0';
    pcVar5[4] = '\0';
    pcVar5[5] = '\0';
    pcVar5[6] = '\0';
    pcVar5[7] = '\0';
    pcVar5 = pcVar5 + (ulong)bVar9 * -0x10 + 8;
  }
  PrintTlvBuffer(sTlvBuffer);
  GetTlvAutho("201",&sTlvInfo,sCaptureCode,&nLength);
  GetTlvAutho("200",&sTlvInfo,sRoutingCode,&nLength);
  GetTlvAutho("288",&sTlvInfo,TableIndicator,&nLength);
  GetTlvAutho("039",&sTlvInfo,sActionCode,&nLength);
  dump_p7_struct(IsoInfo);
  vAuthorSrc[0] = '\0';
  vAuthorSrc[1] = '\0';
  vAuthorSrc[2] = '\0';
  iVar1 = memcmp(sCaptureCode,&DAT_004a7e39,6);
  vAuthorSrc._0_2_ = (-(ushort)(iVar1 == 0) & 0xb) + 0x3045;
  iVar1 = IsoToTlv(nIndiceCtx,IsoInfo,&sTlvInfo);
  if (iVar1 != 0) {
    trace_event("IsoToTlv Error ...",1);
    iVar1 = memcmp(sActionCode,"000",3);
    if (iVar1 == 0) {
      AutomaticReversalProcessing
                (nIndiceCtx,"C",sCaptureCode,sRoutingCode,TableIndicator,IsoInfo,"4002");
    }
    InsertIsoField(0x26,IsoInfo,"909",3);
    return -1;
  }
  trace_event("Fin IsoToTlv  ...",1);
  PutTlvAutho("277",&sTlvInfo,"P",1);
  PutTlvAutho("255",&sTlvInfo,vAuthorSrc,2);
  bVar8 = ((ulong)sTlvBuffer & 1) != 0;
  uVar6 = 0x1000;
  pcVar5 = sTlvBuffer;
  if (bVar8) {
    *sTlvBuffer = '\0';
    pcVar5 = sTlvBuffer + 1;
    uVar6 = 0xfff;
  }
  pcVar7 = pcVar5;
  if (((ulong)pcVar5 & 2) != 0) {
    pcVar7 = pcVar5 + 2;
    uVar6 = (ulong)((int)uVar6 - 2);
    pcVar5[0] = '\0';
    pcVar5[1] = '\0';
  }
  if (((ulong)pcVar7 & 4) != 0) {
    pcVar7[0] = '\0';
    pcVar7[1] = '\0';
    pcVar7[2] = '\0';
    pcVar7[3] = '\0';
    uVar6 = (ulong)((int)uVar6 - 4);
    pcVar7 = pcVar7 + 4;
  }
  for (uVar4 = uVar6 >> 3; uVar4 != 0; uVar4 = uVar4 - 1) {
    pcVar7[0] = '\0';
    pcVar7[1] = '\0';
    pcVar7[2] = '\0';
    pcVar7[3] = '\0';
    pcVar7[4] = '\0';
    pcVar7[5] = '\0';
    pcVar7[6] = '\0';
    pcVar7[7] = '\0';
    pcVar7 = pcVar7 + (ulong)bVar9 * -0x10 + 8;
  }
  if ((uVar6 & 4) != 0) {
    pcVar7[0] = '\0';
    pcVar7[1] = '\0';
    pcVar7[2] = '\0';
    pcVar7[3] = '\0';
    pcVar7 = pcVar7 + 4;
  }
  if ((uVar6 & 2) != 0) {
    pcVar7[0] = '\0';
    pcVar7[1] = '\0';
    pcVar7 = pcVar7 + 2;
  }
  if (bVar8) {
    *pcVar7 = '\0';
  }
  AuthoBuildTlv(sTlvBuffer,&sTlvInfo);
  PrintTlvBuffer(sTlvBuffer);
  iVar1 = GetActionCode(nIndiceCtx,sTlvBuffer,sActionCode);
  if (iVar1 == 0) {
    PutTlvBuffer("039",sTlvBuffer,sActionCode,3);
  }
  else {
    sActionCode[0] = '9';
    sActionCode[1] = '0';
    sActionCode[2] = '9';
    PutTlvBuffer("039",sTlvBuffer,"909",3);
  }
  iVar1 = memcmp(sActionCode,"000",3);
  if (iVar1 == 0) {
    sProcessingCode[4] = '\0';
    sProcessingCode[5] = '\0';
    sProcessingCode[0] = '\0';
    sProcessingCode[1] = '\0';
    sProcessingCode[2] = '\0';
    sProcessingCode[3] = '\0';
    sProcessingCode[6] = '\0';
    iVar1 = GetIsoField(2,IsoInfo,sProcessingCode,&nLength);
    if ((iVar1 == 0) && (iVar1 = memcmp(sProcessingCode,&DAT_004c9c2d,2), iVar1 == 0)) {
      pcVar5 = szWork;
      for (lVar3 = 0x40; lVar3 != 0; lVar3 = lVar3 + -1) {
        pcVar5[0] = '\0';
        pcVar5[1] = '\0';
        pcVar5[2] = '\0';
        pcVar5[3] = '\0';
        pcVar5[4] = '\0';
        pcVar5[5] = '\0';
        pcVar5[6] = '\0';
        pcVar5[7] = '\0';
        pcVar5 = pcVar5 + (ulong)bVar9 * -0x10 + 8;
      }
      iVar1 = GetTlvBuffer("022",sTlvBuffer,szWork,&nLength);
      if (iVar1 == 0) {
        iVar1 = memcmp(szWork,&DAT_004c83bc,0xc);
        if (iVar1 == 0) {
          pcVar5 = szWork;
          for (lVar3 = 0x40; lVar3 != 0; lVar3 = lVar3 + -1) {
            pcVar5[0] = '\0';
            pcVar5[1] = '\0';
            pcVar5[2] = '\0';
            pcVar5[3] = '\0';
            pcVar5[4] = '\0';
            pcVar5[5] = '\0';
            pcVar5[6] = '\0';
            pcVar5[7] = '\0';
            pcVar5 = pcVar5 + (ulong)bVar9 * -0x10 + 8;
          }
          iVar1 = GetTlvBuffer("048",sTlvBuffer,szWork,&nLength);
          pcVar5 = szWork;
          if (iVar1 == 0) {
            InitTlvPrivate(&sTlvPrivateInfo);
            AnalyseTlvPrivate(szWork,nLength,&sTlvPrivateInfo);
            iVar1 = GetTlvPrivate("CL4",&sTlvPrivateInfo,tmpField,&nLength);
            if (iVar1 == 0) {
              if (0 < nLength) {
                PutIsoField(0x66,IsoInfo,tmpField,nLength);
              }
              pcVar7 = "Iso Proc Code Is ===> %s , Dest Account 1==> %s";
              pcVar5 = tmpField;
            }
            else {
              pcVar7 = szWork;
              for (lVar3 = 0x40; lVar3 != 0; lVar3 = lVar3 + -1) {
                pcVar7[0] = '\0';
                pcVar7[1] = '\0';
                pcVar7[2] = '\0';
                pcVar7[3] = '\0';
                pcVar7[4] = '\0';
                pcVar7[5] = '\0';
                pcVar7[6] = '\0';
                pcVar7[7] = '\0';
                pcVar7 = pcVar7 + (ulong)bVar9 * -0x10 + 8;
              }
              iVar1 = GetTlvBuffer("103",sTlvBuffer,szWork,&nLength);
              if (iVar1 != 0) goto LAB_0044ae58;
              if (0 < nLength) {
                PutIsoField(0x66,IsoInfo,szWork,nLength);
              }
              pcVar7 = "Iso Proc Code Is ===> %s , Dest Account 2==> %s";
            }
          }
          else {
            pcVar7 = szWork;
            for (lVar3 = 0x40; lVar3 != 0; lVar3 = lVar3 + -1) {
              pcVar7[0] = '\0';
              pcVar7[1] = '\0';
              pcVar7[2] = '\0';
              pcVar7[3] = '\0';
              pcVar7[4] = '\0';
              pcVar7[5] = '\0';
              pcVar7[6] = '\0';
              pcVar7[7] = '\0';
              pcVar7 = pcVar7 + (ulong)bVar9 * -0x10 + 8;
            }
            iVar1 = GetTlvBuffer("103",sTlvBuffer,szWork,&nLength);
            if (iVar1 != 0) goto LAB_0044ae58;
            if (0 < nLength) {
              PutIsoField(0x66,IsoInfo,szWork,nLength);
            }
            pcVar7 = "Iso Proc Code Is ===> %s , Dest Account 3==> %s";
          }
          sprintf(sLine,pcVar7,sProcessingCode,pcVar5);
          trace_event(sLine,4);
        }
LAB_0044ae58:
        iVar1 = memcmp(szWork,"211400611246",0xc);
        if (iVar1 == 0) {
          pcVar5 = szWork;
          for (lVar3 = 0x40; lVar3 != 0; lVar3 = lVar3 + -1) {
            pcVar5[0] = '\0';
            pcVar5[1] = '\0';
            pcVar5[2] = '\0';
            pcVar5[3] = '\0';
            pcVar5[4] = '\0';
            pcVar5[5] = '\0';
            pcVar5[6] = '\0';
            pcVar5[7] = '\0';
            pcVar5 = pcVar5 + (ulong)bVar9 * -0x10 + 8;
          }
          iVar1 = GetTlvBuffer("103",sTlvBuffer,szWork,&nLength);
          if (iVar1 == 0) {
            if (0 < nLength) {
              PutIsoField(0x66,IsoInfo,szWork,nLength);
            }
            sprintf(sLine,"Iso Proc Code Is ===> %s , Dest Account 4==> %s",sProcessingCode,szWork);
            trace_event(sLine,4);
          }
        }
      }
    }
  }
  iVar1 = GetIsoField(0x3c,IsoInfo,szWork,&nLength);
  if (iVar1 == 0) {
    InitTlvPrivate(&sTlvPrivateInfo);
    AnalyseTlvPrivate(szWork,nLength,&sTlvPrivateInfo);
    pcVar5 = sIssActionCode;
    for (lVar3 = 0x20; lVar3 != 0; lVar3 = lVar3 + -1) {
      pcVar5[0] = '\0';
      pcVar5[1] = '\0';
      pcVar5[2] = '\0';
      pcVar5[3] = '\0';
      pcVar5[4] = '\0';
      pcVar5[5] = '\0';
      pcVar5[6] = '\0';
      pcVar5[7] = '\0';
      pcVar5 = pcVar5 + (ulong)bVar9 * -0x10 + 8;
    }
    *pcVar5 = '\0';
    iVar1 = GetTlvPrivate("039",&sTlvPrivateInfo,sIssActionCode,&nLength);
    if (iVar1 == 0) {
      vAuthorSrc[1] = '2';
      iVar1 = memcmp(sIssActionCode,&DAT_004c9eaa,2);
      if (iVar1 == 0) {
        PutTlvBuffer("255",sTlvBuffer,vAuthorSrc,2);
      }
      iVar1 = memcmp(sIssActionCode,&DAT_004a315e,3);
      if (iVar1 == 0) {
        pcVar5 = szWork;
        for (lVar3 = 0x40; lVar3 != 0; lVar3 = lVar3 + -1) {
          pcVar5[0] = '\0';
          pcVar5[1] = '\0';
          pcVar5[2] = '\0';
          pcVar5[3] = '\0';
          pcVar5[4] = '\0';
          pcVar5[5] = '\0';
          pcVar5[6] = '\0';
          pcVar5[7] = '\0';
          pcVar5 = pcVar5 + (ulong)bVar9 * -0x10 + 8;
        }
        iVar1 = GetTlvBuffer("048",sTlvBuffer,szWork,&nLength);
        if (iVar1 != 0) {
          InitTlvAutho(&sTlvInfo);
          AnalyseTlvAutho(sTlvBuffer,&sTlvInfo);
          TlvToIso(nIndiceCtx,&sTlvInfo,IsoInfo,'\x01');
          trace_event("End   DynamicStandinProcessing(Field 48 Not Found In TLV)",0);
          return -1;
        }
        InitTlvPrivate(&sTlvPrivateInfo);
        AnalyseTlvPrivate(szWork,nLength,&sTlvPrivateInfo);
        iVar1 = GetTlvPrivate("P94",&sTlvPrivateInfo,tmpField,&nLength);
        if (iVar1 != 0) {
          InitTlvAutho(&sTlvInfo);
          AnalyseTlvAutho(sTlvBuffer,&sTlvInfo);
          TlvToIso(nIndiceCtx,&sTlvInfo,IsoInfo,'\x01');
          AuthorUpdate(nIndiceCtx,sTlvBuffer,IsoInfo,sCaptureCode,"1003",'S');
          trace_event("End   DynamicStandinProcessing(Secondary Resource Not Found)",0);
          return -1;
        }
        iVar1 = memcmp(tmpField,"000001",6);
        if (iVar1 != 0) {
          PutTlvBuffer("277",sTlvBuffer,"P",1);
          vAuthorSrc[1] = '0';
          PutTlvBuffer("255",sTlvBuffer,vAuthorSrc,2);
          InitTlvAutho(&sTlvInfo);
          AnalyseTlvAutho(sTlvBuffer,&sTlvInfo);
          TlvToIso(nIndiceCtx,&sTlvInfo,IsoInfo,'\x01');
          iVar1 = UpdateAuthoActivity(nIndiceCtx,sTlvBuffer);
          if (iVar1 != 0) {
            trace_event("Can Not Write In Authorisation table !!!",0);
          }
          sprintf(sLine,"End   DynamicStandinProcessing(Secondary Resource %s Not StandIn)",tmpField
                 );
          trace_event(sLine,5);
          return 0;
        }
        iVar1 = CheckDynamicAdvice(nIndiceCtx,sRoutingCode);
        if (iVar1 == 0) {
          PutTlvBuffer("277",sTlvBuffer,"P",1);
          vAuthorSrc[1] = '2';
          PutTlvBuffer("255",sTlvBuffer,vAuthorSrc,2);
          PutTlvBuffer("025",sTlvBuffer,"1003",4);
          AuthorProcessing(nIndiceCtx,sCaptureCode,sTlvBuffer,IsoInfo,"1003");
          iVar1 = GetActionCode(nIndiceCtx,sTlvBuffer,sActionCode);
          if (iVar1 != 0) {
            sActionCode[0] = '\0';
            sActionCode[1] = '\0';
            sActionCode[2] = '9';
            sActionCode[0] = '9';
            sActionCode[1] = '0';
          }
          PutIsoField(0x26,IsoInfo,sActionCode,3);
LAB_0044b14f:
          iVar1 = AutSafProcessing(nIndiceCtx,sTlvBuffer,sCaptureCode,sRoutingCode);
          PrintTlvBuffer(sTlvBuffer);
          trace_event("End AuthorReplyProcessing(SystemMalfunctionProcessing)",5);
          return iVar1;
        }
        PutTlvBuffer("277",sTlvBuffer,"P",1);
        vAuthorSrc[1] = '0';
        PutTlvBuffer("255",sTlvBuffer,vAuthorSrc,2);
        iVar1 = UpdateAuthoActivity(nIndiceCtx,sTlvBuffer);
        if (iVar1 == 0) {
          UpdateCardActivity(nIndiceCtx,'1',sTlvBuffer);
          goto LAB_0044b14f;
        }
        trace_event("Can Not Write In Authorisation table !!!",0);
        PutTlvBuffer("288",sTlvBuffer,"SAF",3);
        InsertionAuthoActivity(nIndiceCtx,sTlvBuffer);
        goto LAB_0044b56f;
      }
    }
  }
  iVar1 = GetIsoField(2,IsoInfo,sProcessingCode,&nLength);
  if (iVar1 == 0) {
    sprintf(sLine,"Iso Proc Code Is ===> %s",sProcessingCode);
    trace_event(sLine,4);
  }
  iVar2 = GetTlvBuffer("072",sTlvBuffer,tmpField,&nLength);
  iVar1 = 0;
  if ((iVar2 == 0) && (iVar2 = memcmp(sProcessingCode,&DAT_004a7da4,2), iVar1 = 0, iVar2 != 0)) {
    gettimeofday((timeval *)&time_s_aut,(__timezone_ptr_t)0x0);
    gettimeofday((timeval *)&time_s_aut,(__timezone_ptr_t)0x0);
    sprintf(szWork,"%010ld%06d",time_s_aut.tv_sec,time_s_aut.tv_usec);
    tmpField[0x20] = szWork[0];
    tmpField[0x21] = szWork[1];
    tmpField[0x22] = szWork[2];
    tmpField[0x23] = szWork[3];
    tmpField[0x24] = szWork[4];
    tmpField[0x25] = szWork[5];
    tmpField[0x26] = szWork[6];
    tmpField[0x27] = szWork[7];
    tmpField[0x28] = szWork[8];
    tmpField[0x29] = szWork[9];
    tmpField[0x2a] = szWork[10];
    tmpField[0x2b] = szWork[0xb];
    tmpField[0x2c] = szWork[0xc];
    tmpField[0x2d] = szWork[0xd];
    tmpField[0x2e] = szWork[0xe];
    tmpField[0x2f] = szWork[0xf];
    PutTlvBuffer("072",sTlvBuffer,tmpField,nLength);
    iVar1 = nLength;
    __n = (size_t)nLength;
    memcpy(sTimeField,tmpField,__n);
    sTimeField[__n] = '\0';
  }
  iVar2 = UpdateAuthoActivity(nIndiceCtx,sTlvBuffer);
  if (iVar2 == 0) {
    iVar2 = memcmp(sActionCode,"000",3);
    if (iVar2 == 0) {
      iVar2 = UpdateCardActivity(nIndiceCtx,'2',sTlvBuffer);
      if (iVar2 != 0) {
        trace_event("Can Not Update Card Activity  !!!",0);
      }
      iVar2 = UpdateBalance(nIndiceCtx,'2',sTlvBuffer);
      if (iVar2 != 0) {
        trace_event("Can Not Update Balance  !!!",0);
      }
      UpdateSettlement(nIndiceCtx,sTlvBuffer);
    }
    else {
      UpdateCardActivity(nIndiceCtx,'1',sTlvBuffer);
    }
    StopListReplyProcessing(nIndiceCtx,sTlvBuffer);
    InitTlvAutho(&sTlvInfo);
    AnalyseTlvAutho(sTlvBuffer,&sTlvInfo);
    iVar2 = TlvToIso(nIndiceCtx,&sTlvInfo,IsoInfo,'\x01');
    if (iVar2 == 0) {
      if (0 < iVar1) {
        PutIsoField(0x47,IsoInfo,sTimeField,iVar1);
      }
      trace_event("End AuthorReplyProcessing()",5);
      return 0;
    }
    trace_event("TlvToIso Error ...",1);
    PutIsoField(0x26,IsoInfo,"909",3);
    PutTlvBuffer("039",sTlvBuffer,"909",3);
    iVar1 = UpdateAuthoActivity(nIndiceCtx,sTlvBuffer);
    if (iVar1 == 0) {
      return -9;
    }
    trace_event("Error during Update AuthoActivity",0);
    return -9;
  }
  trace_event("Error in UpdateAuthoActivity 1",4);
  iVar1 = memcmp(sActionCode,"000",3);
  if (iVar1 == 0) {
    trace_event("Error in UpdateAuthoActivity 2",4);
    AutomaticReversalProcessing
              (nIndiceCtx,"C",sCaptureCode,sRoutingCode,TableIndicator,IsoInfo,"4002");
  }
  trace_event("Error in UpdateAuthoActivity 3",4);
  PutTlvBuffer("288",sTlvBuffer,"SAF",3);
  trace_event("Error in UpdateAuthoActivity 4",4);
  InsertionAuthoActivity(nIndiceCtx,sTlvBuffer);
  trace_event("Error in UpdateAuthoActivity 5",4);
  PutTlvBuffer("203",sTlvBuffer,"902",3);
  PutTlvBuffer("039",sTlvBuffer,"909",3);
  AnalyseTlvAutho(sTlvBuffer,&sTlvInfo);
  TlvToIso(nIndiceCtx,&sTlvInfo,IsoInfo,'\x01');
  PutIsoField(0x26,IsoInfo,"909",3);
  trace_event("SEVERE ERROR !!!!!",5);
LAB_0044b56f:
  trace_event("Can Not Update Autho Activity File ",5);
  return -1;
}



// WARNING: Unknown calling convention

int AuthorAdviceProcessing
              (int nIndiceCtx,char *sMyResource,char *sAuthoTable,char *sAcquirerBank,
              char *sServGatewayFlag,char *sIntRoutCheck,char *sTlvBuffer,TSIsoInfo *IsoInfo)

{
  int iVar1;
  uint uVar2;
  char *data;
  char *tlv_name;
  char vAuthorSrc [3];
  char sNetworkCode [3];
  char PosCond [3];
  char sActionCode [4];
  int nLength;
  char sReasonCode [5];
  char sDestResource [7];
  char sSescondaryResource [7];
  char sPrimResource [7];
  char sCaptureCode [7];
  char sAuthNum [8];
  char tmpField [256];
  char sLine [512];
  TSTlvPrivate TlvInfo;
  TSTlvAutho sTlvInfo;
  
  trace_event("Start AuthorAdviceProcessing ()",5);
  sDestResource[0] = '\0';
  sDestResource[1] = '\0';
  sDestResource[2] = '\0';
  sDestResource[3] = '\0';
  sDestResource[6] = '\0';
  sDestResource[4] = '\0';
  sDestResource[5] = '\0';
  InitTlvAutho(&sTlvInfo);
  iVar1 = IsoToTlv(nIndiceCtx,IsoInfo,&sTlvInfo);
  if (iVar1 != 0) {
    trace_event("IsoToTlv Error ...",1);
    return -1;
  }
  sCaptureCode[4] = '\0';
  sCaptureCode[5] = '\0';
  sCaptureCode[0] = '\0';
  sCaptureCode[1] = '\0';
  sCaptureCode[2] = '\0';
  sCaptureCode[3] = '\0';
  sCaptureCode[6] = '\0';
  GetTlvAutho("201",&sTlvInfo,sCaptureCode,&nLength);
  vAuthorSrc[0] = '\0';
  vAuthorSrc[1] = '\0';
  vAuthorSrc[2] = '\0';
  iVar1 = memcmp(sCaptureCode,&DAT_004a7e39,6);
  vAuthorSrc._0_2_ = (-(ushort)(iVar1 == 0) & 0xb) + 0x3045;
  PutTlvAutho("288",&sTlvInfo,sAuthoTable,3);
  PutTlvAutho("201",&sTlvInfo,sMyResource,6);
  PutTlvAutho("253",&sTlvInfo,sAcquirerBank,6);
  PutTlvAutho("277",&sTlvInfo,"P",1);
  vAuthorSrc[1] = '1';
  PutTlvAutho("255",&sTlvInfo,vAuthorSrc,2);
  AuthoBuildTlv(sTlvBuffer,&sTlvInfo);
  PrintTlvBuffer(sTlvBuffer);
  iVar1 = CheckAdvTlvFields(nIndiceCtx,sTlvBuffer);
  if (iVar1 == 0) {
    iVar1 = LoadIssuerData(nIndiceCtx,sTlvBuffer,sIntRoutCheck,sDestResource,sSescondaryResource);
    if (iVar1 == 0) {
      sprintf(sLine,"Primary Resource    ...%.6s ",sDestResource);
      trace_event(sLine,5);
      sprintf(sLine,"Secondarry Resource ...%.6s ",sSescondaryResource);
      PutTlvBuffer("200",sTlvBuffer,sDestResource,6);
      PosCond[0] = '\0';
      PosCond[1] = '\0';
      PosCond[2] = '\0';
      iVar1 = GetIsoField(0x3c,IsoInfo,tmpField,&nLength);
      if (iVar1 == 0) {
        InitTlvPrivate(&TlvInfo);
        AnalyseTlvPrivate(tmpField,nLength,&TlvInfo);
        iVar1 = GetTlvPrivate("025",&TlvInfo,PosCond,&nLength);
        if (iVar1 == 0) {
          iVar1 = memcmp(PosCond,&DAT_004a908d,2);
          sprintf(sLine,"ACCOUNT VERIFICATION1 ENH8.2 ...%d ",(ulong)-(uint)(iVar1 != 0));
          trace_event(sLine,5);
          if (-(uint)(iVar1 != 0) == 0) goto LAB_0044bac8;
        }
      }
      iVar1 = AmountMng(nIndiceCtx,sServGatewayFlag,"N",sTlvBuffer);
      if (iVar1 == 0) {
LAB_0044bac8:
        iVar1 = GetTlvBuffer("038",sTlvBuffer,sAuthNum,&nLength);
        if (iVar1 != 0) {
          GetAuthNumber(nIndiceCtx,sTlvBuffer);
        }
        PrintTlvBuffer(sTlvBuffer);
        iVar1 = InsertionAuthoActivity(nIndiceCtx,sTlvBuffer);
        if (iVar1 == 0) {
          iVar1 = GetIsoField(0x26,IsoInfo,sActionCode,&nLength);
          if (iVar1 == 0) {
            iVar1 = GetTlvBuffer("204",sTlvBuffer,sNetworkCode,&nLength);
            if (iVar1 == 0) {
              sprintf(sLine,"NETWORK CODE  =[%s] ",sNetworkCode);
            }
            else {
              builtin_strncpy(sLine,"NETWORK CODE  =[NULL] ",0x17);
            }
            trace_event(sLine,5);
            iVar1 = memcmp(sNetworkCode,&DAT_004d1e47,2);
            if (iVar1 == 0) {
              trace_event("ACTION CODE TRANSLATION FOR DINERS CARDS",5);
              TranslateRespCode(nIndiceCtx,ResourceId,sActionCode,"RP",tmpField);
              sprintf(sLine,"Translated response : sActionCode=[%s] ",sActionCode);
              trace_event(sLine,5);
            }
            iVar1 = memcmp(sActionCode,"000",3);
            if (iVar1 == 0) {
              iVar1 = UpdateCardActivity(nIndiceCtx,'2',sTlvBuffer);
              if (iVar1 != 0) {
                trace_event("Can Not Update Card Activity  !!!",0);
              }
              trace_event("Updating the Balance",0);
              iVar1 = UpdateBalance(nIndiceCtx,'2',sTlvBuffer);
              if (iVar1 != 0) {
                trace_event("Can Not Update Balance  !!!",0);
              }
              UpdateSettlement(nIndiceCtx,sTlvBuffer);
            }
            else {
              UpdateCardActivity(nIndiceCtx,'1',sTlvBuffer);
            }
          }
          sReasonCode[0] = '\0';
          sReasonCode[1] = '\0';
          sReasonCode[2] = '\0';
          sReasonCode[3] = '\0';
          sReasonCode[4] = '\0';
          iVar1 = GetTlvBuffer("025",sTlvBuffer,sReasonCode,&nLength);
          if ((iVar1 == 0) && (iVar1 = memcmp(sReasonCode,&DAT_004c8442,4), iVar1 == 0)) {
            builtin_strncpy(sReasonCode,"7001",4);
            builtin_strncpy(sLine,"PAS D4INSERTION SAF ",0x14);
            sLine._20_2_ = sLine._20_2_ & 0xff00;
            trace_event(sLine,5);
          }
          else {
            uVar2 = AutSafProcessing(nIndiceCtx,sTlvBuffer,sMyResource,sDestResource);
            sprintf(sLine,"AutSafProcessing(%d)",(ulong)uVar2);
            trace_event(sLine,5);
          }
          InitTlvAutho(&sTlvInfo);
          AnalyseTlvAutho(sTlvBuffer,&sTlvInfo);
          TlvToIso(nIndiceCtx,&sTlvInfo,IsoInfo,'\x01');
          trace_event("End   AuthorAdviceProcessing (OK)",5);
          return 0;
        }
        InsertionSaf(nIndiceCtx,sTlvBuffer,sMyResource,sDestResource);
        PutTlvBuffer("288",sTlvBuffer,"SAF",3);
        iVar1 = InsertionAuthoActivity(nIndiceCtx,sTlvBuffer);
        if (iVar1 != 0) {
          trace_event("Can Not Write In Authorization SAF Table ",5);
        }
        trace_event("Can Not Write In Authorization Table ",5);
        return -9;
      }
      trace_event("Retour AmountMng NOK ",5);
      goto LAB_0044bed8;
    }
    trace_event("Could Not Found Destination ",5);
    PutTlvBuffer("200",sTlvBuffer,"000001",6);
    iVar1 = 3;
    data = "909";
    tlv_name = "039";
  }
  else {
    data = "000001";
    tlv_name = "200";
    iVar1 = 6;
  }
  PutTlvBuffer(tlv_name,sTlvBuffer,data,iVar1);
LAB_0044bed8:
  InsertionAuthoActivity(nIndiceCtx,sTlvBuffer);
  trace_event("End   AuthorAdviceProcessing (NOK)",5);
  return -1;
}



// WARNING: Unknown calling convention

int PCCAdviceProcessing(int nIndiceCtx,char *sMyResource,char *sAuthoTable,char *sAcquirerBank,
                       char *sServGatewayFlag,char *sIntRoutCheck,char *sTlvBuffer,
                       TSIsoInfo *IsoInfo)

{
  int iVar1;
  long lVar2;
  char *pcVar3;
  byte bVar4;
  char vAuthorSrc [3];
  char sEventCode [4];
  char sRespCode [4];
  int nLength;
  char sPrimResource [7];
  char sSecResource [7];
  char slProcCode [7];
  char sCaptureCode [7];
  char slTransAmount [23];
  char AddPos [27];
  char sLine [512];
  char tmpField [4096];
  char sAlternAmount [4097];
  TSTlvAutho sTlvInfo;
  
  bVar4 = 0;
  trace_event("Start PCCAdviceProcessing ()",5);
  sPrimResource[4] = '\0';
  sPrimResource[5] = '\0';
  pcVar3 = sLine;
  for (lVar2 = 0x40; lVar2 != 0; lVar2 = lVar2 + -1) {
    pcVar3[0] = '\0';
    pcVar3[1] = '\0';
    pcVar3[2] = '\0';
    pcVar3[3] = '\0';
    pcVar3[4] = '\0';
    pcVar3[5] = '\0';
    pcVar3[6] = '\0';
    pcVar3[7] = '\0';
    pcVar3 = pcVar3 + (ulong)bVar4 * -0x10 + 8;
  }
  sSecResource[4] = '\0';
  sSecResource[5] = '\0';
  sCaptureCode[4] = '\0';
  sCaptureCode[5] = '\0';
  sPrimResource[0] = '\0';
  sPrimResource[1] = '\0';
  sPrimResource[2] = '\0';
  sPrimResource[3] = '\0';
  sPrimResource[6] = '\0';
  pcVar3 = tmpField;
  for (lVar2 = 0x200; lVar2 != 0; lVar2 = lVar2 + -1) {
    pcVar3[0] = '\0';
    pcVar3[1] = '\0';
    pcVar3[2] = '\0';
    pcVar3[3] = '\0';
    pcVar3[4] = '\0';
    pcVar3[5] = '\0';
    pcVar3[6] = '\0';
    pcVar3[7] = '\0';
    pcVar3 = pcVar3 + (ulong)bVar4 * -0x10 + 8;
  }
  sSecResource[0] = '\0';
  sSecResource[1] = '\0';
  sSecResource[2] = '\0';
  sSecResource[3] = '\0';
  sSecResource[6] = '\0';
  sCaptureCode[0] = '\0';
  sCaptureCode[1] = '\0';
  sCaptureCode[2] = '\0';
  sCaptureCode[3] = '\0';
  sCaptureCode[6] = '\0';
  pcVar3 = sAlternAmount;
  for (lVar2 = 0x200; lVar2 != 0; lVar2 = lVar2 + -1) {
    pcVar3[0] = '\0';
    pcVar3[1] = '\0';
    pcVar3[2] = '\0';
    pcVar3[3] = '\0';
    pcVar3[4] = '\0';
    pcVar3[5] = '\0';
    pcVar3[6] = '\0';
    pcVar3[7] = '\0';
    pcVar3 = pcVar3 + (ulong)bVar4 * -0x10 + 8;
  }
  sRespCode[0] = '\0';
  sRespCode[1] = '\0';
  sRespCode[2] = '\0';
  sRespCode[3] = '\0';
  *pcVar3 = '\0';
  InitTlvAutho(&sTlvInfo);
  sPrimResource[4] = '\0';
  sPrimResource[5] = '\0';
  sPrimResource[0] = '\0';
  sPrimResource[1] = '\0';
  sPrimResource[2] = '\0';
  sPrimResource[3] = '\0';
  sPrimResource[6] = '\0';
  iVar1 = IsoToTlv(nIndiceCtx,IsoInfo,&sTlvInfo);
  if (iVar1 == 0) {
    sCaptureCode[0] = '\0';
    sCaptureCode[1] = '\0';
    sCaptureCode[2] = '\0';
    sCaptureCode[3] = '\0';
    sCaptureCode[4] = '\0';
    sCaptureCode[5] = '\0';
    sCaptureCode[6] = '\0';
    GetTlvAutho("201",&sTlvInfo,sCaptureCode,&nLength);
    memcmp(sCaptureCode,&DAT_004a7e39,6);
    PutTlvAutho("288",&sTlvInfo,sAuthoTable,3);
    PutTlvAutho("201",&sTlvInfo,sMyResource,6);
    PutTlvAutho("253",&sTlvInfo,sAcquirerBank,6);
    PutTlvAutho("131",&sTlvInfo,sIntRoutCheck,1);
    PutTlvAutho("200",&sTlvInfo,"000001",6);
    AuthoBuildTlv(sTlvBuffer,&sTlvInfo);
    PrintTlvBuffer(sTlvBuffer);
    iVar1 = GetOriginalPctDataElements(nIndiceCtx,"C",sTlvBuffer,sPrimResource);
    if (iVar1 == 0) {
      GetTlvBuffer("039",(char *)&sTlvBuffer,sRespCode,&nLength);
      sprintf(sLine,"sRespCode (%s)",sRespCode);
      PrintTlvBuffer(sTlvBuffer);
      iVar1 = CheckAdvTlvFields(nIndiceCtx,sTlvBuffer);
      if (iVar1 == 0) {
        iVar1 = LoadIssuerData(nIndiceCtx,sTlvBuffer,sIntRoutCheck,sPrimResource,sSecResource);
        sprintf(sLine,"Primary Resource    ...%.6s ",sPrimResource);
        trace_event(sLine,5);
        sprintf(sLine,"Secondarry Resource ...%.6s ",sSecResource);
        trace_event(sLine,5);
        pcVar3 = "End PCCAdviceProcessing (2)";
        if (iVar1 == 0) {
          PutTlvBuffer("200",sTlvBuffer,sPrimResource,6);
          iVar1 = GetSecurityFlags(nIndiceCtx,sTlvBuffer,"OFF");
          pcVar3 = "End PCCAdviceProcessing (3)";
          if (iVar1 == 0) {
            iVar1 = PreControl(nIndiceCtx,sTlvBuffer);
            pcVar3 = "End PCCAdviceProcessing (4)";
            if (iVar1 == 0) {
              iVar1 = CheckSecurity(nIndiceCtx,sTlvBuffer);
              pcVar3 = "End PCCAdviceProcessing (5)";
              if (iVar1 == 0) {
                iVar1 = AmountMng(nIndiceCtx,sServGatewayFlag,"N",sTlvBuffer);
                if (iVar1 == 0) {
                  iVar1 = memcmp(sMyResource,&DAT_004a7e39,6);
                  if ((iVar1 == 0) ||
                     (iVar1 = CheckFallBack(nIndiceCtx,"OFF",sTlvBuffer), iVar1 == 0)) {
                    PrintTlvBuffer(sTlvBuffer);
                    iVar1 = InsertionAuthoActivity(nIndiceCtx,sTlvBuffer);
                    InitTlvAutho(&sTlvInfo);
                    AnalyseTlvAutho(sTlvBuffer,&sTlvInfo);
                    TlvToIso(nIndiceCtx,&sTlvInfo,IsoInfo,'\x01');
                    trace_event("End   PCCAdviceProcessing (OK)",5);
                    return iVar1;
                  }
                  pcVar3 = "End AuthorRequestProcessing(7)";
                }
                else {
                  trace_event("Retour AmountMng NOK ",5);
                  pcVar3 = "End AuthorRequestProcessing(6)";
                }
              }
            }
          }
        }
      }
      else {
        pcVar3 = "End PCCAdviceProcessing (1)";
      }
    }
    else {
      pcVar3 = "Error Getting Original PCT Transaction";
    }
    trace_event(pcVar3,5);
    InsertionAuthoActivity(nIndiceCtx,sTlvBuffer);
    return -1;
  }
  trace_event("IsoToTlv Error ...",1);
  return -1;
}



// WARNING: Unknown calling convention

int PaymentTrsReqProcessing
              (int nIndiceCtx,char *sMyResource,char *sAuthoTable,char *sAcquirerBank,
              char *InternationalRoutCheck,char *sServGatewayFlag,char *sBillCalculFlag,
              char *sTlvBuffer,TSIsoInfo *IsoInfo)

{
  char acVar1 [4];
  undefined4 uVar2;
  int iVar3;
  uint uVar4;
  long lVar5;
  char *pcVar6;
  char SafIndicator;
  byte bVar7;
  char slFuncCode [4];
  char sEventCode [4];
  pid_t nPid;
  int nLength;
  char slProcCode [7];
  char sPrimResource [7];
  char sSecResource [7];
  TSService rService;
  char sSecurityLevel [21];
  char slCardNumber [23];
  char sLine [512];
  char sTlvProcCode [4097];
  char sIsoProcCode [4097];
  char sAlternAmount [4097];
  TSTlvAutho sTlvInfo;
  
  bVar7 = 0;
  trace_event("Start PaymentTrsReqProcessing()",5);
  slCardNumber[0x14] = '\0';
  slCardNumber[0x15] = '\0';
  sSecResource[4] = '\0';
  sSecResource[5] = '\0';
  rService.szDestAcc[1] = '\0';
  rService.szDestAcc[2] = '\0';
  slProcCode[4] = '\0';
  slProcCode[5] = '\0';
  pcVar6 = sAlternAmount;
  for (lVar5 = 0x200; lVar5 != 0; lVar5 = lVar5 + -1) {
    pcVar6[0] = '\0';
    pcVar6[1] = '\0';
    pcVar6[2] = '\0';
    pcVar6[3] = '\0';
    pcVar6[4] = '\0';
    pcVar6[5] = '\0';
    pcVar6[6] = '\0';
    pcVar6[7] = '\0';
    pcVar6 = pcVar6 + (ulong)bVar7 * -0x10 + 8;
  }
  sPrimResource[4] = '\0';
  sPrimResource[5] = '\0';
  slCardNumber[0] = '\0';
  slCardNumber[1] = '\0';
  slCardNumber[2] = '\0';
  slCardNumber[3] = '\0';
  slCardNumber[4] = '\0';
  slCardNumber[5] = '\0';
  slCardNumber[6] = '\0';
  slCardNumber[7] = '\0';
  slCardNumber[8] = '\0';
  slCardNumber[9] = '\0';
  slCardNumber[10] = '\0';
  slCardNumber[0xb] = '\0';
  slCardNumber[0xc] = '\0';
  slCardNumber[0xd] = '\0';
  slCardNumber[0xe] = '\0';
  slCardNumber[0xf] = '\0';
  slCardNumber[0x10] = '\0';
  slCardNumber[0x11] = '\0';
  slCardNumber[0x12] = '\0';
  slCardNumber[0x13] = '\0';
  slCardNumber[0x16] = '\0';
  slProcCode[0] = '\0';
  slProcCode[1] = '\0';
  slProcCode[2] = '\0';
  slProcCode[3] = '\0';
  slProcCode[6] = '\0';
  slFuncCode[0] = '\0';
  slFuncCode[1] = '\0';
  slFuncCode[2] = '\0';
  slFuncCode[3] = '\0';
  rService.szMti[0] = '\0';
  rService.szMti[1] = '\0';
  rService.szMti[2] = '\0';
  rService.szMti[3] = '\0';
  rService.szMti[4] = '\0';
  rService.szProcCode[0] = '\0';
  rService.szProcCode[1] = '\0';
  rService.szProcCode[2] = '\0';
  rService.szFctCode[0] = '\0';
  rService.szFctCode[1] = '\0';
  rService.szFctCode[2] = '\0';
  rService.szFctCode[3] = '\0';
  rService.szSrcAcc[0] = '\0';
  rService.szSrcAcc[1] = '\0';
  rService.szSrcAcc[2] = '\0';
  rService.szDestAcc[0] = '\0';
  *pcVar6 = '\0';
  sEventCode[0] = '\0';
  sEventCode[1] = '\0';
  sEventCode[2] = '\0';
  sEventCode[3] = '\0';
  sPrimResource[0] = '\0';
  sPrimResource[1] = '\0';
  sPrimResource[2] = '\0';
  sPrimResource[3] = '\0';
  sPrimResource[6] = '\0';
  sSecResource[0] = '\0';
  sSecResource[1] = '\0';
  sSecResource[2] = '\0';
  sSecResource[3] = '\0';
  sSecResource[6] = '\0';
  InitTlvAutho(&sTlvInfo);
  iVar3 = IsoToTlv(nIndiceCtx,IsoInfo,&sTlvInfo);
  if (iVar3 != 0) {
    trace_event("IsoToTlv Error ...",1);
    InsertIsoField(0x26,IsoInfo,"909",3);
    return -1;
  }
  PutTlvAutho("288",&sTlvInfo,sAuthoTable,3);
  PutTlvAutho("201",&sTlvInfo,sMyResource,6);
  PutTlvAutho("253",&sTlvInfo,sAcquirerBank,6);
  PutTlvAutho("131",&sTlvInfo,InternationalRoutCheck,1);
  PutTlvAutho("200",&sTlvInfo,"000001",6);
  AuthoBuildTlv(sTlvBuffer,&sTlvInfo);
  PrintTlvBuffer(sTlvBuffer);
  iVar3 = GetOriginalDataElements(nIndiceCtx,"C",sTlvBuffer,sPrimResource);
  if (iVar3 == 0) {
    trace_event("Found a Duplicate Request. ",5);
    InitTlvAutho(&sTlvInfo);
    AnalyseTlvAutho(sTlvBuffer,&sTlvInfo);
    TlvToIso(nIndiceCtx,&sTlvInfo,IsoInfo,'\x01');
    return 0;
  }
  iVar3 = CheckReqTlvFields(nIndiceCtx,sTlvBuffer);
  if (iVar3 != 0) {
    trace_event("End PaymentTrsReqProcessing (1)",5);
    SafIndicator = 'S';
    goto LAB_0044cb59;
  }
  PrintTlvBuffer(sTlvBuffer);
  iVar3 = LoadIssuerData(nIndiceCtx,sTlvBuffer,InternationalRoutCheck,sPrimResource,sSecResource);
  PrintTlvBuffer(sTlvBuffer);
  sprintf(sLine,"Primary Resource    ...%.6s ",sPrimResource);
  trace_event(sLine,5);
  sprintf(sLine,"Secondarry Resource ...%.6s ",sSecResource);
  trace_event(sLine,5);
  if (iVar3 == 0) {
    PutTlvBuffer("200",sTlvBuffer,sPrimResource,6);
    pcVar6 = sTlvProcCode;
    for (lVar5 = 0x200; lVar5 != 0; lVar5 = lVar5 + -1) {
      pcVar6[0] = '\0';
      pcVar6[1] = '\0';
      pcVar6[2] = '\0';
      pcVar6[3] = '\0';
      pcVar6[4] = '\0';
      pcVar6[5] = '\0';
      pcVar6[6] = '\0';
      pcVar6[7] = '\0';
      pcVar6 = pcVar6 + (ulong)bVar7 * -0x10 + 8;
    }
    *pcVar6 = '\0';
    pcVar6 = sIsoProcCode;
    for (lVar5 = 0x200; lVar5 != 0; lVar5 = lVar5 + -1) {
      pcVar6[0] = '\0';
      pcVar6[1] = '\0';
      pcVar6[2] = '\0';
      pcVar6[3] = '\0';
      pcVar6[4] = '\0';
      pcVar6[5] = '\0';
      pcVar6[6] = '\0';
      pcVar6[7] = '\0';
      pcVar6 = pcVar6 + (ulong)bVar7 * -0x10 + 8;
    }
    *pcVar6 = '\0';
    iVar3 = GetTlvBuffer("003",sTlvBuffer,sTlvProcCode,&nLength);
    if ((iVar3 == 0) && (iVar3 = GetIsoField(2,IsoInfo,sIsoProcCode,&nLength), iVar3 == 0)) {
      sprintf(sLine," PROCESSING CODE TLV %s",sTlvProcCode);
      trace_event(sLine,4);
      sprintf(sLine," PROCESSING CODE ISO %s",sIsoProcCode);
      trace_event(sLine,4);
      sIsoProcCode[0] = sTlvProcCode[6];
      sIsoProcCode[1] = sTlvProcCode[7];
      sprintf(sLine," PROCESSING CODE ISO %s",sIsoProcCode);
      trace_event(sLine,4);
      PutIsoField(2,IsoInfo,sIsoProcCode,6);
    }
    GetIsoField(1,IsoInfo,slCardNumber,&nLength);
    GetIsoField(2,IsoInfo,slProcCode,&nLength);
    GetIsoField(0x17,IsoInfo,slFuncCode,&nLength);
    sprintf(rService.szMti,"%04d",(ulong)(uint)IsoInfo->nMsgType);
    uVar2 = slProcCode._0_4_;
    acVar1 = slFuncCode;
    nLength = 4;
    rService.szProcCode[0] = slProcCode[0];
    rService.szProcCode[1] = slProcCode[1];
    slProcCode._2_2_ = SUB42(uVar2,2);
    rService.szSrcAcc[0] = slProcCode[2];
    rService.szSrcAcc[1] = slProcCode[3];
    rService.szDestAcc[0] = (char)slProcCode._4_2_;
    rService.szDestAcc[1] = SUB21(slProcCode._4_2_,1);
    rService.szFctCode[0] = slFuncCode[0];
    rService.szFctCode[1] = slFuncCode[1];
    slFuncCode[2] = acVar1[2];
    rService.szFctCode[2] = slFuncCode[2];
    slFuncCode = acVar1;
    slProcCode._0_4_ = uVar2;
    uVar4 = CheckResourceServices(nIndiceCtx,sMyResource,&rService);
    if (uVar4 == 0) {
      iVar3 = memcmp(sPrimResource,"000001",6);
      if (iVar3 == 0) {
        trace_event("Prm : STAND_IN AUTHORISATION PROCESSING",5);
        iVar3 = GetSecurityFlags(nIndiceCtx,sTlvBuffer,"OFF");
        if (iVar3 == 0) {
          PrintTlvBuffer(sTlvBuffer);
          iVar3 = PreControl(nIndiceCtx,sTlvBuffer);
          if (iVar3 == 0) {
            iVar3 = CheckSecurity(nIndiceCtx,sTlvBuffer);
            if (iVar3 == 0) {
              iVar3 = AmountMng(nIndiceCtx,sServGatewayFlag,sBillCalculFlag,sTlvBuffer);
              if (iVar3 == 0) {
                PrintTlvBuffer(sTlvBuffer);
                iVar3 = CheckAccAvailable(nIndiceCtx,sTlvBuffer);
                if (iVar3 == 0) {
                  trace_event("End PaymentTrsReqProcessing (OK)",5);
                }
                else {
                  trace_event("End PaymentTrsReqProcessing (8)",5);
                }
              }
              else {
                trace_event("Retour AmountMng NOK ",5);
                trace_event("End PaymentTrsReqProcessing (7)",5);
              }
            }
            else {
              trace_event("End PaymentTrsReqProcessing (6)",5);
            }
          }
          else {
            trace_event("End PaymentTrsReqProcessing (5)",5);
          }
        }
        else {
          trace_event("End PaymentTrsReqProcessing (4)",5);
        }
      }
      else {
        iVar3 = GetTlvBuffer("203",sTlvBuffer,sEventCode,&nLength);
        if (iVar3 == 0) {
          iVar3 = memcmp(sEventCode,&DAT_004caed9,3);
          if (iVar3 != 0) {
            iVar3 = GetSecurityFlags(nIndiceCtx,sTlvBuffer,"ON");
            if (((iVar3 == 0) && (iVar3 = PreControl(nIndiceCtx,sTlvBuffer), iVar3 == 0)) &&
               (iVar3 = CheckSecurity(nIndiceCtx,sTlvBuffer), iVar3 == 0)) {
              PrintTlvBuffer(sTlvBuffer);
              iVar3 = AmountMng(nIndiceCtx,sServGatewayFlag,sBillCalculFlag,sTlvBuffer);
              if (iVar3 != 0) {
                PutTlvBuffer("025",sTlvBuffer,"1006",4);
                trace_event("Retour AmountMng NOK ",5);
                SafIndicator = 'S';
                goto LAB_0044cb59;
              }
              PrintTlvBuffer(sTlvBuffer);
              iVar3 = CheckLimits(nIndiceCtx,"ON",sTlvBuffer,sAlternAmount);
              if (iVar3 == 0) goto LAB_0044cd1c;
            }
            PutTlvBuffer("025",sTlvBuffer,"1006",4);
            SafIndicator = 'S';
            goto LAB_0044cb59;
          }
          iVar3 = AmountMng(nIndiceCtx,sServGatewayFlag,sBillCalculFlag,sTlvBuffer);
          if (iVar3 == 0) {
            PrintTlvBuffer(sTlvBuffer);
LAB_0044cd1c:
            iVar3 = CheckResource(nIndiceCtx,sPrimResource,&nPid);
            if ((iVar3 == 0) || (iVar3 = kill(nPid,0), iVar3 != 0)) {
              trace_event("Primary Ressource Up ",5);
              iVar3 = CardInSaf(nIndiceCtx,slCardNumber);
              if (iVar3 != 0) {
                iVar3 = AuthorRouting(nIndiceCtx,sTlvBuffer,sPrimResource,nPid,IsoInfo);
                return iVar3;
              }
              PutTlvBuffer("025",sTlvBuffer,"1005",4);
            }
            else {
              PutTlvBuffer("025",sTlvBuffer,"1004",4);
              trace_event("Primary Ressource Down ",5);
            }
            iVar3 = memcmp(sSecResource,"000000",6);
            if (iVar3 != 0) {
              iVar3 = memcmp(sSecResource,"000001",6);
              if (iVar3 == 0) {
                trace_event("Sec : STAND_IN AUTHORISATION PROCESSING",5);
                iVar3 = GetSecurityFlags(nIndiceCtx,sTlvBuffer,"OFF");
                if (((iVar3 == 0) && (iVar3 = PreControl(nIndiceCtx,sTlvBuffer), iVar3 == 0)) &&
                   ((iVar3 = CheckSecurity(nIndiceCtx,sTlvBuffer), iVar3 == 0 &&
                    (iVar3 = CheckLimits(nIndiceCtx,"OFF",sTlvBuffer,sAlternAmount), iVar3 == 0))))
                {
                  CheckAccAvailable(nIndiceCtx,sTlvBuffer);
                }
                SafIndicator = 'S';
                goto LAB_0044cb59;
              }
              iVar3 = CheckResource(nIndiceCtx,sSecResource,&nPid);
              if ((iVar3 == 0) && (iVar3 = kill(nPid,0), iVar3 == 0)) {
                iVar3 = AuthorRouting(nIndiceCtx,sTlvBuffer,sSecResource,nPid,IsoInfo);
                return iVar3;
              }
            }
            PutTlvBuffer("203",sTlvBuffer,"801",3);
          }
          else {
            trace_event("Retour AmountMng NOK ",5);
          }
        }
        else {
          trace_event("End PaymentTrsReqProcessing (9)",5);
        }
      }
    }
    else {
      sprintf(sEventCode,"%03d",(ulong)uVar4);
      PutTlvBuffer("025",sTlvBuffer,"1006",4);
      PutTlvBuffer("203",sTlvBuffer,sEventCode,3);
      trace_event("End PaymentTrsReqProcessing (3)",5);
    }
  }
  else {
    trace_event("End PaymentTrsReqProcessing (2)",5);
  }
  SafIndicator = 'N';
LAB_0044cb59:
  iVar3 = AuthorLocal(nIndiceCtx,sTlvBuffer,IsoInfo,sMyResource,sPrimResource,SafIndicator);
  return iVar3;
}



// WARNING: Restarted to delay deadcode elimination for space: stack
// WARNING: Unknown calling convention

int Author_OctProc(int P_nIndexCtx,char *P_sMyResource,char *P_sAuthoTable,char *P_sAcquirerBank,
                  char *P_sInternationalRoutCheck,char *P_sServGatewayFlag,char *P_sBillCalculFlag,
                  char *P_sTlvBuffer,TSIsoInfo *P_psIsoInfo)

{
  char acVar1 [4];
  undefined4 uVar2;
  undefined8 uVar3;
  undefined8 uVar4;
  int iVar5;
  uint uVar6;
  long lVar7;
  char *__s;
  char *pcVar8;
  char cVar9;
  byte bVar10;
  char slFuncCode [4];
  char sEventCode [4];
  pid_t nPid;
  int nLength;
  char sPrimResource [7];
  char sSecResource [7];
  char slProcCode [7];
  TSService rService;
  char sSecVerifFlag [21];
  char slCardNumber [23];
  char sLine [512];
  char tmpField [4096];
  char sAlternAmount [4097];
  TSTlvAutho sTlvInfo;
  
  bVar10 = 0;
  trace_event("Start Author_OctProc()",5);
  rService.szDestAcc[1] = '\0';
  rService.szDestAcc[2] = '\0';
  slProcCode[4] = '\0';
  slProcCode[5] = '\0';
  sSecResource[4] = '\0';
  sSecResource[5] = '\0';
  sPrimResource[4] = '\0';
  sPrimResource[5] = '\0';
  slCardNumber[0x14] = '\0';
  slCardNumber[0x15] = '\0';
  rService.szMti[0] = '\0';
  rService.szMti[1] = '\0';
  rService.szMti[2] = '\0';
  rService.szMti[3] = '\0';
  rService.szMti[4] = '\0';
  rService.szProcCode[0] = '\0';
  rService.szProcCode[1] = '\0';
  rService.szProcCode[2] = '\0';
  rService.szFctCode[0] = '\0';
  rService.szFctCode[1] = '\0';
  rService.szFctCode[2] = '\0';
  rService.szFctCode[3] = '\0';
  rService.szSrcAcc[0] = '\0';
  rService.szSrcAcc[1] = '\0';
  rService.szSrcAcc[2] = '\0';
  rService.szDestAcc[0] = '\0';
  __s = sEventCode;
  sPrimResource[0] = '\0';
  sPrimResource[1] = '\0';
  sPrimResource[2] = '\0';
  sPrimResource[3] = '\0';
  sPrimResource[6] = '\0';
  pcVar8 = sLine;
  for (lVar7 = 0x40; lVar7 != 0; lVar7 = lVar7 + -1) {
    pcVar8[0] = '\0';
    pcVar8[1] = '\0';
    pcVar8[2] = '\0';
    pcVar8[3] = '\0';
    pcVar8[4] = '\0';
    pcVar8[5] = '\0';
    pcVar8[6] = '\0';
    pcVar8[7] = '\0';
    pcVar8 = pcVar8 + (ulong)bVar10 * -0x10 + 8;
  }
  sSecResource[0] = '\0';
  sSecResource[1] = '\0';
  sSecResource[2] = '\0';
  sSecResource[3] = '\0';
  sSecResource[6] = '\0';
  slCardNumber[0] = '\0';
  slCardNumber[1] = '\0';
  slCardNumber[2] = '\0';
  slCardNumber[3] = '\0';
  slCardNumber[4] = '\0';
  slCardNumber[5] = '\0';
  slCardNumber[6] = '\0';
  slCardNumber[7] = '\0';
  slCardNumber[8] = '\0';
  slCardNumber[9] = '\0';
  slCardNumber[10] = '\0';
  slCardNumber[0xb] = '\0';
  slCardNumber[0xc] = '\0';
  slCardNumber[0xd] = '\0';
  slCardNumber[0xe] = '\0';
  slCardNumber[0xf] = '\0';
  slCardNumber[0x10] = '\0';
  slCardNumber[0x11] = '\0';
  slCardNumber[0x12] = '\0';
  slCardNumber[0x13] = '\0';
  slCardNumber[0x16] = '\0';
  slProcCode[0] = '\0';
  slProcCode[1] = '\0';
  slProcCode[2] = '\0';
  slProcCode[3] = '\0';
  slProcCode[6] = '\0';
  slFuncCode[0] = '\0';
  slFuncCode[1] = '\0';
  slFuncCode[2] = '\0';
  slFuncCode[3] = '\0';
  pcVar8 = tmpField;
  for (lVar7 = 0x200; lVar7 != 0; lVar7 = lVar7 + -1) {
    pcVar8[0] = '\0';
    pcVar8[1] = '\0';
    pcVar8[2] = '\0';
    pcVar8[3] = '\0';
    pcVar8[4] = '\0';
    pcVar8[5] = '\0';
    pcVar8[6] = '\0';
    pcVar8[7] = '\0';
    pcVar8 = pcVar8 + (ulong)bVar10 * -0x10 + 8;
  }
  sEventCode[0] = '\0';
  sEventCode[1] = '\0';
  sEventCode[2] = '\0';
  sEventCode[3] = '\0';
  nPid = 0;
  InitTlvAutho(&sTlvInfo);
  iVar5 = IsoToTlv(P_nIndexCtx,P_psIsoInfo,&sTlvInfo);
  if (iVar5 != 0) {
    trace_event("IsoToTlv Error ...",1);
    InsertIsoField(0x26,P_psIsoInfo,"909",3);
LAB_0044db59:
    trace_event("End   Author_OctProc(NOK)",5);
    return -1;
  }
  PutTlvAutho("288",&sTlvInfo,P_sAuthoTable,3);
  PutTlvAutho("201",&sTlvInfo,P_sMyResource,6);
  PutTlvAutho("253",&sTlvInfo,P_sAcquirerBank,6);
  PutTlvAutho("131",&sTlvInfo,P_sInternationalRoutCheck,1);
  PutTlvAutho("200",&sTlvInfo,"000001",6);
  AuthoBuildTlv(P_sTlvBuffer,&sTlvInfo);
  PrintTlvBuffer(P_sTlvBuffer);
  iVar5 = GetOriginalDataElements(P_nIndexCtx,"C",P_sTlvBuffer,sPrimResource);
  if (iVar5 == 0) {
    trace_event("Found a Duplicate Request. ",5);
    PutIsoField(0x26,P_psIsoInfo,"100",3);
    goto LAB_0044db59;
  }
  pcVar8 = tmpField;
  for (lVar7 = 0x200; lVar7 != 0; lVar7 = lVar7 + -1) {
    pcVar8[0] = '\0';
    pcVar8[1] = '\0';
    pcVar8[2] = '\0';
    pcVar8[3] = '\0';
    pcVar8[4] = '\0';
    pcVar8[5] = '\0';
    pcVar8[6] = '\0';
    pcVar8[7] = '\0';
    pcVar8 = pcVar8 + (ulong)bVar10 * -0x10 + 8;
  }
  iVar5 = GetIsoField(3,P_psIsoInfo,tmpField,&nLength);
  if ((iVar5 != 0) || (iVar5 = atoi(tmpField), iVar5 == 0)) {
    PutTlvBuffer("039",P_sTlvBuffer,"110",3);
    cVar9 = 'S';
    goto LAB_0044da3e;
  }
  PrintTlvBuffer(P_sTlvBuffer);
  iVar5 = LoadIssuerData(P_nIndexCtx,P_sTlvBuffer,P_sInternationalRoutCheck,sPrimResource,
                         sSecResource);
  PrintTlvBuffer(P_sTlvBuffer);
  sprintf(sLine,"Primary Resource    ...%.6s ",sPrimResource);
  trace_event(sLine,5);
  sprintf(sLine,"Secondary Resource  ...%.6s ",sSecResource);
  trace_event(sLine,5);
  if (iVar5 == 0) {
    PutTlvBuffer("200",P_sTlvBuffer,sPrimResource,6);
    GetIsoField(1,P_psIsoInfo,slCardNumber,&nLength);
    GetIsoField(2,P_psIsoInfo,slProcCode,&nLength);
    GetIsoField(0x17,P_psIsoInfo,slFuncCode,&nLength);
    uVar3 = rService._0_8_;
    uVar2 = slProcCode._0_4_;
    acVar1 = slFuncCode;
    builtin_strncpy(rService.szMti,"1100",4);
    uVar4 = rService._0_8_;
    nLength = 4;
    rService.szProcCode[2] = SUB81(uVar3,7);
    rService.szMti = SUB85(uVar4,0);
    rService.szProcCode[0] = slProcCode[0];
    rService.szProcCode[1] = slProcCode[1];
    slProcCode._2_2_ = SUB42(uVar2,2);
    rService.szSrcAcc[0] = slProcCode[2];
    rService.szSrcAcc[1] = slProcCode[3];
    rService.szDestAcc[0] = (char)slProcCode._4_2_;
    rService.szDestAcc[1] = SUB21(slProcCode._4_2_,1);
    rService.szFctCode[0] = slFuncCode[0];
    rService.szFctCode[1] = slFuncCode[1];
    slFuncCode[2] = acVar1[2];
    rService.szFctCode[2] = slFuncCode[2];
    slFuncCode = acVar1;
    slProcCode._0_4_ = uVar2;
    uVar6 = CheckResourceServices(P_nIndexCtx,P_sMyResource,&rService);
    if (uVar6 == 0) {
      iVar5 = memcmp(sPrimResource,"000001",6);
      if (iVar5 == 0) {
        trace_event("Primary Resource: STAND_IN AUTHORISATION PROCESSING",5);
        iVar5 = GetSecurityFlags(P_nIndexCtx,P_sTlvBuffer,"OFF");
        if (iVar5 == 0) {
          iVar5 = CheckOctAcceptance(P_nIndexCtx,P_sTlvBuffer,slCardNumber);
          PrintTlvBuffer(P_sTlvBuffer);
          if ((iVar5 == 0) && (iVar5 = PreControl(P_nIndexCtx,P_sTlvBuffer), iVar5 == 0)) {
            iVar5 = AmountMng(P_nIndexCtx,P_sServGatewayFlag,P_sBillCalculFlag,P_sTlvBuffer);
            if (iVar5 != 0) goto LAB_0044dc00;
            iVar5 = CheckLimits(P_nIndexCtx,"OFF",P_sTlvBuffer,sAlternAmount);
            if ((iVar5 == 0) && (iVar5 = PrepaidCheckAccount(P_nIndexCtx,P_sTlvBuffer), iVar5 == 0))
            {
              PutTlvBuffer("039",P_sTlvBuffer,"000",3);
              PrintTlvBuffer(P_sTlvBuffer);
              cVar9 = 'N';
              goto LAB_0044d6a5;
            }
            goto LAB_0044d69f;
          }
        }
      }
      else {
        iVar5 = GetTlvBuffer("203",P_sTlvBuffer,__s,&nLength);
        if (iVar5 != 0) {
LAB_0044d69f:
          cVar9 = 'N';
LAB_0044d6a5:
          iVar5 = OctAuthorLocal(P_nIndexCtx,P_sTlvBuffer,P_psIsoInfo,P_sMyResource,sPrimResource,
                                 cVar9);
          return iVar5;
        }
        iVar5 = memcmp(__s,&DAT_004caed9,3);
        if (iVar5 == 0) {
          iVar5 = AmountMng(P_nIndexCtx,P_sServGatewayFlag,P_sBillCalculFlag,P_sTlvBuffer);
          if (iVar5 == 0) {
LAB_0044d81a:
            PrintTlvBuffer(P_sTlvBuffer);
            iVar5 = CheckResource(P_nIndexCtx,sPrimResource,&nPid);
            if ((iVar5 == 0) &&
               ((iVar5 = kill(nPid,0), iVar5 == 0 ||
                (iVar5 = memcmp(ResourceId,"050000",6), iVar5 == 0)))) {
              trace_event("Primary Ressource Up ",5);
              iVar5 = CardInSaf(P_nIndexCtx,slCardNumber);
              if (iVar5 != 0) {
                iVar5 = AuthorRouting(P_nIndexCtx,P_sTlvBuffer,sPrimResource,nPid,P_psIsoInfo);
                return iVar5;
              }
              PutTlvBuffer("025",P_sTlvBuffer,"1005",4);
              sprintf(sLine,"Card [%s] Found In Saf File ",slCardNumber);
              trace_event(sLine,5);
            }
            else {
              PutTlvBuffer("025",P_sTlvBuffer,"1004",4);
              trace_event("Primary Ressource Down ",5);
            }
            iVar5 = memcmp(sSecResource,"000000",6);
            if (iVar5 == 0) {
              __s = "801";
              goto LAB_0044da23;
            }
            iVar5 = memcmp(sSecResource,"000001",6);
            if (iVar5 != 0) {
              iVar5 = CheckResource(P_nIndexCtx,sSecResource,&nPid);
              if (iVar5 == 0) {
                iVar5 = AuthorRouting(P_nIndexCtx,P_sTlvBuffer,sSecResource,nPid,P_psIsoInfo);
                return iVar5;
              }
              PutTlvBuffer("203",P_sTlvBuffer,"801",3);
              cVar9 = 'N';
              goto LAB_0044d6a5;
            }
            trace_event("Secondary Resource : STAND_IN AUTHORISATION PROCESSING",5);
            iVar5 = GetSecurityFlags(P_nIndexCtx,P_sTlvBuffer,"OFF");
            if (iVar5 == 0) {
              iVar5 = OctAuthorLocal(P_nIndexCtx,P_sTlvBuffer,P_psIsoInfo,P_sMyResource,
                                     sPrimResource,'S');
              return iVar5;
            }
          }
          else {
LAB_0044dc00:
            trace_event("Retour AmountMng NOK ",5);
          }
        }
        else {
          iVar5 = GetSecurityFlags(P_nIndexCtx,P_sTlvBuffer,"ON");
          if (iVar5 != 0) {
            PutTlvBuffer("025",P_sTlvBuffer,"1006",4);
            goto LAB_0044d69f;
          }
          PutTlvBuffer("365",P_sTlvBuffer,"N",1);
          iVar5 = PreControl(P_nIndexCtx,P_sTlvBuffer);
          if (iVar5 == 0) {
            iVar5 = CheckOctAcceptance(P_nIndexCtx,P_sTlvBuffer,slCardNumber);
            PrintTlvBuffer(P_sTlvBuffer);
            if (iVar5 == 0) {
              PrintTlvBuffer(P_sTlvBuffer);
              iVar5 = AmountMng(P_nIndexCtx,P_sServGatewayFlag,P_sBillCalculFlag,P_sTlvBuffer);
              if (iVar5 == 0) {
                iVar5 = CheckLimits(P_nIndexCtx,"ON",P_sTlvBuffer,sAlternAmount);
                if (iVar5 != 0) {
                  PutTlvBuffer("025",P_sTlvBuffer,"1006",4);
                  cVar9 = 'S';
                  goto LAB_0044d6a5;
                }
                goto LAB_0044d81a;
              }
              PutTlvBuffer("025",P_sTlvBuffer,"1006",4);
              goto LAB_0044dc00;
            }
          }
        }
      }
    }
    else {
      sprintf(__s,"%03d",(ulong)uVar6);
      PutTlvBuffer("025",P_sTlvBuffer,"1006",4);
LAB_0044da23:
      PutTlvBuffer("203",P_sTlvBuffer,__s,3);
    }
  }
  cVar9 = 'N';
LAB_0044da3e:
  OctAuthorLocal(P_nIndexCtx,P_sTlvBuffer,P_psIsoInfo,P_sMyResource,sPrimResource,cVar9);
  return -1;
}



// WARNING: Unknown calling convention

int AuthorProcessing(int nIndiceCtx,char *sMyResource,char *sTlvBuffer,TSIsoInfo *sIsoMsg,
                    char *sReasonCode)

{
  int iVar1;
  long lVar2;
  char *pcVar3;
  byte bVar4;
  char sAlternAmount [65];
  
  bVar4 = 0;
  trace_event("Start AuthorProcessing()",5);
  pcVar3 = sAlternAmount;
  for (lVar2 = 8; lVar2 != 0; lVar2 = lVar2 + -1) {
    *(undefined8 *)pcVar3 = 0;
    pcVar3 = (char *)((long)pcVar3 + ((ulong)bVar4 * -2 + 1) * 8);
  }
  *pcVar3 = 0;
  DelTlvBuffer("039",sTlvBuffer);
  PrintTlvBuffer(sTlvBuffer);
  iVar1 = GetSecurityFlags(nIndiceCtx,sTlvBuffer,"OFF");
  if (iVar1 == 0) {
    iVar1 = PreControl(nIndiceCtx,sTlvBuffer);
    if (iVar1 == 0) {
      iVar1 = CheckSecurity(nIndiceCtx,sTlvBuffer);
      if (iVar1 == 0) {
        iVar1 = CheckLimits(nIndiceCtx,"OFF",sTlvBuffer,sAlternAmount);
        if (iVar1 == 0) {
          iVar1 = CheckAccAvailable(nIndiceCtx,sTlvBuffer);
          if (iVar1 == 0) {
            AuthorUpdate(nIndiceCtx,sTlvBuffer,sIsoMsg,sMyResource,sReasonCode,'S');
            trace_event("End   AuthorProcessing(OK)",5);
            iVar1 = 0;
          }
          else {
            iVar1 = AuthorUpdate(nIndiceCtx,sTlvBuffer,sIsoMsg,sMyResource,sReasonCode,'S');
            trace_event("End   AuthorProcessing(ERROR CHECK AVAILABLE)",5);
          }
        }
        else {
          iVar1 = AuthorUpdate(nIndiceCtx,sTlvBuffer,sIsoMsg,sMyResource,sReasonCode,'S');
          trace_event("End   AuthorProcessing(ERROR CHECK LIMITS )",5);
        }
      }
      else {
        iVar1 = AuthorUpdate(nIndiceCtx,sTlvBuffer,sIsoMsg,sMyResource,sReasonCode,'S');
        trace_event("End   AuthorProcessing(ERROR CHECK SECURITY)",5);
      }
    }
    else {
      iVar1 = AuthorUpdate(nIndiceCtx,sTlvBuffer,sIsoMsg,sMyResource,sReasonCode,'S');
      trace_event("End   AuthorProcessing(ERROR PRE-CONTROL)",5);
    }
  }
  else {
    iVar1 = AuthorUpdate(nIndiceCtx,sTlvBuffer,sIsoMsg,sMyResource,sReasonCode,'S');
    trace_event("End   AuthorProcessing(ERROR SECURITY FLAGS)",5);
  }
  return iVar1;
}



// WARNING: Type propagation algorithm not settling
// WARNING: Unknown calling convention

int IssuerTimeOutProcessing(int nIndiceCtx,char *sMyResource,char *sTlvBuffer,TSIsoInfo *sIsoMsg)

{
  int iVar1;
  uint uVar2;
  long lVar3;
  ulong uVar4;
  ulong uVar5;
  char *pcVar6;
  char *pcVar7;
  bool bVar8;
  byte bVar9;
  char sEventCode [4];
  char sActionCode [4];
  int nLength;
  char sPrimResource [7];
  char sSecResource [7];
  char sLine [512];
  char sTlvPrivateBuffer [1000];
  TSTlvPrivate sTlvPrivateInfo;
  TSTlvAutho tlvInfo;
  
  bVar9 = 0;
  trace_event("Start IssuerTimeOutProcessing()",5);
  sSecResource[4] = '\0';
  sSecResource[5] = '\0';
  sPrimResource[4] = '\0';
  sPrimResource[5] = '\0';
  pcVar6 = sTlvPrivateBuffer;
  for (lVar3 = 0x7d; lVar3 != 0; lVar3 = lVar3 + -1) {
    pcVar6[0] = '\0';
    pcVar6[1] = '\0';
    pcVar6[2] = '\0';
    pcVar6[3] = '\0';
    pcVar6[4] = '\0';
    pcVar6[5] = '\0';
    pcVar6[6] = '\0';
    pcVar6[7] = '\0';
    pcVar6 = pcVar6 + (ulong)bVar9 * -0x10 + 8;
  }
  sPrimResource[0] = '\0';
  sPrimResource[1] = '\0';
  sPrimResource[2] = '\0';
  sPrimResource[3] = '\0';
  sPrimResource[6] = '\0';
  sSecResource[0] = '\0';
  sSecResource[1] = '\0';
  sSecResource[2] = '\0';
  sSecResource[3] = '\0';
  sSecResource[6] = '\0';
  InitTlvAutho(&tlvInfo);
  AnalyseTlvAutho(sTlvBuffer,&tlvInfo);
  PutTlvAutho("203",&tlvInfo,"801",3);
  PutTlvAutho("039",&tlvInfo,"912",3);
  PutTlvAutho("277",&tlvInfo,"P",1);
  PutTlvAutho("255",&tlvInfo,"E2",2);
  PutTlvAutho("025",&tlvInfo,"1002",4);
  bVar8 = ((ulong)sTlvBuffer & 1) != 0;
  uVar5 = 0x1000;
  iVar1 = 0x1000;
  if (bVar8) {
    *sTlvBuffer = '\0';
    uVar5 = 0xfff;
    iVar1 = 0xfff;
    uVar4 = (ulong)(sTlvBuffer + 1) & 2;
    pcVar6 = sTlvBuffer + 1;
  }
  else {
    uVar4 = (ulong)sTlvBuffer & 2;
    pcVar6 = sTlvBuffer;
  }
  if (uVar4 == 0) {
    uVar2 = (uint)uVar5;
  }
  else {
    uVar2 = iVar1 - 2;
    uVar5 = (ulong)uVar2;
    pcVar6[0] = '\0';
    pcVar6[1] = '\0';
    pcVar6 = pcVar6 + 2;
  }
  if (((ulong)pcVar6 & 4) != 0) {
    pcVar6[0] = '\0';
    pcVar6[1] = '\0';
    pcVar6[2] = '\0';
    pcVar6[3] = '\0';
    uVar5 = (ulong)(uVar2 - 4);
    pcVar6 = pcVar6 + 4;
  }
  for (uVar4 = uVar5 >> 3; uVar4 != 0; uVar4 = uVar4 - 1) {
    pcVar6[0] = '\0';
    pcVar6[1] = '\0';
    pcVar6[2] = '\0';
    pcVar6[3] = '\0';
    pcVar6[4] = '\0';
    pcVar6[5] = '\0';
    pcVar6[6] = '\0';
    pcVar6[7] = '\0';
    pcVar6 = pcVar6 + (ulong)bVar9 * -0x10 + 8;
  }
  if ((uVar5 & 4) != 0) {
    pcVar6[0] = '\0';
    pcVar6[1] = '\0';
    pcVar6[2] = '\0';
    pcVar6[3] = '\0';
    pcVar6 = pcVar6 + 4;
  }
  pcVar7 = pcVar6;
  if ((uVar5 & 2) != 0) {
    pcVar7 = pcVar6 + 2;
    pcVar6[0] = '\0';
    pcVar6[1] = '\0';
  }
  if (bVar8) {
    *pcVar7 = '\0';
  }
  AuthoBuildTlv(sTlvBuffer,&tlvInfo);
  iVar1 = GetTlvAutho("048",&tlvInfo,sTlvPrivateBuffer,&nLength);
  if (iVar1 == 0) {
    InitTlvPrivate(&sTlvPrivateInfo);
    AnalyseTlvPrivate(sTlvPrivateBuffer,nLength,&sTlvPrivateInfo);
    iVar1 = GetTlvPrivate("P94",&sTlvPrivateInfo,sSecResource,&nLength);
    if (iVar1 == 0) {
      iVar1 = memcmp(sSecResource,"000001",6);
      if (iVar1 == 0) {
        PrintTlvBuffer(sTlvBuffer);
        AuthorProcessing(nIndiceCtx,sMyResource,sTlvBuffer,sIsoMsg,"1002");
        iVar1 = GetTlvAutho("200",&tlvInfo,sPrimResource,&nLength);
        if (iVar1 != 0) {
          builtin_strncpy(sPrimResource,"000001",6);
          trace_event("Primary Resource Not Found In TLV DATA",0);
        }
        uVar2 = AutSafProcessing(nIndiceCtx,sTlvBuffer,sMyResource,sPrimResource);
        sprintf(sLine,"End   IssuerTimeOutProcessing(StandInProcessing %d)",(ulong)uVar2);
        trace_event(sLine,5);
      }
      else {
        TlvToIso(nIndiceCtx,&tlvInfo,sIsoMsg,'\x01');
        bVar8 = ((ulong)sTlvBuffer & 1) != 0;
        uVar5 = 0x1000;
        pcVar6 = sTlvBuffer;
        if (bVar8) {
          *sTlvBuffer = '\0';
          pcVar6 = sTlvBuffer + 1;
          uVar5 = 0xfff;
        }
        pcVar7 = pcVar6;
        if (((ulong)pcVar6 & 2) != 0) {
          pcVar7 = pcVar6 + 2;
          uVar5 = (ulong)((int)uVar5 - 2);
          pcVar6[0] = '\0';
          pcVar6[1] = '\0';
        }
        if (((ulong)pcVar7 & 4) != 0) {
          pcVar7[0] = '\0';
          pcVar7[1] = '\0';
          pcVar7[2] = '\0';
          pcVar7[3] = '\0';
          uVar5 = (ulong)((int)uVar5 - 4);
          pcVar7 = pcVar7 + 4;
        }
        for (uVar4 = uVar5 >> 3; uVar4 != 0; uVar4 = uVar4 - 1) {
          pcVar7[0] = '\0';
          pcVar7[1] = '\0';
          pcVar7[2] = '\0';
          pcVar7[3] = '\0';
          pcVar7[4] = '\0';
          pcVar7[5] = '\0';
          pcVar7[6] = '\0';
          pcVar7[7] = '\0';
          pcVar7 = pcVar7 + (ulong)bVar9 * -0x10 + 8;
        }
        if ((uVar5 & 4) != 0) {
          pcVar7[0] = '\0';
          pcVar7[1] = '\0';
          pcVar7[2] = '\0';
          pcVar7[3] = '\0';
          pcVar7 = pcVar7 + 4;
        }
        if ((uVar5 & 2) != 0) {
          pcVar7[0] = '\0';
          pcVar7[1] = '\0';
          pcVar7 = pcVar7 + 2;
        }
        if (bVar8) {
          *pcVar7 = '\0';
        }
        AuthoBuildTlv(sTlvBuffer,&tlvInfo);
        UpdateAuthoActivity(nIndiceCtx,sTlvBuffer);
        sprintf(sLine,"End   IssuerTimeOutProcessing(Secondary Resource %s Not StandIn)",
                sSecResource);
        trace_event(sLine,5);
        uVar2 = 0;
      }
    }
    else {
      TlvToIso(nIndiceCtx,&tlvInfo,sIsoMsg,'\x01');
      bVar8 = ((ulong)sTlvBuffer & 1) != 0;
      uVar5 = 0x1000;
      pcVar6 = sTlvBuffer;
      if (bVar8) {
        *sTlvBuffer = '\0';
        pcVar6 = sTlvBuffer + 1;
        uVar5 = 0xfff;
      }
      pcVar7 = pcVar6;
      if (((ulong)pcVar6 & 2) != 0) {
        pcVar7 = pcVar6 + 2;
        uVar5 = (ulong)((int)uVar5 - 2);
        pcVar6[0] = '\0';
        pcVar6[1] = '\0';
      }
      if (((ulong)pcVar7 & 4) != 0) {
        pcVar7[0] = '\0';
        pcVar7[1] = '\0';
        pcVar7[2] = '\0';
        pcVar7[3] = '\0';
        uVar5 = (ulong)((int)uVar5 - 4);
        pcVar7 = pcVar7 + 4;
      }
      for (uVar4 = uVar5 >> 3; uVar4 != 0; uVar4 = uVar4 - 1) {
        pcVar7[0] = '\0';
        pcVar7[1] = '\0';
        pcVar7[2] = '\0';
        pcVar7[3] = '\0';
        pcVar7[4] = '\0';
        pcVar7[5] = '\0';
        pcVar7[6] = '\0';
        pcVar7[7] = '\0';
        pcVar7 = pcVar7 + (ulong)bVar9 * -0x10 + 8;
      }
      if ((uVar5 & 4) != 0) {
        pcVar7[0] = '\0';
        pcVar7[1] = '\0';
        pcVar7[2] = '\0';
        pcVar7[3] = '\0';
        pcVar7 = pcVar7 + 4;
      }
      pcVar6 = pcVar7;
      if ((uVar5 & 2) != 0) {
        pcVar6 = pcVar7 + 2;
        pcVar7[0] = '\0';
        pcVar7[1] = '\0';
      }
      if (bVar8) {
        *pcVar6 = '\0';
      }
      uVar2 = 0xffffffff;
      AuthoBuildTlv(sTlvBuffer,&tlvInfo);
      AuthorUpdate(nIndiceCtx,sTlvBuffer,sIsoMsg,sMyResource,"1002",'S');
      trace_event("End   IssuerTimeOutProcessing(Secondary Resource Not Found)",0);
    }
  }
  else {
    uVar2 = 0xffffffff;
    TlvToIso(nIndiceCtx,&tlvInfo,sIsoMsg,'\x01');
    trace_event("End   IssuerTimeOutProcessing(Field 48 Not Found In TLV)",0);
  }
  return uVar2;
}



// WARNING: Type propagation algorithm not settling
// WARNING: Unknown calling convention

int SystemMalfunctionProcessing
              (int nIndiceCtx,char *sMyResource,char *sTlvBuffer,TSIsoInfo *sIsoMsg)

{
  int iVar1;
  uint uVar2;
  long lVar3;
  ulong uVar4;
  ulong uVar5;
  char *pcVar6;
  char *pcVar7;
  bool bVar8;
  byte bVar9;
  char sEventCode [4];
  char sActionCode [4];
  int nLength;
  char sPrimResource [7];
  char sSecResource [7];
  char sLine [512];
  char sTlvPrivateBuffer [1000];
  TSTlvPrivate sTlvPrivateInfo;
  TSTlvAutho tlvInfo;
  
  bVar9 = 0;
  sprintf(sLine,"Start DynamicStandinProcessing(%s)",sMyResource);
  trace_event(sLine,5);
  sSecResource[4] = '\0';
  sSecResource[5] = '\0';
  sPrimResource[4] = '\0';
  sPrimResource[5] = '\0';
  sActionCode[0] = '\0';
  sActionCode[1] = '\0';
  sActionCode[2] = '\0';
  sActionCode[3] = '\0';
  pcVar6 = sTlvPrivateBuffer;
  for (lVar3 = 0x7d; lVar3 != 0; lVar3 = lVar3 + -1) {
    pcVar6[0] = '\0';
    pcVar6[1] = '\0';
    pcVar6[2] = '\0';
    pcVar6[3] = '\0';
    pcVar6[4] = '\0';
    pcVar6[5] = '\0';
    pcVar6[6] = '\0';
    pcVar6[7] = '\0';
    pcVar6 = pcVar6 + (ulong)bVar9 * -0x10 + 8;
  }
  sPrimResource[0] = '\0';
  sPrimResource[1] = '\0';
  sPrimResource[2] = '\0';
  sPrimResource[3] = '\0';
  sPrimResource[6] = '\0';
  sSecResource[0] = '\0';
  sSecResource[1] = '\0';
  sSecResource[2] = '\0';
  sSecResource[3] = '\0';
  sSecResource[6] = '\0';
  InitTlvAutho(&tlvInfo);
  AnalyseTlvAutho(sTlvBuffer,&tlvInfo);
  PutTlvAutho("203",&tlvInfo,"902",3);
  PutTlvAutho("039",&tlvInfo,"909",3);
  bVar8 = ((ulong)sTlvBuffer & 1) != 0;
  uVar5 = 0x1000;
  iVar1 = 0x1000;
  if (bVar8) {
    *sTlvBuffer = '\0';
    uVar5 = 0xfff;
    iVar1 = 0xfff;
    uVar4 = (ulong)(sTlvBuffer + 1) & 2;
    pcVar6 = sTlvBuffer + 1;
  }
  else {
    uVar4 = (ulong)sTlvBuffer & 2;
    pcVar6 = sTlvBuffer;
  }
  if (uVar4 == 0) {
    uVar2 = (uint)uVar5;
  }
  else {
    uVar2 = iVar1 - 2;
    uVar5 = (ulong)uVar2;
    pcVar6[0] = '\0';
    pcVar6[1] = '\0';
    pcVar6 = pcVar6 + 2;
  }
  if (((ulong)pcVar6 & 4) != 0) {
    pcVar6[0] = '\0';
    pcVar6[1] = '\0';
    pcVar6[2] = '\0';
    pcVar6[3] = '\0';
    uVar5 = (ulong)(uVar2 - 4);
    pcVar6 = pcVar6 + 4;
  }
  for (uVar4 = uVar5 >> 3; uVar4 != 0; uVar4 = uVar4 - 1) {
    pcVar6[0] = '\0';
    pcVar6[1] = '\0';
    pcVar6[2] = '\0';
    pcVar6[3] = '\0';
    pcVar6[4] = '\0';
    pcVar6[5] = '\0';
    pcVar6[6] = '\0';
    pcVar6[7] = '\0';
    pcVar6 = pcVar6 + (ulong)bVar9 * -0x10 + 8;
  }
  if ((uVar5 & 4) != 0) {
    pcVar6[0] = '\0';
    pcVar6[1] = '\0';
    pcVar6[2] = '\0';
    pcVar6[3] = '\0';
    pcVar6 = pcVar6 + 4;
  }
  pcVar7 = pcVar6;
  if ((uVar5 & 2) != 0) {
    pcVar7 = pcVar6 + 2;
    pcVar6[0] = '\0';
    pcVar6[1] = '\0';
  }
  if (bVar8) {
    *pcVar7 = '\0';
  }
  AuthoBuildTlv(sTlvBuffer,&tlvInfo);
  iVar1 = GetTlvAutho("048",&tlvInfo,sTlvPrivateBuffer,&nLength);
  if (iVar1 == 0) {
    InitTlvPrivate(&sTlvPrivateInfo);
    AnalyseTlvPrivate(sTlvPrivateBuffer,nLength,&sTlvPrivateInfo);
    iVar1 = GetTlvPrivate("P94",&sTlvPrivateInfo,sSecResource,&nLength);
    if (iVar1 == 0) {
      iVar1 = memcmp(sSecResource,"000001",6);
      if (iVar1 == 0) {
        PrintTlvBuffer(sTlvBuffer);
        PutTlvAutho("277",&tlvInfo,"P",1);
        PutTlvAutho("255",&tlvInfo,"E2",2);
        PutTlvAutho("025",&tlvInfo,"1003",4);
        iVar1 = GetTlvAutho("200",&tlvInfo,sPrimResource,&nLength);
        if (iVar1 != 0) {
          builtin_strncpy(sPrimResource,"000001",6);
          trace_event("Primary Resource Not Found In TLV DATA",0);
        }
        sPrimResource[6] = '\0';
        iVar1 = CheckDynamicAdvice(nIndiceCtx,sPrimResource);
        if (iVar1 == 0) {
          AuthorProcessing(nIndiceCtx,sMyResource,sTlvBuffer,sIsoMsg,"1003");
          iVar1 = GetActionCode(nIndiceCtx,sTlvBuffer,sActionCode);
          if (iVar1 != 0) {
            sActionCode[0] = '\0';
            sActionCode[1] = '\0';
            sActionCode[2] = '9';
            sActionCode[0] = '9';
            sActionCode[1] = '0';
          }
          PutIsoField(0x26,sIsoMsg,sActionCode,3);
        }
        else {
          iVar1 = UpdateAuthoActivity(nIndiceCtx,sTlvBuffer);
          if (iVar1 != 0) {
            PutTlvBuffer("288",sTlvBuffer,"SAF",3);
            InsertionAuthoActivity(nIndiceCtx,sTlvBuffer);
            trace_event("Can Not Update Autho Activity File ",5);
            return -1;
          }
          UpdateCardActivity(nIndiceCtx,'1',sTlvBuffer);
        }
        uVar2 = AutSafProcessing(nIndiceCtx,sTlvBuffer,sMyResource,sPrimResource);
        InitTlvAutho(&tlvInfo);
        AnalyseTlvAutho(sTlvBuffer,&tlvInfo);
        sprintf(sLine,"End   DynamicStandinProcessing(StandInProcessing %d)",(ulong)uVar2);
        trace_event(sLine,5);
      }
      else {
        PutTlvAutho("277",&tlvInfo,"P",1);
        PutTlvAutho("255",&tlvInfo,"E0",2);
        TlvToIso(nIndiceCtx,&tlvInfo,sIsoMsg,'\x01');
        bVar8 = ((ulong)sTlvBuffer & 1) != 0;
        uVar5 = 0x1000;
        pcVar6 = sTlvBuffer;
        if (bVar8) {
          *sTlvBuffer = '\0';
          pcVar6 = sTlvBuffer + 1;
          uVar5 = 0xfff;
        }
        pcVar7 = pcVar6;
        if (((ulong)pcVar6 & 2) != 0) {
          pcVar7 = pcVar6 + 2;
          uVar5 = (ulong)((int)uVar5 - 2);
          pcVar6[0] = '\0';
          pcVar6[1] = '\0';
        }
        if (((ulong)pcVar7 & 4) != 0) {
          pcVar7[0] = '\0';
          pcVar7[1] = '\0';
          pcVar7[2] = '\0';
          pcVar7[3] = '\0';
          uVar5 = (ulong)((int)uVar5 - 4);
          pcVar7 = pcVar7 + 4;
        }
        for (uVar4 = uVar5 >> 3; uVar4 != 0; uVar4 = uVar4 - 1) {
          pcVar7[0] = '\0';
          pcVar7[1] = '\0';
          pcVar7[2] = '\0';
          pcVar7[3] = '\0';
          pcVar7[4] = '\0';
          pcVar7[5] = '\0';
          pcVar7[6] = '\0';
          pcVar7[7] = '\0';
          pcVar7 = pcVar7 + (ulong)bVar9 * -0x10 + 8;
        }
        if ((uVar5 & 4) != 0) {
          pcVar7[0] = '\0';
          pcVar7[1] = '\0';
          pcVar7[2] = '\0';
          pcVar7[3] = '\0';
          pcVar7 = pcVar7 + 4;
        }
        if ((uVar5 & 2) != 0) {
          pcVar7[0] = '\0';
          pcVar7[1] = '\0';
          pcVar7 = pcVar7 + 2;
        }
        if (bVar8) {
          *pcVar7 = '\0';
        }
        AuthoBuildTlv(sTlvBuffer,&tlvInfo);
        UpdateAuthoActivity(nIndiceCtx,sTlvBuffer);
        sprintf(sLine,"End   DynamicStandinProcessing(Secondary Resource %s Not StandIn)",
                sSecResource);
        trace_event(sLine,5);
        uVar2 = 0;
      }
    }
    else {
      TlvToIso(nIndiceCtx,&tlvInfo,sIsoMsg,'\x01');
      bVar8 = ((ulong)sTlvBuffer & 1) != 0;
      uVar5 = 0x1000;
      pcVar6 = sTlvBuffer;
      if (bVar8) {
        *sTlvBuffer = '\0';
        pcVar6 = sTlvBuffer + 1;
        uVar5 = 0xfff;
      }
      pcVar7 = pcVar6;
      if (((ulong)pcVar6 & 2) != 0) {
        pcVar7 = pcVar6 + 2;
        uVar5 = (ulong)((int)uVar5 - 2);
        pcVar6[0] = '\0';
        pcVar6[1] = '\0';
      }
      if (((ulong)pcVar7 & 4) != 0) {
        pcVar7[0] = '\0';
        pcVar7[1] = '\0';
        pcVar7[2] = '\0';
        pcVar7[3] = '\0';
        uVar5 = (ulong)((int)uVar5 - 4);
        pcVar7 = pcVar7 + 4;
      }
      for (uVar4 = uVar5 >> 3; uVar4 != 0; uVar4 = uVar4 - 1) {
        pcVar7[0] = '\0';
        pcVar7[1] = '\0';
        pcVar7[2] = '\0';
        pcVar7[3] = '\0';
        pcVar7[4] = '\0';
        pcVar7[5] = '\0';
        pcVar7[6] = '\0';
        pcVar7[7] = '\0';
        pcVar7 = pcVar7 + (ulong)bVar9 * -0x10 + 8;
      }
      if ((uVar5 & 4) != 0) {
        pcVar7[0] = '\0';
        pcVar7[1] = '\0';
        pcVar7[2] = '\0';
        pcVar7[3] = '\0';
        pcVar7 = pcVar7 + 4;
      }
      pcVar6 = pcVar7;
      if ((uVar5 & 2) != 0) {
        pcVar6 = pcVar7 + 2;
        pcVar7[0] = '\0';
        pcVar7[1] = '\0';
      }
      if (bVar8) {
        *pcVar6 = '\0';
      }
      uVar2 = 0xffffffff;
      AuthoBuildTlv(sTlvBuffer,&tlvInfo);
      AuthorUpdate(nIndiceCtx,sTlvBuffer,sIsoMsg,sMyResource,"1003",'S');
      trace_event("End   DynamicStandinProcessing(Secondary Resource Not Found)",0);
    }
  }
  else {
    uVar2 = 0xffffffff;
    TlvToIso(nIndiceCtx,&tlvInfo,sIsoMsg,'\x01');
    trace_event("End   DynamicStandinProcessing(Field 48 Not Found In TLV)",0);
  }
  return uVar2;
}



// WARNING: Unknown calling convention

int StandInAuthorisationX
              (int nIndiceCtx,char *sMyResource,char *sTlvBuffer,TSIsoInfo *sIsoMsg,char *autho_flag
              )

{
  int iVar1;
  long lVar2;
  char *pcVar3;
  byte bVar4;
  char sEventCode [4];
  char sActionCode [4];
  int nLength;
  char sPrimResource [7];
  char sSecResource [7];
  char sTlvPrivateBuffer [4097];
  char sAlternAmount [4097];
  TSTlvPrivate sTlvPrivateInfo;
  TSTlvAutho tlvInfo;
  
  bVar4 = 0;
  trace_event("Start StandInAuthorisation ()",5);
  sPrimResource[4] = '\0';
  sPrimResource[5] = '\0';
  sActionCode[0] = '\0';
  sActionCode[1] = '\0';
  sActionCode[2] = '\0';
  sActionCode[3] = '\0';
  pcVar3 = sTlvPrivateBuffer;
  for (lVar2 = 0x200; lVar2 != 0; lVar2 = lVar2 + -1) {
    pcVar3[0] = '\0';
    pcVar3[1] = '\0';
    pcVar3[2] = '\0';
    pcVar3[3] = '\0';
    pcVar3[4] = '\0';
    pcVar3[5] = '\0';
    pcVar3[6] = '\0';
    pcVar3[7] = '\0';
    pcVar3 = pcVar3 + (ulong)bVar4 * -0x10 + 8;
  }
  sPrimResource[0] = '\0';
  sPrimResource[1] = '\0';
  sPrimResource[2] = '\0';
  sPrimResource[3] = '\0';
  sSecResource[4] = '\0';
  sSecResource[5] = '\0';
  sPrimResource[6] = '\0';
  sSecResource[0] = '\0';
  sSecResource[1] = '\0';
  sSecResource[2] = '\0';
  sSecResource[3] = '\0';
  sSecResource[6] = '\0';
  *pcVar3 = '\0';
  InitTlvAutho(&tlvInfo);
  AnalyseTlvAutho(sTlvBuffer,&tlvInfo);
  iVar1 = GetTlvAutho("200",&tlvInfo,sPrimResource,&nLength);
  if ((iVar1 == 0) && (iVar1 = GetTlvAutho("048",&tlvInfo,sTlvPrivateBuffer,&nLength), iVar1 == 0))
  {
    InitTlvPrivate(&sTlvPrivateInfo);
    AnalyseTlvPrivate(sTlvPrivateBuffer,nLength,&sTlvPrivateInfo);
    iVar1 = GetTlvPrivate("P94",&sTlvPrivateInfo,sSecResource,&nLength);
    if (iVar1 == 0) {
      iVar1 = memcmp(sSecResource,"000001",6);
      if (iVar1 != 0) {
        if (*autho_flag == 'T') {
          PutTlvAutho("203",&tlvInfo,"801",3);
          pcVar3 = "912";
        }
        else {
          PutTlvAutho("203",&tlvInfo,"902",3);
          pcVar3 = "909";
        }
        PutTlvAutho("039",&tlvInfo,pcVar3,3);
        AuthoBuildTlv(sTlvBuffer,&tlvInfo);
        iVar1 = GetActionCode(nIndiceCtx,sTlvBuffer,sActionCode);
        if (iVar1 == 0) {
          PutTlvAutho("039",&tlvInfo,sActionCode,3);
        }
        else {
          PutTlvAutho("039",&tlvInfo,"909",3);
        }
        TlvToIso(nIndiceCtx,&tlvInfo,sIsoMsg,'\x01');
        PutTlvBuffer("277",sTlvBuffer,"T",1);
        PutTlvBuffer("255",sTlvBuffer,"E2",2);
        PutTlvBuffer("025",sTlvBuffer,"1002",4);
        UpdateAuthoActivity(nIndiceCtx,sTlvBuffer);
        trace_event("End   StandInAuthorisation()",5);
        return 0;
      }
      trace_event("Sec (Exception): STAND_IN Process",5);
      iVar1 = GetSecurityFlags(nIndiceCtx,sTlvBuffer,"OFF");
      if ((((iVar1 == 0) && (iVar1 = PreControl(nIndiceCtx,sTlvBuffer), iVar1 == 0)) &&
          (iVar1 = CheckSecurity(nIndiceCtx,sTlvBuffer), iVar1 == 0)) &&
         ((iVar1 = CheckLimits(nIndiceCtx,"OFF",sTlvBuffer,sAlternAmount), iVar1 == 0 &&
          (iVar1 = CheckAccAvailable(nIndiceCtx,sTlvBuffer), iVar1 != 0)))) {
        PutTlvBuffer("203",sTlvBuffer,"902",3);
      }
      iVar1 = AuthorUpdate(nIndiceCtx,sTlvBuffer,sIsoMsg,sMyResource,"1002",'S');
      return iVar1;
    }
  }
  if (*autho_flag == 'T') {
    PutTlvAutho("203",&tlvInfo,"801",3);
    PutTlvAutho("039",&tlvInfo,"912",3);
  }
  else {
    PutTlvAutho("203",&tlvInfo,"902",3);
    PutTlvAutho("039",&tlvInfo,"909",3);
  }
  iVar1 = GetActionCode(nIndiceCtx,sTlvBuffer,sActionCode);
  if (iVar1 == 0) {
    PutTlvAutho("039",&tlvInfo,sActionCode,3);
  }
  else {
    PutTlvAutho("039",&tlvInfo,"909",3);
  }
  TlvToIso(nIndiceCtx,&tlvInfo,sIsoMsg,'\x01');
  return 0;
}



// WARNING: Unknown calling convention

int BalanceInquiryProcessing
              (int nIndiceCtx,char *sMyResource,char *sAuthoTable,char *sAcquirerBank,
              char *InternationalRoutCheck,char *sServGatewayFlag,char *sBillCalculFlag,
              char *sTlvBuffer,TSIsoInfo *sIsoMsg)

{
  bool bVar1;
  char acVar2 [4];
  undefined4 uVar3;
  bool bVar4;
  int iVar5;
  uint uVar6;
  long lVar7;
  ulong uVar8;
  ulong uVar9;
  char *pcVar10;
  char *pcVar11;
  char SafIndicator;
  byte bVar12;
  char slFuncCode [4];
  char sEventCode [4];
  pid_t nPid;
  int nLength;
  char MerchantType [5];
  char slProcCode [7];
  char sPrimResource [7];
  char sSecResource [7];
  char sInternalStan [7];
  char sPid [9];
  char sSecurityResults [11];
  char sPosData [13];
  TSService rService;
  char slCardNumber [23];
  char sLine [512];
  char sSecurData [4096];
  char sAlternAmount [4097];
  TSTlvAutho sTlvInfo;
  
  bVar12 = 0;
  trace_event("Start BalanceInquiryProcessing()",5);
  pcVar10 = sSecurData;
  for (lVar7 = 0x200; lVar7 != 0; lVar7 = lVar7 + -1) {
    pcVar10[0] = '\0';
    pcVar10[1] = '\0';
    pcVar10[2] = '\0';
    pcVar10[3] = '\0';
    pcVar10[4] = '\0';
    pcVar10[5] = '\0';
    pcVar10[6] = '\0';
    pcVar10[7] = '\0';
    pcVar10 = pcVar10 + (ulong)bVar12 * -0x10 + 8;
  }
  slProcCode[4] = '\0';
  slProcCode[5] = '\0';
  slCardNumber[0x14] = '\0';
  slCardNumber[0x15] = '\0';
  rService.szDestAcc[1] = '\0';
  rService.szDestAcc[2] = '\0';
  sPrimResource[4] = '\0';
  sPrimResource[5] = '\0';
  sSecResource[4] = '\0';
  sSecResource[5] = '\0';
  slCardNumber[0] = '\0';
  slCardNumber[1] = '\0';
  slCardNumber[2] = '\0';
  slCardNumber[3] = '\0';
  slCardNumber[4] = '\0';
  slCardNumber[5] = '\0';
  slCardNumber[6] = '\0';
  slCardNumber[7] = '\0';
  slCardNumber[8] = '\0';
  slCardNumber[9] = '\0';
  slCardNumber[10] = '\0';
  slCardNumber[0xb] = '\0';
  slCardNumber[0xc] = '\0';
  slCardNumber[0xd] = '\0';
  slCardNumber[0xe] = '\0';
  slCardNumber[0xf] = '\0';
  slCardNumber[0x10] = '\0';
  slCardNumber[0x11] = '\0';
  slCardNumber[0x12] = '\0';
  slCardNumber[0x13] = '\0';
  pcVar10 = sAlternAmount;
  for (lVar7 = 0x200; lVar7 != 0; lVar7 = lVar7 + -1) {
    pcVar10[0] = '\0';
    pcVar10[1] = '\0';
    pcVar10[2] = '\0';
    pcVar10[3] = '\0';
    pcVar10[4] = '\0';
    pcVar10[5] = '\0';
    pcVar10[6] = '\0';
    pcVar10[7] = '\0';
    pcVar10 = pcVar10 + (ulong)bVar12 * -0x10 + 8;
  }
  slCardNumber[0x16] = '\0';
  slProcCode[0] = '\0';
  slProcCode[1] = '\0';
  slProcCode[2] = '\0';
  slProcCode[3] = '\0';
  slProcCode[6] = '\0';
  slFuncCode[0] = '\0';
  slFuncCode[1] = '\0';
  slFuncCode[2] = '\0';
  slFuncCode[3] = '\0';
  rService.szMti[0] = '\0';
  rService.szMti[1] = '\0';
  rService.szMti[2] = '\0';
  rService.szMti[3] = '\0';
  rService.szMti[4] = '\0';
  rService.szProcCode[0] = '\0';
  rService.szProcCode[1] = '\0';
  rService.szProcCode[2] = '\0';
  rService.szFctCode[0] = '\0';
  rService.szFctCode[1] = '\0';
  rService.szFctCode[2] = '\0';
  rService.szFctCode[3] = '\0';
  rService.szSrcAcc[0] = '\0';
  rService.szSrcAcc[1] = '\0';
  rService.szSrcAcc[2] = '\0';
  rService.szDestAcc[0] = '\0';
  sEventCode[0] = '\0';
  sEventCode[1] = '\0';
  sEventCode[2] = '\0';
  sEventCode[3] = '\0';
  sPrimResource[0] = '\0';
  sPrimResource[1] = '\0';
  sPrimResource[2] = '\0';
  sPrimResource[3] = '\0';
  sPrimResource[6] = '\0';
  sSecResource[0] = '\0';
  sSecResource[1] = '\0';
  sSecResource[2] = '\0';
  sSecResource[3] = '\0';
  *pcVar10 = '\0';
  sSecResource[6] = '\0';
  sPosData[0] = '\0';
  sPosData[1] = '\0';
  sPosData[2] = '\0';
  sPosData[3] = '\0';
  sPosData[4] = '\0';
  sPosData[5] = '\0';
  sPosData[6] = '\0';
  sPosData[7] = '\0';
  sPosData[8] = '\0';
  sPosData[9] = '\0';
  sPosData[10] = '\0';
  sPosData[0xb] = '\0';
  sPosData[0xc] = '\0';
  MerchantType[0] = '\0';
  MerchantType[1] = '\0';
  MerchantType[2] = '\0';
  MerchantType[3] = '\0';
  MerchantType[4] = '\0';
  InitTlvAutho(&sTlvInfo);
  sTlvBuffer[0] = '\0';
  sTlvBuffer[1] = '\0';
  sTlvBuffer[2] = '\0';
  sTlvBuffer[3] = '\0';
  sTlvBuffer[4] = '\0';
  sTlvBuffer[5] = '\0';
  sTlvBuffer[6] = '\0';
  sTlvBuffer[7] = '\0';
  uVar9 = 0x1000;
  bVar1 = false;
  iVar5 = 0x1000;
  if (((ulong)sTlvBuffer & 1) == 0) {
    pcVar10 = sTlvBuffer;
    bVar4 = false;
    if (((ulong)sTlvBuffer & 2) != 0) goto LAB_0044f848;
LAB_0044f0d8:
    uVar6 = (uint)uVar9;
  }
  else {
    pcVar10 = sTlvBuffer + 1;
    *sTlvBuffer = '\0';
    uVar9 = 0xfff;
    bVar1 = true;
    iVar5 = 0xfff;
    bVar4 = true;
    if (((ulong)pcVar10 & 2) == 0) goto LAB_0044f0d8;
LAB_0044f848:
    bVar1 = bVar4;
    uVar6 = iVar5 - 2;
    uVar9 = (ulong)uVar6;
    pcVar10[0] = '\0';
    pcVar10[1] = '\0';
    pcVar10 = pcVar10 + 2;
  }
  if (((ulong)pcVar10 & 4) != 0) {
    pcVar10[0] = '\0';
    pcVar10[1] = '\0';
    pcVar10[2] = '\0';
    pcVar10[3] = '\0';
    uVar9 = (ulong)(uVar6 - 4);
    pcVar10 = pcVar10 + 4;
  }
  for (uVar8 = uVar9 >> 3; uVar8 != 0; uVar8 = uVar8 - 1) {
    pcVar10[0] = '\0';
    pcVar10[1] = '\0';
    pcVar10[2] = '\0';
    pcVar10[3] = '\0';
    pcVar10[4] = '\0';
    pcVar10[5] = '\0';
    pcVar10[6] = '\0';
    pcVar10[7] = '\0';
    pcVar10 = pcVar10 + (ulong)bVar12 * -0x10 + 8;
  }
  if ((uVar9 & 4) != 0) {
    pcVar10[0] = '\0';
    pcVar10[1] = '\0';
    pcVar10[2] = '\0';
    pcVar10[3] = '\0';
    pcVar10 = pcVar10 + 4;
  }
  pcVar11 = pcVar10;
  if ((uVar9 & 2) != 0) {
    pcVar11 = pcVar10 + 2;
    pcVar10[0] = '\0';
    pcVar10[1] = '\0';
  }
  if (bVar1) {
    *pcVar11 = '\0';
  }
  iVar5 = IsoToTlv(nIndiceCtx,sIsoMsg,&sTlvInfo);
  if (iVar5 != 0) {
    trace_event("IsoToTlv Error ...",1);
    InsertIsoField(0x26,sIsoMsg,"909",3);
    return -1;
  }
  PutTlvAutho("288",&sTlvInfo,sAuthoTable,3);
  PutTlvAutho("201",&sTlvInfo,sMyResource,6);
  PutTlvAutho("253",&sTlvInfo,sAcquirerBank,6);
  PutTlvAutho("131",&sTlvInfo,InternationalRoutCheck,1);
  AuthoBuildTlv(sTlvBuffer,&sTlvInfo);
  PrintTlvBuffer(sTlvBuffer);
  iVar5 = GetOriginalDataElements(nIndiceCtx,"C",sTlvBuffer,sPrimResource);
  if (iVar5 == 0) {
    trace_event("Found a Duplicate Request. ",5);
    PutTlvBuffer("039",sTlvBuffer,"308",3);
    PutTlvBuffer("038",sTlvBuffer,"      ",6);
    InitTlvAutho(&sTlvInfo);
    AnalyseTlvAutho(sTlvBuffer,&sTlvInfo);
    TlvToIso(nIndiceCtx,&sTlvInfo,sIsoMsg,'\x01');
    return 0;
  }
  PutTlvBuffer("203",sTlvBuffer,"902",3);
  iVar5 = LoadIssuerData(nIndiceCtx,sTlvBuffer,InternationalRoutCheck,sPrimResource,sSecResource);
  sprintf(sLine,"Primary Resource    ...%.6s ",sPrimResource);
  trace_event(sLine,5);
  sprintf(sLine,"Secondarry Resource ...%.6s ",sSecResource);
  trace_event(sLine,5);
  if (iVar5 != 0) goto LAB_0044f4cf;
  PutTlvBuffer("200",sTlvBuffer,sPrimResource,6);
  GetIsoField(1,sIsoMsg,slCardNumber,&nLength);
  GetIsoField(2,sIsoMsg,slProcCode,&nLength);
  GetIsoField(0x17,sIsoMsg,slFuncCode,&nLength);
  sprintf(rService.szMti,"%04d",(ulong)(uint)sIsoMsg->nMsgType);
  uVar3 = slProcCode._0_4_;
  acVar2 = slFuncCode;
  nLength = 4;
  rService.szProcCode[0] = slProcCode[0];
  rService.szProcCode[1] = slProcCode[1];
  slProcCode._2_2_ = SUB42(uVar3,2);
  rService.szSrcAcc[0] = slProcCode[2];
  rService.szSrcAcc[1] = slProcCode[3];
  rService.szDestAcc[0] = (char)slProcCode._4_2_;
  rService.szDestAcc[1] = SUB21(slProcCode._4_2_,1);
  rService.szFctCode[0] = slFuncCode[0];
  rService.szFctCode[1] = slFuncCode[1];
  slFuncCode[2] = acVar2[2];
                    // WARNING: Ignoring partial resolution of indirect
  rService.szFctCode[2] = slFuncCode[2];
  slFuncCode = acVar2;
  slProcCode._0_4_ = uVar3;
  uVar6 = CheckResourceServices(nIndiceCtx,sMyResource,&rService);
  if (uVar6 == 0) {
    PrintTlvBuffer(sTlvBuffer);
    iVar5 = memcmp(sPrimResource,"000001",6);
    if (iVar5 == 0) {
      trace_event("Prm : STAND_IN AUTHORISATION PROCESSING",5);
      iVar5 = GetSecurityFlags(nIndiceCtx,sTlvBuffer,"OFF");
      if (((iVar5 == 0) && (iVar5 = PreControl(nIndiceCtx,sTlvBuffer), iVar5 == 0)) &&
         (iVar5 = CheckSecurity(nIndiceCtx,sTlvBuffer), iVar5 == 0)) {
        PrintTlvBuffer(sTlvBuffer);
        iVar5 = BalanceInquiry(nIndiceCtx,sTlvBuffer);
        if (iVar5 == 0) {
          GetIsoField(0x15,sIsoMsg,sPosData,&nLength);
          sprintf(sLine,"sPosData(%s) ",sPosData);
          trace_event(sLine,5);
          iVar5 = memcmp(sMyResource,&DAT_004d475e,2);
          if ((iVar5 != 0) || (sPosData[0xb] != '0')) {
LAB_0044f471:
            PrintTlvBuffer(sTlvBuffer);
            iVar5 = AuthorLocalAdm(nIndiceCtx,sTlvBuffer,sIsoMsg,sMyResource,sPrimResource,'N');
            return iVar5;
          }
          trace_event("check phone started  ecome ",5);
          iVar5 = CheckPhone(nIndiceCtx,slCardNumber,sTlvBuffer);
          if (iVar5 == 0) goto LAB_0044f471;
LAB_0044fa3e:
          iVar5 = 4;
          pcVar10 = "1006";
          pcVar11 = "025";
          goto LAB_0044f4ca;
        }
      }
    }
    else {
      iVar5 = GetTlvBuffer("203",sTlvBuffer,sEventCode,&nLength);
      if (iVar5 == 0) {
        iVar5 = memcmp(sEventCode,&DAT_004caed9,3);
        if (iVar5 != 0) {
          iVar5 = GetSecurityFlags(nIndiceCtx,sTlvBuffer,"ON");
          if (((iVar5 != 0) || (iVar5 = PreControl(nIndiceCtx,sTlvBuffer), iVar5 != 0)) ||
             (iVar5 = CheckSecurity(nIndiceCtx,sTlvBuffer), iVar5 != 0)) {
            PutTlvBuffer("025",sTlvBuffer,"1006",4);
            SafIndicator = 'S';
            goto LAB_0044f4d5;
          }
          GetIsoField(0x15,sIsoMsg,sPosData,&nLength);
          sprintf(sLine,"sPosData(%s) ",sPosData);
          trace_event(sLine,5);
          iVar5 = memcmp(sMyResource,&DAT_004d475e,2);
          if ((iVar5 == 0) && (sPosData[0xb] == '0')) {
            trace_event("check phone started  ecome ",5);
            iVar5 = CheckPhone(nIndiceCtx,slCardNumber,sTlvBuffer);
            if (iVar5 != 0) goto LAB_0044fa3e;
          }
          PrintTlvBuffer(sTlvBuffer);
        }
        iVar5 = CheckResource(nIndiceCtx,sPrimResource,&nPid);
        if ((iVar5 == 0) && (iVar5 = kill(nPid,0), iVar5 == 0)) {
          trace_event("Primary Ressource Up ",5);
          PutTlvBuffer("203",sTlvBuffer,"000",3);
          iVar5 = AuthorRouting(nIndiceCtx,sTlvBuffer,sPrimResource,nPid,sIsoMsg);
          return iVar5;
        }
        trace_event("Primary Ressource Down ",5);
        iVar5 = memcmp(sSecResource,"000000",6);
        if (iVar5 != 0) {
          iVar5 = memcmp(sSecResource,"000001",6);
          if (iVar5 == 0) {
            PutTlvBuffer("025",sTlvBuffer,"1004",4);
            trace_event("Sec : STAND_IN AUTHORISATION PROCESSING",5);
            iVar5 = GetSecurityFlags(nIndiceCtx,sTlvBuffer,"OFF");
            if (((iVar5 == 0) && (iVar5 = PreControl(nIndiceCtx,sTlvBuffer), iVar5 == 0)) &&
               (iVar5 = CheckSecurity(nIndiceCtx,sTlvBuffer), iVar5 == 0)) {
              PrintTlvBuffer(sTlvBuffer);
              iVar5 = BalanceInquiry(nIndiceCtx,sTlvBuffer);
              if (iVar5 == 0) {
                PrintTlvBuffer(sTlvBuffer);
                GetIsoField(0x15,sIsoMsg,sPosData,&nLength);
                sprintf(sLine,"sPosData(%s) ",sPosData);
                trace_event(sLine,5);
                iVar5 = memcmp(sMyResource,&DAT_004d475e,2);
                if ((iVar5 == 0) && (sPosData[0xb] == '0')) {
                  trace_event("check phone started  ecome ",5);
                  iVar5 = CheckPhone(nIndiceCtx,slCardNumber,sTlvBuffer);
                  if (iVar5 != 0) goto LAB_0044fa3e;
                }
                PrintTlvBuffer(sTlvBuffer);
                SafIndicator = 'S';
                goto LAB_0044f4d5;
              }
            }
          }
          else {
            iVar5 = CheckResource(nIndiceCtx,sSecResource,&nPid);
            if (iVar5 == 0) {
              PutTlvBuffer("203",sTlvBuffer,"000",3);
              iVar5 = AuthorRouting(nIndiceCtx,sTlvBuffer,sSecResource,nPid,sIsoMsg);
              return iVar5;
            }
            PutTlvBuffer("025",sTlvBuffer,"1004",4);
            PutTlvBuffer("203",sTlvBuffer,"801",3);
          }
          SafIndicator = 'S';
          goto LAB_0044f4d5;
        }
        PutTlvBuffer("025",sTlvBuffer,"1004",4);
        pcVar10 = "801";
        goto LAB_0044f4c0;
      }
    }
  }
  else {
    pcVar10 = sEventCode;
    sprintf(pcVar10,"%03d",(ulong)uVar6);
LAB_0044f4c0:
    iVar5 = 3;
    pcVar11 = "203";
LAB_0044f4ca:
    PutTlvBuffer(pcVar11,sTlvBuffer,pcVar10,iVar5);
  }
LAB_0044f4cf:
  SafIndicator = 'N';
LAB_0044f4d5:
  iVar5 = AuthorLocal(nIndiceCtx,sTlvBuffer,sIsoMsg,sMyResource,sPrimResource,SafIndicator);
  return iVar5;
}



// WARNING: Unknown calling convention

int ReversalProcessing(int nIndiceCtx,char *sMyResource,char *sAuthoTable,TSIsoInfo *IsoInfo,
                      char *sBillCalculation)

{
  undefined8 uVar1;
  undefined8 uVar2;
  int iVar3;
  long lVar4;
  char *pcVar5;
  byte bVar6;
  char sEventCode [4];
  char sActionCode [4];
  int nLength;
  char AddressVerfi [5];
  char sRoutingCode [7];
  char ReversalStan [7];
  char ProcCode [7];
  char AuthCode [7];
  char ReversalXmit [11];
  char PosCode [23];
  char OriginalDataElements [36];
  char Line [80];
  char tmpField [4096];
  char sTlvBuffer [4097];
  char sData [4097];
  TSTlvPrivate TlvPrivateInfo;
  TSTlvAutho sTlvInfo;
  
  bVar6 = 0;
  trace_event("Start ReversalProcessing()",5);
  AuthCode[4] = '\0';
  AuthCode[5] = '\0';
  sRoutingCode[4] = '\0';
  sRoutingCode[5] = '\0';
  ReversalXmit[8] = '\0';
  ReversalXmit[9] = '\0';
  ReversalStan[4] = '\0';
  ReversalStan[5] = '\0';
  ProcCode[4] = '\0';
  ProcCode[5] = '\0';
  sRoutingCode[0] = '\0';
  sRoutingCode[1] = '\0';
  sRoutingCode[2] = '\0';
  sRoutingCode[3] = '\0';
  sRoutingCode[6] = '\0';
  ReversalXmit[0] = '\0';
  ReversalXmit[1] = '\0';
  ReversalXmit[2] = '\0';
  ReversalXmit[3] = '\0';
  ReversalXmit[4] = '\0';
  ReversalXmit[5] = '\0';
  ReversalXmit[6] = '\0';
  ReversalXmit[7] = '\0';
  ReversalXmit[10] = '\0';
  ReversalStan[0] = '\0';
  ReversalStan[1] = '\0';
  ReversalStan[2] = '\0';
  ReversalStan[3] = '\0';
  ReversalStan[6] = '\0';
  OriginalDataElements[0] = '\0';
  OriginalDataElements[1] = '\0';
  OriginalDataElements[2] = '\0';
  OriginalDataElements[3] = '\0';
  OriginalDataElements[4] = '\0';
  OriginalDataElements[5] = '\0';
  OriginalDataElements[6] = '\0';
  OriginalDataElements[7] = '\0';
  OriginalDataElements[8] = '\0';
  OriginalDataElements[9] = '\0';
  OriginalDataElements[10] = '\0';
  OriginalDataElements[0xb] = '\0';
  OriginalDataElements[0xc] = '\0';
  OriginalDataElements[0xd] = '\0';
  OriginalDataElements[0xe] = '\0';
  OriginalDataElements[0xf] = '\0';
  OriginalDataElements[0x10] = '\0';
  OriginalDataElements[0x11] = '\0';
  OriginalDataElements[0x12] = '\0';
  OriginalDataElements[0x13] = '\0';
  OriginalDataElements[0x14] = '\0';
  OriginalDataElements[0x15] = '\0';
  OriginalDataElements[0x16] = '\0';
  OriginalDataElements[0x17] = '\0';
  OriginalDataElements[0x18] = '\0';
  OriginalDataElements[0x19] = '\0';
  OriginalDataElements[0x1a] = '\0';
  OriginalDataElements[0x1b] = '\0';
  OriginalDataElements[0x1c] = '\0';
  OriginalDataElements[0x1d] = '\0';
  OriginalDataElements[0x1e] = '\0';
  OriginalDataElements[0x1f] = '\0';
  OriginalDataElements[0x20] = '\0';
  OriginalDataElements[0x21] = '\0';
  OriginalDataElements[0x22] = '\0';
  OriginalDataElements[0x23] = '\0';
  AddressVerfi[0] = '\0';
  AddressVerfi[1] = '\0';
  AddressVerfi[2] = '\0';
  AddressVerfi[3] = '\0';
  AddressVerfi[4] = '\0';
  ProcCode[0] = '\0';
  ProcCode[1] = '\0';
  ProcCode[2] = '\0';
  ProcCode[3] = '\0';
  ProcCode[6] = '\0';
  AuthCode[0] = '\0';
  AuthCode[1] = '\0';
  AuthCode[2] = '\0';
  AuthCode[3] = '\0';
  AuthCode[6] = '\0';
  InitTlvAutho(&sTlvInfo);
  pcVar5 = sTlvBuffer;
  for (lVar4 = 0x200; lVar4 != 0; lVar4 = lVar4 + -1) {
    pcVar5[0] = '\0';
    pcVar5[1] = '\0';
    pcVar5[2] = '\0';
    pcVar5[3] = '\0';
    pcVar5[4] = '\0';
    pcVar5[5] = '\0';
    pcVar5[6] = '\0';
    pcVar5[7] = '\0';
    pcVar5 = pcVar5 + (ulong)bVar6 * -0x10 + 8;
  }
  *pcVar5 = '\0';
  IsoToTlv(nIndiceCtx,IsoInfo,&sTlvInfo);
  iVar3 = memcmp(sMyResource,&DAT_004d475e,2);
  if (iVar3 == 0) {
    iVar3 = GetIsoField(2,IsoInfo,ProcCode,&nLength);
    if (iVar3 == 0) {
      sprintf(Line,"ProcCode > [%s] ",ProcCode);
      trace_event(Line,5);
      iVar3 = memcmp(ProcCode,"00",2);
      if ((((iVar3 == 0) || (iVar3 = memcmp(ProcCode,&DAT_004a671d,2), iVar3 == 0)) ||
          (iVar3 = memcmp(ProcCode,"01",2), iVar3 == 0)) && (IsoInfo->nMsgType != 0x58c)) {
        trace_event("Cancelation STARTED ESTIMATED AMOUNT  ",5);
        GetIsoField(0x25,IsoInfo,AuthCode,&nLength);
        PutTlvAutho("038",&sTlvInfo,AuthCode,6);
        PutTlvAutho("288",&sTlvInfo,sAuthoTable,3);
        PutTlvAutho("201",&sTlvInfo,sMyResource,6);
      }
      iVar3 = memcmp(sMyResource,&DAT_004d475e,2);
      if ((iVar3 != 0) || (IsoInfo->nMsgType == 0x58c)) goto LAB_0044fc62;
LAB_0044fdaf:
      pcVar5 = sTlvBuffer;
      for (lVar4 = 0x200; lVar4 != 0; lVar4 = lVar4 + -1) {
        pcVar5[0] = '\0';
        pcVar5[1] = '\0';
        pcVar5[2] = '\0';
        pcVar5[3] = '\0';
        pcVar5[4] = '\0';
        pcVar5[5] = '\0';
        pcVar5[6] = '\0';
        pcVar5[7] = '\0';
        pcVar5 = pcVar5 + (ulong)bVar6 * -0x10 + 8;
      }
      *pcVar5 = '\0';
      AuthoBuildTlv(sTlvBuffer,&sTlvInfo);
      PrintTlvBuffer(sTlvBuffer);
      iVar3 = ReversalProcedure(nIndiceCtx,"N",sBillCalculation,sTlvBuffer,sMyResource,sRoutingCode)
      ;
      PrintTlvBuffer(sTlvBuffer);
      if (iVar3 == 0) {
        PutTlvBuffer("039",sTlvBuffer,"480",3);
        UpdateSettlement(nIndiceCtx,sTlvBuffer);
        PrintTlvBuffer(sTlvBuffer);
        iVar3 = memcmp(sRoutingCode,"000001",6);
        if (iVar3 != 0) {
          InsertionSaf(nIndiceCtx,sTlvBuffer,sMyResource,sRoutingCode);
        }
        InitTlvAutho(&sTlvInfo);
        AnalyseTlvAutho(sTlvBuffer,&sTlvInfo);
        TlvToIso(nIndiceCtx,&sTlvInfo,IsoInfo,'\x03');
        dump_p7_struct(IsoInfo);
        trace_event("End   ReversalProcessing(OK)",5);
        return 0;
      }
      iVar3 = GetActionCode(nIndiceCtx,sTlvBuffer,sActionCode);
      if (iVar3 == 0) {
        PutTlvBuffer("039",sTlvBuffer,sActionCode,3);
      }
      else {
        PutTlvBuffer("039",sTlvBuffer,"909",3);
      }
      PutTlvBuffer("288",sTlvBuffer,"MSC",3);
      PutTlvBuffer("200",sTlvBuffer,"000001",6);
      InsertionAuthoActivity(nIndiceCtx,sTlvBuffer);
      InitTlvAutho(&sTlvInfo);
      AnalyseTlvAutho(sTlvBuffer,&sTlvInfo);
      TlvToIso(nIndiceCtx,&sTlvInfo,IsoInfo,'\x03');
      goto LAB_004500cc;
    }
    PutIsoField(0x26,IsoInfo,"909",3);
    pcVar5 = "ERROR Processing Code Missing ..";
  }
  else {
LAB_0044fc62:
    trace_event("Cancelation  started with MTI 1420",5);
    iVar3 = GetIsoField(0x37,IsoInfo,OriginalDataElements,&nLength);
    if (iVar3 == 0) {
      iVar3 = GetIsoField(10,IsoInfo,ReversalStan,&nLength);
      if (iVar3 == 0) {
        iVar3 = GetIsoField(6,IsoInfo,ReversalXmit,&nLength);
        if (iVar3 == 0) {
          PutTlvAutho("288",&sTlvInfo,sAuthoTable,3);
          PutTlvAutho("201",&sTlvInfo,sMyResource,6);
          PutTlvAutho("129",&sTlvInfo,ReversalStan,6);
          PutTlvAutho("291",&sTlvInfo,ReversalXmit,10);
          uVar2 = OriginalDataElements._8_8_;
          uVar1 = OriginalDataElements._0_8_;
          pcVar5 = sData;
          for (lVar4 = 0x200; lVar4 != 0; lVar4 = lVar4 + -1) {
            pcVar5[0] = '\0';
            pcVar5[1] = '\0';
            pcVar5[2] = '\0';
            pcVar5[3] = '\0';
            pcVar5[4] = '\0';
            pcVar5[5] = '\0';
            pcVar5[6] = '\0';
            pcVar5[7] = '\0';
            pcVar5 = pcVar5 + (ulong)bVar6 * -0x10 + 8;
          }
          sData[0] = OriginalDataElements[4];
          sData[1] = OriginalDataElements[5];
          sData[2] = OriginalDataElements[6];
          sData[3] = OriginalDataElements[7];
          sData[4] = OriginalDataElements[8];
          sData[5] = OriginalDataElements[9];
          *pcVar5 = '\0';
          pcVar5 = tmpField;
          for (lVar4 = 0x200; lVar4 != 0; lVar4 = lVar4 + -1) {
            pcVar5[0] = '\0';
            pcVar5[1] = '\0';
            pcVar5[2] = '\0';
            pcVar5[3] = '\0';
            pcVar5[4] = '\0';
            pcVar5[5] = '\0';
            pcVar5[6] = '\0';
            pcVar5[7] = '\0';
            pcVar5 = pcVar5 + (ulong)bVar6 * -0x10 + 8;
          }
          OriginalDataElements._0_8_ = uVar1;
          OriginalDataElements._8_8_ = uVar2;
          iVar3 = memcmp(sData,"000000",6);
          if (iVar3 != 0) {
            InitTlvPrivate(&TlvPrivateInfo);
            AddTlvPrivate("P13",&TlvPrivateInfo,sData,6);
            nLength = PrivateBuildTlv(tmpField,&TlvPrivateInfo);
            PutTlvAutho("048",&sTlvInfo,tmpField,nLength);
          }
          goto LAB_0044fdaf;
        }
        PutIsoField(0x26,IsoInfo,"909",3);
        pcVar5 = "ERROR Xmit Time Missing ..";
      }
      else {
        PutIsoField(0x26,IsoInfo,"909",3);
        pcVar5 = "ERROR Stan Missing ..";
      }
    }
    else {
      PutIsoField(0x26,IsoInfo,"909",3);
      pcVar5 = "ERROR OriginalDataElements Missing ..";
    }
  }
  trace_event(pcVar5,1);
LAB_004500cc:
  trace_event("End   ReversalProcessing(NOK)",5);
  return -1;
}



// WARNING: Unknown calling convention

int AutomaticReversalProcessing
              (int nIndiceCtx,char *reversal_mode,char *sCaptureCode,char *sRoutingCode,
              char *sAuthoTable,TSIsoInfo *IsoInfo,char *sReasonCode)

{
  int iVar1;
  long lVar2;
  char *pcVar3;
  undefined8 uVar4;
  byte bVar5;
  char sAcquirerIdLen [3];
  char sEventCode [4];
  int nLength;
  int nAcquirerIdLen;
  char sMti [5];
  char ReversalStan [7];
  char sStan [7];
  char ReversalXmit [11];
  char sAcquirerId [12];
  char OriginalDataElements [257];
  char sLine [512];
  char tmpField [4096];
  char sTlvBuffer [4097];
  char sData [4097];
  TSTlvPrivate TlvPrivateInfo;
  TSTlvAutho sTlvInfo;
  
  bVar5 = 0;
  trace_event("Start AutomaticReversalProcessing()",5);
  trace_event("Automatic Reversal After Approval Trx()",5);
  pcVar3 = OriginalDataElements;
  for (lVar2 = 0x20; lVar2 != 0; lVar2 = lVar2 + -1) {
    pcVar3[0] = '\0';
    pcVar3[1] = '\0';
    pcVar3[2] = '\0';
    pcVar3[3] = '\0';
    pcVar3[4] = '\0';
    pcVar3[5] = '\0';
    pcVar3[6] = '\0';
    pcVar3[7] = '\0';
    pcVar3 = pcVar3 + (ulong)bVar5 * -0x10 + 8;
  }
  sStan[4] = '\0';
  sStan[5] = '\0';
  sAcquirerIdLen[0] = '\0';
  sAcquirerIdLen[1] = '\0';
  ReversalXmit[8] = '\0';
  ReversalXmit[9] = '\0';
  *pcVar3 = '\0';
  pcVar3 = sTlvBuffer;
  for (lVar2 = 0x200; lVar2 != 0; lVar2 = lVar2 + -1) {
    pcVar3[0] = '\0';
    pcVar3[1] = '\0';
    pcVar3[2] = '\0';
    pcVar3[3] = '\0';
    pcVar3[4] = '\0';
    pcVar3[5] = '\0';
    pcVar3[6] = '\0';
    pcVar3[7] = '\0';
    pcVar3 = pcVar3 + (ulong)bVar5 * -0x10 + 8;
  }
  ReversalXmit[0] = '\0';
  ReversalXmit[1] = '\0';
  ReversalXmit[2] = '\0';
  ReversalXmit[3] = '\0';
  ReversalXmit[4] = '\0';
  ReversalXmit[5] = '\0';
  ReversalXmit[6] = '\0';
  ReversalXmit[7] = '\0';
  ReversalXmit[10] = '\0';
  sAcquirerIdLen[2] = '\0';
  sMti[0] = '\0';
  sMti[1] = '\0';
  sMti[2] = '\0';
  sMti[3] = '\0';
  sMti[4] = '\0';
  sAcquirerId[0] = '\0';
  sAcquirerId[1] = '\0';
  sAcquirerId[2] = '\0';
  sAcquirerId[3] = '\0';
  sAcquirerId[4] = '\0';
  sAcquirerId[5] = '\0';
  sAcquirerId[6] = '\0';
  sAcquirerId[7] = '\0';
  sAcquirerId[8] = '\0';
  sAcquirerId[9] = '\0';
  sAcquirerId[10] = '\0';
  sAcquirerId[0xb] = '\0';
  *pcVar3 = '\0';
  pcVar3 = sLine;
  for (lVar2 = 0x40; lVar2 != 0; lVar2 = lVar2 + -1) {
    pcVar3[0] = '\0';
    pcVar3[1] = '\0';
    pcVar3[2] = '\0';
    pcVar3[3] = '\0';
    pcVar3[4] = '\0';
    pcVar3[5] = '\0';
    pcVar3[6] = '\0';
    pcVar3[7] = '\0';
    pcVar3 = pcVar3 + (ulong)bVar5 * -0x10 + 8;
  }
  sStan[0] = '\0';
  sStan[1] = '\0';
  sStan[2] = '\0';
  sStan[3] = '\0';
  sStan[6] = '\0';
  pcVar3 = sData;
  for (lVar2 = 0x200; lVar2 != 0; lVar2 = lVar2 + -1) {
    pcVar3[0] = '\0';
    pcVar3[1] = '\0';
    pcVar3[2] = '\0';
    pcVar3[3] = '\0';
    pcVar3[4] = '\0';
    pcVar3[5] = '\0';
    pcVar3[6] = '\0';
    pcVar3[7] = '\0';
    pcVar3 = pcVar3 + (ulong)bVar5 * -0x10 + 8;
  }
  *pcVar3 = '\0';
  pcVar3 = tmpField;
  for (lVar2 = 0x200; lVar2 != 0; lVar2 = lVar2 + -1) {
    pcVar3[0] = '\0';
    pcVar3[1] = '\0';
    pcVar3[2] = '\0';
    pcVar3[3] = '\0';
    pcVar3[4] = '\0';
    pcVar3[5] = '\0';
    pcVar3[6] = '\0';
    pcVar3[7] = '\0';
    pcVar3 = pcVar3 + (ulong)bVar5 * -0x10 + 8;
  }
  memset(&TlvPrivateInfo,0,0x273c);
  InitTlvAutho(&sTlvInfo);
  sprintf(sLine," Index %d",(ulong)(uint)nIndiceCtx);
  trace_event(sLine,4);
  sprintf(sLine," Reversal Mode %s",reversal_mode);
  trace_event(sLine,4);
  sprintf(sLine," Capture Code %s",sCaptureCode);
  trace_event(sLine,4);
  sprintf(sLine," Routing Code %s",sRoutingCode);
  trace_event(sLine,4);
  sprintf(sLine," Auth Table   %s",sAuthoTable);
  trace_event(sLine,4);
  sprintf(sLine," Reason Code  %s",sReasonCode);
  trace_event(sLine,4);
  GetIsoField(6,IsoInfo,ReversalXmit,&nLength);
  GetIsoField(0x1f,IsoInfo,sAcquirerId,&nAcquirerIdLen);
  iVar1 = GetIsoField(0x2f,IsoInfo,tmpField,&nLength);
  if (iVar1 == 0) {
    sStan[4] = '\0';
    sStan[5] = '\0';
    sStan[0] = '\0';
    sStan[1] = '\0';
    sStan[2] = '\0';
    sStan[3] = '\0';
    sStan[6] = '\0';
    AnalyseTlvPrivate(tmpField,nLength,&TlvPrivateInfo);
    GetTlvPrivate("P13",&TlvPrivateInfo,sStan,&nLength);
    iVar1 = IsoInfo->nMsgType;
  }
  else {
    GetIsoField(10,IsoInfo,sStan,&nLength);
    iVar1 = IsoInfo->nMsgType;
  }
  if ((iVar1 == 0x44c) || (iVar1 == 0x456)) {
    uVar4 = 0x44c;
  }
  else {
    if ((iVar1 != 0x4b0) && (iVar1 != 0x4ba)) {
      trace_event("Can Not Reverse such Request",1);
      return -1;
    }
    uVar4 = 0x4b0;
  }
  trace_event("before ISO_MSG_REASON",4);
  PutIsoField(0x18,IsoInfo,sReasonCode,4);
  pcVar3 = OriginalDataElements;
  for (lVar2 = 0x20; lVar2 != 0; lVar2 = lVar2 + -1) {
    pcVar3[0] = '\0';
    pcVar3[1] = '\0';
    pcVar3[2] = '\0';
    pcVar3[3] = '\0';
    pcVar3[4] = '\0';
    pcVar3[5] = '\0';
    pcVar3[6] = '\0';
    pcVar3[7] = '\0';
    pcVar3 = pcVar3 + (ulong)bVar5 * -0x10 + 8;
  }
  builtin_strncpy(OriginalDataElements,"00000000000000000000000000000000000",0x23);
  sMti[0] = '\0';
  sMti[1] = '\0';
  sMti[2] = '\0';
  sMti[3] = '\0';
  sMti[4] = '\0';
  *pcVar3 = '\0';
  sprintf(sMti,"%4d",uVar4);
  OriginalDataElements[4] = sStan[0];
  OriginalDataElements[5] = sStan[1];
  OriginalDataElements[6] = sStan[2];
  OriginalDataElements[7] = sStan[3];
  OriginalDataElements[0] = sMti[0];
  OriginalDataElements[1] = sMti[1];
  OriginalDataElements[2] = sMti[2];
  OriginalDataElements[3] = sMti[3];
  OriginalDataElements[8] = sStan[4];
  OriginalDataElements[9] = sStan[5];
  OriginalDataElements[10] = '0';
  OriginalDataElements[0xb] = '0';
  OriginalDataElements._12_4_ = (undefined4)ReversalXmit._0_8_;
  OriginalDataElements._16_4_ = SUB84(ReversalXmit._0_8_,4);
  OriginalDataElements[0x14] = ReversalXmit[8];
  OriginalDataElements[0x15] = ReversalXmit[9];
  sprintf(sAcquirerIdLen,"%02d",(ulong)(uint)nAcquirerIdLen);
  OriginalDataElements[0x16] = sAcquirerIdLen[0];
  OriginalDataElements[0x17] = sAcquirerIdLen[1];
  memcpy(OriginalDataElements + (0x23 - (long)nAcquirerIdLen),sAcquirerId,(long)nAcquirerIdLen);
  builtin_strncpy(OriginalDataElements + 0x23,"0000000000000",0xd);
  sprintf(sLine,"ISO Original Data = %s",OriginalDataElements);
  trace_event(sLine,4);
  trace_event("before ISO_ORIG_DATA",4);
  PutIsoField(0x37,IsoInfo,OriginalDataElements,0x30);
  IsoInfo->nMsgType = 0x58c;
  IsoToTlv(nIndiceCtx,IsoInfo,&sTlvInfo);
  PutTlvAutho("288",&sTlvInfo,sAuthoTable,3);
  if (*reversal_mode == 'C') {
    PutTlvAutho("201",&sTlvInfo,sCaptureCode,6);
  }
  else {
    PutTlvAutho("200",&sTlvInfo,sRoutingCode,6);
    PutTlvAutho("011",&sTlvInfo,sStan,6);
  }
  GetInternalStan(nIndiceCtx,sStan);
  PutTlvAutho("129",&sTlvInfo,sStan,6);
  current_gmt_date(sData);
  PutTlvAutho("291",&sTlvInfo,sData + 2,10);
  PutTlvAutho("039",&sTlvInfo,"480",3);
  trace_event("before AuthoBuildTlv",4);
  AuthoBuildTlv(sTlvBuffer,&sTlvInfo);
  PutTlvBuffer("011",sTlvBuffer,sStan,6);
  PrintTlvBuffer(sTlvBuffer);
  trace_event("before InsertionSaf",4);
  iVar1 = memcmp(sRoutingCode,"000001",6);
  if (iVar1 != 0) {
    InsertionSaf(nIndiceCtx,sTlvBuffer,sCaptureCode,sRoutingCode);
  }
  InitTlvAutho(&sTlvInfo);
  AnalyseTlvAutho(sTlvBuffer,&sTlvInfo);
  trace_event("before TlvToIso",4);
  TlvToIso(nIndiceCtx,&sTlvInfo,IsoInfo,'\x03');
  return 0;
}



// WARNING: Unknown calling convention

int CheckLimits(int nIndiceCtx,char *sOnOffFlag,char *sTlvBuffer,char *sAlternAmnt)

{
  size_t sVar1;
  ulong uVar2;
  uint uVar3;
  uchar *puVar4;
  bool bVar5;
  byte bVar6;
  uchar auStack_3014 [7436];
  char T_on_off_flag [4];
  int response_code;
  anon_struct_22_2_43c7b5cf T_altern_amount;
  sqlca sqlca;
  char sLine [512];
  anon_struct_4100_2_43c7b5cf T_tlv_auth;
  
  bVar6 = 0;
  trace_event("Start CheckLimits() ",5);
  puVar4 = T_tlv_auth.arr + 2;
  uVar3 = 0xfff;
  T_tlv_auth.arr[0] = '\0';
  T_tlv_auth.arr[1] = '\0';
  bVar5 = ((ulong)puVar4 & 4) != 0;
  if (bVar5) {
    T_tlv_auth.arr[2] = '\0';
    T_tlv_auth.arr[3] = '\0';
    T_tlv_auth.arr[4] = '\0';
    T_tlv_auth.arr[5] = '\0';
    uVar3 = 0xffb;
    puVar4 = T_tlv_auth.arr + 6;
  }
  for (uVar2 = (ulong)(uVar3 >> 3); uVar2 != 0; uVar2 = uVar2 - 1) {
    puVar4[0] = '\0';
    puVar4[1] = '\0';
    puVar4[2] = '\0';
    puVar4[3] = '\0';
    puVar4[4] = '\0';
    puVar4[5] = '\0';
    puVar4[6] = '\0';
    puVar4[7] = '\0';
    puVar4 = puVar4 + (ulong)bVar6 * -0x10 + 8;
  }
  if (!bVar5) {
    puVar4[0] = '\0';
    puVar4[1] = '\0';
    puVar4[2] = '\0';
    puVar4[3] = '\0';
    puVar4 = puVar4 + 4;
  }
  puVar4[0] = '\0';
  puVar4[1] = '\0';
  puVar4[2] = '\0';
  puVar4 = T_tlv_auth.arr;
  T_altern_amount.arr[0] = '\0';
  T_altern_amount.arr[1] = '\0';
  T_altern_amount.arr[2] = '\0';
  T_altern_amount.arr[3] = '\0';
  T_altern_amount.arr[4] = '\0';
  T_altern_amount.arr[5] = '\0';
  T_altern_amount.arr[6] = '\0';
  T_altern_amount.arr[7] = '\0';
  T_tlv_auth.len = 0;
  T_altern_amount.arr[0x10] = '\0';
  T_altern_amount.arr[0x11] = '\0';
  T_altern_amount.len = 0;
  T_on_off_flag[0] = '\0';
  T_on_off_flag[1] = '\0';
  T_on_off_flag[2] = '\0';
  T_on_off_flag[3] = '\0';
  T_altern_amount.arr[8] = '\0';
  T_altern_amount.arr[9] = '\0';
  T_altern_amount.arr[10] = '\0';
  T_altern_amount.arr[0xb] = '\0';
  T_altern_amount.arr[0xc] = '\0';
  T_altern_amount.arr[0xd] = '\0';
  T_altern_amount.arr[0xe] = '\0';
  T_altern_amount.arr[0xf] = '\0';
  T_altern_amount.arr[0x12] = '\0';
  sVar1 = strlen(sTlvBuffer);
  memcpy(puVar4,sTlvBuffer,sVar1);
  T_tlv_auth.len = (ushort)sVar1;
  sVar1 = strlen(sOnOffFlag);
  memcpy(T_on_off_flag,sOnOffFlag,sVar1);
  sLine._40_8_ = &sqlca;
  sLine._56_8_ = &sqladt;
  sLine._64_8_ = &sqltds;
  sLine[0x16] = '\0';
  sLine[0x17] = '\x11';
  sLine[0x170] = '\0';
  sLine[0x171] = '\0';
  sLine[0x178] = '\0';
  sLine[0x179] = '\0';
  sLine._48_8_ = s_begin__response_code____PCRD_P7__004c8b98;
  sLine[0x172] = '\0';
  sLine[0x173] = '\0';
  sLine[0x17a] = '\0';
  sLine[0x17b] = '\0';
  sLine._32_8_ = sqlcud0;
  sLine._176_8_ = &response_code;
  response_code = 0x38d;
  sLine[0] = '\f';
  sLine[1] = '\0';
  sLine[2] = '\0';
  sLine[3] = '\0';
  sLine[4] = '\0';
  sLine[5] = '\0';
  sLine[6] = '\0';
  sLine[7] = '\0';
  sLine[8] = '\x04';
  sLine[9] = '\0';
  sLine[10] = '\0';
  sLine[0xb] = '\0';
  sLine[0xc] = '\x01';
  sLine[0xd] = '\0';
  sLine[0xe] = '\0';
  sLine[0xf] = '\0';
  sLine[0x10] = '\x05';
  sLine[0x11] = '\0';
  sLine[0x12] = '\0';
  sLine[0x13] = '\0';
  sLine[0x18] = '\0';
  sLine[0x19] = '\0';
  sLine[0x1a] = '\0';
  sLine[0x1b] = '\0';
  sLine[0xd0] = '\x04';
  sLine[0xd1] = '\0';
  sLine[0xd2] = '\0';
  sLine[0xd3] = '\0';
  sLine[0xd4] = '\0';
  sLine[0xd5] = '\0';
  sLine[0xd6] = '\0';
  sLine[0xd7] = '\0';
  sLine[0xf0] = '\0';
  sLine[0xf1] = '\0';
  sLine[0xf2] = '\0';
  sLine[0xf3] = '\0';
  sLine[0x100] = '\0';
  sLine[0x101] = '\0';
  sLine[0x102] = '\0';
  sLine[0x103] = '\0';
  sLine[0x104] = '\0';
  sLine[0x105] = '\0';
  sLine[0x106] = '\0';
  sLine[0x107] = '\0';
  sLine[0x120] = '\0';
  sLine[0x121] = '\0';
  sLine[0x122] = '\0';
  sLine[0x123] = '\0';
  sLine[0x130] = '\0';
  sLine[0x131] = '\0';
  sLine[0x132] = '\0';
  sLine[0x133] = '\0';
  sLine[0x134] = '\0';
  sLine[0x135] = '\0';
  sLine[0x136] = '\0';
  sLine[0x137] = '\0';
  sLine[0xd8] = '\x04';
  sLine[0xd9] = '\0';
  sLine[0xda] = '\0';
  sLine[0xdb] = '\0';
  sLine[0xdc] = '\0';
  sLine[0xdd] = '\0';
  sLine[0xde] = '\0';
  sLine[0xdf] = '\0';
  sLine[0xf4] = '\0';
  sLine[0xf5] = '\0';
  sLine[0xf6] = '\0';
  sLine[0xf7] = '\0';
  sLine[0x108] = '\0';
  sLine[0x109] = '\0';
  sLine[0x10a] = '\0';
  sLine[0x10b] = '\0';
  sLine[0x10c] = '\0';
  sLine[0x10d] = '\0';
  sLine[0x10e] = '\0';
  sLine[0x10f] = '\0';
  sLine[0x124] = '\0';
  sLine[0x125] = '\0';
  sLine[0x126] = '\0';
  sLine[0x127] = '\0';
  sLine[0x138] = '\0';
  sLine[0x139] = '\0';
  sLine[0x13a] = '\0';
  sLine[0x13b] = '\0';
  sLine[0x13c] = '\0';
  sLine[0x13d] = '\0';
  sLine[0x13e] = '\0';
  sLine[0x13f] = '\0';
  sLine[0xe0] = '\x15';
  sLine[0xe1] = '\0';
  sLine[0xe2] = '\0';
  sLine[0xe3] = '\0';
  sLine[0xe4] = '\0';
  sLine[0xe5] = '\0';
  sLine[0xe6] = '\0';
  sLine[0xe7] = '\0';
  sLine[0xf8] = '\0';
  sLine[0xf9] = '\0';
  sLine[0xfa] = '\0';
  sLine[0xfb] = '\0';
  sLine[0x110] = '\0';
  sLine[0x111] = '\0';
  sLine[0x112] = '\0';
  sLine[0x113] = '\0';
  sLine[0x114] = '\0';
  sLine[0x115] = '\0';
  sLine[0x116] = '\0';
  sLine[0x117] = '\0';
  sLine[0x128] = '\0';
  sLine[0x129] = '\0';
  sLine[0x12a] = '\0';
  sLine[299] = '\0';
  sLine[0x174] = '\0';
  sLine[0x175] = '\0';
  sLine[0x17c] = '\0';
  sLine[0x17d] = '\0';
  sLine[0x140] = '\0';
  sLine[0x141] = '\0';
  sLine[0x142] = '\0';
  sLine[0x143] = '\0';
  sLine[0x144] = '\0';
  sLine[0x145] = '\0';
  sLine[0x146] = '\0';
  sLine[0x147] = '\0';
  sLine[0x176] = '\0';
  sLine[0x177] = '\0';
  sLine[0x17e] = '\0';
  sLine[0x17f] = '\0';
  sLine._72_8_ = sLine + 0xb0;
  sLine[0xe8] = '\x03';
  sLine[0xe9] = '\x10';
  sLine[0xea] = '\0';
  sLine[0xeb] = '\0';
  sLine[0xec] = '\0';
  sLine[0xed] = '\0';
  sLine[0xee] = '\0';
  sLine[0xef] = '\0';
  sLine[0xfc] = '\0';
  sLine[0xfd] = '\0';
  sLine[0xfe] = '\0';
  sLine[0xff] = '\0';
  sLine._80_8_ = sLine + 0xd0;
  sLine[0x118] = '\0';
  sLine[0x119] = '\0';
  sLine[0x11a] = '\0';
  sLine[0x11b] = '\0';
  sLine[0x11c] = '\0';
  sLine[0x11d] = '\0';
  sLine[0x11e] = '\0';
  sLine[0x11f] = '\0';
  sLine[300] = '\0';
  sLine[0x12d] = '\0';
  sLine[0x12e] = '\0';
  sLine[0x12f] = '\0';
  sLine[0x148] = '\0';
  sLine[0x149] = '\0';
  sLine[0x14a] = '\0';
  sLine[0x14b] = '\0';
  sLine[0x14c] = '\0';
  sLine[0x14d] = '\0';
  sLine[0x14e] = '\0';
  sLine[0x14f] = '\0';
  sLine._88_8_ = sLine + 0xf0;
  sLine._96_8_ = sLine + 0x100;
  sLine._104_8_ = sLine + 0x120;
  sLine._112_8_ = sLine + 0x130;
  sLine._120_8_ = sLine + 0x150;
  sLine._128_8_ = sLine + 0x170;
  sLine._136_8_ = sLine + 0x178;
  sLine._184_8_ = T_on_off_flag;
  sLine._192_8_ = &T_altern_amount;
  sLine._200_8_ = &T_tlv_auth;
  sqlcxt((long)nIndiceCtx * 0x10 + 0x713948,&sqlctx,sLine,&sqlfpn);
  if (sqlca.sqlcode < 0) {
    tlvcpy(sTlvBuffer,(char *)puVar4,(uint)T_tlv_auth.len);
    sprintf(sLine,"%.40s",sqlca.sqlerrm.sqlerrmc);
    trace_event(sLine,1);
    trace_event("End CheckLimits(SYSTEM_MALFUNCTION)",5);
    response_code = 0x38d;
  }
  else if (response_code == 0) {
    tlvcpy(sTlvBuffer,(char *)puVar4,(uint)T_tlv_auth.len);
    memcpy(sAlternAmnt,T_altern_amount.arr,(ulong)T_altern_amount.len);
    trace_event("End CheckLimits(OK)",5);
    response_code = 0;
  }
  else {
    tlvcpy(sTlvBuffer,(char *)puVar4,(uint)T_tlv_auth.len);
    sprintf(sLine,"End CheckLimits(%d)",(ulong)(uint)response_code);
    trace_event(sLine,5);
  }
  return response_code;
}



// WARNING: Unknown calling convention

int UpdateCardActivity(int nIndiceCtx,char cUpdateFlag,char *sTlvBuffer)

{
  size_t __n;
  ulong uVar1;
  uchar *puVar2;
  uint uVar3;
  bool bVar4;
  byte bVar5;
  uchar auStack_3014 [7479];
  char T_update_flag;
  int response_code;
  sqlca sqlca;
  char sLine [512];
  anon_struct_4100_2_43c7b5cf T_tlv_auth;
  
  bVar5 = 0;
  trace_event("Start UpdateCardActivity () ",5);
  puVar2 = T_tlv_auth.arr + 2;
  T_tlv_auth.arr[0] = '\0';
  T_tlv_auth.arr[1] = '\0';
  uVar3 = 0xfff;
  bVar4 = ((ulong)puVar2 & 4) != 0;
  if (bVar4) {
    T_tlv_auth.arr[2] = '\0';
    T_tlv_auth.arr[3] = '\0';
    T_tlv_auth.arr[4] = '\0';
    T_tlv_auth.arr[5] = '\0';
    uVar3 = 0xffb;
    puVar2 = T_tlv_auth.arr + 6;
  }
  for (uVar1 = (ulong)(uVar3 >> 3); uVar1 != 0; uVar1 = uVar1 - 1) {
    puVar2[0] = '\0';
    puVar2[1] = '\0';
    puVar2[2] = '\0';
    puVar2[3] = '\0';
    puVar2[4] = '\0';
    puVar2[5] = '\0';
    puVar2[6] = '\0';
    puVar2[7] = '\0';
    puVar2 = puVar2 + (ulong)bVar5 * -0x10 + 8;
  }
  if (!bVar4) {
    puVar2[0] = '\0';
    puVar2[1] = '\0';
    puVar2[2] = '\0';
    puVar2[3] = '\0';
    puVar2 = puVar2 + 4;
  }
  puVar2[0] = '\0';
  puVar2[1] = '\0';
  puVar2[2] = '\0';
  puVar2 = T_tlv_auth.arr;
  T_tlv_auth.len = 0;
  __n = strlen(sTlvBuffer);
  memcpy(puVar2,sTlvBuffer,__n);
  sLine._40_8_ = &sqlca;
  sLine._56_8_ = &sqladt;
  sLine._64_8_ = &sqltds;
  sLine[0x16] = '\0';
  sLine[0x17] = '\x11';
  sLine[0x148] = '\0';
  sLine[0x149] = '\0';
  sLine[0x14e] = '\0';
  sLine[0x14f] = '\0';
  sLine._48_8_ = s_declare_pin_error_flag_BOOLEAN___004c8c70;
  sLine[0x14a] = '\0';
  sLine[0x14b] = '\0';
  sLine[0x150] = '\0';
  sLine[0x151] = '\0';
  T_tlv_auth.len = (ushort)__n;
  sLine._32_8_ = sqlcud0;
  sLine._176_8_ = &T_update_flag;
  response_code = 0x38d;
  sLine[0] = '\f';
  sLine[1] = '\0';
  sLine[2] = '\0';
  sLine[3] = '\0';
  sLine[4] = '\0';
  sLine[5] = '\0';
  sLine[6] = '\0';
  sLine[7] = '\0';
  sLine[8] = '\x03';
  sLine[9] = '\0';
  sLine[10] = '\0';
  sLine[0xb] = '\0';
  sLine._184_8_ = &response_code;
  sLine[0xc] = '\x01';
  sLine[0xd] = '\0';
  sLine[0xe] = '\0';
  sLine[0xf] = '\0';
  sLine[0x10] = '\x05';
  sLine[0x11] = '\0';
  sLine[0x12] = '\0';
  sLine[0x13] = '\0';
  sLine._72_8_ = sLine + 0xb0;
  sLine[0x18] = '\0';
  sLine[0x19] = '\0';
  sLine[0x1a] = '\0';
  sLine[0x1b] = '\0';
  sLine[200] = '\x01';
  sLine[0xc9] = '\0';
  sLine[0xca] = '\0';
  sLine[0xcb] = '\0';
  sLine[0xcc] = '\0';
  sLine[0xcd] = '\0';
  sLine[0xce] = '\0';
  sLine[0xcf] = '\0';
  sLine[0xe0] = '\0';
  sLine[0xe1] = '\0';
  sLine[0xe2] = '\0';
  sLine[0xe3] = '\0';
  sLine[0xf0] = '\0';
  sLine[0xf1] = '\0';
  sLine[0xf2] = '\0';
  sLine[0xf3] = '\0';
  sLine[0xf4] = '\0';
  sLine[0xf5] = '\0';
  sLine[0xf6] = '\0';
  sLine[0xf7] = '\0';
  sLine[0x108] = '\0';
  sLine[0x109] = '\0';
  sLine[0x10a] = '\0';
  sLine[0x10b] = '\0';
  sLine[0x118] = '\0';
  sLine[0x119] = '\0';
  sLine[0x11a] = '\0';
  sLine[0x11b] = '\0';
  sLine[0x11c] = '\0';
  sLine[0x11d] = '\0';
  sLine[0x11e] = '\0';
  sLine[0x11f] = '\0';
  sLine[0xd0] = '\x04';
  sLine[0xd1] = '\0';
  sLine[0xd2] = '\0';
  sLine[0xd3] = '\0';
  sLine[0xd4] = '\0';
  sLine[0xd5] = '\0';
  sLine[0xd6] = '\0';
  sLine[0xd7] = '\0';
  sLine[0xe4] = '\0';
  sLine[0xe5] = '\0';
  sLine[0xe6] = '\0';
  sLine[0xe7] = '\0';
  sLine[0xf8] = '\0';
  sLine[0xf9] = '\0';
  sLine[0xfa] = '\0';
  sLine[0xfb] = '\0';
  sLine[0xfc] = '\0';
  sLine[0xfd] = '\0';
  sLine[0xfe] = '\0';
  sLine[0xff] = '\0';
  sLine[0x10c] = '\0';
  sLine[0x10d] = '\0';
  sLine[0x10e] = '\0';
  sLine[0x10f] = '\0';
  sLine[0x120] = '\0';
  sLine[0x121] = '\0';
  sLine[0x122] = '\0';
  sLine[0x123] = '\0';
  sLine[0x124] = '\0';
  sLine[0x125] = '\0';
  sLine[0x126] = '\0';
  sLine[0x127] = '\0';
  sLine[0xd8] = '\x03';
  sLine[0xd9] = '\x10';
  sLine[0xda] = '\0';
  sLine[0xdb] = '\0';
  sLine[0xdc] = '\0';
  sLine[0xdd] = '\0';
  sLine[0xde] = '\0';
  sLine[0xdf] = '\0';
  sLine[0xe8] = '\0';
  sLine[0xe9] = '\0';
  sLine[0xea] = '\0';
  sLine[0xeb] = '\0';
  sLine[0x100] = '\0';
  sLine[0x101] = '\0';
  sLine[0x102] = '\0';
  sLine[0x103] = '\0';
  sLine[0x104] = '\0';
  sLine[0x105] = '\0';
  sLine[0x106] = '\0';
  sLine[0x107] = '\0';
  sLine._80_8_ = sLine + 200;
  sLine[0x110] = '\0';
  sLine[0x111] = '\0';
  sLine[0x112] = '\0';
  sLine[0x113] = '\0';
  sLine[0x128] = '\0';
  sLine[0x129] = '\0';
  sLine[0x12a] = '\0';
  sLine[299] = '\0';
  sLine[300] = '\0';
  sLine[0x12d] = '\0';
  sLine[0x12e] = '\0';
  sLine[0x12f] = '\0';
  sLine._88_8_ = sLine + 0xe0;
  sLine[0x14c] = '\0';
  sLine[0x14d] = '\0';
  sLine[0x152] = '\0';
  sLine[0x153] = '\0';
  sLine._96_8_ = sLine + 0xf0;
  sLine._104_8_ = sLine + 0x108;
  sLine._112_8_ = sLine + 0x118;
  sLine._120_8_ = sLine + 0x130;
  sLine._128_8_ = sLine + 0x148;
  sLine._136_8_ = sLine + 0x14e;
  T_update_flag = cUpdateFlag;
  sLine._192_8_ = &T_tlv_auth;
  sqlcxt((long)nIndiceCtx * 0x10 + 0x713948,&sqlctx,sLine,&sqlfpn);
  if (sqlca.sqlcode < 0) {
    tlvcpy(sTlvBuffer,(char *)puVar2,(uint)T_tlv_auth.len);
    sprintf(sLine,"%.40s",sqlca.sqlerrm.sqlerrmc);
    trace_event(sLine,1);
    trace_event("End UpdateCardActivity (SYSTEM_MALFUNCTION)",5);
    response_code = 0x38d;
  }
  else {
    tlvcpy(sTlvBuffer,(char *)puVar2,(uint)T_tlv_auth.len);
    sprintf(sLine,"End UpdateCardActivity (%d)",(ulong)(uint)response_code);
    trace_event(sLine,5);
  }
  return response_code;
}



// WARNING: Unknown calling convention

int UpdateBalance(int nIndiceCtx,char cUpdateFlag,char *sTlvBuffer)

{
  int iVar1;
  size_t __n;
  ulong uVar2;
  long lVar3;
  uchar *puVar4;
  char *pcVar5;
  uint uVar6;
  bool bVar7;
  byte bVar8;
  char T_update_flag;
  int response_code;
  int nIccLen;
  int nTmpLen;
  sqlca sqlca;
  char sIccData [4096];
  char szTmpData [4096];
  anon_struct_4100_2_43c7b5cf T_tlv_auth;
  char sLine [512];
  
  bVar8 = 0;
  trace_event("Start UpdateBalance () ",5);
  puVar4 = T_tlv_auth.arr + 2;
  T_tlv_auth.arr[0] = '\0';
  T_tlv_auth.arr[1] = '\0';
  uVar6 = 0xfff;
  bVar7 = ((ulong)puVar4 & 4) != 0;
  if (bVar7) {
    T_tlv_auth.arr[2] = '\0';
    T_tlv_auth.arr[3] = '\0';
    T_tlv_auth.arr[4] = '\0';
    T_tlv_auth.arr[5] = '\0';
    uVar6 = 0xffb;
    puVar4 = T_tlv_auth.arr + 6;
  }
  for (uVar2 = (ulong)(uVar6 >> 3); uVar2 != 0; uVar2 = uVar2 - 1) {
    puVar4[0] = '\0';
    puVar4[1] = '\0';
    puVar4[2] = '\0';
    puVar4[3] = '\0';
    puVar4[4] = '\0';
    puVar4[5] = '\0';
    puVar4[6] = '\0';
    puVar4[7] = '\0';
    puVar4 = puVar4 + (ulong)bVar8 * -0x10 + 8;
  }
  if (!bVar7) {
    puVar4[0] = '\0';
    puVar4[1] = '\0';
    puVar4[2] = '\0';
    puVar4[3] = '\0';
    puVar4 = puVar4 + 4;
  }
  puVar4[0] = '\0';
  puVar4[1] = '\0';
  puVar4[2] = '\0';
  puVar4 = T_tlv_auth.arr;
  T_tlv_auth.len = 0;
  __n = strlen(sTlvBuffer);
  memcpy(puVar4,sTlvBuffer,__n);
  sLine._40_8_ = &sqlca;
  sLine._56_8_ = &sqladt;
  sLine._64_8_ = &sqltds;
  sLine[0x16] = '\0';
  sLine[0x17] = '\x11';
  sLine[0x148] = '\0';
  sLine[0x149] = '\0';
  sLine[0x14e] = '\0';
  sLine[0x14f] = '\0';
  sLine._48_8_ = s_declare_approval_flag_BOOLEAN____004c8f50;
  sLine[0x14a] = '\0';
  sLine[0x14b] = '\0';
  sLine[0x150] = '\0';
  sLine[0x151] = '\0';
  T_tlv_auth.len = (ushort)__n;
  sLine._32_8_ = sqlcud0;
  sLine._176_8_ = &T_update_flag;
  response_code = 0x38d;
  sLine[0] = '\f';
  sLine[1] = '\0';
  sLine[2] = '\0';
  sLine[3] = '\0';
  sLine[4] = '\0';
  sLine[5] = '\0';
  sLine[6] = '\0';
  sLine[7] = '\0';
  sLine[8] = '\x03';
  sLine[9] = '\0';
  sLine[10] = '\0';
  sLine[0xb] = '\0';
  sLine._184_8_ = &response_code;
  sLine[0xc] = '\x01';
  sLine[0xd] = '\0';
  sLine[0xe] = '\0';
  sLine[0xf] = '\0';
  sLine[0x10] = '\x05';
  sLine[0x11] = '\0';
  sLine[0x12] = '\0';
  sLine[0x13] = '\0';
  sLine._72_8_ = sLine + 0xb0;
  sLine[0x18] = '\0';
  sLine[0x19] = '\0';
  sLine[0x1a] = '\0';
  sLine[0x1b] = '\0';
  sLine[200] = '\x01';
  sLine[0xc9] = '\0';
  sLine[0xca] = '\0';
  sLine[0xcb] = '\0';
  sLine[0xcc] = '\0';
  sLine[0xcd] = '\0';
  sLine[0xce] = '\0';
  sLine[0xcf] = '\0';
  sLine[0xe0] = '\0';
  sLine[0xe1] = '\0';
  sLine[0xe2] = '\0';
  sLine[0xe3] = '\0';
  sLine[0xf0] = '\0';
  sLine[0xf1] = '\0';
  sLine[0xf2] = '\0';
  sLine[0xf3] = '\0';
  sLine[0xf4] = '\0';
  sLine[0xf5] = '\0';
  sLine[0xf6] = '\0';
  sLine[0xf7] = '\0';
  sLine[0x108] = '\0';
  sLine[0x109] = '\0';
  sLine[0x10a] = '\0';
  sLine[0x10b] = '\0';
  sLine[0x118] = '\0';
  sLine[0x119] = '\0';
  sLine[0x11a] = '\0';
  sLine[0x11b] = '\0';
  sLine[0x11c] = '\0';
  sLine[0x11d] = '\0';
  sLine[0x11e] = '\0';
  sLine[0x11f] = '\0';
  sLine[0xd0] = '\x04';
  sLine[0xd1] = '\0';
  sLine[0xd2] = '\0';
  sLine[0xd3] = '\0';
  sLine[0xd4] = '\0';
  sLine[0xd5] = '\0';
  sLine[0xd6] = '\0';
  sLine[0xd7] = '\0';
  sLine[0xe4] = '\0';
  sLine[0xe5] = '\0';
  sLine[0xe6] = '\0';
  sLine[0xe7] = '\0';
  sLine[0xf8] = '\0';
  sLine[0xf9] = '\0';
  sLine[0xfa] = '\0';
  sLine[0xfb] = '\0';
  sLine[0xfc] = '\0';
  sLine[0xfd] = '\0';
  sLine[0xfe] = '\0';
  sLine[0xff] = '\0';
  sLine[0x10c] = '\0';
  sLine[0x10d] = '\0';
  sLine[0x10e] = '\0';
  sLine[0x10f] = '\0';
  sLine[0x120] = '\0';
  sLine[0x121] = '\0';
  sLine[0x122] = '\0';
  sLine[0x123] = '\0';
  sLine[0x124] = '\0';
  sLine[0x125] = '\0';
  sLine[0x126] = '\0';
  sLine[0x127] = '\0';
  sLine[0xd8] = '\x03';
  sLine[0xd9] = '\x10';
  sLine[0xda] = '\0';
  sLine[0xdb] = '\0';
  sLine[0xdc] = '\0';
  sLine[0xdd] = '\0';
  sLine[0xde] = '\0';
  sLine[0xdf] = '\0';
  sLine[0xe8] = '\0';
  sLine[0xe9] = '\0';
  sLine[0xea] = '\0';
  sLine[0xeb] = '\0';
  sLine[0x100] = '\0';
  sLine[0x101] = '\0';
  sLine[0x102] = '\0';
  sLine[0x103] = '\0';
  sLine[0x104] = '\0';
  sLine[0x105] = '\0';
  sLine[0x106] = '\0';
  sLine[0x107] = '\0';
  sLine._80_8_ = sLine + 200;
  sLine[0x110] = '\0';
  sLine[0x111] = '\0';
  sLine[0x112] = '\0';
  sLine[0x113] = '\0';
  sLine[0x128] = '\0';
  sLine[0x129] = '\0';
  sLine[0x12a] = '\0';
  sLine[299] = '\0';
  sLine[300] = '\0';
  sLine[0x12d] = '\0';
  sLine[0x12e] = '\0';
  sLine[0x12f] = '\0';
  sLine._88_8_ = sLine + 0xe0;
  sLine[0x14c] = '\0';
  sLine[0x14d] = '\0';
  sLine[0x152] = '\0';
  sLine[0x153] = '\0';
  sLine._96_8_ = sLine + 0xf0;
  sLine._104_8_ = sLine + 0x108;
  sLine._112_8_ = sLine + 0x118;
  sLine._120_8_ = sLine + 0x130;
  sLine._128_8_ = sLine + 0x148;
  sLine._136_8_ = sLine + 0x14e;
  T_update_flag = cUpdateFlag;
  sLine._192_8_ = &T_tlv_auth;
  sqlcxt((long)nIndiceCtx * 0x10 + 0x713948,&sqlctx,(TSTlvPrivate *)sLine,&sqlfpn);
  if (sqlca.sqlcode < 0) {
    tlvcpy(sTlvBuffer,(char *)puVar4,(uint)T_tlv_auth.len);
    sprintf(sLine,"%.40s",sqlca.sqlerrm.sqlerrmc);
    trace_event(sLine,1);
    trace_event("End UpdateBalance (SYSTEM_MALFUNCTION)",5);
    return 0x38d;
  }
  tlvcpy(sTlvBuffer,(char *)puVar4,(uint)T_tlv_auth.len);
  if (response_code == 0) {
    iVar1 = GetTlvBuffer("055",sTlvBuffer,sIccData,&nIccLen);
    if (iVar1 == 0) {
      InitTlvPrivate((TSTlvPrivate *)sLine);
      AnalyseTlvPrivate(sIccData,nIccLen,(TSTlvPrivate *)sLine);
      pcVar5 = szTmpData;
      for (lVar3 = 0x200; lVar3 != 0; lVar3 = lVar3 + -1) {
        pcVar5[0] = '\0';
        pcVar5[1] = '\0';
        pcVar5[2] = '\0';
        pcVar5[3] = '\0';
        pcVar5[4] = '\0';
        pcVar5[5] = '\0';
        pcVar5[6] = '\0';
        pcVar5[7] = '\0';
        pcVar5 = pcVar5 + (ulong)bVar8 * -0x10 + 8;
      }
      iVar1 = GetTlvPrivate("C24",(TSTlvPrivate *)sLine,szTmpData,&nTmpLen);
      if ((iVar1 == 0) &&
         (iVar1 = GetTlvPrivate("C23",(TSTlvPrivate *)sLine,szTmpData,&nTmpLen), iVar1 == 0)) {
        pcVar5 = szTmpData;
        for (lVar3 = 0x200; lVar3 != 0; lVar3 = lVar3 + -1) {
          pcVar5[0] = '\0';
          pcVar5[1] = '\0';
          pcVar5[2] = '\0';
          pcVar5[3] = '\0';
          pcVar5[4] = '\0';
          pcVar5[5] = '\0';
          pcVar5[6] = '\0';
          pcVar5[7] = '\0';
          pcVar5 = pcVar5 + (ulong)bVar8 * -0x10 + 8;
        }
        iVar1 = check_crpt_data(nIndiceCtx,sTlvBuffer,szTmpData);
        if (iVar1 == 0) {
          iVar1 = GetTlvPrivate("C29",(TSTlvPrivate *)sLine,szTmpData,&nTmpLen);
          if (iVar1 == 0) {
            pcVar5 = szTmpData;
            for (lVar3 = 0x200; lVar3 != 0; lVar3 = lVar3 + -1) {
              pcVar5[0] = '\0';
              pcVar5[1] = '\0';
              pcVar5[2] = '\0';
              pcVar5[3] = '\0';
              pcVar5[4] = '\0';
              pcVar5[5] = '\0';
              pcVar5[6] = '\0';
              pcVar5[7] = '\0';
              pcVar5 = pcVar5 + (ulong)bVar8 * -0x10 + 8;
            }
            iVar1 = gen_iss_script_data(nIndiceCtx,sTlvBuffer,szTmpData);
            if (iVar1 != 0) {
              trace_event("End UpdateBalance (SYSTEM_MALFUNCTION) <ERROR ON gen_iss_script_data()>",
                          5);
              return 0x38d;
            }
          }
          iVar1 = UpdateAuthoActivity(nIndiceCtx,sTlvBuffer);
          if (iVar1 == 0) goto LAB_004515e5;
          trace_event("End UpdateBalance (SYSTEM_MALFUNCTION) <ERROR ON UpdateAuthoActivity()>",5);
        }
        else {
          trace_event("End UpdateBalance (SYSTEM_MALFUNCTION) <ERROR ON check_crpt_data()>",5);
        }
        return 0x38d;
      }
    }
  }
LAB_004515e5:
  sprintf(sLine,"End UpdateBalance (%d)",(ulong)(uint)response_code);
  trace_event(sLine,5);
  return response_code;
}



// WARNING: Unknown calling convention

int StatementReqProcessing
              (int nIndiceCtx,char *sMyResource,char *sAuthoTable,char *sAcquirerBank,
              char *InternationalRoutCheck,char *sServGatewayFlag,char *sBillCalculFlag,
              char *sTlvBuffer,TSIsoInfo *sIsoMsg)

{
  char acVar1 [4];
  undefined4 uVar2;
  int iVar3;
  uint uVar4;
  long lVar5;
  char *pcVar6;
  byte bVar7;
  char slFuncCode [4];
  char sRetCode [4];
  char sEventCode [4];
  pid_t nPid;
  int nLength;
  char slProcCode [7];
  char sPrimResource [7];
  char sSecResource [7];
  char sInternalStan [7];
  char sPid [9];
  char sSecurityResults [11];
  TSService rService;
  char slCardNumber [23];
  char sLine [512];
  char sSecurData [4096];
  char sAlternAmount [4097];
  TSTlvAutho sTlvInfo;
  
  bVar7 = 0;
  trace_event("Start StatementReqProcessing  ()",5);
  pcVar6 = sSecurData;
  for (lVar5 = 0x200; lVar5 != 0; lVar5 = lVar5 + -1) {
    pcVar6[0] = '\0';
    pcVar6[1] = '\0';
    pcVar6[2] = '\0';
    pcVar6[3] = '\0';
    pcVar6[4] = '\0';
    pcVar6[5] = '\0';
    pcVar6[6] = '\0';
    pcVar6[7] = '\0';
    pcVar6 = pcVar6 + (ulong)bVar7 * -0x10 + 8;
  }
  slProcCode[4] = '\0';
  slProcCode[5] = '\0';
  sPrimResource[4] = '\0';
  sPrimResource[5] = '\0';
  rService.szDestAcc[1] = '\0';
  rService.szDestAcc[2] = '\0';
  sSecResource[4] = '\0';
  sSecResource[5] = '\0';
  slProcCode[0] = '\0';
  slProcCode[1] = '\0';
  slProcCode[2] = '\0';
  slProcCode[3] = '\0';
  slProcCode[6] = '\0';
  slFuncCode[0] = '\0';
  slFuncCode[1] = '\0';
  slFuncCode[2] = '\0';
  slFuncCode[3] = '\0';
  rService.szMti[0] = '\0';
  rService.szMti[1] = '\0';
  rService.szMti[2] = '\0';
  rService.szMti[3] = '\0';
  rService.szMti[4] = '\0';
  rService.szProcCode[0] = '\0';
  rService.szProcCode[1] = '\0';
  rService.szProcCode[2] = '\0';
  rService.szFctCode[0] = '\0';
  rService.szFctCode[1] = '\0';
  rService.szFctCode[2] = '\0';
  rService.szFctCode[3] = '\0';
  rService.szSrcAcc[0] = '\0';
  rService.szSrcAcc[1] = '\0';
  rService.szSrcAcc[2] = '\0';
  rService.szDestAcc[0] = '\0';
  sEventCode[0] = '\0';
  sEventCode[1] = '\0';
  sEventCode[2] = '\0';
  sEventCode[3] = '\0';
  sPrimResource[0] = '\0';
  sPrimResource[1] = '\0';
  sPrimResource[2] = '\0';
  sPrimResource[3] = '\0';
  sPrimResource[6] = '\0';
  sSecResource[0] = '\0';
  sSecResource[1] = '\0';
  sSecResource[2] = '\0';
  sSecResource[3] = '\0';
  sSecResource[6] = '\0';
  pcVar6 = sAlternAmount;
  for (lVar5 = 0x200; lVar5 != 0; lVar5 = lVar5 + -1) {
    pcVar6[0] = '\0';
    pcVar6[1] = '\0';
    pcVar6[2] = '\0';
    pcVar6[3] = '\0';
    pcVar6[4] = '\0';
    pcVar6[5] = '\0';
    pcVar6[6] = '\0';
    pcVar6[7] = '\0';
    pcVar6 = pcVar6 + (ulong)bVar7 * -0x10 + 8;
  }
  *pcVar6 = '\0';
  InitTlvAutho(&sTlvInfo);
  sTlvBuffer[0] = '\0';
  sTlvBuffer[1] = '\0';
  sTlvBuffer[2] = '\0';
  sTlvBuffer[3] = '\0';
  sTlvBuffer[4] = '\0';
  sTlvBuffer[5] = '\0';
  sTlvBuffer[6] = '\0';
  sTlvBuffer[7] = '\0';
  iVar3 = IsoToTlv(nIndiceCtx,sIsoMsg,&sTlvInfo);
  if (iVar3 != 0) {
    trace_event("IsoToTlv Error ...",1);
    InsertIsoField(0x26,sIsoMsg,"909",3);
    return -1;
  }
  PutTlvAutho("288",&sTlvInfo,sAuthoTable,3);
  PutTlvAutho("201",&sTlvInfo,sMyResource,6);
  PutTlvAutho("253",&sTlvInfo,sAcquirerBank,6);
  PutTlvAutho("131",&sTlvInfo,InternationalRoutCheck,1);
  AuthoBuildTlv(sTlvBuffer,&sTlvInfo);
  GetIsoField(2,sIsoMsg,slProcCode,&nLength);
  GetIsoField(0x17,sIsoMsg,slFuncCode,&nLength);
  sprintf(rService.szMti,"%04d",(ulong)(uint)sIsoMsg->nMsgType);
  uVar2 = slProcCode._0_4_;
  acVar1 = slFuncCode;
  nLength = 4;
  rService.szProcCode[0] = slProcCode[0];
  rService.szProcCode[1] = slProcCode[1];
  slProcCode._2_2_ = SUB42(uVar2,2);
  rService.szSrcAcc[0] = slProcCode[2];
  rService.szSrcAcc[1] = slProcCode[3];
  rService.szDestAcc[0] = (char)slProcCode._4_2_;
  rService.szDestAcc[1] = SUB21(slProcCode._4_2_,1);
  rService.szFctCode[0] = slFuncCode[0];
  rService.szFctCode[1] = slFuncCode[1];
  slFuncCode[2] = acVar1[2];
  rService.szFctCode[2] = slFuncCode[2];
  slFuncCode = acVar1;
  slProcCode._0_4_ = uVar2;
  uVar4 = CheckResourceServices(nIndiceCtx,sMyResource,&rService);
  if (uVar4 == 0) {
    iVar3 = CheckReqTlvFields(nIndiceCtx,sTlvBuffer);
    if (iVar3 == 0) {
      trace_event(sTlvBuffer,5);
      trace_event("AVANT Load Issuer Data",5);
      PrintTlvBuffer(sTlvBuffer);
      iVar3 = LoadIssuerData(nIndiceCtx,sTlvBuffer,InternationalRoutCheck,sPrimResource,sSecResource
                            );
      sprintf(sLine,"Primary Resource    ...%.6s ",sPrimResource);
      trace_event(sLine,5);
      sprintf(sLine,"Secondarry Resource ...%.6s ",sSecResource);
      trace_event(sLine,5);
      if (iVar3 == 0) {
        iVar3 = memcmp(sPrimResource,"000001",6);
        if (iVar3 == 0) {
          trace_event("Prm : STAND_IN AUTHORISATION PROCESSING",5);
          iVar3 = GetSecurityFlags(nIndiceCtx,sTlvBuffer,"OFF");
          if (((iVar3 == 0) && (iVar3 = PreControl(nIndiceCtx,sTlvBuffer), iVar3 == 0)) &&
             (iVar3 = CheckSecurity(nIndiceCtx,sTlvBuffer), iVar3 == 0)) {
            pcVar6 = sRetCode;
            uVar4 = Statement_Inquiry(nIndiceCtx,sTlvBuffer);
            sRetCode[0] = '\0';
            sRetCode[1] = '\0';
            sRetCode[2] = '\0';
            sRetCode[3] = '\0';
            sprintf(pcVar6,"%03d",(ulong)uVar4);
LAB_00451e70:
            PutTlvBuffer("203",sTlvBuffer,pcVar6,3);
            PrintTlvBuffer(sTlvBuffer);
            iVar3 = AuthorLocalAdm(nIndiceCtx,sTlvBuffer,sIsoMsg,sMyResource,sPrimResource,'N');
            return iVar3;
          }
        }
        else {
          iVar3 = GetTlvBuffer("203",sTlvBuffer,sEventCode,&nLength);
          if (iVar3 == 0) {
            iVar3 = memcmp(sEventCode,&DAT_004caed9,3);
            if (iVar3 != 0) {
              trace_event("PreControl To Run Before Send  AUTHORISATION PROCESSING",5);
              iVar3 = GetSecurityFlags(nIndiceCtx,sTlvBuffer,"ON");
              if (((iVar3 != 0) || (iVar3 = PreControl(nIndiceCtx,sTlvBuffer), iVar3 != 0)) ||
                 (iVar3 = CheckSecurity(nIndiceCtx,sTlvBuffer), iVar3 != 0)) goto LAB_00451bf0;
            }
            iVar3 = CheckResource(nIndiceCtx,sPrimResource,&nPid);
            if ((iVar3 == 0) && (iVar3 = kill(nPid,0), iVar3 == 0)) {
              trace_event("Primary Ressource Up ",5);
              PutTlvBuffer("203",sTlvBuffer,"000",3);
              PrintTlvBuffer(sTlvBuffer);
              iVar3 = AuthorRouting(nIndiceCtx,sTlvBuffer,sPrimResource,nPid,sIsoMsg);
              return iVar3;
            }
            trace_event("Primary Ressource Down ",5);
            iVar3 = memcmp(sSecResource,"000000",6);
            if (iVar3 != 0) {
              iVar3 = memcmp(sSecResource,"000001",6);
              if (iVar3 == 0) {
                trace_event("Sec : STAND_IN AUTHORISATION PROCESSING",5);
                iVar3 = GetSecurityFlags(nIndiceCtx,sTlvBuffer,"OFF");
                if (((iVar3 == 0) && (iVar3 = PreControl(nIndiceCtx,sTlvBuffer), iVar3 == 0)) &&
                   (iVar3 = CheckSecurity(nIndiceCtx,sTlvBuffer), iVar3 == 0)) {
                  uVar4 = Statement_Inquiry(nIndiceCtx,sTlvBuffer);
                  sRetCode[0] = '\0';
                  sRetCode[1] = '\0';
                  sRetCode[2] = '\0';
                  sRetCode[3] = '\0';
                  sprintf(sRetCode,"%03d",(ulong)uVar4);
                  PutTlvBuffer("203",sTlvBuffer,sRetCode,3);
                  pcVar6 = "000";
                  goto LAB_00451e70;
                }
                goto LAB_00451bf0;
              }
              iVar3 = CheckResource(nIndiceCtx,sSecResource,&nPid);
              if (iVar3 == 0) {
                PutTlvBuffer("203",sTlvBuffer,"000",3);
                PrintTlvBuffer(sTlvBuffer);
                iVar3 = AuthorRouting(nIndiceCtx,sTlvBuffer,sSecResource,nPid,sIsoMsg);
                return iVar3;
              }
            }
            PutTlvBuffer("203",sTlvBuffer,"801",3);
          }
        }
      }
    }
  }
  else {
    sprintf(sEventCode,"%03d",(ulong)uVar4);
    PutTlvBuffer("203",sTlvBuffer,sEventCode,3);
  }
LAB_00451bf0:
  iVar3 = AuthorLocal(nIndiceCtx,sTlvBuffer,sIsoMsg,sMyResource,sPrimResource,'N');
  return iVar3;
}



// WARNING: Unknown calling convention

int Statement_Inquiry(int nIndiceCtx,char *sTlvBuffer)

{
  size_t __n;
  ulong uVar1;
  ulong uVar2;
  uint uVar3;
  uchar *puVar4;
  char *pcVar5;
  char *pcVar6;
  bool bVar7;
  byte bVar8;
  uchar auStack_3014 [7480];
  int response_code;
  sqlca sqlca;
  char sLine [512];
  anon_struct_4100_2_43c7b5cf T_tlv_stat;
  
  bVar8 = 0;
  trace_event("Start Statement_Inquiry () ",5);
  puVar4 = T_tlv_stat.arr + 2;
  T_tlv_stat.arr[0] = '\0';
  T_tlv_stat.arr[1] = '\0';
  uVar3 = 0xfff;
  bVar7 = ((ulong)puVar4 & 4) != 0;
  if (bVar7) {
    T_tlv_stat.arr[2] = '\0';
    T_tlv_stat.arr[3] = '\0';
    T_tlv_stat.arr[4] = '\0';
    T_tlv_stat.arr[5] = '\0';
    uVar3 = 0xffb;
    puVar4 = T_tlv_stat.arr + 6;
  }
  for (uVar1 = (ulong)(uVar3 >> 3); uVar1 != 0; uVar1 = uVar1 - 1) {
    puVar4[0] = '\0';
    puVar4[1] = '\0';
    puVar4[2] = '\0';
    puVar4[3] = '\0';
    puVar4[4] = '\0';
    puVar4[5] = '\0';
    puVar4[6] = '\0';
    puVar4[7] = '\0';
    puVar4 = puVar4 + (ulong)bVar8 * -0x10 + 8;
  }
  if (!bVar7) {
    puVar4[0] = '\0';
    puVar4[1] = '\0';
    puVar4[2] = '\0';
    puVar4[3] = '\0';
    puVar4 = puVar4 + 4;
  }
  puVar4[0] = '\0';
  puVar4[1] = '\0';
  puVar4[2] = '\0';
  T_tlv_stat.len = 0;
  __n = strlen(sTlvBuffer);
  memcpy(T_tlv_stat.arr,sTlvBuffer,__n);
  T_tlv_stat.len = (ushort)__n;
  sLine._56_8_ = &sqladt;
  sLine[0x110] = '\0';
  sLine[0x111] = '\0';
  sLine[0x114] = '\0';
  sLine[0x115] = '\0';
  sLine._64_8_ = &sqltds;
  sLine[0x16] = '\0';
  sLine[0x17] = '\x11';
  sLine[0x112] = '\0';
  sLine[0x113] = '\0';
  sLine[0x116] = '\0';
  sLine[0x117] = '\0';
  sLine._48_8_ = s_begin__response_code____PCRD_ATM_004c92a0;
  response_code = 0x38d;
  sLine[0] = '\f';
  sLine[1] = '\0';
  sLine[2] = '\0';
  sLine[3] = '\0';
  sLine[4] = '\0';
  sLine[5] = '\0';
  sLine[6] = '\0';
  sLine[7] = '\0';
  sLine[8] = '\x02';
  sLine[9] = '\0';
  sLine[10] = '\0';
  sLine[0xb] = '\0';
  sLine._32_8_ = sqlcud0;
  sLine._176_8_ = &response_code;
  sLine[0xc] = '\x01';
  sLine[0xd] = '\0';
  sLine[0xe] = '\0';
  sLine[0xf] = '\0';
  sLine[0x10] = '\x05';
  sLine[0x11] = '\0';
  sLine[0x12] = '\0';
  sLine[0x13] = '\0';
  sLine._72_8_ = sLine + 0xb0;
  sLine[0x18] = '\0';
  sLine[0x19] = '\0';
  sLine[0x1a] = '\0';
  sLine[0x1b] = '\0';
  sLine[0xc0] = '\x04';
  sLine[0xc1] = '\0';
  sLine[0xc2] = '\0';
  sLine[0xc3] = '\0';
  sLine[0xc4] = '\0';
  sLine[0xc5] = '\0';
  sLine[0xc6] = '\0';
  sLine[199] = '\0';
  sLine[0xd0] = '\0';
  sLine[0xd1] = '\0';
  sLine[0xd2] = '\0';
  sLine[0xd3] = '\0';
  sLine._80_8_ = sLine + 0xc0;
  sLine[0xd8] = '\0';
  sLine[0xd9] = '\0';
  sLine[0xda] = '\0';
  sLine[0xdb] = '\0';
  sLine[0xdc] = '\0';
  sLine[0xdd] = '\0';
  sLine[0xde] = '\0';
  sLine[0xdf] = '\0';
  sLine[0xe8] = '\0';
  sLine[0xe9] = '\0';
  sLine[0xea] = '\0';
  sLine[0xeb] = '\0';
  sLine[0xf0] = '\0';
  sLine[0xf1] = '\0';
  sLine[0xf2] = '\0';
  sLine[0xf3] = '\0';
  sLine[0xf4] = '\0';
  sLine[0xf5] = '\0';
  sLine[0xf6] = '\0';
  sLine[0xf7] = '\0';
  sLine._88_8_ = sLine + 0xd0;
  sLine[200] = '\x03';
  sLine[0xc9] = '\x10';
  sLine[0xca] = '\0';
  sLine[0xcb] = '\0';
  sLine[0xcc] = '\0';
  sLine[0xcd] = '\0';
  sLine[0xce] = '\0';
  sLine[0xcf] = '\0';
  sLine[0xd4] = '\0';
  sLine[0xd5] = '\0';
  sLine[0xd6] = '\0';
  sLine[0xd7] = '\0';
  sLine._96_8_ = sLine + 0xd8;
  sLine[0xe0] = '\0';
  sLine[0xe1] = '\0';
  sLine[0xe2] = '\0';
  sLine[0xe3] = '\0';
  sLine[0xe4] = '\0';
  sLine[0xe5] = '\0';
  sLine[0xe6] = '\0';
  sLine[0xe7] = '\0';
  sLine[0xec] = '\0';
  sLine[0xed] = '\0';
  sLine[0xee] = '\0';
  sLine[0xef] = '\0';
  sLine[0xf8] = '\0';
  sLine[0xf9] = '\0';
  sLine[0xfa] = '\0';
  sLine[0xfb] = '\0';
  sLine[0xfc] = '\0';
  sLine[0xfd] = '\0';
  sLine[0xfe] = '\0';
  sLine[0xff] = '\0';
  sLine._104_8_ = sLine + 0xe8;
  sLine._112_8_ = sLine + 0xf0;
  sLine._120_8_ = sLine + 0x100;
  sLine._128_8_ = sLine + 0x110;
  sLine._136_8_ = sLine + 0x114;
  sLine._40_8_ = &sqlca;
  sLine._184_8_ = &T_tlv_stat;
  sqlcxt((long)nIndiceCtx * 0x10 + 0x713948,&sqlctx,sLine,&sqlfpn);
  if (sqlca.sqlcode < 0) {
    tlvcpy(sTlvBuffer,(char *)T_tlv_stat.arr,(uint)T_tlv_stat.len);
    sprintf(sLine,"%.40s",sqlca.sqlerrm.sqlerrmc);
    trace_event(sLine,1);
    trace_event("End Statement_Inquiry (SYSTEM_MALFUNCTION)",5);
    response_code = 0x38d;
  }
  else {
    bVar7 = ((ulong)sTlvBuffer & 1) != 0;
    uVar1 = 0x1000;
    pcVar5 = sTlvBuffer;
    if (bVar7) {
      *sTlvBuffer = '\0';
      pcVar5 = sTlvBuffer + 1;
      uVar1 = 0xfff;
    }
    pcVar6 = pcVar5;
    if (((ulong)pcVar5 & 2) != 0) {
      pcVar6 = pcVar5 + 2;
      uVar1 = (ulong)((int)uVar1 - 2);
      pcVar5[0] = '\0';
      pcVar5[1] = '\0';
    }
    if (((ulong)pcVar6 & 4) != 0) {
      pcVar6[0] = '\0';
      pcVar6[1] = '\0';
      pcVar6[2] = '\0';
      pcVar6[3] = '\0';
      uVar1 = (ulong)((int)uVar1 - 4);
      pcVar6 = pcVar6 + 4;
    }
    for (uVar2 = uVar1 >> 3; uVar2 != 0; uVar2 = uVar2 - 1) {
      pcVar6[0] = '\0';
      pcVar6[1] = '\0';
      pcVar6[2] = '\0';
      pcVar6[3] = '\0';
      pcVar6[4] = '\0';
      pcVar6[5] = '\0';
      pcVar6[6] = '\0';
      pcVar6[7] = '\0';
      pcVar6 = pcVar6 + (ulong)bVar8 * -0x10 + 8;
    }
    if ((uVar1 & 4) != 0) {
      pcVar6[0] = '\0';
      pcVar6[1] = '\0';
      pcVar6[2] = '\0';
      pcVar6[3] = '\0';
      pcVar6 = pcVar6 + 4;
    }
    if ((uVar1 & 2) != 0) {
      pcVar6[0] = '\0';
      pcVar6[1] = '\0';
      pcVar6 = pcVar6 + 2;
    }
    if (bVar7) {
      *pcVar6 = '\0';
    }
    tlvcpy(sTlvBuffer,(char *)T_tlv_stat.arr,(uint)T_tlv_stat.len);
    sprintf(sLine,"End Statement_Inquiry (%d)",(ulong)(uint)response_code);
    trace_event(sLine,5);
  }
  return response_code;
}



// WARNING: Unknown calling convention

int Statement_Inquiry_IVR(int nIndiceCtx,char *sTlvBuffer)

{
  size_t __n;
  ulong uVar1;
  ulong uVar2;
  uint uVar3;
  uchar *puVar4;
  char *pcVar5;
  char *pcVar6;
  bool bVar7;
  byte bVar8;
  uchar auStack_3014 [7480];
  int response_code;
  sqlca sqlca;
  char sLine [512];
  anon_struct_4100_2_43c7b5cf T_tlv_stat;
  
  bVar8 = 0;
  trace_event("Start Statement_Inquiry_IVR () ",5);
  puVar4 = T_tlv_stat.arr + 2;
  T_tlv_stat.arr[0] = '\0';
  T_tlv_stat.arr[1] = '\0';
  uVar3 = 0xfff;
  bVar7 = ((ulong)puVar4 & 4) != 0;
  if (bVar7) {
    T_tlv_stat.arr[2] = '\0';
    T_tlv_stat.arr[3] = '\0';
    T_tlv_stat.arr[4] = '\0';
    T_tlv_stat.arr[5] = '\0';
    uVar3 = 0xffb;
    puVar4 = T_tlv_stat.arr + 6;
  }
  for (uVar1 = (ulong)(uVar3 >> 3); uVar1 != 0; uVar1 = uVar1 - 1) {
    puVar4[0] = '\0';
    puVar4[1] = '\0';
    puVar4[2] = '\0';
    puVar4[3] = '\0';
    puVar4[4] = '\0';
    puVar4[5] = '\0';
    puVar4[6] = '\0';
    puVar4[7] = '\0';
    puVar4 = puVar4 + (ulong)bVar8 * -0x10 + 8;
  }
  if (!bVar7) {
    puVar4[0] = '\0';
    puVar4[1] = '\0';
    puVar4[2] = '\0';
    puVar4[3] = '\0';
    puVar4 = puVar4 + 4;
  }
  puVar4[0] = '\0';
  puVar4[1] = '\0';
  puVar4[2] = '\0';
  T_tlv_stat.len = 0;
  __n = strlen(sTlvBuffer);
  memcpy(T_tlv_stat.arr,sTlvBuffer,__n);
  T_tlv_stat.len = (ushort)__n;
  sLine._56_8_ = &sqladt;
  sLine[0x110] = '\0';
  sLine[0x111] = '\0';
  sLine[0x114] = '\0';
  sLine[0x115] = '\0';
  sLine._64_8_ = &sqltds;
  sLine[0x16] = '\0';
  sLine[0x17] = '\x11';
  sLine[0x112] = '\0';
  sLine[0x113] = '\0';
  sLine[0x116] = '\0';
  sLine[0x117] = '\0';
  sLine._48_8_ = s_begin__response_code____PCRD_SPE_004c9348;
  response_code = 0x38d;
  sLine[0] = '\f';
  sLine[1] = '\0';
  sLine[2] = '\0';
  sLine[3] = '\0';
  sLine[4] = '\0';
  sLine[5] = '\0';
  sLine[6] = '\0';
  sLine[7] = '\0';
  sLine[8] = '\x02';
  sLine[9] = '\0';
  sLine[10] = '\0';
  sLine[0xb] = '\0';
  sLine._32_8_ = sqlcud0;
  sLine._176_8_ = &response_code;
  sLine[0xc] = '\x01';
  sLine[0xd] = '\0';
  sLine[0xe] = '\0';
  sLine[0xf] = '\0';
  sLine[0x10] = '\x1c';
  sLine[0x11] = '\0';
  sLine[0x12] = '\0';
  sLine[0x13] = '\0';
  sLine._72_8_ = sLine + 0xb0;
  sLine[0x18] = '\0';
  sLine[0x19] = '\0';
  sLine[0x1a] = '\0';
  sLine[0x1b] = '\0';
  sLine[0xc0] = '\x04';
  sLine[0xc1] = '\0';
  sLine[0xc2] = '\0';
  sLine[0xc3] = '\0';
  sLine[0xc4] = '\0';
  sLine[0xc5] = '\0';
  sLine[0xc6] = '\0';
  sLine[199] = '\0';
  sLine[0xd0] = '\0';
  sLine[0xd1] = '\0';
  sLine[0xd2] = '\0';
  sLine[0xd3] = '\0';
  sLine._80_8_ = sLine + 0xc0;
  sLine[0xd8] = '\0';
  sLine[0xd9] = '\0';
  sLine[0xda] = '\0';
  sLine[0xdb] = '\0';
  sLine[0xdc] = '\0';
  sLine[0xdd] = '\0';
  sLine[0xde] = '\0';
  sLine[0xdf] = '\0';
  sLine[0xe8] = '\0';
  sLine[0xe9] = '\0';
  sLine[0xea] = '\0';
  sLine[0xeb] = '\0';
  sLine[0xf0] = '\0';
  sLine[0xf1] = '\0';
  sLine[0xf2] = '\0';
  sLine[0xf3] = '\0';
  sLine[0xf4] = '\0';
  sLine[0xf5] = '\0';
  sLine[0xf6] = '\0';
  sLine[0xf7] = '\0';
  sLine._88_8_ = sLine + 0xd0;
  sLine[200] = '\x03';
  sLine[0xc9] = '\x10';
  sLine[0xca] = '\0';
  sLine[0xcb] = '\0';
  sLine[0xcc] = '\0';
  sLine[0xcd] = '\0';
  sLine[0xce] = '\0';
  sLine[0xcf] = '\0';
  sLine[0xd4] = '\0';
  sLine[0xd5] = '\0';
  sLine[0xd6] = '\0';
  sLine[0xd7] = '\0';
  sLine._96_8_ = sLine + 0xd8;
  sLine[0xe0] = '\0';
  sLine[0xe1] = '\0';
  sLine[0xe2] = '\0';
  sLine[0xe3] = '\0';
  sLine[0xe4] = '\0';
  sLine[0xe5] = '\0';
  sLine[0xe6] = '\0';
  sLine[0xe7] = '\0';
  sLine[0xec] = '\0';
  sLine[0xed] = '\0';
  sLine[0xee] = '\0';
  sLine[0xef] = '\0';
  sLine[0xf8] = '\0';
  sLine[0xf9] = '\0';
  sLine[0xfa] = '\0';
  sLine[0xfb] = '\0';
  sLine[0xfc] = '\0';
  sLine[0xfd] = '\0';
  sLine[0xfe] = '\0';
  sLine[0xff] = '\0';
  sLine._104_8_ = sLine + 0xe8;
  sLine._112_8_ = sLine + 0xf0;
  sLine._120_8_ = sLine + 0x100;
  sLine._128_8_ = sLine + 0x110;
  sLine._136_8_ = sLine + 0x114;
  sLine._40_8_ = &sqlca;
  sLine._184_8_ = &T_tlv_stat;
  sqlcxt((long)nIndiceCtx * 0x10 + 0x713948,&sqlctx,sLine,&sqlfpn);
  if (sqlca.sqlcode < 0) {
    tlvcpy(sTlvBuffer,(char *)T_tlv_stat.arr,(uint)T_tlv_stat.len);
    sprintf(sLine,"%.40s",sqlca.sqlerrm.sqlerrmc);
    trace_event(sLine,1);
    trace_event("End Statement_Inquiry_IVR (SYSTEM_MALFUNCTION)",5);
    response_code = 0x38d;
  }
  else {
    bVar7 = ((ulong)sTlvBuffer & 1) != 0;
    uVar1 = 0x1000;
    pcVar5 = sTlvBuffer;
    if (bVar7) {
      *sTlvBuffer = '\0';
      pcVar5 = sTlvBuffer + 1;
      uVar1 = 0xfff;
    }
    pcVar6 = pcVar5;
    if (((ulong)pcVar5 & 2) != 0) {
      pcVar6 = pcVar5 + 2;
      uVar1 = (ulong)((int)uVar1 - 2);
      pcVar5[0] = '\0';
      pcVar5[1] = '\0';
    }
    if (((ulong)pcVar6 & 4) != 0) {
      pcVar6[0] = '\0';
      pcVar6[1] = '\0';
      pcVar6[2] = '\0';
      pcVar6[3] = '\0';
      uVar1 = (ulong)((int)uVar1 - 4);
      pcVar6 = pcVar6 + 4;
    }
    for (uVar2 = uVar1 >> 3; uVar2 != 0; uVar2 = uVar2 - 1) {
      pcVar6[0] = '\0';
      pcVar6[1] = '\0';
      pcVar6[2] = '\0';
      pcVar6[3] = '\0';
      pcVar6[4] = '\0';
      pcVar6[5] = '\0';
      pcVar6[6] = '\0';
      pcVar6[7] = '\0';
      pcVar6 = pcVar6 + (ulong)bVar8 * -0x10 + 8;
    }
    if ((uVar1 & 4) != 0) {
      pcVar6[0] = '\0';
      pcVar6[1] = '\0';
      pcVar6[2] = '\0';
      pcVar6[3] = '\0';
      pcVar6 = pcVar6 + 4;
    }
    if ((uVar1 & 2) != 0) {
      pcVar6[0] = '\0';
      pcVar6[1] = '\0';
      pcVar6 = pcVar6 + 2;
    }
    if (bVar7) {
      *pcVar6 = '\0';
    }
    tlvcpy(sTlvBuffer,(char *)T_tlv_stat.arr,(uint)T_tlv_stat.len);
    sprintf(sLine,"End Statement_Inquiry_IVR (%d)",(ulong)(uint)response_code);
    trace_event(sLine,5);
  }
  return response_code;
}



// WARNING: Unknown calling convention

int StopListReplyProcessing(int nIndiceCtx,char *sTlvBuffer)

{
  size_t __n;
  long lVar1;
  ulong uVar2;
  char *pcVar3;
  uchar *puVar4;
  uint uVar5;
  bool bVar6;
  byte bVar7;
  uchar auStack_3014 [3368];
  int response_code;
  sqlca sqlca;
  char sLine [512];
  char buffer_dump [4097];
  anon_struct_4100_2_43c7b5cf T_tlv_auth;
  
  bVar7 = 0;
  trace_event("Start StopListReplyProcessing () ",5);
  pcVar3 = buffer_dump;
  for (lVar1 = 0x200; lVar1 != 0; lVar1 = lVar1 + -1) {
    pcVar3[0] = '\0';
    pcVar3[1] = '\0';
    pcVar3[2] = '\0';
    pcVar3[3] = '\0';
    pcVar3[4] = '\0';
    pcVar3[5] = '\0';
    pcVar3[6] = '\0';
    pcVar3[7] = '\0';
    pcVar3 = pcVar3 + (ulong)bVar7 * -0x10 + 8;
  }
  uVar5 = 0xfff;
  *pcVar3 = '\0';
  puVar4 = T_tlv_auth.arr + 2;
  T_tlv_auth.arr[0] = '\0';
  T_tlv_auth.arr[1] = '\0';
  bVar6 = ((ulong)puVar4 & 4) != 0;
  if (bVar6) {
    T_tlv_auth.arr[2] = '\0';
    T_tlv_auth.arr[3] = '\0';
    T_tlv_auth.arr[4] = '\0';
    T_tlv_auth.arr[5] = '\0';
    uVar5 = 0xffb;
    puVar4 = T_tlv_auth.arr + 6;
  }
  for (uVar2 = (ulong)(uVar5 >> 3); uVar2 != 0; uVar2 = uVar2 - 1) {
    puVar4[0] = '\0';
    puVar4[1] = '\0';
    puVar4[2] = '\0';
    puVar4[3] = '\0';
    puVar4[4] = '\0';
    puVar4[5] = '\0';
    puVar4[6] = '\0';
    puVar4[7] = '\0';
    puVar4 = puVar4 + (ulong)bVar7 * -0x10 + 8;
  }
  if (!bVar6) {
    puVar4[0] = '\0';
    puVar4[1] = '\0';
    puVar4[2] = '\0';
    puVar4[3] = '\0';
    puVar4 = puVar4 + 4;
  }
  puVar4[0] = '\0';
  puVar4[1] = '\0';
  puVar4[2] = '\0';
  T_tlv_auth.len = 0;
  __n = strlen(sTlvBuffer);
  memcpy(T_tlv_auth.arr,sTlvBuffer,__n);
  T_tlv_auth.len = (ushort)__n;
  sLine._40_8_ = &sqlca;
  sLine._56_8_ = &sqladt;
  sLine[0x110] = '\0';
  sLine[0x111] = '\0';
  sLine[0x114] = '\0';
  sLine[0x115] = '\0';
  sLine._64_8_ = &sqltds;
  sLine[0x16] = '\0';
  sLine[0x17] = '\x11';
  sLine[0x112] = '\0';
  sLine[0x113] = '\0';
  sLine[0x116] = '\0';
  sLine[0x117] = '\0';
  sLine._48_8_ = s_begin__response_code____PCRD_P7__004c9418;
  response_code = 0x38d;
  sLine[0] = '\f';
  sLine[1] = '\0';
  sLine[2] = '\0';
  sLine[3] = '\0';
  sLine[4] = '\0';
  sLine[5] = '\0';
  sLine[6] = '\0';
  sLine[7] = '\0';
  sLine[8] = '\x02';
  sLine[9] = '\0';
  sLine[10] = '\0';
  sLine[0xb] = '\0';
  sLine._32_8_ = sqlcud0;
  sLine._176_8_ = &response_code;
  sLine[0xc] = '\x01';
  sLine[0xd] = '\0';
  sLine[0xe] = '\0';
  sLine[0xf] = '\0';
  sLine[0x10] = '\x05';
  sLine[0x11] = '\0';
  sLine[0x12] = '\0';
  sLine[0x13] = '\0';
  sLine._72_8_ = sLine + 0xb0;
  sLine[0x18] = '\0';
  sLine[0x19] = '\0';
  sLine[0x1a] = '\0';
  sLine[0x1b] = '\0';
  sLine[0xc0] = '\x04';
  sLine[0xc1] = '\0';
  sLine[0xc2] = '\0';
  sLine[0xc3] = '\0';
  sLine[0xc4] = '\0';
  sLine[0xc5] = '\0';
  sLine[0xc6] = '\0';
  sLine[199] = '\0';
  sLine[0xd0] = '\0';
  sLine[0xd1] = '\0';
  sLine[0xd2] = '\0';
  sLine[0xd3] = '\0';
  sLine._80_8_ = sLine + 0xc0;
  sLine[0xd8] = '\0';
  sLine[0xd9] = '\0';
  sLine[0xda] = '\0';
  sLine[0xdb] = '\0';
  sLine[0xdc] = '\0';
  sLine[0xdd] = '\0';
  sLine[0xde] = '\0';
  sLine[0xdf] = '\0';
  sLine[0xe8] = '\0';
  sLine[0xe9] = '\0';
  sLine[0xea] = '\0';
  sLine[0xeb] = '\0';
  sLine[0xf0] = '\0';
  sLine[0xf1] = '\0';
  sLine[0xf2] = '\0';
  sLine[0xf3] = '\0';
  sLine[0xf4] = '\0';
  sLine[0xf5] = '\0';
  sLine[0xf6] = '\0';
  sLine[0xf7] = '\0';
  sLine._88_8_ = sLine + 0xd0;
  sLine[200] = '\x03';
  sLine[0xc9] = '\x10';
  sLine[0xca] = '\0';
  sLine[0xcb] = '\0';
  sLine[0xcc] = '\0';
  sLine[0xcd] = '\0';
  sLine[0xce] = '\0';
  sLine[0xcf] = '\0';
  sLine[0xd4] = '\0';
  sLine[0xd5] = '\0';
  sLine[0xd6] = '\0';
  sLine[0xd7] = '\0';
  sLine._96_8_ = sLine + 0xd8;
  sLine[0xe0] = '\0';
  sLine[0xe1] = '\0';
  sLine[0xe2] = '\0';
  sLine[0xe3] = '\0';
  sLine[0xe4] = '\0';
  sLine[0xe5] = '\0';
  sLine[0xe6] = '\0';
  sLine[0xe7] = '\0';
  sLine[0xec] = '\0';
  sLine[0xed] = '\0';
  sLine[0xee] = '\0';
  sLine[0xef] = '\0';
  sLine[0xf8] = '\0';
  sLine[0xf9] = '\0';
  sLine[0xfa] = '\0';
  sLine[0xfb] = '\0';
  sLine[0xfc] = '\0';
  sLine[0xfd] = '\0';
  sLine[0xfe] = '\0';
  sLine[0xff] = '\0';
  sLine._104_8_ = sLine + 0xe8;
  sLine._112_8_ = sLine + 0xf0;
  sLine._120_8_ = sLine + 0x100;
  sLine._128_8_ = sLine + 0x110;
  sLine._136_8_ = sLine + 0x114;
  sLine._184_8_ = &T_tlv_auth;
  sqlcxt((long)nIndiceCtx * 0x10 + 0x713948,&sqlctx,sLine,&sqlfpn);
  if (sqlca.sqlcode < 0) {
    sprintf(sLine,"%.40s",sqlca.sqlerrm.sqlerrmc);
    trace_event(sLine,1);
    trace_event("End StopListReplyProcessing (SYSTEM_MALFUNCTION)",5);
    response_code = 0x38d;
  }
  else {
    uVar2 = 0;
    if (response_code != 0) {
      memcpy(buffer_dump,T_tlv_auth.arr,(ulong)T_tlv_auth.len);
      PrintTlvBuffer(buffer_dump);
      uVar2 = (ulong)(uint)response_code;
    }
    sprintf(sLine,"End StopListReplyProcessing (%d)",uVar2);
    trace_event(sLine,5);
  }
  return response_code;
}



// WARNING: Unknown calling convention

int BalanceInquiry(int nIndiceCtx,char *sTlvBuffer)

{
  size_t __n;
  ulong uVar1;
  uchar *puVar2;
  uint uVar3;
  bool bVar4;
  byte bVar5;
  uchar auStack_3004 [7480];
  int response_code;
  sqlca sqlca;
  char sLine [512];
  anon_struct_4100_2_43c7b5cf T_tlv_bal;
  
  bVar5 = 0;
  trace_event("Start Balance_Inquiry () ",5);
  puVar2 = T_tlv_bal.arr + 2;
  uVar3 = 0xfff;
  T_tlv_bal.arr[0] = '\0';
  T_tlv_bal.arr[1] = '\0';
  bVar4 = ((ulong)puVar2 & 4) != 0;
  if (bVar4) {
    T_tlv_bal.arr[2] = '\0';
    T_tlv_bal.arr[3] = '\0';
    T_tlv_bal.arr[4] = '\0';
    T_tlv_bal.arr[5] = '\0';
    uVar3 = 0xffb;
    puVar2 = T_tlv_bal.arr + 6;
  }
  for (uVar1 = (ulong)(uVar3 >> 3); uVar1 != 0; uVar1 = uVar1 - 1) {
    puVar2[0] = '\0';
    puVar2[1] = '\0';
    puVar2[2] = '\0';
    puVar2[3] = '\0';
    puVar2[4] = '\0';
    puVar2[5] = '\0';
    puVar2[6] = '\0';
    puVar2[7] = '\0';
    puVar2 = puVar2 + (ulong)bVar5 * -0x10 + 8;
  }
  if (!bVar4) {
    puVar2[0] = '\0';
    puVar2[1] = '\0';
    puVar2[2] = '\0';
    puVar2[3] = '\0';
    puVar2 = puVar2 + 4;
  }
  puVar2[0] = '\0';
  puVar2[1] = '\0';
  puVar2[2] = '\0';
  puVar2 = T_tlv_bal.arr;
  T_tlv_bal.len = 0;
  __n = strlen(sTlvBuffer);
  memcpy(puVar2,sTlvBuffer,__n);
  T_tlv_bal.len = (ushort)__n;
  sLine._40_8_ = &sqlca;
  sLine._56_8_ = &sqladt;
  sLine._64_8_ = &sqltds;
  sLine[0x16] = '\0';
  sLine[0x17] = '\x11';
  sLine[0x110] = '\0';
  sLine[0x111] = '\0';
  sLine[0x114] = '\0';
  sLine[0x115] = '\0';
  sLine._48_8_ = s_begin__response_code____PCRD_P7__004c9510;
  sLine[0x112] = '\0';
  sLine[0x113] = '\0';
  sLine[0x116] = '\0';
  sLine[0x117] = '\0';
  response_code = 0x38d;
  sLine._32_8_ = sqlcud0;
  sLine._176_8_ = &response_code;
  sLine[0] = '\f';
  sLine[1] = '\0';
  sLine[2] = '\0';
  sLine[3] = '\0';
  sLine[4] = '\0';
  sLine[5] = '\0';
  sLine[6] = '\0';
  sLine[7] = '\0';
  sLine[8] = '\x02';
  sLine[9] = '\0';
  sLine[10] = '\0';
  sLine[0xb] = '\0';
  sLine[0xc] = '\x01';
  sLine[0xd] = '\0';
  sLine[0xe] = '\0';
  sLine[0xf] = '\0';
  sLine._72_8_ = sLine + 0xb0;
  sLine[0x10] = '\x05';
  sLine[0x11] = '\0';
  sLine[0x12] = '\0';
  sLine[0x13] = '\0';
  sLine[0x18] = '\0';
  sLine[0x19] = '\0';
  sLine[0x1a] = '\0';
  sLine[0x1b] = '\0';
  sLine._80_8_ = sLine + 0xc0;
  sLine[0xc0] = '\x04';
  sLine[0xc1] = '\0';
  sLine[0xc2] = '\0';
  sLine[0xc3] = '\0';
  sLine[0xc4] = '\0';
  sLine[0xc5] = '\0';
  sLine[0xc6] = '\0';
  sLine[199] = '\0';
  sLine[0xd0] = '\0';
  sLine[0xd1] = '\0';
  sLine[0xd2] = '\0';
  sLine[0xd3] = '\0';
  sLine[0xd8] = '\0';
  sLine[0xd9] = '\0';
  sLine[0xda] = '\0';
  sLine[0xdb] = '\0';
  sLine[0xdc] = '\0';
  sLine[0xdd] = '\0';
  sLine[0xde] = '\0';
  sLine[0xdf] = '\0';
  sLine._88_8_ = sLine + 0xd0;
  sLine[0xe8] = '\0';
  sLine[0xe9] = '\0';
  sLine[0xea] = '\0';
  sLine[0xeb] = '\0';
  sLine[0xf0] = '\0';
  sLine[0xf1] = '\0';
  sLine[0xf2] = '\0';
  sLine[0xf3] = '\0';
  sLine[0xf4] = '\0';
  sLine[0xf5] = '\0';
  sLine[0xf6] = '\0';
  sLine[0xf7] = '\0';
  sLine[200] = '\x03';
  sLine[0xc9] = '\x10';
  sLine[0xca] = '\0';
  sLine[0xcb] = '\0';
  sLine[0xcc] = '\0';
  sLine[0xcd] = '\0';
  sLine[0xce] = '\0';
  sLine[0xcf] = '\0';
  sLine._96_8_ = sLine + 0xd8;
  sLine[0xd4] = '\0';
  sLine[0xd5] = '\0';
  sLine[0xd6] = '\0';
  sLine[0xd7] = '\0';
  sLine[0xe0] = '\0';
  sLine[0xe1] = '\0';
  sLine[0xe2] = '\0';
  sLine[0xe3] = '\0';
  sLine[0xe4] = '\0';
  sLine[0xe5] = '\0';
  sLine[0xe6] = '\0';
  sLine[0xe7] = '\0';
  sLine[0xec] = '\0';
  sLine[0xed] = '\0';
  sLine[0xee] = '\0';
  sLine[0xef] = '\0';
  sLine._104_8_ = sLine + 0xe8;
  sLine[0xf8] = '\0';
  sLine[0xf9] = '\0';
  sLine[0xfa] = '\0';
  sLine[0xfb] = '\0';
  sLine[0xfc] = '\0';
  sLine[0xfd] = '\0';
  sLine[0xfe] = '\0';
  sLine[0xff] = '\0';
  sLine._112_8_ = sLine + 0xf0;
  sLine._120_8_ = sLine + 0x100;
  sLine._128_8_ = sLine + 0x110;
  sLine._136_8_ = sLine + 0x114;
  sLine._184_8_ = &T_tlv_bal;
  sqlcxt((long)nIndiceCtx * 0x10 + 0x713948,&sqlctx,sLine,&sqlfpn);
  if (-1 < sqlca.sqlcode) {
    tlvcpy(sTlvBuffer,(char *)puVar2,(uint)T_tlv_bal.len);
    sprintf(sLine,"End Balance_Inquiry (%d)",(ulong)(uint)response_code);
    trace_event(sLine,5);
    return response_code;
  }
  tlvcpy(sTlvBuffer,(char *)puVar2,(uint)T_tlv_bal.len);
  sprintf(sLine,"%.40s",sqlca.sqlerrm.sqlerrmc);
  trace_event(sLine,1);
  trace_event("End Balance_Inquiry (SYSTEM_MALFUNCTION)",5);
  return 0x38d;
}



// WARNING: Unknown calling convention

int AutSafProcessing(int nIndiceCtx,char *sTlvBuffer,char *sSrcResource,char *sDestResource)

{
  size_t __n;
  ulong uVar1;
  uint uVar2;
  uchar *puVar3;
  bool bVar4;
  byte bVar5;
  uchar auStack_3014 [6964];
  int nLength;
  int response_code;
  char sMsgType [5];
  char T_src_resource [7];
  char T_dst_resource [7];
  anon_struct_10_2_43c7b5cf T_tlv_warning;
  sqlca sqlca;
  sqlexd_conflict1 sqlstm;
  char sLine [512];
  anon_struct_4100_2_43c7b5cf T_tlv_auth;
  
  bVar5 = 0;
  sprintf(sLine,"Start AutSafProcessing (%s|%s) ");
  trace_event(sLine,5);
  puVar3 = T_tlv_auth.arr + 2;
  uVar2 = 0xfff;
  T_tlv_auth.arr[0] = '\0';
  T_tlv_auth.arr[1] = '\0';
  bVar4 = ((ulong)puVar3 & 4) != 0;
  if (bVar4) {
    T_tlv_auth.arr[2] = '\0';
    T_tlv_auth.arr[3] = '\0';
    T_tlv_auth.arr[4] = '\0';
    T_tlv_auth.arr[5] = '\0';
    uVar2 = 0xffb;
    puVar3 = T_tlv_auth.arr + 6;
  }
  for (uVar1 = (ulong)(uVar2 >> 3); uVar1 != 0; uVar1 = uVar1 - 1) {
    puVar3[0] = '\0';
    puVar3[1] = '\0';
    puVar3[2] = '\0';
    puVar3[3] = '\0';
    puVar3[4] = '\0';
    puVar3[5] = '\0';
    puVar3[6] = '\0';
    puVar3[7] = '\0';
    puVar3 = puVar3 + (ulong)bVar5 * -0x10 + 8;
  }
  if (!bVar4) {
    puVar3[0] = '\0';
    puVar3[1] = '\0';
    puVar3[2] = '\0';
    puVar3[3] = '\0';
    puVar3 = puVar3 + 4;
  }
  puVar3[0] = '\0';
  puVar3[1] = '\0';
  puVar3[2] = '\0';
  T_dst_resource[4] = '\0';
  T_dst_resource[5] = '\0';
  T_tlv_warning.len = 0;
  T_tlv_warning.arr[4] = '\0';
  T_tlv_warning.arr[5] = '\0';
  T_src_resource[4] = '\0';
  T_src_resource[5] = '\0';
  T_tlv_auth.len = 0;
  T_tlv_warning.arr[0] = '\0';
  T_tlv_warning.arr[1] = '\0';
  T_tlv_warning.arr[2] = '\0';
  T_tlv_warning.arr[3] = '\0';
  T_tlv_warning.arr[6] = '\0';
  T_src_resource[0] = '\0';
  T_src_resource[1] = '\0';
  T_src_resource[2] = '\0';
  T_src_resource[3] = '\0';
  T_src_resource[6] = '\0';
  T_dst_resource[0] = '\0';
  T_dst_resource[1] = '\0';
  T_dst_resource[2] = '\0';
  T_dst_resource[3] = '\0';
  T_dst_resource[6] = '\0';
  __n = strlen(sTlvBuffer);
  memcpy(T_tlv_auth.arr,sTlvBuffer,__n);
  T_src_resource._0_4_ = *(undefined4 *)sSrcResource;
  sMsgType[0] = '\0';
  sMsgType[1] = '\0';
  sMsgType[2] = '\0';
  sMsgType[3] = '\0';
  sMsgType[4] = '\0';
  T_src_resource._4_2_ = *(undefined2 *)(sSrcResource + 4);
  T_tlv_auth.len = (ushort)__n;
  T_dst_resource._0_4_ = *(undefined4 *)sDestResource;
  T_dst_resource._4_2_ = *(undefined2 *)(sDestResource + 4);
  GetTlvBuffer("300",sTlvBuffer,sMsgType,&nLength);
  sMsgType[2] = '2';
  sMsgType[3] = '0';
  PutTlvBuffer("300",(char *)T_tlv_auth.arr,sMsgType,4);
  sqlstm.sqtdso[0] = 0;
  sqlstm.sqladtp = &sqladt;
  sqlstm.sqlety = 0x1100;
  sqlstm.sqadto[0] = 0;
  sqlstm.sqltdsp = &sqltds;
  response_code = 0x38d;
  sqlstm.sqlvsn = 0xc;
  sqlstm.stmt = 
  "begin :response_code := PCRD_SAF_MANAGE . SAF_PROCESSING ( :T_tlv_auth , :T_src_resource , :T_dst_resource , :T_tlv_warning ) ; END ;"
  ;
  sqlstm.arrsiz = 5;
  sqlstm.iters = 1;
  sqlstm.offset = 5;
  sqlstm.cud = sqlcud0;
  sqlstm.sqhstv[0] = (uchar *)&response_code;
  sqlstm.occurs = 0;
  sqlstm.sqhstl[0] = 4;
  sqlstm.sqhsts[0] = 0;
  sqlstm.sqindv[0] = (short *)0x0;
  sqlstm.sqinds[0] = 0;
  sqlstm.sqharm[0] = 0;
  sqlstm.sqhstl[1] = 0x1003;
  sqlstm.sqhsts[1] = 0;
  sqlstm.sqindv[1] = (short *)0x0;
  sqlstm.sqinds[1] = 0;
  sqlstm.sqharm[1] = 0;
  sqlstm.sqadto[1] = 0;
  sqlstm.sqtdso[1] = 0;
  sqlstm.sqhstl[2] = 7;
  sqlstm.sqhsts[2] = 0;
  sqlstm.sqindv[2] = (short *)0x0;
  sqlstm.sqinds[2] = 0;
  sqlstm.sqtdso[2] = 0;
  sqlstm.sqadto[3] = 0;
  sqlstm.sqtdso[3] = 0;
  sqlstm.sqadto[4] = 0;
  sqlstm.sqharm[2] = 0;
  sqlstm.sqtdso[4] = 0;
  sqlstm.sqphsv = sqlstm.sqhstv;
  sqlstm.sqadto[2] = 0;
  sqlstm.sqphsl = sqlstm.sqhstl;
  sqlstm.sqhstl[3] = 7;
  sqlstm.sqhsts[3] = 0;
  sqlstm.sqphss = sqlstm.sqhsts;
  sqlstm.sqindv[3] = (short *)0x0;
  sqlstm.sqinds[3] = 0;
  sqlstm.sqharm[3] = 0;
  sqlstm.sqpind = sqlstm.sqindv;
  sqlstm.sqhstl[4] = 9;
  sqlstm.sqhsts[4] = 0;
  sqlstm.sqpins = sqlstm.sqinds;
  sqlstm.sqindv[4] = (short *)0x0;
  sqlstm.sqinds[4] = 0;
  sqlstm.sqharm[4] = 0;
  sqlstm.sqparm = sqlstm.sqharm;
  sqlstm.sqparc = sqlstm.sqharc;
  sqlstm.sqpadto = sqlstm.sqadto;
  sqlstm.sqptdso = sqlstm.sqtdso;
  sqlstm.sqlest = (uchar *)&sqlca;
  sqlstm.sqhstv[1] = (uchar *)&T_tlv_auth;
  sqlstm.sqhstv[2] = (uchar *)T_src_resource;
  sqlstm.sqhstv[3] = (uchar *)T_dst_resource;
  sqlstm.sqhstv[4] = (uchar *)&T_tlv_warning;
  sqlcxt((long)nIndiceCtx * 0x10 + 0x713948,&sqlctx,&sqlstm,&sqlfpn);
  if (sqlca.sqlcode < 0) {
    sprintf(sLine,"%.40s",sqlca.sqlerrm.sqlerrmc);
    trace_event(sLine,1);
    trace_event("End AutSafProcessing (SYSTEM_MALFUNCTION)",5);
    response_code = 0x38d;
  }
  else {
    sprintf(sLine,"End AutSafProcessing (%d,%.6s)",(ulong)(uint)response_code,T_tlv_warning.arr);
    trace_event(sLine,5);
  }
  return response_code;
}



// WARNING: Unknown calling convention

int CheckDynamicAdvice(int nIndiceCtx,char *sSrcResource)

{
  int response_code;
  char T_src_resource [7];
  sqlca sqlca;
  sqlexd_conflict1 sqlstm;
  char sLine [512];
  
  sprintf(sLine,"Start CheckDynamicAdvice (%s) ",sSrcResource);
  trace_event(sLine,5);
  T_src_resource._0_4_ = *(undefined4 *)sSrcResource;
  sqlstm.sqhstv[1] = (uchar *)T_src_resource;
  sqlstm.sqladtp = &sqladt;
  T_src_resource._4_2_ = *(undefined2 *)(sSrcResource + 4);
  sqlstm.sqlest = (uchar *)&sqlca;
  sqlstm.sqltdsp = &sqltds;
  sqlstm.cud = sqlcud0;
  sqlstm.sqadto[1] = 0;
  sqlstm.sqtdso[1] = 0;
  sqlstm.stmt = 
  "begin :response_code := PCRD_SAF_MANAGE . CHECK_DYNAMIC_ADVICE ( :T_src_resource ) ; END ;";
  sqlstm.sqtdso[0] = 0;
  sqlstm.sqadto[0] = 0;
  sqlstm.sqlety = 0x1100;
  sqlstm.sqhstv[0] = (uchar *)&response_code;
  T_src_resource[6] = '\0';
  response_code = 0x38d;
  sqlstm.sqlvsn = 0xc;
  sqlstm.arrsiz = 5;
  sqlstm.iters = 1;
  sqlstm.offset = 0x28;
  sqlstm.sqphsv = sqlstm.sqhstv;
  sqlstm.occurs = 0;
  sqlstm.sqhstl[0] = 4;
  sqlstm.sqhsts[0] = 0;
  sqlstm.sqindv[0] = (short *)0x0;
  sqlstm.sqinds[0] = 0;
  sqlstm.sqharm[0] = 0;
  sqlstm.sqhstl[1] = 7;
  sqlstm.sqhsts[1] = 0;
  sqlstm.sqindv[1] = (short *)0x0;
  sqlstm.sqinds[1] = 0;
  sqlstm.sqharm[1] = 0;
  sqlstm.sqphsl = sqlstm.sqhstl;
  sqlstm.sqphss = sqlstm.sqhsts;
  sqlstm.sqpind = sqlstm.sqindv;
  sqlstm.sqpins = sqlstm.sqinds;
  sqlstm.sqparm = sqlstm.sqharm;
  sqlstm.sqparc = sqlstm.sqharc;
  sqlstm.sqpadto = sqlstm.sqadto;
  sqlstm.sqptdso = sqlstm.sqtdso;
  sqlcxt((long)nIndiceCtx * 0x10 + 0x713948,&sqlctx,&sqlstm,&sqlfpn);
  if (-1 < sqlca.sqlcode) {
    sprintf(sLine,"End CheckDynamicAdvice (%d)",(ulong)(uint)response_code);
    trace_event(sLine,5);
    return response_code;
  }
  sprintf(sLine,"%.40s",sqlca.sqlerrm.sqlerrmc);
  trace_event(sLine,1);
  trace_event("End CheckDynamicAdvice (SYSTEM_MALFUNCTION)",5);
  return 0x38d;
}



// WARNING: Unknown calling convention

int InsertSettlement(int nIndiceCtx,char *sTlvBuffer,char *sSettlementType)

{
  size_t __n;
  ulong uVar1;
  uchar *puVar2;
  uint uVar3;
  bool bVar4;
  byte bVar5;
  uchar auStack_3014 [7452];
  char T_settlement_type [4];
  int response_code;
  anon_struct_10_2_43c7b5cf T_tlv_warning;
  sqlca sqlca;
  char sLine [512];
  anon_struct_4100_2_43c7b5cf T_tlv_auth;
  
  bVar5 = 0;
  trace_event("Start InsertSettlement () ",5);
  PrintTlvBuffer(sTlvBuffer);
  puVar2 = T_tlv_auth.arr + 2;
  T_settlement_type[0] = '\0';
  T_settlement_type[1] = '\0';
  T_settlement_type[2] = '\0';
  T_settlement_type[3] = '\0';
  T_tlv_auth.arr[0] = '\0';
  T_tlv_auth.arr[1] = '\0';
  uVar3 = 0xfff;
  bVar4 = ((ulong)puVar2 & 4) != 0;
  if (bVar4) {
    T_tlv_auth.arr[2] = '\0';
    T_tlv_auth.arr[3] = '\0';
    T_tlv_auth.arr[4] = '\0';
    T_tlv_auth.arr[5] = '\0';
    uVar3 = 0xffb;
    puVar2 = T_tlv_auth.arr + 6;
  }
  for (uVar1 = (ulong)(uVar3 >> 3); uVar1 != 0; uVar1 = uVar1 - 1) {
    puVar2[0] = '\0';
    puVar2[1] = '\0';
    puVar2[2] = '\0';
    puVar2[3] = '\0';
    puVar2[4] = '\0';
    puVar2[5] = '\0';
    puVar2[6] = '\0';
    puVar2[7] = '\0';
    puVar2 = puVar2 + (ulong)bVar5 * -0x10 + 8;
  }
  if (!bVar4) {
    puVar2[0] = '\0';
    puVar2[1] = '\0';
    puVar2[2] = '\0';
    puVar2[3] = '\0';
    puVar2 = puVar2 + 4;
  }
  puVar2[0] = '\0';
  puVar2[1] = '\0';
  puVar2[2] = '\0';
  T_tlv_warning.len = 0;
  T_tlv_warning.arr[4] = '\0';
  T_tlv_warning.arr[5] = '\0';
  T_tlv_auth.len = 0;
  T_tlv_warning.arr[0] = '\0';
  T_tlv_warning.arr[1] = '\0';
  T_tlv_warning.arr[2] = '\0';
  T_tlv_warning.arr[3] = '\0';
  T_tlv_warning.arr[6] = '\0';
  __n = strlen(sTlvBuffer);
  memcpy(T_tlv_auth.arr,sTlvBuffer,__n);
  T_settlement_type = *(char (*) [4])sSettlementType;
  sLine._40_8_ = &sqlca;
  T_tlv_auth.len = (ushort)__n;
  sLine[0x1d0] = '\0';
  sLine[0x1d1] = '\0';
  sLine[0x16] = '\0';
  sLine[0x17] = '\x11';
  sLine[0x1dc] = '\0';
  sLine[0x1dd] = '\0';
  sLine[0x1d2] = '\0';
  sLine[0x1d3] = '\0';
  sLine._56_8_ = &sqladt;
  sLine[0x1de] = '\0';
  sLine[0x1df] = '\0';
  response_code = 0x38d;
  sLine._64_8_ = &sqltds;
  sLine[0] = '\f';
  sLine[1] = '\0';
  sLine[2] = '\0';
  sLine[3] = '\0';
  sLine[4] = '\0';
  sLine[5] = '\0';
  sLine[6] = '\0';
  sLine[7] = '\0';
  sLine[8] = '\x04';
  sLine[9] = '\0';
  sLine[10] = '\0';
  sLine[0xb] = '\0';
  sLine[0xc] = '\x01';
  sLine[0xd] = '\0';
  sLine[0xe] = '\0';
  sLine[0xf] = '\0';
  sLine._48_8_ = s_begin__response_code____PCRD_P7__004c97f8;
  sLine[0x10] = '\x05';
  sLine[0x11] = '\0';
  sLine[0x12] = '\0';
  sLine[0x13] = '\0';
  sLine[0x18] = '\0';
  sLine[0x19] = '\0';
  sLine[0x1a] = '\0';
  sLine[0x1b] = '\0';
  sLine._32_8_ = sqlcud0;
  sLine._176_8_ = &response_code;
  sLine[0xe0] = '\x04';
  sLine[0xe1] = '\0';
  sLine[0xe2] = '\0';
  sLine[0xe3] = '\0';
  sLine[0xe4] = '\0';
  sLine[0xe5] = '\0';
  sLine[0xe6] = '\0';
  sLine[0xe7] = '\0';
  sLine[0x110] = '\0';
  sLine[0x111] = '\0';
  sLine[0x112] = '\0';
  sLine[0x113] = '\0';
  sLine[0x128] = '\0';
  sLine[0x129] = '\0';
  sLine[0x12a] = '\0';
  sLine[299] = '\0';
  sLine[300] = '\0';
  sLine[0x12d] = '\0';
  sLine[0x12e] = '\0';
  sLine[0x12f] = '\0';
  sLine._184_8_ = T_settlement_type;
  sLine[0x158] = '\0';
  sLine[0x159] = '\0';
  sLine[0x15a] = '\0';
  sLine[0x15b] = '\0';
  sLine[0x170] = '\0';
  sLine[0x171] = '\0';
  sLine[0x172] = '\0';
  sLine[0x173] = '\0';
  sLine[0x174] = '\0';
  sLine[0x175] = '\0';
  sLine[0x176] = '\0';
  sLine[0x177] = '\0';
  sLine[0xe8] = '\x04';
  sLine[0xe9] = '\0';
  sLine[0xea] = '\0';
  sLine[0xeb] = '\0';
  sLine[0xec] = '\0';
  sLine[0xed] = '\0';
  sLine[0xee] = '\0';
  sLine[0xef] = '\0';
  sLine[0x114] = '\0';
  sLine[0x115] = '\0';
  sLine[0x116] = '\0';
  sLine[0x117] = '\0';
  sLine[0x130] = '\0';
  sLine[0x131] = '\0';
  sLine[0x132] = '\0';
  sLine[0x133] = '\0';
  sLine[0x134] = '\0';
  sLine[0x135] = '\0';
  sLine[0x136] = '\0';
  sLine[0x137] = '\0';
  sLine[0x15c] = '\0';
  sLine[0x15d] = '\0';
  sLine[0x15e] = '\0';
  sLine[0x15f] = '\0';
  sLine[0x178] = '\0';
  sLine[0x179] = '\0';
  sLine[0x17a] = '\0';
  sLine[0x17b] = '\0';
  sLine[0x17c] = '\0';
  sLine[0x17d] = '\0';
  sLine[0x17e] = '\0';
  sLine[0x17f] = '\0';
  sLine[0xf0] = '\x03';
  sLine[0xf1] = '\x10';
  sLine[0xf2] = '\0';
  sLine[0xf3] = '\0';
  sLine[0xf4] = '\0';
  sLine[0xf5] = '\0';
  sLine[0xf6] = '\0';
  sLine[0xf7] = '\0';
  sLine[0x118] = '\0';
  sLine[0x119] = '\0';
  sLine[0x11a] = '\0';
  sLine[0x11b] = '\0';
  sLine[0x1e0] = '\0';
  sLine[0x1e1] = '\0';
  sLine._72_8_ = sLine + 0xb0;
  sLine[0x138] = '\0';
  sLine[0x139] = '\0';
  sLine[0x13a] = '\0';
  sLine[0x13b] = '\0';
  sLine[0x13c] = '\0';
  sLine[0x13d] = '\0';
  sLine[0x13e] = '\0';
  sLine[0x13f] = '\0';
  sLine[0x160] = '\0';
  sLine[0x161] = '\0';
  sLine[0x162] = '\0';
  sLine[0x163] = '\0';
  sLine[0x180] = '\0';
  sLine[0x181] = '\0';
  sLine[0x182] = '\0';
  sLine[0x183] = '\0';
  sLine[0x184] = '\0';
  sLine[0x185] = '\0';
  sLine[0x186] = '\0';
  sLine[0x187] = '\0';
  sLine._80_8_ = sLine + 0xe0;
  sLine[0x1d4] = '\0';
  sLine[0x1d5] = '\0';
  sLine[0xf8] = '\t';
  sLine[0xf9] = '\0';
  sLine[0xfa] = '\0';
  sLine[0xfb] = '\0';
  sLine[0xfc] = '\0';
  sLine[0xfd] = '\0';
  sLine[0xfe] = '\0';
  sLine[0xff] = '\0';
  sLine._88_8_ = sLine + 0x110;
  sLine[0x11c] = '\0';
  sLine[0x11d] = '\0';
  sLine[0x11e] = '\0';
  sLine[0x11f] = '\0';
  sLine[0x140] = '\0';
  sLine[0x141] = '\0';
  sLine[0x142] = '\0';
  sLine[0x143] = '\0';
  sLine[0x144] = '\0';
  sLine[0x145] = '\0';
  sLine[0x146] = '\0';
  sLine[0x147] = '\0';
  sLine[0x164] = '\0';
  sLine[0x165] = '\0';
  sLine[0x166] = '\0';
  sLine[0x167] = '\0';
  sLine._96_8_ = sLine + 0x128;
  sLine[0x188] = '\0';
  sLine[0x189] = '\0';
  sLine[0x18a] = '\0';
  sLine[0x18b] = '\0';
  sLine[0x18c] = '\0';
  sLine[0x18d] = '\0';
  sLine[0x18e] = '\0';
  sLine[399] = '\0';
  sLine[0x1d6] = '\0';
  sLine[0x1d7] = '\0';
  sLine[0x1e2] = '\0';
  sLine[0x1e3] = '\0';
  sLine._104_8_ = sLine + 0x158;
  sLine._112_8_ = sLine + 0x170;
  sLine._120_8_ = sLine + 0x1a0;
  sLine._128_8_ = sLine + 0x1d0;
  sLine._136_8_ = sLine + 0x1dc;
  sLine._192_8_ = &T_tlv_auth;
  sLine._200_8_ = &T_tlv_warning;
  sqlcxt((long)nIndiceCtx * 0x10 + 0x713948,&sqlctx,sLine,&sqlfpn);
  if (sqlca.sqlcode < 0) {
    sprintf(sLine,"%.40s",sqlca.sqlerrm.sqlerrmc);
    trace_event(sLine,1);
    trace_event("End InsertSettlement (SYSTEM_MALFUNCTION)",5);
    response_code = 0x38d;
  }
  else {
    sprintf(sLine,"End InsertSettlement (%d,%.6s)",(ulong)(uint)response_code,T_tlv_warning.arr);
    trace_event(sLine,5);
  }
  return response_code;
}



// WARNING: Unknown calling convention

int UpdateSettlement(int nIndiceCtx,char *sTlvBuffer)

{
  size_t __n;
  long lVar1;
  ulong uVar2;
  char *pcVar3;
  uchar *puVar4;
  uint uVar5;
  bool bVar6;
  byte bVar7;
  uchar auStack_3014 [3352];
  int response_code;
  anon_struct_10_2_43c7b5cf T_tlv_warning;
  sqlca sqlca;
  char sLine [512];
  char buffer_dump [4097];
  anon_struct_4100_2_43c7b5cf T_tlv_auth;
  
  bVar7 = 0;
  trace_event("Start UpdateSettlement () ",5);
  uVar5 = 0xfff;
  pcVar3 = buffer_dump;
  for (lVar1 = 0x200; lVar1 != 0; lVar1 = lVar1 + -1) {
    pcVar3[0] = '\0';
    pcVar3[1] = '\0';
    pcVar3[2] = '\0';
    pcVar3[3] = '\0';
    pcVar3[4] = '\0';
    pcVar3[5] = '\0';
    pcVar3[6] = '\0';
    pcVar3[7] = '\0';
    pcVar3 = pcVar3 + (ulong)bVar7 * -0x10 + 8;
  }
  *pcVar3 = '\0';
  puVar4 = T_tlv_auth.arr + 2;
  T_tlv_auth.arr[0] = '\0';
  T_tlv_auth.arr[1] = '\0';
  bVar6 = ((ulong)puVar4 & 4) != 0;
  if (bVar6) {
    T_tlv_auth.arr[2] = '\0';
    T_tlv_auth.arr[3] = '\0';
    T_tlv_auth.arr[4] = '\0';
    T_tlv_auth.arr[5] = '\0';
    uVar5 = 0xffb;
    puVar4 = T_tlv_auth.arr + 6;
  }
  for (uVar2 = (ulong)(uVar5 >> 3); uVar2 != 0; uVar2 = uVar2 - 1) {
    puVar4[0] = '\0';
    puVar4[1] = '\0';
    puVar4[2] = '\0';
    puVar4[3] = '\0';
    puVar4[4] = '\0';
    puVar4[5] = '\0';
    puVar4[6] = '\0';
    puVar4[7] = '\0';
    puVar4 = puVar4 + (ulong)bVar7 * -0x10 + 8;
  }
  if (!bVar6) {
    puVar4[0] = '\0';
    puVar4[1] = '\0';
    puVar4[2] = '\0';
    puVar4[3] = '\0';
    puVar4 = puVar4 + 4;
  }
  puVar4[0] = '\0';
  puVar4[1] = '\0';
  puVar4[2] = '\0';
  T_tlv_warning.arr[4] = '\0';
  T_tlv_warning.arr[5] = '\0';
  T_tlv_auth.len = 0;
  T_tlv_warning.len = 0;
  T_tlv_warning.arr[0] = '\0';
  T_tlv_warning.arr[1] = '\0';
  T_tlv_warning.arr[2] = '\0';
  T_tlv_warning.arr[3] = '\0';
  T_tlv_warning.arr[6] = '\0';
  __n = strlen(sTlvBuffer);
  memcpy(T_tlv_auth.arr,sTlvBuffer,__n);
  T_tlv_auth.len = (ushort)__n;
  sLine._40_8_ = &sqlca;
  sLine._56_8_ = &sqladt;
  sLine[0x1d0] = '\0';
  sLine[0x1d1] = '\0';
  sLine[0x1dc] = '\0';
  sLine[0x1dd] = '\0';
  sLine._64_8_ = &sqltds;
  sLine[0x16] = '\0';
  sLine[0x17] = '\x11';
  sLine[0x1d2] = '\0';
  sLine[0x1d3] = '\0';
  sLine._48_8_ = s_begin__response_code____PCRD_P7__004c98d0;
  sLine[0x1de] = '\0';
  sLine[0x1df] = '\0';
  response_code = 0x38d;
  sLine._32_8_ = sqlcud0;
  sLine._176_8_ = &response_code;
  sLine[0] = '\f';
  sLine[1] = '\0';
  sLine[2] = '\0';
  sLine[3] = '\0';
  sLine[4] = '\0';
  sLine[5] = '\0';
  sLine[6] = '\0';
  sLine[7] = '\0';
  sLine[8] = '\x04';
  sLine[9] = '\0';
  sLine[10] = '\0';
  sLine[0xb] = '\0';
  sLine[0xc] = '\x01';
  sLine[0xd] = '\0';
  sLine[0xe] = '\0';
  sLine[0xf] = '\0';
  sLine[0x10] = '$';
  sLine[0x11] = '\0';
  sLine[0x12] = '\0';
  sLine[0x13] = '\0';
  sLine[0x18] = '\0';
  sLine[0x19] = '\0';
  sLine[0x1a] = '\0';
  sLine[0x1b] = '\0';
  sLine[0xe0] = '\x04';
  sLine[0xe1] = '\0';
  sLine[0xe2] = '\0';
  sLine[0xe3] = '\0';
  sLine[0xe4] = '\0';
  sLine[0xe5] = '\0';
  sLine[0xe6] = '\0';
  sLine[0xe7] = '\0';
  sLine[0x110] = '\0';
  sLine[0x111] = '\0';
  sLine[0x112] = '\0';
  sLine[0x113] = '\0';
  sLine[0x128] = '\0';
  sLine[0x129] = '\0';
  sLine[0x12a] = '\0';
  sLine[299] = '\0';
  sLine[300] = '\0';
  sLine[0x12d] = '\0';
  sLine[0x12e] = '\0';
  sLine[0x12f] = '\0';
  sLine[0x158] = '\0';
  sLine[0x159] = '\0';
  sLine[0x15a] = '\0';
  sLine[0x15b] = '\0';
  sLine[0x170] = '\0';
  sLine[0x171] = '\0';
  sLine[0x172] = '\0';
  sLine[0x173] = '\0';
  sLine[0x174] = '\0';
  sLine[0x175] = '\0';
  sLine[0x176] = '\0';
  sLine[0x177] = '\0';
  sLine[0xe8] = '\x03';
  sLine[0xe9] = '\x10';
  sLine[0xea] = '\0';
  sLine[0xeb] = '\0';
  sLine[0xec] = '\0';
  sLine[0xed] = '\0';
  sLine[0xee] = '\0';
  sLine[0xef] = '\0';
  sLine[0x114] = '\0';
  sLine[0x115] = '\0';
  sLine[0x116] = '\0';
  sLine[0x117] = '\0';
  sLine[0x130] = '\0';
  sLine[0x131] = '\0';
  sLine[0x132] = '\0';
  sLine[0x133] = '\0';
  sLine[0x134] = '\0';
  sLine[0x135] = '\0';
  sLine[0x136] = '\0';
  sLine[0x137] = '\0';
  sLine[0x15c] = '\0';
  sLine[0x15d] = '\0';
  sLine[0x15e] = '\0';
  sLine[0x15f] = '\0';
  sLine[0x178] = '\0';
  sLine[0x179] = '\0';
  sLine[0x17a] = '\0';
  sLine[0x17b] = '\0';
  sLine[0x17c] = '\0';
  sLine[0x17d] = '\0';
  sLine[0x17e] = '\0';
  sLine[0x17f] = '\0';
  sLine[0xf0] = '\t';
  sLine[0xf1] = '\0';
  sLine[0xf2] = '\0';
  sLine[0xf3] = '\0';
  sLine[0xf4] = '\0';
  sLine[0xf5] = '\0';
  sLine[0xf6] = '\0';
  sLine[0xf7] = '\0';
  sLine[0x118] = '\0';
  sLine[0x119] = '\0';
  sLine[0x11a] = '\0';
  sLine[0x11b] = '\0';
  sLine[0x138] = '\0';
  sLine[0x139] = '\0';
  sLine[0x13a] = '\0';
  sLine[0x13b] = '\0';
  sLine[0x13c] = '\0';
  sLine[0x13d] = '\0';
  sLine[0x13e] = '\0';
  sLine[0x13f] = '\0';
  sLine[0x160] = '\0';
  sLine[0x161] = '\0';
  sLine[0x162] = '\0';
  sLine[0x163] = '\0';
  sLine[0x1d4] = '\0';
  sLine[0x1d5] = '\0';
  sLine[0x180] = '\0';
  sLine[0x181] = '\0';
  sLine[0x182] = '\0';
  sLine[0x183] = '\0';
  sLine[0x184] = '\0';
  sLine[0x185] = '\0';
  sLine[0x186] = '\0';
  sLine[0x187] = '\0';
  sLine[0x1e0] = '\0';
  sLine[0x1e1] = '\0';
  sLine._72_8_ = sLine + 0xb0;
  sLine._80_8_ = sLine + 0xe0;
  sLine._88_8_ = sLine + 0x110;
  sLine._96_8_ = sLine + 0x128;
  sLine._104_8_ = sLine + 0x158;
  sLine._112_8_ = sLine + 0x170;
  sLine._120_8_ = sLine + 0x1a0;
  sLine._128_8_ = sLine + 0x1d0;
  sLine._136_8_ = sLine + 0x1dc;
  sLine._184_8_ = &T_tlv_auth;
  sLine._192_8_ = &T_tlv_warning;
  sqlcxt((long)nIndiceCtx * 0x10 + 0x713948,&sqlctx,sLine,&sqlfpn);
  if (sqlca.sqlcode < 0) {
    sprintf(sLine,"%.40s",sqlca.sqlerrm.sqlerrmc);
    trace_event(sLine,1);
    trace_event("End UpdateSettlement (SYSTEM_MALFUNCTION)",5);
    response_code = 0x38d;
  }
  else {
    sprintf(sLine,"End UpdateSettlement (%d,%.6s)",(ulong)(uint)response_code,T_tlv_warning.arr);
    trace_event(sLine,5);
    if (response_code == 0) {
      response_code = 0;
    }
    else {
      memcpy(buffer_dump,T_tlv_auth.arr,(ulong)T_tlv_auth.len);
      PrintTlvBuffer(buffer_dump);
    }
  }
  return response_code;
}



// WARNING: Unknown calling convention

int GetSettlementData(int nIndiceCtx,char *sTlvBuffer,char *sSettlementType,char *sResource)

{
  ulong uVar1;
  uint uVar2;
  uchar *puVar3;
  bool bVar4;
  byte bVar5;
  uchar auStack_3014 [6940];
  char T_sett_type [4];
  int response_code;
  char T_resource_id [7];
  anon_struct_10_2_43c7b5cf T_tlv_warning;
  sqlca sqlca;
  sqlexd_conflict7 sqlstm;
  char sLine [512];
  anon_struct_4100_2_43c7b5cf T_tlv_auth;
  
  bVar5 = 0;
  trace_event("Start GetSettlementData () ",5);
  puVar3 = T_tlv_auth.arr + 2;
  uVar2 = 0xfff;
  T_tlv_auth.arr[0] = '\0';
  T_tlv_auth.arr[1] = '\0';
  bVar4 = ((ulong)puVar3 & 4) != 0;
  if (bVar4) {
    T_tlv_auth.arr[2] = '\0';
    T_tlv_auth.arr[3] = '\0';
    T_tlv_auth.arr[4] = '\0';
    T_tlv_auth.arr[5] = '\0';
    uVar2 = 0xffb;
    puVar3 = T_tlv_auth.arr + 6;
  }
  for (uVar1 = (ulong)(uVar2 >> 3); uVar1 != 0; uVar1 = uVar1 - 1) {
    puVar3[0] = '\0';
    puVar3[1] = '\0';
    puVar3[2] = '\0';
    puVar3[3] = '\0';
    puVar3[4] = '\0';
    puVar3[5] = '\0';
    puVar3[6] = '\0';
    puVar3[7] = '\0';
    puVar3 = puVar3 + (ulong)bVar5 * -0x10 + 8;
  }
  if (!bVar4) {
    puVar3[0] = '\0';
    puVar3[1] = '\0';
    puVar3[2] = '\0';
    puVar3[3] = '\0';
    puVar3 = puVar3 + 4;
  }
  puVar3[0] = '\0';
  puVar3[1] = '\0';
  puVar3[2] = '\0';
  T_tlv_auth.len = 0;
  T_resource_id._0_4_ = *(undefined4 *)sResource;
  T_tlv_warning.len = 0;
  T_tlv_warning.arr[4] = '\0';
  T_tlv_warning.arr[5] = '\0';
  T_resource_id._4_2_ = *(undefined2 *)(sResource + 4);
  T_tlv_warning.arr[0] = '\0';
  T_tlv_warning.arr[1] = '\0';
  T_tlv_warning.arr[2] = '\0';
  T_tlv_warning.arr[3] = '\0';
  T_tlv_warning.arr[6] = '\0';
  T_resource_id[6] = '\0';
  T_sett_type[3] = '\0';
  T_sett_type._0_3_ = *(uint3 *)sSettlementType;
  sprintf(sLine," Resource Id      : %s|",T_resource_id);
  trace_event(sLine,4);
  sprintf(sLine," Sett Type        : %s|",T_sett_type);
  trace_event(sLine,4);
  sqlstm.sqladtp = &sqladt;
  sqlstm.sqlety = 0x1100;
  sqlstm.sqadto[0] = 0;
  sqlstm.sqltdsp = &sqltds;
  sqlstm.sqtdso[0] = 0;
  sqlstm.sqadto[1] = 0;
  sqlstm.stmt = 
  "begin :response_code := PCRD_P7_SETTLEMENT_MNG . GET_SETTLEMENT_DATA ( :T_resource_id , :T_sett_type , :T_tlv_auth , :T_tlv_warning ) ; END ;"
  ;
  sqlstm.sqtdso[1] = 0;
  response_code = 0x38d;
  sqlstm.cud = sqlcud0;
  sqlstm.sqhstv[0] = (uchar *)&response_code;
  sqlstm.sqlvsn = 0xc;
  sqlstm.arrsiz = 5;
  sqlstm.iters = 1;
  sqlstm.offset = 0x3f;
  sqlstm.occurs = 0;
  sqlstm.sqhstl[0] = 4;
  sqlstm.sqhsts[0] = 0;
  sqlstm.sqindv[0] = (short *)0x0;
  sqlstm.sqinds[0] = 0;
  sqlstm.sqharm[0] = 0;
  sqlstm.sqhstl[1] = 7;
  sqlstm.sqhsts[1] = 0;
  sqlstm.sqindv[1] = (short *)0x0;
  sqlstm.sqinds[1] = 0;
  sqlstm.sqharm[1] = 0;
  sqlstm.sqhstl[2] = 4;
  sqlstm.sqhsts[2] = 0;
  sqlstm.sqindv[2] = (short *)0x0;
  sqlstm.sqinds[2] = 0;
  sqlstm.sqadto[3] = 0;
  sqlstm.sqtdso[3] = 0;
  sqlstm.sqharm[2] = 0;
  sqlstm.sqadto[4] = 0;
  sqlstm.sqadto[2] = 0;
  sqlstm.sqtdso[4] = 0;
  sqlstm.sqphsv = sqlstm.sqhstv;
  sqlstm.sqtdso[2] = 0;
  sqlstm.sqhstl[3] = 0x1003;
  sqlstm.sqphsl = sqlstm.sqhstl;
  sqlstm.sqhsts[3] = 0;
  sqlstm.sqindv[3] = (short *)0x0;
  sqlstm.sqinds[3] = 0;
  sqlstm.sqphss = sqlstm.sqhsts;
  sqlstm.sqharm[3] = 0;
  sqlstm.sqhstl[4] = 9;
  sqlstm.sqpind = sqlstm.sqindv;
  sqlstm.sqhsts[4] = 0;
  sqlstm.sqindv[4] = (short *)0x0;
  sqlstm.sqinds[4] = 0;
  sqlstm.sqpins = sqlstm.sqinds;
  sqlstm.sqharm[4] = 0;
  sqlstm.sqparm = sqlstm.sqharm;
  sqlstm.sqparc = sqlstm.sqharc;
  sqlstm.sqpadto = sqlstm.sqadto;
  sqlstm.sqptdso = sqlstm.sqtdso;
  sqlstm.sqlest = (uchar *)&sqlca;
  sqlstm.sqhstv[1] = (uchar *)T_resource_id;
  sqlstm.sqhstv[2] = (uchar *)T_sett_type;
  sqlstm.sqhstv[3] = (uchar *)&T_tlv_auth;
  sqlstm.sqhstv[4] = (uchar *)&T_tlv_warning;
  sqlcxt((long)nIndiceCtx * 0x10 + 0x713948,&sqlctx,&sqlstm,&sqlfpn);
  if (sqlca.sqlcode < 0) {
    sprintf(sLine,"%.40s",sqlca.sqlerrm.sqlerrmc);
    trace_event(sLine,1);
    trace_event("End GetSettlementData (SYSTEM_MALFUNCTION)",5);
    response_code = 0x38d;
  }
  else {
    uVar1 = (ulong)T_tlv_auth.len;
    memcpy(sTlvBuffer,T_tlv_auth.arr,uVar1);
    sTlvBuffer[uVar1] = '\0';
    PrintTlvBuffer(sTlvBuffer);
    sprintf(sLine,"End GetSettlementData (%d,%.6s)",(ulong)(uint)response_code,T_tlv_warning.arr);
    trace_event(sLine,5);
  }
  return response_code;
}



// WARNING: Unknown calling convention

int UpdateSettlementData
              (int nIndiceCtx,char *sTlvBuffer,char *sStatus,char *sSettlementType,char *sResource)

{
  size_t __n;
  ulong uVar1;
  uint uVar2;
  uchar *puVar3;
  bool bVar4;
  byte bVar5;
  uchar auStack_3014 [6924];
  char T_sett_status [2];
  char T_sett_type [4];
  int response_code;
  char T_resource_id [7];
  anon_struct_10_2_43c7b5cf T_tlv_warning;
  sqlca sqlca;
  sqlexd_conflict7 sqlstm;
  char sLine [512];
  anon_struct_4100_2_43c7b5cf T_tlv_auth;
  
  bVar5 = 0;
  trace_event("Start UpdateSettlementData () ",5);
  PrintTlvBuffer(sTlvBuffer);
  puVar3 = T_tlv_auth.arr + 2;
  uVar2 = 0xfff;
  T_tlv_auth.arr[0] = '\0';
  T_tlv_auth.arr[1] = '\0';
  bVar4 = ((ulong)puVar3 & 4) != 0;
  if (bVar4) {
    T_tlv_auth.arr[2] = '\0';
    T_tlv_auth.arr[3] = '\0';
    T_tlv_auth.arr[4] = '\0';
    T_tlv_auth.arr[5] = '\0';
    uVar2 = 0xffb;
    puVar3 = T_tlv_auth.arr + 6;
  }
  for (uVar1 = (ulong)(uVar2 >> 3); uVar1 != 0; uVar1 = uVar1 - 1) {
    puVar3[0] = '\0';
    puVar3[1] = '\0';
    puVar3[2] = '\0';
    puVar3[3] = '\0';
    puVar3[4] = '\0';
    puVar3[5] = '\0';
    puVar3[6] = '\0';
    puVar3[7] = '\0';
    puVar3 = puVar3 + (ulong)bVar5 * -0x10 + 8;
  }
  if (!bVar4) {
    puVar3[0] = '\0';
    puVar3[1] = '\0';
    puVar3[2] = '\0';
    puVar3[3] = '\0';
    puVar3 = puVar3 + 4;
  }
  puVar3[0] = '\0';
  puVar3[1] = '\0';
  puVar3[2] = '\0';
  T_tlv_auth.len = 0;
  T_sett_status[0] = '\0';
  T_sett_status[1] = '\0';
  T_tlv_warning.len = 0;
  T_tlv_warning.arr[4] = '\0';
  T_tlv_warning.arr[5] = '\0';
  T_resource_id[4] = '\0';
  T_resource_id[5] = '\0';
  T_tlv_warning.arr[0] = '\0';
  T_tlv_warning.arr[1] = '\0';
  T_tlv_warning.arr[2] = '\0';
  T_tlv_warning.arr[3] = '\0';
  T_tlv_warning.arr[6] = '\0';
  T_resource_id[0] = '\0';
  T_resource_id[1] = '\0';
  T_resource_id[2] = '\0';
  T_resource_id[3] = '\0';
  T_resource_id[6] = '\0';
  T_sett_type[0] = '\0';
  T_sett_type[1] = '\0';
  T_sett_type[2] = '\0';
  T_sett_type[3] = '\0';
  __n = strlen(sTlvBuffer);
  memcpy(T_tlv_auth.arr,sTlvBuffer,__n);
  T_resource_id._0_4_ = *(undefined4 *)sResource;
  T_resource_id._4_2_ = *(undefined2 *)(sResource + 4);
  T_tlv_auth.len = (ushort)__n;
  T_sett_type._0_3_ = *(undefined3 *)sSettlementType;
  T_sett_status[0] = *sStatus;
  sprintf(sLine," Resource Id      : %s|",T_resource_id);
  trace_event(sLine,4);
  sprintf(sLine," Sett Type        : %s|",T_sett_type);
  trace_event(sLine,4);
  sprintf(sLine," Status           : %s|",T_sett_status);
  trace_event(sLine,4);
  sqlstm.sqladtp = &sqladt;
  sqlstm.sqlety = 0x1100;
  sqlstm.sqadto[0] = 0;
  sqlstm.sqltdsp = &sqltds;
  sqlstm.sqtdso[0] = 0;
  sqlstm.sqadto[1] = 0;
  response_code = 0x38d;
  sqlstm.stmt = 
  "begin :response_code := PCRD_P7_SETTLEMENT_MNG . UPDATE_SETTLEMENT_DATA ( :T_resource_id , :T_sett_type , :T_sett_status , :T_tlv_auth , :T_tlv_warning ) ; END ;"
  ;
  sqlstm.sqlvsn = 0xc;
  sqlstm.arrsiz = 6;
  sqlstm.iters = 1;
  sqlstm.cud = sqlcud0;
  sqlstm.sqhstv[0] = (uchar *)&response_code;
  sqlstm.offset = 0x62;
  sqlstm.occurs = 0;
  sqlstm.sqhstl[0] = 4;
  sqlstm.sqhsts[0] = 0;
  sqlstm.sqindv[0] = (short *)0x0;
  sqlstm.sqinds[0] = 0;
  sqlstm.sqharm[0] = 0;
  sqlstm.sqhstl[1] = 7;
  sqlstm.sqhsts[1] = 0;
  sqlstm.sqindv[1] = (short *)0x0;
  sqlstm.sqinds[1] = 0;
  sqlstm.sqharm[1] = 0;
  sqlstm.sqtdso[1] = 0;
  sqlstm.sqhstl[2] = 4;
  sqlstm.sqhsts[2] = 0;
  sqlstm.sqindv[2] = (short *)0x0;
  sqlstm.sqinds[2] = 0;
  sqlstm.sqharm[2] = 0;
  sqlstm.sqadto[2] = 0;
  sqlstm.sqadto[5] = 0;
  sqlstm.sqtdso[2] = 0;
  sqlstm.sqadto[3] = 0;
  sqlstm.sqtdso[3] = 0;
  sqlstm.sqadto[4] = 0;
  sqlstm.sqhstl[3] = 2;
  sqlstm.sqtdso[4] = 0;
  sqlstm.sqphsv = sqlstm.sqhstv;
  sqlstm.sqhsts[3] = 0;
  sqlstm.sqindv[3] = (short *)0x0;
  sqlstm.sqphsl = sqlstm.sqhstl;
  sqlstm.sqtdso[5] = 0;
  sqlstm.sqinds[3] = 0;
  sqlstm.sqharm[3] = 0;
  sqlstm.sqphss = sqlstm.sqhsts;
  sqlstm.sqhstl[4] = 0x1003;
  sqlstm.sqhsts[4] = 0;
  sqlstm.sqpind = sqlstm.sqindv;
  sqlstm.sqindv[4] = (short *)0x0;
  sqlstm.sqinds[4] = 0;
  sqlstm.sqharm[4] = 0;
  sqlstm.sqpins = sqlstm.sqinds;
  sqlstm.sqhstl[5] = 9;
  sqlstm.sqhsts[5] = 0;
  sqlstm.sqindv[5] = (short *)0x0;
  sqlstm.sqparm = sqlstm.sqharm;
  sqlstm.sqinds[5] = 0;
  sqlstm.sqharm[5] = 0;
  sqlstm.sqparc = sqlstm.sqharc;
  sqlstm.sqpadto = sqlstm.sqadto;
  sqlstm.sqptdso = sqlstm.sqtdso;
  sqlstm.sqlest = (uchar *)&sqlca;
  sqlstm.sqhstv[1] = (uchar *)T_resource_id;
  sqlstm.sqhstv[2] = (uchar *)T_sett_type;
  sqlstm.sqhstv[3] = (uchar *)T_sett_status;
  sqlstm.sqhstv[4] = (uchar *)&T_tlv_auth;
  sqlstm.sqhstv[5] = (uchar *)&T_tlv_warning;
  sqlcxt((long)nIndiceCtx * 0x10 + 0x713948,&sqlctx,&sqlstm,&sqlfpn);
  if (sqlca.sqlcode < 0) {
    sprintf(sLine,"%.40s",sqlca.sqlerrm.sqlerrmc);
    trace_event(sLine,1);
    trace_event("End UpdateSettlementData (SYSTEM_MALFUNCTION)",5);
    response_code = 0x38d;
  }
  else {
    sprintf(sLine,"End UpdateSettlementData (%d,%.6s)",(ulong)(uint)response_code,T_tlv_warning.arr)
    ;
    trace_event(sLine,5);
  }
  return response_code;
}



// WARNING: Unknown calling convention

void FillSecurityResult(char result,char *sSecurityResults,int position)

{
  switch(result) {
  case '\0':
    sSecurityResults[position] = '0';
    return;
  case '\x01':
    sSecurityResults[position] = '1';
    return;
  case '\x02':
    sSecurityResults[position] = '2';
    return;
  case '\x03':
  case '\t':
    sSecurityResults[position] = '3';
    return;
  default:
    sSecurityResults[position] = '4';
    return;
  }
}



// WARNING: Unknown calling convention

void PutHsmRjectEvent(TSTlvAutho *sTlvInfo,char result,int position)

{
  int iVar1;
  int iVar2;
  long lVar3;
  char *pcVar4;
  int nLength;
  char sLine [512];
  char sPinNbr [4096];
  char sPinMaxNbr [4096];
  
  if (result == '\x02') {
    PutTlvAutho("203",sTlvInfo,"028",3);
    return;
  }
  if (result == '\x03') {
    if (position != 7) {
      PutTlvAutho("203",sTlvInfo,"902",3);
      return;
    }
    PutTlvAutho("203",sTlvInfo,"031",3);
  }
  else if (result == '\t') {
    PutTlvAutho("203",sTlvInfo,"991",3);
  }
  else if (result == '\x01') {
    switch(position) {
    case 0:
      PutTlvAutho("203",sTlvInfo,"021",3);
      break;
    case 1:
      PutTlvAutho("203",sTlvInfo,"022",3);
      break;
    case 2:
      pcVar4 = sPinNbr;
      for (lVar3 = 0x200; lVar3 != 0; lVar3 = lVar3 + -1) {
        pcVar4[0] = '\0';
        pcVar4[1] = '\0';
        pcVar4[2] = '\0';
        pcVar4[3] = '\0';
        pcVar4[4] = '\0';
        pcVar4[5] = '\0';
        pcVar4[6] = '\0';
        pcVar4[7] = '\0';
        pcVar4 = pcVar4 + 8;
      }
      pcVar4 = sPinMaxNbr;
      for (lVar3 = 0x200; lVar3 != 0; lVar3 = lVar3 + -1) {
        pcVar4[0] = '\0';
        pcVar4[1] = '\0';
        pcVar4[2] = '\0';
        pcVar4[3] = '\0';
        pcVar4[4] = '\0';
        pcVar4[5] = '\0';
        pcVar4[6] = '\0';
        pcVar4[7] = '\0';
        pcVar4 = pcVar4 + 8;
      }
      iVar1 = GetTlvAutho("145",sTlvInfo,sPinNbr,&nLength);
      if ((iVar1 == 0) && (iVar1 = GetTlvAutho("133",sTlvInfo,sPinMaxNbr,&nLength), iVar1 == 0)) {
        sprintf(sLine," Pin Error %s, Max Retry %s",sPinNbr,sPinMaxNbr);
        trace_event(sLine,4);
        iVar1 = atoi(sPinNbr);
        iVar2 = atoi(sPinMaxNbr);
        if (iVar2 <= iVar1 + 1) {
          PutTlvAutho("203",sTlvInfo,"003",3);
          return;
        }
      }
      PutTlvAutho("203",sTlvInfo,"023",3);
      break;
    case 4:
      PutTlvAutho("203",sTlvInfo,"024",3);
      break;
    case 0x12:
      PutTlvAutho("203",sTlvInfo,"034",3);
      break;
    case 0x18:
      PutTlvAutho("203",sTlvInfo,"027",3);
    }
  }
  return;
}



// WARNING: Unknown calling convention

int HsmDecline(TSTlvAutho *sTlvInfo,char *sSecurityResults,char *sHsmResultCode,char position)

{
  int nLength;
  char sLine [512];
  char sTlvPrivateBuffer [4097];
  TSTlvPrivate sTlvPrivateInfo;
  
  InitTlvPrivate(&sTlvPrivateInfo);
  PutTlvAutho("270",sTlvInfo,sSecurityResults,0x20);
  GetTlvAutho("048",sTlvInfo,sTlvPrivateBuffer,&nLength);
  AnalyseTlvPrivate(sTlvPrivateBuffer,nLength,&sTlvPrivateInfo);
  sprintf(sLine,"HsmResultCode = %s ",sHsmResultCode);
  trace_event(sLine,5);
  PutTlvPrivate("P93",&sTlvPrivateInfo,sHsmResultCode,4);
  if (position == '\0') {
    PutTlvPrivate("P87",&sTlvPrivateInfo,sSecurityResults,1);
  }
  else {
    if (position == '\x01') {
      PutTlvPrivate("P88",&sTlvPrivateInfo,sSecurityResults + 1,1);
    }
    else if (position == '\x18') {
      PutTlvPrivate("P88",&sTlvPrivateInfo,sSecurityResults + 0x18,1);
    }
    else if (position == '\x12') {
      PutTlvPrivate("P20",&sTlvPrivateInfo,sSecurityResults + 0x12,1);
      goto LAB_00454fb8;
    }
    if (position == '\x13') {
      PutTlvPrivate("P21",&sTlvPrivateInfo,sSecurityResults + 0x13,1);
    }
    else if (position == '\x14') {
      PutTlvPrivate("P23",&sTlvPrivateInfo,sSecurityResults + 0x14,1);
    }
    else if (position == '\x15') {
      PutTlvPrivate("P22",&sTlvPrivateInfo,sSecurityResults + 0x15,1);
    }
  }
LAB_00454fb8:
  nLength = PrivateBuildTlv(sTlvPrivateBuffer,&sTlvPrivateInfo);
  PutTlvAutho("048",sTlvInfo,sTlvPrivateBuffer,nLength);
  return 0;
}



// WARNING: Unknown calling convention

int BuildTagOffsetPvv(TSTlvAutho *sTlvInfo,char *sOffset)

{
  int nLength;
  char sTlvPrivateBuffer [4097];
  TSTlvPrivate sTlvPrivateInfo;
  
  InitTlvPrivate(&sTlvPrivateInfo);
  GetTlvAutho("048",sTlvInfo,sTlvPrivateBuffer,&nLength);
  AnalyseTlvPrivate(sTlvPrivateBuffer,nLength,&sTlvPrivateInfo);
  PutTlvPrivate("P16",&sTlvPrivateInfo,sOffset,4);
  nLength = PrivateBuildTlv(sTlvPrivateBuffer,&sTlvPrivateInfo);
  PutTlvAutho("048",sTlvInfo,sTlvPrivateBuffer,nLength);
  return 0;
}



// WARNING: Unknown calling convention

int SetPvvOffsetData(int nIndexCtx,TSTlvAutho *sTlvInfo)

{
  int iVar1;
  uint uVar2;
  long lVar3;
  int *pNewPvv;
  int *piVar4;
  int *sServiceCode_00;
  char *pcVar5;
  int *in_R9;
  int *sCvv1_00;
  byte bVar6;
  char sPvki [2];
  char sServiceCode [4];
  int nLength;
  char sExpiryDate [5];
  char sPvv [6];
  char sCvv1 [6];
  char sOffset [6];
  char sNewPinOff [6];
  char sPan [23];
  char sTrack2Data [41];
  char sTrack3Data [78];
  char sLine [512];
  
  bVar6 = 0;
  nLength = 0;
  trace_event("Start SetPvvOffsetData() ",5);
  pcVar5 = sTrack3Data;
  for (lVar3 = 9; lVar3 != 0; lVar3 = lVar3 + -1) {
    pcVar5[0] = '\0';
    pcVar5[1] = '\0';
    pcVar5[2] = '\0';
    pcVar5[3] = '\0';
    pcVar5[4] = '\0';
    pcVar5[5] = '\0';
    pcVar5[6] = '\0';
    pcVar5[7] = '\0';
    pcVar5 = pcVar5 + (ulong)bVar6 * -0x10 + 8;
  }
  piVar4 = (int *)0x0;
  sPvv[4] = '\0';
  sPvv[5] = '\0';
  sPan[0] = '\0';
  sPan[1] = '\0';
  sPan[2] = '\0';
  sPan[3] = '\0';
  sPan[4] = '\0';
  sPan[5] = '\0';
  sPan[6] = '\0';
  sPan[7] = '\0';
  sPan[8] = '\0';
  sPan[9] = '\0';
  sPan[10] = '\0';
  sPan[0xb] = '\0';
  sPan[0xc] = '\0';
  sPan[0xd] = '\0';
  sPan[0xe] = '\0';
  sPan[0xf] = '\0';
  sPan[0x10] = '\0';
  sPan[0x11] = '\0';
  sPan[0x12] = '\0';
  sPan[0x13] = '\0';
  sPan[0x16] = '\0';
  sExpiryDate[0] = '\0';
  sExpiryDate[1] = '\0';
  sExpiryDate[2] = '\0';
  sExpiryDate[3] = '\0';
  sExpiryDate[4] = '\0';
  pcVar5[0] = '\0';
  pcVar5[1] = '\0';
  pcVar5[2] = '\0';
  pcVar5[3] = '\0';
  pcVar5[4] = '\0';
  pcVar5[5] = '\0';
  sServiceCode[0] = '\0';
  sServiceCode[1] = '\0';
  sServiceCode[2] = '\0';
  sServiceCode[3] = '\0';
  pcVar5 = sTrack2Data;
  for (lVar3 = 5; lVar3 != 0; lVar3 = lVar3 + -1) {
    pcVar5[0] = '\0';
    pcVar5[1] = '\0';
    pcVar5[2] = '\0';
    pcVar5[3] = '\0';
    pcVar5[4] = '\0';
    pcVar5[5] = '\0';
    pcVar5[6] = '\0';
    pcVar5[7] = '\0';
    pcVar5 = pcVar5 + (ulong)bVar6 * -0x10 + 8;
  }
  sPvv[0] = '\0';
  sPvv[1] = '\0';
  sPvv[2] = '\0';
  sPvv[3] = '\0';
  sPan[0x14] = '\0';
  sPan[0x15] = '\0';
  sCvv1[0] = '\0';
  sCvv1[1] = '\0';
  sCvv1[2] = '\0';
  sCvv1[3] = '\0';
  sOffset[0] = '\0';
  sOffset[1] = '\0';
  sOffset[2] = '\0';
  sOffset[3] = '\0';
  sOffset[4] = '\0';
  sOffset[5] = '\0';
  sServiceCode_00 = (int *)sServiceCode;
  *pcVar5 = '\0';
  sCvv1[4] = '\0';
  sCvv1[5] = '\0';
  sCvv1_00 = (int *)sCvv1;
  pNewPvv = &nLength;
  iVar1 = GetTlvAutho("035",sTlvInfo,sTrack2Data,&nLength);
  if (iVar1 == 0) {
    piVar4 = (int *)sPvv;
    GetTrack2Data(sTrack2Data,sPan,sExpiryDate,(char *)sServiceCode_00,sPvv,(char *)sCvv1_00);
    pNewPvv = sServiceCode_00;
    in_R9 = sCvv1_00;
  }
  iVar1 = memcmp(sPvv,"0000",4);
  if ((iVar1 == 0) || (iVar1 = trim(sPvv,4), iVar1 == 0)) {
    iVar1 = GetTlvAutho("036",sTlvInfo,sTrack3Data,&nLength);
    if (iVar1 == 0) {
      iVar1 = UpdateTrack3(nIndexCtx,sTlvInfo);
      if (iVar1 != 0) goto LAB_004553e0;
      uVar2 = 0;
    }
    else {
      piVar4 = (int *)sOffset;
      iVar1 = get_pin_info(nIndexCtx,sPan,(int *)sPvv,piVar4,sPvki,in_R9);
      if (iVar1 != 0) {
LAB_004553e0:
        trace_event(" End SetPvvOffsetData (NOK) ",5);
        return -1;
      }
      uVar2 = ComputePinOffset(nIndexCtx,sTlvInfo,sNewPinOff,(char)piVar4);
      if (uVar2 == 0) {
        uVar2 = PutPinOffset(nIndexCtx,sPan,sNewPinOff);
      }
    }
  }
  else {
    uVar2 = ComputePvv(nIndexCtx,sTlvInfo,sNewPinOff,(char)pNewPvv);
    if (uVar2 == 0) {
      uVar2 = PutPvv(nIndexCtx,sPan,sNewPinOff,(char *)pNewPvv,(char *)piVar4);
    }
  }
  sprintf(sLine,"End SetPvvOffsetData(%d) ",(ulong)uVar2);
  return uVar2;
}



// WARNING: Unknown calling convention

int GetCvc3FromTrack(char *sDiscretionaryData,char *sCvc3)

{
  byte bVar1;
  size_t sVar2;
  size_t sVar3;
  size_t sVar4;
  
  sVar3 = strlen(sDiscretionaryData);
  sVar2 = 0;
  do {
    sVar4 = sVar2;
    if (sVar4 == sVar3) {
      return (int)sVar3;
    }
    sVar2 = sVar4 + 1;
  } while (sDiscretionaryData[sVar4] != 'F');
  *(undefined2 *)(sCvc3 + 2) = *(undefined2 *)(sDiscretionaryData + (sVar4 - 8));
  bVar1 = (sDiscretionaryData + (sVar4 - 8))[2];
  sCvc3[4] = bVar1;
  return (int)bVar1;
}



// WARNING: Removing unreachable block (ram,0x0045863a)
// WARNING: Removing unreachable block (ram,0x004587ae)
// WARNING: Removing unreachable block (ram,0x0045866f)
// WARNING: Removing unreachable block (ram,0x004586c9)
// WARNING: Removing unreachable block (ram,0x004586df)
// WARNING: Removing unreachable block (ram,0x004586ea)
// WARNING: Removing unreachable block (ram,0x00458701)
// WARNING: Removing unreachable block (ram,0x0045871e)
// WARNING: Removing unreachable block (ram,0x00458721)
// WARNING: Removing unreachable block (ram,0x0045872d)
// WARNING: Removing unreachable block (ram,0x00458731)
// WARNING: Removing unreachable block (ram,0x004587f4)
// WARNING: Removing unreachable block (ram,0x00458798)
// WARNING: Unknown calling convention

int CheckSecurity(int nIndiceCtx,char *sTlvBuffer)

{
  char cVar1;
  char cVar2;
  char cVar3;
  char cVar4;
  char cVar5;
  undefined8 uVar6;
  undefined8 uVar7;
  undefined8 uVar8;
  char cVar9;
  char cVar10;
  int iVar11;
  uint uVar12;
  uint uVar13;
  int iVar14;
  long lVar15;
  uint *puVar16;
  uint *puVar17;
  char *pcVar18;
  char *pcVar19;
  char cVar20;
  bool bVar21;
  byte bVar22;
  char *pcStack_10aa8;
  char cStack_10a78;
  char cStack_10a70;
  char *pcStack_10a38;
  char sTemp [2];
  char track_flag [2];
  char sAppControlFlag [2];
  char sControlFlag [2];
  char sPvki [2];
  char sAtc [3];
  char sSecurityFormat [3];
  char sPinBlockFormat [3];
  char sNetworkCode [3];
  char sNAtcTrack1 [3];
  char sNAtcTrack2 [3];
  int nLength;
  int nLen;
  char sServiceCode [4];
  char sCvv1 [4];
  char sCvv2 [4];
  char siCvv [4];
  char tmpServiceCode [4];
  char sFunctionCode [4];
  int nLenExpDate;
  int tPinLength;
  int VisaOfset;
  int nPvki;
  char sExpiryDate [5];
  char sExpirySwapped [5];
  char tmpExpiryDate [5];
  char sAip [5];
  char sHsmResultCode [5];
  char sPCvc3Track2 [5];
  char sPUnAtcTrack2 [5];
  char sIccApplicationIndex [5];
  char sEffectiveDate [5];
  char sMcc [5];
  char sPvv [6];
  char tmpPvv [6];
  char sOffset [6];
  char szPinOff [6];
  char tPvkiPVV [6];
  char sCvc3 [6];
  char sPvv1 [6];
  char sIssuingBankCode [7];
  char sCaptureCode [7];
  char sTvr [11];
  char tOffset [13];
  char sPOS_DATA [13];
  char sPCvc3Track1 [13];
  char sPUnAtcTrack1 [13];
  char eci_value [13];
  char sPosData [13];
  char sDiscretionaryData2 [14];
  char sPinBlock [17];
  char sBitmapCvc3Track2 [17];
  char sBitmapUnAtcTrack2 [17];
  char sMsgErr [18];
  char sPan [23];
  char tmpPan [23];
  char sDiscretionaryData1 [25];
  char sApplicationControl [25];
  char sProcode [25];
  char sSecurityFlags [33];
  char sSecurityResults [33];
  char sKcvc3 [33];
  char sDSTransactionID [37];
  char sTrack2Data [41];
  char sTrack2Data2 [41];
  char sBitmapCvc3Track1 [49];
  char sBitmapUnAtcTrack1 [49];
  char sTrack1Data [78];
  char sTrackInfo [78];
  char sTrack3 [108];
  char aav_field [256];
  char sCVKA [257];
  char sCVKB [257];
  char sPVKA [257];
  char sPVKB [257];
  char sTransKey [257];
  char sPIN_KEY [257];
  char sLine [512];
  char sFieldData [512];
  char sICC_DATA [513];
  char szWork [4096];
  char sTlvPrivateBuffer [4097];
  char sSecurityData [4097];
  char sIccDataTLV [4097];
  char sTlvPrivateBuffer_1 [4097];
  TSTlvPrivate sTlvPrivateInfo;
  TSTlvPrivate tlvInfo;
  char sAddDataPriv [256];
  TSTlvAutho sTlvInfo;
  
  bVar22 = 0;
  puVar17 = (uint *)sTrack1Data;
  nLenExpDate = 0;
  VisaOfset = 0;
  trace_event("Start CheckSecurity(.)",5);
  puVar16 = puVar17;
  for (lVar15 = 9; lVar15 != 0; lVar15 = lVar15 + -1) {
    puVar16[0] = 0;
    puVar16[1] = 0;
    puVar16 = puVar16 + (ulong)bVar22 * -4 + 2;
  }
  sPan[0x14] = '\0';
  sPan[0x15] = '\0';
  sPvki[0] = '\0';
  sPvki[1] = '\0';
  sPosData[0] = '\0';
  sPosData[1] = '\0';
  sPosData[2] = '\0';
  sPosData[3] = '\0';
  sPosData[4] = '\0';
  sPosData[5] = '\0';
  sPosData[6] = '\0';
  sPosData[7] = '\0';
  sPosData[8] = '\0';
  sPosData[9] = '\0';
  sPosData[10] = '\0';
  sPosData[0xb] = '\0';
  sPosData[0xc] = '\0';
  sPan[0] = '\0';
  sPan[1] = '\0';
  sPan[2] = '\0';
  sPan[3] = '\0';
  sPan[4] = '\0';
  sPan[5] = '\0';
  sPan[6] = '\0';
  sPan[7] = '\0';
  sPan[8] = '\0';
  sPan[9] = '\0';
  sPan[10] = '\0';
  sPan[0xb] = '\0';
  sPan[0xc] = '\0';
  sPan[0xd] = '\0';
  sPan[0xe] = '\0';
  sPan[0xf] = '\0';
  sPan[0x10] = '\0';
  sPan[0x11] = '\0';
  sPan[0x12] = '\0';
  sPan[0x13] = '\0';
  sPan[0x16] = '\0';
  *puVar16 = 0;
  *(undefined2 *)(puVar16 + 1) = 0;
  sPinBlock[0] = '\0';
  sPinBlock[1] = '\0';
  sPinBlock[2] = '\0';
  sPinBlock[3] = '\0';
  sPinBlock[4] = '\0';
  sPinBlock[5] = '\0';
  sPinBlock[6] = '\0';
  sPinBlock[7] = '\0';
  sPinBlock[8] = '\0';
  sPinBlock[9] = '\0';
  sPinBlock[10] = '\0';
  sPinBlock[0xb] = '\0';
  sPinBlock[0xc] = '\0';
  sPinBlock[0xd] = '\0';
  sPinBlock[0xe] = '\0';
  sPinBlock[0xf] = '\0';
  puVar16 = (uint *)sTrack2Data;
  for (lVar15 = 5; lVar15 != 0; lVar15 = lVar15 + -1) {
    puVar16[0] = 0;
    puVar16[1] = 0;
    puVar16 = puVar16 + (ulong)bVar22 * -4 + 2;
  }
  sPinBlock[0x10] = '\0';
  sExpiryDate[0] = '\0';
  sExpiryDate[1] = '\0';
  sExpiryDate[2] = '\0';
  sExpiryDate[3] = '\0';
  sExpiryDate[4] = '\0';
  sServiceCode[0] = '\0';
  sServiceCode[1] = '\0';
  sServiceCode[2] = '\0';
  sServiceCode[3] = '\0';
  sPvv[0] = '\0';
  sPvv[1] = '\0';
  sPvv[2] = '\0';
  sPvv[3] = '\0';
  *(char *)puVar16 = '\0';
  pcVar18 = sTrack2Data2;
  for (lVar15 = 5; lVar15 != 0; lVar15 = lVar15 + -1) {
    pcVar18[0] = '\0';
    pcVar18[1] = '\0';
    pcVar18[2] = '\0';
    pcVar18[3] = '\0';
    pcVar18[4] = '\0';
    pcVar18[5] = '\0';
    pcVar18[6] = '\0';
    pcVar18[7] = '\0';
    pcVar18 = pcVar18 + (ulong)bVar22 * -0x10 + 8;
  }
  *pcVar18 = '\0';
  pcVar18 = sSecurityData;
  for (lVar15 = 0x200; lVar15 != 0; lVar15 = lVar15 + -1) {
    pcVar18[0] = '\0';
    pcVar18[1] = '\0';
    pcVar18[2] = '\0';
    pcVar18[3] = '\0';
    pcVar18[4] = '\0';
    pcVar18[5] = '\0';
    pcVar18[6] = '\0';
    pcVar18[7] = '\0';
    pcVar18 = pcVar18 + (ulong)bVar22 * -0x10 + 8;
  }
  *pcVar18 = '\0';
  sPvv[4] = '\0';
  sPvv[5] = '\0';
  sSecurityFormat[0] = '\0';
  sSecurityFormat[1] = '\0';
  sCvv1[0] = '\0';
  sCvv1[1] = '\0';
  sCvv1[2] = '\0';
  sCvv1[3] = '\0';
  sCvv2[0] = '\0';
  sCvv2[1] = '\0';
  sCvv2[2] = '\0';
  sCvv2[3] = '\0';
  pcVar18 = sICC_DATA;
  for (lVar15 = 0x40; lVar15 != 0; lVar15 = lVar15 + -1) {
    pcVar18[0] = '\0';
    pcVar18[1] = '\0';
    pcVar18[2] = '\0';
    pcVar18[3] = '\0';
    pcVar18[4] = '\0';
    pcVar18[5] = '\0';
    pcVar18[6] = '\0';
    pcVar18[7] = '\0';
    pcVar18 = pcVar18 + (ulong)bVar22 * -0x10 + 8;
  }
  sSecurityFlags[0] = '\0';
  sSecurityFlags[1] = '\0';
  sSecurityFlags[2] = '\0';
  sSecurityFlags[3] = '\0';
  sSecurityFlags[4] = '\0';
  sSecurityFlags[5] = '\0';
  sSecurityFlags[6] = '\0';
  sSecurityFlags[7] = '\0';
  sSecurityFlags[8] = '\0';
  sSecurityFlags[9] = '\0';
  sSecurityFlags[10] = '\0';
  sSecurityFlags[0xb] = '\0';
  sSecurityFlags[0xc] = '\0';
  sSecurityFlags[0xd] = '\0';
  sSecurityFlags[0xe] = '\0';
  sSecurityFlags[0xf] = '\0';
  sSecurityFlags[0x10] = '\0';
  sSecurityFlags[0x11] = '\0';
  sSecurityFlags[0x12] = '\0';
  sSecurityFlags[0x13] = '\0';
  sSecurityFlags[0x14] = '\0';
  sSecurityFlags[0x15] = '\0';
  sSecurityFlags[0x16] = '\0';
  sSecurityFlags[0x17] = '\0';
  sSecurityFlags[0x18] = '\0';
  sSecurityFlags[0x19] = '\0';
  sSecurityFlags[0x1a] = '\0';
  sSecurityFlags[0x1b] = '\0';
  sSecurityFlags[0x1c] = '\0';
  sSecurityFlags[0x1d] = '\0';
  sSecurityFlags[0x1e] = '\0';
  sSecurityFlags[0x1f] = '\0';
  sSecurityFlags[0x20] = '\0';
  pcVar19 = szWork;
  for (lVar15 = 0x200; lVar15 != 0; lVar15 = lVar15 + -1) {
    pcVar19[0] = '\0';
    pcVar19[1] = '\0';
    pcVar19[2] = '\0';
    pcVar19[3] = '\0';
    pcVar19[4] = '\0';
    pcVar19[5] = '\0';
    pcVar19[6] = '\0';
    pcVar19[7] = '\0';
    pcVar19 = pcVar19 + (ulong)bVar22 * -0x10 + 8;
  }
  sMsgErr[0x10] = '\0';
  sMsgErr[0x11] = '\0';
  sSecurityResults[0] = '\0';
  sSecurityResults[1] = '\0';
  sSecurityResults[2] = '\0';
  sSecurityResults[3] = '\0';
  sSecurityResults[4] = '\0';
  sSecurityResults[5] = '\0';
  sSecurityResults[6] = '\0';
  sSecurityResults[7] = '\0';
  sSecurityResults[8] = '\0';
  sSecurityResults[9] = '\0';
  sSecurityResults[10] = '\0';
  sSecurityResults[0xb] = '\0';
  sSecurityResults[0xc] = '\0';
  sSecurityResults[0xd] = '\0';
  sSecurityResults[0xe] = '\0';
  sSecurityResults[0xf] = '\0';
  sSecurityResults[0x10] = '\0';
  sSecurityResults[0x11] = '\0';
  sSecurityResults[0x12] = '\0';
  sSecurityResults[0x13] = '\0';
  sSecurityResults[0x14] = '\0';
  sSecurityResults[0x15] = '\0';
  sSecurityResults[0x16] = '\0';
  sSecurityResults[0x17] = '\0';
  sSecurityResults[0x18] = '\0';
  sSecurityResults[0x19] = '\0';
  sSecurityResults[0x1a] = '\0';
  sSecurityResults[0x1b] = '\0';
  sSecurityResults[0x1c] = '\0';
  sSecurityResults[0x1d] = '\0';
  sSecurityResults[0x1e] = '\0';
  sSecurityResults[0x1f] = '\0';
  sSecurityResults[0x20] = '\0';
  sHsmResultCode[0] = '\0';
  sHsmResultCode[1] = '\0';
  sHsmResultCode[2] = '\0';
  sHsmResultCode[3] = '\0';
  sHsmResultCode[4] = '\0';
  sMsgErr[0] = '\0';
  sMsgErr[1] = '\0';
  sMsgErr[2] = '\0';
  sMsgErr[3] = '\0';
  sMsgErr[4] = '\0';
  sMsgErr[5] = '\0';
  sMsgErr[6] = '\0';
  sMsgErr[7] = '\0';
  sMsgErr[8] = '\0';
  sMsgErr[9] = '\0';
  sMsgErr[10] = '\0';
  sMsgErr[0xb] = '\0';
  sMsgErr[0xc] = '\0';
  sMsgErr[0xd] = '\0';
  sMsgErr[0xe] = '\0';
  sMsgErr[0xf] = '\0';
  sSecurityFormat[2] = '\0';
  sFunctionCode[0] = '\0';
  sFunctionCode[1] = '\0';
  sFunctionCode[2] = '\0';
  sFunctionCode[3] = '\0';
  pcVar19 = sTrack3;
  for (lVar15 = 0xd; lVar15 != 0; lVar15 = lVar15 + -1) {
    pcVar19[0] = '\0';
    pcVar19[1] = '\0';
    pcVar19[2] = '\0';
    pcVar19[3] = '\0';
    pcVar19[4] = '\0';
    pcVar19[5] = '\0';
    pcVar19[6] = '\0';
    pcVar19[7] = '\0';
    pcVar19 = pcVar19 + (ulong)bVar22 * -0x10 + 8;
  }
  pcVar19[0] = '\0';
  pcVar19[1] = '\0';
  pcVar19[2] = '\0';
  pcVar19[3] = '\0';
  pcVar19 = sCVKA;
  for (lVar15 = 0x20; lVar15 != 0; lVar15 = lVar15 + -1) {
    pcVar19[0] = '\0';
    pcVar19[1] = '\0';
    pcVar19[2] = '\0';
    pcVar19[3] = '\0';
    pcVar19[4] = '\0';
    pcVar19[5] = '\0';
    pcVar19[6] = '\0';
    pcVar19[7] = '\0';
    pcVar19 = pcVar19 + (ulong)bVar22 * -0x10 + 8;
  }
  *pcVar19 = '\0';
  pcVar19 = sCVKB;
  for (lVar15 = 0x20; lVar15 != 0; lVar15 = lVar15 + -1) {
    pcVar19[0] = '\0';
    pcVar19[1] = '\0';
    pcVar19[2] = '\0';
    pcVar19[3] = '\0';
    pcVar19[4] = '\0';
    pcVar19[5] = '\0';
    pcVar19[6] = '\0';
    pcVar19[7] = '\0';
    pcVar19 = pcVar19 + (ulong)bVar22 * -0x10 + 8;
  }
  *pcVar19 = '\0';
  pcVar19 = sPVKA;
  for (lVar15 = 0x20; lVar15 != 0; lVar15 = lVar15 + -1) {
    pcVar19[0] = '\0';
    pcVar19[1] = '\0';
    pcVar19[2] = '\0';
    pcVar19[3] = '\0';
    pcVar19[4] = '\0';
    pcVar19[5] = '\0';
    pcVar19[6] = '\0';
    pcVar19[7] = '\0';
    pcVar19 = pcVar19 + (ulong)bVar22 * -0x10 + 8;
  }
  *pcVar19 = '\0';
  pcVar19 = sPVKB;
  for (lVar15 = 0x20; lVar15 != 0; lVar15 = lVar15 + -1) {
    pcVar19[0] = '\0';
    pcVar19[1] = '\0';
    pcVar19[2] = '\0';
    pcVar19[3] = '\0';
    pcVar19[4] = '\0';
    pcVar19[5] = '\0';
    pcVar19[6] = '\0';
    pcVar19[7] = '\0';
    pcVar19 = pcVar19 + (ulong)bVar22 * -0x10 + 8;
  }
  *pcVar19 = '\0';
  pcVar19 = sTransKey;
  for (lVar15 = 0x20; lVar15 != 0; lVar15 = lVar15 + -1) {
    pcVar19[0] = '\0';
    pcVar19[1] = '\0';
    pcVar19[2] = '\0';
    pcVar19[3] = '\0';
    pcVar19[4] = '\0';
    pcVar19[5] = '\0';
    pcVar19[6] = '\0';
    pcVar19[7] = '\0';
    pcVar19 = pcVar19 + (ulong)bVar22 * -0x10 + 8;
  }
  *pcVar19 = '\0';
  pcVar19 = sPIN_KEY;
  for (lVar15 = 0x20; lVar15 != 0; lVar15 = lVar15 + -1) {
    pcVar19[0] = '\0';
    pcVar19[1] = '\0';
    pcVar19[2] = '\0';
    pcVar19[3] = '\0';
    pcVar19[4] = '\0';
    pcVar19[5] = '\0';
    pcVar19[6] = '\0';
    pcVar19[7] = '\0';
    pcVar19 = pcVar19 + (ulong)bVar22 * -0x10 + 8;
  }
  *pcVar19 = '\0';
  pcVar19 = sBitmapCvc3Track1;
  for (lVar15 = 6; lVar15 != 0; lVar15 = lVar15 + -1) {
    pcVar19[0] = '\0';
    pcVar19[1] = '\0';
    pcVar19[2] = '\0';
    pcVar19[3] = '\0';
    pcVar19[4] = '\0';
    pcVar19[5] = '\0';
    pcVar19[6] = '\0';
    pcVar19[7] = '\0';
    pcVar19 = pcVar19 + (ulong)bVar22 * -0x10 + 8;
  }
  *pcVar19 = '\0';
  pcVar19 = sBitmapUnAtcTrack1;
  for (lVar15 = 6; lVar15 != 0; lVar15 = lVar15 + -1) {
    pcVar19[0] = '\0';
    pcVar19[1] = '\0';
    pcVar19[2] = '\0';
    pcVar19[3] = '\0';
    pcVar19[4] = '\0';
    pcVar19[5] = '\0';
    pcVar19[6] = '\0';
    pcVar19[7] = '\0';
    pcVar19 = pcVar19 + (ulong)bVar22 * -0x10 + 8;
  }
  *pcVar19 = '\0';
  *pcVar18 = '\0';
  sNetworkCode[0] = '\0';
  sNetworkCode[1] = '\0';
  szPinOff[4] = '\0';
  szPinOff[5] = '\0';
  tmpPvv[4] = '\0';
  tmpPvv[5] = '\0';
  tmpPan[0x14] = '\0';
  tmpPan[0x15] = '\0';
  szPinOff[0] = '\0';
  szPinOff[1] = '\0';
  szPinOff[2] = '\0';
  szPinOff[3] = '\0';
  tOffset[0] = '\0';
  tOffset[1] = '\0';
  tOffset[2] = '\0';
  tOffset[3] = '\0';
  tOffset[4] = '\0';
  tOffset[5] = '\0';
  tOffset[6] = '\0';
  tOffset[7] = '\0';
  tOffset[8] = '\0';
  tOffset[9] = '\0';
  tOffset[10] = '\0';
  tOffset[0xb] = '\0';
  tOffset[0xc] = '\0';
  siCvv[0] = '\0';
  siCvv[1] = '\0';
  siCvv[2] = '\0';
  siCvv[3] = '\0';
  sPOS_DATA[0] = '\0';
  sPOS_DATA[1] = '\0';
  sPOS_DATA[2] = '\0';
  sPOS_DATA[3] = '\0';
  sPOS_DATA[4] = '\0';
  sPOS_DATA[5] = '\0';
  sPOS_DATA[6] = '\0';
  sPOS_DATA[7] = '\0';
  sPOS_DATA[8] = '\0';
  sPOS_DATA[9] = '\0';
  sPOS_DATA[10] = '\0';
  sPOS_DATA[0xb] = '\0';
  sPOS_DATA[0xc] = '\0';
  tmpPan[0] = '\0';
  tmpPan[1] = '\0';
  tmpPan[2] = '\0';
  tmpPan[3] = '\0';
  tmpPan[4] = '\0';
  tmpPan[5] = '\0';
  tmpPan[6] = '\0';
  tmpPan[7] = '\0';
  tmpPan[8] = '\0';
  tmpPan[9] = '\0';
  tmpPan[10] = '\0';
  tmpPan[0xb] = '\0';
  tmpPan[0xc] = '\0';
  tmpPan[0xd] = '\0';
  tmpPan[0xe] = '\0';
  tmpPan[0xf] = '\0';
  tmpPan[0x10] = '\0';
  tmpPan[0x11] = '\0';
  tmpPan[0x12] = '\0';
  tmpPan[0x13] = '\0';
  tmpPan[0x16] = '\0';
  sNetworkCode[2] = '\0';
  tmpExpiryDate[0] = '\0';
  tmpExpiryDate[1] = '\0';
  tmpExpiryDate[2] = '\0';
  tmpExpiryDate[3] = '\0';
  tmpExpiryDate[4] = '\0';
  tmpServiceCode[0] = '\0';
  tmpServiceCode[1] = '\0';
  tmpServiceCode[2] = '\0';
  tmpServiceCode[3] = '\0';
  tmpPvv[0] = '\0';
  tmpPvv[1] = '\0';
  tmpPvv[2] = '\0';
  tmpPvv[3] = '\0';
  sEffectiveDate[0] = '\0';
  sEffectiveDate[1] = '\0';
  sEffectiveDate[2] = '\0';
  sEffectiveDate[3] = '\0';
  sEffectiveDate[4] = '\0';
  sMcc[0] = '\0';
  sMcc[1] = '\0';
  sMcc[2] = '\0';
  sMcc[3] = '\0';
  sMcc[4] = '\0';
  sProcode[0] = '\0';
  sProcode[1] = '\0';
  sProcode[2] = '\0';
  sProcode[3] = '\0';
  sProcode[4] = '\0';
  sProcode[5] = '\0';
  sProcode[6] = '\0';
  sProcode[7] = '\0';
  sProcode[8] = '\0';
  sProcode[9] = '\0';
  sProcode[10] = '\0';
  sProcode[0xb] = '\0';
  sProcode[0xc] = '\0';
  sProcode[0xd] = '\0';
  sProcode[0xe] = '\0';
  sProcode[0xf] = '\0';
  sProcode[0x10] = '\0';
  sProcode[0x11] = '\0';
  sProcode[0x12] = '\0';
  sProcode[0x13] = '\0';
  sProcode[0x14] = '\0';
  sProcode[0x15] = '\0';
  sProcode[0x16] = '\0';
  sProcode[0x17] = '\0';
  sProcode[0x18] = '\0';
  InitTlvAutho(&sTlvInfo);
  AnalyseTlvAutho(sTlvBuffer,&sTlvInfo);
  sCaptureCode[0] = '\0';
  sCaptureCode[1] = '\0';
  sCaptureCode[2] = '\0';
  sCaptureCode[3] = '\0';
  pcVar18 = sTlvPrivateBuffer;
  for (lVar15 = 0x200; lVar15 != 0; lVar15 = lVar15 + -1) {
    pcVar18[0] = '\0';
    pcVar18[1] = '\0';
    pcVar18[2] = '\0';
    pcVar18[3] = '\0';
    pcVar18[4] = '\0';
    pcVar18[5] = '\0';
    pcVar18[6] = '\0';
    pcVar18[7] = '\0';
    pcVar18 = pcVar18 + (ulong)bVar22 * -0x10 + 8;
  }
  sCaptureCode[4] = '\0';
  sCaptureCode[5] = '\0';
  sCaptureCode[6] = '\0';
  *pcVar18 = '\0';
  pcVar18 = sDSTransactionID;
  for (lVar15 = 4; lVar15 != 0; lVar15 = lVar15 + -1) {
    pcVar18[0] = '\0';
    pcVar18[1] = '\0';
    pcVar18[2] = '\0';
    pcVar18[3] = '\0';
    pcVar18[4] = '\0';
    pcVar18[5] = '\0';
    pcVar18[6] = '\0';
    pcVar18[7] = '\0';
    pcVar18 = pcVar18 + (ulong)bVar22 * -0x10 + 8;
  }
  pcVar18[0] = '\0';
  pcVar18[1] = '\0';
  pcVar18[2] = '\0';
  pcVar18[3] = '\0';
  pcVar18[4] = '\0';
  pcVar18 = sFieldData;
  for (lVar15 = 0x40; lVar15 != 0; lVar15 = lVar15 + -1) {
    pcVar18[0] = '\0';
    pcVar18[1] = '\0';
    pcVar18[2] = '\0';
    pcVar18[3] = '\0';
    pcVar18[4] = '\0';
    pcVar18[5] = '\0';
    pcVar18[6] = '\0';
    pcVar18[7] = '\0';
    pcVar18 = pcVar18 + (ulong)bVar22 * -0x10 + 8;
  }
  iVar11 = GetTlvAutho("269",&sTlvInfo,sSecurityFlags,&nLength);
  if (iVar11 != 0) {
    builtin_strncpy(sLine + 8," Flags E",8);
    builtin_strncpy(sLine + 0x10,"mpty.",6);
LAB_00455cf4:
    builtin_strncpy(sLine,"Security",8);
    trace_event(sLine,5);
    trace_event("End   CheckSecurity(MALFUNCTION)",5);
    return 0x38d;
  }
  trace_event("SECURITY FLAGS RECEIVED",4);
  builtin_strncpy(sLine,"________ _____ ________",0x18);
  trace_event(sLine,5);
  sprintf(sLine,"CVV1 FLAG : %c",(ulong)(uint)(int)sSecurityFlags[0]);
  trace_event(sLine,5);
  sprintf(sLine,"CVC2 FLAG : %c",(ulong)(uint)(int)sSecurityFlags[1]);
  trace_event(sLine,5);
  sprintf(sLine,"PIN  FLAG : %c",(ulong)(uint)(int)sSecurityFlags[2]);
  trace_event(sLine,5);
  sprintf(sLine,"PIN  METD : %c",(ulong)(uint)(int)sSecurityFlags[3]);
  trace_event(sLine,5);
  sprintf(sLine,"CRPT FLAG : %c",(ulong)(uint)(int)sSecurityFlags[4]);
  trace_event(sLine,5);
  sprintf(sLine,"ICVV FLAG : %c",(ulong)(uint)(int)sSecurityFlags[0x12]);
  trace_event(sLine,5);
  sprintf(sLine,"CVC3 FLAG : %c",(ulong)(uint)(int)sSecurityFlags[0x18]);
  trace_event(sLine,5);
  sprintf(sLine,"CAVV FLAG : %c",(ulong)(uint)(int)sSecurityFlags[0x1b]);
  trace_event(sLine,5);
  sprintf(sLine,"AVV  FLAG : %c",(ulong)(uint)(int)sSecurityFlags[0x18]);
  trace_event(sLine,5);
  sprintf(sLine,"AEVV FLAG : %c",(ulong)(uint)(int)sSecurityFlags[0x1c]);
  trace_event(sLine,5);
  cVar10 = sSecurityFlags[0];
  cVar20 = sSecurityFlags[1];
  cVar1 = sSecurityFlags[2];
  cVar2 = sSecurityFlags[3];
  cVar3 = sSecurityFlags[4];
  cVar9 = sSecurityFlags[0x12];
  cVar4 = sSecurityFlags[0x18];
  cVar5 = sSecurityFlags[0x1b];
  iVar11 = GetTlvAutho("270",&sTlvInfo,sSecurityResults,&nLength);
  if (iVar11 != 0) {
    builtin_strncpy(sLine + 8," Results Empty.",0x10);
    goto LAB_00455cf4;
  }
  GetTlvAutho("022",&sTlvInfo,sPOS_DATA,&nLength);
  GetTlvAutho("204",&sTlvInfo,sNetworkCode,&nLength);
  GetTlvAutho("201",&sTlvInfo,sCaptureCode,&nLength);
  iVar11 = GetTlvAutho("035",&sTlvInfo,sTrack2Data,&nLength);
  if (iVar11 == 0) {
    iVar11 = memcmp(sNetworkCode,&DAT_004d1e47,2);
    puVar17 = (uint *)sTrack2Data;
    if ((iVar11 == 0) && (iVar11 = memcmp(sCaptureCode,"55",2), iVar11 != 0)) {
      GetDinersTrack2Data(sTrack2Data,sPan,sExpiryDate,sServiceCode,sEffectiveDate,sPvv,sCvv1,
                          sTrack2Data2);
    }
    else {
      GetTrack2Data(sTrack2Data,sPan,sExpiryDate,sServiceCode,sPvv,sCvv1);
    }
    do {
      uVar13 = *puVar17;
      puVar16 = (uint *)sPan;
      puVar17 = puVar17 + 1;
    } while ((uVar13 + 0xfefefeff & ~uVar13 & 0x80808080) == 0);
    do {
      uVar13 = *puVar16;
      puVar16 = puVar16 + 1;
    } while ((uVar13 + 0xfefefeff & ~uVar13 & 0x80808080) == 0);
  }
  else {
    iVar11 = GetTlvAutho("045",&sTlvInfo,(char *)puVar17,&nLength);
    if (iVar11 == 0) {
      iVar11 = memcmp(sNetworkCode,&DAT_004d1e47,2);
      if (iVar11 == 0) {
        GetTrack1Data((char *)puVar17,sPan,sExpiryDate,sServiceCode,sPvv,sCvv1);
      }
      else {
        GetDinersTrack1Data((char *)puVar17,sPan,sExpiryDate,sServiceCode,sPvv,sCvv1);
      }
      do {
        uVar13 = *puVar17;
        puVar17 = puVar17 + 1;
      } while ((uVar13 + 0xfefefeff & ~uVar13 & 0x80808080) == 0);
    }
    else {
      GetTlvAutho("002",&sTlvInfo,sPan,&nLength);
      GetTlvAutho("014",&sTlvInfo,sExpiryDate,&nLenExpDate);
    }
  }
  puVar17 = (uint *)sExpiryDate;
  if (sExpiryDate[0] != '\0') {
    do {
      puVar16 = puVar17;
      uVar12 = *puVar16 + 0xfefefeff & ~*puVar16;
      uVar13 = uVar12 & 0x80808080;
      puVar17 = puVar16 + 1;
    } while (uVar13 == 0);
    bVar21 = (uVar12 & 0x8080) == 0;
    if (bVar21) {
      uVar13 = uVar13 >> 0x10;
    }
    if (bVar21) {
      puVar17 = (uint *)((long)puVar16 + 6);
    }
    nLenExpDate = (((int)puVar17 + -3) - (uint)CARRY1((byte)uVar13,(byte)uVar13)) - (int)sExpiryDate
    ;
  }
  if ((cVar9 == 'Y') && (iVar11 = GetTlvAutho("055",&sTlvInfo,sICC_DATA,&nLength), iVar11 == 0)) {
    puVar17 = (uint *)sTrack2Data;
    for (lVar15 = 5; lVar15 != 0; lVar15 = lVar15 + -1) {
      puVar17[0] = 0;
      puVar17[1] = 0;
      puVar17 = puVar17 + (ulong)bVar22 * -4 + 2;
    }
    *(char *)puVar17 = '\0';
    InitTlvPrivate(&tlvInfo);
    AnalyseTlvPrivate(sICC_DATA,nLength,&tlvInfo);
    iVar11 = GetTlvPrivate("C35",&tlvInfo,sTrack2Data,&nLen);
    if (iVar11 == 0) {
      sprintf(sLine,"iCVV sTrack2Data %d",(ulong)(uint)nLen);
      trace_event(sLine,4);
LAB_00457092:
      iVar11 = memcmp(sNetworkCode,&DAT_004d1e47,2);
      if ((iVar11 == 0) && (iVar11 = memcmp(sCaptureCode,"55",2), iVar11 != 0)) {
        GetDinersTrack2Data(sTrack2Data,tmpPan,tmpExpiryDate,tmpServiceCode,sEffectiveDate,tmpPvv,
                            siCvv,sTrack2Data2);
      }
      else {
        GetTrack2Data(sTrack2Data,tmpPan,tmpExpiryDate,tmpServiceCode,tmpPvv,siCvv);
      }
    }
    else {
      trace_event("Erreur Recupition TRACK2 EQUIVALENT FROM ICC, Field 35 will be used",5);
      puVar17 = (uint *)sTrack2Data;
      for (lVar15 = 5; lVar15 != 0; lVar15 = lVar15 + -1) {
        puVar17[0] = 0;
        puVar17[1] = 0;
        puVar17 = puVar17 + (ulong)bVar22 * -4 + 2;
      }
      *(char *)puVar17 = '\0';
      iVar11 = GetTlvAutho("035",&sTlvInfo,sTrack2Data,&nLength);
      if (iVar11 == 0) goto LAB_00457092;
    }
    if (debug_option == 1) {
      sprintf(sLine,"siCvv is %s",siCvv);
      trace_event(sLine,4);
    }
  }
  uVar8 = sSecurityResults._16_8_;
  uVar6 = sSecurityResults._0_8_;
  sSecurityResults[0] = '4';
  sSecurityResults[1] = '4';
  sSecurityResults[2] = '4';
  uVar7 = sSecurityResults._0_8_;
  sSecurityResults._5_3_ = SUB83(uVar6,5);
  sSecurityResults._0_4_ = (undefined4)uVar7;
  sSecurityResults[4] = '4';
  builtin_strncpy(sSecurityResults + 0x12,"4444",4);
  sSecurityResults._22_2_ = SUB82(uVar8,6);
  PutTlvAutho("270",&sTlvInfo,sSecurityResults,0x20);
  AuthoBuildTlv(sTlvBuffer,&sTlvInfo);
  iVar11 = memcmp(sNetworkCode,"01",2);
  if ((iVar11 == 0) || (iVar11 = memcmp(sNetworkCode,&DAT_004d1e47,2), iVar11 == 0)) {
    sprintf(sLine,"=> CVV1 Flag : %c",(ulong)(uint)(int)cVar10);
    trace_event(sLine,5);
    if ((cVar10 == 'Y') && ((sCvv1[0] != '\0' && (siCvv[0] == '\0')))) {
      if (debug_option == 1) {
        sprintf(sLine,"=> CVV1 : %s",sCvv1);
        trace_event(sLine,5);
      }
      iVar11 = GetCVK(nIndiceCtx,sPan,sCVKA,sCVKB);
      if (iVar11 == 0) {
        iVar11 = check_cvv_data(nIndiceCtx,sPan,sCVKA,sCVKB,sExpiryDate,sServiceCode,sCvv1,
                                sHsmResultCode);
        if ((char)iVar11 != '\0') goto LAB_00456957;
      }
      else {
        builtin_strncpy(sHsmResultCode,"-CVK",5);
        builtin_strncpy(sMsgErr,"INVALID KEYs CVK",0x10);
LAB_00456957:
        pcStack_10a38 = sHsmResultCode;
        iVar11 = check_cvv_data(nIndiceCtx,sPan,sCVKA,sCVKB,sExpiryDate,"999",sCvv1,pcStack_10a38);
        cVar10 = (char)iVar11;
        if (cVar10 != '\0') {
          FillSecurityResult(cVar10,sSecurityResults,0);
          PutHsmRjectEvent(&sTlvInfo,cVar10,0);
          HsmDecline(&sTlvInfo,sSecurityResults,pcStack_10a38,'\0');
          AuthoBuildTlv(sTlvBuffer,&sTlvInfo);
          iVar11 = memcmp(pcStack_10a38,&DAT_004c9dd1,4);
          if (iVar11 != 0) {
            TextError(sHsmResultCode + 2,sMsgErr);
          }
          InitTlvPrivate(&sTlvPrivateInfo);
          pcVar18 = sAddDataPriv;
          for (lVar15 = 0x20; lVar15 != 0; lVar15 = lVar15 + -1) {
            pcVar18[0] = '\0';
            pcVar18[1] = '\0';
            pcVar18[2] = '\0';
            pcVar18[3] = '\0';
            pcVar18[4] = '\0';
            pcVar18[5] = '\0';
            pcVar18[6] = '\0';
            pcVar18[7] = '\0';
            pcVar18 = pcVar18 + (ulong)bVar22 * -0x10 + 8;
          }
          GetTlvBuffer("048",sTlvBuffer,sAddDataPriv,&nLength);
          AnalyseTlvPrivate(sAddDataPriv,nLength,&sTlvPrivateInfo);
          lVar15 = -1;
          pcVar18 = sMsgErr;
          do {
            if (lVar15 == 0) break;
            lVar15 = lVar15 + -1;
            cVar10 = *pcVar18;
            pcVar18 = pcVar18 + (ulong)bVar22 * -2 + 1;
          } while (cVar10 != '\0');
          PutTlvPrivate("P02",&sTlvPrivateInfo,sMsgErr,~(uint)lVar15 - 1);
          pcVar18 = sAddDataPriv;
          for (lVar15 = 0x20; lVar15 != 0; lVar15 = lVar15 + -1) {
            pcVar18[0] = '\0';
            pcVar18[1] = '\0';
            pcVar18[2] = '\0';
            pcVar18[3] = '\0';
            pcVar18[4] = '\0';
            pcVar18[5] = '\0';
            pcVar18[6] = '\0';
            pcVar18[7] = '\0';
            pcVar18 = pcVar18 + (ulong)bVar22 * -0x10 + 8;
          }
          nLength = PrivateBuildTlv(sAddDataPriv,&sTlvPrivateInfo);
          PutTlvBuffer("048",sTlvBuffer,sAddDataPriv,nLength);
          PrintTlvBuffer(sTlvBuffer);
          if (debug_option != 1) {
            return -1;
          }
          sprintf(sLine,"End   CheckSecurity(NOK CVV1[%s])",sCvv1);
          trace_event(sLine,5);
          return -1;
        }
      }
      uVar13 = 0;
      cVar10 = '\0';
    }
    else {
      uVar13 = 0x34;
      cVar10 = '4';
    }
    sprintf(sLine,"=> iCVV Flag : %c",(ulong)(uint)(int)cVar9);
    trace_event(sLine,5);
    if ((cVar9 == 'Y') && ((siCvv[0] != '\0' || (sPOS_DATA[6] == '8')))) {
      iVar11 = GetCVK(nIndiceCtx,sPan,sCVKA,sCVKB);
      if (iVar11 == 0) {
        if (sPOS_DATA[6] == '8') {
          if (cVar10 != '\0') {
            trace_event("Inside FallBack checking",4);
            iVar11 = check_cvv_data(nIndiceCtx,sPan,sCVKA,sCVKB,sExpiryDate,sServiceCode,sCvv1,
                                    sHsmResultCode);
            cVar10 = (char)iVar11;
            if (cVar10 != '\0') {
              FillSecurityResult(cVar10,sSecurityResults,0);
              PutHsmRjectEvent(&sTlvInfo,cVar10,0);
              cVar10 = '\0';
              goto LAB_00458102;
            }
          }
          uVar13 = 0;
          uVar12 = 0x34;
        }
        else {
          if (debug_option == 1) {
            sprintf(sLine,"=> iCVV : %s",siCvv);
            trace_event(sLine,5);
          }
          iVar11 = check_cvv_data(nIndiceCtx,sPan,sCVKA,sCVKB,sExpiryDate,"999",siCvv,sHsmResultCode
                                 );
          cVar10 = (char)iVar11;
          uVar12 = (uint)cVar10;
          sprintf(sLine,"=> icvv_result : %d",(ulong)uVar12);
          trace_event(sLine,5);
          if (cVar10 == '\0') {
            uVar12 = 0;
          }
          else {
            if (debug_option == 1) {
              sprintf(sLine,"=> CVV1-CHECK : %s",siCvv);
              trace_event(sLine,5);
            }
            iVar11 = check_cvv_data(nIndiceCtx,sPan,sCVKA,sCVKB,sExpiryDate,sServiceCode,siCvv,
                                    sHsmResultCode);
            cVar9 = (char)iVar11;
            if (cVar9 != '\0') {
              FillSecurityResult(cVar9,sSecurityResults,0);
              PutHsmRjectEvent(&sTlvInfo,cVar9,0);
              HsmDecline(&sTlvInfo,sSecurityResults,sHsmResultCode,'\0');
              FillSecurityResult(cVar10,sSecurityResults,0x12);
              goto LAB_004584f6;
            }
            uVar13 = 0;
          }
        }
      }
      else {
        builtin_strncpy(sHsmResultCode,"-CVK",4);
        uVar12 = 3;
      }
      sprintf(sLine,"=> icvv_result : %d",(ulong)uVar12);
      trace_event(sLine,5);
      sprintf(sLine,"=> cvv1_result : %d",(ulong)uVar13);
      trace_event(sLine,5);
      FillSecurityResult((char)uVar12,sSecurityResults,0x12);
      FillSecurityResult((char)uVar13,sSecurityResults,0);
    }
    else {
      uVar12 = 0x34;
    }
  }
  else {
    if ((cVar10 == 'Y') && (sCvv1[0] != '\0')) {
      if (debug_option == 1) {
        sprintf(sLine,"=> CVV1 : %s",sCvv1);
        trace_event(sLine,5);
      }
      iVar11 = GetCVK(nIndiceCtx,sPan,sCVKA,sCVKB);
      if (iVar11 != 0) {
        builtin_strncpy(sHsmResultCode,"-CVK",4);
        FillSecurityResult('\x03',sSecurityResults,0);
        PutHsmRjectEvent(&sTlvInfo,'\x03',0);
        goto LAB_004581aa;
      }
      sprintf(sLine,"sPOS_DATA 1 %s",sPOS_DATA);
      trace_event(sLine,4);
      if ((sServiceCode[0] & 0xfbU) != 0x32) {
        iVar11 = check_cvv_data(nIndiceCtx,sPan,sCVKA,sCVKB,sExpiryDate,sServiceCode,sCvv1,
                                sHsmResultCode);
        cVar10 = (char)iVar11;
        if (cVar10 == '\0') {
          FillSecurityResult('\0',sSecurityResults,0);
          uVar13 = 0;
          uVar12 = 0x34;
          goto LAB_004562b0;
        }
LAB_004583ac:
        FillSecurityResult(cVar10,sSecurityResults,0);
        PutHsmRjectEvent(&sTlvInfo,cVar10,0);
LAB_004581aa:
        HsmDecline(&sTlvInfo,sSecurityResults,sHsmResultCode,'\0');
        AuthoBuildTlv(sTlvBuffer,&sTlvInfo);
        trace_event("End   CheckSecurity(NOK CVV1)",5);
        return -1;
      }
      trace_event(" SERVICE CODE TECHNOLOGY ICC",5);
      iVar11 = GetTlvAutho("055",&sTlvInfo,sICC_DATA,&nLength);
      uVar12 = 0x34;
      uVar13 = 0x34;
      if (iVar11 == 0) {
LAB_00457218:
        if (sPOS_DATA[6] == '8') {
          iVar11 = check_cvv_data(nIndiceCtx,sPan,sCVKA,sCVKB,sExpiryDate,sServiceCode,sCvv1,
                                  sHsmResultCode);
          if ((char)iVar11 != '\0') {
            iVar11 = check_cvv_data(nIndiceCtx,sPan,sCVKA,sCVKB,sExpiryDate,"999",sCvv1,
                                    sHsmResultCode);
            cVar10 = (char)iVar11;
            if (cVar10 != '\0') goto LAB_004583ac;
          }
          FillSecurityResult('\0',sSecurityResults,0);
          uVar13 = 0;
        }
        goto LAB_004562b0;
      }
      trace_event("Start   Checking CVV IN FALLBACK CONDITION",5);
      iVar11 = check_cvv_data(nIndiceCtx,sPan,sCVKA,sCVKB,sExpiryDate,"999",sCvv1,sHsmResultCode);
      cVar10 = (char)iVar11;
      if (cVar10 == '\0') {
        cVar9 = '4';
LAB_00457c9a:
        uVar13 = (uint)cVar9;
        FillSecurityResult(cVar9,sSecurityResults,0);
        uVar12 = (uint)cVar10;
        FillSecurityResult(cVar10,sSecurityResults,0x12);
        goto LAB_00457218;
      }
      iVar11 = check_cvv_data(nIndiceCtx,sPan,sCVKA,sCVKB,sExpiryDate,sServiceCode,sCvv1,
                              sHsmResultCode);
      cVar9 = (char)iVar11;
      if (cVar9 == '\0') goto LAB_00457c9a;
      FillSecurityResult(cVar9,sSecurityResults,0);
      PutHsmRjectEvent(&sTlvInfo,cVar9,0);
      HsmDecline(&sTlvInfo,sSecurityResults,sHsmResultCode,'\0');
      FillSecurityResult(cVar10,sSecurityResults,0x12);
LAB_004584f6:
      PutHsmRjectEvent(&sTlvInfo,cVar10,0x12);
      cVar10 = '\x12';
LAB_00458102:
      HsmDecline(&sTlvInfo,sSecurityResults,sHsmResultCode,cVar10);
      AuthoBuildTlv(sTlvBuffer,&sTlvInfo);
      trace_event("End   CheckSecurity(NOK ICVV / CVV1)",5);
      return -1;
    }
    uVar12 = 0x34;
    uVar13 = 0x34;
  }
LAB_004562b0:
  iVar11 = GetTlvAutho("048",&sTlvInfo,sTlvPrivateBuffer,&nLength);
  if (iVar11 == 0) {
    AnalyseTlvPrivate(sTlvPrivateBuffer,nLength,&sTlvPrivateInfo);
    GetTlvPrivate("P92",&sTlvPrivateInfo,sCvv2,&nLength);
  }
  if (debug_option == 0) {
    sprintf(sLine,"Length Expiry Date %d",(ulong)(uint)nLenExpDate);
  }
  else {
    sprintf(sLine,"Length Expiry Date %d, sCvv2 =[%s]",(ulong)(uint)nLenExpDate,sCvv2);
  }
  trace_event(sLine,4);
  cStack_10a70 = '4';
  if ((cVar20 == 'Y') && (sCvv2[0] != '\0')) {
    iVar11 = memcmp(sCvv2,&DAT_004c9ea9,3);
    if (iVar11 != 0) {
      if (nLenExpDate == 0) {
        trace_event("CVC2 PRESENT | EXPIRY DATE NOT PRESENT ",4);
        trace_event("NO CVC2 VERIFICATION                   ",4);
        FillSecurityResult('\x04',sSecurityResults,1);
      }
      else {
        if (debug_option == 1) {
          sprintf(sLine,"=> CVV2 : [%s]",sCvv2);
          trace_event(sLine,5);
        }
        iVar11 = GetCVK(nIndiceCtx,sPan,sCVKA,sCVKB);
        if (iVar11 != 0) {
          builtin_strncpy(sHsmResultCode,"-CVK",4);
          cVar10 = '\x03';
LAB_00456c0f:
          pcStack_10a38 = sHsmResultCode;
          FillSecurityResult(cVar10,sSecurityResults,1);
          PutHsmRjectEvent(&sTlvInfo,cVar10,1);
          HsmDecline(&sTlvInfo,sSecurityResults,pcStack_10a38,'\x01');
          AuthoBuildTlv(sTlvBuffer,&sTlvInfo);
          trace_event("End   CheckSecurity(NOK CVV2)",5);
          return -1;
        }
        iVar11 = check_cvv_data(nIndiceCtx,sPan,sCVKA,sCVKB,sExpiryDate,"000",sCvv2,sHsmResultCode);
        cVar10 = (char)iVar11;
        if (cVar10 != '\0') goto LAB_00456c0f;
        FillSecurityResult('\0',sSecurityResults,1);
        cStack_10a70 = '\0';
      }
    }
  }
  if (((byte)(sPOS_DATA[6] + 0xbdU) < 2) && (cVar4 == 'Y')) {
    trace_event("ERROR : THERE IS NO TRACK",1);
    trace_event("END   check_security(NOK)",5);
    return -1;
  }
  trace_event("NO CVC3 VERIFICATION ",4);
  FillSecurityResult('\x04',sSecurityResults,0x18);
  iVar11 = memcmp(sNetworkCode,"01",2);
  if (((iVar11 == 0) && (cVar5 == 'Y')) &&
     (iVar11 = GetTlvAutho("048",&sTlvInfo,sTlvPrivateBuffer,&nLength), iVar11 == 0)) {
    pcVar18 = sAddDataPriv;
    for (lVar15 = 0x20; lVar15 != 0; lVar15 = lVar15 + -1) {
      pcVar18[0] = '\0';
      pcVar18[1] = '\0';
      pcVar18[2] = '\0';
      pcVar18[3] = '\0';
      pcVar18[4] = '\0';
      pcVar18[5] = '\0';
      pcVar18[6] = '\0';
      pcVar18[7] = '\0';
      pcVar18 = pcVar18 + (ulong)bVar22 * -0x10 + 8;
    }
    InitTlvPrivate(&sTlvPrivateInfo);
    AnalyseTlvPrivate(sTlvPrivateBuffer,nLength,&sTlvPrivateInfo);
    iVar11 = GetTlvPrivate("P50",&sTlvPrivateInfo,sAddDataPriv,&nLength);
    if (iVar11 != 0) {
      GetTlvPrivate("P78",&sTlvPrivateInfo,sAddDataPriv,&nLength);
    }
    trace_event("CAVV NOT FOUND",0);
    trace_event("End   CheckSecurity(NOK CAVV)",5);
    return -1;
  }
  iVar11 = memcmp(sNetworkCode,&DAT_004a7e3d,2);
  if (((iVar11 == 0) && (cVar4 == 'Y')) &&
     (iVar11 = GetTlvAutho("048",&sTlvInfo,sTlvPrivateBuffer,&nLength), iVar11 == 0)) {
    eci_value[0] = '\0';
    eci_value[1] = '\0';
    eci_value[2] = '\0';
    eci_value[3] = '\0';
    eci_value[4] = '\0';
    eci_value[5] = '\0';
    eci_value[6] = '\0';
    eci_value[7] = '\0';
    eci_value[8] = '\0';
    eci_value[9] = '\0';
    eci_value[10] = '\0';
    eci_value[0xb] = '\0';
    eci_value[0xc] = '\0';
    pcVar18 = aav_field;
    for (lVar15 = 0x20; lVar15 != 0; lVar15 = lVar15 + -1) {
      pcVar18[0] = '\0';
      pcVar18[1] = '\0';
      pcVar18[2] = '\0';
      pcVar18[3] = '\0';
      pcVar18[4] = '\0';
      pcVar18[5] = '\0';
      pcVar18[6] = '\0';
      pcVar18[7] = '\0';
      pcVar18 = pcVar18 + (ulong)bVar22 * -0x10 + 8;
    }
    InitTlvPrivate(&sTlvPrivateInfo);
    AnalyseTlvPrivate(sTlvPrivateBuffer,nLength,&sTlvPrivateInfo);
    iVar11 = GetTlvPrivate("P51",&sTlvPrivateInfo,aav_field,&nLength);
    if (iVar11 == 0) {
      GetTlvPrivate("P66",&sTlvPrivateInfo,sFieldData,&nLength);
      sprintf(sLine,"sFieldData [%s] ",sFieldData);
      trace_event(sLine,5);
      if ((sFieldData[1] == '1') || (sFieldData[1] == '2')) {
        if ((aav_field[0] & 0xfdU) == 0x68) goto LAB_00457928;
LAB_004579d3:
        GetTlvPrivate("K06",&sTlvPrivateInfo,sDSTransactionID,&nLength);
        iVar11 = check_aav_data_2_0(nIndiceCtx,sPan,sDSTransactionID,aav_field,sHsmResultCode);
      }
      else {
        if ((sFieldData[1] == '3') || ((byte)(sFieldData[1] - 0x34U) < 6)) goto LAB_004579d3;
LAB_00457928:
        iVar11 = check_aav_data(nIndiceCtx,sPan,aav_field,sHsmResultCode);
      }
      pcStack_10a38 = sHsmResultCode;
      if (iVar11 != 0) {
        FillSecurityResult((char)iVar11,sSecurityResults,0x18);
        PutHsmRjectEvent(&sTlvInfo,(char)iVar11,0x18);
        HsmDecline(&sTlvInfo,sSecurityResults,pcStack_10a38,'\x18');
        AuthoBuildTlv(sTlvBuffer,&sTlvInfo);
        trace_event("End   CheckSecurity(NOK AAV)",5);
        return -1;
      }
    }
    else {
      trace_event("AVV NOT FOUND",0);
      GetTlvPrivate("P42",&sTlvPrivateInfo,eci_value,&nLength);
      if (eci_value[6] == '2') {
        FillSecurityResult(cStack_10a70,sSecurityResults,1);
        FillSecurityResult('\x01',sSecurityResults,0x18);
        PutHsmRjectEvent(&sTlvInfo,'\x01',0x18);
        HsmDecline(&sTlvInfo,sSecurityResults,sHsmResultCode,'\x18');
        AuthoBuildTlv(sTlvBuffer,&sTlvInfo);
        trace_event("End   CheckSecurity(1 NOK AVV ECI == 212 or 912)",5);
        return -1;
      }
    }
  }
  iVar11 = GetTlvAutho("003",&sTlvInfo,sProcode,&nLength);
  if (iVar11 != 0) {
    trace_event("CheckSecurity : sProcode error",5);
  }
  iVar11 = GetTlvAutho("204",&sTlvInfo,sNetworkCode,&nLength);
  if (iVar11 != 0) {
    trace_event("CheckSecurity : sNetworkCode error",5);
  }
  iVar11 = GetTlvAutho("022",&sTlvInfo,sPosData,&nLength);
  if (iVar11 != 0) {
    trace_event("CheckSecurity : sPosData error",5);
  }
  sprintf(sLine,"sNetworkCode(%s), sProcode(%s) sPosData(%s) ",sNetworkCode,sProcode,sPosData);
  trace_event(sLine,5);
  iVar11 = memcmp(sNetworkCode,&DAT_004d1ee1,2);
  if (iVar11 == 0) {
    iVar11 = memcmp(sProcode + 6,"01",2);
    if (((iVar11 != 0) && (iVar11 = memcmp(sProcode + 6,&DAT_004c9c21,2), iVar11 != 0)) ||
       (sPosData[0xb] == '0')) goto LAB_00456678;
    trace_event("NO PIN SATARTED",5);
    if (cVar1 == 'Y') {
      iVar11 = GetTlvAutho("052",&sTlvInfo,sPinBlock,&nLength);
      if (iVar11 != 0) {
        PutTlvAutho("203",&sTlvInfo,"023",3);
        AuthoBuildTlv(sTlvBuffer,&sTlvInfo);
        return -1;
      }
      iVar11 = GetTlvAutho("052",&sTlvInfo,sPinBlock,&nLength);
      if (iVar11 != 0) goto LAB_004564f0;
      goto LAB_004566b0;
    }
    GetTlvAutho("052",&sTlvInfo,sPinBlock,&nLength);
  }
  else {
LAB_00456678:
    iVar11 = GetTlvAutho("052",&sTlvInfo,sPinBlock,&nLength);
    if ((iVar11 == 0) && (cVar1 == 'Y')) {
LAB_004566b0:
      pcStack_10aa8 = sPinBlock;
      if (nLength != 0) {
        GetTlvPrivate("P10",&sTlvPrivateInfo,sTransKey,&nLength);
        GetTlvAutho("053",&sTlvInfo,sSecurityData,&nLength);
        GetTlvAutho("024",&sTlvInfo,sFunctionCode,&nLength);
        GetTlvAutho("036",&sTlvInfo,sTrack3,&nLength);
        GetSecurityData(0,sSecurityData,sSecurityFormat,&nLength);
        iVar11 = memcmp(sSecurityFormat,"01",2);
        cStack_10a78 = 'T';
        if (iVar11 != 0) {
          iVar11 = memcmp(sSecurityFormat,&DAT_004a7e3d,2);
          cStack_10a78 = 'T';
          if (iVar11 == 0) {
            cStack_10a78 = 'S';
          }
        }
        GetSecurityData(1,sSecurityData,sPinBlockFormat,&nLength);
        iVar11 = get_pin_info(nIndiceCtx,sPan,&nPvki,&VisaOfset,tOffset,&tPinLength);
        sprintf(sLine,"PIN Length = %d",(ulong)(uint)tPinLength);
        trace_event(sLine,5);
        if (debug_option == 1) {
          sprintf(sLine,"sPvv value (%s), sPinBlockFormat(%s)",sPvv,sPinBlockFormat);
          trace_event(sLine,5);
        }
        if (cVar2 == '2') {
          if (iVar11 == 0) {
            sprintf(sPvki,"%01d",(ulong)(uint)nPvki);
            cVar10 = sPvki[0];
            sprintf(sPvv,"%01d%04d",(ulong)(uint)nPvki,(ulong)(uint)VisaOfset);
          }
          else {
            cVar10 = sPvv[0];
          }
          iVar11 = GetPVK(nIndiceCtx,sPan,cVar10,sPVKA,sPVKB);
          if (iVar11 != 0) goto LAB_00457a52;
          iVar11 = check_pvv_data(nIndiceCtx,sPan,sPVKA,sPVKB,pcStack_10aa8,sPinBlockFormat,
                                  sTransKey,sPvv,cStack_10a78,sHsmResultCode);
          cVar10 = (char)iVar11;
          if (cVar10 == '\0') {
LAB_00457890:
            cVar10 = '\0';
            goto LAB_00456867;
          }
        }
        else {
          if (cVar2 != '1') {
            cVar10 = '4';
            if (cVar2 == '3') {
              if (iVar11 == 0) {
                iVar11 = GetPVKPinKey(nIndiceCtx,sPan,sPVKA,sPVKB);
                if (iVar11 == 0) {
                  if (sPVKA[0] == 'S') {
                    GetTlvAutho("448",&sTlvInfo,sPVKA,&nLength);
                  }
                  if ((sPVKA[0] != '\0') && (sPVKB[0] != '\0')) {
                    iVar11 = check_offset_data(nIndiceCtx,sPan,sPVKA,pcStack_10aa8,sPinBlockFormat,
                                               sTransKey,tOffset,cStack_10a78,sHsmResultCode,
                                               tPinLength);
                    cVar10 = (char)iVar11;
                    if (cVar10 != '\0') goto LAB_00457b27;
                    goto LAB_00457890;
                  }
                  pcVar18 = sHsmResultCode;
                  for (lVar15 = 5; lVar15 != 0; lVar15 = lVar15 + -1) {
                    *pcVar18 = '\0';
                    pcVar18 = pcVar18 + (ulong)bVar22 * -2 + 1;
                  }
                  builtin_strncpy(sHsmResultCode,"-PVK",4);
                  pcVar18 = "ERR GETTING PVKA/PVKB";
                  pcVar19 = sMsgErr;
                  for (lVar15 = 0x15; lVar15 != 0; lVar15 = lVar15 + -1) {
                    *pcVar19 = *pcVar18;
                    pcVar18 = pcVar18 + (ulong)bVar22 * -2 + 1;
                    pcVar19 = pcVar19 + (ulong)bVar22 * -2 + 1;
                  }
                  lVar15 = -1;
                  pcVar18 = sMsgErr;
                  do {
                    if (lVar15 == 0) break;
                    lVar15 = lVar15 + -1;
                    cVar10 = *pcVar18;
                    pcVar18 = pcVar18 + (ulong)bVar22 * -2 + 1;
                  } while (cVar10 != '\0');
                  PutTlvPrivate("P02",&sTlvPrivateInfo,sMsgErr,~(uint)lVar15 - 1);
                }
                else {
                  pcVar18 = sHsmResultCode;
                  for (lVar15 = 5; lVar15 != 0; lVar15 = lVar15 + -1) {
                    *pcVar18 = '\0';
                    pcVar18 = pcVar18 + (ulong)bVar22 * -2 + 1;
                  }
                  builtin_strncpy(sHsmResultCode,"-PVK",4);
                }
              }
              else {
                pcVar18 = sHsmResultCode;
                for (lVar15 = 5; lVar15 != 0; lVar15 = lVar15 + -1) {
                  *pcVar18 = '\0';
                  pcVar18 = pcVar18 + (ulong)bVar22 * -2 + 1;
                }
                builtin_strncpy(sHsmResultCode,"-PVK",4);
                pcVar18 = "OFFSET READ ERROR";
                pcVar19 = sMsgErr;
                for (lVar15 = 0x11; lVar15 != 0; lVar15 = lVar15 + -1) {
                  *pcVar19 = *pcVar18;
                  pcVar18 = pcVar18 + (ulong)bVar22 * -2 + 1;
                  pcVar19 = pcVar19 + (ulong)bVar22 * -2 + 1;
                }
              }
              cVar10 = '\x03';
LAB_00457b27:
              pcStack_10a38 = sHsmResultCode;
              FillSecurityResult(cVar10,sSecurityResults,2);
              PutHsmRjectEvent(&sTlvInfo,cVar10,2);
              HsmDecline(&sTlvInfo,sSecurityResults,pcStack_10a38,'\x02');
              AuthoBuildTlv(sTlvBuffer,&sTlvInfo);
              trace_event("End   CheckSecurity(PIN NOK)",5);
              return -1;
            }
LAB_00456867:
            FillSecurityResult(cVar10,sSecurityResults,2);
            goto LAB_004564f6;
          }
          GetTrack3Data(sTrack3,szPinOff);
          if ((sTrack3[0] == '\0') || (szPinOff[0] == '\0')) {
            lVar15 = 0x1a;
            builtin_strncpy(sHsmResultCode,"-TCK",4);
            pcVar18 = "==> Invalid TrackIII Data";
            pcVar19 = sLine;
            for (; lVar15 != 0; lVar15 = lVar15 + -1) {
              *pcVar19 = *pcVar18;
              pcVar18 = pcVar18 + (ulong)bVar22 * -2 + 1;
              pcVar19 = pcVar19 + (ulong)bVar22 * -2 + 1;
            }
            trace_event(sLine,4);
            if (debug_option == 1) {
              sprintf(sLine,"= sTrack3       : %.40s",sTrack3);
              trace_event(sLine,4);
              sprintf(sLine,"= szPinOff      : %.6s",szPinOff);
              trace_event(sLine,4);
            }
            pcVar18 = "==> Invalid TrackIII Data";
            pcVar19 = sLine;
            for (lVar15 = 0x1a; lVar15 != 0; lVar15 = lVar15 + -1) {
              *pcVar19 = *pcVar18;
              pcVar18 = pcVar18 + (ulong)bVar22 * -2 + 1;
              pcVar19 = pcVar19 + (ulong)bVar22 * -2 + 1;
            }
            trace_event(sLine,4);
            FillSecurityResult('\x03',sSecurityResults,7);
            PutHsmRjectEvent(&sTlvInfo,'\x03',7);
            cVar10 = '\a';
            goto LAB_00457aa8;
          }
          iVar11 = GetPinKey(nIndiceCtx,sPan,sPIN_KEY);
          if (iVar11 == 0) {
            iVar11 = check_pin_data(nIndiceCtx,sPan,pcStack_10aa8,sPinBlockFormat,sPIN_KEY,sTransKey
                                    ,sHsmResultCode);
            cVar10 = (char)iVar11;
            if (cVar10 != '\0') goto LAB_00457a72;
            goto LAB_00457890;
          }
LAB_00457a52:
          builtin_strncpy(sHsmResultCode,"-PVK",4);
          cVar10 = '\x03';
        }
LAB_00457a72:
        FillSecurityResult(cVar10,sSecurityResults,2);
        PutHsmRjectEvent(&sTlvInfo,cVar10,2);
        cVar10 = '\x02';
LAB_00457aa8:
        HsmDecline(&sTlvInfo,sSecurityResults,sHsmResultCode,cVar10);
        AuthoBuildTlv(sTlvBuffer,&sTlvInfo);
        trace_event("End   CheckSecurity(NOK PIN)",5);
        return -1;
      }
    }
  }
LAB_004564f0:
  cVar10 = '4';
LAB_004564f6:
  iVar11 = GetTlvAutho("018",&sTlvInfo,sMcc,&nLength);
  if (iVar11 != 0) {
    trace_event("CheckSecurity : sMcc empty",5);
  }
  iVar11 = GetTlvAutho("003",&sTlvInfo,sProcode,&nLength);
  if (iVar11 != 0) {
    trace_event("CheckSecurity : sProcode empty",5);
  }
  sprintf(sLine,"MCC :(%s),ProcCode (%s)",sMcc,sProcode);
  trace_event(sLine,5);
  iVar11 = GetTlvAutho("055",&sTlvInfo,sIccDataTLV,&nLength);
  if (((iVar11 == 0) && (cVar3 == 'Y')) &&
     (iVar11 = memcmp(sProcode + 6,&DAT_004a554a,2), iVar11 != 0)) {
    InitTlvPrivate((TSTlvPrivate *)sAddDataPriv);
    iVar11 = check_crpt_data(nIndiceCtx,sTlvBuffer,sHsmResultCode);
    iVar14 = GetTlvBuffer("055",sTlvBuffer,sIccDataTLV,&nLength);
    if (iVar14 == 0) {
      PutTlvAutho("055",&sTlvInfo,sIccDataTLV,nLength);
    }
    pcStack_10aa8._0_1_ = (char)iVar11;
    if ((char)pcStack_10aa8 != '\0') {
      GetTlvAutho("048",&sTlvInfo,sTlvPrivateBuffer_1,&nLength);
      AnalyseTlvPrivate(sTlvPrivateBuffer_1,nLength,(TSTlvPrivate *)sAddDataPriv);
      PutTlvPrivate("P44",(TSTlvPrivate *)sAddDataPriv,"1",1);
      nLength = PrivateBuildTlv(sTlvPrivateBuffer_1,(TSTlvPrivate *)sAddDataPriv);
      PutTlvAutho("048",&sTlvInfo,sTlvPrivateBuffer_1,nLength);
      FillSecurityResult((char)pcStack_10aa8,sSecurityResults,4);
      PutHsmRjectEvent(&sTlvInfo,(char)pcStack_10aa8,4);
      HsmDecline(&sTlvInfo,sSecurityResults,sHsmResultCode,'\x04');
      AuthoBuildTlv(sTlvBuffer,&sTlvInfo);
      trace_event("End   CheckSecurity(NOK CRPT)",5);
      return -1;
    }
    GetTlvAutho("048",&sTlvInfo,sTlvPrivateBuffer_1,&nLength);
    AnalyseTlvPrivate(sTlvPrivateBuffer_1,nLength,(TSTlvPrivate *)sAddDataPriv);
    PutTlvPrivate("P44",(TSTlvPrivate *)sAddDataPriv,"2",1);
    nLength = PrivateBuildTlv(sTlvPrivateBuffer_1,(TSTlvPrivate *)sAddDataPriv);
    PutTlvAutho("048",&sTlvInfo,sTlvPrivateBuffer_1,nLength);
    trace_event("MELTRC... crpt_result OK",4);
    cVar20 = '\0';
  }
  else {
    cVar20 = '4';
  }
  FillSecurityResult((char)uVar13,sSecurityResults,0);
  FillSecurityResult(cStack_10a70,sSecurityResults,1);
  FillSecurityResult(cVar10,sSecurityResults,2);
  FillSecurityResult(cVar20,sSecurityResults,4);
  FillSecurityResult((char)uVar12,sSecurityResults,0x12);
  PutTlvAutho("270",&sTlvInfo,sSecurityResults,0x20);
  AuthoBuildTlv(sTlvBuffer,&sTlvInfo);
  trace_event("End   CheckSecurity(OK)",5);
  return 0;
}



// WARNING: Unknown calling convention

int AmountMng(int nIndiceCtx,char *sServGatewayFlag,char *sBillCalculation,char *sTlvBuffer)

{
  size_t __n;
  ulong uVar1;
  uchar *puVar2;
  uint uVar3;
  bool bVar4;
  byte bVar5;
  uchar auStack_3014 [7478];
  char T_serv_client_flag;
  char T_bill_calcul_flag;
  int response_code;
  sqlca sqlca;
  char sLine [512];
  anon_struct_4100_2_43c7b5cf T_tlv_auth;
  
  bVar5 = 0;
  trace_event("Start AmountMng() ",5);
  PrintTlvBuffer(sTlvBuffer);
  puVar2 = T_tlv_auth.arr + 2;
  uVar3 = 0xfff;
  T_tlv_auth.arr[0] = '\0';
  T_tlv_auth.arr[1] = '\0';
  bVar4 = ((ulong)puVar2 & 4) != 0;
  if (bVar4) {
    T_tlv_auth.arr[2] = '\0';
    T_tlv_auth.arr[3] = '\0';
    T_tlv_auth.arr[4] = '\0';
    T_tlv_auth.arr[5] = '\0';
    uVar3 = 0xffb;
    puVar2 = T_tlv_auth.arr + 6;
  }
  for (uVar1 = (ulong)(uVar3 >> 3); uVar1 != 0; uVar1 = uVar1 - 1) {
    puVar2[0] = '\0';
    puVar2[1] = '\0';
    puVar2[2] = '\0';
    puVar2[3] = '\0';
    puVar2[4] = '\0';
    puVar2[5] = '\0';
    puVar2[6] = '\0';
    puVar2[7] = '\0';
    puVar2 = puVar2 + (ulong)bVar5 * -0x10 + 8;
  }
  if (!bVar4) {
    puVar2[0] = '\0';
    puVar2[1] = '\0';
    puVar2[2] = '\0';
    puVar2[3] = '\0';
    puVar2 = puVar2 + 4;
  }
  puVar2[0] = '\0';
  puVar2[1] = '\0';
  puVar2[2] = '\0';
  puVar2 = T_tlv_auth.arr;
  T_tlv_auth.len = 0;
  T_serv_client_flag = '\0';
  T_bill_calcul_flag = '\0';
  __n = strlen(sTlvBuffer);
  memcpy(puVar2,sTlvBuffer,__n);
  T_serv_client_flag = *sServGatewayFlag;
  sLine._40_8_ = &sqlca;
  T_tlv_auth.len = (ushort)__n;
  sLine[0x170] = '\0';
  sLine[0x171] = '\0';
  sLine[0x16] = '\0';
  sLine[0x17] = '\x11';
  sLine[0x178] = '\0';
  sLine[0x179] = '\0';
  T_bill_calcul_flag = *sBillCalculation;
  sLine[0x172] = '\0';
  sLine[0x173] = '\0';
  sLine[0x17a] = '\0';
  sLine[0x17b] = '\0';
  response_code = 0x38d;
  sLine[0] = '\f';
  sLine[1] = '\0';
  sLine[2] = '\0';
  sLine[3] = '\0';
  sLine[4] = '\0';
  sLine[5] = '\0';
  sLine[6] = '\0';
  sLine[7] = '\0';
  sLine[8] = '\x04';
  sLine[9] = '\0';
  sLine[10] = '\0';
  sLine[0xb] = '\0';
  sLine[0xc] = '\x01';
  sLine[0xd] = '\0';
  sLine[0xe] = '\0';
  sLine[0xf] = '\0';
  sLine[0x10] = '\x05';
  sLine[0x11] = '\0';
  sLine[0x12] = '\0';
  sLine[0x13] = '\0';
  sLine._56_8_ = &sqladt;
  sLine[0x18] = '\0';
  sLine[0x19] = '\0';
  sLine[0x1a] = '\0';
  sLine[0x1b] = '\0';
  sLine[0xd0] = '\x04';
  sLine[0xd1] = '\0';
  sLine[0xd2] = '\0';
  sLine[0xd3] = '\0';
  sLine[0xd4] = '\0';
  sLine[0xd5] = '\0';
  sLine[0xd6] = '\0';
  sLine[0xd7] = '\0';
  sLine[0xf0] = '\0';
  sLine[0xf1] = '\0';
  sLine[0xf2] = '\0';
  sLine[0xf3] = '\0';
  sLine._64_8_ = &sqltds;
  sLine[0x100] = '\0';
  sLine[0x101] = '\0';
  sLine[0x102] = '\0';
  sLine[0x103] = '\0';
  sLine[0x104] = '\0';
  sLine[0x105] = '\0';
  sLine[0x106] = '\0';
  sLine[0x107] = '\0';
  sLine[0x120] = '\0';
  sLine[0x121] = '\0';
  sLine[0x122] = '\0';
  sLine[0x123] = '\0';
  sLine[0x130] = '\0';
  sLine[0x131] = '\0';
  sLine[0x132] = '\0';
  sLine[0x133] = '\0';
  sLine[0x134] = '\0';
  sLine[0x135] = '\0';
  sLine[0x136] = '\0';
  sLine[0x137] = '\0';
  sLine._48_8_ = s_begin__response_code____PCRD_P7__004ca3d8;
  sLine[0xd8] = '\x03';
  sLine[0xd9] = '\x10';
  sLine[0xda] = '\0';
  sLine[0xdb] = '\0';
  sLine[0xdc] = '\0';
  sLine[0xdd] = '\0';
  sLine[0xde] = '\0';
  sLine[0xdf] = '\0';
  sLine[0xf4] = '\0';
  sLine[0xf5] = '\0';
  sLine[0xf6] = '\0';
  sLine[0xf7] = '\0';
  sLine[0x108] = '\0';
  sLine[0x109] = '\0';
  sLine[0x10a] = '\0';
  sLine[0x10b] = '\0';
  sLine[0x10c] = '\0';
  sLine[0x10d] = '\0';
  sLine[0x10e] = '\0';
  sLine[0x10f] = '\0';
  sLine._32_8_ = sqlcud0;
  sLine._176_8_ = &response_code;
  sLine[0x124] = '\0';
  sLine[0x125] = '\0';
  sLine[0x126] = '\0';
  sLine[0x127] = '\0';
  sLine[0x138] = '\0';
  sLine[0x139] = '\0';
  sLine[0x13a] = '\0';
  sLine[0x13b] = '\0';
  sLine[0x13c] = '\0';
  sLine[0x13d] = '\0';
  sLine[0x13e] = '\0';
  sLine[0x13f] = '\0';
  sLine._192_8_ = &T_serv_client_flag;
  sLine._200_8_ = &T_bill_calcul_flag;
  sLine[0x176] = '\0';
  sLine[0x177] = '\0';
  sLine[0xe0] = '\x01';
  sLine[0xe1] = '\0';
  sLine[0xe2] = '\0';
  sLine[0xe3] = '\0';
  sLine[0xe4] = '\0';
  sLine[0xe5] = '\0';
  sLine[0xe6] = '\0';
  sLine[0xe7] = '\0';
  sLine[0xf8] = '\0';
  sLine[0xf9] = '\0';
  sLine[0xfa] = '\0';
  sLine[0xfb] = '\0';
  sLine[0x110] = '\0';
  sLine[0x111] = '\0';
  sLine[0x112] = '\0';
  sLine[0x113] = '\0';
  sLine[0x114] = '\0';
  sLine[0x115] = '\0';
  sLine[0x116] = '\0';
  sLine[0x117] = '\0';
  sLine._72_8_ = sLine + 0xb0;
  sLine[0x128] = '\0';
  sLine[0x129] = '\0';
  sLine[0x12a] = '\0';
  sLine[299] = '\0';
  sLine[0x140] = '\0';
  sLine[0x141] = '\0';
  sLine[0x142] = '\0';
  sLine[0x143] = '\0';
  sLine[0x144] = '\0';
  sLine[0x145] = '\0';
  sLine[0x146] = '\0';
  sLine[0x147] = '\0';
  sLine[0x174] = '\0';
  sLine[0x175] = '\0';
  sLine._80_8_ = sLine + 0xd0;
  sLine[0x17c] = '\0';
  sLine[0x17d] = '\0';
  sLine[0xe8] = '\x01';
  sLine[0xe9] = '\0';
  sLine[0xea] = '\0';
  sLine[0xeb] = '\0';
  sLine[0xec] = '\0';
  sLine[0xed] = '\0';
  sLine[0xee] = '\0';
  sLine[0xef] = '\0';
  sLine[0xfc] = '\0';
  sLine[0xfd] = '\0';
  sLine[0xfe] = '\0';
  sLine[0xff] = '\0';
  sLine._88_8_ = sLine + 0xf0;
  sLine[0x118] = '\0';
  sLine[0x119] = '\0';
  sLine[0x11a] = '\0';
  sLine[0x11b] = '\0';
  sLine[0x11c] = '\0';
  sLine[0x11d] = '\0';
  sLine[0x11e] = '\0';
  sLine[0x11f] = '\0';
  sLine[300] = '\0';
  sLine[0x12d] = '\0';
  sLine[0x12e] = '\0';
  sLine[0x12f] = '\0';
  sLine[0x148] = '\0';
  sLine[0x149] = '\0';
  sLine[0x14a] = '\0';
  sLine[0x14b] = '\0';
  sLine[0x14c] = '\0';
  sLine[0x14d] = '\0';
  sLine[0x14e] = '\0';
  sLine[0x14f] = '\0';
  sLine._96_8_ = sLine + 0x100;
  sLine[0x17e] = '\0';
  sLine[0x17f] = '\0';
  sLine._104_8_ = sLine + 0x120;
  sLine._112_8_ = sLine + 0x130;
  sLine._120_8_ = sLine + 0x150;
  sLine._128_8_ = sLine + 0x170;
  sLine._136_8_ = sLine + 0x178;
  sLine._184_8_ = &T_tlv_auth;
  sqlcxt((long)nIndiceCtx * 0x10 + 0x713948,&sqlctx,sLine,&sqlfpn);
  if (sqlca.sqlcode < 0) {
    tlvcpy(sTlvBuffer,(char *)puVar2,(uint)T_tlv_auth.len);
    sprintf(sLine,"%.40s",sqlca.sqlerrm.sqlerrmc);
    trace_event(sLine,1);
    trace_event("End AmountMng(SYSTEM_MALFUNCTION)",5);
    response_code = 0x38d;
  }
  else if (response_code == 0) {
    sTlvBuffer[0] = '\0';
    sTlvBuffer[1] = '\0';
    sTlvBuffer[2] = '\0';
    sTlvBuffer[3] = '\0';
    sTlvBuffer[4] = '\0';
    sTlvBuffer[5] = '\0';
    sTlvBuffer[6] = '\0';
    sTlvBuffer[7] = '\0';
    tlvcpy(sTlvBuffer,(char *)puVar2,(uint)T_tlv_auth.len);
    trace_event("End AmountMng(OK)",5);
    response_code = 0;
  }
  else {
    tlvcpy(sTlvBuffer,(char *)puVar2,(uint)T_tlv_auth.len);
    sprintf(sLine,"End AmountMng(%d)",(ulong)(uint)response_code);
    trace_event(sLine,5);
  }
  return response_code;
}



// WARNING: Unknown calling convention

int CheckFallBack(int nIndiceCtx,char *sOnOffFlag,char *sTlvBuffer)

{
  size_t sVar1;
  ulong uVar2;
  uchar *puVar3;
  uint uVar4;
  bool bVar5;
  byte bVar6;
  uchar auStack_3014 [7468];
  char T_on_off_flag [4];
  int response_code;
  sqlca sqlca;
  char sLine [512];
  anon_struct_4100_2_43c7b5cf T_tlv_auth;
  
  bVar6 = 0;
  trace_event("Start CheckFallBack() ",5);
  puVar3 = T_tlv_auth.arr + 2;
  uVar4 = 0xfff;
  T_tlv_auth.arr[0] = '\0';
  T_tlv_auth.arr[1] = '\0';
  bVar5 = ((ulong)puVar3 & 4) != 0;
  if (bVar5) {
    T_tlv_auth.arr[2] = '\0';
    T_tlv_auth.arr[3] = '\0';
    T_tlv_auth.arr[4] = '\0';
    T_tlv_auth.arr[5] = '\0';
    uVar4 = 0xffb;
    puVar3 = T_tlv_auth.arr + 6;
  }
  for (uVar2 = (ulong)(uVar4 >> 3); uVar2 != 0; uVar2 = uVar2 - 1) {
    puVar3[0] = '\0';
    puVar3[1] = '\0';
    puVar3[2] = '\0';
    puVar3[3] = '\0';
    puVar3[4] = '\0';
    puVar3[5] = '\0';
    puVar3[6] = '\0';
    puVar3[7] = '\0';
    puVar3 = puVar3 + (ulong)bVar6 * -0x10 + 8;
  }
  if (!bVar5) {
    puVar3[0] = '\0';
    puVar3[1] = '\0';
    puVar3[2] = '\0';
    puVar3[3] = '\0';
    puVar3 = puVar3 + 4;
  }
  puVar3[0] = '\0';
  puVar3[1] = '\0';
  puVar3[2] = '\0';
  puVar3 = T_tlv_auth.arr;
  T_tlv_auth.len = 0;
  T_on_off_flag[0] = '\0';
  T_on_off_flag[1] = '\0';
  T_on_off_flag[2] = '\0';
  T_on_off_flag[3] = '\0';
  sVar1 = strlen(sTlvBuffer);
  memcpy(puVar3,sTlvBuffer,sVar1);
  T_tlv_auth.len = (ushort)sVar1;
  sVar1 = strlen(sOnOffFlag);
  memcpy(T_on_off_flag,sOnOffFlag,sVar1);
  sLine._40_8_ = &sqlca;
  sLine._56_8_ = &sqladt;
  sLine[0x148] = '\0';
  sLine[0x149] = '\0';
  sLine._64_8_ = &sqltds;
  sLine[0x16] = '\0';
  sLine[0x17] = '\x11';
  sLine[0x14e] = '\0';
  sLine[0x14f] = '\0';
  sLine._48_8_ = s_begin__response_code____PCRD_P7__004ca4c8;
  sLine[0x14a] = '\0';
  sLine[0x14b] = '\0';
  sLine[0x150] = '\0';
  sLine[0x151] = '\0';
  response_code = 0x38d;
  sLine._32_8_ = sqlcud0;
  sLine._176_8_ = &response_code;
  sLine[0] = '\f';
  sLine[1] = '\0';
  sLine[2] = '\0';
  sLine[3] = '\0';
  sLine[4] = '\0';
  sLine[5] = '\0';
  sLine[6] = '\0';
  sLine[7] = '\0';
  sLine[8] = '\x03';
  sLine[9] = '\0';
  sLine[10] = '\0';
  sLine[0xb] = '\0';
  sLine[0xc] = '\x01';
  sLine[0xd] = '\0';
  sLine[0xe] = '\0';
  sLine[0xf] = '\0';
  sLine._72_8_ = sLine + 0xb0;
  sLine[0x10] = '\x05';
  sLine[0x11] = '\0';
  sLine[0x12] = '\0';
  sLine[0x13] = '\0';
  sLine[0x18] = '\0';
  sLine[0x19] = '\0';
  sLine[0x1a] = '\0';
  sLine[0x1b] = '\0';
  sLine[200] = '\x04';
  sLine[0xc9] = '\0';
  sLine[0xca] = '\0';
  sLine[0xcb] = '\0';
  sLine[0xcc] = '\0';
  sLine[0xcd] = '\0';
  sLine[0xce] = '\0';
  sLine[0xcf] = '\0';
  sLine[0xe0] = '\0';
  sLine[0xe1] = '\0';
  sLine[0xe2] = '\0';
  sLine[0xe3] = '\0';
  sLine[0xf0] = '\0';
  sLine[0xf1] = '\0';
  sLine[0xf2] = '\0';
  sLine[0xf3] = '\0';
  sLine[0xf4] = '\0';
  sLine[0xf5] = '\0';
  sLine[0xf6] = '\0';
  sLine[0xf7] = '\0';
  sLine[0x108] = '\0';
  sLine[0x109] = '\0';
  sLine[0x10a] = '\0';
  sLine[0x10b] = '\0';
  sLine[0x118] = '\0';
  sLine[0x119] = '\0';
  sLine[0x11a] = '\0';
  sLine[0x11b] = '\0';
  sLine[0x11c] = '\0';
  sLine[0x11d] = '\0';
  sLine[0x11e] = '\0';
  sLine[0x11f] = '\0';
  sLine[0xd0] = '\x04';
  sLine[0xd1] = '\0';
  sLine[0xd2] = '\0';
  sLine[0xd3] = '\0';
  sLine[0xd4] = '\0';
  sLine[0xd5] = '\0';
  sLine[0xd6] = '\0';
  sLine[0xd7] = '\0';
  sLine[0xe4] = '\0';
  sLine[0xe5] = '\0';
  sLine[0xe6] = '\0';
  sLine[0xe7] = '\0';
  sLine[0xf8] = '\0';
  sLine[0xf9] = '\0';
  sLine[0xfa] = '\0';
  sLine[0xfb] = '\0';
  sLine[0xfc] = '\0';
  sLine[0xfd] = '\0';
  sLine[0xfe] = '\0';
  sLine[0xff] = '\0';
  sLine[0x10c] = '\0';
  sLine[0x10d] = '\0';
  sLine[0x10e] = '\0';
  sLine[0x10f] = '\0';
  sLine[0x120] = '\0';
  sLine[0x121] = '\0';
  sLine[0x122] = '\0';
  sLine[0x123] = '\0';
  sLine[0x124] = '\0';
  sLine[0x125] = '\0';
  sLine[0x126] = '\0';
  sLine[0x127] = '\0';
  sLine[0xd8] = '\x03';
  sLine[0xd9] = '\x10';
  sLine[0xda] = '\0';
  sLine[0xdb] = '\0';
  sLine[0xdc] = '\0';
  sLine[0xdd] = '\0';
  sLine[0xde] = '\0';
  sLine[0xdf] = '\0';
  sLine[0xe8] = '\0';
  sLine[0xe9] = '\0';
  sLine[0xea] = '\0';
  sLine[0xeb] = '\0';
  sLine[0x100] = '\0';
  sLine[0x101] = '\0';
  sLine[0x102] = '\0';
  sLine[0x103] = '\0';
  sLine[0x104] = '\0';
  sLine[0x105] = '\0';
  sLine[0x106] = '\0';
  sLine[0x107] = '\0';
  sLine[0x110] = '\0';
  sLine[0x111] = '\0';
  sLine[0x112] = '\0';
  sLine[0x113] = '\0';
  sLine[0x128] = '\0';
  sLine[0x129] = '\0';
  sLine[0x12a] = '\0';
  sLine[299] = '\0';
  sLine[300] = '\0';
  sLine[0x12d] = '\0';
  sLine[0x12e] = '\0';
  sLine[0x12f] = '\0';
  sLine._80_8_ = sLine + 200;
  sLine[0x14c] = '\0';
  sLine[0x14d] = '\0';
  sLine[0x152] = '\0';
  sLine[0x153] = '\0';
  sLine._88_8_ = sLine + 0xe0;
  sLine._96_8_ = sLine + 0xf0;
  sLine._104_8_ = sLine + 0x108;
  sLine._112_8_ = sLine + 0x118;
  sLine._120_8_ = sLine + 0x130;
  sLine._128_8_ = sLine + 0x148;
  sLine._136_8_ = sLine + 0x14e;
  sLine._184_8_ = T_on_off_flag;
  sLine._192_8_ = &T_tlv_auth;
  sqlcxt((long)nIndiceCtx * 0x10 + 0x713948,&sqlctx,sLine,&sqlfpn);
  if (sqlca.sqlcode < 0) {
    tlvcpy(sTlvBuffer,(char *)puVar3,(uint)T_tlv_auth.len);
    sprintf(sLine,"%.40s",sqlca.sqlerrm.sqlerrmc);
    trace_event(sLine,1);
    trace_event("End CheckFallBack(SYSTEM_MALFUNCTION)",5);
    response_code = 0x38d;
  }
  else if (response_code == 0) {
    tlvcpy(sTlvBuffer,(char *)puVar3,(uint)T_tlv_auth.len);
    trace_event("End CheckFallBack(OK)",5);
    response_code = 0;
  }
  else {
    tlvcpy(sTlvBuffer,(char *)puVar3,(uint)T_tlv_auth.len);
    sprintf(sLine,"End CheckFallBack(%d)",(ulong)(uint)response_code);
    trace_event(sLine,5);
  }
  return response_code;
}



// WARNING: Unknown calling convention

int PrepaidCheckAccount(int nIndiceCtx,char *sTlvBuffer)

{
  size_t __n;
  ulong uVar1;
  uchar *puVar2;
  uint uVar3;
  bool bVar4;
  byte bVar5;
  uchar auStack_3014 [7464];
  int response_code;
  anon_struct_10_2_43c7b5cf T_tlv_warning;
  sqlca sqlca;
  char sLine [512];
  anon_struct_4100_2_43c7b5cf T_tlv_auth;
  
  bVar5 = 0;
  trace_event("Start PrepaidCheckAccount () ",5);
  PrintTlvBuffer(sTlvBuffer);
  puVar2 = T_tlv_auth.arr + 2;
  uVar3 = 0xfff;
  T_tlv_auth.arr[0] = '\0';
  T_tlv_auth.arr[1] = '\0';
  bVar4 = ((ulong)puVar2 & 4) != 0;
  if (bVar4) {
    T_tlv_auth.arr[2] = '\0';
    T_tlv_auth.arr[3] = '\0';
    T_tlv_auth.arr[4] = '\0';
    T_tlv_auth.arr[5] = '\0';
    uVar3 = 0xffb;
    puVar2 = T_tlv_auth.arr + 6;
  }
  for (uVar1 = (ulong)(uVar3 >> 3); uVar1 != 0; uVar1 = uVar1 - 1) {
    puVar2[0] = '\0';
    puVar2[1] = '\0';
    puVar2[2] = '\0';
    puVar2[3] = '\0';
    puVar2[4] = '\0';
    puVar2[5] = '\0';
    puVar2[6] = '\0';
    puVar2[7] = '\0';
    puVar2 = puVar2 + (ulong)bVar5 * -0x10 + 8;
  }
  if (!bVar4) {
    puVar2[0] = '\0';
    puVar2[1] = '\0';
    puVar2[2] = '\0';
    puVar2[3] = '\0';
    puVar2 = puVar2 + 4;
  }
  puVar2[0] = '\0';
  puVar2[1] = '\0';
  puVar2[2] = '\0';
  T_tlv_warning.len = 0;
  T_tlv_warning.arr[4] = '\0';
  T_tlv_warning.arr[5] = '\0';
  T_tlv_auth.len = 0;
  T_tlv_warning.arr[0] = '\0';
  T_tlv_warning.arr[1] = '\0';
  T_tlv_warning.arr[2] = '\0';
  T_tlv_warning.arr[3] = '\0';
  T_tlv_warning.arr[6] = '\0';
  __n = strlen(sTlvBuffer);
  memcpy(T_tlv_auth.arr,sTlvBuffer,__n);
  T_tlv_auth.len = (ushort)__n;
  sLine._40_8_ = &sqlca;
  sLine._56_8_ = &sqladt;
  sLine._64_8_ = &sqltds;
  sLine[0x16] = '\0';
  sLine[0x17] = '\x11';
  sLine[0x148] = '\0';
  sLine[0x149] = '\0';
  sLine[0x14e] = '\0';
  sLine[0x14f] = '\0';
  sLine._48_8_ = s_begin__response_code____P7_OCT_A_004ca5d8;
  sLine[0x14a] = '\0';
  sLine[0x14b] = '\0';
  sLine[0x150] = '\0';
  sLine[0x151] = '\0';
  sLine._32_8_ = sqlcud0;
  sLine._176_8_ = &response_code;
  response_code = 0x38d;
  sLine[0] = '\f';
  sLine[1] = '\0';
  sLine[2] = '\0';
  sLine[3] = '\0';
  sLine[4] = '\0';
  sLine[5] = '\0';
  sLine[6] = '\0';
  sLine[7] = '\0';
  sLine[8] = '\x03';
  sLine[9] = '\0';
  sLine[10] = '\0';
  sLine[0xb] = '\0';
  sLine[0xc] = '\x01';
  sLine[0xd] = '\0';
  sLine[0xe] = '\0';
  sLine[0xf] = '\0';
  sLine[0x10] = '\x05';
  sLine[0x11] = '\0';
  sLine[0x12] = '\0';
  sLine[0x13] = '\0';
  sLine[0x18] = '\0';
  sLine[0x19] = '\0';
  sLine[0x1a] = '\0';
  sLine[0x1b] = '\0';
  sLine[200] = '\x04';
  sLine[0xc9] = '\0';
  sLine[0xca] = '\0';
  sLine[0xcb] = '\0';
  sLine[0xcc] = '\0';
  sLine[0xcd] = '\0';
  sLine[0xce] = '\0';
  sLine[0xcf] = '\0';
  sLine[0xe0] = '\0';
  sLine[0xe1] = '\0';
  sLine[0xe2] = '\0';
  sLine[0xe3] = '\0';
  sLine[0xf0] = '\0';
  sLine[0xf1] = '\0';
  sLine[0xf2] = '\0';
  sLine[0xf3] = '\0';
  sLine[0xf4] = '\0';
  sLine[0xf5] = '\0';
  sLine[0xf6] = '\0';
  sLine[0xf7] = '\0';
  sLine[0x108] = '\0';
  sLine[0x109] = '\0';
  sLine[0x10a] = '\0';
  sLine[0x10b] = '\0';
  sLine[0x118] = '\0';
  sLine[0x119] = '\0';
  sLine[0x11a] = '\0';
  sLine[0x11b] = '\0';
  sLine[0x11c] = '\0';
  sLine[0x11d] = '\0';
  sLine[0x11e] = '\0';
  sLine[0x11f] = '\0';
  sLine[0xd0] = '\x03';
  sLine[0xd1] = '\x10';
  sLine[0xd2] = '\0';
  sLine[0xd3] = '\0';
  sLine[0xd4] = '\0';
  sLine[0xd5] = '\0';
  sLine[0xd6] = '\0';
  sLine[0xd7] = '\0';
  sLine[0xe4] = '\0';
  sLine[0xe5] = '\0';
  sLine[0xe6] = '\0';
  sLine[0xe7] = '\0';
  sLine[0xf8] = '\0';
  sLine[0xf9] = '\0';
  sLine[0xfa] = '\0';
  sLine[0xfb] = '\0';
  sLine[0xfc] = '\0';
  sLine[0xfd] = '\0';
  sLine[0xfe] = '\0';
  sLine[0xff] = '\0';
  sLine[0x10c] = '\0';
  sLine[0x10d] = '\0';
  sLine[0x10e] = '\0';
  sLine[0x10f] = '\0';
  sLine[0x120] = '\0';
  sLine[0x121] = '\0';
  sLine[0x122] = '\0';
  sLine[0x123] = '\0';
  sLine[0x124] = '\0';
  sLine[0x125] = '\0';
  sLine[0x126] = '\0';
  sLine[0x127] = '\0';
  sLine[0xd8] = '\t';
  sLine[0xd9] = '\0';
  sLine[0xda] = '\0';
  sLine[0xdb] = '\0';
  sLine[0xdc] = '\0';
  sLine[0xdd] = '\0';
  sLine[0xde] = '\0';
  sLine[0xdf] = '\0';
  sLine[0xe8] = '\0';
  sLine[0xe9] = '\0';
  sLine[0xea] = '\0';
  sLine[0xeb] = '\0';
  sLine[0x100] = '\0';
  sLine[0x101] = '\0';
  sLine[0x102] = '\0';
  sLine[0x103] = '\0';
  sLine[0x104] = '\0';
  sLine[0x105] = '\0';
  sLine[0x106] = '\0';
  sLine[0x107] = '\0';
  sLine[0x110] = '\0';
  sLine[0x111] = '\0';
  sLine[0x112] = '\0';
  sLine[0x113] = '\0';
  sLine[0x152] = '\0';
  sLine[0x153] = '\0';
  sLine[0x128] = '\0';
  sLine[0x129] = '\0';
  sLine[0x12a] = '\0';
  sLine[299] = '\0';
  sLine[300] = '\0';
  sLine[0x12d] = '\0';
  sLine[0x12e] = '\0';
  sLine[0x12f] = '\0';
  sLine[0x14c] = '\0';
  sLine[0x14d] = '\0';
  sLine._72_8_ = sLine + 0xb0;
  sLine._80_8_ = sLine + 200;
  sLine._88_8_ = sLine + 0xe0;
  sLine._96_8_ = sLine + 0xf0;
  sLine._104_8_ = sLine + 0x108;
  sLine._112_8_ = sLine + 0x118;
  sLine._120_8_ = sLine + 0x130;
  sLine._128_8_ = sLine + 0x148;
  sLine._136_8_ = sLine + 0x14e;
  sLine._184_8_ = &T_tlv_auth;
  sLine._192_8_ = &T_tlv_warning;
  sqlcxt((long)nIndiceCtx * 0x10 + 0x713948,&sqlctx,sLine,&sqlfpn);
  if (sqlca.sqlcode < 0) {
    sprintf(sLine,"%.40s",sqlca.sqlerrm.sqlerrmc);
    trace_event(sLine,1);
    trace_event("End PrepaidCheckAccount NOK (SYSTEM_MALFUNCTION)",5);
    response_code = 0x38d;
  }
  else {
    sprintf(sLine,"End PrepaidCheckAccount (%d,%.6s)",(ulong)(uint)response_code,T_tlv_warning.arr);
    trace_event(sLine,5);
    memcpy(sTlvBuffer,T_tlv_auth.arr,(ulong)T_tlv_auth.len);
  }
  return response_code;
}



// WARNING: Unknown calling convention

int OctAccountDeposit(int nIndiceCtx,char *sTlvBuffer)

{
  size_t __n;
  ulong uVar1;
  uchar *puVar2;
  uint uVar3;
  bool bVar4;
  byte bVar5;
  uchar auStack_3014 [7464];
  int response_code;
  anon_struct_10_2_43c7b5cf T_tlv_warning;
  sqlca sqlca;
  char sLine [512];
  anon_struct_4100_2_43c7b5cf T_tlv_auth;
  
  bVar5 = 0;
  trace_event("Start OctAccountDeposit () ",5);
  PrintTlvBuffer(sTlvBuffer);
  puVar2 = T_tlv_auth.arr + 2;
  uVar3 = 0xfff;
  T_tlv_auth.arr[0] = '\0';
  T_tlv_auth.arr[1] = '\0';
  bVar4 = ((ulong)puVar2 & 4) != 0;
  if (bVar4) {
    T_tlv_auth.arr[2] = '\0';
    T_tlv_auth.arr[3] = '\0';
    T_tlv_auth.arr[4] = '\0';
    T_tlv_auth.arr[5] = '\0';
    uVar3 = 0xffb;
    puVar2 = T_tlv_auth.arr + 6;
  }
  for (uVar1 = (ulong)(uVar3 >> 3); uVar1 != 0; uVar1 = uVar1 - 1) {
    puVar2[0] = '\0';
    puVar2[1] = '\0';
    puVar2[2] = '\0';
    puVar2[3] = '\0';
    puVar2[4] = '\0';
    puVar2[5] = '\0';
    puVar2[6] = '\0';
    puVar2[7] = '\0';
    puVar2 = puVar2 + (ulong)bVar5 * -0x10 + 8;
  }
  if (!bVar4) {
    puVar2[0] = '\0';
    puVar2[1] = '\0';
    puVar2[2] = '\0';
    puVar2[3] = '\0';
    puVar2 = puVar2 + 4;
  }
  puVar2[0] = '\0';
  puVar2[1] = '\0';
  puVar2[2] = '\0';
  T_tlv_warning.len = 0;
  T_tlv_warning.arr[4] = '\0';
  T_tlv_warning.arr[5] = '\0';
  T_tlv_auth.len = 0;
  T_tlv_warning.arr[0] = '\0';
  T_tlv_warning.arr[1] = '\0';
  T_tlv_warning.arr[2] = '\0';
  T_tlv_warning.arr[3] = '\0';
  T_tlv_warning.arr[6] = '\0';
  __n = strlen(sTlvBuffer);
  memcpy(T_tlv_auth.arr,sTlvBuffer,__n);
  T_tlv_auth.len = (ushort)__n;
  sLine._40_8_ = &sqlca;
  sLine._56_8_ = &sqladt;
  sLine._64_8_ = &sqltds;
  sLine[0x16] = '\0';
  sLine[0x17] = '\x11';
  sLine[0x148] = '\0';
  sLine[0x149] = '\0';
  sLine[0x14e] = '\0';
  sLine[0x14f] = '\0';
  sLine._48_8_ = s_begin__response_code____P7_OCT_A_004ca6a8;
  sLine[0x14a] = '\0';
  sLine[0x14b] = '\0';
  sLine[0x150] = '\0';
  sLine[0x151] = '\0';
  sLine._32_8_ = sqlcud0;
  sLine._176_8_ = &response_code;
  response_code = 0x38d;
  sLine[0] = '\f';
  sLine[1] = '\0';
  sLine[2] = '\0';
  sLine[3] = '\0';
  sLine[4] = '\0';
  sLine[5] = '\0';
  sLine[6] = '\0';
  sLine[7] = '\0';
  sLine[8] = '\x03';
  sLine[9] = '\0';
  sLine[10] = '\0';
  sLine[0xb] = '\0';
  sLine[0xc] = '\x01';
  sLine[0xd] = '\0';
  sLine[0xe] = '\0';
  sLine[0xf] = '\0';
  sLine[0x10] = ' ';
  sLine[0x11] = '\0';
  sLine[0x12] = '\0';
  sLine[0x13] = '\0';
  sLine[0x18] = '\0';
  sLine[0x19] = '\0';
  sLine[0x1a] = '\0';
  sLine[0x1b] = '\0';
  sLine[200] = '\x04';
  sLine[0xc9] = '\0';
  sLine[0xca] = '\0';
  sLine[0xcb] = '\0';
  sLine[0xcc] = '\0';
  sLine[0xcd] = '\0';
  sLine[0xce] = '\0';
  sLine[0xcf] = '\0';
  sLine[0xe0] = '\0';
  sLine[0xe1] = '\0';
  sLine[0xe2] = '\0';
  sLine[0xe3] = '\0';
  sLine[0xf0] = '\0';
  sLine[0xf1] = '\0';
  sLine[0xf2] = '\0';
  sLine[0xf3] = '\0';
  sLine[0xf4] = '\0';
  sLine[0xf5] = '\0';
  sLine[0xf6] = '\0';
  sLine[0xf7] = '\0';
  sLine[0x108] = '\0';
  sLine[0x109] = '\0';
  sLine[0x10a] = '\0';
  sLine[0x10b] = '\0';
  sLine[0x118] = '\0';
  sLine[0x119] = '\0';
  sLine[0x11a] = '\0';
  sLine[0x11b] = '\0';
  sLine[0x11c] = '\0';
  sLine[0x11d] = '\0';
  sLine[0x11e] = '\0';
  sLine[0x11f] = '\0';
  sLine[0xd0] = '\x03';
  sLine[0xd1] = '\x10';
  sLine[0xd2] = '\0';
  sLine[0xd3] = '\0';
  sLine[0xd4] = '\0';
  sLine[0xd5] = '\0';
  sLine[0xd6] = '\0';
  sLine[0xd7] = '\0';
  sLine[0xe4] = '\0';
  sLine[0xe5] = '\0';
  sLine[0xe6] = '\0';
  sLine[0xe7] = '\0';
  sLine[0xf8] = '\0';
  sLine[0xf9] = '\0';
  sLine[0xfa] = '\0';
  sLine[0xfb] = '\0';
  sLine[0xfc] = '\0';
  sLine[0xfd] = '\0';
  sLine[0xfe] = '\0';
  sLine[0xff] = '\0';
  sLine[0x10c] = '\0';
  sLine[0x10d] = '\0';
  sLine[0x10e] = '\0';
  sLine[0x10f] = '\0';
  sLine[0x120] = '\0';
  sLine[0x121] = '\0';
  sLine[0x122] = '\0';
  sLine[0x123] = '\0';
  sLine[0x124] = '\0';
  sLine[0x125] = '\0';
  sLine[0x126] = '\0';
  sLine[0x127] = '\0';
  sLine[0xd8] = '\t';
  sLine[0xd9] = '\0';
  sLine[0xda] = '\0';
  sLine[0xdb] = '\0';
  sLine[0xdc] = '\0';
  sLine[0xdd] = '\0';
  sLine[0xde] = '\0';
  sLine[0xdf] = '\0';
  sLine[0xe8] = '\0';
  sLine[0xe9] = '\0';
  sLine[0xea] = '\0';
  sLine[0xeb] = '\0';
  sLine[0x100] = '\0';
  sLine[0x101] = '\0';
  sLine[0x102] = '\0';
  sLine[0x103] = '\0';
  sLine[0x104] = '\0';
  sLine[0x105] = '\0';
  sLine[0x106] = '\0';
  sLine[0x107] = '\0';
  sLine[0x110] = '\0';
  sLine[0x111] = '\0';
  sLine[0x112] = '\0';
  sLine[0x113] = '\0';
  sLine[0x152] = '\0';
  sLine[0x153] = '\0';
  sLine[0x128] = '\0';
  sLine[0x129] = '\0';
  sLine[0x12a] = '\0';
  sLine[299] = '\0';
  sLine[300] = '\0';
  sLine[0x12d] = '\0';
  sLine[0x12e] = '\0';
  sLine[0x12f] = '\0';
  sLine[0x14c] = '\0';
  sLine[0x14d] = '\0';
  sLine._72_8_ = sLine + 0xb0;
  sLine._80_8_ = sLine + 200;
  sLine._88_8_ = sLine + 0xe0;
  sLine._96_8_ = sLine + 0xf0;
  sLine._104_8_ = sLine + 0x108;
  sLine._112_8_ = sLine + 0x118;
  sLine._120_8_ = sLine + 0x130;
  sLine._128_8_ = sLine + 0x148;
  sLine._136_8_ = sLine + 0x14e;
  sLine._184_8_ = &T_tlv_auth;
  sLine._192_8_ = &T_tlv_warning;
  sqlcxt((long)nIndiceCtx * 0x10 + 0x713948,&sqlctx,sLine,&sqlfpn);
  if (sqlca.sqlcode < 0) {
    sprintf(sLine,"%.40s",sqlca.sqlerrm.sqlerrmc);
    trace_event(sLine,1);
    trace_event("End OctAccountDeposit NOK (SYSTEM_MALFUNCTION)",5);
    response_code = 0x38d;
  }
  else {
    sprintf(sLine,"End OctAccountDeposit (%d,%.6s)",(ulong)(uint)response_code,T_tlv_warning.arr);
    trace_event(sLine,5);
    memcpy(sTlvBuffer,T_tlv_auth.arr,(ulong)T_tlv_auth.len);
  }
  return response_code;
}



// WARNING: Unknown calling convention

int CheckOctAcceptance(int nIndiceCtx,char *sTlvBuffer,char *p_card_number)

{
  size_t sVar1;
  ulong uVar2;
  uchar *puVar3;
  uint uVar4;
  bool bVar5;
  byte bVar6;
  uchar auStack_3014 [7448];
  int response_code;
  anon_struct_26_2_43c7b5cf T_card_number;
  sqlca sqlca;
  char sLine [512];
  anon_struct_4100_2_43c7b5cf T_tlv_auth;
  
  bVar6 = 0;
  trace_event("Start CheckOctAcceptance () ",5);
  PrintTlvBuffer(sTlvBuffer);
  T_card_number.len = 0;
  sLine._184_8_ = &T_tlv_auth;
  T_card_number.arr[0] = '\0';
  T_card_number.arr[1] = '\0';
  T_card_number.arr[2] = '\0';
  T_card_number.arr[3] = '\0';
  T_card_number.arr[4] = '\0';
  T_card_number.arr[5] = '\0';
  T_card_number.arr[6] = '\0';
  T_card_number.arr[7] = '\0';
  uVar4 = 0xfff;
  T_card_number.arr[8] = '\0';
  T_card_number.arr[9] = '\0';
  T_card_number.arr[10] = '\0';
  T_card_number.arr[0xb] = '\0';
  T_card_number.arr[0xc] = '\0';
  T_card_number.arr[0xd] = '\0';
  T_card_number.arr[0xe] = '\0';
  T_card_number.arr[0xf] = '\0';
  puVar3 = T_tlv_auth.arr + 2;
  T_card_number.arr[0x10] = '\0';
  T_card_number.arr[0x11] = '\0';
  T_card_number.arr[0x12] = '\0';
  T_card_number.arr[0x13] = '\0';
  T_card_number.arr[0x14] = '\0';
  T_card_number.arr[0x15] = '\0';
  T_card_number.arr[0x16] = '\0';
  T_tlv_auth.arr[0] = '\0';
  T_tlv_auth.arr[1] = '\0';
  bVar5 = ((ulong)puVar3 & 4) != 0;
  if (bVar5) {
    T_tlv_auth.arr[2] = '\0';
    T_tlv_auth.arr[3] = '\0';
    T_tlv_auth.arr[4] = '\0';
    T_tlv_auth.arr[5] = '\0';
    uVar4 = 0xffb;
    puVar3 = T_tlv_auth.arr + 6;
  }
  for (uVar2 = (ulong)(uVar4 >> 3); uVar2 != 0; uVar2 = uVar2 - 1) {
    puVar3[0] = '\0';
    puVar3[1] = '\0';
    puVar3[2] = '\0';
    puVar3[3] = '\0';
    puVar3[4] = '\0';
    puVar3[5] = '\0';
    puVar3[6] = '\0';
    puVar3[7] = '\0';
    puVar3 = puVar3 + (ulong)bVar6 * -0x10 + 8;
  }
  if (!bVar5) {
    puVar3[0] = '\0';
    puVar3[1] = '\0';
    puVar3[2] = '\0';
    puVar3[3] = '\0';
    puVar3 = puVar3 + 4;
  }
  puVar3[0] = '\0';
  puVar3[1] = '\0';
  puVar3[2] = '\0';
  T_tlv_auth.len = 0;
  sVar1 = strlen(p_card_number);
  memcpy(T_card_number.arr,p_card_number,sVar1);
  T_card_number.len = (ushort)sVar1;
  sVar1 = strlen(sTlvBuffer);
  memcpy(T_tlv_auth.arr,sTlvBuffer,sVar1);
  T_tlv_auth.len = (ushort)sVar1;
  sLine._56_8_ = &sqladt;
  sLine[0x148] = '\0';
  sLine[0x149] = '\0';
  sLine[0x14e] = '\0';
  sLine[0x14f] = '\0';
  sLine._64_8_ = &sqltds;
  sLine[0x16] = '\0';
  sLine[0x17] = '\x11';
  sLine[0x14a] = '\0';
  sLine[0x14b] = '\0';
  sLine[0x150] = '\0';
  sLine[0x151] = '\0';
  sLine._48_8_ = s_begin__response_code____PCRD_P7__004ca768;
  response_code = 0x38d;
  sLine[0] = '\f';
  sLine[1] = '\0';
  sLine[2] = '\0';
  sLine[3] = '\0';
  sLine[4] = '\0';
  sLine[5] = '\0';
  sLine[6] = '\0';
  sLine[7] = '\0';
  sLine[8] = '\x03';
  sLine[9] = '\0';
  sLine[10] = '\0';
  sLine[0xb] = '\0';
  sLine._32_8_ = sqlcud0;
  sLine._176_8_ = &response_code;
  sLine[0xc] = '\x01';
  sLine[0xd] = '\0';
  sLine[0xe] = '\0';
  sLine[0xf] = '\0';
  sLine[0x10] = ';';
  sLine[0x11] = '\0';
  sLine[0x12] = '\0';
  sLine[0x13] = '\0';
  sLine._72_8_ = sLine + 0xb0;
  sLine[0x18] = '\0';
  sLine[0x19] = '\0';
  sLine[0x1a] = '\0';
  sLine[0x1b] = '\0';
  sLine[200] = '\x04';
  sLine[0xc9] = '\0';
  sLine[0xca] = '\0';
  sLine[0xcb] = '\0';
  sLine[0xcc] = '\0';
  sLine[0xcd] = '\0';
  sLine[0xce] = '\0';
  sLine[0xcf] = '\0';
  sLine[0xe0] = '\0';
  sLine[0xe1] = '\0';
  sLine[0xe2] = '\0';
  sLine[0xe3] = '\0';
  sLine[0xf0] = '\0';
  sLine[0xf1] = '\0';
  sLine[0xf2] = '\0';
  sLine[0xf3] = '\0';
  sLine[0xf4] = '\0';
  sLine[0xf5] = '\0';
  sLine[0xf6] = '\0';
  sLine[0xf7] = '\0';
  sLine[0x108] = '\0';
  sLine[0x109] = '\0';
  sLine[0x10a] = '\0';
  sLine[0x10b] = '\0';
  sLine[0x118] = '\0';
  sLine[0x119] = '\0';
  sLine[0x11a] = '\0';
  sLine[0x11b] = '\0';
  sLine[0x11c] = '\0';
  sLine[0x11d] = '\0';
  sLine[0x11e] = '\0';
  sLine[0x11f] = '\0';
  sLine[0xd0] = '\x03';
  sLine[0xd1] = '\x10';
  sLine[0xd2] = '\0';
  sLine[0xd3] = '\0';
  sLine[0xd4] = '\0';
  sLine[0xd5] = '\0';
  sLine[0xd6] = '\0';
  sLine[0xd7] = '\0';
  sLine[0xe4] = '\0';
  sLine[0xe5] = '\0';
  sLine[0xe6] = '\0';
  sLine[0xe7] = '\0';
  sLine[0xf8] = '\0';
  sLine[0xf9] = '\0';
  sLine[0xfa] = '\0';
  sLine[0xfb] = '\0';
  sLine[0xfc] = '\0';
  sLine[0xfd] = '\0';
  sLine[0xfe] = '\0';
  sLine[0xff] = '\0';
  sLine[0x10c] = '\0';
  sLine[0x10d] = '\0';
  sLine[0x10e] = '\0';
  sLine[0x10f] = '\0';
  sLine[0x120] = '\0';
  sLine[0x121] = '\0';
  sLine[0x122] = '\0';
  sLine[0x123] = '\0';
  sLine[0x124] = '\0';
  sLine[0x125] = '\0';
  sLine[0x126] = '\0';
  sLine[0x127] = '\0';
  sLine[0xd8] = '\x19';
  sLine[0xd9] = '\0';
  sLine[0xda] = '\0';
  sLine[0xdb] = '\0';
  sLine[0xdc] = '\0';
  sLine[0xdd] = '\0';
  sLine[0xde] = '\0';
  sLine[0xdf] = '\0';
  sLine[0xe8] = '\0';
  sLine[0xe9] = '\0';
  sLine[0xea] = '\0';
  sLine[0xeb] = '\0';
  sLine[0x100] = '\0';
  sLine[0x101] = '\0';
  sLine[0x102] = '\0';
  sLine[0x103] = '\0';
  sLine[0x104] = '\0';
  sLine[0x105] = '\0';
  sLine[0x106] = '\0';
  sLine[0x107] = '\0';
  sLine[0x110] = '\0';
  sLine[0x111] = '\0';
  sLine[0x112] = '\0';
  sLine[0x113] = '\0';
  sLine._80_8_ = sLine + 200;
  sLine[0x128] = '\0';
  sLine[0x129] = '\0';
  sLine[0x12a] = '\0';
  sLine[299] = '\0';
  sLine[300] = '\0';
  sLine[0x12d] = '\0';
  sLine[0x12e] = '\0';
  sLine[0x12f] = '\0';
  sLine[0x14c] = '\0';
  sLine[0x14d] = '\0';
  sLine[0x152] = '\0';
  sLine[0x153] = '\0';
  sLine._88_8_ = sLine + 0xe0;
  sLine._96_8_ = sLine + 0xf0;
  sLine._104_8_ = sLine + 0x108;
  sLine._112_8_ = sLine + 0x118;
  sLine._120_8_ = sLine + 0x130;
  sLine._128_8_ = sLine + 0x148;
  sLine._136_8_ = sLine + 0x14e;
  sLine._40_8_ = &sqlca;
  sLine._192_8_ = &T_card_number;
  sqlcxt((long)nIndiceCtx * 0x10 + 0x713948,&sqlctx,sLine,&sqlfpn);
  if (sqlca.sqlcode < 0) {
    sprintf(sLine,"%.40s",sqlca.sqlerrm.sqlerrmc);
    trace_event(sLine,1);
    trace_event("End CheckOctAcceptance NOK (SYSTEM_MALFUNCTION)",5);
    response_code = 0x38d;
  }
  else {
    sprintf(sLine,"End CheckOctAcceptance (%d)",(ulong)(uint)response_code);
    trace_event(sLine,5);
    memcpy(sTlvBuffer,T_tlv_auth.arr,(ulong)T_tlv_auth.len);
  }
  return response_code;
}



// WARNING: Unknown calling convention

int CheckPhone(int nIndiceCtx,char *card_number,char *sTlvBuffer)

{
  size_t sVar1;
  ulong uVar2;
  uchar *puVar3;
  uint uVar4;
  bool bVar5;
  byte bVar6;
  uchar auStack_3014 [7448];
  int response_code;
  anon_struct_26_2_43c7b5cf T_Card_Number;
  sqlca sqlca;
  char sLine [512];
  anon_struct_4100_2_43c7b5cf T_tlv_auth;
  
  bVar6 = 0;
  trace_event("Start CheckPhone",5);
  puVar3 = T_tlv_auth.arr + 2;
  T_tlv_auth.arr[0] = '\0';
  T_tlv_auth.arr[1] = '\0';
  uVar4 = 0xfff;
  bVar5 = ((ulong)puVar3 & 4) != 0;
  if (bVar5) {
    T_tlv_auth.arr[2] = '\0';
    T_tlv_auth.arr[3] = '\0';
    T_tlv_auth.arr[4] = '\0';
    T_tlv_auth.arr[5] = '\0';
    uVar4 = 0xffb;
    puVar3 = T_tlv_auth.arr + 6;
  }
  for (uVar2 = (ulong)(uVar4 >> 3); uVar2 != 0; uVar2 = uVar2 - 1) {
    puVar3[0] = '\0';
    puVar3[1] = '\0';
    puVar3[2] = '\0';
    puVar3[3] = '\0';
    puVar3[4] = '\0';
    puVar3[5] = '\0';
    puVar3[6] = '\0';
    puVar3[7] = '\0';
    puVar3 = puVar3 + (ulong)bVar6 * -0x10 + 8;
  }
  if (!bVar5) {
    puVar3[0] = '\0';
    puVar3[1] = '\0';
    puVar3[2] = '\0';
    puVar3[3] = '\0';
    puVar3 = puVar3 + 4;
  }
  puVar3[0] = '\0';
  puVar3[1] = '\0';
  puVar3[2] = '\0';
  puVar3 = T_tlv_auth.arr;
  T_Card_Number.len = 0;
  T_Card_Number.arr[0x14] = '\0';
  T_Card_Number.arr[0x15] = '\0';
  T_tlv_auth.len = 0;
  T_Card_Number.arr[0] = '\0';
  T_Card_Number.arr[1] = '\0';
  T_Card_Number.arr[2] = '\0';
  T_Card_Number.arr[3] = '\0';
  T_Card_Number.arr[4] = '\0';
  T_Card_Number.arr[5] = '\0';
  T_Card_Number.arr[6] = '\0';
  T_Card_Number.arr[7] = '\0';
  T_Card_Number.arr[8] = '\0';
  T_Card_Number.arr[9] = '\0';
  T_Card_Number.arr[10] = '\0';
  T_Card_Number.arr[0xb] = '\0';
  T_Card_Number.arr[0xc] = '\0';
  T_Card_Number.arr[0xd] = '\0';
  T_Card_Number.arr[0xe] = '\0';
  T_Card_Number.arr[0xf] = '\0';
  T_Card_Number.arr[0x10] = '\0';
  T_Card_Number.arr[0x11] = '\0';
  T_Card_Number.arr[0x12] = '\0';
  T_Card_Number.arr[0x13] = '\0';
  T_Card_Number.arr[0x16] = '\0';
  sVar1 = strlen(sTlvBuffer);
  memcpy(puVar3,sTlvBuffer,sVar1);
  T_tlv_auth.len = (ushort)sVar1;
  sVar1 = strlen(card_number);
  memcpy(T_Card_Number.arr,card_number,sVar1);
  sLine._56_8_ = &sqladt;
  T_Card_Number.len = (ushort)sVar1;
  sLine[0x16] = '\0';
  sLine[0x17] = '\x11';
  sLine._64_8_ = &sqltds;
  sLine[0x148] = '\0';
  sLine[0x149] = '\0';
  sLine[0x14e] = '\0';
  sLine[0x14f] = '\0';
  sLine[0x14a] = '\0';
  sLine[0x14b] = '\0';
  sLine._48_8_ = s_begin__response_code____PCRD_CUP_004ca848;
  sLine[0x150] = '\0';
  sLine[0x151] = '\0';
  sLine[0] = '\f';
  sLine[1] = '\0';
  sLine[2] = '\0';
  sLine[3] = '\0';
  sLine[4] = '\0';
  sLine[5] = '\0';
  sLine[6] = '\0';
  sLine[7] = '\0';
  sLine[8] = '\x03';
  sLine[9] = '\0';
  sLine[10] = '\0';
  sLine[0xb] = '\0';
  sLine._32_8_ = sqlcud0;
  sLine._176_8_ = &response_code;
  sLine[0xc] = '\x01';
  sLine[0xd] = '\0';
  sLine[0xe] = '\0';
  sLine[0xf] = '\0';
  sLine[0x10] = '\x05';
  sLine[0x11] = '\0';
  sLine[0x12] = '\0';
  sLine[0x13] = '\0';
  sLine[0x18] = '\0';
  sLine[0x19] = '\0';
  sLine[0x1a] = '\0';
  sLine[0x1b] = '\0';
  sLine[200] = '\x04';
  sLine[0xc9] = '\0';
  sLine[0xca] = '\0';
  sLine[0xcb] = '\0';
  sLine[0xcc] = '\0';
  sLine[0xcd] = '\0';
  sLine[0xce] = '\0';
  sLine[0xcf] = '\0';
  sLine[0xe0] = '\0';
  sLine[0xe1] = '\0';
  sLine[0xe2] = '\0';
  sLine[0xe3] = '\0';
  sLine[0xf0] = '\0';
  sLine[0xf1] = '\0';
  sLine[0xf2] = '\0';
  sLine[0xf3] = '\0';
  sLine[0xf4] = '\0';
  sLine[0xf5] = '\0';
  sLine[0xf6] = '\0';
  sLine[0xf7] = '\0';
  sLine[0x108] = '\0';
  sLine[0x109] = '\0';
  sLine[0x10a] = '\0';
  sLine[0x10b] = '\0';
  sLine[0x118] = '\0';
  sLine[0x119] = '\0';
  sLine[0x11a] = '\0';
  sLine[0x11b] = '\0';
  sLine[0x11c] = '\0';
  sLine[0x11d] = '\0';
  sLine[0x11e] = '\0';
  sLine[0x11f] = '\0';
  sLine[0xd0] = '\x19';
  sLine[0xd1] = '\0';
  sLine[0xd2] = '\0';
  sLine[0xd3] = '\0';
  sLine[0xd4] = '\0';
  sLine[0xd5] = '\0';
  sLine[0xd6] = '\0';
  sLine[0xd7] = '\0';
  sLine[0xe4] = '\0';
  sLine[0xe5] = '\0';
  sLine[0xe6] = '\0';
  sLine[0xe7] = '\0';
  sLine[0xf8] = '\0';
  sLine[0xf9] = '\0';
  sLine[0xfa] = '\0';
  sLine[0xfb] = '\0';
  sLine[0xfc] = '\0';
  sLine[0xfd] = '\0';
  sLine[0xfe] = '\0';
  sLine[0xff] = '\0';
  sLine[0x10c] = '\0';
  sLine[0x10d] = '\0';
  sLine[0x10e] = '\0';
  sLine[0x10f] = '\0';
  sLine[0x120] = '\0';
  sLine[0x121] = '\0';
  sLine[0x122] = '\0';
  sLine[0x123] = '\0';
  sLine[0x124] = '\0';
  sLine[0x125] = '\0';
  sLine[0x126] = '\0';
  sLine[0x127] = '\0';
  sLine[0xd8] = '\x03';
  sLine[0xd9] = '\x10';
  sLine[0xda] = '\0';
  sLine[0xdb] = '\0';
  sLine[0xdc] = '\0';
  sLine[0xdd] = '\0';
  sLine[0xde] = '\0';
  sLine[0xdf] = '\0';
  sLine[0xe8] = '\0';
  sLine[0xe9] = '\0';
  sLine[0xea] = '\0';
  sLine[0xeb] = '\0';
  sLine[0x100] = '\0';
  sLine[0x101] = '\0';
  sLine[0x102] = '\0';
  sLine[0x103] = '\0';
  sLine[0x104] = '\0';
  sLine[0x105] = '\0';
  sLine[0x106] = '\0';
  sLine[0x107] = '\0';
  sLine[0x110] = '\0';
  sLine[0x111] = '\0';
  sLine[0x112] = '\0';
  sLine[0x113] = '\0';
  sLine[0x152] = '\0';
  sLine[0x153] = '\0';
  sLine[0x128] = '\0';
  sLine[0x129] = '\0';
  sLine[0x12a] = '\0';
  sLine[299] = '\0';
  sLine[300] = '\0';
  sLine[0x12d] = '\0';
  sLine[0x12e] = '\0';
  sLine[0x12f] = '\0';
  sLine[0x14c] = '\0';
  sLine[0x14d] = '\0';
  sLine._72_8_ = sLine + 0xb0;
  sLine._80_8_ = sLine + 200;
  sLine._88_8_ = sLine + 0xe0;
  sLine._96_8_ = sLine + 0xf0;
  sLine._104_8_ = sLine + 0x108;
  sLine._112_8_ = sLine + 0x118;
  sLine._120_8_ = sLine + 0x130;
  sLine._128_8_ = sLine + 0x148;
  sLine._136_8_ = sLine + 0x14e;
  sLine._40_8_ = &sqlca;
  sLine._184_8_ = &T_Card_Number;
  sLine._192_8_ = &T_tlv_auth;
  sqlcxt((long)nIndiceCtx * 0x10 + 0x713948,&sqlctx,sLine,&sqlfpn);
  if (sqlca.sqlcode < 0) {
    tlvcpy(sTlvBuffer,(char *)puVar3,(uint)T_tlv_auth.len);
    sprintf(sLine,"%.50s",sqlca.sqlerrm.sqlerrmc);
    trace_event(sLine,1);
    trace_event("End CheckPhone (ERROR)",5);
    response_code = 1;
  }
  else {
    tlvcpy(sTlvBuffer,(char *)puVar3,(uint)T_tlv_auth.len);
    sprintf(sLine,"End CheckPhone (%d)",(ulong)(uint)response_code);
    trace_event(sLine,5);
  }
  return response_code;
}



// WARNING: Unknown calling convention

int get_pin_info(int nIndexCtx,char *pCardNumber,int *pPvki,int *pVisaOffset,char *pOffset,
                int *pPinLength)

{
  undefined8 uVar1;
  int iVar2;
  size_t sVar3;
  int hPvki;
  int hPVisaOffset;
  int hPinLength;
  int hResult;
  anon_struct_14_2_43c7b5cf hPinOffset;
  anon_struct_24_2_43c7b5cf hCardNumber;
  sqlexd_conflict7 sqlstm;
  char sLine [512];
  
  uVar1 = sLine._16_8_;
  if (debug_option == 1) {
    sprintf(sLine,"Start get_pin_info (%.22s)",pCardNumber);
  }
  else {
    builtin_strncpy(sLine,"Start get_pin_info ()",0x16);
    sLine._22_2_ = SUB82(uVar1,6);
  }
  trace_event(sLine,5);
  hPinOffset.len = 0;
  hCardNumber.arr[0x14] = '\0';
  hCardNumber.arr[0x15] = '\0';
  hCardNumber.len = 0;
  hPinOffset.arr[0] = '\0';
  hPinOffset.arr[1] = '\0';
  hPinOffset.arr[2] = '\0';
  hPinOffset.arr[3] = '\0';
  hPinOffset.arr[4] = '\0';
  hPinOffset.arr[5] = '\0';
  hPinOffset.arr[6] = '\0';
  hPinOffset.arr[7] = '\0';
  hCardNumber.arr[0] = '\0';
  hCardNumber.arr[1] = '\0';
  hCardNumber.arr[2] = '\0';
  hCardNumber.arr[3] = '\0';
  hCardNumber.arr[4] = '\0';
  hCardNumber.arr[5] = '\0';
  hCardNumber.arr[6] = '\0';
  hCardNumber.arr[7] = '\0';
  hCardNumber.arr[8] = '\0';
  hCardNumber.arr[9] = '\0';
  hCardNumber.arr[10] = '\0';
  hCardNumber.arr[0xb] = '\0';
  hCardNumber.arr[0xc] = '\0';
  hCardNumber.arr[0xd] = '\0';
  hCardNumber.arr[0xe] = '\0';
  hCardNumber.arr[0xf] = '\0';
  hCardNumber.arr[0x10] = '\0';
  hCardNumber.arr[0x11] = '\0';
  hCardNumber.arr[0x12] = '\0';
  hCardNumber.arr[0x13] = '\0';
  hPinOffset.arr[8] = '\0';
  hPinOffset.arr[9] = '\0';
  hPinOffset.arr[10] = '\0';
  hPinOffset.arr[0xb] = '\0';
  sVar3 = strlen(pCardNumber);
  memcpy(hCardNumber.arr,pCardNumber,sVar3);
  sVar3 = strlen((char *)hCardNumber.arr);
  hCardNumber.len = (ushort)sVar3;
  sqlstm.sqladtp = &sqladt;
  sqlstm.sqltdsp = &sqltds;
  sqlstm.sqlety = 0x1100;
  sqlstm.sqadto[0] = 0;
  sqlstm.sqtdso[0] = 0;
  sqlstm.stmt = 
  "begin :hResult := PCRD_P7_CTRL_SECURITY . GET_PIN_INFO ( :hCardNumber , :hPvki , :hPVisaOffset , :hPinOffset , :hPinLength ) ; END ;"
  ;
  sqlstm.sqadto[1] = 0;
  sqlstm.sqlvsn = 0xc;
  sqlstm.arrsiz = 6;
  sqlstm.cud = sqlcud0;
  sqlstm.sqhstv[0] = (uchar *)&hResult;
  sqlstm.iters = 1;
  sqlstm.offset = 5;
  sqlstm.sqlest = (uchar *)&sqlca;
  sqlstm.sqhstv[2] = (uchar *)&hPvki;
  sqlstm.occurs = 0;
  sqlstm.sqhstl[0] = 4;
  sqlstm.sqhsts[0] = 0;
  sqlstm.sqindv[0] = (short *)0x0;
  sqlstm.sqinds[0] = 0;
  sqlstm.sqharm[0] = 0;
  sqlstm.sqhstl[1] = 0x18;
  sqlstm.sqhsts[1] = 0;
  sqlstm.sqindv[1] = (short *)0x0;
  sqlstm.sqinds[1] = 0;
  sqlstm.sqharm[1] = 0;
  sqlstm.sqtdso[1] = 0;
  sqlstm.sqhstl[2] = 4;
  sqlstm.sqhsts[2] = 0;
  sqlstm.sqindv[2] = (short *)0x0;
  sqlstm.sqtdso[5] = 0;
  sqlstm.sqphsv = sqlstm.sqhstv;
  sqlstm.sqtdso[2] = 0;
  sqlstm.sqhstv[3] = (uchar *)&hPVisaOffset;
  sqlstm.sqphsl = sqlstm.sqhstl;
  sqlstm.sqinds[2] = 0;
  sqlstm.sqharm[2] = 0;
  sqlstm.sqphss = sqlstm.sqhsts;
  sqlstm.sqadto[3] = 0;
  sqlstm.sqadto[2] = 0;
  sqlstm.sqhstl[3] = 4;
  sqlstm.sqpind = sqlstm.sqindv;
  sqlstm.sqtdso[3] = 0;
  sqlstm.sqhsts[3] = 0;
  sqlstm.sqindv[3] = (short *)0x0;
  sqlstm.sqadto[4] = 0;
  sqlstm.sqpins = sqlstm.sqinds;
  sqlstm.sqtdso[4] = 0;
  sqlstm.sqhstv[5] = (uchar *)&hPinLength;
  sqlstm.sqinds[3] = 0;
  sqlstm.sqharm[3] = 0;
  sqlstm.sqparm = sqlstm.sqharm;
  sqlstm.sqhstl[4] = 0xe;
  sqlstm.sqhsts[4] = 0;
  sqlstm.sqadto[5] = 0;
  sqlstm.sqindv[4] = (short *)0x0;
  sqlstm.sqinds[4] = 0;
  sqlstm.sqharm[4] = 0;
  sqlstm.sqhstl[5] = 4;
  sqlstm.sqhsts[5] = 0;
  sqlstm.sqindv[5] = (short *)0x0;
  sqlstm.sqinds[5] = 0;
  sqlstm.sqharm[5] = 0;
  sqlstm.sqparc = sqlstm.sqharc;
  sqlstm.sqpadto = sqlstm.sqadto;
  sqlstm.sqptdso = sqlstm.sqtdso;
  sqlstm.sqhstv[1] = (uchar *)&hCardNumber;
  sqlstm.sqhstv[4] = (uchar *)&hPinOffset;
  sqlcxt((long)nIndexCtx * 0x10 + 0x713948,&sqlctx,&sqlstm,&sqlfpn);
  if (sqlca.sqlcode < 0) {
    sprintf(sLine,"%.79s",0x715952);
    trace_event(sLine,1);
    trace_event("End   get_pin_info(ERROR)",1);
    iVar2 = 1;
  }
  else if (hResult == 0) {
    *pPvki = hPvki;
    *pVisaOffset = hPVisaOffset;
    memcpy(pOffset,hPinOffset.arr,(ulong)hPinOffset.len);
    sLine._22_2_ = SUB82(sLine._16_8_,6) & 0xff00;
    *pPinLength = hPinLength;
    builtin_strncpy(sLine,"End   get_pin_info(OK)",0x16);
    trace_event(sLine,5);
    iVar2 = 0;
  }
  else {
    builtin_strncpy(sLine,"End   get_pin_info(NOK)",0x18);
    trace_event(sLine,5);
    iVar2 = -1;
  }
  return iVar2;
}



// WARNING: Unknown calling convention

int PutPinOffset(int nIndexCtx,char *pCardNumber,char *pNewPinOffset)

{
  size_t sVar1;
  int hRet;
  anon_struct_18_2_43c7b5cf hNewPinOffset;
  anon_struct_18_2_43c7b5cf hNewPvv;
  anon_struct_24_2_43c7b5cf hCardNumber;
  sqlexd_conflict1 sqlstm;
  char sLine [512];
  
  if (debug_option == 1) {
    sprintf(sLine,"Start PutPinOffset(%.22s,%.08s)",pCardNumber);
  }
  else {
    builtin_strncpy(sLine + 0x10,"et()",5);
    builtin_strncpy(sLine,"Start PutPinOffs",0x10);
  }
  trace_event(sLine,5);
  hNewPinOffset.len = 0;
  hCardNumber.len = 0;
  hCardNumber.arr[0] = '\0';
  hCardNumber.arr[1] = '\0';
  hCardNumber.arr[2] = '\0';
  hCardNumber.arr[3] = '\0';
  hCardNumber.arr[4] = '\0';
  hCardNumber.arr[5] = '\0';
  hCardNumber.arr[6] = '\0';
  hCardNumber.arr[7] = '\0';
  hCardNumber.arr[8] = '\0';
  hCardNumber.arr[9] = '\0';
  hCardNumber.arr[10] = '\0';
  hCardNumber.arr[0xb] = '\0';
  hCardNumber.arr[0xc] = '\0';
  hCardNumber.arr[0xd] = '\0';
  hCardNumber.arr[0xe] = '\0';
  hCardNumber.arr[0xf] = '\0';
  hCardNumber.arr[0x10] = '\0';
  hCardNumber.arr[0x11] = '\0';
  hCardNumber.arr[0x12] = '\0';
  hCardNumber.arr[0x13] = '\0';
  hCardNumber.arr[0x14] = '\0';
  hCardNumber.arr[0x15] = '\0';
  hNewPinOffset.arr[0] = '\0';
  hNewPinOffset.arr[1] = '\0';
  hNewPinOffset.arr[2] = '\0';
  hNewPinOffset.arr[3] = '\0';
  hNewPinOffset.arr[4] = '\0';
  hNewPinOffset.arr[5] = '\0';
  hNewPinOffset.arr[6] = '\0';
  hNewPinOffset.arr[7] = '\0';
  hNewPinOffset.arr[8] = '\0';
  hNewPinOffset.arr[9] = '\0';
  hNewPinOffset.arr[10] = '\0';
  hNewPinOffset.arr[0xb] = '\0';
  hNewPinOffset.arr[0xc] = '\0';
  hNewPinOffset.arr[0xd] = '\0';
  hNewPinOffset.arr[0xe] = '\0';
  hNewPinOffset.arr[0xf] = '\0';
  sVar1 = strlen(pCardNumber);
  memcpy(hCardNumber.arr,pCardNumber,sVar1);
  sVar1 = strlen((char *)hCardNumber.arr);
  hCardNumber.len = (ushort)sVar1;
  hNewPinOffset.arr._0_8_ = *(undefined8 *)pNewPinOffset;
  sVar1 = strlen((char *)hNewPinOffset.arr);
  sqlstm.sqhstv[0] = (uchar *)&hRet;
  hNewPinOffset.len = (ushort)sVar1;
  sqlstm.sqhstv[3] = (uchar *)&hNewPvv;
  sqlstm.sqladtp = &sqladt;
  hNewPvv.len = 4;
  sqlstm.sqltdsp = &sqltds;
  sqlstm.stmt = 
  "begin :hRet := PCRD_P7_CTRL_SECURITY . PUT_PIN_OFFSET ( :hCardNumber , :hNewPinOffset , :hNewPvv ) ; END ;"
  ;
  sqlstm.cud = sqlcud0;
  sqlstm.sqlety = 0x1100;
  sqlstm.sqadto[0] = 0;
  sqlstm.sqtdso[0] = 0;
  builtin_memcpy(hNewPvv.arr,"0000",4);
  sqlstm.sqlvsn = 0xc;
  sqlstm.arrsiz = 4;
  sqlstm.iters = 1;
  sqlstm.offset = 5;
  sqlstm.sqlest = (uchar *)&sqlca;
  sqlstm.occurs = 0;
  sqlstm.sqhstl[0] = 4;
  sqlstm.sqhsts[0] = 0;
  sqlstm.sqindv[0] = (short *)0x0;
  sqlstm.sqinds[0] = 0;
  sqlstm.sqharm[0] = 0;
  sqlstm.sqhstl[1] = 0x18;
  sqlstm.sqhsts[1] = 0;
  sqlstm.sqindv[1] = (short *)0x0;
  sqlstm.sqinds[1] = 0;
  sqlstm.sqharm[1] = 0;
  sqlstm.sqadto[1] = 0;
  sqlstm.sqphsv = sqlstm.sqhstv;
  sqlstm.sqtdso[1] = 0;
  sqlstm.sqhstl[2] = 0x12;
  sqlstm.sqphsl = sqlstm.sqhstl;
  sqlstm.sqhsts[2] = 0;
  sqlstm.sqindv[2] = (short *)0x0;
  sqlstm.sqinds[2] = 0;
  sqlstm.sqphss = sqlstm.sqhsts;
  sqlstm.sqharm[2] = 0;
  sqlstm.sqadto[2] = 0;
  sqlstm.sqtdso[2] = 0;
  sqlstm.sqpind = sqlstm.sqindv;
  sqlstm.sqhstl[3] = 0x12;
  sqlstm.sqhsts[3] = 0;
  sqlstm.sqindv[3] = (short *)0x0;
  sqlstm.sqpins = sqlstm.sqinds;
  sqlstm.sqinds[3] = 0;
  sqlstm.sqharm[3] = 0;
  sqlstm.sqadto[3] = 0;
  sqlstm.sqparm = sqlstm.sqharm;
  sqlstm.sqtdso[3] = 0;
  sqlstm.sqparc = sqlstm.sqharc;
  sqlstm.sqpadto = sqlstm.sqadto;
  sqlstm.sqptdso = sqlstm.sqtdso;
  sqlstm.sqhstv[1] = (uchar *)&hCardNumber;
  sqlstm.sqhstv[2] = (uchar *)&hNewPinOffset;
  sqlcxt((long)nIndexCtx * 0x10 + 0x713948,&sqlctx,&sqlstm,&sqlfpn);
  if (sqlca.sqlcode < 0) {
    sprintf(sLine,"%.79s",0x715952);
    trace_event(sLine,1);
    trace_event("End   PutPinOffset(ERROR)",1);
    hRet = 1;
  }
  else {
    sprintf(sLine,"End   PutPinOffset(%d)",(ulong)(uint)hRet);
    trace_event(sLine,5);
  }
  return hRet;
}



// WARNING: Unknown calling convention

int PutPvv(int nIndexCtx,char *pCardNumber,char *pOldPvv,char *pNewPvv,char *pPvki)

{
  uint uVar1;
  uint uVar2;
  size_t sVar3;
  uint *puVar4;
  uint *puVar5;
  char *pcVar6;
  bool bVar7;
  anon_struct_4_2_43c7b5cf hPvki;
  int hRet;
  char sPvv [5];
  anon_struct_18_2_43c7b5cf hNewPvv;
  anon_struct_18_2_43c7b5cf hNewPinOffset;
  anon_struct_24_2_43c7b5cf hCardNumber;
  sqlexd_conflict1 sqlstm;
  char sLine [512];
  
  if (debug_option == 1) {
    sprintf(sLine,"Start PutPvv(%.22s,%.08s,%.08s,%s)",pCardNumber);
  }
  else {
    builtin_strncpy(sLine,"Start PutPvv()",0xf);
  }
  trace_event(sLine,5);
  hCardNumber.arr[0] = '\0';
  hCardNumber.arr[1] = '\0';
  hCardNumber.arr[2] = '\0';
  hCardNumber.arr[3] = '\0';
  hCardNumber.arr[4] = '\0';
  hCardNumber.arr[5] = '\0';
  hCardNumber.arr[6] = '\0';
  hCardNumber.arr[7] = '\0';
  hNewPvv.len = 0;
  hCardNumber.arr[0x14] = '\0';
  hCardNumber.arr[0x15] = '\0';
  hCardNumber.len = 0;
  hNewPvv.arr[0] = '\0';
  hNewPvv.arr[1] = '\0';
  hNewPvv.arr[2] = '\0';
  hNewPvv.arr[3] = '\0';
  hNewPvv.arr[4] = '\0';
  hNewPvv.arr[5] = '\0';
  hNewPvv.arr[6] = '\0';
  hNewPvv.arr[7] = '\0';
  hCardNumber.arr[8] = '\0';
  hCardNumber.arr[9] = '\0';
  hCardNumber.arr[10] = '\0';
  hCardNumber.arr[0xb] = '\0';
  hCardNumber.arr[0xc] = '\0';
  hCardNumber.arr[0xd] = '\0';
  hCardNumber.arr[0xe] = '\0';
  hCardNumber.arr[0xf] = '\0';
  hNewPvv.arr[8] = '\0';
  hNewPvv.arr[9] = '\0';
  hNewPvv.arr[10] = '\0';
  hNewPvv.arr[0xb] = '\0';
  hNewPvv.arr[0xc] = '\0';
  hNewPvv.arr[0xd] = '\0';
  hNewPvv.arr[0xe] = '\0';
  hNewPvv.arr[0xf] = '\0';
  hNewPinOffset.len = 0;
  hCardNumber.arr[0x10] = '\0';
  hCardNumber.arr[0x11] = '\0';
  hCardNumber.arr[0x12] = '\0';
  hCardNumber.arr[0x13] = '\0';
  hPvki.len = 0;
  hNewPinOffset.arr[0] = '\0';
  hNewPinOffset.arr[1] = '\0';
  hNewPinOffset.arr[2] = '\0';
  hNewPinOffset.arr[3] = '\0';
  hNewPinOffset.arr[4] = '\0';
  hNewPinOffset.arr[5] = '\0';
  hNewPinOffset.arr[6] = '\0';
  hNewPinOffset.arr[7] = '\0';
  hNewPinOffset.arr[8] = '\0';
  hNewPinOffset.arr[9] = '\0';
  hNewPinOffset.arr[10] = '\0';
  hNewPinOffset.arr[0xb] = '\0';
  hNewPinOffset.arr[0xc] = '\0';
  hNewPinOffset.arr[0xd] = '\0';
  hNewPinOffset.arr[0xe] = '\0';
  hNewPinOffset.arr[0xf] = '\0';
  hPvki.arr[0] = '\0';
  hPvki.arr[1] = '\0';
  sPvv[0] = '\0';
  sPvv[1] = '\0';
  sPvv[2] = '\0';
  sPvv[3] = '\0';
  sPvv[4] = '\0';
  sVar3 = strlen(pCardNumber);
  memcpy(hCardNumber.arr,pCardNumber,sVar3);
  sVar3 = strlen((char *)hCardNumber.arr);
  hCardNumber.len = (ushort)sVar3;
  uVar1 = atoi(pNewPvv);
  sprintf(sPvv,"%04d",(ulong)uVar1);
  puVar5 = (uint *)sPvv;
  do {
    puVar4 = puVar5;
    uVar2 = *puVar4 + 0xfefefeff & ~*puVar4;
    uVar1 = uVar2 & 0x80808080;
    puVar5 = puVar4 + 1;
  } while (uVar1 == 0);
  bVar7 = (uVar2 & 0x8080) == 0;
  if (bVar7) {
    uVar1 = uVar1 >> 0x10;
  }
  if (bVar7) {
    puVar5 = (uint *)((long)puVar4 + 6);
  }
  pcVar6 = (char *)((long)puVar5 + ((-3 - (ulong)CARRY1((byte)uVar1,(byte)uVar1)) - (long)sPvv));
  memcpy(hNewPvv.arr,sPvv,(size_t)pcVar6);
  hNewPvv.len = (ushort)pcVar6;
  builtin_memcpy(hNewPinOffset.arr,"0000",4);
  hNewPinOffset.len = 4;
  sVar3 = strlen(pPvki);
  pcVar6 = (char *)memcpy(hPvki.arr,pPvki,sVar3);
  sVar3 = strlen(pcVar6);
  hPvki.len = (ushort)sVar3;
  sqlstm.sqladtp = &sqladt;
  sqlstm.sqadto[0] = 0;
  sqlstm.sqtdso[0] = 0;
  sqlstm.sqltdsp = &sqltds;
  sqlstm.sqlety = 0x1100;
  sqlstm.sqadto[1] = 0;
  sqlstm.stmt = 
  "begin :hRet := PCRD_P7_CTRL_SECURITY . UPDATE_PIN_INFO ( :hCardNumber , :hNewPvv , :hNewPinOffset , :hPvki ) ; END ;"
  ;
  sqlstm.sqtdso[1] = 0;
  hRet = 0x38d;
  sqlstm.cud = sqlcud0;
  sqlstm.sqhstv[0] = (uchar *)&hRet;
  sqlstm.sqlvsn = 0xc;
  sqlstm.arrsiz = 5;
  sqlstm.iters = 1;
  sqlstm.offset = 0x24;
  sqlstm.sqlest = (uchar *)&sqlca;
  sqlstm.occurs = 0;
  sqlstm.sqhstl[0] = 4;
  sqlstm.sqhsts[0] = 0;
  sqlstm.sqindv[0] = (short *)0x0;
  sqlstm.sqinds[0] = 0;
  sqlstm.sqharm[0] = 0;
  sqlstm.sqhstl[1] = 0x18;
  sqlstm.sqhsts[1] = 0;
  sqlstm.sqindv[1] = (short *)0x0;
  sqlstm.sqinds[1] = 0;
  sqlstm.sqharm[1] = 0;
  sqlstm.sqhstl[2] = 0x12;
  sqlstm.sqhsts[2] = 0;
  sqlstm.sqindv[2] = (short *)0x0;
  sqlstm.sqinds[2] = 0;
  sqlstm.sqharm[2] = 0;
  sqlstm.sqadto[2] = 0;
  sqlstm.sqphsv = sqlstm.sqhstv;
  sqlstm.sqtdso[2] = 0;
  sqlstm.sqhstl[3] = 0x12;
  sqlstm.sqphsl = sqlstm.sqhstl;
  sqlstm.sqhsts[3] = 0;
  sqlstm.sqindv[3] = (short *)0x0;
  sqlstm.sqinds[3] = 0;
  sqlstm.sqphss = sqlstm.sqhsts;
  sqlstm.sqharm[3] = 0;
  sqlstm.sqadto[3] = 0;
  sqlstm.sqtdso[3] = 0;
  sqlstm.sqpind = sqlstm.sqindv;
  sqlstm.sqhstl[4] = 4;
  sqlstm.sqhsts[4] = 0;
  sqlstm.sqpins = sqlstm.sqinds;
  sqlstm.sqindv[4] = (short *)0x0;
  sqlstm.sqinds[4] = 0;
  sqlstm.sqharm[4] = 0;
  sqlstm.sqparm = sqlstm.sqharm;
  sqlstm.sqadto[4] = 0;
  sqlstm.sqtdso[4] = 0;
  sqlstm.sqparc = sqlstm.sqharc;
  sqlstm.sqpadto = sqlstm.sqadto;
  sqlstm.sqptdso = sqlstm.sqtdso;
  sqlstm.sqhstv[1] = (uchar *)&hCardNumber;
  sqlstm.sqhstv[2] = (uchar *)&hNewPvv;
  sqlstm.sqhstv[3] = (uchar *)&hNewPinOffset;
  sqlstm.sqhstv[4] = (uchar *)&hPvki;
  sqlcxt((long)nIndexCtx * 0x10 + 0x713948,&sqlctx,&sqlstm,&sqlfpn);
  if (sqlca.sqlcode < 0) {
    sprintf(sLine,"%.79s",0x715952);
    trace_event(sLine,1);
    trace_event("End   PutPvv(ERROR)",1);
    hRet = 1;
  }
  else {
    sprintf(sLine,"End   PutPvv(%d)",(ulong)(uint)hRet);
    trace_event(sLine,5);
  }
  return hRet;
}



// WARNING: Unknown calling convention

int GetPvvOffsetData(int nIndexCtx,TSTlvAutho *sTlvInfo,char *pOffset,char *pPvv)

{
  int iVar1;
  int lRet;
  anon_struct_8_2_43c7b5cf hOffset;
  anon_struct_8_2_43c7b5cf hPvv;
  anon_struct_24_2_43c7b5cf hCardNumber;
  char sLine [512];
  
  trace_event("Start GetPvvOffsetData()",5);
  hOffset.len = 0;
  hPvv.len = 0;
  hCardNumber.arr[0] = '\0';
  hCardNumber.arr[1] = '\0';
  hCardNumber.arr[2] = '\0';
  hCardNumber.arr[3] = '\0';
  hCardNumber.arr[4] = '\0';
  hCardNumber.arr[5] = '\0';
  hCardNumber.arr[6] = '\0';
  hCardNumber.arr[7] = '\0';
  hOffset.arr[0] = '\0';
  hOffset.arr[1] = '\0';
  hOffset.arr[2] = '\0';
  hOffset.arr[3] = '\0';
  hPvv.arr[0] = '\0';
  hPvv.arr[1] = '\0';
  hPvv.arr[2] = '\0';
  hPvv.arr[3] = '\0';
  hCardNumber.arr[0x14] = '\0';
  hCardNumber.arr[0x15] = '\0';
  hOffset.arr[4] = '\0';
  hPvv.arr[4] = '\0';
  hCardNumber.arr[8] = '\0';
  hCardNumber.arr[9] = '\0';
  hCardNumber.arr[10] = '\0';
  hCardNumber.arr[0xb] = '\0';
  hCardNumber.arr[0xc] = '\0';
  hCardNumber.arr[0xd] = '\0';
  hCardNumber.arr[0xe] = '\0';
  hCardNumber.arr[0xf] = '\0';
  hCardNumber.arr[0x10] = '\0';
  hCardNumber.arr[0x11] = '\0';
  hCardNumber.arr[0x12] = '\0';
  hCardNumber.arr[0x13] = '\0';
  hCardNumber.len = 0;
  iVar1 = GetTlvAutho("002",sTlvInfo,(char *)hCardNumber.arr,(int *)&hCardNumber);
  if (iVar1 == 0) {
    sLine._56_8_ = &sqladt;
    sLine[0x16] = '\0';
    sLine[0x17] = '\x11';
    sLine[0x1a8] = '\0';
    sLine[0x1a9] = '\0';
    sLine[0x1b2] = '\0';
    sLine[0x1b3] = '\0';
    sLine._64_8_ = &sqltds;
    sLine[0x1aa] = '\0';
    sLine[0x1ab] = '\0';
    sLine[0x1b4] = '\0';
    sLine[0x1b5] = '\0';
    sLine._48_8_ = s_begin__lRet____PCRD_P7_CTRL_SECU_004caac8;
    sLine[0] = '\f';
    sLine[1] = '\0';
    sLine[2] = '\0';
    sLine[3] = '\0';
    sLine[4] = '\0';
    sLine[5] = '\0';
    sLine[6] = '\0';
    sLine[7] = '\0';
    sLine._32_8_ = sqlcud0;
    sLine[8] = '\x05';
    sLine[9] = '\0';
    sLine[10] = '\0';
    sLine[0xb] = '\0';
    sLine[0xc] = '\x01';
    sLine[0xd] = '\0';
    sLine[0xe] = '\0';
    sLine[0xf] = '\0';
    sLine[0x10] = 'G';
    sLine[0x11] = '\0';
    sLine[0x12] = '\0';
    sLine[0x13] = '\0';
    sLine[0x18] = '\0';
    sLine[0x19] = '\0';
    sLine[0x1a] = '\0';
    sLine[0x1b] = '\0';
    sLine[0xd8] = '\x04';
    sLine[0xd9] = '\0';
    sLine[0xda] = '\0';
    sLine[0xdb] = '\0';
    sLine[0xdc] = '\0';
    sLine[0xdd] = '\0';
    sLine[0xde] = '\0';
    sLine[0xdf] = '\0';
    sLine._40_8_ = &sqlca;
    sLine._176_8_ = &lRet;
    sLine[0x100] = '\0';
    sLine[0x101] = '\0';
    sLine[0x102] = '\0';
    sLine[0x103] = '\0';
    sLine[0x118] = '\0';
    sLine[0x119] = '\0';
    sLine[0x11a] = '\0';
    sLine[0x11b] = '\0';
    sLine[0x11c] = '\0';
    sLine[0x11d] = '\0';
    sLine[0x11e] = '\0';
    sLine[0x11f] = '\0';
    sLine[0x140] = '\0';
    sLine[0x141] = '\0';
    sLine[0x142] = '\0';
    sLine[0x143] = '\0';
    sLine[0x158] = '\0';
    sLine[0x159] = '\0';
    sLine[0x15a] = '\0';
    sLine[0x15b] = '\0';
    sLine[0x15c] = '\0';
    sLine[0x15d] = '\0';
    sLine[0x15e] = '\0';
    sLine[0x15f] = '\0';
    sLine[0xe0] = '\x18';
    sLine[0xe1] = '\0';
    sLine[0xe2] = '\0';
    sLine[0xe3] = '\0';
    sLine[0xe4] = '\0';
    sLine[0xe5] = '\0';
    sLine[0xe6] = '\0';
    sLine[0xe7] = '\0';
    sLine[0x104] = '\0';
    sLine[0x105] = '\0';
    sLine[0x106] = '\0';
    sLine[0x107] = '\0';
    sLine[0x120] = '\0';
    sLine[0x121] = '\0';
    sLine[0x122] = '\0';
    sLine[0x123] = '\0';
    sLine[0x124] = '\0';
    sLine[0x125] = '\0';
    sLine[0x126] = '\0';
    sLine[0x127] = '\0';
    sLine[0x144] = '\0';
    sLine[0x145] = '\0';
    sLine[0x146] = '\0';
    sLine[0x147] = '\0';
    sLine[0x160] = '\0';
    sLine[0x161] = '\0';
    sLine[0x162] = '\0';
    sLine[0x163] = '\0';
    sLine[0x164] = '\0';
    sLine[0x165] = '\0';
    sLine[0x166] = '\0';
    sLine[0x167] = '\0';
    sLine[0xe8] = '\a';
    sLine[0xe9] = '\0';
    sLine[0xea] = '\0';
    sLine[0xeb] = '\0';
    sLine[0xec] = '\0';
    sLine[0xed] = '\0';
    sLine[0xee] = '\0';
    sLine[0xef] = '\0';
    sLine[0x108] = '\0';
    sLine[0x109] = '\0';
    sLine[0x10a] = '\0';
    sLine[0x10b] = '\0';
    sLine[0x128] = '\0';
    sLine[0x129] = '\0';
    sLine[0x12a] = '\0';
    sLine[299] = '\0';
    sLine[300] = '\0';
    sLine[0x12d] = '\0';
    sLine[0x12e] = '\0';
    sLine[0x12f] = '\0';
    sLine[0x148] = '\0';
    sLine[0x149] = '\0';
    sLine[0x14a] = '\0';
    sLine[0x14b] = '\0';
    sLine[0x168] = '\0';
    sLine[0x169] = '\0';
    sLine[0x16a] = '\0';
    sLine[0x16b] = '\0';
    sLine[0x16c] = '\0';
    sLine[0x16d] = '\0';
    sLine[0x16e] = '\0';
    sLine[0x16f] = '\0';
    sLine[0x1b8] = '\0';
    sLine[0x1b9] = '\0';
    sLine[0x1ac] = '\0';
    sLine[0x1ad] = '\0';
    sLine._72_8_ = sLine + 0xb0;
    sLine[0x1b6] = '\0';
    sLine[0x1b7] = '\0';
    sLine[0xf0] = '\a';
    sLine[0xf1] = '\0';
    sLine[0xf2] = '\0';
    sLine[0xf3] = '\0';
    sLine[0xf4] = '\0';
    sLine[0xf5] = '\0';
    sLine[0xf6] = '\0';
    sLine[0xf7] = '\0';
    sLine[0x10c] = '\0';
    sLine[0x10d] = '\0';
    sLine[0x10e] = '\0';
    sLine[0x10f] = '\0';
    sLine._80_8_ = sLine + 0xd8;
    sLine[0x130] = '\0';
    sLine[0x131] = '\0';
    sLine[0x132] = '\0';
    sLine[0x133] = '\0';
    sLine[0x134] = '\0';
    sLine[0x135] = '\0';
    sLine[0x136] = '\0';
    sLine[0x137] = '\0';
    sLine[0x14c] = '\0';
    sLine[0x14d] = '\0';
    sLine[0x14e] = '\0';
    sLine[0x14f] = '\0';
    sLine._88_8_ = sLine + 0x100;
    sLine[0x170] = '\0';
    sLine[0x171] = '\0';
    sLine[0x172] = '\0';
    sLine[0x173] = '\0';
    sLine[0x174] = '\0';
    sLine[0x175] = '\0';
    sLine[0x176] = '\0';
    sLine[0x177] = '\0';
    sLine[0x1ae] = '\0';
    sLine[0x1af] = '\0';
    sLine._96_8_ = sLine + 0x118;
    sLine._104_8_ = sLine + 0x140;
    sLine._112_8_ = sLine + 0x158;
    sLine._120_8_ = sLine + 0x180;
    sLine._128_8_ = sLine + 0x1a8;
    sLine._136_8_ = sLine + 0x1b2;
    sLine._184_8_ = &hCardNumber;
    sLine._192_8_ = &hOffset;
    sLine._200_8_ = &hPvv;
    sqlcxt((long)nIndexCtx * 0x10 + 0x713948,&sqlctx,sLine,&sqlfpn);
    if (sqlca.sqlcode < 0) {
      iVar1 = 1;
      sprintf(sLine,"%.60s",0x715952);
      trace_event(sLine,1);
      trace_event("End   GetPvvOffsetData(ERROR)",1);
    }
    else if (lRet == 0) {
      memcpy(pOffset,hOffset.arr,(ulong)hOffset.len);
      memcpy(pPvv,hPvv.arr,(ulong)hPvv.len);
      if (debug_option == 1) {
        sprintf(sLine,"End GetPvvOffsetData( OK Offset : %s Pvv : %s )",pOffset,pPvv);
      }
      else {
        sLine._26_2_ = SUB42(sLine._24_4_,2) & 0xff00;
        builtin_strncpy(sLine,"End GetPvvOffsetData( OK )",0x1a);
      }
      trace_event(sLine,5);
      iVar1 = 0;
    }
    else {
      sprintf(sLine,"End GetPvvOffsetData( Retour : %d )");
      trace_event(sLine,5);
      iVar1 = lRet;
    }
  }
  else {
    iVar1 = -1;
    trace_event("Extracte Card Number From Tlv Failed ",5);
    trace_event("End GetPvvOffsetData(NOK)",5);
  }
  return iVar1;
}



// WARNING: Unknown calling convention

int UpdatePinChangeInfo(int pnIndexCtx,char *psCardNumber,char *psPVKi,char *psPVV,char *psPINOffset
                       )

{
  size_t sVar1;
  char sPvki [2];
  int lnPVKI;
  int lnRet;
  anon_struct_18_2_43c7b5cf lsPVV;
  anon_struct_18_2_43c7b5cf lsPinOffset;
  anon_struct_24_2_43c7b5cf lsCardNumber;
  sqlexd_conflict1 sqlstm;
  char sLine [512];
  
  sprintf(sLine,"START UpdatePinChangeInfo(%s,%s,%s,%s)",psCardNumber,psPVKi,psPVV,psPINOffset);
  trace_event(sLine,5);
  lsCardNumber.len = 0;
  lsPVV.len = 0;
  lsPinOffset.len = 0;
  lsCardNumber.arr[0] = '\0';
  lsCardNumber.arr[1] = '\0';
  lsCardNumber.arr[2] = '\0';
  lsCardNumber.arr[3] = '\0';
  lsCardNumber.arr[4] = '\0';
  lsCardNumber.arr[5] = '\0';
  lsCardNumber.arr[6] = '\0';
  lsCardNumber.arr[7] = '\0';
  lsCardNumber.arr[8] = '\0';
  lsCardNumber.arr[9] = '\0';
  lsCardNumber.arr[10] = '\0';
  lsCardNumber.arr[0xb] = '\0';
  lsCardNumber.arr[0xc] = '\0';
  lsCardNumber.arr[0xd] = '\0';
  lsCardNumber.arr[0xe] = '\0';
  lsCardNumber.arr[0xf] = '\0';
  lsCardNumber.arr[0x10] = '\0';
  lsCardNumber.arr[0x11] = '\0';
  lsCardNumber.arr[0x12] = '\0';
  lsCardNumber.arr[0x13] = '\0';
  lsCardNumber.arr[0x14] = '\0';
  lsCardNumber.arr[0x15] = '\0';
  lsPVV.arr[0] = '\0';
  lsPVV.arr[1] = '\0';
  lsPVV.arr[2] = '\0';
  lsPVV.arr[3] = '\0';
  lsPVV.arr[4] = '\0';
  lsPVV.arr[5] = '\0';
  lsPVV.arr[6] = '\0';
  lsPVV.arr[7] = '\0';
  lsPVV.arr[8] = '\0';
  lsPVV.arr[9] = '\0';
  lsPVV.arr[10] = '\0';
  lsPVV.arr[0xb] = '\0';
  lsPVV.arr[0xc] = '\0';
  lsPVV.arr[0xd] = '\0';
  lsPVV.arr[0xe] = '\0';
  lsPVV.arr[0xf] = '\0';
  lsPinOffset.arr[0] = '\0';
  lsPinOffset.arr[1] = '\0';
  lsPinOffset.arr[2] = '\0';
  lsPinOffset.arr[3] = '\0';
  lsPinOffset.arr[4] = '\0';
  lsPinOffset.arr[5] = '\0';
  lsPinOffset.arr[6] = '\0';
  lsPinOffset.arr[7] = '\0';
  lsPinOffset.arr[8] = '\0';
  lsPinOffset.arr[9] = '\0';
  lsPinOffset.arr[10] = '\0';
  lsPinOffset.arr[0xb] = '\0';
  lsPinOffset.arr[0xc] = '\0';
  lsPinOffset.arr[0xd] = '\0';
  lsPinOffset.arr[0xe] = '\0';
  lsPinOffset.arr[0xf] = '\0';
  sVar1 = strlen(psCardNumber);
  memcpy(lsCardNumber.arr,psCardNumber,sVar1);
  lsCardNumber.len = (ushort)sVar1;
  sVar1 = strlen(psPVV);
  memcpy(lsPVV.arr,psPVV,sVar1);
  lsPVV.len = (ushort)sVar1;
  sVar1 = strlen(psPINOffset);
  memcpy(lsPinOffset.arr,psPINOffset,sVar1);
  lsPinOffset.len = (ushort)sVar1;
  lnPVKI = atoi(psPVKi);
  sprintf(sLine,"=> lsCardNumber .len=[%d] .arr=[%s]",(ulong)lsCardNumber.len,lsCardNumber.arr);
  trace_event(sLine,5);
  sprintf(sLine,"=> lsPVV        .len=[%d] .arr=[%s]",(ulong)lsPVV.len,lsPVV.arr);
  trace_event(sLine,5);
  sprintf(sLine,"=> lsPinOffset  .len=[%d] .arr=[%s]",(ulong)lsPinOffset.len,lsPinOffset.arr);
  trace_event(sLine,5);
  sprintf(sLine,"=> lnPVKI           =[%d]",(ulong)(uint)lnPVKI);
  trace_event(sLine,5);
  sqlstm.sqadto[0] = 0;
  sqlstm.sqladtp = &sqladt;
  sqlstm.sqtdso[0] = 0;
  sqlstm.sqltdsp = &sqltds;
  sqlstm.sqlety = 0x1100;
  sqlstm.sqadto[1] = 0;
  sqlstm.stmt = 
  "begin :lnRet := PCRD_P7_CTRL_SECURITY . UPDATE_PIN_INFO ( :lsCardNumber , :lsPVV , :lsPinOffset , :lnPVKI ) ; END ;"
  ;
  sqlstm.sqlvsn = 0xc;
  sqlstm.cud = sqlcud0;
  sqlstm.sqhstv[0] = (uchar *)&lnRet;
  sqlstm.arrsiz = 5;
  sqlstm.iters = 1;
  sqlstm.offset = 0x66;
  sqlstm.sqlest = (uchar *)&sqlca;
  sqlstm.occurs = 0;
  sqlstm.sqhstl[0] = 4;
  sqlstm.sqhsts[0] = 0;
  sqlstm.sqindv[0] = (short *)0x0;
  sqlstm.sqinds[0] = 0;
  sqlstm.sqharm[0] = 0;
  sqlstm.sqhstl[1] = 0x18;
  sqlstm.sqhsts[1] = 0;
  sqlstm.sqindv[1] = (short *)0x0;
  sqlstm.sqinds[1] = 0;
  sqlstm.sqharm[1] = 0;
  sqlstm.sqtdso[1] = 0;
  sqlstm.sqhstl[2] = 0x12;
  sqlstm.sqhsts[2] = 0;
  sqlstm.sqindv[2] = (short *)0x0;
  sqlstm.sqtdso[3] = 0;
  sqlstm.sqhstv[4] = (uchar *)&lnPVKI;
  sqlstm.sqinds[2] = 0;
  sqlstm.sqadto[4] = 0;
  sqlstm.sqharm[2] = 0;
  sqlstm.sqtdso[4] = 0;
  sqlstm.sqphsv = sqlstm.sqhstv;
  sqlstm.sqadto[2] = 0;
  sqlstm.sqtdso[2] = 0;
  sqlstm.sqphsl = sqlstm.sqhstl;
  sqlstm.sqhstl[3] = 0x12;
  sqlstm.sqhsts[3] = 0;
  sqlstm.sqphss = sqlstm.sqhsts;
  sqlstm.sqindv[3] = (short *)0x0;
  sqlstm.sqinds[3] = 0;
  sqlstm.sqharm[3] = 0;
  sqlstm.sqpind = sqlstm.sqindv;
  sqlstm.sqadto[3] = 0;
  sqlstm.sqhstl[4] = 4;
  sqlstm.sqhsts[4] = 0;
  sqlstm.sqpins = sqlstm.sqinds;
  sqlstm.sqindv[4] = (short *)0x0;
  sqlstm.sqinds[4] = 0;
  sqlstm.sqharm[4] = 0;
  sqlstm.sqparm = sqlstm.sqharm;
  sqlstm.sqparc = sqlstm.sqharc;
  sqlstm.sqpadto = sqlstm.sqadto;
  sqlstm.sqptdso = sqlstm.sqtdso;
  sqlstm.sqhstv[1] = (uchar *)&lsCardNumber;
  sqlstm.sqhstv[2] = (uchar *)&lsPVV;
  sqlstm.sqhstv[3] = (uchar *)&lsPinOffset;
  sqlcxt((long)pnIndexCtx * 0x10 + 0x713948,&sqlctx,&sqlstm,&sqlfpn);
  if (sqlca.sqlcode < 0) {
    sprintf(sLine,"%.79s",0x715952);
    trace_event(sLine,0);
    trace_event("END   UpdatePinChangeInfo(ERROR)",0);
    lnRet = 1;
  }
  else {
    sprintf(sLine,"END   UpdatePinChangeInfo(%d)",(ulong)(uint)lnRet);
    trace_event(sLine,5);
  }
  return lnRet;
}



// WARNING: Unknown calling convention

int GetActionCode(int nIndiceCtx,char *sTlvAuth,char *sActionCode)

{
  size_t __n;
  ulong uVar1;
  uint uVar2;
  uchar *puVar3;
  bool bVar4;
  byte bVar5;
  uchar auStack_3014 [7100];
  char sEventCode [4];
  char T_action_code [4];
  int nLength;
  int response_code;
  sqlca sqlca;
  sqlexd_conflict sqlstm;
  char sLine [512];
  anon_struct_4100_2_43c7b5cf T_tlv_auth;
  
  bVar5 = 0;
  trace_event("Start GetActionCode() ",5);
  GetTlvBuffer("203",sTlvAuth,sEventCode,&nLength);
  sprintf(sLine,"==> EVENT CODE( %.3s )",sEventCode);
  trace_event(sLine,5);
  puVar3 = T_tlv_auth.arr + 2;
  uVar2 = 0xfff;
  T_tlv_auth.arr[0] = '\0';
  T_tlv_auth.arr[1] = '\0';
  bVar4 = ((ulong)puVar3 & 4) != 0;
  if (bVar4) {
    T_tlv_auth.arr[2] = '\0';
    T_tlv_auth.arr[3] = '\0';
    T_tlv_auth.arr[4] = '\0';
    T_tlv_auth.arr[5] = '\0';
    uVar2 = 0xffb;
    puVar3 = T_tlv_auth.arr + 6;
  }
  for (uVar1 = (ulong)(uVar2 >> 3); uVar1 != 0; uVar1 = uVar1 - 1) {
    puVar3[0] = '\0';
    puVar3[1] = '\0';
    puVar3[2] = '\0';
    puVar3[3] = '\0';
    puVar3[4] = '\0';
    puVar3[5] = '\0';
    puVar3[6] = '\0';
    puVar3[7] = '\0';
    puVar3 = puVar3 + (ulong)bVar5 * -0x10 + 8;
  }
  if (!bVar4) {
    puVar3[0] = '\0';
    puVar3[1] = '\0';
    puVar3[2] = '\0';
    puVar3[3] = '\0';
    puVar3 = puVar3 + 4;
  }
  puVar3[0] = '\0';
  puVar3[1] = '\0';
  puVar3[2] = '\0';
  T_action_code[0] = '\0';
  T_action_code[1] = '\0';
  T_action_code[2] = '\0';
  T_action_code[3] = '\0';
  T_tlv_auth.len = 0;
  __n = strlen(sTlvAuth);
  puVar3 = T_tlv_auth.arr;
  memcpy(puVar3,sTlvAuth,__n);
  T_tlv_auth.len = (ushort)__n;
  sqlstm.sqlest = (uchar *)&sqlca;
  sqlstm.sqladtp = &sqladt;
  sqlstm.sqadto[1] = 0;
  sqlstm.sqltdsp = &sqltds;
  sqlstm.sqlety = 0x1100;
  sqlstm.sqadto[0] = 0;
  sqlstm.sqtdso[0] = 0;
  sqlstm.stmt = 
  "begin :response_code := PCRD_P7_GENERAL_TOOLS . GET_ACTION_CODE ( :T_tlv_auth , :T_action_code ) ; END ;"
  ;
  sqlstm.sqtdso[1] = 0;
  response_code = 0x38d;
  sqlstm.sqlvsn = 0xc;
  sqlstm.cud = sqlcud0;
  sqlstm.sqhstv[0] = (uchar *)&response_code;
  sqlstm.arrsiz = 3;
  sqlstm.iters = 1;
  sqlstm.offset = 5;
  sqlstm.sqphsv = sqlstm.sqhstv;
  sqlstm.occurs = 0;
  sqlstm.sqhstl[0] = 4;
  sqlstm.sqhsts[0] = 0;
  sqlstm.sqindv[0] = (short *)0x0;
  sqlstm.sqinds[0] = 0;
  sqlstm.sqharm[0] = 0;
  sqlstm.sqhstl[1] = 0x1003;
  sqlstm.sqhsts[1] = 0;
  sqlstm.sqindv[1] = (short *)0x0;
  sqlstm.sqinds[1] = 0;
  sqlstm.sqharm[1] = 0;
  sqlstm.sqhstl[2] = 4;
  sqlstm.sqhsts[2] = 0;
  sqlstm.sqindv[2] = (short *)0x0;
  sqlstm.sqinds[2] = 0;
  sqlstm.sqphsl = sqlstm.sqhstl;
  sqlstm.sqharm[2] = 0;
  sqlstm.sqadto[2] = 0;
  sqlstm.sqphss = sqlstm.sqhsts;
  sqlstm.sqtdso[2] = 0;
  sqlstm.sqpind = sqlstm.sqindv;
  sqlstm.sqpins = sqlstm.sqinds;
  sqlstm.sqparm = sqlstm.sqharm;
  sqlstm.sqparc = sqlstm.sqharc;
  sqlstm.sqpadto = sqlstm.sqadto;
  sqlstm.sqptdso = sqlstm.sqtdso;
  sqlstm.sqhstv[1] = (uchar *)&T_tlv_auth;
  sqlstm.sqhstv[2] = (uchar *)T_action_code;
  sqlcxt((long)nIndiceCtx * 0x10 + 0x713948,&sqlctx,&sqlstm,&sqlfpn);
  if (sqlca.sqlcode < 0) {
    tlvcpy(sTlvAuth,(char *)puVar3,(uint)T_tlv_auth.len);
    sprintf(sLine,"%.40s",sqlca.sqlerrm.sqlerrmc);
    trace_event(sLine,1);
    trace_event("End GetActionCode(SYSTEM_MALFUNCTION)",5);
    response_code = 0x38d;
  }
  else {
    if (response_code == 0) {
      tlvcpy(sTlvAuth,(char *)puVar3,(uint)T_tlv_auth.len);
      *(undefined2 *)sActionCode = T_action_code._0_2_;
      sActionCode[2] = T_action_code[2];
      trace_event("End GetActionCode( OK )",5);
    }
    tlvcpy(sTlvAuth,(char *)T_tlv_auth.arr,(uint)T_tlv_auth.len);
    sprintf(sLine,"End GetActionCode( %d )  Action (%.3s)",(ulong)(uint)response_code,sActionCode);
    trace_event(sLine,5);
  }
  return response_code;
}



// WARNING: Unknown calling convention

int GetAuthNumber(int nIndiceCtx,char *sTlvBuffer)

{
  int response_code;
  char T_auth_number [7];
  sqlca sqlca;
  char sLine [512];
  
  trace_event("Start GetAuthNumber() ",5);
  sLine._40_8_ = &sqlca;
  sLine._56_8_ = &sqladt;
  sLine._64_8_ = &sqltds;
  T_auth_number[4] = '\0';
  T_auth_number[5] = '\0';
  sLine[0x16] = '\0';
  sLine[0x17] = '\x11';
  sLine[0x110] = '\0';
  sLine[0x111] = '\0';
  sLine._48_8_ = s_begin__response_code____PCRD_P7__004caef8;
  sLine[0x114] = '\0';
  sLine[0x115] = '\0';
  sLine[0x112] = '\0';
  sLine[0x113] = '\0';
  sLine[0x116] = '\0';
  sLine[0x117] = '\0';
  sLine._32_8_ = sqlcud0;
  sLine._72_8_ = sLine + 0xb0;
  T_auth_number[0] = '\0';
  T_auth_number[1] = '\0';
  T_auth_number[2] = '\0';
  T_auth_number[3] = '\0';
  T_auth_number[6] = '\0';
  response_code = 0x38d;
  sLine._80_8_ = sLine + 0xc0;
  sLine[0] = '\f';
  sLine[1] = '\0';
  sLine[2] = '\0';
  sLine[3] = '\0';
  sLine[4] = '\0';
  sLine[5] = '\0';
  sLine[6] = '\0';
  sLine[7] = '\0';
  sLine[8] = '\x02';
  sLine[9] = '\0';
  sLine[10] = '\0';
  sLine[0xb] = '\0';
  sLine[0xc] = '\x01';
  sLine[0xd] = '\0';
  sLine[0xe] = '\0';
  sLine[0xf] = '\0';
  sLine._88_8_ = sLine + 0xd0;
  sLine[0x10] = '\x05';
  sLine[0x11] = '\0';
  sLine[0x12] = '\0';
  sLine[0x13] = '\0';
  sLine[0x18] = '\0';
  sLine[0x19] = '\0';
  sLine[0x1a] = '\0';
  sLine[0x1b] = '\0';
  sLine[0xc0] = '\x04';
  sLine[0xc1] = '\0';
  sLine[0xc2] = '\0';
  sLine[0xc3] = '\0';
  sLine[0xc4] = '\0';
  sLine[0xc5] = '\0';
  sLine[0xc6] = '\0';
  sLine[199] = '\0';
  sLine[0xd0] = '\0';
  sLine[0xd1] = '\0';
  sLine[0xd2] = '\0';
  sLine[0xd3] = '\0';
  sLine[0xd8] = '\0';
  sLine[0xd9] = '\0';
  sLine[0xda] = '\0';
  sLine[0xdb] = '\0';
  sLine[0xdc] = '\0';
  sLine[0xdd] = '\0';
  sLine[0xde] = '\0';
  sLine[0xdf] = '\0';
  sLine[0xe8] = '\0';
  sLine[0xe9] = '\0';
  sLine[0xea] = '\0';
  sLine[0xeb] = '\0';
  sLine[0xf0] = '\0';
  sLine[0xf1] = '\0';
  sLine[0xf2] = '\0';
  sLine[0xf3] = '\0';
  sLine[0xf4] = '\0';
  sLine[0xf5] = '\0';
  sLine[0xf6] = '\0';
  sLine[0xf7] = '\0';
  sLine[200] = '\a';
  sLine[0xc9] = '\0';
  sLine[0xca] = '\0';
  sLine[0xcb] = '\0';
  sLine[0xcc] = '\0';
  sLine[0xcd] = '\0';
  sLine[0xce] = '\0';
  sLine[0xcf] = '\0';
  sLine[0xd4] = '\0';
  sLine[0xd5] = '\0';
  sLine[0xd6] = '\0';
  sLine[0xd7] = '\0';
  sLine[0xe0] = '\0';
  sLine[0xe1] = '\0';
  sLine[0xe2] = '\0';
  sLine[0xe3] = '\0';
  sLine[0xe4] = '\0';
  sLine[0xe5] = '\0';
  sLine[0xe6] = '\0';
  sLine[0xe7] = '\0';
  sLine[0xec] = '\0';
  sLine[0xed] = '\0';
  sLine[0xee] = '\0';
  sLine[0xef] = '\0';
  sLine[0xf8] = '\0';
  sLine[0xf9] = '\0';
  sLine[0xfa] = '\0';
  sLine[0xfb] = '\0';
  sLine[0xfc] = '\0';
  sLine[0xfd] = '\0';
  sLine[0xfe] = '\0';
  sLine[0xff] = '\0';
  sLine._96_8_ = sLine + 0xd8;
  sLine._104_8_ = sLine + 0xe8;
  sLine._112_8_ = sLine + 0xf0;
  sLine._120_8_ = sLine + 0x100;
  sLine._128_8_ = sLine + 0x110;
  sLine._136_8_ = sLine + 0x114;
  sLine._176_8_ = &response_code;
  sLine._184_8_ = T_auth_number;
  sqlcxt((long)nIndiceCtx * 0x10 + 0x713948,&sqlctx,sLine,&sqlfpn);
  if (-1 < sqlca.sqlcode) {
    if (response_code == 0) {
      PutTlvBuffer("038",sTlvBuffer,T_auth_number,6);
      trace_event("End GetAuthNumber( OK )",5);
    }
    else {
      PutTlvBuffer("038",sTlvBuffer,"999999",6);
    }
    sprintf(sLine,"End GetAuthNumber( %d )",(ulong)(uint)response_code);
    trace_event(sLine,5);
    return response_code;
  }
  sprintf(sLine,"%.40s",sqlca.sqlerrm.sqlerrmc);
  trace_event(sLine,1);
  trace_event("End GetAuthNumber(SYSTEM_MALFUNCTION)",5);
  return 0x38d;
}



// WARNING: Unknown calling convention

int PinFromTpkToLmk(int nIndexCtx,uchar *pTpkKey,uchar *pPinBlk,uchar *pPinBlkFmt,uchar *pCardNbr,
                   uchar *pPinLmk)

{
  int iVar1;
  long lVar2;
  uchar *puVar3;
  byte bVar4;
  uchar lErrCode [3];
  pid_t nPid;
  char sLine [512];
  uchar lHsmBuffIn [4096];
  uchar lHsmBuffOut [4096];
  
  bVar4 = 0;
  sprintf(sLine,"Start PinFromTpkToLmk(%.16s,%.16s,%.2s,%.22s)",pTpkKey,pPinBlk,pPinBlkFmt,pCardNbr)
  ;
  trace_event(sLine,5);
  puVar3 = lHsmBuffIn;
  for (lVar2 = 0x200; lVar2 != 0; lVar2 = lVar2 + -1) {
    puVar3[0] = '\0';
    puVar3[1] = '\0';
    puVar3[2] = '\0';
    puVar3[3] = '\0';
    puVar3[4] = '\0';
    puVar3[5] = '\0';
    puVar3[6] = '\0';
    puVar3[7] = '\0';
    puVar3 = puVar3 + (ulong)bVar4 * -0x10 + 8;
  }
  lErrCode[2] = '\0';
  puVar3 = lHsmBuffOut;
  for (lVar2 = 0x200; lVar2 != 0; lVar2 = lVar2 + -1) {
    puVar3[0] = '\0';
    puVar3[1] = '\0';
    puVar3[2] = '\0';
    puVar3[3] = '\0';
    puVar3[4] = '\0';
    puVar3[5] = '\0';
    puVar3[6] = '\0';
    puVar3[7] = '\0';
    puVar3 = puVar3 + (ulong)bVar4 * -0x10 + 8;
  }
  lErrCode[0] = '\0';
  lErrCode[1] = '\0';
  command_JC((char *)lHsmBuffIn,(char *)pTpkKey,(char *)pPinBlk,(char *)pPinBlkFmt,(char *)pCardNbr)
  ;
  iVar1 = CheckResource(nIndexCtx,"070000",&nPid);
  if ((iVar1 != 0) ||
     (iVar1 = HsmQuery(nIndexCtx,nPid,(char *)lHsmBuffIn,(char *)lHsmBuffOut), iVar1 == 0x3ef)) {
    trace_event("HSM FOR VERIFICATION NOT AVAILABLE",1);
    trace_event("End   PinFromTpkToLmk(HSM_UNAVAILABLE)",5);
    return 9;
  }
  if (iVar1 == 3) {
    trace_event("HSM MALFUNCTION DETECTED",1);
    trace_event("End   PinFromTpkToLmk(SYSTEM_MALFUNCTION)",5);
    return 3;
  }
  trace_event("End  PinFromTpkToLmk(OK)",5);
  command_JD((char *)lHsmBuffOut,(char *)pPinLmk,(char *)lErrCode);
  iVar1 = memcmp(lErrCode,"01",2);
  if (iVar1 != 0) {
    iVar1 = memcmp(lErrCode,"00",2);
    if (iVar1 != 0) {
      trace_event("End   PinFromTpkToLmk(SYSTEM_MALFUNCTION)",5);
      return 0x38d;
    }
    sprintf(sLine,"End   PinFomTpkToLmk(%.16s)",pPinLmk);
    trace_event(sLine,5);
    return 0;
  }
  trace_event("End   PinFromTpkToLmk(NOK)",5);
  return -1;
}



// WARNING: Unknown calling convention

int PinFromZpkToLmk(int nIndexCtx,uchar *pZpkKey,uchar *pPinBlk,uchar *pPinBlkFmt,uchar *pCardNbr,
                   uchar *pPinLmk)

{
  int iVar1;
  long lVar2;
  uchar *puVar3;
  char *mess;
  byte bVar4;
  uchar lErrCode [3];
  pid_t nPid;
  char sLine [512];
  uchar lHsmBuffIn [4096];
  uchar lHsmBuffOut [4096];
  
  bVar4 = 0;
  sprintf(sLine,"Start PinFromZpkToLmk(%.16s,%.16s,%.2s,%.22s)",pZpkKey,pPinBlk,pPinBlkFmt,pCardNbr)
  ;
  trace_event(sLine,5);
  puVar3 = lHsmBuffIn;
  for (lVar2 = 0x200; lVar2 != 0; lVar2 = lVar2 + -1) {
    puVar3[0] = '\0';
    puVar3[1] = '\0';
    puVar3[2] = '\0';
    puVar3[3] = '\0';
    puVar3[4] = '\0';
    puVar3[5] = '\0';
    puVar3[6] = '\0';
    puVar3[7] = '\0';
    puVar3 = puVar3 + (ulong)bVar4 * -0x10 + 8;
  }
  lErrCode[2] = '\0';
  puVar3 = lHsmBuffOut;
  for (lVar2 = 0x200; lVar2 != 0; lVar2 = lVar2 + -1) {
    puVar3[0] = '\0';
    puVar3[1] = '\0';
    puVar3[2] = '\0';
    puVar3[3] = '\0';
    puVar3[4] = '\0';
    puVar3[5] = '\0';
    puVar3[6] = '\0';
    puVar3[7] = '\0';
    puVar3 = puVar3 + (ulong)bVar4 * -0x10 + 8;
  }
  lErrCode[0] = '\0';
  lErrCode[1] = '\0';
  command_JE((char *)lHsmBuffIn,(char *)pZpkKey,(char *)pPinBlk,(char *)pPinBlkFmt,(char *)pCardNbr)
  ;
  iVar1 = CheckResource(nIndexCtx,"070000",&nPid);
  if (iVar1 == 0) {
    iVar1 = HsmQuery(nIndexCtx,nPid,(char *)lHsmBuffIn,(char *)lHsmBuffOut);
    if (iVar1 != 0x3ef) {
      if (iVar1 == 3) {
        trace_event("HSM MALFUNCTION DETECTED",1);
        trace_event("End   PinFromZpkToLmk(SYSTEM_MALFUNCTION)",5);
        return 3;
      }
      trace_event("End  PinFromZpkToLmk(OK)",5);
      command_JF((char *)lHsmBuffOut,(char *)lErrCode,(char *)pPinLmk);
      iVar1 = memcmp(lErrCode,"01",2);
      if (iVar1 != 0) {
        iVar1 = memcmp(lErrCode,"00",2);
        if (iVar1 != 0) {
          trace_event("End   PinFromZpkToLmk(SYSTEM_MALFUNCTION)",5);
          return 0x38d;
        }
        sprintf(sLine,"End   PinFomZpkToLmk(%.16s)",pPinLmk);
        trace_event(sLine,5);
        return 0;
      }
      trace_event("End   PinFromZpkToLmk(NOK)",5);
      return -1;
    }
    mess = "HSM FOR VERIFICATION NOT AVAILABLE";
  }
  else {
    mess = "Resource HSM Unavailable";
  }
  trace_event(mess,1);
  trace_event("End   PinFromZpkToLmk(HSM_UNAVIALABLE)",5);
  return 9;
}



// WARNING: Unknown calling convention

int PinFromTpkToZpk(int nIndexCtx,uchar *pTpkKey,uchar *pZpkKey,uchar *pPinTpk,uchar *pPinBlkFmt,
                   uchar *pCardNbr,uchar *pPinZpk)

{
  int iVar1;
  long lVar2;
  uchar *puVar3;
  byte bVar4;
  uchar *Pan;
  uchar lErrCode [3];
  pid_t nPid;
  char sLine [512];
  uchar lHsmBuffIn [4096];
  uchar lHsmBuffOut [4096];
  
  bVar4 = 0;
  Pan = pCardNbr;
  sprintf(sLine,"Start PinFromTpkToZpk(%.16s,%.16s,%.16s,%.2s,%.22s)",pTpkKey,pZpkKey,pPinTpk,
          pPinBlkFmt);
  trace_event(sLine,5);
  puVar3 = lHsmBuffIn;
  for (lVar2 = 0x200; lVar2 != 0; lVar2 = lVar2 + -1) {
    puVar3[0] = '\0';
    puVar3[1] = '\0';
    puVar3[2] = '\0';
    puVar3[3] = '\0';
    puVar3[4] = '\0';
    puVar3[5] = '\0';
    puVar3[6] = '\0';
    puVar3[7] = '\0';
    puVar3 = puVar3 + (ulong)bVar4 * -0x10 + 8;
  }
  lErrCode[2] = '\0';
  puVar3 = lHsmBuffOut;
  for (lVar2 = 0x200; lVar2 != 0; lVar2 = lVar2 + -1) {
    puVar3[0] = '\0';
    puVar3[1] = '\0';
    puVar3[2] = '\0';
    puVar3[3] = '\0';
    puVar3[4] = '\0';
    puVar3[5] = '\0';
    puVar3[6] = '\0';
    puVar3[7] = '\0';
    puVar3 = puVar3 + (ulong)bVar4 * -0x10 + 8;
  }
  lErrCode[0] = '\0';
  lErrCode[1] = '\0';
  command_CA((char *)lHsmBuffIn,(char *)pTpkKey,(char *)pZpkKey,(char *)pPinTpk,(char *)pPinBlkFmt,
             (char *)pCardNbr,(char *)Pan);
  iVar1 = CheckResource(nIndexCtx,"070000",&nPid);
  if ((iVar1 != 0) ||
     (iVar1 = HsmQuery(nIndexCtx,nPid,(char *)lHsmBuffIn,(char *)lHsmBuffOut), iVar1 == 0x3ef)) {
    trace_event("HSM FOR VERIFICATION NOT AVAILABLE",1);
    trace_event("End   PinFromTpkToZmk(HSM_UNAVIALABLE)",5);
    return 9;
  }
  if (iVar1 == 3) {
    trace_event("HSM MALFUNCTION DETECTED",1);
    trace_event("End   PinFromTpkToZmk(SYSTEM_MALFUNCTION)",5);
    return 3;
  }
  iVar1 = command_CB((char *)lHsmBuffOut,(char *)lErrCode,(char *)pPinZpk);
  if (iVar1 == 0) {
    iVar1 = memcmp(lErrCode,"00",2);
    if (iVar1 != 0) {
      trace_event("End   PinFromZpkToZpk(SYSTEM_MALFUNCTION)",5);
      return 0x38d;
    }
    sprintf(sLine,"End   PinFomTpkToZpk(%.16s)",pPinZpk);
    trace_event(sLine,5);
    return 0;
  }
  trace_event("End   PinFromZpkToZpk(NOK)",5);
  return -1;
}



// WARNING: Unknown calling convention

int ComputePinOffset(int nIndexCtx,TSTlvAutho *sTlvInfo,char *pOffset,char pvki)

{
  int iVar1;
  long lVar2;
  char *pcVar3;
  byte bVar4;
  char sSecurityFormat [3];
  char lPinBlkFmt [3];
  int nLength;
  char lPin [9];
  char lPinLmk [17];
  char lPinBlk [17];
  char lCardNbr [23];
  char sKey [256];
  char lPvka [256];
  char lPvkb [256];
  char sLine [512];
  char sTlvBuffer [4096];
  char sTlvPrivateBuffer [4097];
  char sSecurityData [4097];
  TSTlvPrivate sTlvPrivateInfo;
  
  bVar4 = 0;
  trace_event("Start ComputePinOffset()",5);
  InitTlvPrivate(&sTlvPrivateInfo);
  lPinBlkFmt[0] = '\0';
  lPinBlkFmt[1] = '\0';
  pcVar3 = sTlvPrivateBuffer;
  for (lVar2 = 0x200; lVar2 != 0; lVar2 = lVar2 + -1) {
    pcVar3[0] = '\0';
    pcVar3[1] = '\0';
    pcVar3[2] = '\0';
    pcVar3[3] = '\0';
    pcVar3[4] = '\0';
    pcVar3[5] = '\0';
    pcVar3[6] = '\0';
    pcVar3[7] = '\0';
    pcVar3 = pcVar3 + (ulong)bVar4 * -0x10 + 8;
  }
  lPinBlkFmt[2] = '\0';
  lCardNbr[0x14] = '\0';
  lCardNbr[0x15] = '\0';
  lPin[0] = '\0';
  lPin[1] = '\0';
  lPin[2] = '\0';
  lPin[3] = '\0';
  lPin[4] = '\0';
  lPin[5] = '\0';
  lPin[6] = '\0';
  lPin[7] = '\0';
  lPin[8] = '\0';
  lPinBlk[0] = '\0';
  lPinBlk[1] = '\0';
  lPinBlk[2] = '\0';
  lPinBlk[3] = '\0';
  lPinBlk[4] = '\0';
  lPinBlk[5] = '\0';
  lPinBlk[6] = '\0';
  lPinBlk[7] = '\0';
  lPinBlk[8] = '\0';
  lPinBlk[9] = '\0';
  lPinBlk[10] = '\0';
  lPinBlk[0xb] = '\0';
  lPinBlk[0xc] = '\0';
  lPinBlk[0xd] = '\0';
  lPinBlk[0xe] = '\0';
  lPinBlk[0xf] = '\0';
  lPinBlk[0x10] = '\0';
  *pcVar3 = '\0';
  pcVar3 = sKey;
  for (lVar2 = 0x20; lVar2 != 0; lVar2 = lVar2 + -1) {
    pcVar3[0] = '\0';
    pcVar3[1] = '\0';
    pcVar3[2] = '\0';
    pcVar3[3] = '\0';
    pcVar3[4] = '\0';
    pcVar3[5] = '\0';
    pcVar3[6] = '\0';
    pcVar3[7] = '\0';
    pcVar3 = pcVar3 + (ulong)bVar4 * -0x10 + 8;
  }
  lCardNbr[0] = '\0';
  lCardNbr[1] = '\0';
  lCardNbr[2] = '\0';
  lCardNbr[3] = '\0';
  lCardNbr[4] = '\0';
  lCardNbr[5] = '\0';
  lCardNbr[6] = '\0';
  lCardNbr[7] = '\0';
  lCardNbr[8] = '\0';
  lCardNbr[9] = '\0';
  lCardNbr[10] = '\0';
  lCardNbr[0xb] = '\0';
  lCardNbr[0xc] = '\0';
  lCardNbr[0xd] = '\0';
  lCardNbr[0xe] = '\0';
  lCardNbr[0xf] = '\0';
  lCardNbr[0x10] = '\0';
  lCardNbr[0x11] = '\0';
  lCardNbr[0x12] = '\0';
  lCardNbr[0x13] = '\0';
  lCardNbr[0x16] = '\0';
  sSecurityFormat[2] = '\0';
  pcVar3 = lPvka;
  for (lVar2 = 0x20; lVar2 != 0; lVar2 = lVar2 + -1) {
    pcVar3[0] = '\0';
    pcVar3[1] = '\0';
    pcVar3[2] = '\0';
    pcVar3[3] = '\0';
    pcVar3[4] = '\0';
    pcVar3[5] = '\0';
    pcVar3[6] = '\0';
    pcVar3[7] = '\0';
    pcVar3 = pcVar3 + (ulong)bVar4 * -0x10 + 8;
  }
  pcVar3 = lPvkb;
  for (lVar2 = 0x20; lVar2 != 0; lVar2 = lVar2 + -1) {
    pcVar3[0] = '\0';
    pcVar3[1] = '\0';
    pcVar3[2] = '\0';
    pcVar3[3] = '\0';
    pcVar3[4] = '\0';
    pcVar3[5] = '\0';
    pcVar3[6] = '\0';
    pcVar3[7] = '\0';
    pcVar3 = pcVar3 + (ulong)bVar4 * -0x10 + 8;
  }
  pcVar3 = sSecurityData;
  for (lVar2 = 0x200; lVar2 != 0; lVar2 = lVar2 + -1) {
    pcVar3[0] = '\0';
    pcVar3[1] = '\0';
    pcVar3[2] = '\0';
    pcVar3[3] = '\0';
    pcVar3[4] = '\0';
    pcVar3[5] = '\0';
    pcVar3[6] = '\0';
    pcVar3[7] = '\0';
    pcVar3 = pcVar3 + (ulong)bVar4 * -0x10 + 8;
  }
  *pcVar3 = '\0';
  sSecurityFormat[0] = '\0';
  sSecurityFormat[1] = '\0';
  pcVar3 = sTlvBuffer;
  for (lVar2 = 0x200; lVar2 != 0; lVar2 = lVar2 + -1) {
    pcVar3[0] = '\0';
    pcVar3[1] = '\0';
    pcVar3[2] = '\0';
    pcVar3[3] = '\0';
    pcVar3[4] = '\0';
    pcVar3[5] = '\0';
    pcVar3[6] = '\0';
    pcVar3[7] = '\0';
    pcVar3 = pcVar3 + (ulong)bVar4 * -0x10 + 8;
  }
  iVar1 = GetTlvAutho("002",sTlvInfo,lCardNbr,&nLength);
  pcVar3 = " Extract Card Number Error ";
  if (iVar1 == 0) {
    iVar1 = GetTlvAutho("031",sTlvInfo,lPinBlk,&nLength);
    if (iVar1 == 0) {
      iVar1 = GetTlvAutho("048",sTlvInfo,sTlvPrivateBuffer,&nLength);
      if (iVar1 == 0) {
        AnalyseTlvPrivate(sTlvPrivateBuffer,nLength,&sTlvPrivateInfo);
        GetTlvPrivate("P10",&sTlvPrivateInfo,sKey,&nLength);
      }
      GetTlvAutho("053",sTlvInfo,sSecurityData,&nLength);
      GetSecurityData(0,sSecurityData,sSecurityFormat,&nLength);
      GetSecurityData(1,sSecurityData,lPinBlkFmt,&nLength);
      iVar1 = GetTlvAutho("448",sTlvInfo,sKey,&nLength);
      if (iVar1 != 0) {
        trace_event(" Extract AUTO_PVK_V1 ",5);
        trace_event("End   AUTO_PVK_V1(ERROR)",5);
        return 1;
      }
      if (sKey[0] == 'S') {
        memcpy(lPvka,sKey,(long)nLength);
LAB_0045cd62:
        iVar1 = ProdPinOffsetOfcustomerPIN(nIndexCtx,sKey,lPvka,lPinBlk,lPinBlkFmt,lCardNbr,pOffset)
        ;
        sprintf(sLine,"End   ComputePinOffset(%s)",pOffset);
        trace_event(sLine,5);
        return iVar1;
      }
      iVar1 = GetTlvAutho("443",sTlvInfo,sKey,&nLength);
      if ((iVar1 == 0) || (iVar1 = GetPVKPinKey(nIndexCtx,lCardNbr,lPvka,lPvkb), iVar1 == 0))
      goto LAB_0045cd62;
      goto LAB_0045cdd1;
    }
    pcVar3 = " Extract New Pin Block Data Error ";
  }
  trace_event(pcVar3,5);
LAB_0045cdd1:
  trace_event("End   ComputePinOffset(ERROR)",5);
  return 1;
}



// WARNING: Unknown calling convention

int ComputePvv(int nIndexCtx,TSTlvAutho *sTlvInfo,char *pPvv,char pvki)

{
  int iVar1;
  long lVar2;
  char *pcVar3;
  byte bVar4;
  char sSecurityFormat [3];
  char lPinBlkFmt [3];
  char lPvki [3];
  int nLength;
  char lPin [9];
  char lPinLmk [17];
  char lPinBlk [17];
  char lCardNbr [23];
  char sKey [256];
  char lPvka [256];
  char lPvkb [256];
  char sLine [512];
  char sTlvBuffer [4096];
  char sTlvPrivateBuffer [4097];
  char sSecurityData [4097];
  TSTlvPrivate sTlvPrivateInfo;
  
  bVar4 = 0;
  trace_event("Start ComputePvv()",5);
  InitTlvPrivate(&sTlvPrivateInfo);
  pcVar3 = sKey;
  for (lVar2 = 0x20; lVar2 != 0; lVar2 = lVar2 + -1) {
    pcVar3[0] = '\0';
    pcVar3[1] = '\0';
    pcVar3[2] = '\0';
    pcVar3[3] = '\0';
    pcVar3[4] = '\0';
    pcVar3[5] = '\0';
    pcVar3[6] = '\0';
    pcVar3[7] = '\0';
    pcVar3 = pcVar3 + (ulong)bVar4 * -0x10 + 8;
  }
  lPinBlkFmt[0] = '\0';
  lPinBlkFmt[1] = '\0';
  lCardNbr[0x14] = '\0';
  lCardNbr[0x15] = '\0';
  lPinBlkFmt[2] = '\0';
  lPin[0] = '\0';
  lPin[1] = '\0';
  lPin[2] = '\0';
  lPin[3] = '\0';
  lPin[4] = '\0';
  lPin[5] = '\0';
  lPin[6] = '\0';
  lPin[7] = '\0';
  pcVar3 = sTlvPrivateBuffer;
  for (lVar2 = 0x200; lVar2 != 0; lVar2 = lVar2 + -1) {
    pcVar3[0] = '\0';
    pcVar3[1] = '\0';
    pcVar3[2] = '\0';
    pcVar3[3] = '\0';
    pcVar3[4] = '\0';
    pcVar3[5] = '\0';
    pcVar3[6] = '\0';
    pcVar3[7] = '\0';
    pcVar3 = pcVar3 + (ulong)bVar4 * -0x10 + 8;
  }
  lPin[8] = '\0';
  lPinBlk[0] = '\0';
  lPinBlk[1] = '\0';
  lPinBlk[2] = '\0';
  lPinBlk[3] = '\0';
  lPinBlk[4] = '\0';
  lPinBlk[5] = '\0';
  lPinBlk[6] = '\0';
  lPinBlk[7] = '\0';
  lPinBlk[8] = '\0';
  lPinBlk[9] = '\0';
  lPinBlk[10] = '\0';
  lPinBlk[0xb] = '\0';
  lPinBlk[0xc] = '\0';
  lPinBlk[0xd] = '\0';
  lPinBlk[0xe] = '\0';
  lPinBlk[0xf] = '\0';
  lPinBlk[0x10] = '\0';
  lCardNbr[0] = '\0';
  lCardNbr[1] = '\0';
  lCardNbr[2] = '\0';
  lCardNbr[3] = '\0';
  lCardNbr[4] = '\0';
  lCardNbr[5] = '\0';
  lCardNbr[6] = '\0';
  lCardNbr[7] = '\0';
  lCardNbr[8] = '\0';
  lCardNbr[9] = '\0';
  lCardNbr[10] = '\0';
  lCardNbr[0xb] = '\0';
  lCardNbr[0xc] = '\0';
  lCardNbr[0xd] = '\0';
  lCardNbr[0xe] = '\0';
  lCardNbr[0xf] = '\0';
  lCardNbr[0x10] = '\0';
  lCardNbr[0x11] = '\0';
  lCardNbr[0x12] = '\0';
  lCardNbr[0x13] = '\0';
  lCardNbr[0x16] = '\0';
  sSecurityFormat[2] = '\0';
  *pcVar3 = '\0';
  pcVar3 = lPvka;
  for (lVar2 = 0x20; lVar2 != 0; lVar2 = lVar2 + -1) {
    pcVar3[0] = '\0';
    pcVar3[1] = '\0';
    pcVar3[2] = '\0';
    pcVar3[3] = '\0';
    pcVar3[4] = '\0';
    pcVar3[5] = '\0';
    pcVar3[6] = '\0';
    pcVar3[7] = '\0';
    pcVar3 = pcVar3 + (ulong)bVar4 * -0x10 + 8;
  }
  pcVar3 = lPvkb;
  for (lVar2 = 0x20; lVar2 != 0; lVar2 = lVar2 + -1) {
    pcVar3[0] = '\0';
    pcVar3[1] = '\0';
    pcVar3[2] = '\0';
    pcVar3[3] = '\0';
    pcVar3[4] = '\0';
    pcVar3[5] = '\0';
    pcVar3[6] = '\0';
    pcVar3[7] = '\0';
    pcVar3 = pcVar3 + (ulong)bVar4 * -0x10 + 8;
  }
  pcVar3 = sSecurityData;
  for (lVar2 = 0x200; lVar2 != 0; lVar2 = lVar2 + -1) {
    pcVar3[0] = '\0';
    pcVar3[1] = '\0';
    pcVar3[2] = '\0';
    pcVar3[3] = '\0';
    pcVar3[4] = '\0';
    pcVar3[5] = '\0';
    pcVar3[6] = '\0';
    pcVar3[7] = '\0';
    pcVar3 = pcVar3 + (ulong)bVar4 * -0x10 + 8;
  }
  *pcVar3 = '\0';
  sSecurityFormat[0] = '\0';
  sSecurityFormat[1] = '\0';
  pcVar3 = sTlvBuffer;
  for (lVar2 = 0x200; lVar2 != 0; lVar2 = lVar2 + -1) {
    pcVar3[0] = '\0';
    pcVar3[1] = '\0';
    pcVar3[2] = '\0';
    pcVar3[3] = '\0';
    pcVar3[4] = '\0';
    pcVar3[5] = '\0';
    pcVar3[6] = '\0';
    pcVar3[7] = '\0';
    pcVar3 = pcVar3 + (ulong)bVar4 * -0x10 + 8;
  }
  iVar1 = GetTlvAutho("002",sTlvInfo,lCardNbr,&nLength);
  pcVar3 = " Extract Card Number Error ";
  if (iVar1 == 0) {
    iVar1 = GetTlvAutho("031",sTlvInfo,lPinBlk,&nLength);
    if (iVar1 == 0) {
      iVar1 = GetTlvAutho("048",sTlvInfo,sTlvPrivateBuffer,&nLength);
      if (iVar1 == 0) {
        AnalyseTlvPrivate(sTlvPrivateBuffer,nLength,&sTlvPrivateInfo);
        GetTlvPrivate("P10",&sTlvPrivateInfo,sKey,&nLength);
      }
      GetTlvAutho("053",sTlvInfo,sSecurityData,&nLength);
      GetSecurityData(0,sSecurityData,sSecurityFormat,&nLength);
      GetSecurityData(1,sSecurityData,lPinBlkFmt,&nLength);
      iVar1 = GetTlvAutho("443",sTlvInfo,sKey,&nLength);
      if (iVar1 == 0) {
        if (sKey[0] == 'S') {
          memcpy(lPvka,sKey,(long)nLength);
        }
        else {
          lPvka[8] = sKey[8];
          lPvka[9] = sKey[9];
          lPvka[10] = sKey[10];
          lPvka[0xb] = sKey[0xb];
          lPvka[0xc] = sKey[0xc];
          lPvka[0xd] = sKey[0xd];
          lPvka[0xe] = sKey[0xe];
          lPvka[0xf] = sKey[0xf];
          lPvkb[0] = sKey[0x10];
          lPvkb[1] = sKey[0x11];
          lPvkb[2] = sKey[0x12];
          lPvkb[3] = sKey[0x13];
          lPvkb[4] = sKey[0x14];
          lPvkb[5] = sKey[0x15];
          lPvkb[6] = sKey[0x16];
          lPvkb[7] = sKey[0x17];
          lPvkb[8] = sKey[0x18];
          lPvkb[9] = sKey[0x19];
          lPvkb[10] = sKey[0x1a];
          lPvkb[0xb] = sKey[0x1b];
          lPvkb[0xc] = sKey[0x1c];
          lPvkb[0xd] = sKey[0x1d];
          lPvkb[0xe] = sKey[0x1e];
          lPvkb[0xf] = sKey[0x1f];
        }
LAB_0045d114:
        lPvki[0] = pvki;
        iVar1 = generate_ABA_PVV(nIndexCtx,sKey,lPvka,lPinBlk,lPinBlkFmt,lCardNbr,lPvki,pPvv);
        if (debug_option != 1) {
          trace_event("End   ComputePvv(OK)",5);
          return iVar1;
        }
        sprintf(sLine,"End   ComputePvv(%s)",pPvv);
        trace_event(sLine,5);
        return iVar1;
      }
      trace_event(" ComputePvv 1...",5);
      iVar1 = GetPVK(nIndexCtx,lCardNbr,pvki,lPvka,lPvkb);
      if (iVar1 == 0) goto LAB_0045d114;
      goto LAB_0045d189;
    }
    pcVar3 = " Extract New Pin Block Data Error ";
  }
  trace_event(pcVar3,5);
LAB_0045d189:
  trace_event("End   ComputePvv(ERROR)",5);
  return 1;
}



// WARNING: Unknown calling convention

int FormatThePvvtlvBuffer
              (char *v_card_number,char *v_pvkI_key,char *v_pvkA_key,char *v_pvkB_key,
              char *v_pin_block,char *sTlvBuffer)

{
  uint uVar1;
  uint uVar2;
  size_t sVar3;
  uint *puVar4;
  uint *puVar5;
  bool bVar6;
  char sFlagsBuffer [11];
  TSTlvProd tlvInfo;
  
  InitTlvProd(&tlvInfo);
  builtin_strncpy(sFlagsBuffer,"NNYNNYNNNN",0xb);
  puVar5 = (uint *)sFlagsBuffer;
  do {
    puVar4 = puVar5;
    uVar1 = *puVar4 + 0xfefefeff & ~*puVar4;
    uVar2 = uVar1 & 0x80808080;
    puVar5 = puVar4 + 1;
  } while (uVar2 == 0);
  bVar6 = (uVar1 & 0x8080) == 0;
  if (bVar6) {
    uVar2 = uVar2 >> 0x10;
  }
  if (bVar6) {
    puVar5 = (uint *)((long)puVar4 + 6);
  }
  PutTlvProd("P03",&tlvInfo,sFlagsBuffer,
             (((int)puVar5 + -3) - (uint)CARRY1((byte)uVar2,(byte)uVar2)) - (int)sFlagsBuffer);
  sVar3 = strlen(v_card_number);
  PutTlvProd("P04",&tlvInfo,v_card_number,(int)sVar3);
  sVar3 = strlen(v_pvkI_key);
  PutTlvProd("P11",&tlvInfo,v_pvkI_key,(int)sVar3);
  sVar3 = strlen(v_pvkA_key);
  PutTlvProd("P12",&tlvInfo,v_pvkA_key,(int)sVar3);
  sVar3 = strlen(v_pvkB_key);
  PutTlvProd("P13",&tlvInfo,v_pvkB_key,(int)sVar3);
  sVar3 = strlen(v_pin_block);
  PutTlvProd("P14",&tlvInfo,v_pin_block,(int)sVar3);
  ProdBuildTlv(sTlvBuffer,&tlvInfo);
  return 0;
}



// WARNING: Unknown calling convention

int FormatTheOffsetTlvBuffer
              (char *v_card_number,char *v_pvkA_key,char *v_pin_block,int vPinLength,
              char *sTlvBuffer)

{
  uint uVar1;
  uint uVar2;
  size_t sVar3;
  uint *puVar4;
  uint *puVar5;
  bool bVar6;
  char sPinLen [3];
  char sFlagsBuffer [11];
  char sLine [512];
  TSTlvProd tlvInfo;
  
  InitTlvProd(&tlvInfo);
  sprintf(sLine,"vPinLength = [%d]",(ulong)(uint)vPinLength);
  trace_event(sLine,5);
  sPinLen[0] = '\0';
  sPinLen[1] = '\0';
  sPinLen[2] = '\0';
  sprintf(sPinLen,"%02d",(ulong)(uint)vPinLength);
  sprintf(sLine,"sPinLen = [%s]",sPinLen);
  trace_event(sLine,5);
  builtin_strncpy(sFlagsBuffer,"NNNNNNYNNN",0xb);
  puVar5 = (uint *)sFlagsBuffer;
  do {
    puVar4 = puVar5;
    uVar1 = *puVar4 + 0xfefefeff & ~*puVar4;
    uVar2 = uVar1 & 0x80808080;
    puVar5 = puVar4 + 1;
  } while (uVar2 == 0);
  bVar6 = (uVar1 & 0x8080) == 0;
  if (bVar6) {
    uVar2 = uVar2 >> 0x10;
  }
  if (bVar6) {
    puVar5 = (uint *)((long)puVar4 + 6);
  }
  PutTlvProd("P03",&tlvInfo,sFlagsBuffer,
             (((int)puVar5 + -3) - (uint)CARRY1((byte)uVar2,(byte)uVar2)) - (int)sFlagsBuffer);
  sVar3 = strlen(v_card_number);
  PutTlvProd("P04",&tlvInfo,v_card_number,(int)sVar3);
  sVar3 = strlen(v_pvkA_key);
  PutTlvProd("P12",&tlvInfo,v_pvkA_key,(int)sVar3);
  sVar3 = strlen(v_pin_block);
  PutTlvProd("P14",&tlvInfo,v_pin_block,(int)sVar3);
  puVar5 = (uint *)sPinLen;
  do {
    puVar4 = puVar5;
    uVar1 = *puVar4 + 0xfefefeff & ~*puVar4;
    uVar2 = uVar1 & 0x80808080;
    puVar5 = puVar4 + 1;
  } while (uVar2 == 0);
  bVar6 = (uVar1 & 0x8080) == 0;
  if (bVar6) {
    uVar2 = uVar2 >> 0x10;
  }
  if (bVar6) {
    puVar5 = (uint *)((long)puVar4 + 6);
  }
  PutTlvProd("P24",&tlvInfo,sPinLen,
             (((int)puVar5 + -3) - (uint)CARRY1((byte)uVar2,(byte)uVar2)) - (int)sPinLen);
  dump_buffer((uchar *)tlvInfo.sTlvData,tlvInfo.nLength,'A','L','O');
  ProdBuildTlv(sTlvBuffer,&tlvInfo);
  return 0;
}



// WARNING: Unknown calling convention

int GeneratePinOffset(int nIndexCtx,uchar *pPvkaKey,uchar *pPinLmk,uchar *pCardNbr,uchar *pPinOffset
                     )

{
  int iVar1;
  long lVar2;
  uchar *puVar3;
  byte bVar4;
  uchar lErrorCode [2];
  pid_t nPid;
  char sLine [512];
  uchar lHsmBuffIn [4096];
  uchar lHsmBuffOut [4096];
  
  bVar4 = 0;
  sprintf(sLine,"Start GeneratePinOffset(%.16s,%.16s,%.22s)",pPvkaKey,pPinLmk,pCardNbr);
  trace_event(sLine,5);
  puVar3 = lHsmBuffIn;
  for (lVar2 = 0x200; lVar2 != 0; lVar2 = lVar2 + -1) {
    puVar3[0] = '\0';
    puVar3[1] = '\0';
    puVar3[2] = '\0';
    puVar3[3] = '\0';
    puVar3[4] = '\0';
    puVar3[5] = '\0';
    puVar3[6] = '\0';
    puVar3[7] = '\0';
    puVar3 = puVar3 + (ulong)bVar4 * -0x10 + 8;
  }
  puVar3 = lHsmBuffOut;
  for (lVar2 = 0x200; lVar2 != 0; lVar2 = lVar2 + -1) {
    puVar3[0] = '\0';
    puVar3[1] = '\0';
    puVar3[2] = '\0';
    puVar3[3] = '\0';
    puVar3[4] = '\0';
    puVar3[5] = '\0';
    puVar3[6] = '\0';
    puVar3[7] = '\0';
    puVar3 = puVar3 + (ulong)bVar4 * -0x10 + 8;
  }
  lErrorCode[0] = '\0';
  lErrorCode[1] = '\0';
  command_DE((char *)lHsmBuffIn,(char *)pPvkaKey,(char *)pPinLmk,(char *)pCardNbr);
  iVar1 = CheckResource(nIndexCtx,"070000",&nPid);
  if ((iVar1 != 0) ||
     (iVar1 = HsmQuery(nIndexCtx,nPid,(char *)lHsmBuffIn,(char *)lHsmBuffOut), iVar1 == 0x3ef)) {
    trace_event("HSM FOR VERIFICATION NOT AVAILABLE",1);
    trace_event("End   GeneratePinOffset(HSM_UNAVAILABLE)",5);
    return 9;
  }
  if (iVar1 == 3) {
    trace_event("HSM MALFUNCTION DETECTED",1);
    trace_event("End   GeneratePinOffset(SYSTEM_MALFUNCTION)",5);
    return 3;
  }
  command_DF((char *)lHsmBuffOut,(char *)lErrorCode,(char *)pPinOffset);
  iVar1 = memcmp(lErrorCode,"01",2);
  if (iVar1 != 0) {
    iVar1 = memcmp(lErrorCode,"00",2);
    if (iVar1 != 0) {
      trace_event("End   GeneratePinOffset(NOK)",5);
      return 0x38d;
    }
    sprintf(sLine,"End   GeneratePinOffset(%.16s)",pPinOffset);
    trace_event(sLine,5);
    return 0;
  }
  trace_event("End   GeneratePinOffset(NOK)",5);
  return -1;
}



// WARNING: Unknown calling convention

int ReversalProcedure(int nIndiceCtx,char *sReversalMode,char *sBillCalculation,char *sTlvBuffer,
                     char *sCaptureCode,char *sRoutingCode)

{
  size_t __n;
  ulong uVar1;
  uint uVar2;
  uchar *puVar3;
  bool bVar4;
  byte bVar5;
  uchar auStack_3014 [7404];
  char T_bill_calcul_flag [2];
  char T_reversal_mode [2];
  int response_code;
  char T_ROUTING_CODE [7];
  char T_CAPTURE_CODE [7];
  sqlca sqlca;
  char sLine [512];
  anon_struct_4100_2_43c7b5cf T_tlv_auth;
  
  bVar5 = 0;
  trace_event("Start ReversalProcedure() ",5);
  sLine._200_8_ = &T_tlv_auth;
  puVar3 = T_tlv_auth.arr + 2;
  T_ROUTING_CODE[0] = '\0';
  T_ROUTING_CODE[1] = '\0';
  T_ROUTING_CODE[2] = '\0';
  T_ROUTING_CODE[3] = '\0';
  uVar2 = 0xfff;
  T_bill_calcul_flag[1] = '\0';
  T_bill_calcul_flag[0] = *sBillCalculation;
  bVar4 = ((ulong)puVar3 & 4) != 0;
  T_ROUTING_CODE[4] = '\0';
  T_ROUTING_CODE[5] = '\0';
  T_ROUTING_CODE[6] = '\0';
  T_CAPTURE_CODE[0] = '\0';
  T_CAPTURE_CODE[1] = '\0';
  T_CAPTURE_CODE[2] = '\0';
  T_CAPTURE_CODE[3] = '\0';
  T_CAPTURE_CODE[4] = '\0';
  T_CAPTURE_CODE[5] = '\0';
  T_CAPTURE_CODE[6] = '\0';
  T_tlv_auth.arr[0] = '\0';
  T_tlv_auth.arr[1] = '\0';
  T_reversal_mode[1] = '\0';
  T_reversal_mode[0] = *sReversalMode;
  if (bVar4) {
    T_tlv_auth.arr[2] = '\0';
    T_tlv_auth.arr[3] = '\0';
    T_tlv_auth.arr[4] = '\0';
    T_tlv_auth.arr[5] = '\0';
    uVar2 = 0xffb;
    puVar3 = T_tlv_auth.arr + 6;
  }
  for (uVar1 = (ulong)(uVar2 >> 3); uVar1 != 0; uVar1 = uVar1 - 1) {
    puVar3[0] = '\0';
    puVar3[1] = '\0';
    puVar3[2] = '\0';
    puVar3[3] = '\0';
    puVar3[4] = '\0';
    puVar3[5] = '\0';
    puVar3[6] = '\0';
    puVar3[7] = '\0';
    puVar3 = puVar3 + (ulong)bVar5 * -0x10 + 8;
  }
  if (!bVar4) {
    puVar3[0] = '\0';
    puVar3[1] = '\0';
    puVar3[2] = '\0';
    puVar3[3] = '\0';
    puVar3 = puVar3 + 4;
  }
  puVar3[0] = '\0';
  puVar3[1] = '\0';
  puVar3[2] = '\0';
  puVar3 = T_tlv_auth.arr;
  T_tlv_auth.len = 0;
  __n = strlen(sTlvBuffer);
  memcpy(puVar3,sTlvBuffer,__n);
  T_tlv_auth.len = (ushort)__n;
  PrintTlvBuffer((char *)puVar3);
  sLine._40_8_ = &sqlca;
  sLine._56_8_ = &sqladt;
  sLine[0x16] = '\0';
  sLine[0x17] = '\x11';
  sLine[0x1d0] = '\0';
  sLine[0x1d1] = '\0';
  sLine._64_8_ = &sqltds;
  sLine[0x1dc] = '\0';
  sLine[0x1dd] = '\0';
  sLine[0x1d2] = '\0';
  sLine[0x1d3] = '\0';
  sLine[0x1de] = '\0';
  sLine[0x1df] = '\0';
  sLine._48_8_ = s_begin__response_code____PCRD_P7__004cb538;
  response_code = 0x38d;
  sLine[0] = '\f';
  sLine[1] = '\0';
  sLine[2] = '\0';
  sLine[3] = '\0';
  sLine[4] = '\0';
  sLine[5] = '\0';
  sLine[6] = '\0';
  sLine[7] = '\0';
  sLine[8] = '\x06';
  sLine[9] = '\0';
  sLine[10] = '\0';
  sLine[0xb] = '\0';
  sLine._32_8_ = sqlcud0;
  sLine._176_8_ = &response_code;
  sLine[0xc] = '\x01';
  sLine[0xd] = '\0';
  sLine[0xe] = '\0';
  sLine[0xf] = '\0';
  sLine[0x10] = '\x05';
  sLine[0x11] = '\0';
  sLine[0x12] = '\0';
  sLine[0x13] = '\0';
  sLine._184_8_ = T_bill_calcul_flag;
  sLine[0x18] = '\0';
  sLine[0x19] = '\0';
  sLine[0x1a] = '\0';
  sLine[0x1b] = '\0';
  sLine[0xe0] = '\x04';
  sLine[0xe1] = '\0';
  sLine[0xe2] = '\0';
  sLine[0xe3] = '\0';
  sLine[0xe4] = '\0';
  sLine[0xe5] = '\0';
  sLine[0xe6] = '\0';
  sLine[0xe7] = '\0';
  sLine[0x110] = '\0';
  sLine[0x111] = '\0';
  sLine[0x112] = '\0';
  sLine[0x113] = '\0';
  sLine[0x128] = '\0';
  sLine[0x129] = '\0';
  sLine[0x12a] = '\0';
  sLine[299] = '\0';
  sLine[300] = '\0';
  sLine[0x12d] = '\0';
  sLine[0x12e] = '\0';
  sLine[0x12f] = '\0';
  sLine[0x158] = '\0';
  sLine[0x159] = '\0';
  sLine[0x15a] = '\0';
  sLine[0x15b] = '\0';
  sLine[0x170] = '\0';
  sLine[0x171] = '\0';
  sLine[0x172] = '\0';
  sLine[0x173] = '\0';
  sLine[0x174] = '\0';
  sLine[0x175] = '\0';
  sLine[0x176] = '\0';
  sLine[0x177] = '\0';
  sLine[0xe8] = '\x02';
  sLine[0xe9] = '\0';
  sLine[0xea] = '\0';
  sLine[0xeb] = '\0';
  sLine[0xec] = '\0';
  sLine[0xed] = '\0';
  sLine[0xee] = '\0';
  sLine[0xef] = '\0';
  sLine[0x114] = '\0';
  sLine[0x115] = '\0';
  sLine[0x116] = '\0';
  sLine[0x117] = '\0';
  sLine[0x130] = '\0';
  sLine[0x131] = '\0';
  sLine[0x132] = '\0';
  sLine[0x133] = '\0';
  sLine[0x134] = '\0';
  sLine[0x135] = '\0';
  sLine[0x136] = '\0';
  sLine[0x137] = '\0';
  sLine[0x15c] = '\0';
  sLine[0x15d] = '\0';
  sLine[0x15e] = '\0';
  sLine[0x15f] = '\0';
  sLine[0x178] = '\0';
  sLine[0x179] = '\0';
  sLine[0x17a] = '\0';
  sLine[0x17b] = '\0';
  sLine[0x17c] = '\0';
  sLine[0x17d] = '\0';
  sLine[0x17e] = '\0';
  sLine[0x17f] = '\0';
  sLine[0xf0] = '\x02';
  sLine[0xf1] = '\0';
  sLine[0xf2] = '\0';
  sLine[0xf3] = '\0';
  sLine[0xf4] = '\0';
  sLine[0xf5] = '\0';
  sLine[0xf6] = '\0';
  sLine[0xf7] = '\0';
  sLine[0x118] = '\0';
  sLine[0x119] = '\0';
  sLine[0x11a] = '\0';
  sLine[0x11b] = '\0';
  sLine[0x138] = '\0';
  sLine[0x139] = '\0';
  sLine[0x13a] = '\0';
  sLine[0x13b] = '\0';
  sLine[0x13c] = '\0';
  sLine[0x13d] = '\0';
  sLine[0x13e] = '\0';
  sLine[0x13f] = '\0';
  sLine[0x160] = '\0';
  sLine[0x161] = '\0';
  sLine[0x162] = '\0';
  sLine[0x163] = '\0';
  sLine[0x1d8] = '\0';
  sLine[0x1d9] = '\0';
  sLine[0x1e4] = '\0';
  sLine[0x1e5] = '\0';
  sLine[0x1da] = '\0';
  sLine[0x1db] = '\0';
  sLine[0x1e6] = '\0';
  sLine[0x1e7] = '\0';
  sLine._72_8_ = sLine + 0xb0;
  sLine[0x1e2] = '\0';
  sLine[0x1e3] = '\0';
  sLine._216_8_ = T_ROUTING_CODE;
  sLine[0x1d4] = '\0';
  sLine[0x1d5] = '\0';
  sLine[0x1e0] = '\0';
  sLine[0x1e1] = '\0';
  sLine._80_8_ = sLine + 0xe0;
  sLine[0x1d6] = '\0';
  sLine[0x1d7] = '\0';
  sLine[0x180] = '\0';
  sLine[0x181] = '\0';
  sLine[0x182] = '\0';
  sLine[0x183] = '\0';
  sLine[0x184] = '\0';
  sLine[0x185] = '\0';
  sLine[0x186] = '\0';
  sLine[0x187] = '\0';
  sLine[0xf8] = '\x03';
  sLine[0xf9] = '\x10';
  sLine[0xfa] = '\0';
  sLine[0xfb] = '\0';
  sLine[0xfc] = '\0';
  sLine[0xfd] = '\0';
  sLine[0xfe] = '\0';
  sLine[0xff] = '\0';
  sLine._88_8_ = sLine + 0x110;
  sLine[0x11c] = '\0';
  sLine[0x11d] = '\0';
  sLine[0x11e] = '\0';
  sLine[0x11f] = '\0';
  sLine[0x140] = '\0';
  sLine[0x141] = '\0';
  sLine[0x142] = '\0';
  sLine[0x143] = '\0';
  sLine[0x144] = '\0';
  sLine[0x145] = '\0';
  sLine[0x146] = '\0';
  sLine[0x147] = '\0';
  sLine[0x164] = '\0';
  sLine[0x165] = '\0';
  sLine[0x166] = '\0';
  sLine[0x167] = '\0';
  sLine._96_8_ = sLine + 0x128;
  sLine[0x188] = '\0';
  sLine[0x189] = '\0';
  sLine[0x18a] = '\0';
  sLine[0x18b] = '\0';
  sLine[0x18c] = '\0';
  sLine[0x18d] = '\0';
  sLine[0x18e] = '\0';
  sLine[399] = '\0';
  sLine[0x100] = '\a';
  sLine[0x101] = '\0';
  sLine[0x102] = '\0';
  sLine[0x103] = '\0';
  sLine[0x104] = '\0';
  sLine[0x105] = '\0';
  sLine[0x106] = '\0';
  sLine[0x107] = '\0';
  sLine._104_8_ = sLine + 0x158;
  sLine[0x120] = '\0';
  sLine[0x121] = '\0';
  sLine[0x122] = '\0';
  sLine[0x123] = '\0';
  sLine[0x148] = '\0';
  sLine[0x149] = '\0';
  sLine[0x14a] = '\0';
  sLine[0x14b] = '\0';
  sLine[0x14c] = '\0';
  sLine[0x14d] = '\0';
  sLine[0x14e] = '\0';
  sLine[0x14f] = '\0';
  sLine[0x168] = '\0';
  sLine[0x169] = '\0';
  sLine[0x16a] = '\0';
  sLine[0x16b] = '\0';
  sLine._112_8_ = sLine + 0x170;
  sLine[400] = '\0';
  sLine[0x191] = '\0';
  sLine[0x192] = '\0';
  sLine[0x193] = '\0';
  sLine[0x194] = '\0';
  sLine[0x195] = '\0';
  sLine[0x196] = '\0';
  sLine[0x197] = '\0';
  sLine[0x108] = '\a';
  sLine[0x109] = '\0';
  sLine[0x10a] = '\0';
  sLine[0x10b] = '\0';
  sLine[0x10c] = '\0';
  sLine[0x10d] = '\0';
  sLine[0x10e] = '\0';
  sLine[0x10f] = '\0';
  sLine._120_8_ = sLine + 0x1a0;
  sLine[0x124] = '\0';
  sLine[0x125] = '\0';
  sLine[0x126] = '\0';
  sLine[0x127] = '\0';
  sLine[0x150] = '\0';
  sLine[0x151] = '\0';
  sLine[0x152] = '\0';
  sLine[0x153] = '\0';
  sLine[0x154] = '\0';
  sLine[0x155] = '\0';
  sLine[0x156] = '\0';
  sLine[0x157] = '\0';
  sLine[0x16c] = '\0';
  sLine[0x16d] = '\0';
  sLine[0x16e] = '\0';
  sLine[0x16f] = '\0';
  sLine[0x198] = '\0';
  sLine[0x199] = '\0';
  sLine[0x19a] = '\0';
  sLine[0x19b] = '\0';
  sLine[0x19c] = '\0';
  sLine[0x19d] = '\0';
  sLine[0x19e] = '\0';
  sLine[0x19f] = '\0';
  sLine._128_8_ = sLine + 0x1d0;
  sLine._136_8_ = sLine + 0x1dc;
  sLine._192_8_ = T_reversal_mode;
  sLine._208_8_ = T_CAPTURE_CODE;
  sqlcxt((long)nIndiceCtx * 0x10 + 0x713948,&sqlctx,sLine,&sqlfpn);
  if (sqlca.sqlcode < 0) {
    tlvcpy(sTlvBuffer,(char *)puVar3,(uint)T_tlv_auth.len);
    sprintf(sLine,"%.40s",sqlca.sqlerrm.sqlerrmc);
    trace_event(sLine,1);
    trace_event("End ReversalProcedure(SYSTEM_MALFUNCTION)",5);
    response_code = 0x38d;
  }
  else {
    tlvcpy(sTlvBuffer,(char *)puVar3,(uint)T_tlv_auth.len);
    if (T_reversal_mode[0] == 'R') {
      *(undefined4 *)sCaptureCode = T_CAPTURE_CODE._0_4_;
      *(undefined2 *)(sCaptureCode + 4) = T_CAPTURE_CODE._4_2_;
    }
    else {
      fprintf(stderr,"\n REVERSAL MODE = [%.1s] \n",T_reversal_mode);
      *(undefined4 *)sRoutingCode = T_ROUTING_CODE._0_4_;
      *(undefined2 *)(sRoutingCode + 4) = T_ROUTING_CODE._4_2_;
    }
    sprintf(sLine,"End ReversalProcedure(%d)",(ulong)(uint)response_code);
    trace_event(sLine,5);
  }
  return response_code;
}



// WARNING: Unknown calling convention

int InsertionAuthoActivity(int nIndiceCtx,char *sTlvBuffer)

{
  size_t __n;
  long lVar1;
  ulong uVar2;
  uint uVar3;
  char *pcVar4;
  uchar *puVar5;
  bool bVar6;
  byte bVar7;
  uchar auStack_3014 [3352];
  int response_code;
  anon_struct_10_2_43c7b5cf T_tlv_warning;
  sqlca sqlca;
  char sLine [512];
  char buffer_dump [4097];
  anon_struct_4100_2_43c7b5cf T_tlv_auth;
  
  bVar7 = 0;
  trace_event("Start InsertionAuthoActivity () ",5);
  pcVar4 = buffer_dump;
  for (lVar1 = 0x200; lVar1 != 0; lVar1 = lVar1 + -1) {
    pcVar4[0] = '\0';
    pcVar4[1] = '\0';
    pcVar4[2] = '\0';
    pcVar4[3] = '\0';
    pcVar4[4] = '\0';
    pcVar4[5] = '\0';
    pcVar4[6] = '\0';
    pcVar4[7] = '\0';
    pcVar4 = pcVar4 + (ulong)bVar7 * -0x10 + 8;
  }
  uVar3 = 0xfff;
  *pcVar4 = '\0';
  puVar5 = T_tlv_auth.arr + 2;
  T_tlv_auth.arr[0] = '\0';
  T_tlv_auth.arr[1] = '\0';
  bVar6 = ((ulong)puVar5 & 4) != 0;
  if (bVar6) {
    T_tlv_auth.arr[2] = '\0';
    T_tlv_auth.arr[3] = '\0';
    T_tlv_auth.arr[4] = '\0';
    T_tlv_auth.arr[5] = '\0';
    uVar3 = 0xffb;
    puVar5 = T_tlv_auth.arr + 6;
  }
  for (uVar2 = (ulong)(uVar3 >> 3); uVar2 != 0; uVar2 = uVar2 - 1) {
    puVar5[0] = '\0';
    puVar5[1] = '\0';
    puVar5[2] = '\0';
    puVar5[3] = '\0';
    puVar5[4] = '\0';
    puVar5[5] = '\0';
    puVar5[6] = '\0';
    puVar5[7] = '\0';
    puVar5 = puVar5 + (ulong)bVar7 * -0x10 + 8;
  }
  if (!bVar6) {
    puVar5[0] = '\0';
    puVar5[1] = '\0';
    puVar5[2] = '\0';
    puVar5[3] = '\0';
    puVar5 = puVar5 + 4;
  }
  puVar5[0] = '\0';
  puVar5[1] = '\0';
  puVar5[2] = '\0';
  T_tlv_warning.arr[0] = '\0';
  T_tlv_warning.arr[1] = '\0';
  T_tlv_warning.arr[2] = '\0';
  T_tlv_warning.arr[3] = '\0';
  T_tlv_warning.arr[4] = '\0';
  T_tlv_warning.arr[5] = '\0';
  T_tlv_warning.arr[6] = '\0';
  T_tlv_auth.len = 0;
  T_tlv_warning.len = 0;
  __n = strlen(sTlvBuffer);
  memcpy(T_tlv_auth.arr,sTlvBuffer,__n);
  T_tlv_auth.len = (ushort)__n;
  sLine._40_8_ = &sqlca;
  sLine._56_8_ = &sqladt;
  sLine[0x170] = '\0';
  sLine[0x171] = '\0';
  sLine[0x178] = '\0';
  sLine[0x179] = '\0';
  sLine._64_8_ = &sqltds;
  sLine[0x16] = '\0';
  sLine[0x17] = '\x11';
  sLine[0x172] = '\0';
  sLine[0x173] = '\0';
  sLine._48_8_ = s_begin__response_code____PCRD_AUT_004cb640;
  sLine[0x17a] = '\0';
  sLine[0x17b] = '\0';
  response_code = 0x38d;
  sLine[0] = '\f';
  sLine[1] = '\0';
  sLine[2] = '\0';
  sLine[3] = '\0';
  sLine[4] = '\0';
  sLine[5] = '\0';
  sLine[6] = '\0';
  sLine[7] = '\0';
  sLine._32_8_ = sqlcud0;
  sLine._176_8_ = &response_code;
  sLine[8] = '\x03';
  sLine[9] = '\0';
  sLine[10] = '\0';
  sLine[0xb] = '\0';
  sLine[0xc] = '\x01';
  sLine[0xd] = '\0';
  sLine[0xe] = '\0';
  sLine[0xf] = '\0';
  sLine[0x10] = '\x05';
  sLine[0x11] = '\0';
  sLine[0x12] = '\0';
  sLine[0x13] = '\0';
  sLine[0x18] = '\0';
  sLine[0x19] = '\0';
  sLine[0x1a] = '\0';
  sLine[0x1b] = '\0';
  sLine[0xd0] = '\x04';
  sLine[0xd1] = '\0';
  sLine[0xd2] = '\0';
  sLine[0xd3] = '\0';
  sLine[0xd4] = '\0';
  sLine[0xd5] = '\0';
  sLine[0xd6] = '\0';
  sLine[0xd7] = '\0';
  sLine[0xf0] = '\0';
  sLine[0xf1] = '\0';
  sLine[0xf2] = '\0';
  sLine[0xf3] = '\0';
  sLine[0x100] = '\0';
  sLine[0x101] = '\0';
  sLine[0x102] = '\0';
  sLine[0x103] = '\0';
  sLine[0x104] = '\0';
  sLine[0x105] = '\0';
  sLine[0x106] = '\0';
  sLine[0x107] = '\0';
  sLine[0x120] = '\0';
  sLine[0x121] = '\0';
  sLine[0x122] = '\0';
  sLine[0x123] = '\0';
  sLine[0x130] = '\0';
  sLine[0x131] = '\0';
  sLine[0x132] = '\0';
  sLine[0x133] = '\0';
  sLine[0x134] = '\0';
  sLine[0x135] = '\0';
  sLine[0x136] = '\0';
  sLine[0x137] = '\0';
  sLine[0xd8] = '\x03';
  sLine[0xd9] = '\x10';
  sLine[0xda] = '\0';
  sLine[0xdb] = '\0';
  sLine[0xdc] = '\0';
  sLine[0xdd] = '\0';
  sLine[0xde] = '\0';
  sLine[0xdf] = '\0';
  sLine[0xf4] = '\0';
  sLine[0xf5] = '\0';
  sLine[0xf6] = '\0';
  sLine[0xf7] = '\0';
  sLine[0x108] = '\0';
  sLine[0x109] = '\0';
  sLine[0x10a] = '\0';
  sLine[0x10b] = '\0';
  sLine[0x10c] = '\0';
  sLine[0x10d] = '\0';
  sLine[0x10e] = '\0';
  sLine[0x10f] = '\0';
  sLine[0x124] = '\0';
  sLine[0x125] = '\0';
  sLine[0x126] = '\0';
  sLine[0x127] = '\0';
  sLine[0x138] = '\0';
  sLine[0x139] = '\0';
  sLine[0x13a] = '\0';
  sLine[0x13b] = '\0';
  sLine[0x13c] = '\0';
  sLine[0x13d] = '\0';
  sLine[0x13e] = '\0';
  sLine[0x13f] = '\0';
  sLine[0xe0] = '\t';
  sLine[0xe1] = '\0';
  sLine[0xe2] = '\0';
  sLine[0xe3] = '\0';
  sLine[0xe4] = '\0';
  sLine[0xe5] = '\0';
  sLine[0xe6] = '\0';
  sLine[0xe7] = '\0';
  sLine[0xf8] = '\0';
  sLine[0xf9] = '\0';
  sLine[0xfa] = '\0';
  sLine[0xfb] = '\0';
  sLine[0x110] = '\0';
  sLine[0x111] = '\0';
  sLine[0x112] = '\0';
  sLine[0x113] = '\0';
  sLine[0x114] = '\0';
  sLine[0x115] = '\0';
  sLine[0x116] = '\0';
  sLine[0x117] = '\0';
  sLine[0x128] = '\0';
  sLine[0x129] = '\0';
  sLine[0x12a] = '\0';
  sLine[299] = '\0';
  sLine[0x174] = '\0';
  sLine[0x175] = '\0';
  sLine[0x140] = '\0';
  sLine[0x141] = '\0';
  sLine[0x142] = '\0';
  sLine[0x143] = '\0';
  sLine[0x144] = '\0';
  sLine[0x145] = '\0';
  sLine[0x146] = '\0';
  sLine[0x147] = '\0';
  sLine[0x17c] = '\0';
  sLine[0x17d] = '\0';
  sLine._72_8_ = sLine + 0xb0;
  sLine._80_8_ = sLine + 0xd0;
  sLine._88_8_ = sLine + 0xf0;
  sLine._96_8_ = sLine + 0x100;
  sLine._104_8_ = sLine + 0x120;
  sLine._112_8_ = sLine + 0x130;
  sLine._120_8_ = sLine + 0x150;
  sLine._128_8_ = sLine + 0x170;
  sLine._136_8_ = sLine + 0x178;
  sLine._184_8_ = &T_tlv_auth;
  sLine._192_8_ = &T_tlv_warning;
  sqlcxt((long)nIndiceCtx * 0x10 + 0x713948,&sqlctx,sLine,&sqlfpn);
  if (sqlca.sqlcode < 0) {
    sprintf(sLine,"%.40s",sqlca.sqlerrm.sqlerrmc);
    trace_event(sLine,1);
    trace_event("End InsertionAuthoActivity (SYSTEM_MALFUNCTION)",5);
    response_code = 0x38d;
  }
  else {
    uVar2 = 0;
    if (response_code != 0) {
      memcpy(buffer_dump,T_tlv_auth.arr,(ulong)T_tlv_auth.len);
      PrintTlvBuffer(buffer_dump);
      uVar2 = (ulong)(uint)response_code;
    }
    sprintf(sLine,"End InsertionAuthoActivity (%d,%.6s)",uVar2,T_tlv_warning.arr);
    trace_event(sLine,5);
  }
  return response_code;
}



// WARNING: Unknown calling convention

int UpdateAuthoActivity(int nIndiceCtx,char *sTlvBuffer)

{
  size_t __n;
  ulong uVar1;
  uchar *puVar2;
  uint uVar3;
  bool bVar4;
  byte bVar5;
  uchar auStack_3014 [7464];
  int response_code;
  anon_struct_10_2_43c7b5cf T_tlv_warning;
  sqlca sqlca;
  char sLine [512];
  anon_struct_4100_2_43c7b5cf T_tlv_auth;
  
  bVar5 = 0;
  trace_event("Start UpdateAuthoActivity () ",5);
  puVar2 = T_tlv_auth.arr + 2;
  uVar3 = 0xfff;
  T_tlv_auth.arr[0] = '\0';
  T_tlv_auth.arr[1] = '\0';
  bVar4 = ((ulong)puVar2 & 4) != 0;
  if (bVar4) {
    T_tlv_auth.arr[2] = '\0';
    T_tlv_auth.arr[3] = '\0';
    T_tlv_auth.arr[4] = '\0';
    T_tlv_auth.arr[5] = '\0';
    uVar3 = 0xffb;
    puVar2 = T_tlv_auth.arr + 6;
  }
  for (uVar1 = (ulong)(uVar3 >> 3); uVar1 != 0; uVar1 = uVar1 - 1) {
    puVar2[0] = '\0';
    puVar2[1] = '\0';
    puVar2[2] = '\0';
    puVar2[3] = '\0';
    puVar2[4] = '\0';
    puVar2[5] = '\0';
    puVar2[6] = '\0';
    puVar2[7] = '\0';
    puVar2 = puVar2 + (ulong)bVar5 * -0x10 + 8;
  }
  if (!bVar4) {
    puVar2[0] = '\0';
    puVar2[1] = '\0';
    puVar2[2] = '\0';
    puVar2[3] = '\0';
    puVar2 = puVar2 + 4;
  }
  puVar2[0] = '\0';
  puVar2[1] = '\0';
  puVar2[2] = '\0';
  T_tlv_warning.len = 0;
  T_tlv_warning.arr[4] = '\0';
  T_tlv_warning.arr[5] = '\0';
  T_tlv_auth.len = 0;
  T_tlv_warning.arr[0] = '\0';
  T_tlv_warning.arr[1] = '\0';
  T_tlv_warning.arr[2] = '\0';
  T_tlv_warning.arr[3] = '\0';
  T_tlv_warning.arr[6] = '\0';
  __n = strlen(sTlvBuffer);
  memcpy(T_tlv_auth.arr,sTlvBuffer,__n);
  T_tlv_auth.len = (ushort)__n;
  trace_event(" => Structure TLV avant Update <== ",4);
  sLine._56_8_ = &sqladt;
  sLine[0x16] = '\0';
  sLine[0x17] = '\x11';
  sLine[0x170] = '\0';
  sLine[0x171] = '\0';
  sLine._64_8_ = &sqltds;
  sLine[0x178] = '\0';
  sLine[0x179] = '\0';
  sLine[0x172] = '\0';
  sLine[0x173] = '\0';
  sLine[0x17a] = '\0';
  sLine[0x17b] = '\0';
  sLine._48_8_ = s_begin__response_code____PCRD_AUT_004cb738;
  response_code = 0x38d;
  sLine[0] = '\f';
  sLine[1] = '\0';
  sLine[2] = '\0';
  sLine[3] = '\0';
  sLine[4] = '\0';
  sLine[5] = '\0';
  sLine[6] = '\0';
  sLine[7] = '\0';
  sLine._32_8_ = sqlcud0;
  sLine._176_8_ = &response_code;
  sLine[8] = '\x03';
  sLine[9] = '\0';
  sLine[10] = '\0';
  sLine[0xb] = '\0';
  sLine[0xc] = '\x01';
  sLine[0xd] = '\0';
  sLine[0xe] = '\0';
  sLine[0xf] = '\0';
  sLine[0x10] = ' ';
  sLine[0x11] = '\0';
  sLine[0x12] = '\0';
  sLine[0x13] = '\0';
  sLine[0x18] = '\0';
  sLine[0x19] = '\0';
  sLine[0x1a] = '\0';
  sLine[0x1b] = '\0';
  sLine[0xd0] = '\x04';
  sLine[0xd1] = '\0';
  sLine[0xd2] = '\0';
  sLine[0xd3] = '\0';
  sLine[0xd4] = '\0';
  sLine[0xd5] = '\0';
  sLine[0xd6] = '\0';
  sLine[0xd7] = '\0';
  sLine[0xf0] = '\0';
  sLine[0xf1] = '\0';
  sLine[0xf2] = '\0';
  sLine[0xf3] = '\0';
  sLine[0x100] = '\0';
  sLine[0x101] = '\0';
  sLine[0x102] = '\0';
  sLine[0x103] = '\0';
  sLine[0x104] = '\0';
  sLine[0x105] = '\0';
  sLine[0x106] = '\0';
  sLine[0x107] = '\0';
  sLine[0x120] = '\0';
  sLine[0x121] = '\0';
  sLine[0x122] = '\0';
  sLine[0x123] = '\0';
  sLine[0x130] = '\0';
  sLine[0x131] = '\0';
  sLine[0x132] = '\0';
  sLine[0x133] = '\0';
  sLine[0x134] = '\0';
  sLine[0x135] = '\0';
  sLine[0x136] = '\0';
  sLine[0x137] = '\0';
  sLine[0xd8] = '\x03';
  sLine[0xd9] = '\x10';
  sLine[0xda] = '\0';
  sLine[0xdb] = '\0';
  sLine[0xdc] = '\0';
  sLine[0xdd] = '\0';
  sLine[0xde] = '\0';
  sLine[0xdf] = '\0';
  sLine[0xf4] = '\0';
  sLine[0xf5] = '\0';
  sLine[0xf6] = '\0';
  sLine[0xf7] = '\0';
  sLine[0x108] = '\0';
  sLine[0x109] = '\0';
  sLine[0x10a] = '\0';
  sLine[0x10b] = '\0';
  sLine[0x10c] = '\0';
  sLine[0x10d] = '\0';
  sLine[0x10e] = '\0';
  sLine[0x10f] = '\0';
  sLine[0x124] = '\0';
  sLine[0x125] = '\0';
  sLine[0x126] = '\0';
  sLine[0x127] = '\0';
  sLine[0x138] = '\0';
  sLine[0x139] = '\0';
  sLine[0x13a] = '\0';
  sLine[0x13b] = '\0';
  sLine[0x13c] = '\0';
  sLine[0x13d] = '\0';
  sLine[0x13e] = '\0';
  sLine[0x13f] = '\0';
  sLine[0xe0] = '\t';
  sLine[0xe1] = '\0';
  sLine[0xe2] = '\0';
  sLine[0xe3] = '\0';
  sLine[0xe4] = '\0';
  sLine[0xe5] = '\0';
  sLine[0xe6] = '\0';
  sLine[0xe7] = '\0';
  sLine[0xf8] = '\0';
  sLine[0xf9] = '\0';
  sLine[0xfa] = '\0';
  sLine[0xfb] = '\0';
  sLine[0x110] = '\0';
  sLine[0x111] = '\0';
  sLine[0x112] = '\0';
  sLine[0x113] = '\0';
  sLine[0x114] = '\0';
  sLine[0x115] = '\0';
  sLine[0x116] = '\0';
  sLine[0x117] = '\0';
  sLine[0x128] = '\0';
  sLine[0x129] = '\0';
  sLine[0x12a] = '\0';
  sLine[299] = '\0';
  sLine[0x140] = '\0';
  sLine[0x141] = '\0';
  sLine[0x142] = '\0';
  sLine[0x143] = '\0';
  sLine[0x144] = '\0';
  sLine[0x145] = '\0';
  sLine[0x146] = '\0';
  sLine[0x147] = '\0';
  sLine[0x17c] = '\0';
  sLine[0x17d] = '\0';
  sLine[0x174] = '\0';
  sLine[0x175] = '\0';
  sLine._72_8_ = sLine + 0xb0;
  sLine._80_8_ = sLine + 0xd0;
  sLine._88_8_ = sLine + 0xf0;
  sLine._96_8_ = sLine + 0x100;
  sLine._104_8_ = sLine + 0x120;
  sLine._112_8_ = sLine + 0x130;
  sLine._120_8_ = sLine + 0x150;
  sLine._128_8_ = sLine + 0x170;
  sLine._136_8_ = sLine + 0x178;
  sLine._40_8_ = &sqlca;
  sLine._184_8_ = &T_tlv_auth;
  sLine._192_8_ = &T_tlv_warning;
  sqlcxt((long)nIndiceCtx * 0x10 + 0x713948,&sqlctx,sLine,&sqlfpn);
  if (sqlca.sqlcode < 0) {
    sprintf(sLine,"%.40s",sqlca.sqlerrm.sqlerrmc);
    trace_event(sLine,1);
    trace_event("End UpdateAuthoActivity (SYSTEM_MALFUNCTION)",5);
    response_code = 0x38d;
  }
  else {
    sTlvBuffer[0] = '\0';
    sTlvBuffer[1] = '\0';
    sTlvBuffer[2] = '\0';
    sTlvBuffer[3] = '\0';
    sTlvBuffer[4] = '\0';
    sTlvBuffer[5] = '\0';
    sTlvBuffer[6] = '\0';
    sTlvBuffer[7] = '\0';
    memcpy(sTlvBuffer,T_tlv_auth.arr,(ulong)T_tlv_auth.len);
    sprintf(sLine,"End UpdateAuthoActivity (%d,%.6s)",(ulong)(uint)response_code,T_tlv_warning.arr);
    trace_event(sLine,5);
  }
  return response_code;
}



// WARNING: Unknown calling convention

int UpdateAuthoActivityForAtmAdvice(int nIndiceCtx,char *sTlvBuffer,char *Pstatus)

{
  size_t sVar1;
  ulong uVar2;
  uchar *puVar3;
  uint uVar4;
  bool bVar5;
  byte bVar6;
  uchar auStack_3014 [7448];
  int response_code;
  anon_struct_6_2_43c7b5cf T_status;
  anon_struct_10_2_43c7b5cf T_tlv_warning;
  sqlca sqlca;
  char sLine [512];
  anon_struct_4100_2_43c7b5cf T_tlv_auth;
  
  bVar6 = 0;
  trace_event("Start UpdateAuthoActivityForAtmAdvice() ",5);
  puVar3 = T_tlv_auth.arr + 2;
  uVar4 = 0xfff;
  T_tlv_auth.arr[0] = '\0';
  T_tlv_auth.arr[1] = '\0';
  bVar5 = ((ulong)puVar3 & 4) != 0;
  if (bVar5) {
    T_tlv_auth.arr[2] = '\0';
    T_tlv_auth.arr[3] = '\0';
    T_tlv_auth.arr[4] = '\0';
    T_tlv_auth.arr[5] = '\0';
    uVar4 = 0xffb;
    puVar3 = T_tlv_auth.arr + 6;
  }
  for (uVar2 = (ulong)(uVar4 >> 3); uVar2 != 0; uVar2 = uVar2 - 1) {
    puVar3[0] = '\0';
    puVar3[1] = '\0';
    puVar3[2] = '\0';
    puVar3[3] = '\0';
    puVar3[4] = '\0';
    puVar3[5] = '\0';
    puVar3[6] = '\0';
    puVar3[7] = '\0';
    puVar3 = puVar3 + (ulong)bVar6 * -0x10 + 8;
  }
  if (!bVar5) {
    puVar3[0] = '\0';
    puVar3[1] = '\0';
    puVar3[2] = '\0';
    puVar3[3] = '\0';
    puVar3 = puVar3 + 4;
  }
  puVar3[0] = '\0';
  puVar3[1] = '\0';
  puVar3[2] = '\0';
  T_status.len = 0;
  T_tlv_warning.len = 0;
  T_tlv_warning.arr[4] = '\0';
  T_tlv_warning.arr[5] = '\0';
  T_status.arr[0] = '\0';
  T_status.arr[1] = '\0';
  T_tlv_auth.len = 0;
  T_tlv_warning.arr[0] = '\0';
  T_tlv_warning.arr[1] = '\0';
  T_tlv_warning.arr[2] = '\0';
  T_tlv_warning.arr[3] = '\0';
  T_tlv_warning.arr[6] = '\0';
  T_status.arr[2] = '\0';
  sVar1 = strlen(sTlvBuffer);
  memcpy(T_tlv_auth.arr,sTlvBuffer,sVar1);
  T_tlv_auth.len = (ushort)sVar1;
  sVar1 = strlen(Pstatus);
  memcpy(T_status.arr,Pstatus,sVar1);
  T_status.len = (ushort)sVar1;
  trace_event(" => Structure TLV avant Update <== ",4);
  PrintTlvBuffer(sTlvBuffer);
  sLine[0x17a] = '\0';
  sLine[0x17b] = '\0';
  sLine._56_8_ = &sqladt;
  sLine[0x16] = '\0';
  sLine[0x17] = '\x11';
  sLine[0x170] = '\0';
  sLine[0x171] = '\0';
  sLine._64_8_ = &sqltds;
  sLine[0x178] = '\0';
  sLine[0x179] = '\0';
  sLine[0x172] = '\0';
  sLine[0x173] = '\0';
  sLine._48_8_ = s_begin__response_code____PCRD_ATM_004cb838;
  response_code = 0x38d;
  sLine[0] = '\f';
  sLine[1] = '\0';
  sLine[2] = '\0';
  sLine[3] = '\0';
  sLine[4] = '\0';
  sLine[5] = '\0';
  sLine[6] = '\0';
  sLine[7] = '\0';
  sLine._32_8_ = sqlcud0;
  sLine._176_8_ = &response_code;
  sLine[8] = '\x04';
  sLine[9] = '\0';
  sLine[10] = '\0';
  sLine[0xb] = '\0';
  sLine[0xc] = '\x01';
  sLine[0xd] = '\0';
  sLine[0xe] = '\0';
  sLine[0xf] = '\0';
  sLine[0x10] = ';';
  sLine[0x11] = '\0';
  sLine[0x12] = '\0';
  sLine[0x13] = '\0';
  sLine[0x18] = '\0';
  sLine[0x19] = '\0';
  sLine[0x1a] = '\0';
  sLine[0x1b] = '\0';
  sLine[0xd0] = '\x04';
  sLine[0xd1] = '\0';
  sLine[0xd2] = '\0';
  sLine[0xd3] = '\0';
  sLine[0xd4] = '\0';
  sLine[0xd5] = '\0';
  sLine[0xd6] = '\0';
  sLine[0xd7] = '\0';
  sLine[0xf0] = '\0';
  sLine[0xf1] = '\0';
  sLine[0xf2] = '\0';
  sLine[0xf3] = '\0';
  sLine[0x100] = '\0';
  sLine[0x101] = '\0';
  sLine[0x102] = '\0';
  sLine[0x103] = '\0';
  sLine[0x104] = '\0';
  sLine[0x105] = '\0';
  sLine[0x106] = '\0';
  sLine[0x107] = '\0';
  sLine[0x120] = '\0';
  sLine[0x121] = '\0';
  sLine[0x122] = '\0';
  sLine[0x123] = '\0';
  sLine[0x130] = '\0';
  sLine[0x131] = '\0';
  sLine[0x132] = '\0';
  sLine[0x133] = '\0';
  sLine[0x134] = '\0';
  sLine[0x135] = '\0';
  sLine[0x136] = '\0';
  sLine[0x137] = '\0';
  sLine[0xd8] = '\x03';
  sLine[0xd9] = '\x10';
  sLine[0xda] = '\0';
  sLine[0xdb] = '\0';
  sLine[0xdc] = '\0';
  sLine[0xdd] = '\0';
  sLine[0xde] = '\0';
  sLine[0xdf] = '\0';
  sLine[0xf4] = '\0';
  sLine[0xf5] = '\0';
  sLine[0xf6] = '\0';
  sLine[0xf7] = '\0';
  sLine[0x108] = '\0';
  sLine[0x109] = '\0';
  sLine[0x10a] = '\0';
  sLine[0x10b] = '\0';
  sLine[0x10c] = '\0';
  sLine[0x10d] = '\0';
  sLine[0x10e] = '\0';
  sLine[0x10f] = '\0';
  sLine[0x124] = '\0';
  sLine[0x125] = '\0';
  sLine[0x126] = '\0';
  sLine[0x127] = '\0';
  sLine[0x138] = '\0';
  sLine[0x139] = '\0';
  sLine[0x13a] = '\0';
  sLine[0x13b] = '\0';
  sLine[0x13c] = '\0';
  sLine[0x13d] = '\0';
  sLine[0x13e] = '\0';
  sLine[0x13f] = '\0';
  sLine[0xe0] = '\t';
  sLine[0xe1] = '\0';
  sLine[0xe2] = '\0';
  sLine[0xe3] = '\0';
  sLine[0xe4] = '\0';
  sLine[0xe5] = '\0';
  sLine[0xe6] = '\0';
  sLine[0xe7] = '\0';
  sLine[0xf8] = '\0';
  sLine[0xf9] = '\0';
  sLine[0xfa] = '\0';
  sLine[0xfb] = '\0';
  sLine[0x110] = '\0';
  sLine[0x111] = '\0';
  sLine[0x112] = '\0';
  sLine[0x113] = '\0';
  sLine[0x114] = '\0';
  sLine[0x115] = '\0';
  sLine[0x116] = '\0';
  sLine[0x117] = '\0';
  sLine[0x128] = '\0';
  sLine[0x129] = '\0';
  sLine[0x12a] = '\0';
  sLine[299] = '\0';
  sLine[0x140] = '\0';
  sLine[0x141] = '\0';
  sLine[0x142] = '\0';
  sLine[0x143] = '\0';
  sLine[0x144] = '\0';
  sLine[0x145] = '\0';
  sLine[0x146] = '\0';
  sLine[0x147] = '\0';
  sLine[0x17e] = '\0';
  sLine[0x17f] = '\0';
  sLine._72_8_ = sLine + 0xb0;
  sLine[0x174] = '\0';
  sLine[0x175] = '\0';
  sLine._80_8_ = sLine + 0xd0;
  sLine[0x17c] = '\0';
  sLine[0x17d] = '\0';
  sLine[0xe8] = '\x05';
  sLine[0xe9] = '\0';
  sLine[0xea] = '\0';
  sLine[0xeb] = '\0';
  sLine[0xec] = '\0';
  sLine[0xed] = '\0';
  sLine[0xee] = '\0';
  sLine[0xef] = '\0';
  sLine[0xfc] = '\0';
  sLine[0xfd] = '\0';
  sLine[0xfe] = '\0';
  sLine[0xff] = '\0';
  sLine._88_8_ = sLine + 0xf0;
  sLine[0x118] = '\0';
  sLine[0x119] = '\0';
  sLine[0x11a] = '\0';
  sLine[0x11b] = '\0';
  sLine[0x11c] = '\0';
  sLine[0x11d] = '\0';
  sLine[0x11e] = '\0';
  sLine[0x11f] = '\0';
  sLine._96_8_ = sLine + 0x100;
  sLine[300] = '\0';
  sLine[0x12d] = '\0';
  sLine[0x12e] = '\0';
  sLine[0x12f] = '\0';
  sLine[0x148] = '\0';
  sLine[0x149] = '\0';
  sLine[0x14a] = '\0';
  sLine[0x14b] = '\0';
  sLine[0x14c] = '\0';
  sLine[0x14d] = '\0';
  sLine[0x14e] = '\0';
  sLine[0x14f] = '\0';
  sLine[0x176] = '\0';
  sLine[0x177] = '\0';
  sLine._104_8_ = sLine + 0x120;
  sLine._112_8_ = sLine + 0x130;
  sLine._120_8_ = sLine + 0x150;
  sLine._128_8_ = sLine + 0x170;
  sLine._136_8_ = sLine + 0x178;
  sLine._40_8_ = &sqlca;
  sLine._184_8_ = &T_tlv_auth;
  sLine._192_8_ = &T_tlv_warning;
  sLine._200_8_ = &T_status;
  sqlcxt((long)nIndiceCtx * 0x10 + 0x713948,&sqlctx,sLine,&sqlfpn);
  if (sqlca.sqlcode < 0) {
    sprintf(sLine,"%.40s",sqlca.sqlerrm.sqlerrmc);
    trace_event(sLine,1);
    trace_event("End UpdateAuthoActivityForATmAdvice (SYSTEM_MALFUNCTION)",5);
    response_code = 0x38d;
  }
  else {
    sprintf(sLine,"End UpdateAuthoActivityForAtmAdvice (%d,%.6s)",(ulong)(uint)response_code,
            T_tlv_warning.arr);
    trace_event(sLine,5);
  }
  return response_code;
}



// WARNING: Unknown calling convention

int format_card_from_pan(char *card,char *pan)

{
  size_t sVar1;
  char V_card_number [13];
  undefined1 auStack_1b [3];
  
  builtin_strncpy(V_card_number,"000000000000",0xc);
  sVar1 = strlen(pan);
  if (sVar1 < 0xd) {
    memcpy(auStack_1b + -sVar1,pan,sVar1 - 1);
  }
  else {
    V_card_number._0_8_ = *(undefined8 *)(pan + (sVar1 - 0xd));
    V_card_number._8_4_ = *(undefined4 *)(pan + (sVar1 - 0xd) + 8);
  }
  *(undefined8 *)card = V_card_number._0_8_;
  *(undefined4 *)(card + 8) = V_card_number._8_4_;
  return 0;
}



// WARNING: Unknown calling convention

int TextError(char *err_code,char *sMsgErr)

{
  int iVar1;
  int iVar2;
  t_response *ptVar3;
  char ligne [512];
  
  iVar2 = 0;
  ptVar3 = hsm_response;
  do {
    iVar1 = memcmp(ptVar3->reponse,err_code,2);
    if (iVar1 == 0) {
      sprintf(ligne,"=> %s <=",hsm_response[iVar2].description);
      trace_event(ligne,5);
      strcpy(sMsgErr,hsm_response[iVar2].description);
      return 0;
    }
    iVar2 = iVar2 + 1;
    ptVar3 = ptVar3 + 1;
  } while (iVar2 != 0x1c);
  sprintf(sMsgErr,"=>UNKNOWN ERROR CODE %s <=",err_code);
  return 0;
}



// WARNING: Unknown calling convention

int command_AE(char *buffer_transmit,char *tmk_lmk,char *tpk_lmk)

{
  size_t sVar1;
  size_t __n;
  
  trace_event("Debut command_AE()",5);
  buffer_transmit[0] = 'A';
  buffer_transmit[1] = 'E';
  sVar1 = strlen(tmk_lmk);
  memcpy(buffer_transmit + 2,tmk_lmk,sVar1);
  sVar1 = strlen(tmk_lmk);
  __n = strlen(tpk_lmk);
  memcpy(buffer_transmit + 2 + sVar1,tpk_lmk,__n);
  trace_event("Fin   command_AE()",5);
  return 0;
}



// WARNING: Unknown calling convention

int command_AF(char *buffer_received,char *tpk_tmk,char *err_code)

{
  char cVar1;
  int iVar2;
  char Command [3];
  char sLine [512];
  
  trace_event("Start command_AF()",5);
  Command._0_2_ = *(undefined2 *)buffer_received;
  Command[2] = '\0';
  *(undefined4 *)err_code = *(undefined4 *)buffer_received;
  iVar2 = memcmp(Command,&DAT_004a40cc,2);
  if (iVar2 != 0) {
    return 0x7d1;
  }
  TextError(err_code + 2,sLine);
  iVar2 = memcmp(err_code + 2,"00",2);
  if (iVar2 != 0) {
    return 0x7d2;
  }
  cVar1 = buffer_received[4];
  if (cVar1 == 'U') {
LAB_0045ed70:
    trace_event("Triple DES Encryption Double Length",4);
    *(undefined8 *)tpk_tmk = *(undefined8 *)(buffer_received + 4);
    *(undefined8 *)(tpk_tmk + 8) = *(undefined8 *)(buffer_received + 0xc);
    *(undefined8 *)(tpk_tmk + 0x10) = *(undefined8 *)(buffer_received + 0x14);
    *(undefined8 *)(tpk_tmk + 0x18) = *(undefined8 *)(buffer_received + 0x1c);
  }
  else {
    if (cVar1 < 'V') {
      if (cVar1 != 'T') {
LAB_0045edb8:
        trace_event("Single DES Encryption Single Length",4);
        *(undefined8 *)tpk_tmk = *(undefined8 *)(buffer_received + 4);
        *(undefined8 *)(tpk_tmk + 8) = *(undefined8 *)(buffer_received + 0xc);
        goto LAB_0045ed56;
      }
    }
    else {
      if (cVar1 == 'X') goto LAB_0045ed70;
      if (cVar1 != 'Y') goto LAB_0045edb8;
    }
    trace_event("Triple DES Encryption Triple Length",4);
    *(undefined8 *)tpk_tmk = *(undefined8 *)(buffer_received + 4);
    *(undefined8 *)(tpk_tmk + 8) = *(undefined8 *)(buffer_received + 0xc);
    *(undefined8 *)(tpk_tmk + 0x10) = *(undefined8 *)(buffer_received + 0x14);
    *(undefined8 *)(tpk_tmk + 0x18) = *(undefined8 *)(buffer_received + 0x1c);
    *(undefined8 *)(tpk_tmk + 0x20) = *(undefined8 *)(buffer_received + 0x24);
    *(undefined8 *)(tpk_tmk + 0x28) = *(undefined8 *)(buffer_received + 0x2c);
  }
LAB_0045ed56:
  trace_event("End   command_AF(OK)",5);
  return 0;
}



// WARNING: Unknown calling convention

int command_AG(char *buffer_transmit,char *tmk_lmk,char *tak_lmk)

{
  size_t sVar1;
  size_t __n;
  
  trace_event("Debut command_AG()",5);
  buffer_transmit[0] = 'A';
  buffer_transmit[1] = 'G';
  sVar1 = strlen(tmk_lmk);
  memcpy(buffer_transmit + 2,tmk_lmk,sVar1);
  sVar1 = strlen(tmk_lmk);
  __n = strlen(tak_lmk);
  memcpy(buffer_transmit + 2 + sVar1,tak_lmk,__n);
  trace_event("Fin   command_AG()",5);
  return 0;
}



// WARNING: Unknown calling convention

int command_AH(char *buffer_received,char *tak_tmk,char *err_code)

{
  char cVar1;
  int iVar2;
  char Command [3];
  char sLine [512];
  
  trace_event("Start command_AH()",5);
  Command._0_2_ = *(undefined2 *)buffer_received;
  Command[2] = '\0';
  *(undefined4 *)err_code = *(undefined4 *)buffer_received;
  iVar2 = memcmp(Command,&DAT_004cb9ea,2);
  if (iVar2 != 0) {
    return 0x7d1;
  }
  TextError(err_code + 2,sLine);
  iVar2 = memcmp(err_code + 2,"00",2);
  if (iVar2 != 0) {
    return 0x7d2;
  }
  cVar1 = buffer_received[4];
  if (cVar1 == 'U') {
LAB_0045efb0:
    trace_event("Triple DES Encryption Double Length",4);
    *(undefined8 *)tak_tmk = *(undefined8 *)(buffer_received + 4);
    *(undefined8 *)(tak_tmk + 8) = *(undefined8 *)(buffer_received + 0xc);
    *(undefined8 *)(tak_tmk + 0x10) = *(undefined8 *)(buffer_received + 0x14);
    *(undefined8 *)(tak_tmk + 0x18) = *(undefined8 *)(buffer_received + 0x1c);
  }
  else {
    if (cVar1 < 'V') {
      if (cVar1 != 'T') {
LAB_0045eff8:
        trace_event("Single DES Encryption Single Length",4);
        *(undefined8 *)tak_tmk = *(undefined8 *)(buffer_received + 4);
        *(undefined8 *)(tak_tmk + 8) = *(undefined8 *)(buffer_received + 0xc);
        goto LAB_0045ef96;
      }
    }
    else {
      if (cVar1 == 'X') goto LAB_0045efb0;
      if (cVar1 != 'Y') goto LAB_0045eff8;
    }
    trace_event("Triple DES Encryption Triple Length",4);
    *(undefined8 *)tak_tmk = *(undefined8 *)(buffer_received + 4);
    *(undefined8 *)(tak_tmk + 8) = *(undefined8 *)(buffer_received + 0xc);
    *(undefined8 *)(tak_tmk + 0x10) = *(undefined8 *)(buffer_received + 0x14);
    *(undefined8 *)(tak_tmk + 0x18) = *(undefined8 *)(buffer_received + 0x1c);
    *(undefined8 *)(tak_tmk + 0x20) = *(undefined8 *)(buffer_received + 0x24);
    *(undefined8 *)(tak_tmk + 0x28) = *(undefined8 *)(buffer_received + 0x2c);
  }
LAB_0045ef96:
  trace_event("End   command_AH(OK)",5);
  return 0;
}



// WARNING: Unknown calling convention

int command_AS(char *buffer_transmit)

{
  trace_event("Debut command_AS()",5);
  buffer_transmit[0] = 'A';
  buffer_transmit[1] = 'S';
  trace_event("Fin   command_AS()",5);
  return 0;
}



// WARNING: Unknown calling convention

int command_AT(char *buffer_received,char *cvka_lmk,char *cvkb_lmk,char *check_valuea,
              char *check_valueb,char *err_code)

{
  int iVar1;
  int iVar2;
  char Command [3];
  char sLine [512];
  
  trace_event("Start command_AT()",5);
  cvka_lmk[0] = '\0';
  cvka_lmk[1] = '\0';
  cvka_lmk[2] = '\0';
  cvka_lmk[3] = '\0';
  cvka_lmk[4] = '\0';
  cvka_lmk[5] = '\0';
  cvka_lmk[6] = '\0';
  cvka_lmk[7] = '\0';
  cvka_lmk[8] = '\0';
  cvka_lmk[9] = '\0';
  cvka_lmk[10] = '\0';
  cvka_lmk[0xb] = '\0';
  cvka_lmk[0xc] = '\0';
  cvka_lmk[0xd] = '\0';
  cvka_lmk[0xe] = '\0';
  cvka_lmk[0xf] = '\0';
  cvkb_lmk[0] = '\0';
  cvkb_lmk[1] = '\0';
  cvkb_lmk[2] = '\0';
  cvkb_lmk[3] = '\0';
  cvkb_lmk[4] = '\0';
  cvkb_lmk[5] = '\0';
  cvkb_lmk[6] = '\0';
  cvkb_lmk[7] = '\0';
  cvkb_lmk[8] = '\0';
  cvkb_lmk[9] = '\0';
  cvkb_lmk[10] = '\0';
  cvkb_lmk[0xb] = '\0';
  cvkb_lmk[0xc] = '\0';
  cvkb_lmk[0xd] = '\0';
  cvkb_lmk[0xe] = '\0';
  cvkb_lmk[0xf] = '\0';
  check_valuea[0] = '\0';
  check_valuea[1] = '\0';
  check_valuea[2] = '\0';
  check_valuea[3] = '\0';
  check_valuea[4] = '\0';
  check_valuea[5] = '\0';
  check_valuea[6] = '\0';
  check_valuea[7] = '\0';
  check_valuea[8] = '\0';
  check_valuea[9] = '\0';
  check_valuea[10] = '\0';
  check_valuea[0xb] = '\0';
  check_valuea[0xc] = '\0';
  check_valuea[0xd] = '\0';
  check_valuea[0xe] = '\0';
  check_valuea[0xf] = '\0';
  Command._0_2_ = *(undefined2 *)buffer_received;
  Command[2] = '\0';
  *(undefined4 *)err_code = *(undefined4 *)buffer_received;
  iVar1 = memcmp(Command,&DAT_004cba3b,2);
  iVar2 = 0x7d1;
  if (iVar1 == 0) {
    TextError(err_code + 2,sLine);
    iVar2 = memcmp(err_code + 2,"00",2);
    if (iVar2 == 0) {
      *(undefined8 *)cvka_lmk = *(undefined8 *)(buffer_received + 4);
      *(undefined8 *)(cvka_lmk + 8) = *(undefined8 *)(buffer_received + 0xc);
      *(undefined8 *)cvkb_lmk = *(undefined8 *)(buffer_received + 0x14);
      *(undefined8 *)(cvkb_lmk + 8) = *(undefined8 *)(buffer_received + 0x1c);
      *(undefined8 *)check_valuea = *(undefined8 *)(buffer_received + 0x24);
      *(undefined8 *)(check_valuea + 8) = *(undefined8 *)(buffer_received + 0x2c);
      *(undefined8 *)check_valueb = *(undefined8 *)(buffer_received + 0x2a);
      *(undefined8 *)(check_valueb + 8) = *(undefined8 *)(buffer_received + 0x32);
      trace_event("End   command_AT()",5);
      iVar2 = 0;
    }
    else {
      iVar2 = 0x7d2;
    }
  }
  return iVar2;
}



// WARNING: Unknown calling convention

int command_AU(char *buffer_transmit,char *zmk_lmk,char *cvka_lmk,char *cvkb_lmk)

{
  trace_event("Debut command_AU()",5);
  buffer_transmit[0] = 'A';
  buffer_transmit[1] = 'U';
  *(undefined8 *)(buffer_transmit + 2) = *(undefined8 *)zmk_lmk;
  *(undefined8 *)(buffer_transmit + 10) = *(undefined8 *)(zmk_lmk + 8);
  *(undefined8 *)(buffer_transmit + 0x12) = *(undefined8 *)cvka_lmk;
  *(undefined8 *)(buffer_transmit + 0x1a) = *(undefined8 *)(cvka_lmk + 8);
  *(undefined8 *)(buffer_transmit + 0x22) = *(undefined8 *)cvkb_lmk;
  *(undefined8 *)(buffer_transmit + 0x2a) = *(undefined8 *)(cvkb_lmk + 8);
  trace_event("Fin   command_AU()",5);
  return 0;
}



// WARNING: Unknown calling convention

int command_AV(char *buffer_received,char *cvka_zmk,char *cvkb_zmk,char *check_valuea,
              char *check_valueb,char *err_code)

{
  int iVar1;
  int iVar2;
  char Command [3];
  char sLine [512];
  
  trace_event("Start command_AV()",5);
  cvka_zmk[0] = '\0';
  cvka_zmk[1] = '\0';
  cvka_zmk[2] = '\0';
  cvka_zmk[3] = '\0';
  cvka_zmk[4] = '\0';
  cvka_zmk[5] = '\0';
  cvka_zmk[6] = '\0';
  cvka_zmk[7] = '\0';
  cvka_zmk[8] = '\0';
  cvka_zmk[9] = '\0';
  cvka_zmk[10] = '\0';
  cvka_zmk[0xb] = '\0';
  cvka_zmk[0xc] = '\0';
  cvka_zmk[0xd] = '\0';
  cvka_zmk[0xe] = '\0';
  cvka_zmk[0xf] = '\0';
  cvkb_zmk[0] = '\0';
  cvkb_zmk[1] = '\0';
  cvkb_zmk[2] = '\0';
  cvkb_zmk[3] = '\0';
  cvkb_zmk[4] = '\0';
  cvkb_zmk[5] = '\0';
  cvkb_zmk[6] = '\0';
  cvkb_zmk[7] = '\0';
  cvkb_zmk[8] = '\0';
  cvkb_zmk[9] = '\0';
  cvkb_zmk[10] = '\0';
  cvkb_zmk[0xb] = '\0';
  cvkb_zmk[0xc] = '\0';
  cvkb_zmk[0xd] = '\0';
  cvkb_zmk[0xe] = '\0';
  cvkb_zmk[0xf] = '\0';
  check_valuea[0] = '\0';
  check_valuea[1] = '\0';
  check_valuea[2] = '\0';
  check_valuea[3] = '\0';
  check_valuea[4] = '\0';
  check_valuea[5] = '\0';
  check_valuea[6] = '\0';
  check_valuea[7] = '\0';
  check_valuea[8] = '\0';
  check_valuea[9] = '\0';
  check_valuea[10] = '\0';
  check_valuea[0xb] = '\0';
  check_valuea[0xc] = '\0';
  check_valuea[0xd] = '\0';
  check_valuea[0xe] = '\0';
  check_valuea[0xf] = '\0';
  check_valueb[0] = '\0';
  check_valueb[1] = '\0';
  check_valueb[2] = '\0';
  check_valueb[3] = '\0';
  check_valueb[4] = '\0';
  check_valueb[5] = '\0';
  check_valueb[6] = '\0';
  check_valueb[7] = '\0';
  check_valueb[8] = '\0';
  check_valueb[9] = '\0';
  check_valueb[10] = '\0';
  check_valueb[0xb] = '\0';
  check_valueb[0xc] = '\0';
  check_valueb[0xd] = '\0';
  check_valueb[0xe] = '\0';
  check_valueb[0xf] = '\0';
  Command._0_2_ = *(undefined2 *)buffer_received;
  Command[2] = '\0';
  *(undefined4 *)err_code = *(undefined4 *)buffer_received;
  iVar1 = memcmp(Command,&DAT_004cba8a,2);
  iVar2 = 0x7d1;
  if (iVar1 == 0) {
    TextError(err_code + 2,sLine);
    iVar2 = memcmp(err_code + 2,"00",2);
    if (iVar2 == 0) {
      *(undefined8 *)cvka_zmk = *(undefined8 *)(buffer_received + 4);
      *(undefined8 *)(cvka_zmk + 8) = *(undefined8 *)(buffer_received + 0xc);
      *(undefined8 *)cvkb_zmk = *(undefined8 *)(buffer_received + 0x14);
      *(undefined8 *)(cvkb_zmk + 8) = *(undefined8 *)(buffer_received + 0x1c);
      *(undefined8 *)check_valuea = *(undefined8 *)(buffer_received + 0x24);
      *(undefined8 *)(check_valuea + 8) = *(undefined8 *)(buffer_received + 0x2c);
      *(undefined8 *)check_valueb = *(undefined8 *)(buffer_received + 0x34);
      *(undefined8 *)(check_valueb + 8) = *(undefined8 *)(buffer_received + 0x3c);
      trace_event("End   command_AV()",5);
      iVar2 = 0;
    }
    else {
      iVar2 = 0x7d2;
    }
  }
  return iVar2;
}



// WARNING: Unknown calling convention

int command_AW(char *buffer_transmit,char *zmk_lmk,char *cvka_zmk,char *cvkb_zmk)

{
  trace_event("Start command_AW()",5);
  buffer_transmit[0] = 'A';
  buffer_transmit[1] = 'W';
  *(undefined8 *)(buffer_transmit + 2) = *(undefined8 *)zmk_lmk;
  *(undefined8 *)(buffer_transmit + 10) = *(undefined8 *)(zmk_lmk + 8);
  *(undefined8 *)(buffer_transmit + 0x12) = *(undefined8 *)cvka_zmk;
  *(undefined8 *)(buffer_transmit + 0x1a) = *(undefined8 *)(cvka_zmk + 8);
  *(undefined8 *)(buffer_transmit + 0x22) = *(undefined8 *)cvkb_zmk;
  *(undefined8 *)(buffer_transmit + 0x2a) = *(undefined8 *)(cvkb_zmk + 8);
  trace_event("End   command_AW()",5);
  return 0;
}



// WARNING: Unknown calling convention

int command_AX(char *buffer_received,char *cvka_lmk,char *cvkb_lmk,char *check_valuea,
              char *check_valueb,char *err_code)

{
  int iVar1;
  int iVar2;
  char Command [3];
  char sLine [512];
  
  trace_event("Start command_AX()",5);
  cvka_lmk[0] = '\0';
  cvka_lmk[1] = '\0';
  cvka_lmk[2] = '\0';
  cvka_lmk[3] = '\0';
  cvka_lmk[4] = '\0';
  cvka_lmk[5] = '\0';
  cvka_lmk[6] = '\0';
  cvka_lmk[7] = '\0';
  cvka_lmk[8] = '\0';
  cvka_lmk[9] = '\0';
  cvka_lmk[10] = '\0';
  cvka_lmk[0xb] = '\0';
  cvka_lmk[0xc] = '\0';
  cvka_lmk[0xd] = '\0';
  cvka_lmk[0xe] = '\0';
  cvka_lmk[0xf] = '\0';
  cvkb_lmk[0] = '\0';
  cvkb_lmk[1] = '\0';
  cvkb_lmk[2] = '\0';
  cvkb_lmk[3] = '\0';
  cvkb_lmk[4] = '\0';
  cvkb_lmk[5] = '\0';
  cvkb_lmk[6] = '\0';
  cvkb_lmk[7] = '\0';
  cvkb_lmk[8] = '\0';
  cvkb_lmk[9] = '\0';
  cvkb_lmk[10] = '\0';
  cvkb_lmk[0xb] = '\0';
  cvkb_lmk[0xc] = '\0';
  cvkb_lmk[0xd] = '\0';
  cvkb_lmk[0xe] = '\0';
  cvkb_lmk[0xf] = '\0';
  check_valuea[0] = '\0';
  check_valuea[1] = '\0';
  check_valuea[2] = '\0';
  check_valuea[3] = '\0';
  check_valuea[4] = '\0';
  check_valuea[5] = '\0';
  check_valuea[6] = '\0';
  check_valuea[7] = '\0';
  check_valuea[8] = '\0';
  check_valuea[9] = '\0';
  check_valuea[10] = '\0';
  check_valuea[0xb] = '\0';
  check_valuea[0xc] = '\0';
  check_valuea[0xd] = '\0';
  check_valuea[0xe] = '\0';
  check_valuea[0xf] = '\0';
  check_valueb[0] = '\0';
  check_valueb[1] = '\0';
  check_valueb[2] = '\0';
  check_valueb[3] = '\0';
  check_valueb[4] = '\0';
  check_valueb[5] = '\0';
  check_valueb[6] = '\0';
  check_valueb[7] = '\0';
  check_valueb[8] = '\0';
  check_valueb[9] = '\0';
  check_valueb[10] = '\0';
  check_valueb[0xb] = '\0';
  check_valueb[0xc] = '\0';
  check_valueb[0xd] = '\0';
  check_valueb[0xe] = '\0';
  check_valueb[0xf] = '\0';
  Command._0_2_ = *(undefined2 *)buffer_received;
  Command[2] = '\0';
  *(undefined4 *)err_code = *(undefined4 *)buffer_received;
  iVar1 = memcmp(Command,"AX",2);
  iVar2 = 0x7d1;
  if (iVar1 == 0) {
    TextError(err_code + 2,sLine);
    iVar2 = memcmp(err_code + 2,"00",2);
    if (iVar2 == 0) {
      *(undefined8 *)cvka_lmk = *(undefined8 *)(buffer_received + 4);
      *(undefined8 *)(cvka_lmk + 8) = *(undefined8 *)(buffer_received + 0xc);
      *(undefined8 *)cvkb_lmk = *(undefined8 *)(buffer_received + 0x14);
      *(undefined8 *)(cvkb_lmk + 8) = *(undefined8 *)(buffer_received + 0x1c);
      *(undefined8 *)check_valuea = *(undefined8 *)(buffer_received + 0x24);
      *(undefined8 *)(check_valuea + 8) = *(undefined8 *)(buffer_received + 0x2c);
      *(undefined8 *)check_valueb = *(undefined8 *)(buffer_received + 0x34);
      *(undefined8 *)(check_valueb + 8) = *(undefined8 *)(buffer_received + 0x3c);
      trace_event("End   command_AX()",5);
      iVar2 = 0;
    }
    else {
      iVar2 = 0x7d2;
    }
  }
  return iVar2;
}



// WARNING: Unknown calling convention

int command_CA(char *buffer_transmit,char *Tpk,char *Zpk,char *PinTpk,char *format_in,
              char *format_out,char *Pan)

{
  size_t sVar1;
  size_t sVar2;
  char *pcVar3;
  char Card [13];
  
  pcVar3 = buffer_transmit + 2;
  trace_event("Start command_CA()",5);
  Card[0] = '\0';
  Card[1] = '\0';
  Card[2] = '\0';
  Card[3] = '\0';
  Card[4] = '\0';
  Card[5] = '\0';
  Card[6] = '\0';
  Card[7] = '\0';
  buffer_transmit[0] = 'C';
  buffer_transmit[1] = 'A';
  Card[8] = '\0';
  Card[9] = '\0';
  Card[10] = '\0';
  Card[0xb] = '\0';
  Card[0xc] = '\0';
  sVar1 = strlen(Tpk);
  memcpy(pcVar3,Tpk,sVar1);
  sVar1 = strlen(Tpk);
  sVar2 = strlen(Zpk);
  memcpy(pcVar3 + sVar1,Zpk,sVar2);
  sVar2 = strlen(Zpk);
  pcVar3 = pcVar3 + sVar1 + sVar2;
  pcVar3[0] = '1';
  pcVar3[1] = '2';
  *(undefined8 *)(pcVar3 + 2) = *(undefined8 *)PinTpk;
  *(undefined8 *)(pcVar3 + 10) = *(undefined8 *)(PinTpk + 8);
  *(undefined2 *)(pcVar3 + 0x12) = *(undefined2 *)format_in;
  *(undefined2 *)(pcVar3 + 0x14) = *(undefined2 *)format_out;
  format_card_from_pan(Card,Pan);
  *(undefined8 *)(pcVar3 + 0x16) = Card._0_8_;
  *(undefined4 *)(pcVar3 + 0x1e) = Card._8_4_;
  trace_event("End   command_CA()",5);
  return 0;
}



// WARNING: Unknown calling convention

int command_CB(char *buffer_received,char *PinZpk,char *err_code)

{
  int iVar1;
  int iVar2;
  char Command [3];
  char sLine [512];
  
  iVar2 = 0x7d1;
  trace_event("Start command_CB()",5);
  PinZpk[0] = '\0';
  PinZpk[1] = '\0';
  PinZpk[2] = '\0';
  PinZpk[3] = '\0';
  PinZpk[4] = '\0';
  PinZpk[5] = '\0';
  PinZpk[6] = '\0';
  PinZpk[7] = '\0';
  PinZpk[8] = '\0';
  PinZpk[9] = '\0';
  PinZpk[10] = '\0';
  PinZpk[0xb] = '\0';
  PinZpk[0xc] = '\0';
  PinZpk[0xd] = '\0';
  PinZpk[0xe] = '\0';
  PinZpk[0xf] = '\0';
  Command._0_2_ = *(undefined2 *)buffer_received;
  Command[2] = '\0';
  *(undefined4 *)err_code = *(undefined4 *)buffer_received;
  iVar1 = memcmp(Command,"CB",2);
  if (iVar1 == 0) {
    TextError(err_code + 2,sLine);
    iVar2 = memcmp(err_code + 2,"00",2);
    if (iVar2 == 0) {
      *(undefined8 *)PinZpk = *(undefined8 *)(buffer_received + 6);
      *(undefined8 *)(PinZpk + 8) = *(undefined8 *)(buffer_received + 0xe);
      trace_event("End   command_CB()",5);
      iVar2 = 0;
    }
    else {
      iVar2 = 0x7d2;
    }
  }
  return iVar2;
}



// WARNING: Unknown calling convention

int command_CC(char *buffer_transmit,char *zpk_in,char *zpk_out,char *pin,char *format_in,
              char *format_out,char *pan)

{
  size_t sVar1;
  int iVar2;
  char card [13];
  char sLine [512];
  
  trace_event("Start command_CC()",5);
  if (debug_option == 1) {
    sprintf(sLine,"==> zpk_in     =[%s]",zpk_in);
    trace_event(sLine,0);
    sprintf(sLine,"==> zpk_out    =[%s]",zpk_out);
    trace_event(sLine,0);
    sprintf(sLine,"==> pin        =[%s]",pin);
    trace_event(sLine,0);
    sprintf(sLine,"==> format_in  =[%s]",format_in);
    trace_event(sLine,0);
    sprintf(sLine,"==> format_out =[%s]",format_out);
    trace_event(sLine,0);
    sprintf(sLine,"==> pan        =[%s]",pan);
    trace_event(sLine,0);
  }
  card[0] = '\0';
  card[1] = '\0';
  card[2] = '\0';
  card[3] = '\0';
  card[4] = '\0';
  card[5] = '\0';
  card[6] = '\0';
  card[7] = '\0';
  card[8] = '\0';
  card[9] = '\0';
  card[10] = '\0';
  card[0xb] = '\0';
  card[0xc] = '\0';
  buffer_transmit[0] = 'C';
  buffer_transmit[1] = 'C';
  sVar1 = strlen(zpk_in);
  memcpy(buffer_transmit + 2,zpk_in,sVar1);
  sVar1 = strlen(zpk_in);
  iVar2 = (int)sVar1 + 2;
  sVar1 = strlen(zpk_out);
  memcpy(buffer_transmit + iVar2,zpk_out,sVar1);
  sVar1 = strlen(zpk_out);
  iVar2 = iVar2 + (int)sVar1;
  (buffer_transmit + iVar2)[0] = '1';
  (buffer_transmit + iVar2)[1] = '2';
  *(undefined8 *)(buffer_transmit + (iVar2 + 2)) = *(undefined8 *)pin;
  *(undefined8 *)(buffer_transmit + (iVar2 + 2) + 8) = *(undefined8 *)(pin + 8);
  *(undefined2 *)(buffer_transmit + (iVar2 + 0x12)) = *(undefined2 *)format_in;
  *(undefined2 *)(buffer_transmit + (iVar2 + 0x14)) = *(undefined2 *)format_out;
  format_card_from_pan(card,pan);
  *(undefined8 *)(buffer_transmit + (iVar2 + 0x16)) = card._0_8_;
  *(undefined4 *)(buffer_transmit + (iVar2 + 0x16) + 8) = card._8_4_;
  sprintf(sLine,"==> offset     =[%d]",(ulong)(iVar2 + 0x22U));
  trace_event(sLine,0);
  dump_buffer((uchar *)buffer_transmit,iVar2 + 0x22U,'A','L','O');
  trace_event("End   command_CC()",5);
  return 0;
}



// WARNING: Unknown calling convention

int command_CD(char *buffer_received,char *PinZpk,char *err_code)

{
  int iVar1;
  int iVar2;
  char Command [3];
  char sLine [512];
  
  iVar2 = 0x7d1;
  trace_event("Start command_CD()",5);
  PinZpk[0] = '\0';
  PinZpk[1] = '\0';
  PinZpk[2] = '\0';
  PinZpk[3] = '\0';
  PinZpk[4] = '\0';
  PinZpk[5] = '\0';
  PinZpk[6] = '\0';
  PinZpk[7] = '\0';
  PinZpk[8] = '\0';
  PinZpk[9] = '\0';
  PinZpk[10] = '\0';
  PinZpk[0xb] = '\0';
  PinZpk[0xc] = '\0';
  PinZpk[0xd] = '\0';
  PinZpk[0xe] = '\0';
  PinZpk[0xf] = '\0';
  Command._0_2_ = *(undefined2 *)buffer_received;
  Command[2] = '\0';
  *(undefined4 *)err_code = *(undefined4 *)buffer_received;
  iVar1 = memcmp(Command,&DAT_004cbc04,2);
  if (iVar1 == 0) {
    TextError(err_code + 2,sLine);
    iVar2 = memcmp(err_code + 2,"00",2);
    if (iVar2 == 0) {
      *(undefined8 *)PinZpk = *(undefined8 *)(buffer_received + 6);
      *(undefined8 *)(PinZpk + 8) = *(undefined8 *)(buffer_received + 0xe);
      trace_event("End   command_CD()",5);
      iVar2 = 0;
    }
    else {
      iVar2 = 0x7d2;
    }
  }
  return iVar2;
}



// WARNING: Unknown calling convention

int command_CW(char *buffer_transmit,char *cvka_lmk,char *cvkb_lmk,char *pan,char *expirat_date,
              char *serv_code)

{
  size_t sVar1;
  char *pcVar2;
  long lVar3;
  char ligne [512];
  
  pcVar2 = ligne;
  for (lVar3 = 0x40; lVar3 != 0; lVar3 = lVar3 + -1) {
    pcVar2[0] = '\0';
    pcVar2[1] = '\0';
    pcVar2[2] = '\0';
    pcVar2[3] = '\0';
    pcVar2[4] = '\0';
    pcVar2[5] = '\0';
    pcVar2[6] = '\0';
    pcVar2[7] = '\0';
    pcVar2 = pcVar2 + 8;
  }
  if (debug_option == 1) {
    sprintf(ligne,"Start  command_CW(%s,%s,%s)",pan,expirat_date,serv_code);
  }
  else {
    builtin_strncpy(ligne,"Start command_CW()",0x13);
  }
  trace_event(ligne,5);
  buffer_transmit[0] = 'C';
  buffer_transmit[1] = 'W';
  *(undefined8 *)(buffer_transmit + 2) = *(undefined8 *)cvka_lmk;
  *(undefined8 *)(buffer_transmit + 10) = *(undefined8 *)(cvka_lmk + 8);
  *(undefined8 *)(buffer_transmit + 0x12) = *(undefined8 *)cvkb_lmk;
  *(undefined8 *)(buffer_transmit + 0x1a) = *(undefined8 *)(cvkb_lmk + 8);
  sVar1 = strlen(pan);
  memcpy(buffer_transmit + 0x22,pan,sVar1);
  sVar1 = strlen(pan);
  pcVar2 = buffer_transmit + 0x22 + sVar1;
  *pcVar2 = ';';
  *(undefined4 *)(pcVar2 + 1) = *(undefined4 *)expirat_date;
  *(undefined2 *)(pcVar2 + 5) = *(undefined2 *)serv_code;
  pcVar2[7] = serv_code[2];
  trace_event("End   command_CW()",5);
  return 0;
}



// WARNING: Unknown calling convention

int command_CX(char *buffer_received,char *cvv,char *err_code)

{
  int iVar1;
  int iVar2;
  char Command [3];
  char sLine [512];
  
  iVar2 = 0x7d1;
  trace_event("Start command_CX()",5);
  Command._0_2_ = *(undefined2 *)buffer_received;
  Command[2] = '\0';
  *(undefined4 *)err_code = *(undefined4 *)buffer_received;
  iVar1 = memcmp(Command,&DAT_004cbc5c,2);
  if (iVar1 == 0) {
    TextError(err_code + 2,sLine);
    iVar2 = memcmp(err_code + 2,"00",2);
    if (iVar2 != 0) {
      return 0x7d2;
    }
    *(undefined2 *)cvv = *(undefined2 *)(buffer_received + 4);
    cvv[2] = buffer_received[6];
    trace_event("End   command_CX()",5);
    iVar2 = 0;
  }
  return iVar2;
}



// WARNING: Unknown calling convention

int command_CY(char *buffer_transmit,char *card_number,char *service_code,char *expiry_date,
              char *cvk_A,char *cvk_B,char *cvv)

{
  size_t sVar1;
  char *pcVar2;
  char *pcVar3;
  char ligne [512];
  
  if (debug_option == 1) {
    sprintf(ligne,"Start command_CY(%.22s,%.3s,%.4s,%.3s)",card_number,service_code,expiry_date,cvv)
    ;
  }
  else {
    builtin_strncpy(ligne,"Start command_CY()",0x13);
  }
  trace_event(ligne,5);
  buffer_transmit[0] = 'C';
  buffer_transmit[1] = 'Y';
  sVar1 = strlen(cvk_A);
  memcpy(buffer_transmit + 2,cvk_A,sVar1);
  sVar1 = strlen(cvk_A);
  pcVar2 = buffer_transmit + 2 + sVar1;
  pcVar3 = pcVar2;
  if ((*cvk_A != 'U') && (*cvk_A != 'S')) {
    pcVar3 = pcVar2 + 0x10;
    *(undefined8 *)pcVar2 = *(undefined8 *)cvk_B;
    *(undefined8 *)(pcVar2 + 8) = *(undefined8 *)(cvk_B + 8);
  }
  *(undefined2 *)pcVar3 = *(undefined2 *)cvv;
  pcVar3[2] = cvv[2];
  sVar1 = strlen(card_number);
  memcpy(pcVar3 + 3,card_number,sVar1);
  sVar1 = strlen(card_number);
  pcVar3 = pcVar3 + 3 + sVar1;
  *pcVar3 = ';';
  *(undefined2 *)(pcVar3 + 1) = *(undefined2 *)expiry_date;
  *(undefined2 *)(pcVar3 + 3) = *(undefined2 *)(expiry_date + 2);
  *(undefined2 *)(pcVar3 + 5) = *(undefined2 *)service_code;
  pcVar3[7] = service_code[2];
  trace_event("End   command_CY(OK)",5);
  return 0;
}



// WARNING: Unknown calling convention

int command_CZ(char *buffer_received,char *err_code)

{
  int iVar1;
  char *err_code_00;
  char Command [3];
  char sLine [512];
  
  trace_event("Start command_CZ()",5);
  Command._0_2_ = *(undefined2 *)buffer_received;
  Command[2] = '\0';
  *(undefined4 *)err_code = *(undefined4 *)buffer_received;
  iVar1 = memcmp(Command,&DAT_004cbc9a,2);
  if (iVar1 == 0) {
    err_code_00 = err_code + 2;
    TextError(err_code_00,sLine);
    iVar1 = memcmp(err_code_00,"00",2);
    if (iVar1 == 0) {
      trace_event("End   command_CZ(OK)",5);
      iVar1 = 0;
    }
    else {
      iVar1 = memcmp(err_code_00,"01",2);
      if (iVar1 != 0) {
        trace_event("End   command_CZ(CRYPTOGRAPHIC_ERROR)",5);
        return 2;
      }
      iVar1 = 1;
      trace_event("End   command_CZ(VERIFICATION_FAILED)",5);
    }
  }
  else {
    iVar1 = 0x7d1;
    trace_event("End   command_CZ(ERROR_COMMAND)",5);
  }
  return iVar1;
}



// WARNING: Unknown calling convention

int command_EC(char *buffer_transmit,char *zpk,char *pvka,char *pvkb,char *pin_block,char *format,
              char *pan,char *pvv)

{
  char cVar1;
  size_t sVar2;
  size_t sVar3;
  char *pcVar4;
  char *pcVar5;
  char pvki [2];
  char card [13];
  
  pcVar4 = buffer_transmit + 2;
  trace_event("Start command_EC()",5);
  cVar1 = *pvv;
  buffer_transmit[0] = 'E';
  buffer_transmit[1] = 'C';
  card[0] = '\0';
  card[1] = '\0';
  card[2] = '\0';
  card[3] = '\0';
  card[4] = '\0';
  card[5] = '\0';
  card[6] = '\0';
  card[7] = '\0';
  card[8] = '\0';
  card[9] = '\0';
  card[10] = '\0';
  card[0xb] = '\0';
  card[0xc] = '\0';
  sVar2 = strlen(zpk);
  memcpy(pcVar4,zpk,sVar2);
  sVar2 = strlen(zpk);
  sVar3 = strlen(pvka);
  memcpy(pcVar4 + sVar2,pvka,sVar3);
  sVar3 = strlen(pvka);
  pcVar5 = pcVar4 + sVar2 + sVar3;
  pcVar4 = pcVar5;
  if ((*pvka != 'U') && (*pvka != 'S')) {
    pcVar4 = pcVar5 + 0x10;
    *(undefined8 *)pcVar5 = *(undefined8 *)pvkb;
    *(undefined8 *)(pcVar5 + 8) = *(undefined8 *)(pvkb + 8);
  }
  *(undefined8 *)pcVar4 = *(undefined8 *)pin_block;
  *(undefined8 *)(pcVar4 + 8) = *(undefined8 *)(pin_block + 8);
  *(undefined2 *)(pcVar4 + 0x10) = *(undefined2 *)format;
  format_card_from_pan(card,pan);
  pcVar4[0x1e] = cVar1;
  *(undefined8 *)(pcVar4 + 0x12) = card._0_8_;
  *(undefined4 *)(pcVar4 + 0x1a) = card._8_4_;
  *(undefined4 *)(pcVar4 + 0x1f) = *(undefined4 *)(pvv + 1);
  trace_event("Fin   command_EC(OK)",5);
  return 0;
}



// WARNING: Unknown calling convention

int command_ED(char *buffer_received,char *err_code)

{
  int iVar1;
  char *err_code_00;
  char Command [3];
  char sLine [512];
  
  trace_event("Start command_ED()",5);
  Command._0_2_ = *(undefined2 *)buffer_received;
  Command[2] = '\0';
  *(undefined4 *)err_code = *(undefined4 *)buffer_received;
  iVar1 = memcmp(Command,"ED",2);
  if (iVar1 == 0) {
    err_code_00 = err_code + 2;
    TextError(err_code_00,sLine);
    iVar1 = memcmp(err_code_00,"00",2);
    if (iVar1 == 0) {
      trace_event("End   command_ED(OK)",5);
      iVar1 = 0;
    }
    else {
      iVar1 = memcmp(err_code_00,"01",2);
      if (iVar1 != 0) {
        trace_event("End   command_ED(CRYPTOGRAPHIC_ERROR)",5);
        return 2;
      }
      iVar1 = 1;
      trace_event("End   command_ED(VERIFICATION_FAILED)",5);
    }
  }
  else {
    iVar1 = 0x7d1;
    trace_event("End   command_ED(ERROR_COMMAND)",5);
  }
  return iVar1;
}



// WARNING: Unknown calling convention

int command_DC(char *buffer_transmit,char *tpk_key,char *pvka_key,char *pvkb_key,char *pin_block,
              char *format,char *pan,char *pvv)

{
  char cVar1;
  undefined4 uVar2;
  size_t sVar3;
  size_t sVar4;
  char *pcVar5;
  char *pcVar6;
  char pvki [2];
  
  pcVar5 = buffer_transmit + 2;
  trace_event("Start command_DC()",5);
  cVar1 = *pvv;
  buffer_transmit[0] = 'D';
  buffer_transmit[1] = 'C';
  sVar3 = strlen(tpk_key);
  memcpy(pcVar5,tpk_key,sVar3);
  sVar3 = strlen(tpk_key);
  sVar4 = strlen(pvka_key);
  memcpy(pcVar5 + sVar3,pvka_key,sVar4);
  sVar4 = strlen(pvka_key);
  pcVar6 = pcVar5 + sVar3 + sVar4;
  pcVar5 = pcVar6;
  if ((*pvka_key != 'U') && (*pvka_key != 'S')) {
    pcVar5 = pcVar6 + 0x10;
    *(undefined8 *)pcVar6 = *(undefined8 *)pvkb_key;
    *(undefined8 *)(pcVar6 + 8) = *(undefined8 *)(pvkb_key + 8);
  }
  *(undefined8 *)pcVar5 = *(undefined8 *)pin_block;
  *(undefined8 *)(pcVar5 + 8) = *(undefined8 *)(pin_block + 8);
  *(undefined2 *)(pcVar5 + 0x10) = *(undefined2 *)format;
  sVar3 = strlen(pan);
  *(undefined8 *)(pcVar5 + 0x12) = *(undefined8 *)(pan + (sVar3 - 0xd));
  uVar2 = *(undefined4 *)(pan + (sVar3 - 0xd) + 8);
  pcVar5[0x1e] = cVar1;
  *(undefined4 *)(pcVar5 + 0x1a) = uVar2;
  *(undefined4 *)(pcVar5 + 0x1f) = *(undefined4 *)(pvv + 1);
  trace_event("End   command_DC()",5);
  return 0;
}



// WARNING: Unknown calling convention

int command_DD(char *buffer_received,char *err_code)

{
  int iVar1;
  char *err_code_00;
  char Command [3];
  char sLine [512];
  
  trace_event("Start command_DD()",5);
  Command._0_2_ = *(undefined2 *)buffer_received;
  Command[2] = '\0';
  *(undefined4 *)err_code = *(undefined4 *)buffer_received;
  iVar1 = memcmp(Command,&DAT_004cbd3b,2);
  if (iVar1 == 0) {
    err_code_00 = err_code + 2;
    TextError(err_code_00,sLine);
    iVar1 = memcmp(err_code_00,"00",2);
    if (iVar1 == 0) {
      trace_event("End   command_DD(OK)",5);
      iVar1 = 0;
    }
    else {
      iVar1 = memcmp(err_code_00,"01",2);
      if (iVar1 != 0) {
        trace_event("End   command_DD(CRYPTOGRAPHIC_ERROR)",5);
        return 2;
      }
      iVar1 = 1;
      trace_event("End   command_DD(VERIFICATION_FAILED)",5);
    }
  }
  else {
    iVar1 = 0x7d1;
    trace_event("End   command_DD(ERROR_COMMAND)",5);
  }
  return iVar1;
}



// WARNING: Unknown calling convention

int command_DE(char *buffer_transmit,char *Pvka,char *PinLmk,char *Pan)

{
  undefined2 uVar1;
  size_t sVar2;
  size_t sVar3;
  char *pcVar4;
  char Card [13];
  
  pcVar4 = buffer_transmit + 2;
  trace_event("Start command_DE()",5);
  Card[0] = '\0';
  Card[1] = '\0';
  Card[2] = '\0';
  Card[3] = '\0';
  Card[4] = '\0';
  Card[5] = '\0';
  Card[6] = '\0';
  Card[7] = '\0';
  buffer_transmit[0] = 'D';
  buffer_transmit[1] = 'E';
  Card[8] = '\0';
  Card[9] = '\0';
  Card[10] = '\0';
  Card[0xb] = '\0';
  Card[0xc] = '\0';
  sVar2 = strlen(Pvka);
  memcpy(pcVar4,Pvka,sVar2);
  sVar2 = strlen(Pvka);
  sVar3 = strlen(PinLmk);
  memcpy(pcVar4 + sVar2,PinLmk,sVar3);
  sVar3 = strlen(PinLmk);
  pcVar4 = pcVar4 + sVar2 + sVar3;
  pcVar4[0] = '0';
  pcVar4[1] = '4';
  format_card_from_pan(Card,Pan);
  *(undefined8 *)(pcVar4 + 2) = Card._0_8_;
  *(undefined4 *)(pcVar4 + 10) = Card._8_4_;
  pcVar4[0xe] = '0';
  pcVar4[0xf] = '1';
  pcVar4[0x10] = '2';
  pcVar4[0x11] = '3';
  pcVar4[0x12] = '4';
  pcVar4[0x13] = '5';
  pcVar4[0x14] = '6';
  pcVar4[0x15] = '7';
  pcVar4[0x16] = '8';
  pcVar4[0x17] = '9';
  pcVar4[0x18] = '0';
  pcVar4[0x19] = '1';
  pcVar4[0x1a] = '2';
  pcVar4[0x1b] = '3';
  pcVar4[0x1c] = '4';
  pcVar4[0x1d] = '5';
  *(undefined8 *)(pcVar4 + 0x1e) = *(undefined8 *)Pan;
  uVar1 = *(undefined2 *)(Pan + 8);
  pcVar4[0x28] = 'N';
  *(undefined2 *)(pcVar4 + 0x26) = uVar1;
  sVar2 = strlen(Pan);
  pcVar4[0x29] = Pan[sVar2 - 1];
  trace_event("End   command_DE(OK)",5);
  return 0;
}



// WARNING: Unknown calling convention

int command_DF(char *buffer_received,char *offset,char *err_code)

{
  int iVar1;
  char Command [3];
  char sLine [512];
  
  trace_event("Start command_DF()",5);
  Command._0_2_ = *(undefined2 *)buffer_received;
  Command[2] = '\0';
  *(undefined4 *)err_code = *(undefined4 *)buffer_received;
  iVar1 = memcmp(Command,&DAT_004cbd8e,2);
  if (iVar1 != 0) {
    trace_event("End   command_DF(ERROR_COMMAND)",5);
    return 0x7d1;
  }
  TextError(err_code + 2,sLine);
  iVar1 = memcmp(err_code + 2,"00",2);
  if (iVar1 != 0) {
    trace_event("End   command_DF(CHECK_ERROR)",5);
    return 0x7d2;
  }
  *(undefined8 *)offset = *(undefined8 *)(buffer_received + 4);
  *(undefined4 *)(offset + 8) = *(undefined4 *)(buffer_received + 0xc);
  trace_event("End   command_DF(OK)",5);
  return 0;
}



// WARNING: Unknown calling convention

int command_DG(char *buffer_transmit,char *pvka,char *pvkb,char *pin,char *Pan,char *pvki)

{
  size_t sVar1;
  char *pcVar2;
  char *pcVar3;
  char Card [13];
  
  Card[0] = '\0';
  Card[1] = '\0';
  Card[2] = '\0';
  Card[3] = '\0';
  Card[4] = '\0';
  Card[5] = '\0';
  Card[6] = '\0';
  Card[7] = '\0';
  Card[8] = '\0';
  Card[9] = '\0';
  Card[10] = '\0';
  Card[0xb] = '\0';
  Card[0xc] = '\0';
  trace_event("Start   command_DG()",5);
  buffer_transmit[0] = 'D';
  buffer_transmit[1] = 'G';
  sVar1 = strlen(pvka);
  memcpy(buffer_transmit + 2,pvka,sVar1);
  sVar1 = strlen(pvka);
  pcVar2 = buffer_transmit + 2 + sVar1;
  pcVar3 = pcVar2;
  if ((*pvka != 'U') && (*pvka != 'S')) {
    pcVar3 = pcVar2 + 0x10;
    *(undefined8 *)pcVar2 = *(undefined8 *)pvkb;
    *(undefined8 *)(pcVar2 + 8) = *(undefined8 *)(pvkb + 8);
  }
  *(undefined4 *)pcVar3 = *(undefined4 *)pin;
  pcVar3[4] = pin[4];
  format_card_from_pan(Card,Pan);
  *(undefined8 *)(pcVar3 + 5) = Card._0_8_;
  *(undefined4 *)(pcVar3 + 0xd) = Card._8_4_;
  pcVar3[0x11] = *pvki;
  trace_event("End    command_DG()",5);
  return 0;
}



// WARNING: Unknown calling convention

int command_DH(char *buffer_received,char *pvv,char *err_code)

{
  int iVar1;
  char Command [3];
  char sLine [512];
  
  trace_event("Start command_DH()",5);
  Command._0_2_ = *(undefined2 *)buffer_received;
  Command[2] = '\0';
  *(undefined4 *)err_code = *(undefined4 *)buffer_received;
  iVar1 = memcmp(Command,"DH",2);
  if (iVar1 != 0) {
    trace_event("End   command_DH(ERROR_COMMAND)",5);
    return 0x7d1;
  }
  TextError(err_code + 2,sLine);
  iVar1 = memcmp(err_code + 2,"00",2);
  if (iVar1 != 0) {
    trace_event("End   command_DH(CHECK_ERROR)",5);
    return 0x7d2;
  }
  *(undefined4 *)pvv = *(undefined4 *)(buffer_received + 4);
  trace_event("End   command_DH(OK)",5);
  return 0;
}



// WARNING: Unknown calling convention

int command_EA(char *buffer_transmit,char *Zpk,char *Pvka,char *PinZpk,char *format,char *Pan,
              char *offset)

{
  undefined2 uVar1;
  size_t sVar2;
  size_t sVar3;
  char *pcVar4;
  char Card [13];
  
  pcVar4 = buffer_transmit + 2;
  trace_event("Start command_EA()",5);
  Card[0] = '\0';
  Card[1] = '\0';
  Card[2] = '\0';
  Card[3] = '\0';
  Card[4] = '\0';
  Card[5] = '\0';
  Card[6] = '\0';
  Card[7] = '\0';
  buffer_transmit[0] = 'E';
  buffer_transmit[1] = 'A';
  Card[8] = '\0';
  Card[9] = '\0';
  Card[10] = '\0';
  Card[0xb] = '\0';
  Card[0xc] = '\0';
  sVar2 = strlen(Zpk);
  memcpy(pcVar4,Zpk,sVar2);
  sVar2 = strlen(Zpk);
  sVar3 = strlen(Pvka);
  memcpy(pcVar4 + sVar2,Pvka,sVar3);
  sVar3 = strlen(Pvka);
  pcVar4 = pcVar4 + sVar2 + sVar3;
  pcVar4[0] = '1';
  pcVar4[1] = '2';
  *(undefined8 *)(pcVar4 + 2) = *(undefined8 *)PinZpk;
  *(undefined8 *)(pcVar4 + 10) = *(undefined8 *)(PinZpk + 8);
  uVar1 = *(undefined2 *)format;
  pcVar4[0x14] = '0';
  pcVar4[0x15] = '4';
  *(undefined2 *)(pcVar4 + 0x12) = uVar1;
  format_card_from_pan(Card,Pan);
  *(undefined8 *)(pcVar4 + 0x16) = Card._0_8_;
  *(undefined4 *)(pcVar4 + 0x1e) = Card._8_4_;
  pcVar4[0x22] = '0';
  pcVar4[0x23] = '1';
  pcVar4[0x24] = '2';
  pcVar4[0x25] = '3';
  pcVar4[0x26] = '4';
  pcVar4[0x27] = '5';
  pcVar4[0x28] = '6';
  pcVar4[0x29] = '7';
  pcVar4[0x2a] = '8';
  pcVar4[0x2b] = '9';
  pcVar4[0x2c] = '0';
  pcVar4[0x2d] = '1';
  pcVar4[0x2e] = '2';
  pcVar4[0x2f] = '3';
  pcVar4[0x30] = '4';
  pcVar4[0x31] = '5';
  *(undefined8 *)(pcVar4 + 0x32) = *(undefined8 *)Pan;
  uVar1 = *(undefined2 *)(Pan + 8);
  pcVar4[0x3c] = 'N';
  *(undefined2 *)(pcVar4 + 0x3a) = uVar1;
  sVar2 = strlen(Pan);
  pcVar4[0x3d] = Pan[sVar2 - 1];
  *(undefined4 *)(pcVar4 + 0x3e) = *(undefined4 *)offset;
  pcVar4[0x42] = 'F';
  pcVar4[0x43] = 'F';
  pcVar4[0x44] = 'F';
  pcVar4[0x45] = 'F';
  pcVar4[0x46] = 'F';
  pcVar4[0x47] = 'F';
  pcVar4[0x48] = 'F';
  pcVar4[0x49] = 'F';
  trace_event("Start command_EA(OK)",5);
  return 0;
}



// WARNING: Unknown calling convention

int command_EB(char *buffer_received,char *err_code)

{
  int iVar1;
  int iVar2;
  char *err_code_00;
  char Command [3];
  char sLine [512];
  
  trace_event("Start command_EB()",5);
  Command._0_2_ = *(undefined2 *)buffer_received;
  Command[2] = '\0';
  iVar2 = 0x7d1;
  *(undefined4 *)err_code = *(undefined4 *)buffer_received;
  iVar1 = memcmp(Command,"EB",2);
  if (iVar1 == 0) {
    err_code_00 = err_code + 2;
    TextError(err_code_00,sLine);
    iVar2 = memcmp(err_code_00,"00",2);
    if (iVar2 == 0) {
      trace_event("End   command_EB(OK)",5);
      iVar2 = 0;
    }
    else {
      iVar2 = memcmp(err_code_00,"01",2);
      if (iVar2 == 0) {
        iVar2 = 1;
        trace_event("End   command_EB(VERIFICATION_FAILED)",5);
      }
      else {
        iVar2 = 2;
        trace_event("End   command_EB(CRYPTOGRAPHIC_ERROR)",5);
      }
    }
  }
  return iVar2;
}



// WARNING: Unknown calling convention

int command_EE(char *buffer_transmit,char *pvk_lmk,char *pvv,char *pan)

{
  undefined2 uVar1;
  undefined4 uVar2;
  size_t sVar3;
  char *pcVar4;
  char Card [13];
  
  Card[0] = '\0';
  Card[1] = '\0';
  Card[2] = '\0';
  Card[3] = '\0';
  Card[4] = '\0';
  Card[5] = '\0';
  Card[6] = '\0';
  Card[7] = '\0';
  Card[8] = '\0';
  Card[9] = '\0';
  Card[10] = '\0';
  Card[0xb] = '\0';
  Card[0xc] = '\0';
  trace_event("Start command_EE()",5);
  buffer_transmit[0] = 'E';
  buffer_transmit[1] = 'E';
  sVar3 = strlen(pvk_lmk);
  memcpy(buffer_transmit + 2,pvk_lmk,sVar3);
  sVar3 = strlen(pvk_lmk);
  pcVar4 = buffer_transmit + 2 + sVar3;
  uVar2 = *(undefined4 *)pvv;
  pcVar4[0xc] = '0';
  pcVar4[0xd] = '4';
  *(undefined4 *)pcVar4 = uVar2;
  pcVar4[4] = 'F';
  pcVar4[5] = 'F';
  pcVar4[6] = 'F';
  pcVar4[7] = 'F';
  pcVar4[8] = 'F';
  pcVar4[9] = 'F';
  pcVar4[10] = 'F';
  pcVar4[0xb] = 'F';
  format_card_from_pan(Card,pan);
  *(undefined8 *)(pcVar4 + 0xe) = Card._0_8_;
  *(undefined4 *)(pcVar4 + 0x16) = Card._8_4_;
  pcVar4[0x1a] = '0';
  pcVar4[0x1b] = '1';
  pcVar4[0x1c] = '2';
  pcVar4[0x1d] = '3';
  pcVar4[0x1e] = '4';
  pcVar4[0x1f] = '5';
  pcVar4[0x20] = '6';
  pcVar4[0x21] = '7';
  pcVar4[0x22] = '8';
  pcVar4[0x23] = '9';
  pcVar4[0x24] = '0';
  pcVar4[0x25] = '1';
  pcVar4[0x26] = '2';
  pcVar4[0x27] = '3';
  pcVar4[0x28] = '4';
  pcVar4[0x29] = '5';
  *(undefined8 *)(pcVar4 + 0x2a) = *(undefined8 *)pan;
  uVar1 = *(undefined2 *)(pan + 8);
  pcVar4[0x34] = 'N';
  *(undefined2 *)(pcVar4 + 0x32) = uVar1;
  sVar3 = strlen(pan);
  pcVar4[0x35] = pan[sVar3 - 1];
  trace_event("End   command_EE(OK)",5);
  return 0;
}



// WARNING: Unknown calling convention

int command_EF(char *buffer_received,char *pin,char *err_code)

{
  int iVar1;
  char Command [3];
  char sLine [512];
  
  trace_event("Start command_EF()",5);
  Command._0_2_ = *(undefined2 *)buffer_received;
  Command[2] = '\0';
  *(undefined4 *)err_code = *(undefined4 *)buffer_received;
  iVar1 = memcmp(Command,"EF",2);
  if (iVar1 != 0) {
    trace_event("End   command_EF(ERROR_COMMAND)",5);
    return 0x7d1;
  }
  TextError(err_code + 2,sLine);
  iVar1 = memcmp(err_code + 2,"00",2);
  if (iVar1 != 0) {
    trace_event("End   command_EF(CHECK_ERROR)",5);
    return 0x7d2;
  }
  pin[0] = '\0';
  pin[1] = '\0';
  pin[2] = '\0';
  pin[3] = '\0';
  pin[4] = '\0';
  *(undefined4 *)pin = *(undefined4 *)(buffer_received + 4);
  pin[4] = buffer_received[8];
  trace_event("End   command_EF(OK)",5);
  return 0;
}



// WARNING: Unknown calling convention

int command_PE(char *buffer_transmit,char *pan,char *pin,char *field0,char *field1,char *field2,
              char *field3,char *field4,char *field5,char *field6)

{
  size_t sVar1;
  size_t __n;
  char *pcVar2;
  char card [13];
  
  card[0] = '\0';
  card[1] = '\0';
  card[2] = '\0';
  card[3] = '\0';
  card[4] = '\0';
  card[5] = '\0';
  card[6] = '\0';
  card[7] = '\0';
  card[8] = '\0';
  card[9] = '\0';
  card[10] = '\0';
  card[0xb] = '\0';
  card[0xc] = '\0';
  trace_event("Start command_PE()",5);
  buffer_transmit[0] = 'P';
  buffer_transmit[1] = 'E';
  buffer_transmit[2] = 'C';
  pcVar2 = buffer_transmit + 0x14;
  format_card_from_pan(card,pan);
  *(undefined8 *)(buffer_transmit + 3) = card._0_8_;
  *(undefined4 *)(buffer_transmit + 0xb) = card._8_4_;
  *(undefined4 *)(buffer_transmit + 0xf) = *(undefined4 *)pin;
  buffer_transmit[0x13] = pin[4];
  sVar1 = strlen(field0);
  memcpy(pcVar2,field0,sVar1);
  sVar1 = strlen(field0);
  pcVar2 = pcVar2 + sVar1;
  *pcVar2 = ';';
  pcVar2 = pcVar2 + 1;
  sVar1 = strlen(field1);
  memcpy(pcVar2,field1,sVar1);
  sVar1 = strlen(field1);
  pcVar2 = pcVar2 + sVar1;
  *pcVar2 = ';';
  pcVar2 = pcVar2 + 1;
  sVar1 = strlen(field2);
  memcpy(pcVar2,field2,sVar1);
  sVar1 = strlen(field2);
  pcVar2 = pcVar2 + sVar1;
  *pcVar2 = ';';
  pcVar2 = pcVar2 + 1;
  sVar1 = strlen(field3);
  memcpy(pcVar2,field3,sVar1);
  sVar1 = strlen(field3);
  pcVar2 = pcVar2 + sVar1;
  *pcVar2 = ';';
  pcVar2 = pcVar2 + 1;
  sVar1 = strlen(field4);
  memcpy(pcVar2,field4,sVar1);
  sVar1 = strlen(field4);
  pcVar2 = pcVar2 + sVar1;
  *pcVar2 = ';';
  pcVar2 = pcVar2 + 1;
  sVar1 = strlen(field5);
  memcpy(pcVar2,field5,sVar1);
  sVar1 = strlen(field5);
  pcVar2[sVar1] = ';';
  __n = strlen(field6);
  memcpy(pcVar2 + sVar1 + 1,field6,__n);
  trace_event("End   command_PE(OK)",5);
  return 0;
}



// WARNING: Unknown calling convention

int command_PZ(char *buffer_received,char *err_code)

{
  int iVar1;
  char Command [3];
  char sLine [512];
  
  trace_event("Start command_PZ()",5);
  Command._0_2_ = *(undefined2 *)buffer_received;
  Command[2] = '\0';
  *(undefined4 *)err_code = *(undefined4 *)buffer_received;
  iVar1 = memcmp(Command,&DAT_004cbf2c,2);
  if (iVar1 != 0) {
    trace_event("End   command_PZ(ERROR_COMMAND)",5);
    return 0x7d1;
  }
  TextError(err_code + 2,sLine);
  iVar1 = memcmp(err_code + 2,"00",2);
  if (iVar1 != 0) {
    trace_event("End   command_PZ(CHECK_ERROR)",5);
    return 0x7d2;
  }
  trace_event("End   command_PZ(OK)",5);
  return 0;
}



// WARNING: Unknown calling convention

int command_FA(char *buffer_transmit,char *zmk_lmk,char *zpk_zmk)

{
  size_t sVar1;
  char *__dest;
  char ligne [512];
  
  if (debug_option == 1) {
    sprintf(ligne,"Start command_FA(%.48s, .48%s)",zmk_lmk,zpk_zmk);
  }
  else {
    builtin_strncpy(ligne,"Start command_FA()",0x13);
  }
  trace_event(ligne,5);
  buffer_transmit[0] = 'F';
  buffer_transmit[1] = 'A';
  sVar1 = strlen(zmk_lmk);
  memcpy(buffer_transmit + 2,zmk_lmk,sVar1);
  sVar1 = strlen(zmk_lmk);
  __dest = buffer_transmit + 2 + sVar1;
  sVar1 = strlen(zpk_zmk);
  if (sVar1 == 0x20) {
    *__dest = 'X';
    __dest = __dest + 1;
    sVar1 = strlen(zpk_zmk);
  }
  if (sVar1 == 0x30) {
    *__dest = 'T';
    __dest = __dest + 1;
    sVar1 = strlen(zpk_zmk);
  }
  memcpy(__dest,zpk_zmk,sVar1);
  trace_event("End   command_FA(OK)",5);
  return 0;
}



// WARNING: Unknown calling convention

int command_FB(char *buffer_received,char *zpk_lmk,char *check_value,char *err_code)

{
  char cVar1;
  int iVar2;
  ulong uVar3;
  char *pcVar4;
  char *pcVar5;
  ulong uVar6;
  bool bVar7;
  byte bVar8;
  char Command [3];
  char sLine [512];
  
  bVar8 = 0;
  trace_event("Start command_FB()",5);
  bVar7 = ((ulong)zpk_lmk & 1) != 0;
  uVar6 = 0x30;
  iVar2 = 0x30;
  if (bVar7) {
    *zpk_lmk = '\0';
    uVar6 = 0x2f;
    iVar2 = 0x2f;
    uVar3 = (ulong)(zpk_lmk + 1) & 2;
    pcVar5 = zpk_lmk + 1;
  }
  else {
    uVar3 = (ulong)zpk_lmk & 2;
    pcVar5 = zpk_lmk;
  }
  pcVar4 = pcVar5;
  if (uVar3 != 0) {
    pcVar4 = pcVar5 + 2;
    uVar6 = (ulong)(iVar2 - 2);
    pcVar5[0] = '\0';
    pcVar5[1] = '\0';
  }
  if (((ulong)pcVar4 & 4) != 0) {
    pcVar4[0] = '\0';
    pcVar4[1] = '\0';
    pcVar4[2] = '\0';
    pcVar4[3] = '\0';
    uVar6 = (ulong)((int)uVar6 - 4);
    pcVar4 = pcVar4 + 4;
  }
  for (uVar3 = uVar6 >> 3; uVar3 != 0; uVar3 = uVar3 - 1) {
    pcVar4[0] = '\0';
    pcVar4[1] = '\0';
    pcVar4[2] = '\0';
    pcVar4[3] = '\0';
    pcVar4[4] = '\0';
    pcVar4[5] = '\0';
    pcVar4[6] = '\0';
    pcVar4[7] = '\0';
    pcVar4 = pcVar4 + (ulong)bVar8 * -0x10 + 8;
  }
  if ((uVar6 & 4) != 0) {
    pcVar4[0] = '\0';
    pcVar4[1] = '\0';
    pcVar4[2] = '\0';
    pcVar4[3] = '\0';
    pcVar4 = pcVar4 + 4;
  }
  pcVar5 = pcVar4;
  if ((uVar6 & 2) != 0) {
    pcVar5 = pcVar4 + 2;
    pcVar4[0] = '\0';
    pcVar4[1] = '\0';
  }
  if (bVar7) {
    *pcVar5 = '\0';
  }
  check_value[0] = '\0';
  check_value[1] = '\0';
  check_value[2] = '\0';
  check_value[3] = '\0';
  check_value[4] = '\0';
  check_value[5] = '\0';
  check_value[6] = '\0';
  check_value[7] = '\0';
  check_value[8] = '\0';
  check_value[9] = '\0';
  check_value[10] = '\0';
  check_value[0xb] = '\0';
  check_value[0xc] = '\0';
  check_value[0xd] = '\0';
  check_value[0xe] = '\0';
  check_value[0xf] = '\0';
  Command._0_2_ = *(undefined2 *)buffer_received;
  Command[2] = '\0';
  *(undefined4 *)err_code = *(undefined4 *)buffer_received;
  iVar2 = memcmp(Command,"FB",2);
  if (iVar2 != 0) {
    trace_event("End   command_FB(ERROR_COMMAND)",5);
    return 0x7d1;
  }
  pcVar5 = err_code + 2;
  TextError(pcVar5,sLine);
  iVar2 = memcmp(pcVar5,"01",2);
  if (iVar2 == 0) {
    trace_event("WARNING !! : ODD PARITY ENFORCED",5);
  }
  else {
    iVar2 = memcmp(pcVar5,"00",2);
    if (iVar2 != 0) {
      trace_event("End   command_FB(CHECK_ERROR)",5);
      return 0x7d2;
    }
  }
  cVar1 = buffer_received[4];
  if (cVar1 == 'U') {
LAB_004613c0:
    trace_event("Triple DES Encryption Double Length",4);
    *(undefined8 *)zpk_lmk = *(undefined8 *)(buffer_received + 4);
    *(undefined8 *)(zpk_lmk + 8) = *(undefined8 *)(buffer_received + 0xc);
    *(undefined8 *)(zpk_lmk + 0x10) = *(undefined8 *)(buffer_received + 0x14);
    *(undefined8 *)(zpk_lmk + 0x18) = *(undefined8 *)(buffer_received + 0x1c);
    zpk_lmk[0x20] = buffer_received[0x24];
    *(undefined8 *)check_value = *(undefined8 *)(buffer_received + 0x25);
    *(undefined8 *)(check_value + 8) = *(undefined8 *)(buffer_received + 0x2d);
    zpk_lmk[0x21] = '\0';
  }
  else {
    if (cVar1 < 'V') {
      if (cVar1 == 'T') {
LAB_004612f8:
        trace_event("Triple DES Encryption Triple Length",4);
        *(undefined8 *)zpk_lmk = *(undefined8 *)(buffer_received + 4);
        *(undefined8 *)(zpk_lmk + 8) = *(undefined8 *)(buffer_received + 0xc);
        *(undefined8 *)(zpk_lmk + 0x10) = *(undefined8 *)(buffer_received + 0x14);
        *(undefined8 *)(zpk_lmk + 0x18) = *(undefined8 *)(buffer_received + 0x1c);
        *(undefined8 *)(zpk_lmk + 0x20) = *(undefined8 *)(buffer_received + 0x24);
        *(undefined8 *)(zpk_lmk + 0x28) = *(undefined8 *)(buffer_received + 0x2c);
        zpk_lmk[0x30] = buffer_received[0x34];
        *(undefined8 *)check_value = *(undefined8 *)(buffer_received + 0x35);
        *(undefined8 *)(check_value + 8) = *(undefined8 *)(buffer_received + 0x3d);
        zpk_lmk[0x31] = '\0';
        goto LAB_004612ad;
      }
    }
    else {
      if (cVar1 == 'X') goto LAB_004613c0;
      if (cVar1 == 'Y') goto LAB_004612f8;
    }
    trace_event("Single DES Encryption Single Length",4);
    *(undefined8 *)zpk_lmk = *(undefined8 *)(buffer_received + 4);
    *(undefined8 *)(zpk_lmk + 8) = *(undefined8 *)(buffer_received + 0xc);
    *(undefined8 *)check_value = *(undefined8 *)(buffer_received + 0x14);
    *(undefined8 *)(check_value + 8) = *(undefined8 *)(buffer_received + 0x1c);
    zpk_lmk[0x10] = '\0';
  }
LAB_004612ad:
  trace_event("End   command_FB(OK)",5);
  return 0;
}



// WARNING: Unknown calling convention

int command_FC(char *buffer_transmit,char *zmk_lmk,char *key_zmk)

{
  size_t sVar1;
  size_t __n;
  
  trace_event("Start command_FC()",5);
  buffer_transmit[0] = 'F';
  buffer_transmit[1] = 'C';
  sVar1 = strlen(zmk_lmk);
  memcpy(buffer_transmit + 2,zmk_lmk,sVar1);
  sVar1 = strlen(zmk_lmk);
  __n = strlen(key_zmk);
  memcpy(buffer_transmit + 2 + sVar1,key_zmk,__n);
  trace_event("End   command_FC(OK)",5);
  return 0;
}



// WARNING: Unknown calling convention

int command_FD(char *buffer_received,char *err_code,char *key_lmk)

{
  char cVar1;
  int iVar2;
  char Command [3];
  char check_value [17];
  char sLine [512];
  
  trace_event("Start command_FD()",5);
  if (debug_option == 1) {
    sprintf(sLine,"buffer_received=[%s]",buffer_received);
    trace_event(sLine,0);
  }
  key_lmk[0] = '\0';
  key_lmk[1] = '\0';
  key_lmk[2] = '\0';
  key_lmk[3] = '\0';
  key_lmk[4] = '\0';
  key_lmk[5] = '\0';
  key_lmk[6] = '\0';
  key_lmk[7] = '\0';
  key_lmk[8] = '\0';
  key_lmk[9] = '\0';
  key_lmk[10] = '\0';
  key_lmk[0xb] = '\0';
  key_lmk[0xc] = '\0';
  key_lmk[0xd] = '\0';
  key_lmk[0xe] = '\0';
  key_lmk[0xf] = '\0';
  Command._0_2_ = *(undefined2 *)buffer_received;
  Command[2] = '\0';
  *(undefined2 *)err_code = *(undefined2 *)(buffer_received + 2);
  iVar2 = memcmp(Command,&DAT_004cc00d,2);
  if (iVar2 != 0) {
    trace_event("End   command_FD(ERROR_COMMAND)",5);
    return 0x7d1;
  }
  TextError(err_code + 2,sLine);
  iVar2 = memcmp(err_code,"01",2);
  if (iVar2 == 0) {
    trace_event("WARNING FORCAGE PARITE",5);
  }
  else {
    iVar2 = memcmp(err_code,"00",2);
    if (iVar2 != 0) {
      trace_event("End   command_FD(CHECK_ERROR)",5);
      return 0x7d2;
    }
  }
  cVar1 = buffer_received[4];
  if (cVar1 == 'U') {
LAB_00461670:
    trace_event("Triple DES Encryption Double Length",4);
    *(undefined8 *)key_lmk = *(undefined8 *)(buffer_received + 4);
    *(undefined8 *)(key_lmk + 8) = *(undefined8 *)(buffer_received + 0xc);
    *(undefined8 *)(key_lmk + 0x10) = *(undefined8 *)(buffer_received + 0x14);
    *(undefined8 *)(key_lmk + 0x18) = *(undefined8 *)(buffer_received + 0x1c);
    key_lmk[0x20] = buffer_received[0x24];
    key_lmk[0x21] = '\0';
  }
  else {
    if (cVar1 < 'V') {
      if (cVar1 != 'T') {
LAB_004616f0:
        trace_event("Single DES Encryption Single Length",4);
        *(undefined8 *)key_lmk = *(undefined8 *)(buffer_received + 4);
        *(undefined8 *)(key_lmk + 8) = *(undefined8 *)(buffer_received + 0xc);
        key_lmk[0x10] = '\0';
        goto LAB_004616c0;
      }
    }
    else {
      if (cVar1 == 'X') goto LAB_00461670;
      if (cVar1 != 'Y') goto LAB_004616f0;
    }
    trace_event("Triple DES Encryption Triple Length",4);
    *(undefined8 *)key_lmk = *(undefined8 *)(buffer_received + 4);
    *(undefined8 *)(key_lmk + 8) = *(undefined8 *)(buffer_received + 0xc);
    *(undefined8 *)(key_lmk + 0x10) = *(undefined8 *)(buffer_received + 0x14);
    *(undefined8 *)(key_lmk + 0x18) = *(undefined8 *)(buffer_received + 0x1c);
    *(undefined8 *)(key_lmk + 0x20) = *(undefined8 *)(buffer_received + 0x24);
    *(undefined8 *)(key_lmk + 0x28) = *(undefined8 *)(buffer_received + 0x2c);
    key_lmk[0x30] = buffer_received[0x34];
    key_lmk[0x31] = '\0';
  }
LAB_004616c0:
  if (debug_option == 1) {
    sprintf(sLine,"==> key_lmk=[%s]",key_lmk);
    trace_event(sLine,0);
  }
  trace_event("End   command_FD(OK)",5);
  return 0;
}



// WARNING: Unknown calling convention

int command_FE(char *buffer_transmit,char *zmk_lmk,char *key_lmk)

{
  size_t sVar1;
  size_t __n;
  
  trace_event("Start command_FE()",5);
  buffer_transmit[0] = 'F';
  buffer_transmit[1] = 'E';
  sVar1 = strlen(zmk_lmk);
  memcpy(buffer_transmit + 2,zmk_lmk,sVar1);
  sVar1 = strlen(zmk_lmk);
  __n = strlen(key_lmk);
  memcpy(buffer_transmit + 2 + sVar1,key_lmk,__n);
  trace_event("End   command_FE()",5);
  return 0;
}



// WARNING: Unknown calling convention

int command_FF(char *buffer_received,char *key_zmk,char *check_value,char *err_code)

{
  char cVar1;
  int iVar2;
  char Command [3];
  char sLine [512];
  
  trace_event("Start command_FF()",5);
  check_value[0] = '\0';
  check_value[1] = '\0';
  check_value[2] = '\0';
  check_value[3] = '\0';
  check_value[4] = '\0';
  check_value[5] = '\0';
  check_value[6] = '\0';
  check_value[7] = '\0';
  check_value[8] = '\0';
  check_value[9] = '\0';
  check_value[10] = '\0';
  check_value[0xb] = '\0';
  check_value[0xc] = '\0';
  check_value[0xd] = '\0';
  check_value[0xe] = '\0';
  check_value[0xf] = '\0';
  Command._0_2_ = *(undefined2 *)buffer_received;
  Command[2] = '\0';
  *(undefined4 *)err_code = *(undefined4 *)buffer_received;
  iVar2 = memcmp(Command,"FF",2);
  if (iVar2 != 0) {
    trace_event("End   command_FF(ERROR_COMMAND)",5);
    return 0x7d1;
  }
  TextError(err_code + 2,sLine);
  iVar2 = memcmp(err_code + 2,"00",2);
  if (iVar2 != 0) {
    trace_event("End   command_FF(CHECK_ERROR)",5);
    return 0x7d2;
  }
  cVar1 = buffer_received[4];
  if (cVar1 == 'U') {
LAB_00461a08:
    trace_event("Triple DES Encryption Double Length",4);
    *(undefined8 *)key_zmk = *(undefined8 *)(buffer_received + 4);
    *(undefined8 *)(key_zmk + 8) = *(undefined8 *)(buffer_received + 0xc);
    *(undefined8 *)(key_zmk + 0x10) = *(undefined8 *)(buffer_received + 0x14);
    *(undefined8 *)(key_zmk + 0x18) = *(undefined8 *)(buffer_received + 0x1c);
    *(undefined8 *)check_value = *(undefined8 *)(buffer_received + 0x24);
    *(undefined8 *)(check_value + 8) = *(undefined8 *)(buffer_received + 0x2c);
    key_zmk[0x20] = '\0';
  }
  else {
    if (cVar1 < 'V') {
      if (cVar1 == 'T') {
LAB_004619a8:
        trace_event("Triple DES Encryption Triple Length",4);
        *(undefined8 *)key_zmk = *(undefined8 *)(buffer_received + 4);
        *(undefined8 *)(key_zmk + 8) = *(undefined8 *)(buffer_received + 0xc);
        *(undefined8 *)(key_zmk + 0x10) = *(undefined8 *)(buffer_received + 0x14);
        *(undefined8 *)(key_zmk + 0x18) = *(undefined8 *)(buffer_received + 0x1c);
        *(undefined8 *)(key_zmk + 0x20) = *(undefined8 *)(buffer_received + 0x24);
        *(undefined8 *)(key_zmk + 0x28) = *(undefined8 *)(buffer_received + 0x2c);
        *(undefined8 *)check_value = *(undefined8 *)(buffer_received + 0x34);
        *(undefined8 *)(check_value + 8) = *(undefined8 *)(buffer_received + 0x3c);
        key_zmk[0x30] = '\0';
        goto LAB_00461962;
      }
    }
    else {
      if (cVar1 == 'X') goto LAB_00461a08;
      if (cVar1 == 'Y') goto LAB_004619a8;
    }
    trace_event("Single DES Encryption Single Length",4);
    *(undefined8 *)key_zmk = *(undefined8 *)(buffer_received + 4);
    *(undefined8 *)(key_zmk + 8) = *(undefined8 *)(buffer_received + 0xc);
    *(undefined8 *)check_value = *(undefined8 *)(buffer_received + 0x14);
    *(undefined8 *)(check_value + 8) = *(undefined8 *)(buffer_received + 0x1c);
    key_zmk[0x10] = '\0';
  }
LAB_00461962:
  trace_event("End   command_FF(OK)",5);
  return 0;
}



// WARNING: Unknown calling convention

int command_FI(char *buffer_transmit,char *zmk_lmk)

{
  size_t __n;
  
  trace_event("Start command_FI()",5);
  buffer_transmit[2] = '1';
  buffer_transmit[0] = 'F';
  buffer_transmit[1] = 'I';
  __n = strlen(zmk_lmk);
  memcpy(buffer_transmit + 3,zmk_lmk,__n);
  trace_event("End   command_FI(OK)",5);
  return 0;
}



// WARNING: Unknown calling convention

int command_FJ(char *buffer_received,char *zak_zmk,char *zak_lmk,char *check_value,char *err_code)

{
  char cVar1;
  int iVar2;
  char Command [3];
  char sLine [512];
  
  trace_event("Start command_FJ()",5);
  zak_lmk[0] = '\0';
  zak_lmk[1] = '\0';
  zak_lmk[2] = '\0';
  zak_lmk[3] = '\0';
  zak_lmk[4] = '\0';
  zak_lmk[5] = '\0';
  zak_lmk[6] = '\0';
  zak_lmk[7] = '\0';
  zak_lmk[8] = '\0';
  zak_lmk[9] = '\0';
  zak_lmk[10] = '\0';
  zak_lmk[0xb] = '\0';
  zak_lmk[0xc] = '\0';
  zak_lmk[0xd] = '\0';
  zak_lmk[0xe] = '\0';
  zak_lmk[0xf] = '\0';
  zak_zmk[0] = '\0';
  zak_zmk[1] = '\0';
  zak_zmk[2] = '\0';
  zak_zmk[3] = '\0';
  zak_zmk[4] = '\0';
  zak_zmk[5] = '\0';
  zak_zmk[6] = '\0';
  zak_zmk[7] = '\0';
  zak_zmk[8] = '\0';
  zak_zmk[9] = '\0';
  zak_zmk[10] = '\0';
  zak_zmk[0xb] = '\0';
  zak_zmk[0xc] = '\0';
  zak_zmk[0xd] = '\0';
  zak_zmk[0xe] = '\0';
  zak_zmk[0xf] = '\0';
  check_value[0] = '\0';
  check_value[1] = '\0';
  check_value[2] = '\0';
  check_value[3] = '\0';
  check_value[4] = '\0';
  check_value[5] = '\0';
  check_value[6] = '\0';
  check_value[7] = '\0';
  check_value[8] = '\0';
  check_value[9] = '\0';
  check_value[10] = '\0';
  check_value[0xb] = '\0';
  check_value[0xc] = '\0';
  check_value[0xd] = '\0';
  check_value[0xe] = '\0';
  check_value[0xf] = '\0';
  Command._0_2_ = *(undefined2 *)buffer_received;
  Command[2] = '\0';
  *(undefined4 *)err_code = *(undefined4 *)buffer_received;
  iVar2 = memcmp(Command,&DAT_004cc112,2);
  if (iVar2 != 0) {
    trace_event("End   command_FJ(ERROR_COMMAND)",5);
    return 0x7d1;
  }
  TextError(err_code + 2,sLine);
  iVar2 = memcmp(err_code + 2,"00",2);
  if (iVar2 != 0) {
    trace_event("End   command_FJ(CHECK_ERROR)",5);
    return 0x7d2;
  }
  cVar1 = buffer_received[4];
  if (cVar1 == 'U') {
LAB_00461d00:
    *(undefined8 *)zak_zmk = *(undefined8 *)(buffer_received + 4);
    *(undefined8 *)(zak_zmk + 8) = *(undefined8 *)(buffer_received + 0xc);
    *(undefined8 *)(zak_zmk + 0x10) = *(undefined8 *)(buffer_received + 0x14);
    *(undefined8 *)(zak_zmk + 0x18) = *(undefined8 *)(buffer_received + 0x1c);
    *(undefined8 *)zak_lmk = *(undefined8 *)(buffer_received + 0x24);
    *(undefined8 *)(zak_lmk + 8) = *(undefined8 *)(buffer_received + 0x2c);
    *(undefined8 *)(zak_lmk + 0x10) = *(undefined8 *)(buffer_received + 0x34);
    *(undefined8 *)(zak_lmk + 0x18) = *(undefined8 *)(buffer_received + 0x3c);
    *(undefined8 *)check_value = *(undefined8 *)(buffer_received + 0x44);
    *(undefined8 *)(check_value + 8) = *(undefined8 *)(buffer_received + 0x4c);
    zak_zmk[0x20] = '\0';
  }
  else {
    if (cVar1 < 'V') {
      if (cVar1 == 'T') {
LAB_00461c68:
        trace_event("Triple DES Encryption Triple Length",4);
        *(undefined8 *)zak_zmk = *(undefined8 *)(buffer_received + 4);
        *(undefined8 *)(zak_zmk + 8) = *(undefined8 *)(buffer_received + 0xc);
        *(undefined8 *)(zak_zmk + 0x10) = *(undefined8 *)(buffer_received + 0x14);
        *(undefined8 *)(zak_zmk + 0x18) = *(undefined8 *)(buffer_received + 0x1c);
        *(undefined8 *)(zak_zmk + 0x20) = *(undefined8 *)(buffer_received + 0x24);
        *(undefined8 *)(zak_zmk + 0x28) = *(undefined8 *)(buffer_received + 0x2c);
        *(undefined8 *)zak_lmk = *(undefined8 *)(buffer_received + 0x34);
        *(undefined8 *)(zak_lmk + 8) = *(undefined8 *)(buffer_received + 0x3c);
        *(undefined8 *)(zak_lmk + 0x10) = *(undefined8 *)(buffer_received + 0x44);
        *(undefined8 *)(zak_lmk + 0x18) = *(undefined8 *)(buffer_received + 0x4c);
        *(undefined8 *)(zak_lmk + 0x20) = *(undefined8 *)(buffer_received + 0x54);
        *(undefined8 *)(zak_lmk + 0x28) = *(undefined8 *)(buffer_received + 0x5c);
        *(undefined8 *)check_value = *(undefined8 *)(buffer_received + 100);
        *(undefined8 *)(check_value + 8) = *(undefined8 *)(buffer_received + 0x6c);
        zak_zmk[0x30] = '\0';
        goto LAB_00461c1e;
      }
    }
    else {
      if (cVar1 == 'X') goto LAB_00461d00;
      if (cVar1 == 'Y') goto LAB_00461c68;
    }
    trace_event("Single DES Encryption Single Length",4);
    *(undefined8 *)zak_zmk = *(undefined8 *)(buffer_received + 4);
    *(undefined8 *)(zak_zmk + 8) = *(undefined8 *)(buffer_received + 0xc);
    *(undefined8 *)zak_lmk = *(undefined8 *)(buffer_received + 0x14);
    *(undefined8 *)(zak_lmk + 8) = *(undefined8 *)(buffer_received + 0x1c);
    *(undefined8 *)check_value = *(undefined8 *)(buffer_received + 0x24);
    *(undefined8 *)(check_value + 8) = *(undefined8 *)(buffer_received + 0x2c);
    zak_zmk[0x10] = '\0';
  }
LAB_00461c1e:
  trace_event("End   command_FJ(OK)",5);
  return 0;
}



// WARNING: Unknown calling convention

int command_FK(char *buffer_transmit,char *zmk_lmk,char *zak_zmk)

{
  size_t sVar1;
  size_t __n;
  
  trace_event("Start command_FK()",5);
  buffer_transmit[2] = '1';
  buffer_transmit[0] = 'F';
  buffer_transmit[1] = 'K';
  sVar1 = strlen(zmk_lmk);
  memcpy(buffer_transmit + 3,zmk_lmk,sVar1);
  sVar1 = strlen(zmk_lmk);
  __n = strlen(zak_zmk);
  memcpy(buffer_transmit + 3 + sVar1,zak_zmk,__n);
  trace_event("End   command_FK(OK)",5);
  return 0;
}



// WARNING: Unknown calling convention

int command_FL(char *buffer_received,char *zak_lmk,char *check_value,char *err_code)

{
  char cVar1;
  int iVar2;
  char Command [3];
  char sLine [512];
  
  trace_event("Start command_FL()",5);
  zak_lmk[0] = '\0';
  zak_lmk[1] = '\0';
  zak_lmk[2] = '\0';
  zak_lmk[3] = '\0';
  zak_lmk[4] = '\0';
  zak_lmk[5] = '\0';
  zak_lmk[6] = '\0';
  zak_lmk[7] = '\0';
  zak_lmk[8] = '\0';
  zak_lmk[9] = '\0';
  zak_lmk[10] = '\0';
  zak_lmk[0xb] = '\0';
  zak_lmk[0xc] = '\0';
  zak_lmk[0xd] = '\0';
  zak_lmk[0xe] = '\0';
  zak_lmk[0xf] = '\0';
  check_value[0] = '\0';
  check_value[1] = '\0';
  check_value[2] = '\0';
  check_value[3] = '\0';
  check_value[4] = '\0';
  check_value[5] = '\0';
  check_value[6] = '\0';
  check_value[7] = '\0';
  check_value[8] = '\0';
  check_value[9] = '\0';
  check_value[10] = '\0';
  check_value[0xb] = '\0';
  check_value[0xc] = '\0';
  check_value[0xd] = '\0';
  check_value[0xe] = '\0';
  check_value[0xf] = '\0';
  Command._0_2_ = *(undefined2 *)buffer_received;
  Command[2] = '\0';
  *(undefined4 *)err_code = *(undefined4 *)buffer_received;
  iVar2 = memcmp(Command,&DAT_004a2afc,2);
  if (iVar2 != 0) {
    trace_event("End   command_FL(ERROR_COMMAND)",5);
    return 0x7d1;
  }
  TextError(err_code + 2,sLine);
  iVar2 = memcmp(err_code + 2,"00",2);
  if (iVar2 != 0) {
    trace_event("End   command_FL(CHECK_ERROR)",5);
    return 0x7d2;
  }
  cVar1 = buffer_received[4];
  if (cVar1 == 'U') {
LAB_00461fd8:
    trace_event("Triple DES Encryption Double Length",4);
    *(undefined8 *)zak_lmk = *(undefined8 *)(buffer_received + 4);
    *(undefined8 *)(zak_lmk + 8) = *(undefined8 *)(buffer_received + 0xc);
    *(undefined8 *)(zak_lmk + 0x10) = *(undefined8 *)(buffer_received + 0x14);
    *(undefined8 *)(zak_lmk + 0x18) = *(undefined8 *)(buffer_received + 0x1c);
    *(undefined8 *)check_value = *(undefined8 *)(buffer_received + 0x24);
    *(undefined8 *)(check_value + 8) = *(undefined8 *)(buffer_received + 0x2c);
    zak_lmk[0x20] = '\0';
  }
  else {
    if (cVar1 < 'V') {
      if (cVar1 == 'T') {
LAB_00461f78:
        trace_event("Triple DES Encryption Triple Length",4);
        *(undefined8 *)zak_lmk = *(undefined8 *)(buffer_received + 4);
        *(undefined8 *)(zak_lmk + 8) = *(undefined8 *)(buffer_received + 0xc);
        *(undefined8 *)(zak_lmk + 0x10) = *(undefined8 *)(buffer_received + 0x14);
        *(undefined8 *)(zak_lmk + 0x18) = *(undefined8 *)(buffer_received + 0x1c);
        *(undefined8 *)(zak_lmk + 0x20) = *(undefined8 *)(buffer_received + 0x24);
        *(undefined8 *)(zak_lmk + 0x28) = *(undefined8 *)(buffer_received + 0x2c);
        *(undefined8 *)check_value = *(undefined8 *)(buffer_received + 0x34);
        *(undefined8 *)(check_value + 8) = *(undefined8 *)(buffer_received + 0x3c);
        zak_lmk[0x30] = '\0';
        goto LAB_00461f2d;
      }
    }
    else {
      if (cVar1 == 'X') goto LAB_00461fd8;
      if (cVar1 == 'Y') goto LAB_00461f78;
    }
    trace_event("Single DES Encryption Single Length",4);
    *(undefined8 *)zak_lmk = *(undefined8 *)(buffer_received + 4);
    *(undefined8 *)(zak_lmk + 8) = *(undefined8 *)(buffer_received + 0xc);
    *(undefined8 *)check_value = *(undefined8 *)(buffer_received + 0x14);
    *(undefined8 *)(check_value + 8) = *(undefined8 *)(buffer_received + 0x1c);
    zak_lmk[0x10] = '\0';
  }
LAB_00461f2d:
  trace_event("End   command_FL(OK)",5);
  return 0;
}



// WARNING: Unknown calling convention

int command_FM(char *buffer_transmit,char *zmk_lmk,char *zak_lmk)

{
  size_t sVar1;
  size_t __n;
  
  trace_event("Start command_FM()",5);
  buffer_transmit[2] = '1';
  buffer_transmit[0] = 'F';
  buffer_transmit[1] = 'M';
  sVar1 = strlen(zmk_lmk);
  memcpy(buffer_transmit + 3,zmk_lmk,sVar1);
  sVar1 = strlen(zmk_lmk);
  __n = strlen(zak_lmk);
  memcpy(buffer_transmit + 3 + sVar1,zak_lmk,__n);
  trace_event("End   command_FM()",5);
  return 0;
}



// WARNING: Unknown calling convention

int command_FN(char *buffer_received,char *zak_zmk,char *err_code)

{
  char cVar1;
  undefined8 uVar2;
  int iVar3;
  char Command [3];
  char sLine [512];
  
  trace_event("Start command_FN()",5);
  zak_zmk[0] = '\0';
  zak_zmk[1] = '\0';
  zak_zmk[2] = '\0';
  zak_zmk[3] = '\0';
  zak_zmk[4] = '\0';
  zak_zmk[5] = '\0';
  zak_zmk[6] = '\0';
  zak_zmk[7] = '\0';
  zak_zmk[8] = '\0';
  zak_zmk[9] = '\0';
  zak_zmk[10] = '\0';
  zak_zmk[0xb] = '\0';
  zak_zmk[0xc] = '\0';
  zak_zmk[0xd] = '\0';
  zak_zmk[0xe] = '\0';
  zak_zmk[0xf] = '\0';
  Command._0_2_ = *(undefined2 *)buffer_received;
  Command[2] = '\0';
  *(undefined4 *)err_code = *(undefined4 *)buffer_received;
  iVar3 = memcmp(Command,&DAT_004cc1ef,2);
  if (iVar3 != 0) {
    trace_event("End   command_FN(ERROR_COMMAND)",5);
    return 0x7d1;
  }
  TextError(err_code + 2,sLine);
  iVar3 = memcmp(err_code + 2,"00",2);
  if (iVar3 != 0) {
    trace_event("End   command_FN(CHECK_ERROR)",5);
    return 0x7d2;
  }
  cVar1 = buffer_received[4];
  if (cVar1 == 'U') {
LAB_00462240:
    trace_event("Triple DES Encryption Double Length",4);
    *(undefined8 *)zak_zmk = *(undefined8 *)(buffer_received + 4);
    *(undefined8 *)(zak_zmk + 8) = *(undefined8 *)(buffer_received + 0xc);
    *(undefined8 *)(zak_zmk + 0x10) = *(undefined8 *)(buffer_received + 0x14);
    uVar2 = *(undefined8 *)(buffer_received + 0x1c);
    zak_zmk[0x20] = '\0';
    *(undefined8 *)(zak_zmk + 0x18) = uVar2;
  }
  else {
    if (cVar1 < 'V') {
      if (cVar1 != 'T') {
LAB_00462214:
        trace_event("Single DES Encryption Single Length",4);
        *(undefined8 *)zak_zmk = *(undefined8 *)(buffer_received + 4);
        uVar2 = *(undefined8 *)(buffer_received + 0xc);
        zak_zmk[0x10] = '\0';
        *(undefined8 *)(zak_zmk + 8) = uVar2;
        return 0;
      }
    }
    else {
      if (cVar1 == 'X') goto LAB_00462240;
      if (cVar1 != 'Y') goto LAB_00462214;
    }
    trace_event("Triple DES Encryption Triple Length",4);
    *(undefined8 *)zak_zmk = *(undefined8 *)(buffer_received + 4);
    *(undefined8 *)(zak_zmk + 8) = *(undefined8 *)(buffer_received + 0xc);
    *(undefined8 *)(zak_zmk + 0x10) = *(undefined8 *)(buffer_received + 0x14);
    *(undefined8 *)(zak_zmk + 0x18) = *(undefined8 *)(buffer_received + 0x1c);
    *(undefined8 *)(zak_zmk + 0x20) = *(undefined8 *)(buffer_received + 0x24);
    uVar2 = *(undefined8 *)(buffer_received + 0x2c);
    zak_zmk[0x30] = '\0';
    *(undefined8 *)(zak_zmk + 0x28) = uVar2;
  }
  return 0;
}



// WARNING: Unknown calling convention

int command_GC(char *buffer_transmit,char *zmk_lmk,char *zpk_lmk)

{
  size_t sVar1;
  size_t __n;
  
  trace_event("Start command_GC()",5);
  buffer_transmit[0] = 'G';
  buffer_transmit[1] = 'C';
  sVar1 = strlen(zmk_lmk);
  memcpy(buffer_transmit + 2,zmk_lmk,sVar1);
  sVar1 = strlen(zmk_lmk);
  __n = strlen(zpk_lmk);
  memcpy(buffer_transmit + 2 + sVar1,zpk_lmk,__n);
  trace_event("End   command_GC()",5);
  return 0;
}



// WARNING: Unknown calling convention

int command_GD(char *buffer_received,char *zpk_zmk,char *check_value,char *err_code)

{
  char cVar1;
  undefined8 uVar2;
  int iVar3;
  char Command [3];
  char sLine [512];
  
  trace_event("Start command_GD()",5);
  zpk_zmk[0] = '\0';
  zpk_zmk[1] = '\0';
  zpk_zmk[2] = '\0';
  zpk_zmk[3] = '\0';
  zpk_zmk[4] = '\0';
  zpk_zmk[5] = '\0';
  zpk_zmk[6] = '\0';
  zpk_zmk[7] = '\0';
  zpk_zmk[8] = '\0';
  zpk_zmk[9] = '\0';
  zpk_zmk[10] = '\0';
  zpk_zmk[0xb] = '\0';
  zpk_zmk[0xc] = '\0';
  zpk_zmk[0xd] = '\0';
  zpk_zmk[0xe] = '\0';
  zpk_zmk[0xf] = '\0';
  check_value[0] = '\0';
  check_value[1] = '\0';
  check_value[2] = '\0';
  check_value[3] = '\0';
  check_value[4] = '\0';
  check_value[5] = '\0';
  check_value[6] = '\0';
  check_value[7] = '\0';
  check_value[8] = '\0';
  check_value[9] = '\0';
  check_value[10] = '\0';
  check_value[0xb] = '\0';
  check_value[0xc] = '\0';
  check_value[0xd] = '\0';
  check_value[0xe] = '\0';
  check_value[0xf] = '\0';
  Command._0_2_ = *(undefined2 *)buffer_received;
  Command[2] = '\0';
  *(undefined4 *)err_code = *(undefined4 *)buffer_received;
  iVar3 = memcmp(Command,&DAT_004cc249,2);
  if (iVar3 != 0) {
    trace_event("End   command_GD(ERROR_COMMAND)",5);
    return 0x7d1;
  }
  TextError(err_code + 2,sLine);
  iVar3 = memcmp(err_code + 2,"00",2);
  if (iVar3 != 0) {
    trace_event("End   command_GD(ERROR_COMMAND)",5);
    return 0x7d2;
  }
  cVar1 = buffer_received[4];
  if (cVar1 == 'U') {
LAB_004624f8:
    trace_event("Triple DES Encryption Double Length",4);
    *(undefined8 *)zpk_zmk = *(undefined8 *)(buffer_received + 4);
    *(undefined8 *)(zpk_zmk + 8) = *(undefined8 *)(buffer_received + 0xc);
    *(undefined8 *)(zpk_zmk + 0x10) = *(undefined8 *)(buffer_received + 0x14);
    uVar2 = *(undefined8 *)(buffer_received + 0x1c);
    zpk_zmk[0x20] = '\0';
    *(undefined8 *)(zpk_zmk + 0x18) = uVar2;
    *(undefined8 *)check_value = *(undefined8 *)(buffer_received + 0x24);
    *(undefined8 *)(check_value + 8) = *(undefined8 *)(buffer_received + 0x2c);
  }
  else {
    if (cVar1 < 'V') {
      if (cVar1 == 'T') {
LAB_00462498:
        trace_event("Triple DES Encryption Triple Length",4);
        *(undefined8 *)zpk_zmk = *(undefined8 *)(buffer_received + 4);
        *(undefined8 *)(zpk_zmk + 8) = *(undefined8 *)(buffer_received + 0xc);
        *(undefined8 *)(zpk_zmk + 0x10) = *(undefined8 *)(buffer_received + 0x14);
        *(undefined8 *)(zpk_zmk + 0x18) = *(undefined8 *)(buffer_received + 0x1c);
        *(undefined8 *)(zpk_zmk + 0x20) = *(undefined8 *)(buffer_received + 0x24);
        uVar2 = *(undefined8 *)(buffer_received + 0x2c);
        zpk_zmk[0x30] = '\0';
        *(undefined8 *)(zpk_zmk + 0x28) = uVar2;
        *(undefined8 *)check_value = *(undefined8 *)(buffer_received + 0x34);
        *(undefined8 *)(check_value + 8) = *(undefined8 *)(buffer_received + 0x3c);
        goto LAB_0046244d;
      }
    }
    else {
      if (cVar1 == 'X') goto LAB_004624f8;
      if (cVar1 == 'Y') goto LAB_00462498;
    }
    trace_event("Single DES Encryption Single Length",4);
    *(undefined8 *)zpk_zmk = *(undefined8 *)(buffer_received + 4);
    uVar2 = *(undefined8 *)(buffer_received + 0xc);
    zpk_zmk[0x10] = '\0';
    *(undefined8 *)(zpk_zmk + 8) = uVar2;
    *(undefined8 *)check_value = *(undefined8 *)(buffer_received + 0x14);
    *(undefined8 *)(check_value + 8) = *(undefined8 *)(buffer_received + 0x1c);
  }
LAB_0046244d:
  trace_event("End   command_GD(OK)",5);
  return 0;
}



// WARNING: Unknown calling convention

int command_GG(char *buffer_transmit,char *zmk1_lmk,char *zmk2_lmk,char *zmk3_lmk)

{
  size_t sVar1;
  size_t sVar2;
  size_t __n;
  char *__dest;
  
  __dest = buffer_transmit + 2;
  trace_event("Start command_GG()",5);
  buffer_transmit[0] = 'G';
  buffer_transmit[1] = 'G';
  sVar1 = strlen(zmk1_lmk);
  memcpy(__dest,zmk1_lmk,sVar1);
  sVar1 = strlen(zmk1_lmk);
  sVar2 = strlen(zmk2_lmk);
  memcpy(__dest + sVar1,zmk2_lmk,sVar2);
  sVar2 = strlen(zmk2_lmk);
  __n = strlen(zmk3_lmk);
  memcpy(__dest + sVar1 + sVar2,zmk3_lmk,__n);
  trace_event("End   command_GG()",5);
  return 0;
}



// WARNING: Unknown calling convention

int command_GH(char *buffer_received,char *zmk_lmk,char *check_value,char *err_code)

{
  char cVar1;
  undefined8 uVar2;
  int iVar3;
  size_t sVar4;
  char Command [3];
  char sLine [512];
  
  trace_event("Start command_GH()",5);
  zmk_lmk[0] = '\0';
  zmk_lmk[1] = '\0';
  zmk_lmk[2] = '\0';
  zmk_lmk[3] = '\0';
  zmk_lmk[4] = '\0';
  zmk_lmk[5] = '\0';
  zmk_lmk[6] = '\0';
  zmk_lmk[7] = '\0';
  zmk_lmk[8] = '\0';
  zmk_lmk[9] = '\0';
  zmk_lmk[10] = '\0';
  zmk_lmk[0xb] = '\0';
  zmk_lmk[0xc] = '\0';
  zmk_lmk[0xd] = '\0';
  zmk_lmk[0xe] = '\0';
  zmk_lmk[0xf] = '\0';
  Command._0_2_ = *(undefined2 *)buffer_received;
  Command[2] = '\0';
  *(undefined4 *)err_code = *(undefined4 *)buffer_received;
  iVar3 = memcmp(Command,&DAT_004cc29a,2);
  if (iVar3 != 0) {
    trace_event("End   command_GH(ERROR_COMMAND)",5);
    return 0x7d1;
  }
  TextError(err_code + 2,sLine);
  iVar3 = memcmp(err_code + 2,"00",2);
  if (iVar3 != 0) {
    trace_event("End   command_GH(CHECK_ERROR)",5);
    return 0x7d2;
  }
  cVar1 = buffer_received[4];
  if (cVar1 == 'U') {
LAB_004627f8:
    trace_event("Triple DES Encryption Double Length",4);
    *(undefined8 *)zmk_lmk = *(undefined8 *)(buffer_received + 4);
    *(undefined8 *)(zmk_lmk + 8) = *(undefined8 *)(buffer_received + 0xc);
LAB_004627b8:
    *(undefined8 *)(zmk_lmk + 0x10) = *(undefined8 *)(buffer_received + 0x14);
    uVar2 = *(undefined8 *)(buffer_received + 0x1c);
    zmk_lmk[0x20] = '\0';
    *(undefined8 *)(zmk_lmk + 0x18) = uVar2;
    *(undefined8 *)check_value = *(undefined8 *)(buffer_received + 0x24);
    *(undefined8 *)(check_value + 8) = *(undefined8 *)(buffer_received + 0x2c);
  }
  else {
    if (cVar1 < 'V') {
      if (cVar1 != 'T') {
LAB_00462788:
        trace_event("Single DES Encryption Single Length",4);
        sVar4 = strlen(buffer_received + 4);
        *(undefined8 *)zmk_lmk = *(undefined8 *)(buffer_received + 4);
        *(undefined8 *)(zmk_lmk + 8) = *(undefined8 *)(buffer_received + 0xc);
        if (sVar4 < 0x21) {
          zmk_lmk[0x10] = '\0';
          *(undefined8 *)check_value = *(undefined8 *)(buffer_received + 0x14);
          *(undefined8 *)(check_value + 8) = *(undefined8 *)(buffer_received + 0x1c);
          goto LAB_004627dc;
        }
        goto LAB_004627b8;
      }
    }
    else {
      if (cVar1 == 'X') goto LAB_004627f8;
      if (cVar1 != 'Y') goto LAB_00462788;
    }
    trace_event("Triple DES Encryption Triple Length",4);
    *(undefined8 *)zmk_lmk = *(undefined8 *)(buffer_received + 4);
    *(undefined8 *)(zmk_lmk + 8) = *(undefined8 *)(buffer_received + 0xc);
    *(undefined8 *)(zmk_lmk + 0x10) = *(undefined8 *)(buffer_received + 0x14);
    *(undefined8 *)(zmk_lmk + 0x18) = *(undefined8 *)(buffer_received + 0x1c);
    *(undefined8 *)(zmk_lmk + 0x20) = *(undefined8 *)(buffer_received + 0x24);
    uVar2 = *(undefined8 *)(buffer_received + 0x2c);
    zmk_lmk[0x30] = '\0';
    *(undefined8 *)(zmk_lmk + 0x28) = uVar2;
    *(undefined8 *)check_value = *(undefined8 *)(buffer_received + 0x34);
    *(undefined8 *)(check_value + 8) = *(undefined8 *)(buffer_received + 0x3c);
  }
LAB_004627dc:
  trace_event("End   command_GH(OK)",5);
  return 0;
}



// WARNING: Unknown calling convention

int command_HA(char *buffer_transmit,char *tmk_lmk)

{
  size_t __n;
  
  trace_event("Start command_HA()",5);
  buffer_transmit[0] = 'H';
  buffer_transmit[1] = 'A';
  __n = strlen(tmk_lmk);
  memcpy(buffer_transmit + 2,tmk_lmk,__n);
  trace_event("End   command_HA(OK)",5);
  return 0;
}



// WARNING: Unknown calling convention

int command_HA_TDES(char *buffer_transmit,char *zmk_lmk)

{
  size_t sVar1;
  
  trace_event("Start command_HA_TDES()",5);
  buffer_transmit[0] = 'H';
  buffer_transmit[1] = 'A';
  sVar1 = strlen(zmk_lmk);
  memcpy(buffer_transmit + 2,zmk_lmk,sVar1);
  sVar1 = strlen(zmk_lmk);
  builtin_strncpy(buffer_transmit + sVar1 + 2,";XU0",4);
  trace_event("End   command_HA_TDES()",5);
  return 0;
}



// WARNING: Unknown calling convention

int command_HB(char *buffer_received,char *tak_tmk,char *tak_lmk,char *err_code)

{
  char cVar1;
  undefined8 uVar2;
  int iVar3;
  char Command [3];
  char sLine [512];
  
  trace_event("Start command_HB()",5);
  tak_lmk[0] = '\0';
  tak_lmk[1] = '\0';
  tak_lmk[2] = '\0';
  tak_lmk[3] = '\0';
  tak_lmk[4] = '\0';
  tak_lmk[5] = '\0';
  tak_lmk[6] = '\0';
  tak_lmk[7] = '\0';
  tak_lmk[8] = '\0';
  tak_lmk[9] = '\0';
  tak_lmk[10] = '\0';
  tak_lmk[0xb] = '\0';
  tak_lmk[0xc] = '\0';
  tak_lmk[0xd] = '\0';
  tak_lmk[0xe] = '\0';
  tak_lmk[0xf] = '\0';
  tak_tmk[0] = '\0';
  tak_tmk[1] = '\0';
  tak_tmk[2] = '\0';
  tak_tmk[3] = '\0';
  tak_tmk[4] = '\0';
  tak_tmk[5] = '\0';
  tak_tmk[6] = '\0';
  tak_tmk[7] = '\0';
  tak_tmk[8] = '\0';
  tak_tmk[9] = '\0';
  tak_tmk[10] = '\0';
  tak_tmk[0xb] = '\0';
  tak_tmk[0xc] = '\0';
  tak_tmk[0xd] = '\0';
  tak_tmk[0xe] = '\0';
  tak_tmk[0xf] = '\0';
  Command._0_2_ = *(undefined2 *)buffer_received;
  Command[2] = '\0';
  *(undefined4 *)err_code = *(undefined4 *)buffer_received;
  iVar3 = memcmp(Command,&DAT_004cc33b,2);
  if (iVar3 != 0) {
    trace_event("End   command_HB(ERROR_COMMAND)",5);
    return 0x7d1;
  }
  TextError(err_code + 2,sLine);
  iVar3 = memcmp(err_code + 2,"00",2);
  if (iVar3 != 0) {
    trace_event("End   command_HB(CHECK_ERROR)",5);
    return 0x7d2;
  }
  cVar1 = buffer_received[4];
  if (cVar1 == 'U') {
LAB_00462b20:
    trace_event("Triple DES Encryption Double Length",4);
    *(undefined8 *)tak_tmk = *(undefined8 *)(buffer_received + 4);
    *(undefined8 *)(tak_tmk + 8) = *(undefined8 *)(buffer_received + 0xc);
    *(undefined8 *)(tak_tmk + 0x10) = *(undefined8 *)(buffer_received + 0x14);
    *(undefined8 *)(tak_tmk + 0x18) = *(undefined8 *)(buffer_received + 0x1c);
    cVar1 = buffer_received[0x24];
    tak_tmk[0x21] = '\0';
    tak_tmk[0x20] = cVar1;
    *(undefined8 *)tak_lmk = *(undefined8 *)(buffer_received + 0x25);
    *(undefined8 *)(tak_lmk + 8) = *(undefined8 *)(buffer_received + 0x2d);
    *(undefined8 *)(tak_lmk + 0x10) = *(undefined8 *)(buffer_received + 0x35);
    *(undefined8 *)(tak_lmk + 0x18) = *(undefined8 *)(buffer_received + 0x3d);
    cVar1 = buffer_received[0x45];
    tak_lmk[0x21] = '\0';
    tak_lmk[0x20] = cVar1;
  }
  else {
    if (cVar1 < 'V') {
      if (cVar1 == 'T') {
LAB_00462a98:
        trace_event("Triple DES Encryption Triple Length",4);
        *(undefined8 *)tak_tmk = *(undefined8 *)(buffer_received + 4);
        *(undefined8 *)(tak_tmk + 8) = *(undefined8 *)(buffer_received + 0xc);
        *(undefined8 *)(tak_tmk + 0x10) = *(undefined8 *)(buffer_received + 0x14);
        *(undefined8 *)(tak_tmk + 0x18) = *(undefined8 *)(buffer_received + 0x1c);
        *(undefined8 *)(tak_tmk + 0x20) = *(undefined8 *)(buffer_received + 0x24);
        uVar2 = *(undefined8 *)(buffer_received + 0x2c);
        tak_tmk[0x30] = '\0';
        *(undefined8 *)(tak_tmk + 0x28) = uVar2;
        *(undefined8 *)tak_lmk = *(undefined8 *)(buffer_received + 0x34);
        *(undefined8 *)(tak_lmk + 8) = *(undefined8 *)(buffer_received + 0x3c);
        *(undefined8 *)(tak_lmk + 0x10) = *(undefined8 *)(buffer_received + 0x44);
        *(undefined8 *)(tak_lmk + 0x18) = *(undefined8 *)(buffer_received + 0x4c);
        *(undefined8 *)(tak_lmk + 0x20) = *(undefined8 *)(buffer_received + 0x54);
        uVar2 = *(undefined8 *)(buffer_received + 0x5c);
        tak_lmk[0x30] = '\0';
        *(undefined8 *)(tak_lmk + 0x28) = uVar2;
        goto LAB_00462a56;
      }
    }
    else {
      if (cVar1 == 'X') goto LAB_00462b20;
      if (cVar1 == 'Y') goto LAB_00462a98;
    }
    trace_event("Single DES Encryption Single Length",4);
    *(undefined8 *)tak_tmk = *(undefined8 *)(buffer_received + 4);
    uVar2 = *(undefined8 *)(buffer_received + 0xc);
    tak_tmk[0x10] = '\0';
    *(undefined8 *)(tak_tmk + 8) = uVar2;
    *(undefined8 *)tak_lmk = *(undefined8 *)(buffer_received + 0x14);
    uVar2 = *(undefined8 *)(buffer_received + 0x1c);
    tak_lmk[0x10] = '\0';
    *(undefined8 *)(tak_lmk + 8) = uVar2;
  }
LAB_00462a56:
  trace_event("End   command_HB(OK)",5);
  return 0;
}



// WARNING: Unknown calling convention

int command_IA(char *buffer_transmit,char *zmk_lmk)

{
  size_t __n;
  
  trace_event("Start command_IA()",5);
  buffer_transmit[0] = 'I';
  buffer_transmit[1] = 'A';
  __n = strlen(zmk_lmk);
  memcpy(buffer_transmit + 2,zmk_lmk,__n);
  trace_event("End   command_IA()",5);
  return 0;
}



// WARNING: Unknown calling convention

int command_IA_TDES(char *buffer_transmit,char *zmk_lmk)

{
  size_t sVar1;
  
  trace_event("Start command_IA_TDES()",5);
  buffer_transmit[0] = 'I';
  buffer_transmit[1] = 'A';
  sVar1 = strlen(zmk_lmk);
  memcpy(buffer_transmit + 2,zmk_lmk,sVar1);
  sVar1 = strlen(zmk_lmk);
  builtin_strncpy(buffer_transmit + sVar1 + 2,";XU0",4);
  trace_event("End   command_IA_TDES()",5);
  return 0;
}



// WARNING: Unknown calling convention

int command_IB(char *buffer_received,char *zpk_zmk,char *zpk_lmk,char *check_value,char *err_code)

{
  char cVar1;
  undefined8 uVar2;
  int iVar3;
  char Command [3];
  char sLine [512];
  
  trace_event("Start command_IB()",5);
  zpk_lmk[0] = '\0';
  zpk_lmk[1] = '\0';
  zpk_lmk[2] = '\0';
  zpk_lmk[3] = '\0';
  zpk_lmk[4] = '\0';
  zpk_lmk[5] = '\0';
  zpk_lmk[6] = '\0';
  zpk_lmk[7] = '\0';
  zpk_lmk[8] = '\0';
  zpk_lmk[9] = '\0';
  zpk_lmk[10] = '\0';
  zpk_lmk[0xb] = '\0';
  zpk_lmk[0xc] = '\0';
  zpk_lmk[0xd] = '\0';
  zpk_lmk[0xe] = '\0';
  zpk_lmk[0xf] = '\0';
  zpk_zmk[0] = '\0';
  zpk_zmk[1] = '\0';
  zpk_zmk[2] = '\0';
  zpk_zmk[3] = '\0';
  zpk_zmk[4] = '\0';
  zpk_zmk[5] = '\0';
  zpk_zmk[6] = '\0';
  zpk_zmk[7] = '\0';
  zpk_zmk[8] = '\0';
  zpk_zmk[9] = '\0';
  zpk_zmk[10] = '\0';
  zpk_zmk[0xb] = '\0';
  zpk_zmk[0xc] = '\0';
  zpk_zmk[0xd] = '\0';
  zpk_zmk[0xe] = '\0';
  zpk_zmk[0xf] = '\0';
  check_value[0] = '\0';
  check_value[1] = '\0';
  check_value[2] = '\0';
  check_value[3] = '\0';
  check_value[4] = '\0';
  check_value[5] = '\0';
  check_value[6] = '\0';
  check_value[7] = '\0';
  check_value[8] = '\0';
  check_value[9] = '\0';
  check_value[10] = '\0';
  check_value[0xb] = '\0';
  check_value[0xc] = '\0';
  check_value[0xd] = '\0';
  check_value[0xe] = '\0';
  check_value[0xf] = '\0';
  Command._0_2_ = *(undefined2 *)buffer_received;
  Command[2] = '\0';
  *(undefined4 *)err_code = *(undefined4 *)buffer_received;
  iVar3 = memcmp(Command,&DAT_004d6914,2);
  if (iVar3 != 0) {
    trace_event("End   command_IB(ERROR_COMMAND)",5);
    return 0x7d1;
  }
  TextError(err_code + 2,sLine);
  iVar3 = memcmp(err_code + 2,"00",2);
  if (iVar3 != 0) {
    trace_event("End   command_IB(CHECK_ERROR)",5);
    return 0x7d2;
  }
  cVar1 = buffer_received[4];
  if (cVar1 == 'U') {
LAB_00462eb0:
    trace_event("Triple DES Encryption Double Length",4);
    *(undefined8 *)zpk_zmk = *(undefined8 *)(buffer_received + 4);
    *(undefined8 *)(zpk_zmk + 8) = *(undefined8 *)(buffer_received + 0xc);
    *(undefined8 *)(zpk_zmk + 0x10) = *(undefined8 *)(buffer_received + 0x14);
    *(undefined8 *)(zpk_zmk + 0x18) = *(undefined8 *)(buffer_received + 0x1c);
    cVar1 = buffer_received[0x24];
    zpk_zmk[0x21] = '\0';
    zpk_zmk[0x20] = cVar1;
    *(undefined8 *)zpk_lmk = *(undefined8 *)(buffer_received + 0x25);
    *(undefined8 *)(zpk_lmk + 8) = *(undefined8 *)(buffer_received + 0x2d);
    *(undefined8 *)(zpk_lmk + 0x10) = *(undefined8 *)(buffer_received + 0x35);
    *(undefined8 *)(zpk_lmk + 0x18) = *(undefined8 *)(buffer_received + 0x3d);
    cVar1 = buffer_received[0x45];
    zpk_lmk[0x21] = '\0';
    zpk_lmk[0x20] = cVar1;
    *(undefined8 *)check_value = *(undefined8 *)(buffer_received + 0x46);
    *(undefined8 *)(check_value + 8) = *(undefined8 *)(buffer_received + 0x4e);
  }
  else {
    if (cVar1 < 'V') {
      if (cVar1 == 'T') {
LAB_00462e18:
        trace_event("Triple DES Encryption Triple Length",4);
        *(undefined8 *)zpk_zmk = *(undefined8 *)(buffer_received + 4);
        *(undefined8 *)(zpk_zmk + 8) = *(undefined8 *)(buffer_received + 0xc);
        *(undefined8 *)(zpk_zmk + 0x10) = *(undefined8 *)(buffer_received + 0x14);
        *(undefined8 *)(zpk_zmk + 0x18) = *(undefined8 *)(buffer_received + 0x1c);
        *(undefined8 *)(zpk_zmk + 0x20) = *(undefined8 *)(buffer_received + 0x24);
        uVar2 = *(undefined8 *)(buffer_received + 0x2c);
        zpk_zmk[0x30] = '\0';
        *(undefined8 *)(zpk_zmk + 0x28) = uVar2;
        *(undefined8 *)zpk_lmk = *(undefined8 *)(buffer_received + 0x34);
        *(undefined8 *)(zpk_lmk + 8) = *(undefined8 *)(buffer_received + 0x3c);
        *(undefined8 *)(zpk_lmk + 0x10) = *(undefined8 *)(buffer_received + 0x44);
        *(undefined8 *)(zpk_lmk + 0x18) = *(undefined8 *)(buffer_received + 0x4c);
        *(undefined8 *)(zpk_lmk + 0x20) = *(undefined8 *)(buffer_received + 0x54);
        uVar2 = *(undefined8 *)(buffer_received + 0x5c);
        zpk_lmk[0x30] = '\0';
        *(undefined8 *)(zpk_lmk + 0x28) = uVar2;
        *(undefined8 *)check_value = *(undefined8 *)(buffer_received + 100);
        *(undefined8 *)(check_value + 8) = *(undefined8 *)(buffer_received + 0x6c);
        goto LAB_00462dd4;
      }
    }
    else {
      if (cVar1 == 'X') goto LAB_00462eb0;
      if (cVar1 == 'Y') goto LAB_00462e18;
    }
    trace_event("Single DES Encryption Single Length",4);
    *(undefined8 *)zpk_zmk = *(undefined8 *)(buffer_received + 4);
    uVar2 = *(undefined8 *)(buffer_received + 0xc);
    zpk_zmk[0x10] = '\0';
    *(undefined8 *)(zpk_zmk + 8) = uVar2;
    *(undefined8 *)zpk_lmk = *(undefined8 *)(buffer_received + 0x14);
    uVar2 = *(undefined8 *)(buffer_received + 0x1c);
    zpk_lmk[0x10] = '\0';
    *(undefined8 *)(zpk_lmk + 8) = uVar2;
    *(undefined8 *)check_value = *(undefined8 *)(buffer_received + 0x24);
    *(undefined8 *)(check_value + 8) = *(undefined8 *)(buffer_received + 0x2c);
  }
LAB_00462dd4:
  trace_event("End   command_IB(OK)",5);
  return 0;
}



// WARNING: Unknown calling convention

int command_JC(char *buffer_transmit,char *Tpk,char *PinBlock,char *format,char *Pan)

{
  size_t sVar1;
  char *pcVar2;
  char Card [13];
  char CardTrunc [23];
  char ligne [512];
  
  CardTrunc[0] = '\0';
  CardTrunc[1] = '\0';
  CardTrunc[2] = '\0';
  CardTrunc[3] = '\0';
  CardTrunc[4] = '\0';
  CardTrunc[5] = '\0';
  CardTrunc[6] = '\0';
  CardTrunc[7] = '\0';
  CardTrunc[8] = '\0';
  CardTrunc[9] = '\0';
  CardTrunc[10] = '\0';
  CardTrunc[0xb] = '\0';
  CardTrunc[0xc] = '\0';
  CardTrunc[0xd] = '\0';
  CardTrunc[0xe] = '\0';
  CardTrunc[0xf] = '\0';
  CardTrunc[0x10] = '\0';
  CardTrunc[0x11] = '\0';
  CardTrunc[0x12] = '\0';
  CardTrunc[0x13] = '\0';
  CardTrunc[0x14] = '\0';
  CardTrunc[0x15] = '\0';
  CardTrunc[0x16] = '\0';
  Card[0] = '\0';
  Card[1] = '\0';
  Card[2] = '\0';
  Card[3] = '\0';
  Card[4] = '\0';
  Card[5] = '\0';
  Card[6] = '\0';
  Card[7] = '\0';
  Card[8] = '\0';
  Card[9] = '\0';
  Card[10] = '\0';
  Card[0xb] = '\0';
  Card[0xc] = '\0';
  if (debug_option == 1) {
    sprintf(ligne,"Start command_JC(%.16s,%.2s,%.22s)",PinBlock,format,Card);
  }
  else {
    TrunCard(Card,CardTrunc);
    sprintf(ligne,"Start command_JC(%.2s,%.22s)",format,CardTrunc);
  }
  trace_event(ligne,5);
  buffer_transmit[0] = 'J';
  buffer_transmit[1] = 'C';
  sVar1 = strlen(Tpk);
  memcpy(buffer_transmit + 2,Tpk,sVar1);
  sVar1 = strlen(Tpk);
  pcVar2 = buffer_transmit + 2 + sVar1;
  *(undefined8 *)pcVar2 = *(undefined8 *)PinBlock;
  *(undefined8 *)(pcVar2 + 8) = *(undefined8 *)(PinBlock + 8);
  *(undefined2 *)(pcVar2 + 0x10) = *(undefined2 *)format;
  format_card_from_pan(Card,Pan);
  *(undefined8 *)(pcVar2 + 0x12) = Card._0_8_;
  *(undefined4 *)(pcVar2 + 0x1a) = Card._8_4_;
  if (debug_option == 1) {
    sprintf(ligne,"End   command_JC(%.60s)",pcVar2 + 0x12);
  }
  else {
    builtin_strncpy(ligne + 0x10,"(OK)",5);
    builtin_strncpy(ligne,"End   command_JC",0x10);
  }
  trace_event(ligne,5);
  return 0;
}



// WARNING: Unknown calling convention

int command_JD(char *buffer_received,char *PinLmk,char *err_code)

{
  int iVar1;
  bool bVar2;
  char Command [3];
  char ligne [512];
  char sLine [512];
  
  Command[0] = '\0';
  Command[1] = '\0';
  Command[2] = '\0';
  if (debug_option == 1) {
    sprintf(ligne,"Start command_JD(%.40s)",buffer_received);
  }
  else {
    ligne._18_2_ = SUB42(ligne._16_4_,2) & 0xff00;
    builtin_strncpy(ligne,"Start command_JD()",0x12);
  }
  trace_event(ligne,5);
  Command._0_2_ = *(undefined2 *)buffer_received;
  *(undefined2 *)err_code = *(undefined2 *)(buffer_received + 2);
  iVar1 = memcmp(Command,&DAT_004cc45a,2);
  if (iVar1 == 0) {
    TextError(err_code,sLine);
    iVar1 = memcmp(err_code,"00",2);
    if (iVar1 == 0) {
      *(undefined8 *)PinLmk = *(undefined8 *)(buffer_received + 4);
      bVar2 = debug_option == 1;
      *(undefined8 *)(PinLmk + 8) = *(undefined8 *)(buffer_received + 0xc);
      if (bVar2) {
        sprintf(ligne,"End   command_JD(%.2s,%.16s)",err_code,PinLmk);
      }
      else {
        builtin_strncpy(ligne + 0x10,"(OK)",5);
        builtin_strncpy(ligne,"End   command_JD",0x10);
      }
      trace_event(ligne,5);
      iVar1 = 0;
    }
    else {
      iVar1 = 0x7d2;
      trace_event("End   command_JD(CHECK_ERROR)",5);
    }
  }
  else {
    iVar1 = 0x7d1;
    trace_event("End   command_JD(ERROR_COMMAND)",5);
  }
  return iVar1;
}



// WARNING: Unknown calling convention

int command_JE(char *buffer_transmit,char *Zpk,char *PinBlock,char *format,char *Pan)

{
  size_t sVar1;
  char *pcVar2;
  char Card [13];
  char CardTrunc [23];
  char ligne [512];
  
  CardTrunc[0] = '\0';
  CardTrunc[1] = '\0';
  CardTrunc[2] = '\0';
  CardTrunc[3] = '\0';
  CardTrunc[4] = '\0';
  CardTrunc[5] = '\0';
  CardTrunc[6] = '\0';
  CardTrunc[7] = '\0';
  CardTrunc[8] = '\0';
  CardTrunc[9] = '\0';
  CardTrunc[10] = '\0';
  CardTrunc[0xb] = '\0';
  CardTrunc[0xc] = '\0';
  CardTrunc[0xd] = '\0';
  CardTrunc[0xe] = '\0';
  CardTrunc[0xf] = '\0';
  CardTrunc[0x10] = '\0';
  CardTrunc[0x11] = '\0';
  CardTrunc[0x12] = '\0';
  CardTrunc[0x13] = '\0';
  CardTrunc[0x14] = '\0';
  CardTrunc[0x15] = '\0';
  CardTrunc[0x16] = '\0';
  Card[0] = '\0';
  Card[1] = '\0';
  Card[2] = '\0';
  Card[3] = '\0';
  Card[4] = '\0';
  Card[5] = '\0';
  Card[6] = '\0';
  Card[7] = '\0';
  Card[8] = '\0';
  Card[9] = '\0';
  Card[10] = '\0';
  Card[0xb] = '\0';
  Card[0xc] = '\0';
  if (debug_option == 1) {
    sprintf(ligne,"Start command_JE(%.16s,%.2s,%.22s)",PinBlock,format,Card);
  }
  else {
    TrunCard(Card,CardTrunc);
    sprintf(ligne,"Start command_JE(%.2s,%.22s)",format,CardTrunc);
  }
  trace_event(ligne,5);
  buffer_transmit[0] = 'J';
  buffer_transmit[1] = 'E';
  sVar1 = strlen(Zpk);
  memcpy(buffer_transmit + 2,Zpk,sVar1);
  sVar1 = strlen(Zpk);
  pcVar2 = buffer_transmit + 2 + sVar1;
  *(undefined8 *)pcVar2 = *(undefined8 *)PinBlock;
  *(undefined8 *)(pcVar2 + 8) = *(undefined8 *)(PinBlock + 8);
  *(undefined2 *)(pcVar2 + 0x10) = *(undefined2 *)format;
  format_card_from_pan(Card,Pan);
  ligne[0x10] = '(';
  ligne[0x11] = ')';
  ligne[0x12] = '\0';
  *(undefined8 *)(pcVar2 + 0x12) = Card._0_8_;
  *(undefined4 *)(pcVar2 + 0x1a) = Card._8_4_;
  builtin_strncpy(ligne,"End   command_JE",0x10);
  trace_event(ligne,5);
  return 0;
}



// WARNING: Unknown calling convention

int command_JF(char *buffer_received,char *pin_lmk,char *err_code)

{
  int iVar1;
  char Command [3];
  char sLine [512];
  
  trace_event("Start command_JF()",5);
  Command._0_2_ = *(undefined2 *)buffer_received;
  Command[2] = '\0';
  *(undefined4 *)err_code = *(undefined4 *)buffer_received;
  iVar1 = memcmp(Command,&DAT_004cc4c8,2);
  if (iVar1 != 0) {
    trace_event("End   command_JF(ERROR_COMMAND)",5);
    return 0x7d1;
  }
  TextError(err_code + 2,sLine);
  iVar1 = memcmp(err_code + 2,"00",2);
  if (iVar1 != 0) {
    trace_event("End   command_JF(CHECK_ERROR)",5);
    return 0x7d2;
  }
  *(undefined8 *)pin_lmk = *(undefined8 *)(buffer_received + 4);
  *(undefined8 *)(pin_lmk + 8) = *(undefined8 *)(buffer_received + 0xc);
  trace_event("End   command_JF(OK)",5);
  return 0;
}



// WARNING: Unknown calling convention

int command_JG(char *buffer_transmit,char *Zpk,char *PinLmk,char *format,char *Pan)

{
  size_t sVar1;
  char *pcVar2;
  char Card [13];
  char ligne [512];
  
  Card[0] = '\0';
  Card[1] = '\0';
  Card[2] = '\0';
  Card[3] = '\0';
  Card[4] = '\0';
  Card[5] = '\0';
  Card[6] = '\0';
  Card[7] = '\0';
  Card[8] = '\0';
  Card[9] = '\0';
  Card[10] = '\0';
  Card[0xb] = '\0';
  Card[0xc] = '\0';
  if (debug_option == 1) {
    sprintf(ligne,"Start command_JG(%.16s,%.2s,%.22s)",PinLmk,format,Card);
  }
  else {
    builtin_strncpy(ligne,"Start command_JG()",0x13);
  }
  trace_event(ligne,5);
  buffer_transmit[0] = 'J';
  buffer_transmit[1] = 'G';
  sVar1 = strlen(Zpk);
  memcpy(buffer_transmit + 2,Zpk,sVar1);
  sVar1 = strlen(Zpk);
  pcVar2 = buffer_transmit + 2 + sVar1;
  *(undefined2 *)pcVar2 = *(undefined2 *)format;
  format_card_from_pan(Card,Pan);
  ligne[0x10] = '(';
  ligne[0x11] = ')';
  ligne[0x12] = '\0';
  *(undefined8 *)(pcVar2 + 2) = Card._0_8_;
  *(undefined4 *)(pcVar2 + 10) = Card._8_4_;
  *(undefined8 *)(pcVar2 + 0xe) = *(undefined8 *)PinLmk;
  *(undefined8 *)(pcVar2 + 0x16) = *(undefined8 *)(PinLmk + 8);
  builtin_strncpy(ligne,"End   command_JE",0x10);
  trace_event(ligne,5);
  return 0;
}



// WARNING: Unknown calling convention

int command_JH(char *buffer_received,char *PinBlock,char *err_code)

{
  int iVar1;
  char Command [3];
  char sLine [512];
  
  trace_event("Start command_JH()",5);
  Command._0_2_ = *(undefined2 *)buffer_received;
  Command[2] = '\0';
  *(undefined4 *)err_code = *(undefined4 *)buffer_received;
  iVar1 = memcmp(Command,&DAT_004cc511,2);
  if (iVar1 != 0) {
    trace_event("End   command_JH(ERROR_COMMAND)",5);
    return 0x7d1;
  }
  TextError(err_code + 2,sLine);
  iVar1 = memcmp(err_code + 2,"00",2);
  if (iVar1 != 0) {
    trace_event("End   command_JH(CHECK_ERROR)",5);
    return 0x7d2;
  }
  *(undefined8 *)PinBlock = *(undefined8 *)(buffer_received + 4);
  *(undefined8 *)(PinBlock + 8) = *(undefined8 *)(buffer_received + 0xc);
  trace_event("End   command_JH(OK)",5);
  return 0;
}



// WARNING: Unknown calling convention

int command_OE(char *buffer_transmit)

{
  trace_event("Start command_OE()",5);
  buffer_transmit[0] = 'O';
  buffer_transmit[1] = 'E';
  trace_event("End   command_OE()",5);
  return 0;
}



// WARNING: Unknown calling convention

int command_OF(char *buffer_received,char *key_lmk,char *check_value,char *err_code)

{
  char cVar1;
  undefined8 uVar2;
  int iVar3;
  char Command [3];
  char sLine [512];
  
  trace_event("Start command_OF()",5);
  key_lmk[0] = '\0';
  key_lmk[1] = '\0';
  key_lmk[2] = '\0';
  key_lmk[3] = '\0';
  key_lmk[4] = '\0';
  key_lmk[5] = '\0';
  key_lmk[6] = '\0';
  key_lmk[7] = '\0';
  key_lmk[8] = '\0';
  key_lmk[9] = '\0';
  key_lmk[10] = '\0';
  key_lmk[0xb] = '\0';
  key_lmk[0xc] = '\0';
  key_lmk[0xd] = '\0';
  key_lmk[0xe] = '\0';
  key_lmk[0xf] = '\0';
  check_value[0] = '\0';
  check_value[1] = '\0';
  check_value[2] = '\0';
  check_value[3] = '\0';
  check_value[4] = '\0';
  check_value[5] = '\0';
  check_value[6] = '\0';
  check_value[7] = '\0';
  check_value[8] = '\0';
  check_value[9] = '\0';
  check_value[10] = '\0';
  check_value[0xb] = '\0';
  check_value[0xc] = '\0';
  check_value[0xd] = '\0';
  check_value[0xe] = '\0';
  check_value[0xf] = '\0';
  Command._0_2_ = *(undefined2 *)buffer_received;
  Command[2] = '\0';
  *(undefined4 *)err_code = *(undefined4 *)buffer_received;
  iVar3 = memcmp(Command,&DAT_004cc580,2);
  if (iVar3 != 0) {
    trace_event("End   command_OF(ERROR_COMMAND)",5);
    return 0x7d1;
  }
  TextError(err_code + 2,sLine);
  iVar3 = memcmp(err_code + 2,"00",2);
  if (iVar3 != 0) {
    trace_event("End   command_OF(CHECK_ERROR)",5);
    return 0x7d2;
  }
  cVar1 = buffer_received[4];
  if (cVar1 == 'U') {
LAB_00463a08:
    trace_event("Triple DES Encryption Double Length",4);
    *(undefined8 *)key_lmk = *(undefined8 *)(buffer_received + 4);
    *(undefined8 *)(key_lmk + 8) = *(undefined8 *)(buffer_received + 0xc);
    *(undefined8 *)(key_lmk + 0x10) = *(undefined8 *)(buffer_received + 0x14);
    uVar2 = *(undefined8 *)(buffer_received + 0x1c);
    key_lmk[0x20] = '\0';
    *(undefined8 *)(key_lmk + 0x18) = uVar2;
    *(undefined8 *)check_value = *(undefined8 *)(buffer_received + 0x24);
    *(undefined8 *)(check_value + 8) = *(undefined8 *)(buffer_received + 0x2c);
  }
  else {
    if (cVar1 < 'V') {
      if (cVar1 == 'T') {
LAB_004639a8:
        trace_event("Triple DES Encryption Triple Length",4);
        *(undefined8 *)key_lmk = *(undefined8 *)(buffer_received + 4);
        *(undefined8 *)(key_lmk + 8) = *(undefined8 *)(buffer_received + 0xc);
        *(undefined8 *)(key_lmk + 0x10) = *(undefined8 *)(buffer_received + 0x14);
        *(undefined8 *)(key_lmk + 0x18) = *(undefined8 *)(buffer_received + 0x1c);
        *(undefined8 *)(key_lmk + 0x20) = *(undefined8 *)(buffer_received + 0x24);
        uVar2 = *(undefined8 *)(buffer_received + 0x2c);
        key_lmk[0x30] = '\0';
        *(undefined8 *)(key_lmk + 0x28) = uVar2;
        *(undefined8 *)check_value = *(undefined8 *)(buffer_received + 0x34);
        *(undefined8 *)(check_value + 8) = *(undefined8 *)(buffer_received + 0x3c);
        goto LAB_0046395d;
      }
    }
    else {
      if (cVar1 == 'X') goto LAB_00463a08;
      if (cVar1 == 'Y') goto LAB_004639a8;
    }
    trace_event("Single DES Encryption Single Length",4);
    *(undefined8 *)key_lmk = *(undefined8 *)(buffer_received + 4);
    uVar2 = *(undefined8 *)(buffer_received + 0xc);
    key_lmk[0x10] = '\0';
    *(undefined8 *)(key_lmk + 8) = uVar2;
    *(undefined8 *)check_value = *(undefined8 *)(buffer_received + 0x14);
    *(undefined8 *)(check_value + 8) = *(undefined8 *)(buffer_received + 0x1c);
  }
LAB_0046395d:
  trace_event("End   command_OF(OK)",5);
  return 0;
}



// WARNING: Unknown calling convention

int command_HE(char *buffer_transmit,char *cle,char *data)

{
  size_t sVar1;
  char *__dest;
  
  __dest = buffer_transmit + 2;
  trace_event("Start command_HE()",5);
  buffer_transmit[0] = 'H';
  buffer_transmit[1] = 'E';
  sVar1 = strlen(cle);
  memcpy(__dest,cle,sVar1);
  sVar1 = strlen(cle);
  *(undefined8 *)(__dest + sVar1) = *(undefined8 *)data;
  *(undefined8 *)(__dest + sVar1 + 8) = *(undefined8 *)(data + 8);
  trace_event("End   command_HE()",5);
  return 0;
}



// WARNING: Unknown calling convention

int command_HF(char *buffer_received,char *pin,char *err_code)

{
  int iVar1;
  char Command [3];
  char sLine [512];
  
  trace_event("Start command_HF()",5);
  pin[0] = '\0';
  pin[1] = '\0';
  pin[2] = '\0';
  pin[3] = '\0';
  pin[4] = '\0';
  pin[5] = '\0';
  pin[6] = '\0';
  pin[7] = '\0';
  pin[8] = '\0';
  pin[9] = '\0';
  pin[10] = '\0';
  pin[0xb] = '\0';
  pin[0xc] = '\0';
  pin[0xd] = '\0';
  pin[0xe] = '\0';
  pin[0xf] = '\0';
  Command._0_2_ = *(undefined2 *)buffer_received;
  Command[2] = '\0';
  *(undefined4 *)err_code = *(undefined4 *)buffer_received;
  iVar1 = memcmp(Command,&DAT_004cc5ef,2);
  if (iVar1 != 0) {
    trace_event("End   command_HF(ERROR_COMMND)",5);
    return 0x7d1;
  }
  TextError(err_code + 2,sLine);
  iVar1 = memcmp(err_code + 2,"00",2);
  if (iVar1 != 0) {
    trace_event("End   command_HF(CHECK_ERROR)",5);
    return 0x7d2;
  }
  *(undefined8 *)pin = *(undefined8 *)(buffer_received + 4);
  *(undefined8 *)(pin + 8) = *(undefined8 *)(buffer_received + 0xc);
  trace_event("End   command_HF(OK)",5);
  return 0;
}



// WARNING: Unknown calling convention

int command_HG(char *buffer_transmit,char *cle,char *data)

{
  size_t sVar1;
  char *__dest;
  
  __dest = buffer_transmit + 2;
  trace_event("Start command_HG()",5);
  buffer_transmit[0] = 'H';
  buffer_transmit[1] = 'G';
  sVar1 = strlen(cle);
  memcpy(__dest,cle,sVar1);
  sVar1 = strlen(cle);
  *(undefined8 *)(__dest + sVar1) = *(undefined8 *)data;
  *(undefined8 *)(__dest + sVar1 + 8) = *(undefined8 *)(data + 8);
  trace_event("End   command_HG()",5);
  return 0;
}



// WARNING: Unknown calling convention

int command_HH(char *buffer_received,char *pin,char *err_code)

{
  int iVar1;
  char Command [3];
  char sLine [512];
  
  trace_event("Start command_HH()",5);
  Command._0_2_ = *(undefined2 *)buffer_received;
  Command[2] = '\0';
  *(undefined4 *)err_code = *(undefined4 *)buffer_received;
  iVar1 = memcmp(Command,&DAT_004cc65e,2);
  if (iVar1 != 0) {
    trace_event("Start command_HH(ERROR_COMMAND)",5);
    return 0x7d1;
  }
  TextError(err_code + 2,sLine);
  iVar1 = memcmp(err_code + 2,"00",2);
  if (iVar1 != 0) {
    trace_event("Start command_HH(CHECK_ERROR)",5);
    return 0x7d2;
  }
  *(undefined8 *)pin = *(undefined8 *)(buffer_received + 4);
  *(undefined8 *)(pin + 8) = *(undefined8 *)(buffer_received + 0xc);
  trace_event("End   command_HH(OK)",5);
  return 0;
}



// WARNING: Unknown calling convention

int command_HC(char *buffer_transmit,char *key)

{
  size_t sVar1;
  char sLine [512];
  
  if (debug_option == 1) {
    sprintf(sLine,"Start command_HC(%s)",key);
  }
  else {
    builtin_strncpy(sLine,"Start command_HC()",0x13);
  }
  trace_event(sLine,5);
  buffer_transmit[0] = 'H';
  buffer_transmit[1] = 'C';
  sVar1 = strlen(key);
  if (sVar1 < 0x11) {
    memcpy(buffer_transmit + 2,key,sVar1);
  }
  else {
    memcpy(buffer_transmit + 2,key,sVar1);
    sVar1 = strlen(key);
    builtin_strncpy(buffer_transmit + sVar1 + 2,";XU0",4);
  }
  trace_event("End   command_HC(OK)",5);
  return 0;
}



// WARNING: Unknown calling convention

int command_HD(char *buffer_received,char *key_key,char *key_lmk,char *err_code)

{
  char cVar1;
  undefined8 uVar2;
  int iVar3;
  char Command [3];
  char sLine [512];
  
  trace_event("Start command_HD()",5);
  Command._0_2_ = *(undefined2 *)buffer_received;
  Command[2] = '\0';
  *(undefined4 *)err_code = *(undefined4 *)buffer_received;
  iVar3 = memcmp(Command,&DAT_004cc6d1,2);
  if (iVar3 != 0) {
    trace_event("End   command_HD(ERROR_COMMAND)",5);
    return 0x7d1;
  }
  TextError(err_code + 2,sLine);
  iVar3 = memcmp(err_code + 2,"00",2);
  if (iVar3 != 0) {
    trace_event("End   command_HD(CHECK_ERROR)",5);
    return 0x7d2;
  }
  cVar1 = buffer_received[4];
  if (cVar1 == 'U') {
LAB_00464078:
    trace_event("Triple DES Encryption Double Length",4);
    *(undefined8 *)key_key = *(undefined8 *)(buffer_received + 4);
    *(undefined8 *)(key_key + 8) = *(undefined8 *)(buffer_received + 0xc);
    *(undefined8 *)(key_key + 0x10) = *(undefined8 *)(buffer_received + 0x14);
    *(undefined8 *)(key_key + 0x18) = *(undefined8 *)(buffer_received + 0x1c);
    cVar1 = buffer_received[0x24];
    key_key[0x21] = '\0';
    key_key[0x20] = cVar1;
    *(undefined8 *)key_lmk = *(undefined8 *)(buffer_received + 0x25);
    *(undefined8 *)(key_lmk + 8) = *(undefined8 *)(buffer_received + 0x2d);
    *(undefined8 *)(key_lmk + 0x10) = *(undefined8 *)(buffer_received + 0x35);
    *(undefined8 *)(key_lmk + 0x18) = *(undefined8 *)(buffer_received + 0x3d);
    cVar1 = buffer_received[0x45];
    key_lmk[0x21] = '\0';
    key_lmk[0x20] = cVar1;
  }
  else {
    if (cVar1 < 'V') {
      if (cVar1 == 'T') {
LAB_00463fd8:
        trace_event("Triple DES Encryption Triple Length",4);
        *(undefined8 *)key_key = *(undefined8 *)(buffer_received + 4);
        *(undefined8 *)(key_key + 8) = *(undefined8 *)(buffer_received + 0xc);
        *(undefined8 *)(key_key + 0x10) = *(undefined8 *)(buffer_received + 0x14);
        *(undefined8 *)(key_key + 0x18) = *(undefined8 *)(buffer_received + 0x1c);
        *(undefined8 *)(key_key + 0x20) = *(undefined8 *)(buffer_received + 0x24);
        *(undefined8 *)(key_key + 0x28) = *(undefined8 *)(buffer_received + 0x2c);
        cVar1 = buffer_received[0x34];
        key_key[0x31] = '\0';
        key_key[0x30] = cVar1;
        *(undefined8 *)key_lmk = *(undefined8 *)(buffer_received + 0x35);
        *(undefined8 *)(key_lmk + 8) = *(undefined8 *)(buffer_received + 0x3d);
        *(undefined8 *)(key_lmk + 0x10) = *(undefined8 *)(buffer_received + 0x45);
        *(undefined8 *)(key_lmk + 0x18) = *(undefined8 *)(buffer_received + 0x4d);
        *(undefined8 *)(key_lmk + 0x20) = *(undefined8 *)(buffer_received + 0x55);
        *(undefined8 *)(key_lmk + 0x28) = *(undefined8 *)(buffer_received + 0x5d);
        cVar1 = buffer_received[0x65];
        key_lmk[0x31] = '\0';
        key_lmk[0x30] = cVar1;
        goto LAB_00463f98;
      }
    }
    else {
      if (cVar1 == 'X') goto LAB_00464078;
      if (cVar1 == 'Y') goto LAB_00463fd8;
    }
    trace_event("Single DES Encryption Single Length",4);
    *(undefined8 *)key_key = *(undefined8 *)(buffer_received + 4);
    uVar2 = *(undefined8 *)(buffer_received + 0xc);
    key_key[0x10] = '\0';
    *(undefined8 *)(key_key + 8) = uVar2;
    *(undefined8 *)key_lmk = *(undefined8 *)(buffer_received + 0x14);
    uVar2 = *(undefined8 *)(buffer_received + 0x1c);
    key_lmk[0x10] = '\0';
    *(undefined8 *)(key_lmk + 8) = uVar2;
  }
LAB_00463f98:
  trace_event("End   command_HD(OK)",5);
  return 0;
}



// WARNING: Unknown calling convention

int command_FG(char *buffer_transmit,char *zmk)

{
  size_t __n;
  
  trace_event("Debut command_FG()",5);
  buffer_transmit[0] = 'F';
  buffer_transmit[1] = 'G';
  __n = strlen(zmk);
  memcpy(buffer_transmit + 2,zmk,__n);
  trace_event("Fin   command_FG(OK)",5);
  return 0;
}



// WARNING: Unknown calling convention

int command_FH(char *buffer_received,char *pvka_lmk,char *pvkb_lmk,char *pvka_zmk,char *pvkb_zmk,
              char *check_valuea,char *check_valueb,char *err_code)

{
  int iVar1;
  char Command [3];
  char sLine [512];
  
  trace_event("Start command_FH()",5);
  pvka_lmk[0] = '\0';
  pvka_lmk[1] = '\0';
  pvka_lmk[2] = '\0';
  pvka_lmk[3] = '\0';
  pvka_lmk[4] = '\0';
  pvka_lmk[5] = '\0';
  pvka_lmk[6] = '\0';
  pvka_lmk[7] = '\0';
  pvka_lmk[8] = '\0';
  pvka_lmk[9] = '\0';
  pvka_lmk[10] = '\0';
  pvka_lmk[0xb] = '\0';
  pvka_lmk[0xc] = '\0';
  pvka_lmk[0xd] = '\0';
  pvka_lmk[0xe] = '\0';
  pvka_lmk[0xf] = '\0';
  pvkb_lmk[0] = '\0';
  pvkb_lmk[1] = '\0';
  pvkb_lmk[2] = '\0';
  pvkb_lmk[3] = '\0';
  pvkb_lmk[4] = '\0';
  pvkb_lmk[5] = '\0';
  pvkb_lmk[6] = '\0';
  pvkb_lmk[7] = '\0';
  pvkb_lmk[8] = '\0';
  pvkb_lmk[9] = '\0';
  pvkb_lmk[10] = '\0';
  pvkb_lmk[0xb] = '\0';
  pvkb_lmk[0xc] = '\0';
  pvkb_lmk[0xd] = '\0';
  pvkb_lmk[0xe] = '\0';
  pvkb_lmk[0xf] = '\0';
  pvka_zmk[0] = '\0';
  pvka_zmk[1] = '\0';
  pvka_zmk[2] = '\0';
  pvka_zmk[3] = '\0';
  pvka_zmk[4] = '\0';
  pvka_zmk[5] = '\0';
  pvka_zmk[6] = '\0';
  pvka_zmk[7] = '\0';
  pvka_zmk[8] = '\0';
  pvka_zmk[9] = '\0';
  pvka_zmk[10] = '\0';
  pvka_zmk[0xb] = '\0';
  pvka_zmk[0xc] = '\0';
  pvka_zmk[0xd] = '\0';
  pvka_zmk[0xe] = '\0';
  pvka_zmk[0xf] = '\0';
  pvkb_zmk[0] = '\0';
  pvkb_zmk[1] = '\0';
  pvkb_zmk[2] = '\0';
  pvkb_zmk[3] = '\0';
  pvkb_zmk[4] = '\0';
  pvkb_zmk[5] = '\0';
  pvkb_zmk[6] = '\0';
  pvkb_zmk[7] = '\0';
  pvkb_zmk[8] = '\0';
  pvkb_zmk[9] = '\0';
  pvkb_zmk[10] = '\0';
  pvkb_zmk[0xb] = '\0';
  pvkb_zmk[0xc] = '\0';
  pvkb_zmk[0xd] = '\0';
  pvkb_zmk[0xe] = '\0';
  pvkb_zmk[0xf] = '\0';
  check_valuea[0] = '\0';
  check_valuea[1] = '\0';
  check_valuea[2] = '\0';
  check_valuea[3] = '\0';
  check_valuea[4] = '\0';
  check_valuea[5] = '\0';
  check_valuea[6] = '\0';
  check_valuea[7] = '\0';
  check_valuea[8] = '\0';
  check_valuea[9] = '\0';
  check_valuea[10] = '\0';
  check_valuea[0xb] = '\0';
  check_valuea[0xc] = '\0';
  check_valuea[0xd] = '\0';
  check_valuea[0xe] = '\0';
  check_valuea[0xf] = '\0';
  check_valueb[0] = '\0';
  check_valueb[1] = '\0';
  check_valueb[2] = '\0';
  check_valueb[3] = '\0';
  check_valueb[4] = '\0';
  check_valueb[5] = '\0';
  check_valueb[6] = '\0';
  check_valueb[7] = '\0';
  check_valueb[8] = '\0';
  check_valueb[9] = '\0';
  check_valueb[10] = '\0';
  check_valueb[0xb] = '\0';
  check_valueb[0xc] = '\0';
  check_valueb[0xd] = '\0';
  check_valueb[0xe] = '\0';
  check_valueb[0xf] = '\0';
  Command._0_2_ = *(undefined2 *)buffer_received;
  Command[2] = '\0';
  *(undefined4 *)err_code = *(undefined4 *)buffer_received;
  iVar1 = memcmp(Command,&DAT_004cc742,2);
  if (iVar1 == 0) {
    TextError(err_code + 2,sLine);
    iVar1 = memcmp(err_code + 2,"00",2);
    if (iVar1 == 0) {
      *(undefined8 *)pvka_lmk = *(undefined8 *)(buffer_received + 4);
      *(undefined8 *)(pvka_lmk + 8) = *(undefined8 *)(buffer_received + 0xc);
      *(undefined8 *)pvkb_lmk = *(undefined8 *)(buffer_received + 0x14);
      *(undefined8 *)(pvkb_lmk + 8) = *(undefined8 *)(buffer_received + 0x1c);
      *(undefined8 *)pvka_zmk = *(undefined8 *)(buffer_received + 0x24);
      *(undefined8 *)(pvka_zmk + 8) = *(undefined8 *)(buffer_received + 0x2c);
      *(undefined8 *)pvkb_zmk = *(undefined8 *)(buffer_received + 0x34);
      *(undefined8 *)(pvkb_zmk + 8) = *(undefined8 *)(buffer_received + 0x3c);
      *(undefined8 *)check_valuea = *(undefined8 *)(buffer_received + 0x44);
      *(undefined8 *)(check_valuea + 8) = *(undefined8 *)(buffer_received + 0x4c);
      *(undefined8 *)check_valueb = *(undefined8 *)(buffer_received + 0x54);
      *(undefined8 *)(check_valueb + 8) = *(undefined8 *)(buffer_received + 0x5c);
      trace_event("End   command_FH(OK)",5);
      iVar1 = 0;
    }
    else {
      trace_event("End   command_FH(CHECK_ERROR)",5);
      iVar1 = 0x7d2;
    }
  }
  else {
    trace_event("End   command_FH(ERROR_COMMAND)",5);
    iVar1 = 0x7d1;
  }
  return iVar1;
}



// WARNING: Unknown calling convention

int command_MI(char *buffer_transmit,char *zmk,char *tak_zmk)

{
  size_t sVar1;
  size_t __n;
  
  trace_event("Start command_MI()",5);
  buffer_transmit[0] = 'M';
  buffer_transmit[1] = 'I';
  sVar1 = strlen(zmk);
  memcpy(buffer_transmit + 2,zmk,sVar1);
  sVar1 = strlen(zmk);
  __n = strlen(tak_zmk);
  memcpy(buffer_transmit + 2 + sVar1,tak_zmk,__n);
  trace_event("End   command_MI(OK)",5);
  return 0;
}



// WARNING: Unknown calling convention

int command_MJ(char *buffer_received,char *tak_lmk,char *check_value,char *err_code)

{
  char cVar1;
  int iVar2;
  char Command [3];
  char sLine [512];
  
  trace_event("Start command_MJ()",5);
  tak_lmk[0] = '\0';
  tak_lmk[1] = '\0';
  tak_lmk[2] = '\0';
  tak_lmk[3] = '\0';
  tak_lmk[4] = '\0';
  tak_lmk[5] = '\0';
  tak_lmk[6] = '\0';
  tak_lmk[7] = '\0';
  tak_lmk[8] = '\0';
  tak_lmk[9] = '\0';
  tak_lmk[10] = '\0';
  tak_lmk[0xb] = '\0';
  tak_lmk[0xc] = '\0';
  tak_lmk[0xd] = '\0';
  tak_lmk[0xe] = '\0';
  tak_lmk[0xf] = '\0';
  Command._0_2_ = *(undefined2 *)buffer_received;
  Command[2] = '\0';
  *(undefined4 *)err_code = *(undefined4 *)buffer_received;
  iVar2 = memcmp(Command,&DAT_004cc7b3,2);
  if (iVar2 != 0) {
    trace_event("End   command_MJ(ERROR_COMMAND)",5);
    return 0x7d1;
  }
  TextError(err_code + 2,sLine);
  iVar2 = memcmp(err_code + 2,"00",2);
  if (iVar2 != 0) {
    trace_event("End   command_MJ(CHECK_ERROR)",5);
    return 0x7d2;
  }
  cVar1 = buffer_received[4];
  if (cVar1 == 'U') {
LAB_00464590:
    trace_event("Triple DES Encryption Double Length",4);
    *(undefined8 *)tak_lmk = *(undefined8 *)(buffer_received + 4);
    *(undefined8 *)(tak_lmk + 8) = *(undefined8 *)(buffer_received + 0xc);
    *(undefined8 *)(tak_lmk + 0x10) = *(undefined8 *)(buffer_received + 0x14);
    *(undefined8 *)(tak_lmk + 0x18) = *(undefined8 *)(buffer_received + 0x1c);
    *(undefined8 *)check_value = *(undefined8 *)(buffer_received + 0x24);
    *(undefined8 *)(check_value + 8) = *(undefined8 *)(buffer_received + 0x2c);
    *(undefined8 *)(check_value + 0x10) = *(undefined8 *)(buffer_received + 0x34);
    *(undefined8 *)(check_value + 0x18) = *(undefined8 *)(buffer_received + 0x3c);
    tak_lmk[0x20] = '\0';
  }
  else {
    if (cVar1 < 'V') {
      if (cVar1 == 'T') {
LAB_00464514:
        trace_event("Triple DES Encryption Triple Length",4);
        *(undefined8 *)tak_lmk = *(undefined8 *)(buffer_received + 4);
        *(undefined8 *)(tak_lmk + 8) = *(undefined8 *)(buffer_received + 0xc);
        *(undefined8 *)(tak_lmk + 0x10) = *(undefined8 *)(buffer_received + 0x14);
        *(undefined8 *)(tak_lmk + 0x18) = *(undefined8 *)(buffer_received + 0x1c);
        *(undefined8 *)(tak_lmk + 0x20) = *(undefined8 *)(buffer_received + 0x24);
        *(undefined8 *)(tak_lmk + 0x28) = *(undefined8 *)(buffer_received + 0x2c);
        *(undefined8 *)check_value = *(undefined8 *)(buffer_received + 0x34);
        *(undefined8 *)(check_value + 8) = *(undefined8 *)(buffer_received + 0x3c);
        *(undefined8 *)(check_value + 0x10) = *(undefined8 *)(buffer_received + 0x44);
        *(undefined8 *)(check_value + 0x18) = *(undefined8 *)(buffer_received + 0x4c);
        *(undefined8 *)(check_value + 0x20) = *(undefined8 *)(buffer_received + 0x54);
        *(undefined8 *)(check_value + 0x28) = *(undefined8 *)(buffer_received + 0x5c);
        tak_lmk[0x30] = '\0';
        goto LAB_004644d8;
      }
    }
    else {
      if (cVar1 == 'X') goto LAB_00464590;
      if (cVar1 == 'Y') goto LAB_00464514;
    }
    trace_event("Single DES Encryption Single Length",4);
    *(undefined8 *)tak_lmk = *(undefined8 *)(buffer_received + 4);
    *(undefined8 *)(tak_lmk + 8) = *(undefined8 *)(buffer_received + 0xc);
    *(undefined8 *)check_value = *(undefined8 *)(buffer_received + 0x14);
    *(undefined8 *)(check_value + 8) = *(undefined8 *)(buffer_received + 0x1c);
    tak_lmk[0x10] = '\0';
  }
LAB_004644d8:
  trace_event("End   command_MJ(OK)",5);
  return 0;
}



// WARNING: Unknown calling convention

int command_MG(char *buffer_transmit,char *zmk,char *tak_lmk)

{
  size_t sVar1;
  size_t __n;
  
  trace_event("Start command_MG()",5);
  buffer_transmit[0] = 'M';
  buffer_transmit[1] = 'G';
  sVar1 = strlen(zmk);
  memcpy(buffer_transmit + 2,zmk,sVar1);
  sVar1 = strlen(zmk);
  __n = strlen(tak_lmk);
  memcpy(buffer_transmit + 2 + sVar1,tak_lmk,__n);
  trace_event("End   command_MG(OK)",5);
  return 0;
}



// WARNING: Unknown calling convention

int command_MG_TDES(char *buffer_transmit,char *zmk,char *tak_lmk)

{
  size_t sVar1;
  size_t sVar2;
  
  trace_event("Start command_MG_TDES()",5);
  buffer_transmit[0] = 'M';
  buffer_transmit[1] = 'G';
  sVar1 = strlen(zmk);
  memcpy(buffer_transmit + 2,zmk,sVar1);
  sVar1 = strlen(zmk);
  sVar2 = strlen(tak_lmk);
  memcpy(buffer_transmit + 2 + sVar1,tak_lmk,sVar2);
  sVar2 = strlen(tak_lmk);
  builtin_strncpy(buffer_transmit + sVar2 + sVar1 + 2,";XU0",4);
  trace_event("End   command_MG_TDES(OK)",5);
  return 0;
}



// WARNING: Unknown calling convention

int command_MH(char *buffer_received,char *tak_zmk,char *check_value,char *err_code)

{
  char cVar1;
  int iVar2;
  char Command [3];
  char sLine [512];
  
  trace_event("Start command_MH()",5);
  tak_zmk[0] = '\0';
  tak_zmk[1] = '\0';
  tak_zmk[2] = '\0';
  tak_zmk[3] = '\0';
  tak_zmk[4] = '\0';
  tak_zmk[5] = '\0';
  tak_zmk[6] = '\0';
  tak_zmk[7] = '\0';
  tak_zmk[8] = '\0';
  tak_zmk[9] = '\0';
  tak_zmk[10] = '\0';
  tak_zmk[0xb] = '\0';
  tak_zmk[0xc] = '\0';
  tak_zmk[0xd] = '\0';
  tak_zmk[0xe] = '\0';
  tak_zmk[0xf] = '\0';
  Command._0_2_ = *(undefined2 *)buffer_received;
  Command[2] = '\0';
  *(undefined4 *)err_code = *(undefined4 *)buffer_received;
  iVar2 = memcmp(Command,&DAT_004cc856,2);
  if (iVar2 != 0) {
    trace_event("End   command_MH(ERROR_COMMAND)",5);
    return 0x7d1;
  }
  TextError(err_code + 2,sLine);
  iVar2 = memcmp(err_code + 2,"00",2);
  if (iVar2 != 0) {
    trace_event("End   command_MH(CHECK_ERROR)",5);
    return 0x7d2;
  }
  cVar1 = buffer_received[4];
  if (cVar1 == 'U') {
LAB_004648f0:
    trace_event("Triple DES Encryption Double Length",4);
    *(undefined8 *)tak_zmk = *(undefined8 *)(buffer_received + 4);
    *(undefined8 *)(tak_zmk + 8) = *(undefined8 *)(buffer_received + 0xc);
    *(undefined8 *)(tak_zmk + 0x10) = *(undefined8 *)(buffer_received + 0x14);
    *(undefined8 *)(tak_zmk + 0x18) = *(undefined8 *)(buffer_received + 0x1c);
    *(undefined8 *)check_value = *(undefined8 *)(buffer_received + 0x24);
    *(undefined8 *)(check_value + 8) = *(undefined8 *)(buffer_received + 0x2c);
    *(undefined8 *)(check_value + 0x10) = *(undefined8 *)(buffer_received + 0x34);
    *(undefined8 *)(check_value + 0x18) = *(undefined8 *)(buffer_received + 0x3c);
    tak_zmk[0x20] = '\0';
  }
  else {
    if (cVar1 < 'V') {
      if (cVar1 == 'T') {
LAB_00464874:
        trace_event("Triple DES Encryption Triple Length",4);
        *(undefined8 *)tak_zmk = *(undefined8 *)(buffer_received + 4);
        *(undefined8 *)(tak_zmk + 8) = *(undefined8 *)(buffer_received + 0xc);
        *(undefined8 *)(tak_zmk + 0x10) = *(undefined8 *)(buffer_received + 0x14);
        *(undefined8 *)(tak_zmk + 0x18) = *(undefined8 *)(buffer_received + 0x1c);
        *(undefined8 *)(tak_zmk + 0x20) = *(undefined8 *)(buffer_received + 0x24);
        *(undefined8 *)(tak_zmk + 0x28) = *(undefined8 *)(buffer_received + 0x2c);
        *(undefined8 *)check_value = *(undefined8 *)(buffer_received + 0x34);
        *(undefined8 *)(check_value + 8) = *(undefined8 *)(buffer_received + 0x3c);
        *(undefined8 *)(check_value + 0x10) = *(undefined8 *)(buffer_received + 0x44);
        *(undefined8 *)(check_value + 0x18) = *(undefined8 *)(buffer_received + 0x4c);
        *(undefined8 *)(check_value + 0x20) = *(undefined8 *)(buffer_received + 0x54);
        *(undefined8 *)(check_value + 0x28) = *(undefined8 *)(buffer_received + 0x5c);
        tak_zmk[0x30] = '\0';
        goto LAB_00464838;
      }
    }
    else {
      if (cVar1 == 'X') goto LAB_004648f0;
      if (cVar1 == 'Y') goto LAB_00464874;
    }
    trace_event("Single DES Encryption Single Length",4);
    *(undefined8 *)tak_zmk = *(undefined8 *)(buffer_received + 4);
    *(undefined8 *)(tak_zmk + 8) = *(undefined8 *)(buffer_received + 0xc);
    *(undefined8 *)check_value = *(undefined8 *)(buffer_received + 0x14);
    *(undefined8 *)(check_value + 8) = *(undefined8 *)(buffer_received + 0x1c);
    tak_zmk[0x10] = '\0';
  }
LAB_00464838:
  trace_event("End   command_MH(OK)",5);
  return 0;
}



// WARNING: Unknown calling convention

int command_BA(char *buffer_transmit,char *pin,char *Pan)

{
  char card [13];
  
  card[0] = '\0';
  card[1] = '\0';
  card[2] = '\0';
  card[3] = '\0';
  card[4] = '\0';
  card[5] = '\0';
  card[6] = '\0';
  card[7] = '\0';
  card[8] = '\0';
  card[9] = '\0';
  card[10] = '\0';
  card[0xb] = '\0';
  card[0xc] = '\0';
  trace_event("Start command_BA()",5);
  buffer_transmit[0] = 'B';
  buffer_transmit[1] = 'A';
  *(undefined8 *)(buffer_transmit + 2) = *(undefined8 *)pin;
  *(undefined8 *)(buffer_transmit + 10) = *(undefined8 *)(pin + 8);
  format_card_from_pan(card,Pan);
  *(undefined8 *)(buffer_transmit + 0x12) = card._0_8_;
  *(undefined4 *)(buffer_transmit + 0x1a) = card._8_4_;
  trace_event("End   command_BA(OK)",5);
  return 0;
}



// WARNING: Unknown calling convention

int command_BB(char *buffer_received,char *pin_lmk,char *err_code)

{
  int iVar1;
  char Command [3];
  char sLine [512];
  
  trace_event("Start command_BB()",5);
  pin_lmk[0] = '\0';
  pin_lmk[1] = '\0';
  pin_lmk[2] = '\0';
  pin_lmk[3] = '\0';
  pin_lmk[4] = '\0';
  pin_lmk[5] = '\0';
  pin_lmk[6] = '\0';
  pin_lmk[7] = '\0';
  pin_lmk[8] = '\0';
  pin_lmk[9] = '\0';
  pin_lmk[10] = '\0';
  pin_lmk[0xb] = '\0';
  pin_lmk[0xc] = '\0';
  pin_lmk[0xd] = '\0';
  pin_lmk[0xe] = '\0';
  pin_lmk[0xf] = '\0';
  Command._0_2_ = *(undefined2 *)buffer_received;
  Command[2] = '\0';
  *(undefined4 *)err_code = *(undefined4 *)buffer_received;
  iVar1 = memcmp(Command,&DAT_004cc8c7,2);
  if (iVar1 != 0) {
    trace_event("End   command_BB(ERROR_COMMAND)",5);
    return 0x7d1;
  }
  TextError(err_code + 2,sLine);
  iVar1 = memcmp(err_code + 2,"00",2);
  if (iVar1 != 0) {
    trace_event("End   command_BB(CHECK_ERROR)",5);
    return 0x7d2;
  }
  *(undefined8 *)pin_lmk = *(undefined8 *)(buffer_received + 4);
  *(undefined8 *)(pin_lmk + 8) = *(undefined8 *)(buffer_received + 0xc);
  trace_event("End   command_BB(OK)",5);
  return 0;
}



// WARNING: Unknown calling convention

int command_NC(char *buffer_transmit)

{
  trace_event("Start command_NC()",5);
  buffer_transmit[0] = 'N';
  buffer_transmit[1] = 'C';
  trace_event("End   command_NC()",5);
  return 0;
}



// WARNING: Unknown calling convention

int command_ND(char *buffer_received,char *lmk_check,char *err_code)

{
  int iVar1;
  char Command [3];
  char sLine [512];
  
  trace_event("Start command_ND()",5);
  Command._0_2_ = *(undefined2 *)buffer_received;
  Command[2] = '\0';
  *(undefined4 *)err_code = *(undefined4 *)buffer_received;
  iVar1 = memcmp(Command,"ND",2);
  if (iVar1 != 0) {
    trace_event("End   command_ND(ERROR_COMMAND)",5);
    return 0x7d1;
  }
  TextError(err_code + 2,sLine);
  iVar1 = memcmp(err_code + 2,"00",2);
  if (iVar1 != 0) {
    trace_event("End   command_ND(CHECK_ERROR)",5);
    return 0x7d2;
  }
  *(undefined8 *)lmk_check = *(undefined8 *)(buffer_received + 4);
  *(undefined8 *)(lmk_check + 8) = *(undefined8 *)(buffer_received + 0xc);
  trace_event("End   command_ND(OK)",5);
  return 0;
}



// WARNING: Unknown calling convention

int command_DA(char *buffer_transmit,char *Zpk,char *Pvka,char *PinZpk,char *format,char *Pan,
              char *offset,int PinLength)

{
  undefined2 uVar1;
  size_t sVar2;
  size_t sVar3;
  char *pcVar4;
  char vPinLen [3];
  char Card [13];
  
  pcVar4 = buffer_transmit + 2;
  Card[0] = '\0';
  Card[1] = '\0';
  Card[2] = '\0';
  Card[3] = '\0';
  Card[4] = '\0';
  Card[5] = '\0';
  Card[6] = '\0';
  Card[7] = '\0';
  Card[8] = '\0';
  Card[9] = '\0';
  Card[10] = '\0';
  Card[0xb] = '\0';
  Card[0xc] = '\0';
  trace_event("Start command_DA",5);
  buffer_transmit[0] = 'D';
  buffer_transmit[1] = 'A';
  sVar2 = strlen(Zpk);
  memcpy(pcVar4,Zpk,sVar2);
  sVar2 = strlen(Zpk);
  sVar3 = strlen(Pvka);
  memcpy(pcVar4 + sVar2,Pvka,sVar3);
  sVar3 = strlen(Pvka);
  pcVar4 = pcVar4 + sVar2 + sVar3;
  pcVar4[0] = '1';
  pcVar4[1] = '2';
  *(undefined8 *)(pcVar4 + 2) = *(undefined8 *)PinZpk;
  *(undefined8 *)(pcVar4 + 10) = *(undefined8 *)(PinZpk + 8);
  *(undefined2 *)(pcVar4 + 0x12) = *(undefined2 *)format;
  sprintf(vPinLen,"%02d",(ulong)(uint)PinLength);
  *(undefined2 *)(pcVar4 + 0x14) = vPinLen._0_2_;
  format_card_from_pan(Card,Pan);
  *(undefined8 *)(pcVar4 + 0x16) = Card._0_8_;
  *(undefined4 *)(pcVar4 + 0x1e) = Card._8_4_;
  pcVar4[0x22] = '0';
  pcVar4[0x23] = '1';
  pcVar4[0x24] = '2';
  pcVar4[0x25] = '3';
  pcVar4[0x26] = '4';
  pcVar4[0x27] = '5';
  pcVar4[0x28] = '6';
  pcVar4[0x29] = '7';
  pcVar4[0x2a] = '8';
  pcVar4[0x2b] = '9';
  pcVar4[0x2c] = '0';
  pcVar4[0x2d] = '1';
  pcVar4[0x2e] = '2';
  pcVar4[0x2f] = '3';
  pcVar4[0x30] = '4';
  pcVar4[0x31] = '5';
  *(undefined8 *)(pcVar4 + 0x32) = *(undefined8 *)Pan;
  uVar1 = *(undefined2 *)(Pan + 8);
  pcVar4[0x3c] = 'N';
  *(undefined2 *)(pcVar4 + 0x3a) = uVar1;
  sVar2 = strlen(Pan);
  pcVar4[0x3d] = Pan[sVar2 - 1];
  sVar2 = strlen(offset);
  memcpy(pcVar4 + 0x3e,offset,sVar2);
  sVar2 = strlen(offset);
  memcpy(pcVar4 + 0x3e + sVar2,"FFFFFFFFFFFF",0xc - sVar2);
  trace_event("End command_DA()",5);
  return 0;
}



// WARNING: Unknown calling convention

int command_DB(char *buffer_received,char *err_code)

{
  int iVar1;
  int iVar2;
  char *err_code_00;
  char Command [3];
  char sLine [512];
  
  Command._0_2_ = *(undefined2 *)buffer_received;
  Command[2] = '\0';
  *(undefined4 *)err_code = *(undefined4 *)buffer_received;
  iVar1 = memcmp(Command,&DAT_004cc998,2);
  iVar2 = 0x7d1;
  if (iVar1 == 0) {
    err_code_00 = err_code + 2;
    TextError(err_code_00,sLine);
    iVar2 = memcmp(err_code_00,"00",2);
    if (iVar2 != 0) {
      iVar1 = memcmp(err_code_00,"01",2);
      return 2 - (uint)(iVar1 == 0);
    }
  }
  return iVar2;
}



// WARNING: Unknown calling convention

int command_MW(uchar *Buffer,char mode,uchar *tak_key,uchar *sVect,uchar *mac_data,
              uchar *message_mac,int lg_message_mac)

{
  long lVar1;
  int iVar2;
  long lVar3;
  long local_240;
  char ligne [512];
  
  trace_event("Start command_MW()",5);
  Buffer[2] = mode;
  Buffer[0] = 'M';
  Buffer[1] = 'W';
  *(undefined8 *)(Buffer + 3) = *(undefined8 *)tak_key;
  *(undefined8 *)(Buffer + 0xb) = *(undefined8 *)(tak_key + 8);
  if ((byte)(mode - 0x30U) < 2) {
    lVar3 = 0x1e;
    iVar2 = 0x1e;
    local_240 = 0x1b;
    lVar1 = 0x13;
  }
  else {
    iVar2 = 0x2e;
    local_240 = 0x2b;
    lVar1 = 0x23;
    *(undefined8 *)(Buffer + 0x13) = *(undefined8 *)sVect;
    lVar3 = 0x2e;
    *(undefined8 *)(Buffer + 0x1b) = *(undefined8 *)(sVect + 8);
  }
  *(undefined8 *)(Buffer + lVar1) = *(undefined8 *)mac_data;
  sprintf(ligne,"Inside command_MW the length is %d",(ulong)(uint)lg_message_mac);
  trace_event(ligne,5);
  sprintf((char *)(Buffer + local_240),"%03X",(ulong)(uint)lg_message_mac);
  memcpy(Buffer + lVar3,message_mac,(long)lg_message_mac);
  if (debug_option == 1) {
    sprintf(ligne,"End command_MW(%02d)%s",(ulong)(uint)(lg_message_mac + iVar2),Buffer);
  }
  else {
    builtin_strncpy(ligne,"End command_MW(OK)",0x13);
  }
  trace_event(ligne,5);
  return lg_message_mac + iVar2;
}



// WARNING: Unknown calling convention

int command_MX(uchar *Buffer_received,uchar *error_code)

{
  int iVar1;
  int iVar2;
  char Command [3];
  char sLine [512];
  
  trace_event("Start command_MX()",5);
  if (debug_option == 1) {
    sprintf(sLine,"Buffer_received=[%s]",Buffer_received);
    trace_event(sLine,5);
  }
  Command._0_2_ = *(undefined2 *)Buffer_received;
  Command[2] = '\0';
  iVar2 = 0x7d1;
  *(undefined2 *)error_code = *(undefined2 *)(Buffer_received + 2);
  iVar1 = memcmp(Command,&DAT_004cc9f2,2);
  if (iVar1 == 0) {
    iVar2 = memcmp(error_code,"00",2);
    if (iVar2 == 0) {
      trace_event("End   command_MX(OK)",5);
      iVar2 = 0;
    }
    else {
      iVar2 = 1;
      iVar1 = memcmp(error_code,"01",2);
      if (iVar1 != 0) {
        trace_event("End   command_MX(ERROR)",5);
        return 2;
      }
    }
  }
  return iVar2;
}



// WARNING: Unknown calling convention

int command_MU_DES(uchar *Buffer,char mode,uchar *tak_key,uchar *sVect,uchar *message_mac,
                  int lg_message_mac)

{
  long lVar1;
  int iVar2;
  long lVar3;
  char ligne [512];
  
  trace_event("Start command_MU()",5);
  Buffer[2] = mode;
  Buffer[0] = 'M';
  Buffer[1] = 'U';
  *(undefined8 *)(Buffer + 3) = *(undefined8 *)tak_key;
  *(undefined8 *)(Buffer + 0xb) = *(undefined8 *)(tak_key + 8);
  if ((byte)(mode - 0x30U) < 2) {
    lVar3 = 0x16;
    iVar2 = 0x16;
    lVar1 = 0x13;
  }
  else {
    lVar3 = 0x26;
    iVar2 = 0x26;
    lVar1 = 0x23;
    *(undefined8 *)(Buffer + 0x13) = *(undefined8 *)sVect;
    *(undefined8 *)(Buffer + 0x1b) = *(undefined8 *)(sVect + 8);
  }
  sprintf((char *)(Buffer + lVar1),"%03X",(ulong)(uint)lg_message_mac);
  memcpy(Buffer + lVar3,message_mac,(long)lg_message_mac);
  sprintf(ligne,"End command_MU(%02d)",(ulong)(uint)(lg_message_mac + iVar2));
  trace_event(ligne,5);
  return lg_message_mac + iVar2;
}



// WARNING: Unknown calling convention

int command_MU(uchar *Buffer,char mode,uchar *tak_key,uchar *sVect,uchar *message_mac,
              int lg_message_mac)

{
  int iVar1;
  long lVar2;
  long lVar3;
  char ligne [512];
  
  trace_event("Start command_MU()",5);
  Buffer[2] = mode;
  Buffer[0] = 'M';
  Buffer[1] = 'U';
  *(undefined8 *)(Buffer + 3) = *(undefined8 *)tak_key;
  *(undefined8 *)(Buffer + 0xb) = *(undefined8 *)(tak_key + 8);
  *(undefined8 *)(Buffer + 0x13) = *(undefined8 *)(tak_key + 0x10);
  *(undefined8 *)(Buffer + 0x1b) = *(undefined8 *)(tak_key + 0x18);
  Buffer[0x23] = tak_key[0x20];
  if ((byte)(mode - 0x30U) < 2) {
    lVar3 = 0x27;
    iVar1 = 0x27;
    lVar2 = 0x24;
  }
  else {
    lVar3 = 0x37;
    iVar1 = 0x37;
    lVar2 = 0x34;
    *(undefined8 *)(Buffer + 0x24) = *(undefined8 *)sVect;
    *(undefined8 *)(Buffer + 0x2c) = *(undefined8 *)(sVect + 8);
  }
  sprintf((char *)(Buffer + lVar2),"%03X",(ulong)(uint)lg_message_mac);
  memcpy(Buffer + lVar3,message_mac,(long)lg_message_mac);
  sprintf(ligne,"End command_MU(%02d)",(ulong)(uint)(lg_message_mac + iVar1));
  trace_event(ligne,5);
  return lg_message_mac + iVar1;
}



// WARNING: Unknown calling convention

int command_MV(uchar *Buffer_received,uchar *error_code,uchar *mac_data)

{
  int iVar1;
  int iVar2;
  size_t __n;
  char Command [3];
  
  iVar2 = 0x7d1;
  trace_event("Start command_MV()",5);
  Command._0_2_ = *(undefined2 *)Buffer_received;
  *(undefined2 *)error_code = *(undefined2 *)(Buffer_received + 2);
  iVar1 = memcmp(Command,"MV",2);
  if (iVar1 == 0) {
    iVar2 = memcmp(error_code,"00",2);
    if (iVar2 != 0) {
      return 0x7d2;
    }
    __n = strlen((char *)(Buffer_received + 4));
    memcpy(mac_data,Buffer_received + 4,__n);
    trace_event("End   command_MV(OK)",5);
    iVar2 = 0;
  }
  return iVar2;
}



// WARNING: Unknown calling convention

int command_KU_OLD(char *sHsmBuffer,char cModeFlag,char cSchemeId,char *sSMI,char *sPanAndSeq,
                  char *sIntegSessData,int nPlainTextLen,char *sPlainTextData,char *sSMC,char *sTK,
                  char *sConfSessData,int nOffset,int nCipherTextLen,char *sCipherTextData)

{
  size_t sVar1;
  int iVar2;
  uint uVar3;
  char sLine [512];
  
  trace_event("Start command_KU_OLD()",5);
  trace_event("KU",5);
  sHsmBuffer[3] = cSchemeId;
  sHsmBuffer[2] = cModeFlag;
  sHsmBuffer[0] = 'K';
  sHsmBuffer[1] = 'U';
  if (debug_option == 1) {
    sprintf(sLine,"==> sSMI=[%s]",sSMI);
    trace_event(sLine,0);
  }
  sVar1 = strlen(sSMI);
  memcpy(sHsmBuffer + 4,sSMI,sVar1);
  sVar1 = strlen(sSMI);
  iVar2 = (int)sVar1;
  *(undefined8 *)(sHsmBuffer + (iVar2 + 4)) = *(undefined8 *)sPanAndSeq;
  *(undefined8 *)(sHsmBuffer + (iVar2 + 0xc)) = *(undefined8 *)sIntegSessData;
  sprintf(sHsmBuffer + (iVar2 + 0x14),"%04X",(ulong)(uint)nPlainTextLen);
  memcpy(sHsmBuffer + (iVar2 + 0x18),sPlainTextData,(long)nPlainTextLen);
  iVar2 = iVar2 + 0x18 + nPlainTextLen;
  uVar3 = iVar2 + 1;
  sHsmBuffer[iVar2] = ';';
  if (cModeFlag != '0') {
    sVar1 = strlen(sSMC);
    memcpy(sHsmBuffer + (int)uVar3,sSMC,sVar1);
    sVar1 = strlen(sSMC);
    iVar2 = uVar3 + (int)sVar1;
    sVar1 = strlen(sTK);
    memcpy(sHsmBuffer + iVar2,sTK,sVar1);
    sVar1 = strlen(sSMC);
    iVar2 = iVar2 + (int)sVar1;
    *(undefined8 *)(sHsmBuffer + iVar2) = *(undefined8 *)sConfSessData;
    sprintf(sHsmBuffer + (iVar2 + 8),"%04X",(ulong)(uint)nOffset);
    sprintf(sHsmBuffer + (iVar2 + 0xc),"%04X",(ulong)(uint)nCipherTextLen);
    memcpy(sHsmBuffer + (iVar2 + 0xe),sCipherTextData,(long)nCipherTextLen);
    uVar3 = iVar2 + 0xe + nCipherTextLen;
  }
  sprintf(sLine,"End command_KU_OLD(%d)",(ulong)uVar3);
  trace_event(sLine,5);
  return uVar3;
}



// WARNING: Unknown calling convention

int command_KV_OLD(char *sBuffRcv,char cModeFlag,char *sErrCode,char *sMAC,int *nSecureMsgLen,
                  char *sSecureMsgData)

{
  int iVar1;
  long lVar2;
  char *pcVar3;
  byte bVar4;
  char Command [3];
  char sLine [512];
  char sLine2 [512];
  char sTmpData [4096];
  
  bVar4 = 0;
  trace_event("Start command_KV_OLD()",5);
  pcVar3 = sTmpData;
  for (lVar2 = 0x200; lVar2 != 0; lVar2 = lVar2 + -1) {
    pcVar3[0] = '\0';
    pcVar3[1] = '\0';
    pcVar3[2] = '\0';
    pcVar3[3] = '\0';
    pcVar3[4] = '\0';
    pcVar3[5] = '\0';
    pcVar3[6] = '\0';
    pcVar3[7] = '\0';
    pcVar3 = pcVar3 + (ulong)bVar4 * -0x10 + 8;
  }
  Command._0_2_ = *(undefined2 *)sBuffRcv;
  Command[2] = '\0';
  *(undefined4 *)sErrCode = *(undefined4 *)sBuffRcv;
  iVar1 = memcmp(Command,&DAT_004ccacd,2);
  if (iVar1 == 0) {
    TextError(sErrCode + 2,sLine);
    sprintf(sLine2,"sErrCode=[%s]. sLine=[%s]",sErrCode,sLine);
    trace_event(sLine2,5);
    iVar1 = memcmp(sErrCode + 2,"00",2);
    if (iVar1 == 0) {
      *(undefined8 *)sMAC = *(undefined8 *)(sBuffRcv + 4);
      if (cModeFlag != '0') {
        sTmpData._0_4_ = *(undefined4 *)(sBuffRcv + 0xc);
        lVar2 = strtol(sTmpData,(char **)0x0,10);
        *nSecureMsgLen = (int)lVar2;
        memcpy(sSecureMsgData,sBuffRcv + 0x10,(size_t)nSecureMsgLen);
      }
      trace_event("End   command_KV_OLD(OK)",5);
      iVar1 = 0;
    }
    else {
      iVar1 = 2;
      trace_event("End   command_KV_OLD(CRYPTOGRAPHIC_ERROR)",5);
    }
  }
  else {
    iVar1 = 0x7d1;
    trace_event("End   command_KV_OLD(ERROR_COMMAND)",5);
  }
  return iVar1;
}



// WARNING: Unknown calling convention

int HexToDec(char *InHexBuff,int *OutDec)

{
  byte bVar1;
  long lVar2;
  long lVar3;
  long lVar4;
  long lVar5;
  char v1 [3];
  char v2 [3];
  char v3 [3];
  char v4 [3];
  
  v1[0] = *InHexBuff;
  v1[2] = '\0';
  v2[2] = '\0';
  v3[2] = '\0';
  v4[2] = '\0';
  v1[1] = '\0';
  v2[1] = '\0';
  v2[0] = InHexBuff[1];
  v3[1] = '\0';
  v3[0] = InHexBuff[2];
  v4[1] = '\0';
  v4[0] = InHexBuff[3];
  bVar1 = InHexBuff[1];
  if ('@' < v1[0]) {
    sprintf(v1,"%02d",(ulong)((int)v1[0] - 0x37));
    bVar1 = v2[0];
  }
  if ('@' < (char)bVar1) {
    sprintf(v2,"%02d",(ulong)((int)(char)bVar1 - 0x37));
  }
  if ('@' < v3[0]) {
    sprintf(v3,"%02d",(ulong)((int)v3[0] - 0x37));
  }
  if ('@' < v4[0]) {
    sprintf(v4,"%02d",(ulong)((int)v4[0] - 0x37));
  }
  lVar2 = strtol(v1,(char **)0x0,10);
  lVar3 = strtol(v2,(char **)0x0,10);
  lVar4 = strtol(v3,(char **)0x0,10);
  lVar5 = strtol(v4,(char **)0x0,10);
  *OutDec = (((int)lVar2 * 0x10 + (int)lVar3) * 0x10 + (int)lVar4) * 0x10 + (int)lVar5;
  return 0;
}



// WARNING: Unknown calling convention

int command_KQ(char *sHsmBuffer,char cSchemeId,char *sDmk,char *sPanAndSeq,char *sAtc,char *sUn,
              int nDataLen,char *sData,char *sArqc,char *sArc)

{
  int iVar1;
  size_t sVar2;
  char sLine [512];
  
  trace_event("Start command_KQ()",5);
  sHsmBuffer[3] = cSchemeId;
  sHsmBuffer[0] = 'K';
  sHsmBuffer[1] = 'Q';
  sHsmBuffer[2] = '1';
  sVar2 = strlen(sDmk);
  memcpy(sHsmBuffer + 4,sDmk,sVar2);
  sVar2 = strlen(sDmk);
  iVar1 = (int)sVar2;
  *(undefined8 *)(sHsmBuffer + (iVar1 + 4)) = *(undefined8 *)sPanAndSeq;
  *(undefined2 *)(sHsmBuffer + (iVar1 + 0xc)) = *(undefined2 *)sAtc;
  *(undefined4 *)(sHsmBuffer + (iVar1 + 0xe)) = *(undefined4 *)sUn;
  sprintf(sHsmBuffer + (iVar1 + 0x12),"%02X",(ulong)(uint)nDataLen);
  memcpy(sHsmBuffer + (iVar1 + 0x14),sData,(long)nDataLen);
  iVar1 = iVar1 + 0x14 + nDataLen;
  sHsmBuffer[iVar1] = ';';
  *(undefined8 *)(sHsmBuffer + (iVar1 + 1)) = *(undefined8 *)sArqc;
  *(undefined2 *)(sHsmBuffer + (iVar1 + 9)) = *(undefined2 *)sArc;
  sprintf(sLine,"KCH TRACE131212:  Buffer[%s]",sHsmBuffer);
  trace_event(sLine,5);
  sprintf(sLine,"End command_KQ(%d)",(ulong)(iVar1 + 0xbU));
  trace_event(sLine,5);
  return iVar1 + 0xbU;
}



// WARNING: Unknown calling convention

int command_KR(char *sBuffRcv,char *sErrCode,char *sArpc)

{
  char *err_code;
  int iVar1;
  char Command [3];
  char sLine [512];
  
  trace_event("Start command_KR()",5);
  Command._0_2_ = *(undefined2 *)sBuffRcv;
  Command[2] = '\0';
  *(undefined4 *)sErrCode = *(undefined4 *)sBuffRcv;
  iVar1 = memcmp(Command,&DAT_004ccb59,2);
  if (iVar1 == 0) {
    err_code = sErrCode + 2;
    TextError(err_code,sLine);
    iVar1 = memcmp(err_code,"00",2);
    if (iVar1 == 0) {
      *(undefined8 *)sArpc = *(undefined8 *)(sBuffRcv + 4);
      trace_event("End   command_KR(OK)",5);
      iVar1 = 0;
    }
    else {
      iVar1 = memcmp(err_code,"01",2);
      if (iVar1 != 0) {
        trace_event("End   command_KR(CRYPTOGRAPHIC_ERROR)",5);
        return 2;
      }
      iVar1 = 1;
      *(undefined8 *)sArpc = *(undefined8 *)(sBuffRcv + 4);
      trace_event("End   command_KR(VERIFICATION_FAILED)",5);
    }
  }
  else {
    iVar1 = 0x7d1;
    trace_event("End   command_ED(ERROR_COMMAND)",5);
  }
  return iVar1;
}



// WARNING: Unknown calling convention

int command_KX(char *sBuffRcv,char *sErrCode,char *sArpc)

{
  char *err_code;
  int iVar1;
  char Command [3];
  char sLine [512];
  
  trace_event("Start command_KX()",5);
  Command._0_2_ = *(undefined2 *)sBuffRcv;
  Command[2] = '\0';
  *(undefined4 *)sErrCode = *(undefined4 *)sBuffRcv;
  iVar1 = memcmp(Command,&DAT_004ccb84,2);
  if (iVar1 == 0) {
    err_code = sErrCode + 2;
    TextError(err_code,sLine);
    iVar1 = memcmp(err_code,"00",2);
    if (iVar1 == 0) {
      *(undefined8 *)sArpc = *(undefined8 *)(sBuffRcv + 4);
      trace_event("End   command_KX(OK)",5);
      iVar1 = 0;
    }
    else {
      iVar1 = memcmp(err_code,"01",2);
      if (iVar1 != 0) {
        trace_event("End   command_KX(CRYPTOGRAPHIC_ERROR)",5);
        return 2;
      }
      iVar1 = 1;
      *(undefined8 *)sArpc = *(undefined8 *)(sBuffRcv + 4);
      trace_event("End   command_KX(VERIFICATION_FAILED)",5);
    }
  }
  else {
    iVar1 = 0x7d1;
    trace_event("End   command_KX(ERROR_COMMAND)",5);
  }
  return iVar1;
}



// WARNING: Unknown calling convention

int command_KW(char *sHsmBuffer,char cSchemeId,char *sDmk,char *sPanAndSeq,char *sAtc,char *sUn,
              int nDataLen,char *sData,char *sArqc,char *sCsu)

{
  size_t sVar1;
  uint uVar2;
  int iVar3;
  ulong uVar4;
  char sLine [512];
  
  trace_event("Start command_KW(..)",5);
  sHsmBuffer[0] = 'K';
  sHsmBuffer[1] = 'W';
  sprintf(sLine,"offset_1(%d), HsmBuffer (%s) ",2,sHsmBuffer);
  trace_event(sLine,5);
  sHsmBuffer[3] = cSchemeId;
  sHsmBuffer[2] = (nDataLen < 1) + '3';
  sprintf(sLine,"offset_2(%d), HsmBuffer (%s) ",4,sHsmBuffer);
  trace_event(sLine,5);
  sVar1 = strlen(sDmk);
  memcpy(sHsmBuffer + 4,sDmk,sVar1);
  sVar1 = strlen(sDmk);
  iVar3 = (int)sVar1;
  sprintf(sLine,"offset_3(%d), HsmBuffer (%s) ",(ulong)(iVar3 + 4U),sHsmBuffer);
  trace_event(sLine,5);
  uVar2 = iVar3 + 0xe;
  *(undefined8 *)(sHsmBuffer + (int)(iVar3 + 4U)) = *(undefined8 *)sPanAndSeq;
  sprintf(sLine,"offset_3_1(%d) ",(ulong)(iVar3 + 0xcU));
  trace_event(sLine,5);
  *(undefined2 *)(sHsmBuffer + (int)(iVar3 + 0xcU)) = *(undefined2 *)sAtc;
  sprintf(sLine,"offset_3_2(%d) ",(ulong)uVar2);
  trace_event(sLine,5);
  if (((byte)(sHsmBuffer[2] - 0x30U) < 2) || (sHsmBuffer[2] == '3')) {
    sprintf(sHsmBuffer + (int)uVar2,"%02X",(ulong)(uint)nDataLen);
    memcpy(sHsmBuffer + (iVar3 + 0x10),sData,(long)nDataLen);
    iVar3 = iVar3 + 0x10 + nDataLen;
    uVar2 = iVar3 + 1;
    sHsmBuffer[iVar3] = ';';
  }
  uVar4 = (ulong)(uVar2 + 8);
  sprintf(sLine,"offset_4(%d) ",(ulong)uVar2);
  trace_event(sLine,5);
  *(undefined8 *)(sHsmBuffer + (int)uVar2) = *(undefined8 *)sArqc;
  sprintf(sLine,"offset_5(%d) ",uVar4);
  trace_event(sLine,5);
  if ((byte)(sHsmBuffer[2] - 0x33U) < 2) {
    *(undefined4 *)(sHsmBuffer + (int)(uVar2 + 8)) = *(undefined4 *)sCsu;
    uVar4 = (ulong)(uVar2 + 0xd);
    sHsmBuffer[(int)(uVar2 + 0xc)] = '0';
  }
  sprintf(sLine,"offset_6(%d) ",uVar4);
  trace_event(sLine,5);
  sprintf(sLine,"End command_KW(%d) ",uVar4);
  trace_event(sLine,5);
  return (int)uVar4;
}



// WARNING: Unknown calling convention

int command_KW_DCI(char *sHsmBuffer,char cSchemeId,char *sDmk,char *sPanAndSeq,char *sAtc,char *sUn,
                  int nDataLen,char *sData,char *sArqc,char *sCsu,char *sArc)

{
  char cVar1;
  int iVar2;
  size_t sVar3;
  int iVar4;
  char sLine [512];
  char szWork [4096];
  char szWork1 [4096];
  
  trace_event("Start command_KW_DCI()",5);
  sHsmBuffer[3] = cSchemeId;
  sHsmBuffer[0] = 'K';
  sHsmBuffer[1] = 'W';
  sHsmBuffer[2] = (nDataLen < 1) + '1';
  sVar3 = strlen(sDmk);
  memcpy(sHsmBuffer + 4,sDmk,sVar3);
  sVar3 = strlen(sDmk);
  iVar4 = (int)sVar3;
  *(undefined8 *)(sHsmBuffer + (iVar4 + 4)) = *(undefined8 *)sPanAndSeq;
  iVar2 = iVar4 + 0xe;
  *(undefined2 *)(sHsmBuffer + (iVar4 + 0xc)) = *(undefined2 *)sAtc;
  if (((byte)(sHsmBuffer[2] - 0x30U) < 2) || (sHsmBuffer[2] == '3')) {
    sprintf(sHsmBuffer + iVar2,"%02X",(ulong)(uint)nDataLen);
    memcpy(sHsmBuffer + (iVar4 + 0x10),sData,(long)nDataLen);
    iVar4 = iVar4 + 0x10 + nDataLen;
    iVar2 = iVar4 + 1;
    sHsmBuffer[iVar4] = ';';
  }
  iVar4 = iVar2 + 8;
  *(undefined8 *)(sHsmBuffer + iVar2) = *(undefined8 *)sArqc;
  cVar1 = sHsmBuffer[2];
  if ((byte)(cVar1 - 0x31U) < 2) {
    *(undefined2 *)(sHsmBuffer + iVar4) = *(undefined2 *)sArc;
    iVar4 = iVar2 + 10;
    cVar1 = sHsmBuffer[2];
  }
  if ((byte)(cVar1 - 0x33U) < 2) {
    *(undefined4 *)(sHsmBuffer + iVar4) = *(undefined4 *)sCsu;
    iVar2 = iVar4 + 4;
    iVar4 = iVar4 + 5;
    sHsmBuffer[iVar2] = '0';
  }
  szWork[0] = '1';
  szWork[1] = '9';
  AsciiToHex((uchar *)szWork,(uchar *)szWork1,2);
  sHsmBuffer[iVar4] = szWork1[0];
  sprintf(sLine,"sHsmBuffer (%s)",sHsmBuffer);
  trace_event(sLine,5);
  sprintf(sLine,"End command_KW_DCI(%d)",(ulong)(iVar4 + 1U));
  trace_event(sLine,5);
  return iVar4 + 1U;
}



// WARNING: Unknown calling convention

int command_KU(char *sHsmBuffer,char cModeFlag,char cSchemeId,char *sSMI,char *sPanAndSeq,
              char *sIntegSessData,int nPlainTextLen,char *sPlainTextData,char *sSMC,char *sTK,
              char *sConfSessData,int nOffset,int nCipherTextLen,char *sCipherTextData,
              char *sSrcPBFrmt,char *sDestPBFrmt,char *sPan12LastDigits,char *sAC,
              char encryption_mode)

{
  size_t sVar1;
  int iVar2;
  uint uVar3;
  int iVar4;
  char sLine [512];
  
  trace_event("Start command_KU()",5);
  sHsmBuffer[3] = cSchemeId;
  sHsmBuffer[0] = 'K';
  sHsmBuffer[1] = 'U';
  sHsmBuffer[2] = cModeFlag;
  if (debug_option == 1) {
    sprintf(sLine,"==> sSMI=[%s]",sSMI);
    trace_event(sLine,0);
  }
  sVar1 = strlen(sSMI);
  memcpy(sHsmBuffer + 4,sSMI,sVar1);
  sVar1 = strlen(sSMI);
  iVar2 = (int)sVar1;
  *(undefined8 *)(sHsmBuffer + (iVar2 + 4)) = *(undefined8 *)sPanAndSeq;
  *(undefined8 *)(sHsmBuffer + (iVar2 + 0xc)) = *(undefined8 *)sIntegSessData;
  sprintf(sHsmBuffer + (iVar2 + 0x14),"%04X",(ulong)(uint)nPlainTextLen);
  memcpy(sHsmBuffer + (iVar2 + 0x18),sPlainTextData,(long)nPlainTextLen);
  iVar2 = iVar2 + 0x18 + nPlainTextLen;
  uVar3 = iVar2 + 1;
  sHsmBuffer[iVar2] = ';';
  if (cModeFlag == '4') {
    sVar1 = strlen(sSMC);
    memcpy(sHsmBuffer + (int)uVar3,sSMC,sVar1);
    sVar1 = strlen(sSMC);
    iVar2 = uVar3 + (int)sVar1;
    *(undefined8 *)(sHsmBuffer + iVar2) = *(undefined8 *)sConfSessData;
    sprintf(sHsmBuffer + (iVar2 + 8),"%04X",(ulong)(uint)nOffset);
    sprintf(sHsmBuffer + (iVar2 + 0xc),"%04X",(ulong)(uint)nCipherTextLen);
    memcpy(sHsmBuffer + (iVar2 + 0x10),sCipherTextData,(long)nCipherTextLen);
    iVar4 = iVar2 + 0x10 + nCipherTextLen;
    (sHsmBuffer + iVar4)[0] = ';';
    (sHsmBuffer + iVar4)[1] = '1';
    iVar2 = iVar4 + 3;
    sHsmBuffer[iVar4 + 2] = ';';
    if (*sTK == 'S') {
      sHsmBuffer[iVar2] = 'F';
    }
    else if (encryption_mode == 'T') {
      sHsmBuffer[iVar2] = '1';
    }
    else {
      sHsmBuffer[iVar2] = '0';
    }
    sVar1 = strlen(sTK);
    memcpy(sHsmBuffer + (iVar4 + 4),sTK,sVar1);
    sVar1 = strlen(sTK);
    iVar2 = iVar4 + 4 + (int)sVar1;
    *(undefined2 *)(sHsmBuffer + iVar2) = *(undefined2 *)sSrcPBFrmt;
    *(undefined2 *)(sHsmBuffer + (iVar2 + 2)) = *(undefined2 *)sDestPBFrmt;
    uVar3 = iVar2 + 0x10;
    *(undefined8 *)(sHsmBuffer + (iVar2 + 4)) = *(undefined8 *)sPan12LastDigits;
    *(undefined4 *)(sHsmBuffer + (iVar2 + 4) + 8) = *(undefined4 *)(sPan12LastDigits + 8);
    iVar2 = memcmp(sDestPBFrmt,&DAT_004a8fd3,2);
    if (iVar2 != 0) {
      iVar2 = memcmp(sDestPBFrmt,&DAT_004d44e6,2);
      if (iVar2 != 0) goto LAB_00466343;
    }
    sVar1 = strlen(sAC);
    memcpy(sHsmBuffer + (int)uVar3,sAC,sVar1);
    sVar1 = strlen(sAC);
    uVar3 = uVar3 + (int)sVar1;
  }
LAB_00466343:
  sprintf(sLine,"End command_KU(%d)",(ulong)uVar3);
  trace_event(sLine,5);
  return uVar3;
}



// WARNING: Unknown calling convention

int command_KV(char *sBuffRcv,char cModeFlag,char *sErrCode,char *sMAC,int *nSecureMsgLen,
              char *sSecureMsgData)

{
  int iVar1;
  long lVar2;
  uchar *puVar3;
  byte bVar4;
  char Command [3];
  uchar sSecDataLen [16];
  char sLine [512];
  char sTmpData [4096];
  
  bVar4 = 0;
  trace_event("Start command_KV()",5);
  puVar3 = (uchar *)sTmpData;
  for (lVar2 = 0x200; lVar2 != 0; lVar2 = lVar2 + -1) {
    puVar3[0] = '\0';
    puVar3[1] = '\0';
    puVar3[2] = '\0';
    puVar3[3] = '\0';
    puVar3[4] = '\0';
    puVar3[5] = '\0';
    puVar3[6] = '\0';
    puVar3[7] = '\0';
    puVar3 = puVar3 + (ulong)bVar4 * -0x10 + 8;
  }
  Command[2] = '\0';
  sSecDataLen[0] = '\0';
  sSecDataLen[1] = '\0';
  sSecDataLen[2] = '\0';
  sSecDataLen[3] = '\0';
  sSecDataLen[4] = '\0';
  sSecDataLen[5] = '\0';
  sSecDataLen[6] = '\0';
  sSecDataLen[7] = '\0';
  Command._0_2_ = *(undefined2 *)sBuffRcv;
  sSecDataLen[8] = '\0';
  sSecDataLen[9] = '\0';
  sSecDataLen[10] = '\0';
  sSecDataLen[0xb] = '\0';
  sSecDataLen[0xc] = '\0';
  sSecDataLen[0xd] = '\0';
  sSecDataLen[0xe] = '\0';
  sSecDataLen[0xf] = '\0';
  *(undefined4 *)sErrCode = *(undefined4 *)sBuffRcv;
  iVar1 = memcmp(Command,&DAT_004ccacd,2);
  if (iVar1 == 0) {
    TextError(sErrCode + 2,sLine);
    iVar1 = memcmp(sErrCode + 2,"00",2);
    if (iVar1 == 0) {
      *(undefined8 *)sMAC = *(undefined8 *)(sBuffRcv + 4);
      if (cModeFlag != '0') {
        sTmpData._0_4_ = *(undefined4 *)(sBuffRcv + 0xc);
        AsciiToHex((uchar *)sTmpData,sSecDataLen,4);
        iVar1 = (uint)sSecDataLen[0] * 0x100 + (uint)sSecDataLen[1];
        *nSecureMsgLen = iVar1;
        memcpy(sSecureMsgData,sBuffRcv + 0x10,(long)iVar1);
      }
      trace_event("End   command_KV(OK)",5);
      iVar1 = 0;
    }
    else {
      iVar1 = 2;
      trace_event("End   command_KV(CRYPTOGRAPHIC_ERROR)",5);
    }
  }
  else {
    iVar1 = 0x7d1;
    trace_event("End   command_KV(ERROR_COMMAND)",5);
  }
  return iVar1;
}



// WARNING: Unknown calling convention

int command_KY(char *sHsmBuffer,char cModeFlag,char cSchemeId,char *sSMI,char *sPanAndSeq,
              char *sIntegSessData,int nPlainTextLen,char *sPlainTextData,char *sSMC,char *sTK,
              char *sConfSessData,int nOffset,int nCipherTextLen,char *sCipherTextData,
              char *sSrcPBFrmt,char *sDestPBFrmt,char *sPan12LastDigits,char *sAC)

{
  size_t sVar1;
  int iVar2;
  uint uVar3;
  int iVar4;
  char sLine [512];
  
  trace_event("Start command_KY()",5);
  sHsmBuffer[3] = cSchemeId;
  sHsmBuffer[0] = 'K';
  sHsmBuffer[1] = 'Y';
  sHsmBuffer[2] = cModeFlag;
  sprintf(sLine,"==> sSMI=[%s]",sSMI);
  trace_event(sLine,0);
  sVar1 = strlen(sSMI);
  memcpy(sHsmBuffer + 4,sSMI,sVar1);
  sVar1 = strlen(sSMI);
  iVar4 = (int)sVar1;
  *(undefined8 *)(sHsmBuffer + (iVar4 + 4)) = *(undefined8 *)sPanAndSeq;
  *(undefined8 *)(sHsmBuffer + (iVar4 + 0xc)) = *(undefined8 *)sIntegSessData;
  sprintf(sHsmBuffer + (iVar4 + 0x14),"%04X",(ulong)(uint)nPlainTextLen);
  iVar2 = iVar4 + 0x18 + nPlainTextLen;
  memcpy(sHsmBuffer + (iVar4 + 0x18),sPlainTextData,(long)nPlainTextLen);
  uVar3 = iVar2 + 1;
  sHsmBuffer[iVar2] = ';';
  if ((cModeFlag == '4') || (cModeFlag == '2')) {
    sVar1 = strlen(sSMC);
    memcpy(sHsmBuffer + (int)uVar3,sSMC,sVar1);
    sVar1 = strlen(sSMC);
    iVar4 = uVar3 + (int)sVar1;
    sprintf(sHsmBuffer + iVar4,"%04X",(ulong)(uint)nOffset);
    sprintf(sHsmBuffer + (iVar4 + 4),"%04X",(ulong)(uint)nCipherTextLen);
    memcpy(sHsmBuffer + (iVar4 + 8),sCipherTextData,(long)nCipherTextLen);
    iVar4 = nCipherTextLen + iVar4 + 8;
    uVar3 = iVar4 + 1;
    sHsmBuffer[iVar4] = ';';
    if (cModeFlag == '4') {
      sHsmBuffer[(int)uVar3] = '1';
      sVar1 = strlen(sTK);
      memcpy(sHsmBuffer + (iVar4 + 2),sTK,sVar1);
      sVar1 = strlen(sTK);
      iVar4 = iVar4 + 2 + (int)sVar1;
      *(undefined2 *)(sHsmBuffer + iVar4) = *(undefined2 *)sSrcPBFrmt;
      *(undefined2 *)(sHsmBuffer + (iVar4 + 2)) = *(undefined2 *)sDestPBFrmt;
      uVar3 = iVar4 + 0x10;
      *(undefined8 *)(sHsmBuffer + (iVar4 + 4)) = *(undefined8 *)sPan12LastDigits;
      *(undefined4 *)(sHsmBuffer + (iVar4 + 4) + 8) = *(undefined4 *)(sPan12LastDigits + 8);
      iVar4 = memcmp(sDestPBFrmt,&DAT_004a8fd3,2);
      if (iVar4 != 0) {
        iVar4 = memcmp(sDestPBFrmt,&DAT_004d44e6,2);
        if (iVar4 != 0) goto LAB_00466829;
      }
      sVar1 = strlen(sAC);
      memcpy(sHsmBuffer + (int)uVar3,sAC,sVar1);
      sVar1 = strlen(sAC);
      uVar3 = uVar3 + (int)sVar1;
    }
  }
LAB_00466829:
  sprintf(sLine,"End command_KY(%d)",(ulong)uVar3);
  trace_event(sLine,5);
  return uVar3;
}



// WARNING: Unknown calling convention

int command_KZ(char *sBuffRcv,char cModeFlag,char *sErrCode,char *sMAC,int *nSecureMsgLen,
              char *sSecureMsgData)

{
  int iVar1;
  long lVar2;
  uchar *puVar3;
  byte bVar4;
  char Command [3];
  uchar sSecDataLen [16];
  char sLine [512];
  char sTmpData [4096];
  
  bVar4 = 0;
  trace_event("Start command_KZ()",5);
  puVar3 = (uchar *)sTmpData;
  for (lVar2 = 0x200; lVar2 != 0; lVar2 = lVar2 + -1) {
    puVar3[0] = '\0';
    puVar3[1] = '\0';
    puVar3[2] = '\0';
    puVar3[3] = '\0';
    puVar3[4] = '\0';
    puVar3[5] = '\0';
    puVar3[6] = '\0';
    puVar3[7] = '\0';
    puVar3 = puVar3 + (ulong)bVar4 * -0x10 + 8;
  }
  Command[2] = '\0';
  sSecDataLen[0] = '\0';
  sSecDataLen[1] = '\0';
  sSecDataLen[2] = '\0';
  sSecDataLen[3] = '\0';
  sSecDataLen[4] = '\0';
  sSecDataLen[5] = '\0';
  sSecDataLen[6] = '\0';
  sSecDataLen[7] = '\0';
  Command._0_2_ = *(undefined2 *)sBuffRcv;
  sSecDataLen[8] = '\0';
  sSecDataLen[9] = '\0';
  sSecDataLen[10] = '\0';
  sSecDataLen[0xb] = '\0';
  sSecDataLen[0xc] = '\0';
  sSecDataLen[0xd] = '\0';
  sSecDataLen[0xe] = '\0';
  sSecDataLen[0xf] = '\0';
  *(undefined4 *)sErrCode = *(undefined4 *)sBuffRcv;
  iVar1 = memcmp(Command,&DAT_004ccd2e,2);
  if (iVar1 == 0) {
    TextError(sErrCode + 2,sLine);
    iVar1 = memcmp(sErrCode + 2,"00",2);
    if (iVar1 == 0) {
      *(undefined8 *)sMAC = *(undefined8 *)(sBuffRcv + 4);
      if (cModeFlag != '5') {
        sTmpData._0_4_ = *(undefined4 *)(sBuffRcv + 0xc);
        AsciiToHex((uchar *)sTmpData,sSecDataLen,4);
        iVar1 = (uint)sSecDataLen[0] * 0x100 + (uint)sSecDataLen[1];
        *nSecureMsgLen = iVar1;
        memcpy(sSecureMsgData,sBuffRcv + 0x10,(long)iVar1);
      }
      trace_event("End   command_KZ(OK)",5);
      iVar1 = 0;
    }
    else {
      iVar1 = 2;
      trace_event("End   command_KZ(CRYPTOGRAPHIC_ERROR)",5);
    }
  }
  else {
    iVar1 = 0x7d1;
    trace_event("End   command_KZ(ERROR_COMMAND)",5);
  }
  return iVar1;
}



// WARNING: Unknown calling convention

void FctIncrimentRandBy1(char *psRandIn,char *psRandOut)

{
  char sTmpIn [16];
  char sTmpOut [16];
  char sLine [512];
  
  sTmpIn[0] = '\0';
  sTmpIn[1] = '\0';
  sTmpIn[2] = '\0';
  sTmpIn[3] = '\0';
  sTmpIn[4] = '\0';
  sTmpIn[5] = '\0';
  sTmpIn[6] = '\0';
  sTmpIn[7] = '\0';
  sTmpIn[8] = '\0';
  sTmpIn[9] = '\0';
  sTmpIn[10] = '\0';
  sTmpIn[0xb] = '\0';
  sTmpIn[0xc] = '\0';
  sTmpIn[0xd] = '\0';
  sTmpIn[0xe] = '\0';
  sTmpIn[0xf] = '\0';
  sTmpOut[0] = '\0';
  sTmpOut[1] = '\0';
  sTmpOut[2] = '\0';
  sTmpOut[3] = '\0';
  sTmpOut[4] = '\0';
  sTmpOut[5] = '\0';
  sTmpOut[6] = '\0';
  sTmpOut[7] = '\0';
  sTmpOut[8] = '\0';
  sTmpOut[9] = '\0';
  sTmpOut[10] = '\0';
  sTmpOut[0xb] = '\0';
  sTmpOut[0xc] = '\0';
  sTmpOut[0xd] = '\0';
  sTmpOut[0xe] = '\0';
  sTmpOut[0xf] = '\0';
  HexToAscii((uchar *)psRandIn,(uchar *)sTmpIn,0x10);
  sprintf(sLine,"START FctIncrimentRandBy1(psRandIn=[%s])",sTmpIn);
  trace_event(sLine,5);
  psRandOut[7] = psRandIn[7] + '\x01';
  HexToAscii((uchar *)psRandOut,(uchar *)sTmpOut,0x10);
  sprintf(sLine,"END   FctIncrimentRandBy1(psRandOut=[%s])",sTmpOut);
  trace_event(sLine,5);
  return;
}



// WARNING: Unknown calling convention

int command_CI(char *sHsmBuffer,char *sBdk,char *sZpk,char *sKsnDesc,char *sKsn,char *sPinBlock,
              char *sFormatOut,char *sPan)

{
  size_t sVar1;
  long lVar2;
  char *pcVar3;
  int iVar4;
  uint uVar5;
  char sCard [13];
  char sLine [512];
  
  sCard[0] = '\0';
  sCard[1] = '\0';
  sCard[2] = '\0';
  sCard[3] = '\0';
  sCard[4] = '\0';
  sCard[5] = '\0';
  sCard[6] = '\0';
  sCard[7] = '\0';
  sCard[8] = '\0';
  sCard[9] = '\0';
  sCard[10] = '\0';
  sCard[0xb] = '\0';
  sCard[0xc] = '\0';
  pcVar3 = sLine;
  for (lVar2 = 0x40; lVar2 != 0; lVar2 = lVar2 + -1) {
    pcVar3[0] = '\0';
    pcVar3[1] = '\0';
    pcVar3[2] = '\0';
    pcVar3[3] = '\0';
    pcVar3[4] = '\0';
    pcVar3[5] = '\0';
    pcVar3[6] = '\0';
    pcVar3[7] = '\0';
    pcVar3 = pcVar3 + 8;
  }
  trace_event("Start command_CI()",5);
  sHsmBuffer[0] = 'C';
  sHsmBuffer[1] = 'I';
  sVar1 = strlen(sBdk);
  memcpy(sHsmBuffer + 2,sBdk,sVar1);
  sVar1 = strlen(sBdk);
  iVar4 = (int)sVar1 + 2;
  sVar1 = strlen(sZpk);
  memcpy(sHsmBuffer + iVar4,sZpk,sVar1);
  sVar1 = strlen(sZpk);
  iVar4 = iVar4 + (int)sVar1;
  sVar1 = strlen(sKsnDesc);
  memcpy(sHsmBuffer + iVar4,sKsnDesc,sVar1);
  sVar1 = strlen(sKsnDesc);
  iVar4 = iVar4 + (int)sVar1;
  sVar1 = strlen(sKsn);
  memcpy(sHsmBuffer + iVar4,sKsn,sVar1);
  sVar1 = strlen(sKsn);
  iVar4 = iVar4 + (int)sVar1;
  sVar1 = strlen(sPinBlock);
  memcpy(sHsmBuffer + iVar4,sPinBlock,sVar1);
  sVar1 = strlen(sPinBlock);
  iVar4 = iVar4 + (int)sVar1;
  sVar1 = strlen(sFormatOut);
  memcpy(sHsmBuffer + iVar4,sFormatOut,sVar1);
  sVar1 = strlen(sFormatOut);
  uVar5 = iVar4 + (int)sVar1;
  format_card_from_pan(sCard,sPan);
  *(undefined8 *)sHsmBuffer = sCard._0_8_;
  *(undefined4 *)(sHsmBuffer + 8) = sCard._8_4_;
  sprintf(sLine,"End command_CI(%d)",(ulong)uVar5);
  trace_event(sLine,5);
  return uVar5;
}



// WARNING: Unknown calling convention

int command_CJ(char *sBuffRcv,char *sErrCode,char *sPinLen,char *sPinBlock,char *sFormatCode)

{
  int iVar1;
  char Command [3];
  char sLine [512];
  
  trace_event("Start command_CJ()",5);
  Command._0_2_ = *(undefined2 *)sBuffRcv;
  Command[2] = '\0';
  *(undefined4 *)sErrCode = *(undefined4 *)sBuffRcv;
  iVar1 = memcmp(Command,&DAT_004ccd7f,2);
  if (iVar1 == 0) {
    TextError(sErrCode + 2,sLine);
    iVar1 = memcmp(sErrCode + 2,"00",2);
    if (iVar1 == 0) {
      *(undefined2 *)sPinLen = *(undefined2 *)(sBuffRcv + 4);
      *(undefined8 *)sPinBlock = *(undefined8 *)(sBuffRcv + 6);
      *(undefined8 *)(sPinBlock + 8) = *(undefined8 *)(sBuffRcv + 0xe);
      *(undefined2 *)sFormatCode = *(undefined2 *)(sBuffRcv + 0x16);
      trace_event("End   command_CJ(OK)",5);
      iVar1 = 0;
    }
    else {
      iVar1 = 1;
      trace_event("End   command_CJ(VERIFICATION_FAILED)",5);
    }
  }
  else {
    iVar1 = 0x7d1;
    trace_event("End   command_CJ(ERROR_COMMAND)",5);
  }
  return iVar1;
}



// WARNING: Unknown calling convention

int command_BI(char *sHsmBuffer)

{
  long lVar1;
  char *pcVar2;
  char sLine [512];
  
  pcVar2 = sLine;
  for (lVar1 = 0x40; lVar1 != 0; lVar1 = lVar1 + -1) {
    *(undefined8 *)pcVar2 = 0;
    pcVar2 = (char *)((long)pcVar2 + 8);
  }
  trace_event("Start command_BI()",5);
  builtin_strncpy(sHsmBuffer,";XU0",4);
  sprintf(sLine,"End command_BI(%d)",2);
  trace_event(sLine,5);
  return 2;
}



// WARNING: Unknown calling convention

int command_BJ(char *sBuffRcv,char *sErrCode,char *sBdkLmk)

{
  char cVar1;
  undefined8 uVar2;
  int iVar3;
  long lVar4;
  char *pcVar5;
  char Command [3];
  char sLine [512];
  
  Command[0] = '\0';
  Command[1] = '\0';
  Command[2] = '\0';
  pcVar5 = sLine;
  for (lVar4 = 0x40; lVar4 != 0; lVar4 = lVar4 + -1) {
    pcVar5[0] = '\0';
    pcVar5[1] = '\0';
    pcVar5[2] = '\0';
    pcVar5[3] = '\0';
    pcVar5[4] = '\0';
    pcVar5[5] = '\0';
    pcVar5[6] = '\0';
    pcVar5[7] = '\0';
    pcVar5 = pcVar5 + 8;
  }
  trace_event("Start command_BJ()",5);
  Command._0_2_ = *(undefined2 *)sBuffRcv;
  *(undefined4 *)sErrCode = *(undefined4 *)sBuffRcv;
  iVar3 = memcmp(Command,&DAT_004ccdd0,2);
  if (iVar3 != 0) {
    trace_event("End   command_BJ(ERROR_COMMAND)",5);
    return 0x7d1;
  }
  pcVar5 = sErrCode + 2;
  TextError(pcVar5,sLine);
  iVar3 = memcmp(pcVar5,"00",2);
  if (iVar3 != 0) {
    iVar3 = memcmp(pcVar5,"01",2);
    if (iVar3 != 0) {
      trace_event("End   command_BJ(CRYPTOGRAPHIC_ERROR)",5);
      return 2;
    }
    trace_event("End   command_BJ(VERIFICATION_FAILED)",5);
    return 1;
  }
  cVar1 = sBuffRcv[4];
  if (cVar1 == 'U') {
LAB_00467178:
    trace_event("Triple DES Encryption Double Length",4);
    *(undefined8 *)sBdkLmk = *(undefined8 *)(sBuffRcv + 4);
    *(undefined8 *)(sBdkLmk + 8) = *(undefined8 *)(sBuffRcv + 0xc);
    *(undefined8 *)(sBdkLmk + 0x10) = *(undefined8 *)(sBuffRcv + 0x14);
    *(undefined8 *)(sBdkLmk + 0x18) = *(undefined8 *)(sBuffRcv + 0x1c);
    cVar1 = sBuffRcv[0x24];
    sBdkLmk[0x21] = '\0';
    sBdkLmk[0x20] = cVar1;
  }
  else {
    if (cVar1 < 'V') {
      if (cVar1 == 'T') {
LAB_00467128:
        trace_event("Triple DES Encryption Triple Length",4);
        *(undefined8 *)sBdkLmk = *(undefined8 *)(sBuffRcv + 4);
        *(undefined8 *)(sBdkLmk + 8) = *(undefined8 *)(sBuffRcv + 0xc);
        *(undefined8 *)(sBdkLmk + 0x10) = *(undefined8 *)(sBuffRcv + 0x14);
        *(undefined8 *)(sBdkLmk + 0x18) = *(undefined8 *)(sBuffRcv + 0x1c);
        *(undefined8 *)(sBdkLmk + 0x20) = *(undefined8 *)(sBuffRcv + 0x24);
        uVar2 = *(undefined8 *)(sBuffRcv + 0x2c);
        sBdkLmk[0x30] = '\0';
        *(undefined8 *)(sBdkLmk + 0x28) = uVar2;
        goto LAB_004670be;
      }
    }
    else {
      if (cVar1 == 'X') goto LAB_00467178;
      if (cVar1 == 'Y') goto LAB_00467128;
    }
    trace_event("Single DES Encryption Single Length",4);
    *(undefined8 *)sBdkLmk = *(undefined8 *)(sBuffRcv + 4);
    uVar2 = *(undefined8 *)(sBuffRcv + 0xc);
    sBdkLmk[0x10] = '\0';
    *(undefined8 *)(sBdkLmk + 8) = uVar2;
  }
LAB_004670be:
  trace_event("End   command_BJ(OK)",5);
  return 0;
}



// WARNING: Unknown calling convention

int command_DY(char *sHsmBuffer,char *sZmk,char *sBdk)

{
  size_t sVar1;
  long lVar2;
  char *pcVar3;
  int iVar4;
  uint uVar5;
  char sLine [512];
  
  pcVar3 = sLine;
  for (lVar2 = 0x40; lVar2 != 0; lVar2 = lVar2 + -1) {
    *(undefined8 *)pcVar3 = 0;
    pcVar3 = (char *)((long)pcVar3 + 8);
  }
  trace_event("Start command_DY()",5);
  sHsmBuffer[0] = 'D';
  sHsmBuffer[1] = 'Y';
  sVar1 = strlen(sZmk);
  memcpy(sHsmBuffer + 2,sZmk,sVar1);
  sVar1 = strlen(sZmk);
  iVar4 = (int)sVar1 + 2;
  sVar1 = strlen(sBdk);
  memcpy(sHsmBuffer + iVar4,sBdk,sVar1);
  sVar1 = strlen(sBdk);
  uVar5 = iVar4 + (int)sVar1;
  sprintf(sLine,"End command_DY(%d)",(ulong)uVar5);
  trace_event(sLine,5);
  return uVar5;
}



// WARNING: Unknown calling convention

int command_DZ(char *buffer_received,char *sBdk_zmk,char *check_value,char *err_code)

{
  char cVar1;
  int iVar2;
  ulong uVar3;
  char *pcVar4;
  char *pcVar5;
  ulong uVar6;
  bool bVar7;
  byte bVar8;
  char Command [3];
  char sLine [512];
  
  bVar8 = 0;
  trace_event("Start command_DZ()",5);
  bVar7 = ((ulong)sBdk_zmk & 1) != 0;
  uVar6 = 0x30;
  iVar2 = 0x30;
  if (bVar7) {
    *sBdk_zmk = '\0';
    uVar6 = 0x2f;
    iVar2 = 0x2f;
    uVar3 = (ulong)(sBdk_zmk + 1) & 2;
    pcVar5 = sBdk_zmk + 1;
  }
  else {
    uVar3 = (ulong)sBdk_zmk & 2;
    pcVar5 = sBdk_zmk;
  }
  pcVar4 = pcVar5;
  if (uVar3 != 0) {
    pcVar4 = pcVar5 + 2;
    uVar6 = (ulong)(iVar2 - 2);
    pcVar5[0] = '\0';
    pcVar5[1] = '\0';
  }
  if (((ulong)pcVar4 & 4) != 0) {
    pcVar4[0] = '\0';
    pcVar4[1] = '\0';
    pcVar4[2] = '\0';
    pcVar4[3] = '\0';
    uVar6 = (ulong)((int)uVar6 - 4);
    pcVar4 = pcVar4 + 4;
  }
  for (uVar3 = uVar6 >> 3; uVar3 != 0; uVar3 = uVar3 - 1) {
    pcVar4[0] = '\0';
    pcVar4[1] = '\0';
    pcVar4[2] = '\0';
    pcVar4[3] = '\0';
    pcVar4[4] = '\0';
    pcVar4[5] = '\0';
    pcVar4[6] = '\0';
    pcVar4[7] = '\0';
    pcVar4 = pcVar4 + (ulong)bVar8 * -0x10 + 8;
  }
  if ((uVar6 & 4) != 0) {
    pcVar4[0] = '\0';
    pcVar4[1] = '\0';
    pcVar4[2] = '\0';
    pcVar4[3] = '\0';
    pcVar4 = pcVar4 + 4;
  }
  pcVar5 = pcVar4;
  if ((uVar6 & 2) != 0) {
    pcVar5 = pcVar4 + 2;
    pcVar4[0] = '\0';
    pcVar4[1] = '\0';
  }
  if (bVar7) {
    *pcVar5 = '\0';
  }
  check_value[0] = '\0';
  check_value[1] = '\0';
  check_value[2] = '\0';
  check_value[3] = '\0';
  check_value[4] = '\0';
  check_value[5] = '\0';
  check_value[6] = '\0';
  check_value[7] = '\0';
  check_value[8] = '\0';
  check_value[9] = '\0';
  check_value[10] = '\0';
  check_value[0xb] = '\0';
  check_value[0xc] = '\0';
  check_value[0xd] = '\0';
  check_value[0xe] = '\0';
  check_value[0xf] = '\0';
  Command._0_2_ = *(undefined2 *)buffer_received;
  Command[2] = '\0';
  *(undefined4 *)err_code = *(undefined4 *)buffer_received;
  iVar2 = memcmp(Command,&DAT_004cce21,2);
  if (iVar2 != 0) {
    trace_event("End   command_DY(ERROR_COMMAND)",5);
    return 0x7d1;
  }
  pcVar5 = err_code + 2;
  TextError(pcVar5,sLine);
  iVar2 = memcmp(pcVar5,"01",2);
  if (iVar2 == 0) {
    trace_event("WARNING !! : ODD PARITY ENFORCED",5);
  }
  else {
    iVar2 = memcmp(pcVar5,"00",2);
    if (iVar2 != 0) {
      trace_event("End   command_DZ(CHECK_ERROR)",5);
      return 0x7d2;
    }
  }
  cVar1 = buffer_received[4];
  if (cVar1 == 'U') {
LAB_00467550:
    trace_event("Triple DES Encryption Double Length",4);
    *(undefined8 *)sBdk_zmk = *(undefined8 *)(buffer_received + 4);
    *(undefined8 *)(sBdk_zmk + 8) = *(undefined8 *)(buffer_received + 0xc);
    *(undefined8 *)(sBdk_zmk + 0x10) = *(undefined8 *)(buffer_received + 0x14);
    *(undefined8 *)(sBdk_zmk + 0x18) = *(undefined8 *)(buffer_received + 0x1c);
    sBdk_zmk[0x20] = buffer_received[0x24];
    *(undefined8 *)check_value = *(undefined8 *)(buffer_received + 0x25);
    *(undefined8 *)(check_value + 8) = *(undefined8 *)(buffer_received + 0x2d);
    sBdk_zmk[0x21] = '\0';
  }
  else {
    if (cVar1 < 'V') {
      if (cVar1 == 'T') {
LAB_00467488:
        trace_event("Triple DES Encryption Triple Length",4);
        *(undefined8 *)sBdk_zmk = *(undefined8 *)(buffer_received + 4);
        *(undefined8 *)(sBdk_zmk + 8) = *(undefined8 *)(buffer_received + 0xc);
        *(undefined8 *)(sBdk_zmk + 0x10) = *(undefined8 *)(buffer_received + 0x14);
        *(undefined8 *)(sBdk_zmk + 0x18) = *(undefined8 *)(buffer_received + 0x1c);
        *(undefined8 *)(sBdk_zmk + 0x20) = *(undefined8 *)(buffer_received + 0x24);
        *(undefined8 *)(sBdk_zmk + 0x28) = *(undefined8 *)(buffer_received + 0x2c);
        sBdk_zmk[0x30] = buffer_received[0x34];
        *(undefined8 *)check_value = *(undefined8 *)(buffer_received + 0x35);
        *(undefined8 *)(check_value + 8) = *(undefined8 *)(buffer_received + 0x3d);
        sBdk_zmk[0x31] = '\0';
        goto LAB_0046743d;
      }
    }
    else {
      if (cVar1 == 'X') goto LAB_00467550;
      if (cVar1 == 'Y') goto LAB_00467488;
    }
    trace_event("Single DES Encryption Single Length",4);
    *(undefined8 *)sBdk_zmk = *(undefined8 *)(buffer_received + 4);
    *(undefined8 *)(sBdk_zmk + 8) = *(undefined8 *)(buffer_received + 0xc);
    *(undefined8 *)check_value = *(undefined8 *)(buffer_received + 0x14);
    *(undefined8 *)(check_value + 8) = *(undefined8 *)(buffer_received + 0x1c);
    sBdk_zmk[0x10] = '\0';
  }
LAB_0046743d:
  trace_event("End   command_DZ(OK)",5);
  return 0;
}



// WARNING: Unknown calling convention

int command_CM(char *buffer_transmit,char *bdk_key,char *pvka_key,char *pvkb_key,char *ksn_desc,
              char *ksn,char *pin_block,char *pan,char *pvv)

{
  char cVar1;
  undefined4 uVar2;
  size_t sVar3;
  size_t sVar4;
  char *__dest;
  char *pcVar5;
  char pvki [2];
  
  trace_event("Start command_CM()",5);
  cVar1 = *pvv;
  buffer_transmit[0] = 'C';
  buffer_transmit[1] = 'M';
  sVar3 = strlen(bdk_key);
  memcpy(buffer_transmit + 2,bdk_key,sVar3);
  sVar3 = strlen(bdk_key);
  pcVar5 = buffer_transmit + 2 + sVar3;
  __dest = pcVar5 + 0x20;
  *(undefined8 *)pcVar5 = *(undefined8 *)pvka_key;
  *(undefined8 *)(pcVar5 + 8) = *(undefined8 *)(pvka_key + 8);
  *(undefined8 *)(pcVar5 + 0x10) = *(undefined8 *)pvkb_key;
  *(undefined8 *)(pcVar5 + 0x18) = *(undefined8 *)(pvkb_key + 8);
  sVar3 = strlen(ksn_desc);
  memcpy(__dest,ksn_desc,sVar3);
  sVar3 = strlen(ksn_desc);
  sVar4 = strlen(ksn);
  memcpy(__dest + sVar3,ksn,sVar4);
  sVar4 = strlen(ksn);
  pcVar5 = __dest + sVar3 + sVar4;
  *(undefined8 *)pcVar5 = *(undefined8 *)pin_block;
  *(undefined8 *)(pcVar5 + 8) = *(undefined8 *)(pin_block + 8);
  sVar3 = strlen(pan);
  *(undefined8 *)(pcVar5 + 0x10) = *(undefined8 *)(pan + (sVar3 - 0xd));
  uVar2 = *(undefined4 *)(pan + (sVar3 - 0xd) + 8);
  pcVar5[0x1c] = cVar1;
  *(undefined4 *)(pcVar5 + 0x18) = uVar2;
  *(undefined4 *)(pcVar5 + 0x1d) = *(undefined4 *)(pvv + 1);
  trace_event("End   command_CM()",5);
  return 0;
}



// WARNING: Unknown calling convention

int command_CN(char *buffer_received,char *err_code)

{
  int iVar1;
  char *err_code_00;
  char Command [3];
  char sLine [512];
  
  trace_event("Start command_CN()",5);
  Command._0_2_ = *(undefined2 *)buffer_received;
  Command[2] = '\0';
  *(undefined4 *)err_code = *(undefined4 *)buffer_received;
  iVar1 = memcmp(Command,&DAT_004cce90,2);
  if (iVar1 == 0) {
    err_code_00 = err_code + 2;
    TextError(err_code_00,sLine);
    iVar1 = memcmp(err_code_00,"00",2);
    if (iVar1 == 0) {
      trace_event("End   command_CN(OK)",5);
      iVar1 = 0;
    }
    else {
      iVar1 = memcmp(err_code_00,"01",2);
      if (iVar1 != 0) {
        trace_event("End   command_CN(CRYPTOGRAPHIC_ERROR)",5);
        return 2;
      }
      iVar1 = 1;
      trace_event("End   command_CN(VERIFICATION_FAILED)",5);
    }
  }
  else {
    iVar1 = 0x7d1;
    trace_event("End   command_CN(ERROR_COMMAND)",5);
  }
  return iVar1;
}



// WARNING: Unknown calling convention

int command_KS(char *sHsmBuffer,char sModeFlag,char cSchemeId,char *sDmk,char *sPanAndSeq,char *sAtc
              ,char *sUn,char *sData)

{
  char cVar1;
  int iVar2;
  size_t sVar3;
  uint uVar4;
  char sLine [512];
  
  trace_event("Start command_KS()",5);
  sHsmBuffer[0] = 'K';
  sHsmBuffer[1] = 'S';
  cVar1 = *(char *)(long)sModeFlag;
  sHsmBuffer[3] = cSchemeId;
  sHsmBuffer[2] = cVar1;
  sVar3 = strlen(sDmk);
  memcpy(sHsmBuffer + 4,sDmk,sVar3);
  sVar3 = strlen(sDmk);
  iVar2 = (int)sVar3;
  uVar4 = iVar2 + 0x14;
  *(undefined8 *)(sHsmBuffer + (iVar2 + 4)) = *(undefined8 *)sPanAndSeq;
  *(undefined8 *)(sHsmBuffer + (iVar2 + 0xc)) = *(undefined8 *)sData;
  if (sModeFlag == '\x01') {
    *(undefined2 *)(sHsmBuffer + (int)uVar4) = *(undefined2 *)sAtc;
    uVar4 = iVar2 + 0x1a;
    *(undefined4 *)(sHsmBuffer + (iVar2 + 0x16)) = *(undefined4 *)sUn;
  }
  sprintf(sLine,"End command_KS(%d)",(ulong)uVar4);
  trace_event(sLine,5);
  return uVar4;
}



// WARNING: Unknown calling convention

int command_KT(char *sBuffRcv,char *sErrCode,char *sData)

{
  int iVar1;
  char *err_code;
  char Command [3];
  char sLine [512];
  
  trace_event("Start command_KT()",5);
  Command._0_2_ = *(undefined2 *)sBuffRcv;
  Command[2] = '\0';
  *(undefined4 *)sErrCode = *(undefined4 *)sBuffRcv;
  iVar1 = memcmp(Command,&DAT_004ccee1,2);
  if (iVar1 == 0) {
    err_code = sErrCode + 2;
    TextError(err_code,sLine);
    iVar1 = memcmp(err_code,"01",2);
    if (iVar1 == 0) {
      iVar1 = 1;
      *(undefined8 *)sData = *(undefined8 *)(sBuffRcv + 4);
      trace_event("End   command_KT(VERIFICATION_FAILED)",5);
    }
    else {
      iVar1 = memcmp(err_code,"00",2);
      if (iVar1 != 0) {
        trace_event("End   command_KT(CRYPTOGRAPHIC_ERROR)",5);
        return 2;
      }
      trace_event("End   command_KT(OK)",5);
      iVar1 = 0;
    }
  }
  else {
    iVar1 = 0x7d1;
    trace_event("End   command_KT(ERROR_COMMAND)",5);
  }
  return iVar1;
}



// WARNING: Unknown calling convention

int command_KY_MAC(char *sHsmBuffer,char cModeFlag,char cSchemeId,char *sSMI,char *sVISMI,
                  char *sPanAndSeq,char *sATC,char *sARQC,int nPlainTextLen,char *sPlainTextData)

{
  size_t sVar1;
  int iVar2;
  uint uVar3;
  int iVar4;
  char sLine [512];
  
  trace_event("Start command_KY_MAC()",5);
  sHsmBuffer[2] = cModeFlag;
  sHsmBuffer[0] = 'K';
  sHsmBuffer[1] = 'Y';
  if (cModeFlag == '0') {
    sVar1 = strlen(sSMI);
    memcpy(sHsmBuffer + 3,sSMI,sVar1);
    sVar1 = strlen(sSMI);
    iVar4 = (int)sVar1 + 3;
    sVar1 = strlen(sVISMI);
    memcpy(sHsmBuffer + iVar4,sVISMI,sVar1);
    sVar1 = strlen(sVISMI);
    iVar4 = iVar4 + (int)sVar1;
    *(undefined8 *)(sHsmBuffer + iVar4) = *(undefined8 *)sPanAndSeq;
    trace_event("SCHEMA ID = 0, BOTH ATC AND ARQC ARE USED ",0);
    sHsmBuffer[iVar4 + 8] = '1';
    *(undefined2 *)(sHsmBuffer + (iVar4 + 9)) = *(undefined2 *)sATC;
    sVar1 = strlen(sARQC);
    memcpy(sHsmBuffer + (iVar4 + 0xb),sARQC,sVar1);
    sVar1 = strlen(sARQC);
    iVar4 = iVar4 + 0xb + (int)sVar1;
  }
  else {
    trace_event("cModeFlag != 0 ; SCHEMA ID will be used",0);
    sHsmBuffer[3] = cSchemeId;
    sVar1 = strlen(sSMI);
    memcpy(sHsmBuffer + 4,sSMI,sVar1);
    sVar1 = strlen(sSMI);
    iVar4 = (int)sVar1 + 0xc;
    *(undefined8 *)(sHsmBuffer + ((int)sVar1 + 4)) = *(undefined8 *)sPanAndSeq;
  }
  sprintf(sHsmBuffer + iVar4,"%04X",(ulong)(uint)nPlainTextLen);
  sVar1 = strlen(sPlainTextData);
  sprintf(sLine,"LEN sPlainTextData =[%s] COMPARE(%d,%d)",sPlainTextData,sVar1,
          (ulong)(uint)nPlainTextLen);
  trace_event(sLine,5);
  iVar2 = nPlainTextLen + iVar4 + 4;
  memcpy(sHsmBuffer + (iVar4 + 4),sPlainTextData,(long)nPlainTextLen);
  sHsmBuffer[iVar2] = ';';
  sprintf(sLine,"sHsmBuffer (%s)",sHsmBuffer);
  trace_event(sLine,5);
  uVar3 = iVar2 + 1;
  sprintf(sLine,"End command_KY(%d)",(ulong)uVar3);
  trace_event(sLine,5);
  return uVar3;
}



// WARNING: Unknown calling convention

int command_PM(char *sHsmBuffer,char cSchemeId,char cVersion,char *sMkcvc3,char *sPan,
              char *sPanSeqNo,char *sExpiryDate,char *sServiceCode,char *sAtc,char *sDcvv,
              char *sIvcvc3,int nDataLen,char *sData,char *sUn,char *sCvc3)

{
  size_t sVar1;
  long lVar2;
  ulong uVar3;
  uint uVar4;
  char *pcVar5;
  int iVar6;
  ulong uVar7;
  char sLine [512];
  
  trace_event("Start command_PM()",5);
  sHsmBuffer[0] = 'P';
  sHsmBuffer[1] = 'M';
  sprintf(sHsmBuffer + 2,"%c",(ulong)(uint)(int)cSchemeId);
  sprintf(sHsmBuffer + 3,"%c",(ulong)(uint)(int)cVersion);
  sVar1 = strlen(sMkcvc3);
  memcpy(sHsmBuffer + 4,sMkcvc3,sVar1);
  sVar1 = strlen(sMkcvc3);
  iVar6 = (int)sVar1 + 5;
  sHsmBuffer[(int)sVar1 + 4] = 'A';
  sVar1 = strlen(sPan);
  memcpy(sHsmBuffer + iVar6,sPan,sVar1);
  sVar1 = strlen(sPan);
  iVar6 = iVar6 + (int)sVar1;
  uVar4 = iVar6 + 1;
  sHsmBuffer[iVar6] = ';';
  if (cSchemeId == '0') {
    *(undefined4 *)(sHsmBuffer + (int)uVar4) = *(undefined4 *)sExpiryDate;
    uVar4 = iVar6 + 0x11;
    *(undefined2 *)(sHsmBuffer + (iVar6 + 5)) = *(undefined2 *)sServiceCode;
    (sHsmBuffer + (iVar6 + 5))[2] = sServiceCode[2];
    *(undefined4 *)(sHsmBuffer + (iVar6 + 8)) = *(undefined4 *)sAtc;
    *(undefined2 *)(sHsmBuffer + (iVar6 + 8) + 4) = *(undefined2 *)(sAtc + 4);
    *(undefined2 *)(sHsmBuffer + (iVar6 + 0xe)) = *(undefined2 *)sDcvv;
    (sHsmBuffer + (iVar6 + 0xe))[2] = sDcvv[2];
  }
  else if (cSchemeId == '1') {
    if ((byte)(cVersion - 0x31U) < 2) {
      if (sPanSeqNo == (char *)0x0) {
        pcVar5 = "sPanSeqNo null HsmBuffer+52(%s) ";
        (sHsmBuffer + (int)uVar4)[0] = '0';
        (sHsmBuffer + (int)uVar4)[1] = '0';
      }
      else {
        pcVar5 = "sPanSeqNo not null HsmBuffer+52(%s) ";
        *(undefined2 *)(sHsmBuffer + (int)uVar4) = *(undefined2 *)(sPanSeqNo + 1);
      }
      uVar4 = iVar6 + 3;
      sprintf(sLine,pcVar5,sHsmBuffer + 0x34);
      trace_event(sLine,5);
    }
    if ((byte)(cVersion - 0x30U) < 2) {
      lVar2 = (long)(int)uVar4;
      uVar4 = uVar4 + 5;
      *(undefined4 *)(sHsmBuffer + lVar2) = *(undefined4 *)sIvcvc3;
      (sHsmBuffer + lVar2)[4] = sIvcvc3[4];
    }
    else if (cVersion == '2') {
      sprintf(sHsmBuffer + (int)uVar4,"%03d",(ulong)(uint)nDataLen);
      memcpy(sHsmBuffer + (int)(uVar4 + 3),sData,(long)nDataLen);
      iVar6 = uVar4 + 3 + nDataLen;
      *(undefined8 *)(sHsmBuffer + iVar6) = *(undefined8 *)sUn;
      *(undefined4 *)(sHsmBuffer + (iVar6 + 8)) = *(undefined4 *)sAtc;
      (sHsmBuffer + (iVar6 + 8))[4] = sAtc[4];
      uVar4 = iVar6 + 0x12;
      *(undefined4 *)(sHsmBuffer + (iVar6 + 0xd)) = *(undefined4 *)sCvc3;
      (sHsmBuffer + (iVar6 + 0xd))[4] = sCvc3[4];
    }
  }
  uVar7 = 0;
  if (0 < (int)uVar4) {
    do {
      pcVar5 = sHsmBuffer + uVar7;
      uVar3 = uVar7 & 0xffffffff;
      uVar7 = uVar7 + 1;
      sprintf(sLine,"|%02d|%02X|",uVar3,(ulong)(uint)(int)*pcVar5);
      trace_event(sLine,5);
    } while ((int)uVar7 < (int)uVar4);
  }
  sprintf(sLine,"End command_PM(%d), HsmBuffer (%s) ",(ulong)uVar4,sHsmBuffer);
  trace_event(sLine,5);
  return uVar4;
}



// WARNING: Unknown calling convention

int command_PN(char *sBuffRcv,char *sErrCode)

{
  int iVar1;
  char *err_code;
  char Command [3];
  char sLine [512];
  
  trace_event("Start command_PN()",5);
  Command._0_2_ = *(undefined2 *)sBuffRcv;
  Command[2] = '\0';
  *(undefined4 *)sErrCode = *(undefined4 *)sBuffRcv;
  iVar1 = memcmp(Command,&DAT_004d8f6a,2);
  if (iVar1 == 0) {
    err_code = sErrCode + 2;
    TextError(err_code,sLine);
    iVar1 = memcmp(err_code,"00",2);
    if (iVar1 == 0) {
      trace_event("End   command_PN(OK)",5);
      iVar1 = 0;
    }
    else {
      iVar1 = memcmp(err_code,"01",2);
      if (iVar1 != 0) {
        trace_event("End   command_PN(CRYPTOGRAPHIC_ERROR)",5);
        return 2;
      }
      iVar1 = 1;
      trace_event("End   command_PN(VERIFICATION_FAILED)",5);
    }
  }
  else {
    iVar1 = 0x7d1;
    trace_event("End   command_PN(ERROR_COMMAND)",5);
  }
  return iVar1;
}



// WARNING: Unknown calling convention

int command_JS(char *sHsmBuffer,char *sDmk,char *sPanAndSeq,char *sAtc,int nDataLen,char *sData,
              char *sArqc,char *sArc)

{
  int iVar1;
  size_t sVar2;
  int iVar3;
  long lVar4;
  uint uVar5;
  int iVar6;
  char *pcVar7;
  byte bVar8;
  char sLine [512];
  
  bVar8 = 0;
  trace_event("Start command_JS()",5);
  pcVar7 = sLine;
  for (lVar4 = 0x40; lVar4 != 0; lVar4 = lVar4 + -1) {
    pcVar7[0] = '\0';
    pcVar7[1] = '\0';
    pcVar7[2] = '\0';
    pcVar7[3] = '\0';
    pcVar7[4] = '\0';
    pcVar7[5] = '\0';
    pcVar7[6] = '\0';
    pcVar7[7] = '\0';
    pcVar7 = pcVar7 + (ulong)bVar8 * -0x10 + 8;
  }
  sHsmBuffer[0] = 'J';
  sHsmBuffer[1] = 'S';
  sHsmBuffer[3] = '1';
  sHsmBuffer[2] = (nDataLen < 1) + '1';
  sVar2 = strlen(sDmk);
  memcpy(sHsmBuffer + 4,sDmk,sVar2);
  sVar2 = strlen(sDmk);
  iVar1 = (int)sVar2;
  iVar3 = iVar1 + 0xf;
  *(undefined8 *)(sHsmBuffer + (iVar1 + 4)) = *(undefined8 *)sPanAndSeq;
  *(undefined2 *)(sHsmBuffer + (iVar1 + 0xc)) = *(undefined2 *)sAtc;
  sHsmBuffer[iVar1 + 0xe] = '0';
  if ((byte)(sHsmBuffer[2] - 0x30U) < 2) {
    sprintf(sHsmBuffer + iVar3,"%02X",(ulong)(uint)nDataLen);
    iVar6 = iVar1 + 0x11 + nDataLen;
    memcpy(sHsmBuffer + (iVar1 + 0x11),sData,(long)nDataLen);
    iVar3 = iVar6 + 1;
    sHsmBuffer[iVar6] = ';';
  }
  uVar5 = iVar3 + 8;
  *(undefined8 *)(sHsmBuffer + iVar3) = *(undefined8 *)sArqc;
  if ((byte)(sHsmBuffer[2] - 0x31U) < 2) {
    *(undefined2 *)(sHsmBuffer + (int)uVar5) = *(undefined2 *)sArc;
    uVar5 = iVar3 + 10;
  }
  sprintf(sLine,"End command_JS(%d)",(ulong)uVar5);
  trace_event(sLine,5);
  return uVar5;
}



// WARNING: Unknown calling convention

int command_JT(char *sBuffRcv,char *sErrCode,char *sArpc)

{
  char *err_code;
  int iVar1;
  char Command [3];
  char sLine [512];
  
  trace_event("Start command_JT()",5);
  Command._0_2_ = *(undefined2 *)sBuffRcv;
  Command[2] = '\0';
  *(undefined4 *)sErrCode = *(undefined4 *)sBuffRcv;
  iVar1 = memcmp(Command,&DAT_004ccf90,2);
  if (iVar1 == 0) {
    err_code = sErrCode + 2;
    TextError(err_code,sLine);
    iVar1 = memcmp(err_code,"00",2);
    if (iVar1 == 0) {
      *(undefined8 *)sArpc = *(undefined8 *)(sBuffRcv + 4);
      trace_event("End   command_JT(OK)",5);
      iVar1 = 0;
    }
    else {
      iVar1 = memcmp(err_code,"01",2);
      if (iVar1 != 0) {
        trace_event("End   command_JT(CRYPTOGRAPHIC_ERROR)",5);
        return 2;
      }
      iVar1 = 1;
      *(undefined8 *)sArpc = *(undefined8 *)(sBuffRcv + 4);
      trace_event("End   command_JT(VERIFICATION_FAILED)",5);
    }
  }
  else {
    iVar1 = 0x7d1;
    trace_event("End   command_JT(ERROR_COMMAND)",5);
  }
  return iVar1;
}



// WARNING: Unknown calling convention

int command_A0(char *buffer_transmit,char mode,char *keyType,char *KeyUsage,char *Algorithm,
              char *ModeOfUse,char *KeyVersionNumber,char *Exportability,char *lmk_id,char zmk_flag,
              char *zmkLmk,char keyLen)

{
  undefined2 uVar1;
  size_t sVar2;
  char *pcVar3;
  
  trace_event("Start command_A0()",5);
  buffer_transmit[2] = mode;
  buffer_transmit[0] = 'A';
  buffer_transmit[1] = '0';
  *(undefined2 *)(buffer_transmit + 3) = *(undefined2 *)keyType;
  buffer_transmit[5] = keyType[2];
  if ((((*keyType == 'F') && (keyType[1] == 'F')) && (keyType[2] == 'F')) && (keyType[3] == '\0')) {
    buffer_transmit[6] = 'S';
    sVar2 = strlen(zmkLmk);
    memcpy(buffer_transmit + 7,zmkLmk,sVar2);
    sVar2 = strlen(zmkLmk);
    pcVar3 = buffer_transmit + 7 + sVar2;
    *pcVar3 = 'X';
    pcVar3[1] = '%';
    uVar1 = *(undefined2 *)lmk_id;
    pcVar3[4] = '#';
    *(undefined2 *)(pcVar3 + 2) = uVar1;
    *(undefined2 *)(pcVar3 + 5) = *(undefined2 *)KeyUsage;
    *(undefined2 *)(pcVar3 + 7) = *(undefined2 *)Algorithm;
    pcVar3[9] = *ModeOfUse;
    *(undefined2 *)(pcVar3 + 10) = *(undefined2 *)KeyVersionNumber;
    pcVar3[0xc] = *Exportability;
    pcVar3[0xd] = '0';
    pcVar3[0xe] = '0';
  }
  else {
    buffer_transmit[6] = 'U';
    if (keyLen == 'S') {
      buffer_transmit[6] = 'Z';
      buffer_transmit[7] = ';';
      buffer_transmit[8] = zmk_flag;
      sVar2 = strlen(zmkLmk);
      memcpy(buffer_transmit + 9,zmkLmk,sVar2);
      sVar2 = strlen(zmkLmk);
      (buffer_transmit + 9)[sVar2] = 'Z';
    }
    else {
      buffer_transmit[7] = ';';
      buffer_transmit[8] = zmk_flag;
      sVar2 = strlen(zmkLmk);
      memcpy(buffer_transmit + 9,zmkLmk,sVar2);
      sVar2 = strlen(zmkLmk);
      (buffer_transmit + 9)[sVar2] = 'X';
    }
  }
  trace_event("End   command_A0(OK)",5);
  return 0;
}



// WARNING: Unknown calling convention

int command_M6(uchar *buffer_transmit,uchar mode,uchar format,uchar *algorithm,uchar padMethod,
              uchar *keyTpe,int data_len,uchar *takzak_lmk,uchar *data,char *interValue)

{
  undefined2 uVar1;
  size_t sVar2;
  int iVar3;
  
  trace_event("Start command_M6()",5);
  buffer_transmit[2] = mode;
  buffer_transmit[0] = 'M';
  buffer_transmit[1] = '6';
  buffer_transmit[3] = format;
  uVar1 = *(undefined2 *)algorithm;
  buffer_transmit[6] = padMethod;
  *(undefined2 *)(buffer_transmit + 4) = uVar1;
  if (*takzak_lmk == 'S') {
    buffer_transmit[9] = 'F';
    buffer_transmit[7] = 'F';
    buffer_transmit[8] = 'F';
  }
  else {
    *(undefined2 *)(buffer_transmit + 7) = *(undefined2 *)keyTpe;
    buffer_transmit[9] = keyTpe[2];
  }
  sVar2 = strlen((char *)takzak_lmk);
  memcpy(buffer_transmit + 10,takzak_lmk,sVar2);
  sVar2 = strlen((char *)takzak_lmk);
  iVar3 = (int)sVar2 + 10;
  if (1 < (byte)(mode - 0x30)) {
    *(undefined8 *)(buffer_transmit + iVar3) = *(undefined8 *)interValue;
    *(undefined8 *)(buffer_transmit + iVar3 + 8) = *(undefined8 *)(interValue + 8);
    iVar3 = (int)sVar2 + 0x1a;
  }
  sprintf((char *)(buffer_transmit + iVar3),"%04X",(ulong)(uint)data_len);
  memcpy(buffer_transmit + (iVar3 + 4),data,(long)data_len);
  trace_event("End command_M6()",5);
  return iVar3 + 4 + data_len;
}



// WARNING: Unknown calling convention

int command_M7(char *buffer_received,char *err_code,char *macData,char mode,char *interValue)

{
  int iVar1;
  int iVar2;
  char *pcVar3;
  long lVar4;
  long lVar5;
  
  iVar2 = 0x7d1;
  trace_event("Start command_M7()",5);
  *(undefined2 *)err_code = *(undefined2 *)(buffer_received + 2);
  iVar1 = memcmp(buffer_received,&DAT_004cd007,2);
  if (iVar1 == 0) {
    iVar2 = memcmp(err_code,"00",2);
    if (iVar2 == 0) {
      lVar4 = 4;
      lVar5 = 8;
      if ((byte)(mode - 0x31U) < 2) {
        lVar5 = 0x18;
        lVar4 = 0x14;
        *(undefined8 *)interValue = *(undefined8 *)(buffer_received + 4);
        *(undefined8 *)(interValue + 8) = *(undefined8 *)(buffer_received + 0xc);
      }
      iVar2 = memcmp(buffer_received + lVar4,&DAT_004cd00a,4);
      pcVar3 = buffer_received + lVar5;
      if (iVar2 != 0) {
        pcVar3 = buffer_received + lVar4;
      }
      *(undefined8 *)macData = *(undefined8 *)pcVar3;
      trace_event("End command_M7()",5);
      iVar2 = 0;
    }
    else {
      iVar2 = 2;
    }
  }
  return iVar2;
}



// WARNING: Unknown calling convention

int command_M8(uchar *buffer_transmit,uchar mode,uchar format,uchar *algorithm,uchar padMethod,
              uchar *keyTpe,int data_len,uchar *takzak_lmk,uchar *mac,uchar *data,uchar *interValue)

{
  undefined2 uVar1;
  size_t sVar2;
  int iVar3;
  int iVar4;
  
  trace_event("Start command_M8()",5);
  buffer_transmit[2] = mode;
  buffer_transmit[0] = 'M';
  buffer_transmit[1] = '8';
  buffer_transmit[3] = format;
  uVar1 = *(undefined2 *)algorithm;
  buffer_transmit[6] = padMethod;
  *(undefined2 *)(buffer_transmit + 4) = uVar1;
  if (*takzak_lmk == 'S') {
    buffer_transmit[9] = 'F';
    buffer_transmit[7] = 'F';
    buffer_transmit[8] = 'F';
  }
  else {
    *(undefined2 *)(buffer_transmit + 7) = *(undefined2 *)keyTpe;
    buffer_transmit[9] = keyTpe[2];
  }
  sVar2 = strlen((char *)takzak_lmk);
  memcpy(buffer_transmit + 10,takzak_lmk,sVar2);
  sVar2 = strlen((char *)takzak_lmk);
  iVar3 = (int)sVar2 + 10;
  if (1 < (byte)(mode - 0x30)) {
    *(undefined8 *)(buffer_transmit + iVar3) = *(undefined8 *)interValue;
    *(undefined8 *)(buffer_transmit + iVar3 + 8) = *(undefined8 *)(interValue + 8);
    iVar3 = (int)sVar2 + 0x1a;
  }
  sprintf((char *)(buffer_transmit + iVar3),"%04X",(ulong)(uint)data_len);
  iVar4 = iVar3 + 4 + data_len;
  memcpy(buffer_transmit + (iVar3 + 4),data,(long)data_len);
  *(undefined8 *)(buffer_transmit + iVar4) = *(undefined8 *)mac;
  trace_event("End command_M8()",5);
  return iVar4 + 8;
}



// WARNING: Unknown calling convention

int command_M9(char *buffer_received,char *err_code,char mode,char *interValue)

{
  int iVar1;
  
  trace_event("Start command_M9()",5);
  *(undefined2 *)err_code = *(undefined2 *)(buffer_received + 2);
  iVar1 = memcmp(buffer_received,&DAT_004cd057,2);
  if (iVar1 != 0) {
    return 0x7d1;
  }
  iVar1 = memcmp(err_code,"00",2);
  if (iVar1 != 0) {
    return 2;
  }
  if ((byte)(mode - 0x31U) < 2) {
    *(undefined8 *)interValue = *(undefined8 *)(buffer_received + 4);
    *(undefined8 *)(interValue + 8) = *(undefined8 *)(buffer_received + 0xc);
  }
  trace_event("End command_M9()",5);
  return 0;
}



// WARNING: Unknown calling convention

int command_A1(char *buffer_received,char mode,char *keyLmk,char *keyZmk,char *check_value)

{
  char cVar1;
  undefined2 uVar2;
  undefined8 uVar3;
  int iVar4;
  long lVar5;
  char *pcVar6;
  char *pcVar7;
  size_t __n;
  char sKeyLenStr [32];
  char sLine [512];
  
  trace_event("Start command_A1()",5);
  iVar4 = memcmp(buffer_received,&DAT_004d685d,2);
  if (iVar4 == 0) {
    TextError(buffer_received + 2,sLine);
    iVar4 = memcmp(buffer_received + 2,"00",2);
    if (iVar4 == 0) {
      switch(buffer_received[4]) {
      case 'S':
        trace_event("Keyblock Encryption Length",4);
        sKeyLenStr._0_4_ = *(undefined4 *)(buffer_received + 6);
        lVar5 = strtol(sKeyLenStr,(char **)0x0,10);
        __n = (size_t)((int)lVar5 + 1);
        memcpy(keyLmk,buffer_received + 4,__n);
        keyLmk[__n] = '\0';
        pcVar6 = buffer_received + 4 + __n;
        pcVar7 = pcVar6;
        if (mode == '1') {
          pcVar7 = pcVar6 + 0x21;
          *(undefined8 *)keyZmk = *(undefined8 *)pcVar6;
          *(undefined8 *)(keyZmk + 8) = *(undefined8 *)(pcVar6 + 8);
          *(undefined8 *)(keyZmk + 0x10) = *(undefined8 *)(pcVar6 + 0x10);
          *(undefined8 *)(keyZmk + 0x18) = *(undefined8 *)(pcVar6 + 0x18);
          cVar1 = pcVar6[0x20];
          keyZmk[0x21] = '\0';
          keyZmk[0x20] = cVar1;
        }
        break;
      case 'T':
      case 'Y':
        trace_event("Triple DES Encryption Triple Length",4);
        *(undefined8 *)keyLmk = *(undefined8 *)(buffer_received + 4);
        *(undefined8 *)(keyLmk + 8) = *(undefined8 *)(buffer_received + 0xc);
        *(undefined8 *)(keyLmk + 0x10) = *(undefined8 *)(buffer_received + 0x14);
        *(undefined8 *)(keyLmk + 0x18) = *(undefined8 *)(buffer_received + 0x1c);
        *(undefined8 *)(keyLmk + 0x20) = *(undefined8 *)(buffer_received + 0x24);
        *(undefined8 *)(keyLmk + 0x28) = *(undefined8 *)(buffer_received + 0x2c);
        cVar1 = buffer_received[0x34];
        keyLmk[0x31] = '\0';
        keyLmk[0x30] = cVar1;
        pcVar7 = buffer_received + 0x35;
        if (mode == '1') {
          *(undefined8 *)keyZmk = *(undefined8 *)(buffer_received + 0x35);
          *(undefined8 *)(keyZmk + 8) = *(undefined8 *)(buffer_received + 0x3d);
          *(undefined8 *)(keyZmk + 0x10) = *(undefined8 *)(buffer_received + 0x45);
          *(undefined8 *)(keyZmk + 0x18) = *(undefined8 *)(buffer_received + 0x4d);
          *(undefined8 *)(keyZmk + 0x20) = *(undefined8 *)(buffer_received + 0x55);
          *(undefined8 *)(keyZmk + 0x28) = *(undefined8 *)(buffer_received + 0x5d);
          cVar1 = buffer_received[0x65];
          keyZmk[0x31] = '\0';
          keyZmk[0x30] = cVar1;
          pcVar7 = buffer_received + 0x66;
        }
        break;
      case 'U':
      case 'X':
        *(undefined8 *)keyLmk = *(undefined8 *)(buffer_received + 4);
        *(undefined8 *)(keyLmk + 8) = *(undefined8 *)(buffer_received + 0xc);
        *(undefined8 *)(keyLmk + 0x10) = *(undefined8 *)(buffer_received + 0x14);
        *(undefined8 *)(keyLmk + 0x18) = *(undefined8 *)(buffer_received + 0x1c);
        cVar1 = buffer_received[0x24];
        keyLmk[0x21] = '\0';
        keyLmk[0x20] = cVar1;
        pcVar7 = buffer_received + 0x25;
        if (mode == '1') {
          *(undefined8 *)keyZmk = *(undefined8 *)(buffer_received + 0x25);
          *(undefined8 *)(keyZmk + 8) = *(undefined8 *)(buffer_received + 0x2d);
          *(undefined8 *)(keyZmk + 0x10) = *(undefined8 *)(buffer_received + 0x35);
          *(undefined8 *)(keyZmk + 0x18) = *(undefined8 *)(buffer_received + 0x3d);
          cVar1 = buffer_received[0x45];
          keyZmk[0x21] = '\0';
          keyZmk[0x20] = cVar1;
          pcVar7 = buffer_received + 0x46;
        }
        break;
      default:
        trace_event("Single DES Encryption Single Length",4);
        *(undefined8 *)keyLmk = *(undefined8 *)(buffer_received + 4);
        uVar3 = *(undefined8 *)(buffer_received + 0xc);
        keyLmk[0x10] = '\0';
        *(undefined8 *)(keyLmk + 8) = uVar3;
        pcVar7 = buffer_received + 0x14;
        if (mode == '1') {
          *(undefined8 *)keyZmk = *(undefined8 *)(buffer_received + 0x14);
          uVar3 = *(undefined8 *)(buffer_received + 0x1c);
          keyZmk[0x10] = '\0';
          *(undefined8 *)(keyZmk + 8) = uVar3;
          pcVar7 = buffer_received + 0x24;
        }
      }
      *(undefined4 *)check_value = *(undefined4 *)pcVar7;
      uVar2 = *(undefined2 *)(pcVar7 + 4);
      check_value[6] = '\0';
      *(undefined2 *)(check_value + 4) = uVar2;
      trace_event("End   command_A1(OK)",5);
      iVar4 = 0;
    }
    else {
      iVar4 = 0x7d2;
      trace_event("End   command_A1(CHECK_ERROR)",5);
    }
  }
  else {
    iVar4 = 0x7d1;
    trace_event("End   command_A1(ERROR_COMMAND)",5);
  }
  return iVar4;
}



// WARNING: Unknown calling convention

int command_A6(char *buffer_transmit,char *keyType,char *zmkLmk,char *keyZmk,char *KeyUsage,
              char *ModeOfUse,char *KeyVersionNumber,char *Exportability,char *lmk_id,
              char *attala_var)

{
  bool bVar1;
  size_t sVar2;
  int iVar3;
  long lVar4;
  int iVar5;
  
  trace_event("Start command_A6()",5);
  buffer_transmit[0] = 'A';
  buffer_transmit[1] = '6';
  *(undefined2 *)(buffer_transmit + 2) = *(undefined2 *)keyType;
  buffer_transmit[4] = keyType[2];
  sVar2 = strlen(zmkLmk);
  memcpy(buffer_transmit + 5,zmkLmk,sVar2);
  sVar2 = strlen(zmkLmk);
  iVar3 = (int)sVar2;
  iVar5 = iVar3 + 5;
  sVar2 = strlen(keyZmk);
  if (sVar2 == 0x20) {
    buffer_transmit[iVar5] = 'X';
    iVar5 = iVar3 + 6;
    bVar1 = false;
    sVar2 = strlen(keyZmk);
  }
  else if (sVar2 < 0x22) {
    bVar1 = false;
  }
  else if (*keyZmk == 'R') {
    bVar1 = true;
  }
  else {
    buffer_transmit[iVar5] = 'R';
    iVar5 = iVar3 + 6;
    bVar1 = true;
    sVar2 = strlen(keyZmk);
  }
  memcpy(buffer_transmit + iVar5,keyZmk,sVar2);
  sVar2 = strlen(keyZmk);
  iVar5 = iVar5 + (int)sVar2;
  if ((((*keyType == 'F') && (keyType[1] == 'F')) && (keyType[2] == 'F')) && (keyType[3] == '\0')) {
    buffer_transmit[iVar5] = 'S';
  }
  else {
    buffer_transmit[iVar5] = 'U';
  }
  iVar5 = iVar5 + 1;
  if ((attala_var != (char *)0x0) && (*attala_var != '\0')) {
    sVar2 = strlen(attala_var);
    lVar4 = (long)iVar5;
    iVar3 = 2;
    if ((int)sVar2 < 3) {
      iVar3 = (int)sVar2;
    }
    iVar5 = iVar5 + iVar3;
    memcpy(buffer_transmit + lVar4,attala_var,(long)iVar3);
  }
  if (((*keyType == 'F') && (keyType[1] == 'F')) && ((keyType[2] == 'F' && (keyType[3] == '\0')))) {
    buffer_transmit[iVar5] = '%';
    *(undefined2 *)(buffer_transmit + (iVar5 + 1)) = *(undefined2 *)lmk_id;
    buffer_transmit[iVar5 + 3] = '#';
    *(undefined2 *)(buffer_transmit + (iVar5 + 4)) = *(undefined2 *)KeyUsage;
    iVar3 = iVar5 + 6;
    if (!bVar1) {
      buffer_transmit[iVar3] = *ModeOfUse;
      *(undefined2 *)(buffer_transmit + (iVar5 + 7)) = *(undefined2 *)KeyVersionNumber;
      buffer_transmit[iVar5 + 9] = *Exportability;
      iVar3 = iVar5 + 10;
    }
    (buffer_transmit + iVar3)[0] = '0';
    (buffer_transmit + iVar3)[1] = '0';
  }
  trace_event("End   command_A6(OK)",5);
  return 0;
}



// WARNING: Unknown calling convention

int command_A7(char *buffer_received,char *keyLmk,char *check_value)

{
  char cVar1;
  undefined2 uVar2;
  undefined8 uVar3;
  int iVar4;
  long lVar5;
  size_t __n;
  char *pcVar6;
  char sLine [512];
  
  trace_event("Start command_A7(SW)......",5);
  iVar4 = memcmp(buffer_received,&DAT_004cd10f,2);
  if (iVar4 == 0) {
    pcVar6 = buffer_received + 2;
    iVar4 = memcmp(pcVar6,"00",2);
    if ((iVar4 == 0) || (iVar4 = memcmp(pcVar6,"01",2), iVar4 == 0)) {
      switch(buffer_received[4]) {
      case 'S':
        trace_event("Keyblock Encryption Length",4);
        sLine._0_4_ = *(undefined4 *)(buffer_received + 6);
        lVar5 = strtol(sLine,(char **)0x0,10);
        __n = (size_t)((int)lVar5 + 1);
        memcpy(keyLmk,buffer_received + 4,__n);
        keyLmk[__n] = '\0';
        pcVar6 = buffer_received + 4 + __n;
        break;
      case 'T':
      case 'Y':
        pcVar6 = buffer_received + 0x35;
        trace_event("Triple DES Encryption Triple Length",4);
        *(undefined8 *)keyLmk = *(undefined8 *)(buffer_received + 4);
        *(undefined8 *)(keyLmk + 8) = *(undefined8 *)(buffer_received + 0xc);
        *(undefined8 *)(keyLmk + 0x10) = *(undefined8 *)(buffer_received + 0x14);
        *(undefined8 *)(keyLmk + 0x18) = *(undefined8 *)(buffer_received + 0x1c);
        *(undefined8 *)(keyLmk + 0x20) = *(undefined8 *)(buffer_received + 0x24);
        *(undefined8 *)(keyLmk + 0x28) = *(undefined8 *)(buffer_received + 0x2c);
        cVar1 = buffer_received[0x34];
        keyLmk[0x31] = '\0';
        keyLmk[0x30] = cVar1;
        break;
      case 'U':
      case 'X':
        pcVar6 = buffer_received + 0x25;
        *(undefined8 *)keyLmk = *(undefined8 *)(buffer_received + 4);
        *(undefined8 *)(keyLmk + 8) = *(undefined8 *)(buffer_received + 0xc);
        *(undefined8 *)(keyLmk + 0x10) = *(undefined8 *)(buffer_received + 0x14);
        *(undefined8 *)(keyLmk + 0x18) = *(undefined8 *)(buffer_received + 0x1c);
        cVar1 = buffer_received[0x24];
        keyLmk[0x21] = '\0';
        keyLmk[0x20] = cVar1;
        break;
      default:
        pcVar6 = buffer_received + 0x14;
        trace_event("Single DES Encryption Single Length",4);
        *(undefined8 *)keyLmk = *(undefined8 *)(buffer_received + 4);
        uVar3 = *(undefined8 *)(buffer_received + 0xc);
        keyLmk[0x10] = '\0';
        *(undefined8 *)(keyLmk + 8) = uVar3;
      }
      *(undefined4 *)check_value = *(undefined4 *)pcVar6;
      uVar2 = *(undefined2 *)(pcVar6 + 4);
      check_value[6] = '\0';
      *(undefined2 *)(check_value + 4) = uVar2;
      trace_event("End   command_A7(OK)",5);
      iVar4 = 0;
    }
    else {
      iVar4 = 0x7d2;
      TextError(pcVar6,sLine);
      trace_event("End   command_A7(CHECK_ERROR)",5);
    }
  }
  else {
    iVar4 = 0x7d1;
    trace_event("End   command_A7(ERROR_COMMAND)",5);
  }
  return iVar4;
}



// WARNING: Unknown calling convention

int command_BU(char *sHsmBuffer,char *KeyTypeCode,char cKeyLengthFlag,char *sKey,char *sKeyType)

{
  int iVar1;
  size_t sVar2;
  uint uVar3;
  char sLine [512];
  
  trace_event("Start command_BU()",5);
  sHsmBuffer[0] = 'B';
  sHsmBuffer[1] = 'U';
  if (*sKey == 'S') {
    sHsmBuffer[4] = 'F';
    sHsmBuffer[2] = 'F';
    sHsmBuffer[3] = 'F';
    sVar2 = strlen(sKey);
    memcpy(sHsmBuffer + 5,sKey,sVar2);
    sVar2 = strlen(sKey);
    uVar3 = (int)sVar2 + 9;
    builtin_strncpy(sHsmBuffer + ((int)sVar2 + 5),";FFF",4);
  }
  else {
    *(undefined2 *)(sHsmBuffer + 2) = *(undefined2 *)KeyTypeCode;
    sprintf(sHsmBuffer + 4,"%c",(ulong)(uint)(int)cKeyLengthFlag);
    sVar2 = strlen(sKey);
    memcpy(sHsmBuffer + 5,sKey,sVar2);
    sVar2 = strlen(sKey);
    iVar1 = (int)sVar2;
    uVar3 = iVar1 + 5;
    sVar2 = strlen(sKeyType);
    if (sVar2 == 3) {
      sHsmBuffer[(int)uVar3] = ';';
      uVar3 = iVar1 + 0xd;
      *(undefined2 *)(sHsmBuffer + (iVar1 + 6)) = *(undefined2 *)sKeyType;
      (sHsmBuffer + (iVar1 + 6))[2] = sKeyType[2];
      sHsmBuffer[iVar1 + 9] = ';';
      sHsmBuffer[iVar1 + 10] = '0';
      sHsmBuffer[iVar1 + 0xb] = '0';
      sHsmBuffer[iVar1 + 0xc] = '0';
    }
  }
  sprintf(sLine,"End command_BU(%d), HsmBuffer (%s) ",(ulong)uVar3,sHsmBuffer);
  trace_event(sLine,5);
  return uVar3;
}



// WARNING: Unknown calling convention

int command_BV(char *sBuffRcv,char *sKeyCheckValue)

{
  int iVar1;
  size_t sVar2;
  long lVar3;
  char *pcVar4;
  byte bVar5;
  char Command [3];
  char sErrCode [257];
  char sLine [512];
  
  bVar5 = 0;
  trace_event("Start command_BV()",5);
  pcVar4 = sErrCode;
  for (lVar3 = 0x20; lVar3 != 0; lVar3 = lVar3 + -1) {
    pcVar4[0] = '\0';
    pcVar4[1] = '\0';
    pcVar4[2] = '\0';
    pcVar4[3] = '\0';
    pcVar4[4] = '\0';
    pcVar4[5] = '\0';
    pcVar4[6] = '\0';
    pcVar4[7] = '\0';
    pcVar4 = pcVar4 + (ulong)bVar5 * -0x10 + 8;
  }
  Command[2] = '\0';
  *pcVar4 = '\0';
  pcVar4 = sLine;
  for (lVar3 = 0x40; lVar3 != 0; lVar3 = lVar3 + -1) {
    pcVar4[0] = '\0';
    pcVar4[1] = '\0';
    pcVar4[2] = '\0';
    pcVar4[3] = '\0';
    pcVar4[4] = '\0';
    pcVar4[5] = '\0';
    pcVar4[6] = '\0';
    pcVar4[7] = '\0';
    pcVar4 = pcVar4 + (ulong)bVar5 * -0x10 + 8;
  }
  Command._0_2_ = *(undefined2 *)sBuffRcv;
  sErrCode._0_4_ = *(undefined4 *)sBuffRcv;
  iVar1 = memcmp(Command,&DAT_004cd16b,2);
  if (iVar1 == 0) {
    TextError(sErrCode + 2,sLine);
    iVar1 = memcmp(sErrCode + 2,"00",2);
    if (iVar1 == 0) {
      sVar2 = strlen(sBuffRcv);
      if (sVar2 - 4 < 0x10) {
        memcpy(sKeyCheckValue,sBuffRcv + 4,sVar2 - 4);
      }
      else {
        *(undefined8 *)sKeyCheckValue = *(undefined8 *)(sBuffRcv + 4);
        *(undefined8 *)(sKeyCheckValue + 8) = *(undefined8 *)(sBuffRcv + 0xc);
      }
      trace_event("End   command_BV(OK)",5);
      return 0;
    }
    iVar1 = -1;
    trace_event("End   command_BV(NOK)",5);
  }
  else {
    iVar1 = 0x7d1;
    trace_event("End   command_BV(ERROR_COMMAND)",5);
  }
  return iVar1;
}



// WARNING: Unknown calling convention

int command_EY(char *buffer_transmit,char *hash_id,char *sig_id,char *pad_mode_id,char *pData,
              char *pSignature,char *pPublicKey)

{
  uint uVar1;
  uint uVar2;
  int iVar3;
  size_t sVar4;
  int iVar5;
  char *pcVar6;
  char sKeySizeStr [5];
  
  sKeySizeStr[0] = '\0';
  sKeySizeStr[1] = '\0';
  sKeySizeStr[2] = '\0';
  sKeySizeStr[3] = '\0';
  sKeySizeStr[4] = '\0';
  trace_event("Start command_EY()",5);
  buffer_transmit[0] = 'E';
  buffer_transmit[1] = 'Y';
  *(undefined2 *)(buffer_transmit + 2) = *(undefined2 *)hash_id;
  *(undefined2 *)(buffer_transmit + 4) = *(undefined2 *)sig_id;
  *(undefined2 *)(buffer_transmit + 6) = *(undefined2 *)pad_mode_id;
  sVar4 = strlen(pSignature);
  uVar1 = AsciiToHex((uchar *)pSignature,(uchar *)(buffer_transmit + 0xc),(int)sVar4);
  sprintf(sKeySizeStr,"%04d",(ulong)uVar1);
  *(undefined4 *)(buffer_transmit + 8) = sKeySizeStr._0_4_;
  buffer_transmit[(int)(uVar1 + 0xc)] = ';';
  sVar4 = strlen(pData);
  uVar2 = AsciiToHex((uchar *)pData,(uchar *)(buffer_transmit + (long)(int)(uVar1 + 0xd) + 4),
                     (int)sVar4);
  sprintf(sKeySizeStr,"%04d",(ulong)uVar2);
  iVar3 = uVar1 + 0x11 + uVar2;
  iVar5 = iVar3 + 1;
  *(undefined4 *)(buffer_transmit + (int)(uVar1 + 0xd)) = sKeySizeStr._0_4_;
  buffer_transmit[iVar3] = ';';
  sVar4 = strlen(pPublicKey);
  if (*pPublicKey == 'S') {
    pcVar6 = buffer_transmit + iVar5;
    *(undefined8 *)pcVar6 = *(undefined8 *)pPublicKey;
    *(undefined8 *)(pcVar6 + 8) = *(undefined8 *)(pPublicKey + 8);
    pcVar6[0x10] = pPublicKey[0x10];
    iVar5 = iVar3 + 0x12;
    iVar3 = AsciiToHex((uchar *)(pPublicKey + 0x11),(uchar *)(buffer_transmit + iVar5),
                       (int)sVar4 + -0x11);
  }
  else {
    iVar3 = AsciiToHex((uchar *)pPublicKey,(uchar *)(buffer_transmit + iVar5),(int)sVar4);
  }
  trace_event("End   command_EY(OK)",5);
  return iVar5 + iVar3;
}



// WARNING: Unknown calling convention

int command_EZ(char *buffer_received)

{
  char *__s1;
  int iVar1;
  
  trace_event("Start command_EZ()",5);
  iVar1 = memcmp(buffer_received,&DAT_004cd1d4,2);
  if (iVar1 != 0) {
    trace_event("End   command_EZ(ERROR_COMMAND)",5);
    return 0x7d1;
  }
  __s1 = buffer_received + 2;
  iVar1 = memcmp(__s1,"00",2);
  if (iVar1 != 0) {
    iVar1 = memcmp(__s1,"01",2);
    if (iVar1 != 0) {
      iVar1 = memcmp(__s1,&DAT_004a7e3d,2);
      if (iVar1 != 0) {
        trace_event("End   command_EZ(CRYPTOGRAPHIC_ERROR)",5);
        return 2;
      }
    }
    trace_event("End   command_EZ(VERIFICATION_FAILED)",5);
    return 1;
  }
  trace_event("End   command_EZ(OK)",5);
  return 0;
}



// WARNING: Unknown calling convention

int command_EW(uchar *sHsmBuffer,char *sHashIdentifier,char *sSignatureIdentifier,
              char *sPadModeIdentifier,uchar *sMessageData,int nMessageDataLen,char *sSecretKeyFlag,
              char *sSecretKey)

{
  uint uVar1;
  int iVar2;
  size_t sVar3;
  uchar *puVar4;
  ulong uVar5;
  int iVar6;
  char sDataLength [5];
  char sLine [512];
  
  trace_event("Start command_EW()",5);
  sHsmBuffer[0] = 'E';
  sHsmBuffer[1] = 'W';
  *(undefined2 *)(sHsmBuffer + 2) = *(undefined2 *)sHashIdentifier;
  *(undefined2 *)(sHsmBuffer + 4) = *(undefined2 *)sSignatureIdentifier;
  *(undefined2 *)(sHsmBuffer + 6) = *(undefined2 *)sPadModeIdentifier;
  sprintf(sDataLength,"%04d",(ulong)(uint)nMessageDataLen);
  uVar1 = nMessageDataLen + 0xf;
  uVar5 = (ulong)uVar1;
  *(undefined4 *)(sHsmBuffer + 8) = sDataLength._0_4_;
  memcpy(sHsmBuffer + 0xc,sMessageData,(long)nMessageDataLen);
  sHsmBuffer[nMessageDataLen + 0xc] = ';';
  *(undefined2 *)(sHsmBuffer + (nMessageDataLen + 0xd)) = *(undefined2 *)sSecretKeyFlag;
  iVar2 = memcmp(sSecretKeyFlag,&DAT_004d48c9,2);
  if (iVar2 == 0) {
    sVar3 = strlen(sSecretKey);
    iVar2 = (int)sVar3;
    if (*sSecretKey == 'S') {
      builtin_memcpy(sHsmBuffer + (int)uVar1,"FFFF",4);
      puVar4 = sHsmBuffer + (nMessageDataLen + 0x13);
      *(undefined8 *)puVar4 = *(undefined8 *)sSecretKey;
      *(undefined8 *)(puVar4 + 8) = *(undefined8 *)(sSecretKey + 8);
      puVar4[0x10] = sSecretKey[0x10];
      iVar2 = AsciiToHex((uchar *)(sSecretKey + 0x11),sHsmBuffer + (nMessageDataLen + 0x24),
                         iVar2 + -0x11);
      uVar5 = (ulong)(uint)(nMessageDataLen + 0x24 + iVar2);
    }
    else {
      iVar6 = (int)(((uint)(sVar3 >> 0x1f) & 1) + iVar2) >> 1;
      *(undefined4 *)(sHsmBuffer + (int)uVar1) = *(undefined4 *)(long)iVar6;
      uVar5 = (ulong)(uint)(iVar6 + nMessageDataLen + 0x13);
      AsciiToHex((uchar *)sSecretKey,sHsmBuffer + (nMessageDataLen + 0x13),iVar2);
    }
  }
  sprintf(sLine,"End command_EW(%d)",uVar5);
  trace_event(sLine,5);
  return (int)uVar5;
}



// WARNING: Unknown calling convention

int command_EX(uchar *sBuffRcv,uchar *sSignature,int *nSignatureLen)

{
  int iVar1;
  long lVar2;
  char *pcVar3;
  byte bVar4;
  char Command [3];
  char sSignatureLen [5];
  char sErrCode [11];
  char sLine [512];
  
  bVar4 = 0;
  trace_event("Start command_EX()",5);
  sErrCode[8] = '\0';
  sErrCode[9] = '\0';
  pcVar3 = sLine;
  for (lVar2 = 0x40; lVar2 != 0; lVar2 = lVar2 + -1) {
    pcVar3[0] = '\0';
    pcVar3[1] = '\0';
    pcVar3[2] = '\0';
    pcVar3[3] = '\0';
    pcVar3[4] = '\0';
    pcVar3[5] = '\0';
    pcVar3[6] = '\0';
    pcVar3[7] = '\0';
    pcVar3 = pcVar3 + (ulong)bVar4 * -0x10 + 8;
  }
  Command._0_2_ = *(undefined2 *)sBuffRcv;
  Command[2] = '\0';
  sErrCode[10] = '\0';
  sSignatureLen[0] = '\0';
  sSignatureLen[1] = '\0';
  sSignatureLen[2] = '\0';
  sSignatureLen[3] = '\0';
  sSignatureLen[4] = '\0';
  sErrCode[4] = '\0';
  sErrCode[5] = '\0';
  sErrCode[6] = '\0';
  sErrCode[7] = '\0';
  sErrCode._0_4_ = *(uint *)sBuffRcv;
  iVar1 = memcmp(Command,"EX",2);
  if (iVar1 == 0) {
    TextError(sErrCode + 2,sLine);
    iVar1 = memcmp(sErrCode + 2,"00",2);
    if (iVar1 == 0) {
      sSignatureLen._0_4_ = *(undefined4 *)(sBuffRcv + 4);
      lVar2 = strtol(sSignatureLen,(char **)0x0,10);
      *nSignatureLen = (int)lVar2;
      memcpy(sSignature,sBuffRcv + 8,(long)(int)lVar2);
      trace_event("End   command_EX(OK)",5);
      iVar1 = 0;
    }
    else {
      iVar1 = -1;
      sprintf(sLine,"HSM Error: %.30s",sLine);
      trace_event(sLine,4);
      trace_event("End   command_EX(NOK)",5);
    }
  }
  else {
    iVar1 = 0x7d1;
    trace_event("End   command_EX(ERROR_COMMAND)",5);
  }
  return iVar1;
}



// WARNING: Unknown calling convention

int command_GK(uchar *buffer_transmit,char *Encryption_Identifier,char *Pad_Mode_Identifier,
              char *Mask_Generation_Function,char *MGF_Hash_Function,
              char *OAEP_Encoding_Parameters_Length,char *OAEP_Encoding_Parameters,char *Key_Type,
              char *Signature_Indicator,char *Signature_Hash_Identifier,char *Signature_Identifier,
              char *Signature_Pad_Mode_Identifier,char *Header_Data_Block_Length,
              char *Header_Data_Block,char *Footer_Data_Block_Length,char *Footer_Data_Block,
              char *Private_Key_Flag,char *Private_Key_Length,char *Private_Key,char *DES_Key_Flag,
              char *DES_Key_LMK,char *Check_Value,char *HMAC_Key_Format,char *HMAC_Key_Length,
              char *HMAC_Key_LMK,char *MAC,char *Public_Key,char *Authentication_Data,
              char *Key_Block_Type,char *Key_Block_Template_Length,char *Key_Block_Template,
              char *Key_Offset,char *Check_Value_Length,char *Check_Value_Offset)

{
  char cVar1;
  int iVar2;
  size_t sVar3;
  uchar *puVar4;
  long lVar5;
  int iVar6;
  uint nLng;
  int iVar7;
  
  trace_event("Start command_GK()",5);
  buffer_transmit[0] = 'G';
  buffer_transmit[1] = 'K';
  *(undefined2 *)(buffer_transmit + 2) = *(undefined2 *)Encryption_Identifier;
  *(undefined2 *)(buffer_transmit + 4) = *(undefined2 *)Pad_Mode_Identifier;
  iVar2 = memcmp(Pad_Mode_Identifier,&DAT_004a7e3d,2);
  lVar5 = 6;
  iVar6 = 6;
  if (iVar2 == 0) {
    sVar3 = strlen(Mask_Generation_Function);
    memcpy(buffer_transmit + 6,Mask_Generation_Function,sVar3);
    sVar3 = strlen(Mask_Generation_Function);
    iVar2 = (int)sVar3 + 6;
    sVar3 = strlen(MGF_Hash_Function);
    memcpy(buffer_transmit + iVar2,MGF_Hash_Function,sVar3);
    sVar3 = strlen(MGF_Hash_Function);
    iVar2 = iVar2 + (int)sVar3;
    sVar3 = strlen(OAEP_Encoding_Parameters_Length);
    memcpy(buffer_transmit + iVar2,OAEP_Encoding_Parameters_Length,sVar3);
    sVar3 = strlen(OAEP_Encoding_Parameters_Length);
    iVar2 = iVar2 + (int)sVar3;
    sVar3 = strlen(OAEP_Encoding_Parameters);
    memcpy(buffer_transmit + iVar2,OAEP_Encoding_Parameters,sVar3);
    sVar3 = strlen(OAEP_Encoding_Parameters);
    iVar2 = iVar2 + (int)sVar3;
    iVar6 = iVar2 + 1;
    buffer_transmit[iVar2] = ';';
    cVar1 = *DES_Key_LMK;
    lVar5 = (long)iVar6;
  }
  else {
    cVar1 = *DES_Key_LMK;
  }
  if (cVar1 == 'S') {
    builtin_memcpy(buffer_transmit + lVar5,"FFFF",4);
    iVar6 = iVar6 + 4;
  }
  else {
    sVar3 = strlen(Key_Type);
    memcpy(buffer_transmit + lVar5,Key_Type,sVar3);
    sVar3 = strlen(Key_Type);
    iVar6 = iVar6 + (int)sVar3;
  }
  if (((*Signature_Hash_Identifier != '\0') && (*Signature_Identifier != '\0')) &&
     (*Signature_Pad_Mode_Identifier != '\0')) {
    buffer_transmit[iVar6] = '=';
    sVar3 = strlen(Signature_Hash_Identifier);
    memcpy(buffer_transmit + (iVar6 + 1),Signature_Hash_Identifier,sVar3);
    sVar3 = strlen(Signature_Hash_Identifier);
    iVar2 = iVar6 + 1 + (int)sVar3;
    sVar3 = strlen(Signature_Identifier);
    memcpy(buffer_transmit + iVar2,Signature_Identifier,sVar3);
    sVar3 = strlen(Signature_Identifier);
    iVar2 = iVar2 + (int)sVar3;
    sVar3 = strlen(Signature_Pad_Mode_Identifier);
    memcpy(buffer_transmit + iVar2,Signature_Pad_Mode_Identifier,sVar3);
    sVar3 = strlen(Signature_Pad_Mode_Identifier);
    iVar2 = iVar2 + (int)sVar3;
    sVar3 = strlen(Header_Data_Block_Length);
    memcpy(buffer_transmit + iVar2,Header_Data_Block_Length,sVar3);
    sVar3 = strlen(Header_Data_Block_Length);
    iVar2 = iVar2 + (int)sVar3;
    iVar6 = memcmp(Header_Data_Block_Length,"0000",4);
    if (iVar6 != 0) {
      sVar3 = strlen(Header_Data_Block);
      memcpy(buffer_transmit + iVar2,Header_Data_Block,sVar3);
      sVar3 = strlen(Header_Data_Block);
      iVar2 = iVar2 + (int)sVar3;
    }
    buffer_transmit[iVar2] = ';';
    sVar3 = strlen(Footer_Data_Block_Length);
    memcpy(buffer_transmit + (iVar2 + 1),Footer_Data_Block_Length,sVar3);
    sVar3 = strlen(Footer_Data_Block_Length);
    iVar2 = iVar2 + 1 + (int)sVar3;
    iVar6 = memcmp(Footer_Data_Block_Length,"0000",4);
    if (iVar6 != 0) {
      sVar3 = strlen(Footer_Data_Block);
      memcpy(buffer_transmit + iVar2,Footer_Data_Block,sVar3);
      sVar3 = strlen(Footer_Data_Block);
      iVar2 = iVar2 + (int)sVar3;
    }
    buffer_transmit[iVar2] = ';';
    sVar3 = strlen(Private_Key_Flag);
    memcpy(buffer_transmit + (iVar2 + 1),Private_Key_Flag,sVar3);
    sVar3 = strlen(Private_Key_Flag);
    iVar2 = iVar2 + 1 + (int)sVar3;
    iVar6 = memcmp(Private_Key_Flag,&DAT_004d48c9,2);
    if (iVar6 == 0) {
      if (*Private_Key == 'S') {
        iVar6 = iVar2 + 4;
        builtin_memcpy(buffer_transmit + iVar2,"FFFF",4);
      }
      else {
        sVar3 = strlen(Private_Key_Length);
        memcpy(buffer_transmit + iVar2,Private_Key_Length,sVar3);
        sVar3 = strlen(Private_Key_Length);
        iVar6 = iVar2 + (int)sVar3;
      }
      sVar3 = strlen(Private_Key);
      memcpy(buffer_transmit + iVar6,Private_Key,sVar3);
      sVar3 = strlen(Private_Key);
      iVar2 = iVar6 + (int)sVar3;
    }
    iVar6 = iVar2 + 1;
    buffer_transmit[iVar2] = ';';
  }
  iVar2 = memcmp(Key_Type,&DAT_004cd274,4);
  if (iVar2 == 0) {
    if (*HMAC_Key_LMK == 'S') {
      (buffer_transmit + iVar6)[0] = '0';
      (buffer_transmit + iVar6)[1] = '4';
      iVar2 = iVar6 + 6;
      builtin_memcpy(buffer_transmit + (iVar6 + 2),"FFFF",4);
    }
    else {
      sVar3 = strlen(HMAC_Key_Format);
      memcpy(buffer_transmit + iVar6,HMAC_Key_Format,sVar3);
      sVar3 = strlen(HMAC_Key_Format);
      iVar6 = iVar6 + (int)sVar3;
      sVar3 = strlen(HMAC_Key_Length);
      memcpy(buffer_transmit + iVar6,HMAC_Key_Length,sVar3);
      sVar3 = strlen(HMAC_Key_Length);
      iVar2 = iVar6 + (int)sVar3;
    }
    sVar3 = strlen(HMAC_Key_LMK);
    memcpy(buffer_transmit + iVar2,HMAC_Key_LMK,sVar3);
    sVar3 = strlen(HMAC_Key_LMK);
    iVar2 = iVar2 + (int)sVar3;
    iVar7 = iVar2 + 1;
    buffer_transmit[iVar2] = ';';
  }
  else {
    if (*DES_Key_LMK == 'S') {
      iVar7 = iVar6 + 1;
      buffer_transmit[iVar6] = 'F';
    }
    else {
      sVar3 = strlen(DES_Key_Flag);
      memcpy(buffer_transmit + iVar6,DES_Key_Flag,sVar3);
      sVar3 = strlen(DES_Key_Flag);
      iVar7 = iVar6 + (int)sVar3;
    }
    sVar3 = strlen(DES_Key_LMK);
    memcpy(buffer_transmit + iVar7,DES_Key_LMK,sVar3);
    sVar3 = strlen(DES_Key_LMK);
    iVar7 = iVar7 + (int)sVar3;
    sVar3 = strlen(Check_Value);
    memcpy(buffer_transmit + iVar7,Check_Value,sVar3);
    sVar3 = strlen(Check_Value);
    iVar7 = iVar7 + (int)sVar3;
  }
  sVar3 = strlen(Public_Key);
  nLng = (uint)sVar3;
  if (*Public_Key == 'S') {
    lVar5 = (long)iVar7;
    iVar7 = iVar7 + 0x11;
    puVar4 = buffer_transmit + lVar5;
    nLng = nLng - 0x11;
    sVar3 = (size_t)nLng;
    *(undefined8 *)puVar4 = *(undefined8 *)Public_Key;
    *(undefined8 *)(puVar4 + 8) = *(undefined8 *)(Public_Key + 8);
    puVar4[0x10] = Public_Key[0x10];
    Public_Key = Public_Key + 0x11;
  }
  AsciiToHex((uchar *)Public_Key,buffer_transmit + iVar7,nLng);
  iVar7 = iVar7 + ((int)((int)sVar3 + ((uint)(sVar3 >> 0x1f) & 1)) >> 1);
  if (*Authentication_Data != '\0') {
    sVar3 = strlen(Authentication_Data);
    memcpy(buffer_transmit + iVar7,Authentication_Data,sVar3);
    sVar3 = strlen(Authentication_Data);
    iVar7 = iVar7 + (int)sVar3;
  }
  if (*Key_Block_Type != '\0') {
    buffer_transmit[iVar7] = ';';
    sVar3 = strlen(Key_Block_Type);
    memcpy(buffer_transmit + (iVar7 + 1),Key_Block_Type,sVar3);
    sVar3 = strlen(Key_Block_Type);
    iVar7 = iVar7 + 1 + (int)sVar3;
  }
  iVar6 = memcmp(Key_Block_Type,&DAT_004a7e3d,2);
  if (iVar6 == 0) {
    sVar3 = strlen(Key_Block_Template_Length);
    memcpy(buffer_transmit + iVar7,Key_Block_Template_Length,sVar3);
    sVar3 = strlen(Key_Block_Template_Length);
    iVar7 = iVar7 + (int)sVar3;
    sVar3 = strlen(Key_Block_Template);
    memcpy(buffer_transmit + iVar7,Key_Block_Template,sVar3);
    sVar3 = strlen(Key_Block_Template);
    iVar7 = iVar7 + (int)sVar3;
    iVar6 = iVar7 + 1;
    buffer_transmit[iVar7] = ';';
    sVar3 = strlen(Key_Offset);
    memcpy(buffer_transmit + iVar6,Key_Offset,sVar3);
    sVar3 = strlen(Key_Offset);
    iVar7 = iVar6 + (int)sVar3;
  }
  iVar6 = memcmp(Key_Type,&DAT_004cd274,4);
  if ((iVar6 != 0) && (iVar6 = memcmp(Key_Block_Type,&DAT_004a7e3d,2), iVar6 == 0)) {
    sVar3 = strlen(Check_Value_Length);
    memcpy(buffer_transmit + iVar7,Check_Value_Length,sVar3);
    sVar3 = strlen(Check_Value_Length);
    iVar7 = iVar7 + (int)sVar3;
    sVar3 = strlen(Check_Value_Offset);
    memcpy(buffer_transmit + iVar7,Check_Value_Offset,sVar3);
    sVar3 = strlen(Check_Value_Offset);
    iVar7 = iVar7 + (int)sVar3;
  }
  trace_event("End   command_GK(OK)",5);
  return iVar7;
}



// WARNING: Unknown calling convention

int command_GL(uchar *sBuffRcv,char *Key_Type,char *Initialization_value,char *Encrypted_Key_Length,
              uchar *Encrypted_Key,char *Signature_Indicator,char *Signature_Length,char *Signature,
              char *sErrCode)

{
  int iVar1;
  long lVar2;
  size_t sVar3;
  ulong uVar4;
  long lVar5;
  char Command [3];
  char sLine [512];
  
  trace_event("Start command_GL()",5);
  Command._0_2_ = *(undefined2 *)sBuffRcv;
  Command[2] = '\0';
  *(undefined4 *)sErrCode = *(undefined4 *)sBuffRcv;
  iVar1 = memcmp(Command,&DAT_004cd2a1,2);
  if (iVar1 != 0) {
    trace_event("End   command_GL(ERROR_COMMAND)",5);
    return 0x7d1;
  }
  TextError(sErrCode + 2,sLine);
  iVar1 = memcmp(sErrCode + 2,"00",2);
  if (iVar1 == 0) {
    iVar1 = memcmp(Key_Type,&DAT_004cd274,4);
    if ((iVar1 == 0) || (iVar1 = memcmp(Key_Type,&DAT_004cd2bc,4), iVar1 == 0)) {
      lVar5 = 8;
      iVar1 = 8;
      lVar2 = 4;
    }
    else {
      iVar1 = 0x18;
      *(undefined8 *)Initialization_value = *(undefined8 *)(sBuffRcv + 4);
      *(undefined8 *)(Initialization_value + 8) = *(undefined8 *)(sBuffRcv + 0xc);
      lVar5 = 0x18;
      lVar2 = 0x14;
    }
    *(undefined4 *)Encrypted_Key_Length = *(undefined4 *)(sBuffRcv + lVar2);
    lVar2 = strtol(Encrypted_Key_Length,(char **)0x0,10);
    memcpy(Encrypted_Key,sBuffRcv + lVar5,(long)(int)lVar2);
    lVar2 = strtol(Encrypted_Key_Length,(char **)0x0,10);
    iVar1 = iVar1 + (int)lVar2;
    sVar3 = strlen((char *)sBuffRcv);
    uVar4 = (ulong)(iVar1 + 4);
    if ((uVar4 < sVar3) && (*Signature_Indicator == '=')) {
      *(undefined4 *)Signature_Length = *(undefined4 *)(sBuffRcv + iVar1);
      lVar2 = strtol(Signature_Length,(char **)0x0,10);
      if (0 < (int)lVar2) {
        lVar2 = strtol(Signature_Length,(char **)0x0,10);
        memcpy(Signature,sBuffRcv + uVar4,(long)(int)lVar2);
      }
    }
    trace_event("End   command_GL(OK)",5);
    return 0;
  }
  trace_event("End   command_GL(ERROR)",5);
  return 1;
}



// WARNING: Unknown calling convention

int command_EO(char *buffer_transmit,char *rsakey,char *rsaencoding)

{
  size_t sVar1;
  long lVar2;
  int iVar3;
  char *pcVar4;
  char RSA_Public_Key [4096];
  
  pcVar4 = RSA_Public_Key;
  for (lVar2 = 0x200; lVar2 != 0; lVar2 = lVar2 + -1) {
    *(undefined8 *)pcVar4 = 0;
    pcVar4 = (char *)((long)pcVar4 + 8);
  }
  trace_event("Start command_EO()",5);
  buffer_transmit[0] = 'E';
  buffer_transmit[1] = 'O';
  sVar1 = strlen(rsaencoding);
  memcpy(buffer_transmit + 2,rsaencoding,sVar1);
  sVar1 = strlen(rsakey);
  AsciiToHex((uchar *)rsakey,(uchar *)RSA_Public_Key,(int)sVar1);
  iVar3 = (int)((int)sVar1 + ((uint)(sVar1 >> 0x1f) & 1)) >> 1;
  memcpy(buffer_transmit + 4,RSA_Public_Key,(long)iVar3);
  builtin_strncpy(buffer_transmit + (iVar3 + 4),"~%01#N00S00",0xb);
  trace_event("End   command_EO(OK)",5);
  return iVar3 + 0xf;
}



// WARNING: Unknown calling convention

int command_EP(char *buffer_received,char *sRSAKey,char *mac)

{
  byte bVar1;
  int iVar2;
  size_t sVar3;
  long lVar4;
  byte *pbVar5;
  char *pcVar6;
  char sAsciiHex [3];
  uchar mac_from_buff [5];
  char sKeyLen [5];
  char sLine [512];
  
  sAsciiHex[0] = '\0';
  sAsciiHex[1] = '\0';
  mac_from_buff[0] = '\0';
  mac_from_buff[1] = '\0';
  mac_from_buff[2] = '\0';
  mac_from_buff[3] = '\0';
  pbVar5 = mac_from_buff;
  mac_from_buff[4] = '\0';
  sAsciiHex[2] = '\0';
  sKeyLen[0] = '\0';
  sKeyLen[1] = '\0';
  sKeyLen[2] = '\0';
  sKeyLen[3] = '\0';
  sKeyLen[4] = '\0';
  trace_event("Start command_EP()",5);
  iVar2 = memcmp(buffer_received,&DAT_004da282,2);
  if (iVar2 == 0) {
    TextError(buffer_received + 2,sLine);
    iVar2 = memcmp(buffer_received + 2,"00",2);
    if (iVar2 == 0) {
      iVar2 = 0;
      if (buffer_received[4] == 'S') {
        *(undefined8 *)sRSAKey = *(undefined8 *)(buffer_received + 4);
        *(undefined8 *)(sRSAKey + 8) = *(undefined8 *)(buffer_received + 0xc);
        sRSAKey[0x10] = buffer_received[0x14];
        sKeyLen._0_4_ = *(undefined4 *)(buffer_received + 6);
        lVar4 = strtol(sKeyLen,(char **)0x0,10);
        HexToAscii((uchar *)(buffer_received + 0x15),(uchar *)(sRSAKey + 0x11),
                   (int)lVar4 * 2 + -0x20);
        trace_event("End   command_EP(OK)",5);
      }
      else {
        mac_from_buff._0_4_ = *(undefined4 *)(buffer_received + 4);
        pcVar6 = mac;
        do {
          bVar1 = *pbVar5;
          sAsciiHex[0] = '\0';
          sAsciiHex[1] = '\0';
          sAsciiHex[2] = '\0';
          pbVar5 = pbVar5 + 1;
          sprintf(sAsciiHex,"%02X",(ulong)bVar1);
          *(undefined2 *)pcVar6 = sAsciiHex._0_2_;
          pcVar6 = pcVar6 + 2;
        } while (pbVar5 != mac_from_buff + 4);
        sVar3 = strlen(mac);
        sprintf(sLine,"mac: (%d)%s",sVar3,mac);
        trace_event(sLine,4);
        trace_event("End   command_EP(OK)",5);
      }
    }
    else {
      iVar2 = 2;
      trace_event("End   command_EP(CHECK_ERROR)",5);
    }
  }
  else {
    iVar2 = 0x7d1;
    trace_event("End   command_EP(ERROR_COMMAND)",5);
  }
  return iVar2;
}



// WARNING: Unknown calling convention

int command_FW(char *buffer_transmit,char *Tpk_Zpk,char *Pvk,char *PinBlock,char *format,char *Pan,
              char *PvkI)

{
  size_t sVar1;
  size_t sVar2;
  char *pcVar3;
  char Card [13];
  char CardTrunc [23];
  char ligne [512];
  
  CardTrunc[0] = '\0';
  CardTrunc[1] = '\0';
  CardTrunc[2] = '\0';
  CardTrunc[3] = '\0';
  CardTrunc[4] = '\0';
  CardTrunc[5] = '\0';
  CardTrunc[6] = '\0';
  CardTrunc[7] = '\0';
  CardTrunc[8] = '\0';
  CardTrunc[9] = '\0';
  CardTrunc[10] = '\0';
  CardTrunc[0xb] = '\0';
  CardTrunc[0xc] = '\0';
  CardTrunc[0xd] = '\0';
  CardTrunc[0xe] = '\0';
  CardTrunc[0xf] = '\0';
  CardTrunc[0x10] = '\0';
  CardTrunc[0x11] = '\0';
  CardTrunc[0x12] = '\0';
  CardTrunc[0x13] = '\0';
  CardTrunc[0x14] = '\0';
  CardTrunc[0x15] = '\0';
  CardTrunc[0x16] = '\0';
  Card[0] = '\0';
  Card[1] = '\0';
  Card[2] = '\0';
  Card[3] = '\0';
  Card[4] = '\0';
  Card[5] = '\0';
  Card[6] = '\0';
  Card[7] = '\0';
  Card[8] = '\0';
  Card[9] = '\0';
  Card[10] = '\0';
  Card[0xb] = '\0';
  Card[0xc] = '\0';
  if (debug_option == 1) {
    sprintf(ligne,"Start command_FW(%.16s,%.2s,%.22s)",PinBlock,format,Pan);
  }
  else {
    TrunCard(Pan,CardTrunc);
    sprintf(ligne,"Start command_FW(%.2s,%.22s)",format,CardTrunc);
  }
  trace_event(ligne,5);
  builtin_strncpy(buffer_transmit,"FWFFF",5);
  pcVar3 = buffer_transmit + 5;
  sVar1 = strlen(Tpk_Zpk);
  memcpy(pcVar3,Tpk_Zpk,sVar1);
  sVar1 = strlen(Tpk_Zpk);
  sVar2 = strlen(Pvk);
  memcpy(pcVar3 + sVar1,Pvk,sVar2);
  sVar2 = strlen(Pvk);
  pcVar3 = pcVar3 + sVar1 + sVar2;
  *(undefined8 *)pcVar3 = *(undefined8 *)PinBlock;
  *(undefined8 *)(pcVar3 + 8) = *(undefined8 *)(PinBlock + 8);
  *(undefined2 *)(pcVar3 + 0x10) = *(undefined2 *)format;
  format_card_from_pan(Card,Pan);
  *(undefined8 *)(pcVar3 + 0x12) = Card._0_8_;
  *(undefined4 *)(pcVar3 + 0x1a) = Card._8_4_;
  pcVar3[0x1e] = *PvkI;
  if (debug_option == 1) {
    sprintf(ligne,"End   command_FW(%.60s)",pcVar3 + 0x1f);
  }
  else {
    builtin_strncpy(ligne + 0x10,"(OK)",5);
    builtin_strncpy(ligne,"End   command_FW",0x10);
  }
  trace_event(ligne,5);
  return 0;
}



// WARNING: Unknown calling convention

int command_FX(char *buffer_received,char *Pvv,char *err_code)

{
  int iVar1;
  char Command [3];
  char ligne [512];
  char sLine [512];
  
  Command[0] = '\0';
  Command[1] = '\0';
  Command[2] = '\0';
  if (debug_option == 1) {
    sprintf(ligne,"Start command_FX(%.40s)",buffer_received);
  }
  else {
    ligne._18_2_ = SUB42(ligne._16_4_,2) & 0xff00;
    builtin_strncpy(ligne,"Start command_FX()",0x12);
  }
  trace_event(ligne,5);
  Command._0_2_ = *(undefined2 *)buffer_received;
  *(undefined2 *)err_code = *(undefined2 *)(buffer_received + 2);
  iVar1 = memcmp(Command,&DAT_004cd39d,2);
  if (iVar1 == 0) {
    TextError(err_code,sLine);
    iVar1 = memcmp(err_code,"00",2);
    if (iVar1 == 0) {
      *(undefined4 *)Pvv = *(undefined4 *)(buffer_received + 4);
      if (debug_option == 1) {
        sprintf(ligne,"End   command_FX(%.2s,%.16s)",err_code,Pvv);
      }
      else {
        builtin_strncpy(ligne + 0x10,"(OK)",5);
        builtin_strncpy(ligne,"End   command_FX",0x10);
      }
      trace_event(ligne,5);
      iVar1 = 0;
    }
    else {
      iVar1 = 0x7d2;
      trace_event("End   command_FX(CHECK_ERROR)",5);
    }
  }
  else {
    iVar1 = 0x7d1;
    trace_event("End   command_FX(ERROR_COMMAND)",5);
  }
  return iVar1;
}



// WARNING: Unknown calling convention

int command_BK(char *buffer_transmit,char *Pvk,char *Tpk_Zpk,char *PinBlock,char *format,char *Pan,
              char *sDecTable)

{
  undefined2 uVar1;
  size_t sVar2;
  size_t sVar3;
  char *pcVar4;
  char Card [13];
  
  pcVar4 = buffer_transmit + 5;
  trace_event("Start command_BK()",5);
  builtin_strncpy(buffer_transmit,"BKFFF",5);
  Card[0] = '\0';
  Card[1] = '\0';
  Card[2] = '\0';
  Card[3] = '\0';
  Card[4] = '\0';
  Card[5] = '\0';
  Card[6] = '\0';
  Card[7] = '\0';
  Card[8] = '\0';
  Card[9] = '\0';
  Card[10] = '\0';
  Card[0xb] = '\0';
  Card[0xc] = '\0';
  sVar2 = strlen(Tpk_Zpk);
  memcpy(pcVar4,Tpk_Zpk,sVar2);
  sVar2 = strlen(Tpk_Zpk);
  sVar3 = strlen(Pvk);
  memcpy(pcVar4 + sVar2,Pvk,sVar3);
  sVar3 = strlen(Pvk);
  pcVar4 = pcVar4 + sVar2 + sVar3;
  *(undefined8 *)pcVar4 = *(undefined8 *)PinBlock;
  *(undefined8 *)(pcVar4 + 8) = *(undefined8 *)(PinBlock + 8);
  uVar1 = *(undefined2 *)format;
  pcVar4[0x12] = '0';
  pcVar4[0x13] = '4';
  *(undefined2 *)(pcVar4 + 0x10) = uVar1;
  format_card_from_pan(Card,Pan);
  *(undefined8 *)(pcVar4 + 0x14) = Card._0_8_;
  *(undefined4 *)(pcVar4 + 0x1c) = Card._8_4_;
  *(undefined8 *)(pcVar4 + 0x20) = *(undefined8 *)sDecTable;
  *(undefined8 *)(pcVar4 + 0x28) = *(undefined8 *)(sDecTable + 8);
  *(undefined8 *)(pcVar4 + 0x30) = *(undefined8 *)Pan;
  uVar1 = *(undefined2 *)(Pan + 8);
  pcVar4[0x3a] = 'N';
  *(undefined2 *)(pcVar4 + 0x38) = uVar1;
  sVar2 = strlen(Pan);
  pcVar4[0x3b] = Pan[sVar2 - 1];
  trace_event("End   command_BK(OK)",5);
  return 0;
}



// WARNING: Unknown calling convention

int command_BL(char *buffer_received,char *offset,char *err_code)

{
  int iVar1;
  char *err_code_00;
  char Command [3];
  char sLine [512];
  
  trace_event("Start command_BL()",5);
  Command._0_2_ = *(undefined2 *)buffer_received;
  Command[2] = '\0';
  *(undefined4 *)err_code = *(undefined4 *)buffer_received;
  iVar1 = memcmp(Command,&DAT_004cd416,2);
  if (iVar1 != 0) {
    trace_event("End   command_DF(ERROR_COMMAND)",5);
    return 0x7d1;
  }
  err_code_00 = err_code + 2;
  TextError(err_code_00,sLine);
  iVar1 = memcmp(err_code_00,"00",2);
  if (iVar1 != 0) {
    iVar1 = memcmp(err_code_00,&DAT_004a7e3d,2);
    if (iVar1 != 0) {
      trace_event("End   command_BL(CHECK_ERROR)",5);
      return 0x7d2;
    }
  }
  *(undefined8 *)offset = *(undefined8 *)(buffer_received + 4);
  *(undefined4 *)(offset + 8) = *(undefined4 *)(buffer_received + 0xc);
  trace_event("End   command_BL(OK)",5);
  return 0;
}



// WARNING: Unknown calling convention

int command_A8(char *buffer_transmit,char *keyType,char *zmkLmk,char *keyLmk)

{
  size_t sVar1;
  size_t sVar2;
  char *__dest;
  
  __dest = buffer_transmit + 5;
  trace_event("Start command_A8()",5);
  buffer_transmit[0] = 'A';
  buffer_transmit[1] = '8';
  *(undefined2 *)(buffer_transmit + 2) = *(undefined2 *)keyType;
  buffer_transmit[4] = keyType[2];
  sVar1 = strlen(zmkLmk);
  memcpy(__dest,zmkLmk,sVar1);
  sVar1 = strlen(zmkLmk);
  sVar2 = strlen(keyLmk);
  memcpy(__dest + sVar1,keyLmk,sVar2);
  sVar2 = strlen(keyLmk);
  (__dest + sVar1)[sVar2] = 'X';
  trace_event("End   command_A8(OK)",5);
  return 0;
}



// WARNING: Unknown calling convention

int command_A9(char *buffer_received,char *keyZmk,char *check_value)

{
  char cVar1;
  undefined2 uVar2;
  undefined8 uVar3;
  int iVar4;
  long lVar5;
  size_t __n;
  char *pcVar6;
  char sKeyLenStr [32];
  char sLine [512];
  
  trace_event("Start command_A9()",5);
  iVar4 = memcmp(buffer_received,&DAT_004cd487,2);
  if (iVar4 == 0) {
    TextError(buffer_received + 2,sLine);
    iVar4 = memcmp(buffer_received + 2,"00",2);
    if (iVar4 == 0) {
      switch(buffer_received[4]) {
      case 'S':
        trace_event("Keyblock Encryption Length",4);
        sKeyLenStr._0_4_ = *(undefined4 *)(buffer_received + 6);
        lVar5 = strtol(sKeyLenStr,(char **)0x0,10);
        __n = (size_t)((int)lVar5 + 1);
        memcpy(keyZmk,buffer_received + 4,__n);
        keyZmk[__n] = '\0';
        pcVar6 = buffer_received + 4 + __n;
        break;
      case 'T':
      case 'Y':
        pcVar6 = buffer_received + 0x35;
        trace_event("Triple DES Encryption Triple Length",4);
        *(undefined8 *)keyZmk = *(undefined8 *)(buffer_received + 4);
        *(undefined8 *)(keyZmk + 8) = *(undefined8 *)(buffer_received + 0xc);
        *(undefined8 *)(keyZmk + 0x10) = *(undefined8 *)(buffer_received + 0x14);
        *(undefined8 *)(keyZmk + 0x18) = *(undefined8 *)(buffer_received + 0x1c);
        *(undefined8 *)(keyZmk + 0x20) = *(undefined8 *)(buffer_received + 0x24);
        *(undefined8 *)(keyZmk + 0x28) = *(undefined8 *)(buffer_received + 0x2c);
        cVar1 = buffer_received[0x34];
        keyZmk[0x31] = '\0';
        keyZmk[0x30] = cVar1;
        break;
      case 'U':
      case 'X':
        pcVar6 = buffer_received + 0x25;
        *(undefined8 *)keyZmk = *(undefined8 *)(buffer_received + 4);
        *(undefined8 *)(keyZmk + 8) = *(undefined8 *)(buffer_received + 0xc);
        *(undefined8 *)(keyZmk + 0x10) = *(undefined8 *)(buffer_received + 0x14);
        *(undefined8 *)(keyZmk + 0x18) = *(undefined8 *)(buffer_received + 0x1c);
        cVar1 = buffer_received[0x24];
        keyZmk[0x21] = '\0';
        keyZmk[0x20] = cVar1;
        break;
      default:
        pcVar6 = buffer_received + 0x14;
        trace_event("Single DES Encryption Single Length",4);
        *(undefined8 *)keyZmk = *(undefined8 *)(buffer_received + 4);
        uVar3 = *(undefined8 *)(buffer_received + 0xc);
        keyZmk[0x10] = '\0';
        *(undefined8 *)(keyZmk + 8) = uVar3;
      }
      *(undefined4 *)check_value = *(undefined4 *)pcVar6;
      uVar2 = *(undefined2 *)(pcVar6 + 4);
      check_value[6] = '\0';
      *(undefined2 *)(check_value + 4) = uVar2;
      trace_event("End   command_A9(OK)",5);
      iVar4 = 0;
    }
    else {
      iVar4 = 0x7d2;
      trace_event("End   command_A9(CHECK_ERROR)",5);
    }
  }
  else {
    iVar4 = 0x7d1;
    trace_event("End   command_A9(ERROR_COMMAND)",5);
  }
  return iVar4;
}



// WARNING: Unknown calling convention

char decomp_f(char w)

{
  char cVar1;
  
  cVar1 = '0';
  if (9 < (byte)w) {
    cVar1 = '7';
  }
  return w + cVar1;
}



// WARNING: Unknown calling convention

void decomp(char x,char *r)

{
  char cVar1;
  
  cVar1 = decomp_f(x & 0xf);
  r[1] = cVar1;
  cVar1 = decomp_f((char)((int)((byte)x & 0xf0) >> 4));
  *r = cVar1;
  return;
}



// WARNING: Unknown calling convention

void decomp_all(char *A,char *B)

{
  char *pcVar1;
  long lVar2;
  
  lVar2 = 0;
  do {
    pcVar1 = A + lVar2;
    lVar2 = lVar2 + 1;
    decomp(*pcVar1,B);
    B = B + 2;
  } while (lVar2 != 8);
  return;
}



// WARNING: Unknown calling convention

void decimalisation(char *table_decimalisation,char *cle)

{
  char cVar1;
  char cVar2;
  int iVar3;
  
  cVar1 = *cle;
  cVar2 = cle[1];
  iVar3 = cVar1 + -0x30;
  if ('9' < cVar1) {
    iVar3 = cVar1 + -0x37;
  }
  *cle = table_decimalisation[iVar3];
  cVar1 = cle[2];
  iVar3 = cVar2 + -0x30;
  if ('9' < cVar2) {
    iVar3 = cVar2 + -0x37;
  }
  cle[1] = table_decimalisation[iVar3];
  cVar2 = cle[3];
  iVar3 = cVar1 + -0x30;
  if ('9' < cVar1) {
    iVar3 = cVar1 + -0x37;
  }
  cle[2] = table_decimalisation[iVar3];
  cVar1 = cle[4];
  iVar3 = cVar2 + -0x30;
  if ('9' < cVar2) {
    iVar3 = cVar2 + -0x37;
  }
  cle[3] = table_decimalisation[iVar3];
  cVar2 = cle[5];
  iVar3 = cVar1 + -0x30;
  if ('9' < cVar1) {
    iVar3 = cVar1 + -0x37;
  }
  cle[4] = table_decimalisation[iVar3];
  cVar1 = cle[6];
  iVar3 = cVar2 + -0x30;
  if ('9' < cVar2) {
    iVar3 = cVar2 + -0x37;
  }
  cle[5] = table_decimalisation[iVar3];
  cVar2 = cle[7];
  iVar3 = cVar1 + -0x30;
  if ('9' < cVar1) {
    iVar3 = cVar1 + -0x37;
  }
  cle[6] = table_decimalisation[iVar3];
  cVar1 = cle[8];
  iVar3 = cVar2 + -0x30;
  if ('9' < cVar2) {
    iVar3 = cVar2 + -0x37;
  }
  cle[7] = table_decimalisation[iVar3];
  cVar2 = cle[9];
  iVar3 = cVar1 + -0x30;
  if ('9' < cVar1) {
    iVar3 = cVar1 + -0x37;
  }
  cle[8] = table_decimalisation[iVar3];
  cVar1 = cle[10];
  iVar3 = cVar2 + -0x30;
  if ('9' < cVar2) {
    iVar3 = cVar2 + -0x37;
  }
  cle[9] = table_decimalisation[iVar3];
  cVar2 = cle[0xb];
  iVar3 = cVar1 + -0x30;
  if ('9' < cVar1) {
    iVar3 = cVar1 + -0x37;
  }
  cle[10] = table_decimalisation[iVar3];
  iVar3 = cVar2 + -0x30;
  if ('9' < cVar2) {
    iVar3 = cVar2 + -0x37;
  }
  cle[0xb] = table_decimalisation[iVar3];
  cVar1 = cle[0xc];
  cVar2 = cle[0xd];
  iVar3 = cVar1 + -0x30;
  if ('9' < cVar1) {
    iVar3 = cVar1 + -0x37;
  }
  cle[0xc] = table_decimalisation[iVar3];
  cVar1 = cle[0xe];
  iVar3 = cVar2 + -0x30;
  if ('9' < cVar2) {
    iVar3 = cVar2 + -0x37;
  }
  cle[0xd] = table_decimalisation[iVar3];
  cVar2 = cle[0xf];
  iVar3 = cVar1 + -0x30;
  if ('9' < cVar1) {
    iVar3 = cVar1 + -0x37;
  }
  cle[0xe] = table_decimalisation[iVar3];
  iVar3 = cVar2 + -0x30;
  if ('9' < cVar2) {
    iVar3 = cVar2 + -0x37;
  }
  cle[0xf] = table_decimalisation[iVar3];
  return;
}



// WARNING: Unknown calling convention

uchar comp_g(uchar w)

{
  byte bVar1;
  
  bVar1 = w - 0x30;
  if (9 < (byte)(w - 0x30)) {
    bVar1 = w - 0x37;
  }
  return bVar1;
}



// WARNING: Unknown calling convention

void comp(uchar *x,uchar *r)

{
  uchar uVar1;
  uchar uVar2;
  
  uVar1 = comp_g(x[1]);
  uVar2 = comp_g(*x);
  *r = uVar2 * '\x10' + uVar1;
  return;
}



// WARNING: Unknown calling convention

void comp_all(uchar *A,uchar *B)

{
  uchar *r;
  long lVar1;
  
  lVar1 = 0;
  do {
    r = B + lVar1;
    lVar1 = lVar1 + 1;
    comp(A,r);
    A = A + 2;
  } while (lVar1 != 8);
  return;
}



// WARNING: Unknown calling convention

void x_or(uchar *entre1,uchar *entre2,uchar *sortie)

{
  uchar Entree1 [8];
  uchar Entree2 [8];
  uchar Sortie [8];
  
  comp_all(entre1,Entree1);
  comp_all(entre2,Entree2);
  Sortie[0] = Entree1[0] ^ Entree2[0];
  Sortie[1] = Entree2[1] ^ Entree1[1];
  Sortie[2] = Entree2[2] ^ Entree1[2];
  Sortie[3] = Entree2[3] ^ Entree1[3];
  Sortie[4] = Entree2[4] ^ Entree1[4];
  Sortie[5] = Entree2[5] ^ Entree1[5];
  Sortie[6] = Entree2[6] ^ Entree1[6];
  Sortie[7] = Entree2[7] ^ Entree1[7];
  decomp_all((char *)Sortie,(char *)sortie);
  return;
}



// WARNING: Unknown calling convention

int numeric_extract(char *entree,char *sortie)

{
  bool bVar1;
  uint uVar2;
  long lVar3;
  
  sortie[0] = '\0';
  sortie[1] = '\0';
  sortie[2] = '\0';
  sortie[3] = '\0';
  sortie[4] = '\0';
  sortie[5] = '\0';
  sortie[6] = '\0';
  sortie[7] = '\0';
  sortie[8] = '\0';
  sortie[9] = '\0';
  sortie[10] = '\0';
  sortie[0xb] = '\0';
  sortie[0xc] = '\0';
  sortie[0xd] = '\0';
  sortie[0xe] = '\0';
  sortie[0xf] = '\0';
  sortie[0x10] = '\0';
  bVar1 = (int)*entree - 0x30U < 10;
  if (bVar1) {
    *sortie = *entree;
  }
  uVar2 = (uint)bVar1;
  if ((int)entree[1] - 0x30U < 10) {
    uVar2 = bVar1 + 1;
    sortie[(int)(uint)bVar1] = entree[1];
  }
  if ((int)entree[2] - 0x30U < 10) {
    lVar3 = (long)(int)uVar2;
    uVar2 = uVar2 + 1;
    sortie[lVar3] = entree[2];
  }
  if ((int)entree[3] - 0x30U < 10) {
    lVar3 = (long)(int)uVar2;
    uVar2 = uVar2 + 1;
    sortie[lVar3] = entree[3];
  }
  if ((int)entree[4] - 0x30U < 10) {
    lVar3 = (long)(int)uVar2;
    uVar2 = uVar2 + 1;
    sortie[lVar3] = entree[4];
  }
  if ((int)entree[5] - 0x30U < 10) {
    lVar3 = (long)(int)uVar2;
    uVar2 = uVar2 + 1;
    sortie[lVar3] = entree[5];
  }
  if ((int)entree[6] - 0x30U < 10) {
    lVar3 = (long)(int)uVar2;
    uVar2 = uVar2 + 1;
    sortie[lVar3] = entree[6];
  }
  if ((int)entree[7] - 0x30U < 10) {
    lVar3 = (long)(int)uVar2;
    uVar2 = uVar2 + 1;
    sortie[lVar3] = entree[7];
  }
  if ((int)entree[8] - 0x30U < 10) {
    lVar3 = (long)(int)uVar2;
    uVar2 = uVar2 + 1;
    sortie[lVar3] = entree[8];
  }
  if ((int)entree[9] - 0x30U < 10) {
    lVar3 = (long)(int)uVar2;
    uVar2 = uVar2 + 1;
    sortie[lVar3] = entree[9];
  }
  if ((int)entree[10] - 0x30U < 10) {
    lVar3 = (long)(int)uVar2;
    uVar2 = uVar2 + 1;
    sortie[lVar3] = entree[10];
  }
  if ((int)entree[0xb] - 0x30U < 10) {
    lVar3 = (long)(int)uVar2;
    uVar2 = uVar2 + 1;
    sortie[lVar3] = entree[0xb];
  }
  if ((int)entree[0xc] - 0x30U < 10) {
    lVar3 = (long)(int)uVar2;
    uVar2 = uVar2 + 1;
    sortie[lVar3] = entree[0xc];
  }
  if ((int)entree[0xd] - 0x30U < 10) {
    lVar3 = (long)(int)uVar2;
    uVar2 = uVar2 + 1;
    sortie[lVar3] = entree[0xd];
  }
  if ((int)entree[0xe] - 0x30U < 10) {
    lVar3 = (long)(int)uVar2;
    uVar2 = uVar2 + 1;
    sortie[lVar3] = entree[0xe];
  }
  if ((int)entree[0xf] - 0x30U < 10) {
    sortie[(int)uVar2] = entree[0xf];
  }
  return uVar2;
}



// WARNING: Unknown calling convention

void expand_pin(uchar *crypt_pin,uchar *pin_block)

{
  byte bVar1;
  byte *pbVar2;
  byte bVar3;
  int iVar4;
  char ligne [512];
  
  if (debug_option == 1) {
    sprintf(ligne,"Start expand_pin(%.8s)",pin_block);
  }
  else {
    builtin_strncpy(ligne,"Start expand_pin()",0x13);
  }
  trace_event("Start expand_pin()",5);
  bVar1 = *pin_block;
  iVar4 = 0;
  crypt_pin[1] = bVar1 & 0xf;
  *crypt_pin = bVar1 >> 4;
  bVar1 = pin_block[1];
  crypt_pin[3] = bVar1 & 0xf;
  crypt_pin[2] = bVar1 >> 4;
  bVar1 = pin_block[2];
  crypt_pin[5] = bVar1 & 0xf;
  crypt_pin[4] = bVar1 >> 4;
  bVar1 = pin_block[3];
  crypt_pin[7] = bVar1 & 0xf;
  crypt_pin[6] = bVar1 >> 4;
  bVar1 = pin_block[4];
  crypt_pin[9] = bVar1 & 0xf;
  crypt_pin[8] = bVar1 >> 4;
  bVar1 = pin_block[5];
  crypt_pin[0xb] = bVar1 & 0xf;
  crypt_pin[10] = bVar1 >> 4;
  bVar1 = pin_block[6];
  crypt_pin[0xd] = bVar1 & 0xf;
  crypt_pin[0xc] = bVar1 >> 4;
  bVar1 = pin_block[7];
  crypt_pin[0xf] = bVar1 & 0xf;
  crypt_pin[0xe] = bVar1 >> 4;
  pbVar2 = crypt_pin;
  do {
    bVar1 = *pbVar2;
    if (bVar1 < 10) {
      *pbVar2 = bVar1 + 0x30;
    }
    else if (bVar1 == 10) {
      *pbVar2 = 0x41;
    }
    else if (bVar1 == 0xb) {
      *pbVar2 = 0x42;
    }
    else if (bVar1 == 0xc) {
      *pbVar2 = 0x43;
    }
    else if (bVar1 == 0xd) {
      *pbVar2 = 0x44;
    }
    else if (bVar1 == 0xe) {
      *pbVar2 = 0x45;
    }
    else {
      bVar3 = 0x46;
      if (bVar1 != 0xf) {
        bVar3 = 0;
      }
      *pbVar2 = bVar3;
    }
    pbVar2 = pbVar2 + 1;
    iVar4 = iVar4 + 1;
  } while (iVar4 != 0x10);
  if (debug_option == 1) {
    sprintf(ligne,"End   expand_pin(%.16s)",crypt_pin);
  }
  else {
    builtin_strncpy(ligne,"End   expand_pin()",0x13);
  }
  trace_event(ligne,5);
  return;
}



// WARNING: Unknown calling convention

void compress_pin(char *target,char *source)

{
  char cVar1;
  byte bVar2;
  long lVar3;
  byte bVar4;
  byte bVar5;
  
  trace_event("Start compress_pin()",5);
  lVar3 = 0;
  do {
    cVar1 = source[lVar3 * 2];
    bVar2 = source[lVar3 * 2 + 1];
    bVar5 = 0xa0;
    if ((((cVar1 != 'A') && (bVar5 = 0xb0, cVar1 != 'B')) && (bVar5 = 0xc0, cVar1 != 'C')) &&
       ((bVar5 = 0xd0, cVar1 != 'D' && (bVar5 = 0xe0, cVar1 != 'E')))) {
      bVar5 = 0xf0;
      if (cVar1 != 'F') {
        bVar5 = cVar1 << 4;
      }
    }
    bVar4 = 10;
    if (((bVar2 != 0x41) && (bVar4 = 0xb, bVar2 != 0x42)) &&
       ((bVar4 = 0xc, bVar2 != 0x43 &&
        (((bVar4 = 0xd, bVar2 != 0x44 && (bVar4 = 0xe, bVar2 != 0x45)) &&
         (bVar4 = bVar2 & 0xf, bVar2 == 0x46)))))) {
      bVar4 = 0xf;
    }
    target[lVar3] = bVar5 | bVar4;
    lVar3 = lVar3 + 1;
  } while (lVar3 != 8);
  trace_event("End   compress_pin()",5);
  return;
}



// WARNING: Unknown calling convention

int HsmQuery(int nIndiceCtx,pid_t nHsmPid,char *BuffSnd,char *BuffRcv)

{
  int iVar1;
  pthread_t pVar2;
  size_t __n;
  void *pvVar3;
  long lVar4;
  TSHsmCtx *pTVar5;
  TSHsmExchange *pTVar6;
  byte bVar7;
  char sLine [512];
  TSHsmExchange sBalMessage;
  
  bVar7 = 0;
  pTVar6 = &sBalMessage;
  for (lVar4 = 0x205; lVar4 != 0; lVar4 = lVar4 + -1) {
    (pTVar6->sHeader).sPartner[0] = '\0';
    (pTVar6->sHeader).sPartner[1] = '\0';
    (pTVar6->sHeader).sSource[0] = '\0';
    (pTVar6->sHeader).sSource[1] = '\0';
    (pTVar6->sHeader).nPartnerId = 0;
    pTVar6 = (TSHsmExchange *)&(pTVar6->sHeader).nSourceId;
  }
  pTVar5 = tab_HsmCtx + nIndiceCtx;
  for (lVar4 = 0x200; lVar4 != 0; lVar4 = lVar4 + -1) {
    pTVar5->szBufferBal[0] = '\0';
    pTVar5->szBufferBal[1] = '\0';
    pTVar5->szBufferBal[2] = '\0';
    pTVar5->szBufferBal[3] = '\0';
    pTVar5->szBufferBal[4] = '\0';
    pTVar5->szBufferBal[5] = '\0';
    pTVar5->szBufferBal[6] = '\0';
    pTVar5->szBufferBal[7] = '\0';
    pTVar5 = (TSHsmCtx *)(pTVar5->szBufferBal + 8);
  }
  sBalMessage.sHeader.nIndex = nIndiceCtx;
  pVar2 = pthread_self();
  sBalMessage.sHeader.tid = (int)pVar2;
  sBalMessage.sHeader.nCoNumber = GetNextCoNumber(nIndiceCtx);
  sBalMessage.sHeader.nPartnerId = nHsmPid;
  sBalMessage.sHeader.nSourceId = getpid();
  sBalMessage.sHeader.nCommand = 0x834;
  __n = strlen(BuffSnd);
  pvVar3 = memcpy(sBalMessage.sBody,BuffSnd,__n);
  sBalMessage.sHeader.nLen = (int)__n;
  if (debug_option == 1) {
    sprintf(sLine,"TO HSM:%d-->%s|",__n & 0xffffffff,pvVar3);
    trace_event(sLine,4);
  }
  iVar1 = WriteBalHsm(nBalHsm,&sBalMessage);
  if (iVar1 == 0) {
    pTVar6 = &sBalMessage;
    for (lVar4 = 0x205; lVar4 != 0; lVar4 = lVar4 + -1) {
      (pTVar6->sHeader).sPartner[0] = '\0';
      (pTVar6->sHeader).sPartner[1] = '\0';
      (pTVar6->sHeader).sSource[0] = '\0';
      (pTVar6->sHeader).sSource[1] = '\0';
      (pTVar6->sHeader).nPartnerId = 0;
      pTVar6 = (TSHsmExchange *)((long)pTVar6 + (ulong)bVar7 * -0x10 + 8);
    }
    iVar1 = WaitHsmResponse(nIndiceCtx,0x23,BuffRcv);
    if (iVar1 == 0) {
      if (debug_option == 1) {
        sprintf(sLine,"FROM HSM: <--%s|",BuffRcv);
        trace_event(sLine,4);
      }
      trace_event("End HsmQuery ( OK )",5);
      iVar1 = 0;
    }
    else {
      iVar1 = 0x3ef;
      trace_event("Time Out Situation With HSM",5);
      trace_event("End HsmQuery ( NOK )",5);
    }
  }
  else {
    iVar1 = 3;
    trace_event("Can Not Write Message To Hsm Queue",5);
    trace_event("End  HsmQuery ( NOK )",5);
  }
  return iVar1;
}



// WARNING: Unknown calling convention

int calc_pin(int nIndiceCtx,char *card,char *pin_key,char *pin)

{
  int iVar1;
  size_t sVar2;
  char *BuffRcv;
  char sHsmResultCode [5];
  char sortie [17];
  char entree [17];
  char Buffer [512];
  char Buffer_hsm_recu [512];
  
  BuffRcv = pin;
  trace_event("Start calc_pin()",5);
  stack0xfffffffffffffb7c = 0;
  sHsmResultCode[0] = '\0';
  sHsmResultCode[1] = '\0';
  sHsmResultCode[2] = '\0';
  sHsmResultCode[3] = '\0';
  sortie[0] = '\0';
  sortie[1] = '\0';
  sortie[2] = '\0';
  sortie[3] = '\0';
  sortie[4] = '\0';
  sortie[5] = '\0';
  sortie[6] = '\0';
  sortie[7] = '\0';
  sortie[8] = '\0';
  sortie[9] = '\0';
  sortie[10] = '\0';
  sortie[0xb] = '\0';
  sortie[0xc] = '\0';
  sortie[0xd] = '\0';
  sortie[0xe] = '\0';
  sortie[0xf] = '\0';
  sortie[0x10] = '\0';
  builtin_strncpy(entree,"00000000",9);
  entree[9] = '\0';
  entree[10] = '\0';
  entree[0xb] = '\0';
  entree[0xc] = '\0';
  entree[0xd] = '\0';
  entree[0xe] = '\0';
  entree[0xf] = '\0';
  entree[0x10] = '\0';
  sVar2 = strlen(card);
  entree._8_8_ = *(undefined8 *)(card + (sVar2 - 8));
  command_HE(Buffer,pin_key,entree);
  iVar1 = HsmQuery(nIndiceCtx,(pid_t)Buffer,Buffer_hsm_recu,BuffRcv);
  if (iVar1 == 0x3ef) {
    trace_event("HSM NOT AVAILABLE",1);
    iVar1 = -1;
  }
  else if (iVar1 == 3) {
    trace_event("MALFUNCTION ERROR",1);
    iVar1 = -1;
  }
  else {
    iVar1 = command_HF(Buffer_hsm_recu,sortie,sHsmResultCode);
    if (iVar1 == 0) {
      if (sortie[0] == 'A') {
        sortie[0] = '0';
      }
      else if (sortie[0] == 'B') {
        sortie[0] = '1';
      }
      else if (sortie[0] == 'C') {
        sortie[0] = '2';
      }
      else if (sortie[0] == 'D') {
        sortie[0] = '3';
      }
      else if (sortie[0] == 'E') {
        sortie[0] = '4';
      }
      else if (sortie[0] == 'F') {
        sortie[0] = '5';
      }
      if (sortie[1] == 'A') {
        sortie[1] = '0';
      }
      else if (sortie[1] == 'B') {
        sortie[1] = '1';
      }
      else if (sortie[1] == 'C') {
        sortie[1] = '2';
      }
      else if (sortie[1] == 'D') {
        sortie[1] = '3';
      }
      else if (sortie[1] == 'E') {
        sortie[1] = '4';
      }
      else if (sortie[1] == 'F') {
        sortie[1] = '5';
      }
      if (sortie[2] == 'A') {
        sortie[2] = '0';
      }
      else if (sortie[2] == 'B') {
        sortie[2] = '1';
      }
      else if (sortie[2] == 'C') {
        sortie[2] = '2';
      }
      else if (sortie[2] == 'D') {
        sortie[2] = '3';
      }
      else if (sortie[2] == 'E') {
        sortie[2] = '4';
      }
      else if (sortie[2] == 'F') {
        sortie[2] = '5';
      }
      if (sortie[3] == 'A') {
        sortie[3] = '0';
      }
      else if (sortie[3] == 'B') {
        sortie[3] = '1';
      }
      else if (sortie[3] == 'C') {
        sortie[3] = '2';
      }
      else if (sortie[3] == 'D') {
        sortie[3] = '3';
      }
      else if (sortie[3] == 'E') {
        sortie[3] = '4';
      }
      else if (sortie[3] == 'F') {
        sortie[3] = '5';
      }
      *(undefined4 *)pin = sortie._0_4_;
      trace_event("End   calc_pin()",5);
      iVar1 = 0;
    }
    else {
      iVar1 = -1;
    }
  }
  return iVar1;
}



// WARNING: Unknown calling convention

int calc_pin_block(int nIndiceCtx,char *card,char *pin_key,char *pin_block)

{
  undefined8 uVar1;
  int extraout_EAX;
  size_t sVar2;
  char value [3];
  char pin [5];
  char entree1 [17];
  char entree2 [17];
  
  trace_event("Start calc_pin_block()",5);
  entree1[0] = '\0';
  entree1[1] = '\0';
  entree1[2] = '\0';
  entree1[3] = '\0';
  entree1[4] = '\0';
  entree1[5] = '\0';
  entree1[6] = '\0';
  entree1[7] = '\0';
  entree1[8] = '\0';
  entree1[9] = '\0';
  entree1[10] = '\0';
  entree1[0xb] = '\0';
  entree1[0xc] = '\0';
  entree1[0xd] = '\0';
  entree1[0xe] = '\0';
  entree1[0xf] = '\0';
  entree1[0x10] = '\0';
  entree2[0] = '\0';
  entree2[1] = '\0';
  entree2[2] = '\0';
  entree2[3] = '\0';
  entree2[4] = '\0';
  entree2[5] = '\0';
  entree2[6] = '\0';
  entree2[7] = '\0';
  entree2[8] = '\0';
  entree2[9] = '\0';
  entree2[10] = '\0';
  entree2[0xb] = '\0';
  entree2[0xc] = '\0';
  entree2[0xd] = '\0';
  entree2[0xe] = '\0';
  entree2[0xf] = '\0';
  entree2[0x10] = '\0';
  pin[0] = '\0';
  pin[1] = '\0';
  pin[2] = '\0';
  pin[3] = '\0';
  pin[4] = '\0';
  value[0] = '\0';
  value[1] = '\0';
  value[2] = '\0';
  calc_pin(nIndiceCtx,card,pin_key,pin);
  builtin_strncpy(entree1,"FFFFFFFFFFFFFFFF",0x10);
  sprintf(value,"%02d",4);
  builtin_strncpy(entree2,"0000",4);
  entree1[2] = pin[0];
  entree1[3] = pin[1];
  entree1[4] = pin[2];
  entree1[5] = pin[3];
  entree1[0] = value[0];
  entree1[1] = value[1];
  sVar2 = strlen(card);
  uVar1 = *(undefined8 *)(card + (sVar2 - 0xd));
  entree2._4_4_ = (undefined4)uVar1;
  entree2._8_4_ = (undefined4)((ulong)uVar1 >> 0x20);
  entree2._12_4_ = *(undefined4 *)(card + (sVar2 - 0xd) + 8);
  x_or((uchar *)entree1,(uchar *)entree2,(uchar *)pin_block);
  trace_event("End   calc_pin_block(VOID)",5);
  return extraout_EAX;
}



// WARNING: Removing unreachable block (ram,0x0046c350)
// WARNING: Removing unreachable block (ram,0x0046c368)
// WARNING: Removing unreachable block (ram,0x0046c370)
// WARNING: Removing unreachable block (ram,0x0046c387)
// WARNING: Removing unreachable block (ram,0x0046c390)
// WARNING: Removing unreachable block (ram,0x0046c153)
// WARNING: Removing unreachable block (ram,0x0046c144)
// WARNING: Removing unreachable block (ram,0x0046c162)
// WARNING: Unknown calling convention

int HsmQueryBin(int nIndiceCtx,pid_t nHsmPid,char *BuffSnd,int nLength,char *BuffRcv)

{
  uint uVar1;
  int iVar2;
  pthread_t pVar3;
  long lVar4;
  TSHsmCtx *pTVar5;
  TSHsmExchange *pTVar6;
  byte bVar7;
  char sLine [512];
  TSHsmExchange sBalMessage;
  
  bVar7 = 0;
  trace_event("Start HsmQueryBin ()",5);
  pTVar6 = &sBalMessage;
  for (lVar4 = 0x205; lVar4 != 0; lVar4 = lVar4 + -1) {
    (pTVar6->sHeader).sPartner[0] = '\0';
    (pTVar6->sHeader).sPartner[1] = '\0';
    (pTVar6->sHeader).sSource[0] = '\0';
    (pTVar6->sHeader).sSource[1] = '\0';
    (pTVar6->sHeader).nPartnerId = 0;
    pTVar6 = (TSHsmExchange *)((long)pTVar6 + (ulong)bVar7 * -0x10 + 8);
  }
  pTVar5 = tab_HsmCtx + nIndiceCtx;
  for (lVar4 = 0x200; lVar4 != 0; lVar4 = lVar4 + -1) {
    pTVar5->szBufferBal[0] = '\0';
    pTVar5->szBufferBal[1] = '\0';
    pTVar5->szBufferBal[2] = '\0';
    pTVar5->szBufferBal[3] = '\0';
    pTVar5->szBufferBal[4] = '\0';
    pTVar5->szBufferBal[5] = '\0';
    pTVar5->szBufferBal[6] = '\0';
    pTVar5->szBufferBal[7] = '\0';
    pTVar5 = (TSHsmCtx *)((long)pTVar5 + (ulong)bVar7 * -0x10 + 8);
  }
  sBalMessage.sHeader.nIndex = nIndiceCtx;
  pVar3 = pthread_self();
  sBalMessage.sHeader.tid = (int)pVar3;
  sBalMessage.sHeader.nCoNumber = GetNextCoNumber(nIndiceCtx);
  sBalMessage.sHeader.nPartnerId = nHsmPid;
  sBalMessage.sHeader.nSourceId = getpid();
  sBalMessage.sHeader.nCommand = 0x834;
  memcpy(sBalMessage.sBody,BuffSnd,(long)nLength);
  sBalMessage.sHeader.nLen = nLength;
  uVar1 = getpid();
  sprintf(sLine,"GLOBAL PartnerID = %d; SourceID = %d",(ulong)(uint)nHsmPid,(ulong)uVar1);
  trace_event(sLine,4);
  if (debug_option == 1) {
    sprintf(sLine,"TO HSM: Len=[%d]--> Data=",(ulong)(uint)sBalMessage.sHeader.nLen);
    trace_event(sLine,4);
    dump_buffer((uchar *)sBalMessage.sBody,sBalMessage.sHeader.nLen,'A','B','O');
  }
  iVar2 = WriteBalHsm(nBalHsm,&sBalMessage);
  if (iVar2 == 0) {
    pTVar6 = &sBalMessage;
    for (lVar4 = 0x205; lVar4 != 0; lVar4 = lVar4 + -1) {
      (pTVar6->sHeader).sPartner[0] = '\0';
      (pTVar6->sHeader).sPartner[1] = '\0';
      (pTVar6->sHeader).sSource[0] = '\0';
      (pTVar6->sHeader).sSource[1] = '\0';
      (pTVar6->sHeader).nPartnerId = 0;
      pTVar6 = (TSHsmExchange *)((long)pTVar6 + (ulong)bVar7 * -0x10 + 8);
    }
    iVar2 = WaitHsmResponse(nIndiceCtx,0x23,BuffRcv);
    if (iVar2 == 0) {
      dump_buffer((uchar *)(tab_HsmCtx + nIndiceCtx),tab_HsmCtx[nIndiceCtx].nLenBal,'A','B','O');
      trace_event("End   HsmQueryBin ( OK )",5);
      iVar2 = 0;
    }
    else {
      iVar2 = 0x3ef;
      trace_event("Time Out Situation With HSM",5);
      trace_event("End HsmQueryBin ( NOK )",5);
    }
  }
  else {
    iVar2 = 3;
    trace_event("Can Not Write Message To Hsm Queue",5);
    trace_event("End  HsmQuery ( NOK )",5);
  }
  return iVar2;
}



// WARNING: Unknown calling convention

char * StrMoins(char *sPinBlockC,char *sPinCalc)

{
  char cVar1;
  char cVar2;
  char cVar3;
  char cVar4;
  char dif [5];
  char sLine [512];
  
  if (debug_option == 1) {
    trace_event("Start StrMoins()",5);
    sprintf(sLine," Pin Block Claire : %s ",sPinBlockC);
    trace_event(sLine,5);
    sprintf(sLine," Pin Block Calculer : %s ",sPinCalc);
    trace_event(sLine,5);
  }
  dif[4] = '\0';
  cVar1 = *sPinBlockC - *sPinCalc;
  if (*sPinBlockC < *sPinCalc) {
    cVar1 = cVar1 + '\n';
  }
  dif[0] = cVar1 + '0';
  cVar3 = sPinBlockC[1] - sPinCalc[1];
  cVar1 = cVar3 + '\n';
  if (sPinCalc[1] <= sPinBlockC[1]) {
    cVar1 = cVar3;
  }
  dif[1] = cVar1 + '0';
  cVar4 = sPinBlockC[2] - sPinCalc[2];
  cVar1 = sPinBlockC[3];
  cVar3 = sPinCalc[3];
  cVar2 = cVar4 + '\n';
  if (sPinCalc[2] <= sPinBlockC[2]) {
    cVar2 = cVar4;
  }
  dif[2] = cVar2 + '0';
  cVar2 = cVar1 - cVar3;
  if (cVar1 < cVar3) {
    cVar2 = (cVar1 + '\n') - cVar3;
  }
  dif[3] = cVar2 + '0';
  sprintf(sLine,"End StrMoins( %s ) ",dif);
  trace_event(sLine,5);
  return dif;
}



// WARNING: Unknown calling convention

int ChangePin(int nIndexCtx,char *sPinBlck,char *sPan,char *sTrack3,char *sPinKey,char *sTpkKey,
             char *sFunctionCode,char *sHsmResultCode)

{
  int iVar1;
  char *pcVar2;
  long lVar3;
  uchar *puVar4;
  byte bVar5;
  pid_t nPid;
  char sPinCalcul [5];
  char sPinResult [17];
  char pin_clair_recu [17];
  char entree2 [17];
  char sLine [512];
  uchar BuffSnd [4096];
  uchar BuffRcv [4096];
  
  bVar5 = 0;
  trace_event("Debut ChangePin()",5);
  puVar4 = BuffSnd;
  for (lVar3 = 0x200; lVar3 != 0; lVar3 = lVar3 + -1) {
    puVar4[0] = '\0';
    puVar4[1] = '\0';
    puVar4[2] = '\0';
    puVar4[3] = '\0';
    puVar4[4] = '\0';
    puVar4[5] = '\0';
    puVar4[6] = '\0';
    puVar4[7] = '\0';
    puVar4 = puVar4 + (ulong)bVar5 * -0x10 + 8;
  }
  sPinResult[0] = '\0';
  sPinResult[1] = '\0';
  sPinResult[2] = '\0';
  sPinResult[3] = '\0';
  sPinResult[4] = '\0';
  sPinResult[5] = '\0';
  sPinResult[6] = '\0';
  sPinResult[7] = '\0';
  sPinResult[8] = '\0';
  sPinResult[9] = '\0';
  sPinResult[10] = '\0';
  sPinResult[0xb] = '\0';
  sPinResult[0xc] = '\0';
  sPinResult[0xd] = '\0';
  sPinResult[0xe] = '\0';
  sPinResult[0xf] = '\0';
  sPinResult[0x10] = '\0';
  pin_clair_recu[0] = '\0';
  pin_clair_recu[1] = '\0';
  pin_clair_recu[2] = '\0';
  pin_clair_recu[3] = '\0';
  pin_clair_recu[4] = '\0';
  pin_clair_recu[5] = '\0';
  pin_clair_recu[6] = '\0';
  pin_clair_recu[7] = '\0';
  pin_clair_recu[8] = '\0';
  pin_clair_recu[9] = '\0';
  pin_clair_recu[10] = '\0';
  pin_clair_recu[0xb] = '\0';
  pin_clair_recu[0xc] = '\0';
  pin_clair_recu[0xd] = '\0';
  pin_clair_recu[0xe] = '\0';
  pin_clair_recu[0xf] = '\0';
  pin_clair_recu[0x10] = '\0';
  sPinCalcul[0] = '\0';
  sPinCalcul[1] = '\0';
  sPinCalcul[2] = '\0';
  sPinCalcul[3] = '\0';
  sPinCalcul[4] = '\0';
  puVar4 = BuffRcv;
  for (lVar3 = 0x200; lVar3 != 0; lVar3 = lVar3 + -1) {
    puVar4[0] = '\0';
    puVar4[1] = '\0';
    puVar4[2] = '\0';
    puVar4[3] = '\0';
    puVar4[4] = '\0';
    puVar4[5] = '\0';
    puVar4[6] = '\0';
    puVar4[7] = '\0';
    puVar4 = puVar4 + (ulong)bVar5 * -0x10 + 8;
  }
  if (debug_option == 1) {
    trace_event("============================================",5);
    sprintf(sLine,"PAN                         : %.20s",sPan);
    trace_event(sLine,5);
    sprintf(sLine,"PIN BLOCK                   : %.16s",sPinBlck);
    trace_event(sLine,5);
    sprintf(sLine,"TPK                         : %.16s",sTpkKey);
    trace_event(sLine,5);
    sprintf(sLine,"TAK                         : %.16s",sPinKey);
    trace_event(sLine,5);
    trace_event("============================================",5);
  }
  command_HG((char *)BuffSnd,sTpkKey,sPinBlck);
  iVar1 = CheckResource(nIndexCtx,"070000",&nPid);
  if (iVar1 == 0) {
    iVar1 = HsmQuery(nIndexCtx,nPid,(char *)BuffSnd,(char *)BuffRcv);
    if (iVar1 == 0x3ef) {
      iVar1 = 5;
      pcVar2 = "HSM NOT AVAILABLE.";
      builtin_strncpy(sHsmResultCode,"UNVL",4);
    }
    else {
      if (iVar1 != 3) {
        iVar1 = command_HH((char *)BuffRcv,pin_clair_recu,sHsmResultCode);
        if (iVar1 != 0) {
          if (iVar1 == 0x7d1) {
            trace_event("End   check_pin_data(ERROR_COMMAND)",5);
            return 3;
          }
          trace_event("End   check_pin_data(CRYPTOGRAPHIC_ERROR)",5);
          return 2;
        }
        strlen(sPan);
        sPinResult[0] = pin_clair_recu[0];
        sPinResult[1] = pin_clair_recu[1];
        sPinResult[2] = pin_clair_recu[2];
        sPinResult[3] = pin_clair_recu[3];
        sPinResult[4] = pin_clair_recu[4];
        sPinResult[5] = pin_clair_recu[5];
        sPinResult[6] = pin_clair_recu[6];
        sPinResult[7] = pin_clair_recu[7];
        sPinResult[8] = pin_clair_recu[8];
        sPinResult[9] = pin_clair_recu[9];
        sPinResult[10] = pin_clair_recu[10];
        sPinResult[0xb] = pin_clair_recu[0xb];
        sPinResult[0xc] = pin_clair_recu[0xc];
        sPinResult[0xd] = pin_clair_recu[0xd];
        sPinResult[0xe] = pin_clair_recu[0xe];
        sPinResult[0xf] = pin_clair_recu[0xf];
        if (debug_option == 1) {
          sprintf(sLine,"PIN CLAIRE RECU : %.16s\n",pin_clair_recu);
          trace_event(sLine,4);
        }
        iVar1 = calc_pin(nIndexCtx,sTrack3,sPinKey,sPinCalcul);
        if (iVar1 == 0) {
          if (debug_option == 1) {
            sprintf(sLine,"PIN CALC : %.4s\n",sPinCalcul);
            trace_event(sLine,4);
          }
          pcVar2 = StrMoins(sPinResult,sPinCalcul);
          *(undefined4 *)(sTrack3 + 0x31) = *(undefined4 *)pcVar2;
          trace_event("Fin   ChangePin(OK)",5);
          return 0;
        }
        trace_event("Fin   ChangePin(NOK)",5);
        return -1;
      }
      pcVar2 = "MALFUNCTION ERROR";
      iVar1 = 1;
      builtin_strncpy(sHsmResultCode,"UNVL",4);
    }
    trace_event(pcVar2,iVar1);
    trace_event("Fin   check_pin_data(HSM_UNAVAILABLE)",5);
  }
  else {
    builtin_strncpy(sHsmResultCode,"UNVL",4);
    trace_event("HSM FOR VERIFICATION NOT AVAILABLE",1);
    trace_event("End   check_pin_data(HSM_UNAVAILABLE)",5);
  }
  return 9;
}



// WARNING: Unknown calling convention

int UpdateTrack3(int nIndexCtx,TSTlvAutho *sTlvInfo)

{
  int iVar1;
  long lVar2;
  char *pcVar3;
  byte bVar4;
  char sFunctionCode [4];
  char sServiceCode [4];
  char sCvv1 [4];
  int nTrack3;
  int nLength;
  char sExpiryDate [5];
  char sPvv [6];
  char sHsmResultCode [10];
  char sPinKey [16];
  char sTakKey [16];
  char sPinBlock [17];
  char sSecurityResults [21];
  char sPan [23];
  char sTrack2Data [41];
  char sTrack3 [105];
  char sLine [512];
  char sTlvPrivateBuffer [4096];
  TSTlvPrivate sTlvPrivateInfo;
  
  bVar4 = 0;
  trace_event("Debut UpdateTrack3()",5);
  sHsmResultCode[8] = '\0';
  sHsmResultCode[9] = '\0';
  pcVar3 = sTrack2Data;
  for (lVar2 = 5; lVar2 != 0; lVar2 = lVar2 + -1) {
    pcVar3[0] = '\0';
    pcVar3[1] = '\0';
    pcVar3[2] = '\0';
    pcVar3[3] = '\0';
    pcVar3[4] = '\0';
    pcVar3[5] = '\0';
    pcVar3[6] = '\0';
    pcVar3[7] = '\0';
    pcVar3 = pcVar3 + (ulong)bVar4 * -0x10 + 8;
  }
  sPan[0x14] = '\0';
  sPan[0x15] = '\0';
  sTakKey[0] = '\0';
  sTakKey[1] = '\0';
  sTakKey[2] = '\0';
  sTakKey[3] = '\0';
  sTakKey[4] = '\0';
  sTakKey[5] = '\0';
  sTakKey[6] = '\0';
  sTakKey[7] = '\0';
  sTakKey[8] = '\0';
  sTakKey[9] = '\0';
  sTakKey[10] = '\0';
  sTakKey[0xb] = '\0';
  sTakKey[0xc] = '\0';
  sTakKey[0xd] = '\0';
  sTakKey[0xe] = '\0';
  sTakKey[0xf] = '\0';
  sPvv[4] = '\0';
  sPvv[5] = '\0';
  sPinKey[0] = '\0';
  sPinKey[1] = '\0';
  sPinKey[2] = '\0';
  sPinKey[3] = '\0';
  sPinKey[4] = '\0';
  sPinKey[5] = '\0';
  sPinKey[6] = '\0';
  sPinKey[7] = '\0';
  sPinKey[8] = '\0';
  sPinKey[9] = '\0';
  sPinKey[10] = '\0';
  sPinKey[0xb] = '\0';
  sPinKey[0xc] = '\0';
  sPinKey[0xd] = '\0';
  sPinKey[0xe] = '\0';
  sPinKey[0xf] = '\0';
  *pcVar3 = '\0';
  pcVar3 = sTlvPrivateBuffer;
  for (lVar2 = 0x200; lVar2 != 0; lVar2 = lVar2 + -1) {
    pcVar3[0] = '\0';
    pcVar3[1] = '\0';
    pcVar3[2] = '\0';
    pcVar3[3] = '\0';
    pcVar3[4] = '\0';
    pcVar3[5] = '\0';
    pcVar3[6] = '\0';
    pcVar3[7] = '\0';
    pcVar3 = pcVar3 + (ulong)bVar4 * -0x10 + 8;
  }
  sHsmResultCode[0] = '\0';
  sHsmResultCode[1] = '\0';
  sHsmResultCode[2] = '\0';
  sHsmResultCode[3] = '\0';
  sHsmResultCode[4] = '\0';
  sHsmResultCode[5] = '\0';
  sHsmResultCode[6] = '\0';
  sHsmResultCode[7] = '\0';
  sExpiryDate[0] = '\0';
  sExpiryDate[1] = '\0';
  sExpiryDate[2] = '\0';
  sExpiryDate[3] = '\0';
  sExpiryDate[4] = '\0';
  sServiceCode[0] = '\0';
  sServiceCode[1] = '\0';
  sServiceCode[2] = '\0';
  sServiceCode[3] = '\0';
  sPvv[0] = '\0';
  sPvv[1] = '\0';
  sPvv[2] = '\0';
  sPvv[3] = '\0';
  sPan[0] = '\0';
  sPan[1] = '\0';
  sPan[2] = '\0';
  sPan[3] = '\0';
  sPan[4] = '\0';
  sPan[5] = '\0';
  sPan[6] = '\0';
  sPan[7] = '\0';
  sPan[8] = '\0';
  sPan[9] = '\0';
  sPan[10] = '\0';
  sPan[0xb] = '\0';
  sPan[0xc] = '\0';
  sPan[0xd] = '\0';
  sPan[0xe] = '\0';
  sPan[0xf] = '\0';
  sPan[0x10] = '\0';
  sPan[0x11] = '\0';
  sPan[0x12] = '\0';
  sPan[0x13] = '\0';
  sPan[0x16] = '\0';
  sCvv1[0] = '\0';
  sCvv1[1] = '\0';
  sCvv1[2] = '\0';
  sCvv1[3] = '\0';
  sPinBlock[0] = '\0';
  sPinBlock[1] = '\0';
  sPinBlock[2] = '\0';
  sPinBlock[3] = '\0';
  sPinBlock[4] = '\0';
  sPinBlock[5] = '\0';
  sPinBlock[6] = '\0';
  sPinBlock[7] = '\0';
  sPinBlock[8] = '\0';
  sPinBlock[9] = '\0';
  sPinBlock[10] = '\0';
  sPinBlock[0xb] = '\0';
  sPinBlock[0xc] = '\0';
  sPinBlock[0xd] = '\0';
  sPinBlock[0xe] = '\0';
  sPinBlock[0xf] = '\0';
  sPinBlock[0x10] = '\0';
  sSecurityResults[0] = '\0';
  sSecurityResults[1] = '\0';
  sSecurityResults[2] = '\0';
  sSecurityResults[3] = '\0';
  sSecurityResults[4] = '\0';
  sSecurityResults[5] = '\0';
  sSecurityResults[6] = '\0';
  sSecurityResults[7] = '\0';
  sSecurityResults[8] = '\0';
  sSecurityResults[9] = '\0';
  sSecurityResults[10] = '\0';
  sSecurityResults[0xb] = '\0';
  sSecurityResults[0xc] = '\0';
  sSecurityResults[0xd] = '\0';
  sSecurityResults[0xe] = '\0';
  sSecurityResults[0xf] = '\0';
  sSecurityResults[0x10] = '\0';
  sSecurityResults[0x11] = '\0';
  sSecurityResults[0x12] = '\0';
  sSecurityResults[0x13] = '\0';
  sSecurityResults[0x14] = '\0';
  iVar1 = GetTlvAutho("035",sTlvInfo,sTrack2Data,&nLength);
  if (iVar1 == 0) {
    GetTrack2Data(sTrack2Data,sPan,sExpiryDate,sServiceCode,sPvv,sCvv1);
  }
  GetTlvAutho("024",sTlvInfo,sFunctionCode,&nLength);
  GetTlvAutho("036",sTlvInfo,sTrack3,&nTrack3);
  iVar1 = GetTlvAutho("048",sTlvInfo,sTlvPrivateBuffer,&nLength);
  if (iVar1 == 0) {
    AnalyseTlvPrivate(sTlvPrivateBuffer,nLength,&sTlvPrivateInfo);
    GetTlvPrivate("P10",&sTlvPrivateInfo,sTakKey,&nLength);
  }
  iVar1 = GetPinKey(nIndexCtx,sPan,sPinKey);
  if (iVar1 == 0) {
    iVar1 = GetTlvAutho("031",sTlvInfo,sPinBlock,&nLength);
    if (iVar1 == 0) {
      pcVar3 = sHsmResultCode;
      iVar1 = ChangePin(nIndexCtx,sPinBlock,sPan,sTrack3,sPinKey,sTakKey,sFunctionCode,pcVar3);
      if (iVar1 != 0) {
        FillSecurityResult((char)iVar1,sSecurityResults,2);
        PutHsmRjectEvent(sTlvInfo,(char)iVar1,2);
        goto LAB_0046ccbf;
      }
      if (debug_option == 1) {
        sprintf(sLine," T3 : %s ",sTrack3);
        trace_event(sLine,4);
      }
      PutTlvAutho("036",sTlvInfo,sTrack3,nTrack3);
    }
    trace_event("Fin   UpdateTrack3(OK)",5);
    iVar1 = 0;
  }
  else {
    FillSecurityResult('\x03',sSecurityResults,2);
    PutHsmRjectEvent(sTlvInfo,'\x03',2);
    pcVar3 = "-TAK";
LAB_0046ccbf:
    HsmDecline(sTlvInfo,sSecurityResults,pcVar3,'\x02');
    trace_event("End   UpdateTrack3(NOK)",5);
    iVar1 = -1;
  }
  return iVar1;
}



// WARNING: Removing unreachable block (ram,0x0046ce17)
// WARNING: Removing unreachable block (ram,0x0046ce30)
// WARNING: Removing unreachable block (ram,0x0046ce47)
// WARNING: Removing unreachable block (ram,0x0046ce50)
// WARNING: Removing unreachable block (ram,0x0046cd84)
// WARNING: Removing unreachable block (ram,0x0046cd93)
// WARNING: Removing unreachable block (ram,0x0046cda2)
// WARNING: Unknown calling convention

void InitTabHsmCtx(int mode)

{
  pthread_cond_t *__cond;
  uint uVar1;
  int iVar2;
  uint *puVar3;
  long lVar4;
  TSHsmCtx *pTVar5;
  TSHsmCtx *pTVar6;
  byte bVar7;
  pthread_mutexattr_t mattr;
  pthread_condattr_t cattr;
  
  bVar7 = 0;
  pthread_mutexattr_init((pthread_mutexattr_t *)&mattr);
  pthread_condattr_init((pthread_condattr_t *)&cattr);
  pTVar5 = tab_HsmCtx;
  do {
    pTVar5->co_number = 0;
    pTVar5->free = 1;
    pTVar5->status = -1;
    pTVar5->tid = 0xffffffffffffffff;
    pTVar5->nLenBal = 0;
    pTVar6 = pTVar5;
    for (lVar4 = 0x200; lVar4 != 0; lVar4 = lVar4 + -1) {
      pTVar6->szBufferBal[0] = '\0';
      pTVar6->szBufferBal[1] = '\0';
      pTVar6->szBufferBal[2] = '\0';
      pTVar6->szBufferBal[3] = '\0';
      pTVar6->szBufferBal[4] = '\0';
      pTVar6->szBufferBal[5] = '\0';
      pTVar6->szBufferBal[6] = '\0';
      pTVar6->szBufferBal[7] = '\0';
      pTVar6 = (TSHsmCtx *)((long)pTVar6 + ((ulong)bVar7 * -2 + 1) * 8);
    }
    pthread_mutex_init((pthread_mutex_t *)&pTVar5->HsmMutex,(pthread_mutexattr_t *)&mattr);
    __cond = &pTVar5->HsmCond;
    pTVar5 = pTVar5 + 1;
    pthread_cond_init((pthread_cond_t *)__cond,(pthread_condattr_t *)&cattr);
  } while (pTVar5 != (TSHsmCtx *)&OPENSSL_ia32cap_P);
  if (mode == 0) {
    nBalHsm = OpenBalCom(0x102);
  }
  else {
    nBalHsm = OpenBalCom(0x103);
  }
  if (-1 < nBalHsm) {
    uVar1 = getpid();
    EmptyQueue(nBalHsm,(ulong)uVar1);
    trace_event("*********Create The HSM Thread********",5);
    iVar2 = pthread_create(&tab_ThrInfo[9].tid,(pthread_attr_t *)0x0,thread_HSM,(void *)0x0);
    if (-1 < iVar2) {
      return;
    }
    puVar3 = (uint *)__errno_location();
    fprintf(stderr,"pthread_create (HSM) Error %d\n",(ulong)*puVar3);
                    // WARNING: Subroutine does not return
    exit(0);
  }
  trace_event("Can Not Open Hsm Queue",5);
                    // WARNING: Subroutine does not return
  exit(0);
}



// WARNING: Unknown calling convention

int GetNextCoNumber(int nIndex)

{
  int iVar1;
  
  iVar1 = (tab_HsmCtx[nIndex].co_number + 1) % 100;
  tab_HsmCtx[nIndex].co_number = iVar1;
  return iVar1;
}



// WARNING: Unknown calling convention

int CmpCoNumber(int nIndex,int nCoNumber)

{
  return -(uint)(tab_HsmCtx[nIndex].co_number != nCoNumber);
}



// WARNING: Unknown calling convention

int GetThreadHsmIndex(pthread_t tid)

{
  int iVar1;
  pthread_t *ppVar2;
  
  ppVar2 = &tab_HsmCtx[0].tid;
  iVar1 = 0;
  do {
    if (*ppVar2 == tid) {
      return iVar1;
    }
    iVar1 = iVar1 + 1;
    ppVar2 = ppVar2 + 0x20f;
  } while (iVar1 != 0x200);
  return -1;
}



// WARNING: Unknown calling convention

int WaitHsmResponse(int nIndex,int nTimer,char *szBuffer)

{
  pthread_mutex_t *__mutex;
  int iVar1;
  int iVar2;
  uint *puVar3;
  timeval tv;
  timespec ts;
  
  tab_HsmCtx[nIndex].flag_bal = -200;
  iVar2 = gettimeofday((timeval *)&tv,(__timezone_ptr_t)0x0);
  if (iVar2 < 0) {
    puVar3 = (uint *)__errno_location();
    fprintf(stderr,"gettimeofday Error : %d\n",(ulong)*puVar3);
    iVar2 = -1;
  }
  else {
    ts.tv_sec = nTimer + tv.tv_sec;
    __mutex = &tab_HsmCtx[nIndex].HsmMutex;
    ts.tv_nsec = tv.tv_usec * 1000;
    pthread_mutex_lock((pthread_mutex_t *)__mutex);
    iVar2 = pthread_cond_timedwait
                      ((pthread_cond_t *)&tab_HsmCtx[nIndex].HsmCond,(pthread_mutex_t *)__mutex,
                       (timespec *)&ts);
    if (iVar2 < 0) {
      tab_HsmCtx[nIndex].flag_bal = -1;
      iVar2 = -1;
    }
    else if (iVar2 == 0x6e) {
      tab_HsmCtx[nIndex].flag_bal = -100;
      iVar2 = -100;
    }
    else {
      iVar1 = tab_HsmCtx[nIndex].nLenBal;
      tab_HsmCtx[nIndex].flag_bal = 0;
      iVar2 = 0;
      memcpy(szBuffer,tab_HsmCtx + nIndex,(long)iVar1);
    }
    pthread_mutex_unlock((pthread_mutex_t *)__mutex);
  }
  return iVar2;
}



// WARNING: Unknown calling convention

int InfoHsmThread(int nIndex)

{
  pthread_mutex_lock((pthread_mutex_t *)&tab_HsmCtx[nIndex].HsmMutex);
  pthread_cond_signal((pthread_cond_t *)&tab_HsmCtx[nIndex].HsmCond);
  pthread_mutex_unlock((pthread_mutex_t *)&tab_HsmCtx[nIndex].HsmMutex);
  return 0;
}



// WARNING: Unknown calling convention

void * thread_HSM(void *arg)

{
  int nIndex;
  uint uVar1;
  int iVar2;
  int iVar3;
  pthread_t __th;
  void *pvVar4;
  int iVar5;
  TSHsmExchange sBalMsg;
  
  iVar5 = 0;
  __th = pthread_self();
  pthread_detach(__th);
  ThreadMaskSignals();
  do {
    uVar1 = getpid();
    iVar2 = ReadBalHsm(nBalHsm,(ulong)uVar1,0,&sBalMsg);
    if (iVar2 < 0) {
      iVar5 = iVar5 + 1;
      trace_event("* ReadBalHsm .... Error Reading Message",5);
      if (iVar5 == 10) {
        trace_event("* ABOUT TO EXIT THE PROGRAM *",5);
                    // WARNING: Subroutine does not return
        exit(0);
      }
    }
    if ((uint)sBalMsg.sHeader.nIndex < 0x200) {
      iVar3 = CmpCoNumber(sBalMsg.sHeader.nIndex,sBalMsg.sHeader.nCoNumber);
      nIndex = sBalMsg.sHeader.nIndex;
      iVar2 = sBalMsg.sHeader.nLen;
      if (iVar3 == 0) {
        pvVar4 = memcpy(tab_HsmCtx + sBalMsg.sHeader.nIndex,sBalMsg.sBody,(long)sBalMsg.sHeader.nLen
                       );
        *(int *)((long)pvVar4 + 0x1000) = iVar2;
        InfoHsmThread(nIndex);
      }
    }
  } while( true );
}



// WARNING: Unknown calling convention

int translate_key_scheme
              (int nIndexCtx,char *Zmk_Key,char *Zpk_Zmk,char *Check_Value_In,char *Zpk_Lmk,
              char *Check_Value_Out,char *sAttalaVar)

{
  int iVar1;
  size_t __n;
  long lVar2;
  char *pcVar3;
  pid_t nPid;
  char sHsmResultCode [5];
  char sLMKId [8];
  char ligne [512];
  char BuffSnd [1516];
  char BuffRcv [1516];
  
  Check_Value_Out[0] = '\0';
  Check_Value_Out[1] = '\0';
  Check_Value_Out[2] = '\0';
  Check_Value_Out[3] = '\0';
  Check_Value_Out[4] = '\0';
  Check_Value_Out[5] = '\0';
  Check_Value_Out[6] = '\0';
  Check_Value_Out[7] = '\0';
  Check_Value_Out[8] = '\0';
  Check_Value_Out[9] = '\0';
  Check_Value_Out[10] = '\0';
  Check_Value_Out[0xb] = '\0';
  Check_Value_Out[0xc] = '\0';
  Check_Value_Out[0xd] = '\0';
  Check_Value_Out[0xe] = '\0';
  Check_Value_Out[0xf] = '\0';
  sHsmResultCode[0] = '\0';
  sHsmResultCode[1] = '\0';
  sHsmResultCode[2] = '\0';
  sHsmResultCode[3] = '\0';
  sHsmResultCode[4] = '\0';
  sLMKId[0] = '\0';
  sLMKId[1] = '\0';
  sLMKId[2] = '\0';
  sLMKId[3] = '\0';
  sLMKId[4] = '\0';
  sLMKId[5] = '\0';
  sLMKId[6] = '\0';
  sLMKId[7] = '\0';
  pcVar3 = BuffSnd;
  for (lVar2 = 0xbd; lVar2 != 0; lVar2 = lVar2 + -1) {
    pcVar3[0] = '\0';
    pcVar3[1] = '\0';
    pcVar3[2] = '\0';
    pcVar3[3] = '\0';
    pcVar3[4] = '\0';
    pcVar3[5] = '\0';
    pcVar3[6] = '\0';
    pcVar3[7] = '\0';
    pcVar3 = pcVar3 + 8;
  }
  pcVar3[0] = '\0';
  pcVar3[1] = '\0';
  pcVar3[2] = '\0';
  pcVar3[3] = '\0';
  pcVar3 = BuffRcv;
  for (lVar2 = 0xbd; lVar2 != 0; lVar2 = lVar2 + -1) {
    pcVar3[0] = '\0';
    pcVar3[1] = '\0';
    pcVar3[2] = '\0';
    pcVar3[3] = '\0';
    pcVar3[4] = '\0';
    pcVar3[5] = '\0';
    pcVar3[6] = '\0';
    pcVar3[7] = '\0';
    pcVar3 = pcVar3 + 8;
  }
  pcVar3[0] = '\0';
  pcVar3[1] = '\0';
  pcVar3[2] = '\0';
  pcVar3[3] = '\0';
  if (debug_option == 1) {
    sprintf(ligne,"Start translate_key_scheme(%.32s, %.32s, %.16s)",Zmk_Key,Zpk_Zmk,Check_Value_In);
  }
  else {
    sprintf(ligne,"Start translate_key_scheme(%.16s)",Check_Value_In);
  }
  trace_event(ligne,5);
  if (*Zmk_Key == 'S') {
    sLMKId._0_2_ = *(undefined2 *)(Zmk_Key + 0xf);
    command_A6(BuffSnd,"FFF",Zmk_Key,Zpk_Zmk,"72","N","00","S",sLMKId,sAttalaVar);
    if (debug_option == 1) {
      sprintf(ligne,"BuffSnd[%.100s]",BuffSnd);
      trace_event(ligne,5);
    }
    iVar1 = CheckResource(nIndexCtx,"070000",&nPid);
    if (iVar1 == 0) {
      iVar1 = HsmQuery(nIndexCtx,nPid,BuffSnd,BuffRcv);
      if (iVar1 == 0x3ef) {
        iVar1 = 9;
        trace_event("HSM NOT AVAILABLE",1);
        trace_event("End   translate_key_scheme(NOT_AVAILABLE)",5);
      }
      else if (iVar1 == 3) {
        iVar1 = 9;
        trace_event("HSM MALFUNCTION DETECTED",1);
        trace_event("End   translate_key_scheme(MALFUNCTION)",5);
      }
      else {
        iVar1 = command_A7(BuffRcv,Zpk_Lmk,Check_Value_Out);
        pcVar3 = "HSM Abnormal  DETECTED";
        if (iVar1 == 0) {
          __n = strlen(Check_Value_In);
          iVar1 = memcmp(Check_Value_Out,Check_Value_In,__n);
          if (iVar1 == 0) {
            trace_event("End   translate_key_scheme(OK)",5);
            return 0;
          }
          pcVar3 = "CHECK VALUES ARE DIFFERENT";
        }
        iVar1 = 2;
        trace_event(pcVar3,1);
        trace_event("End   translate_key_scheme(CRYPTOGRAPHIC_ERROR)",5);
      }
    }
    else {
      iVar1 = 9;
      trace_event("Resource HSM VERIF Unavailable",1);
    }
  }
  else {
    iVar1 = -1;
    trace_event("Invalid ZMK Key scheme",1);
    trace_event("End   translate_key_scheme(NOK)",5);
  }
  return iVar1;
}



// WARNING: Unknown calling convention

int key_exchange_scheme(int nIndexCtx,char *Zmk_Key,char *Zpk_Zmk,char *Check_Value_In,char *Zpk_Lmk
                       ,char *Check_Value_Out)

{
  int iVar1;
  
  iVar1 = translate_key_scheme(nIndexCtx,Zmk_Key,Zpk_Zmk,Check_Value_In,Zpk_Lmk,Check_Value_Out,"");
  return iVar1;
}



// WARNING: Unknown calling convention

int key_exchange_scheme2
              (int nIndexCtx,char *Zmk_Key,char *Zpk_Zmk,char *Check_Value_In,char *Zpk_Lmk,
              char *Check_Value_Out)

{
  int iVar1;
  long lVar2;
  char *pcVar3;
  pid_t nPid;
  char sHsmResultCode [5];
  char BuffSnd [128];
  char BuffRcv [128];
  char ligne [512];
  
  Check_Value_Out[0] = '\0';
  Check_Value_Out[1] = '\0';
  Check_Value_Out[2] = '\0';
  Check_Value_Out[3] = '\0';
  Check_Value_Out[4] = '\0';
  Check_Value_Out[5] = '\0';
  Check_Value_Out[6] = '\0';
  Check_Value_Out[7] = '\0';
  Check_Value_Out[8] = '\0';
  Check_Value_Out[9] = '\0';
  Check_Value_Out[10] = '\0';
  Check_Value_Out[0xb] = '\0';
  Check_Value_Out[0xc] = '\0';
  Check_Value_Out[0xd] = '\0';
  Check_Value_Out[0xe] = '\0';
  Check_Value_Out[0xf] = '\0';
  sHsmResultCode[0] = '\0';
  sHsmResultCode[1] = '\0';
  sHsmResultCode[2] = '\0';
  sHsmResultCode[3] = '\0';
  sHsmResultCode[4] = '\0';
  pcVar3 = BuffSnd;
  for (lVar2 = 0x10; lVar2 != 0; lVar2 = lVar2 + -1) {
    pcVar3[0] = '\0';
    pcVar3[1] = '\0';
    pcVar3[2] = '\0';
    pcVar3[3] = '\0';
    pcVar3[4] = '\0';
    pcVar3[5] = '\0';
    pcVar3[6] = '\0';
    pcVar3[7] = '\0';
    pcVar3 = pcVar3 + 8;
  }
  pcVar3 = BuffRcv;
  for (lVar2 = 0x10; lVar2 != 0; lVar2 = lVar2 + -1) {
    pcVar3[0] = '\0';
    pcVar3[1] = '\0';
    pcVar3[2] = '\0';
    pcVar3[3] = '\0';
    pcVar3[4] = '\0';
    pcVar3[5] = '\0';
    pcVar3[6] = '\0';
    pcVar3[7] = '\0';
    pcVar3 = pcVar3 + 8;
  }
  if (debug_option == 1) {
    sprintf(ligne,"Start key_exchange_scheme2(%.32s, %.32s, %.16s)",Zmk_Key,Zpk_Zmk,Check_Value_In);
  }
  else {
    builtin_strncpy(ligne + 0x18,"e2()",5);
    builtin_strncpy(ligne,"Start key_exchange_schem",0x18);
  }
  trace_event(ligne,5);
  command_FA(BuffSnd,Zmk_Key,Zpk_Zmk);
  iVar1 = CheckResource(nIndexCtx,"070000",&nPid);
  if (iVar1 == 0) {
    if (debug_option == 1) {
      sprintf(ligne," translation_lib.c -->  BuffSnd[%.100s]",BuffSnd);
      trace_event(ligne,5);
    }
    iVar1 = HsmQuery(nIndexCtx,nPid,BuffSnd,BuffRcv);
    if (iVar1 == 0x3ef) {
      iVar1 = 9;
      trace_event("HSM NOT AVAILABLE",1);
      trace_event("End   key_exchange_scheme2(NOT_AVAILABLE)",5);
    }
    else if (iVar1 == 3) {
      iVar1 = 9;
      trace_event("HSM MALFUNCTION DETECTED",1);
      trace_event("End   key_exchange_scheme2(MALFUNCTION)",5);
    }
    else {
      iVar1 = command_FB(BuffRcv,Zpk_Lmk,Check_Value_Out,sHsmResultCode);
      if (iVar1 == 0) {
        trace_event("End   key_exchange_scheme2(OK)",5);
        iVar1 = 0;
      }
      else {
        iVar1 = 2;
        trace_event("HSM Abnormal  DETECTED",1);
        trace_event("End   key_exchange_scheme2(CRYPTOGRAPHIC_ERROR)",5);
      }
    }
  }
  else {
    iVar1 = 9;
    trace_event("Resource HSM VERIF Unavailable",1);
  }
  return iVar1;
}



// WARNING: Unknown calling convention

int pin_translate(int nIndiceCtx,char *card,char *transkey,char *zpk,char *pin,char *format_in,
                 char *format_out,char mode)

{
  int iVar1;
  long lVar2;
  char *pcVar3;
  byte bVar4;
  pid_t nPid;
  char sHsmResultCode [5];
  char ligne [512];
  char BuffSnd [1516];
  char BuffRcv [1516];
  
  bVar4 = 0;
  sHsmResultCode[0] = '\0';
  sHsmResultCode[1] = '\0';
  sHsmResultCode[2] = '\0';
  sHsmResultCode[3] = '\0';
  sHsmResultCode[4] = '\0';
  if (debug_option == 1) {
    sprintf(ligne,"Start pin_translate(%.22s,%s,%s,%.16s,%.2s,%.2s,%c)",card,transkey,zpk,pin,
            format_in,format_out,(int)mode);
  }
  else {
    builtin_strncpy(ligne,"Start pin_translate()",0x16);
  }
  trace_event(ligne,5);
  sprintf(ligne,"formatou  %.2s",format_out);
  trace_event(ligne,5);
  pcVar3 = BuffSnd;
  for (lVar2 = 0xbd; lVar2 != 0; lVar2 = lVar2 + -1) {
    pcVar3[0] = '\0';
    pcVar3[1] = '\0';
    pcVar3[2] = '\0';
    pcVar3[3] = '\0';
    pcVar3[4] = '\0';
    pcVar3[5] = '\0';
    pcVar3[6] = '\0';
    pcVar3[7] = '\0';
    pcVar3 = pcVar3 + (ulong)bVar4 * -0x10 + 8;
  }
  pcVar3[0] = '\0';
  pcVar3[1] = '\0';
  pcVar3[2] = '\0';
  pcVar3[3] = '\0';
  pcVar3 = BuffRcv;
  for (lVar2 = 0xbd; lVar2 != 0; lVar2 = lVar2 + -1) {
    pcVar3[0] = '\0';
    pcVar3[1] = '\0';
    pcVar3[2] = '\0';
    pcVar3[3] = '\0';
    pcVar3[4] = '\0';
    pcVar3[5] = '\0';
    pcVar3[6] = '\0';
    pcVar3[7] = '\0';
    pcVar3 = pcVar3 + (ulong)bVar4 * -0x10 + 8;
  }
  pcVar3[0] = '\0';
  pcVar3[1] = '\0';
  pcVar3[2] = '\0';
  pcVar3[3] = '\0';
  if (mode == 'T') {
    command_CA(BuffSnd,transkey,zpk,pin,format_in,format_out,card);
  }
  else {
    command_CC(BuffSnd,transkey,zpk,pin,format_in,format_out,card);
  }
  sprintf(ligne,"transkey pin_translate(%s)",transkey);
  trace_event(ligne,5);
  iVar1 = CheckResource(nIndiceCtx,"070000",&nPid);
  if (iVar1 == 0) {
    iVar1 = HsmQuery(nIndiceCtx,nPid,BuffSnd,BuffRcv);
    pcVar3 = "HSM NOT AVAILABLE";
    if (iVar1 != 0x3ef) {
      if (iVar1 != 3) {
        if (mode == 'T') {
          iVar1 = command_CB(BuffRcv,pin,sHsmResultCode);
        }
        else {
          iVar1 = command_CD(BuffRcv,pin,sHsmResultCode);
        }
        if (iVar1 != 0) {
          trace_event("End   pin_translate(NOK)",5);
          return 2;
        }
        trace_event("End   pin_translate(OK)",5);
        return 0;
      }
      pcVar3 = "HSM MALFUNCTION DETECTED";
    }
    trace_event(pcVar3,1);
    trace_event("End   pin_translate()",5);
  }
  else {
    trace_event("HSM FOR TRANSLATION NOT AVAILABLE",1);
    trace_event("End   pin_translate(MALFUNCTION)",5);
  }
  return 9;
}



// WARNING: Unknown calling convention

int TranslateAwkFromZmkToLmk(int nIndexCtx,char *Zmk,char *AwkZmk,char *AwkLmk,char *tmpFieldLen)

{
  int iVar1;
  uint uVar2;
  uint uVar3;
  long lVar4;
  uint *puVar5;
  uint *puVar6;
  char *pcVar7;
  bool bVar8;
  pid_t nPid;
  char sHsmResultCode [5];
  char CheckValue [17];
  char Key [17];
  char BuffSnd [128];
  char BuffRcv [128];
  char ligne [512];
  
  sHsmResultCode[0] = '\0';
  sHsmResultCode[1] = '\0';
  sHsmResultCode[2] = '\0';
  sHsmResultCode[3] = '\0';
  sHsmResultCode[4] = '\0';
  CheckValue[0] = '\0';
  CheckValue[1] = '\0';
  CheckValue[2] = '\0';
  CheckValue[3] = '\0';
  CheckValue[4] = '\0';
  CheckValue[5] = '\0';
  CheckValue[6] = '\0';
  CheckValue[7] = '\0';
  CheckValue[8] = '\0';
  CheckValue[9] = '\0';
  CheckValue[10] = '\0';
  CheckValue[0xb] = '\0';
  CheckValue[0xc] = '\0';
  CheckValue[0xd] = '\0';
  CheckValue[0xe] = '\0';
  CheckValue[0xf] = '\0';
  pcVar7 = BuffSnd;
  for (lVar4 = 0x10; lVar4 != 0; lVar4 = lVar4 + -1) {
    pcVar7[0] = '\0';
    pcVar7[1] = '\0';
    pcVar7[2] = '\0';
    pcVar7[3] = '\0';
    pcVar7[4] = '\0';
    pcVar7[5] = '\0';
    pcVar7[6] = '\0';
    pcVar7[7] = '\0';
    pcVar7 = pcVar7 + 8;
  }
  CheckValue[0x10] = '\0';
  Key[0] = '\0';
  Key[1] = '\0';
  Key[2] = '\0';
  Key[3] = '\0';
  Key[4] = '\0';
  Key[5] = '\0';
  Key[6] = '\0';
  Key[7] = '\0';
  Key[8] = '\0';
  Key[9] = '\0';
  Key[10] = '\0';
  Key[0xb] = '\0';
  Key[0xc] = '\0';
  Key[0xd] = '\0';
  Key[0xe] = '\0';
  Key[0xf] = '\0';
  Key[0x10] = '\0';
  pcVar7 = BuffRcv;
  for (lVar4 = 0x10; lVar4 != 0; lVar4 = lVar4 + -1) {
    pcVar7[0] = '\0';
    pcVar7[1] = '\0';
    pcVar7[2] = '\0';
    pcVar7[3] = '\0';
    pcVar7[4] = '\0';
    pcVar7[5] = '\0';
    pcVar7[6] = '\0';
    pcVar7[7] = '\0';
    pcVar7 = pcVar7 + 8;
  }
  if (debug_option == 1) {
    sprintf(ligne,"Start TranslateAwkFromZmkToLmk (%.16s, %.16s)",Zmk,AwkZmk);
  }
  else {
    builtin_strncpy(ligne,"Start TranslateAwkFromZmkToLmk ()",0x22);
  }
  trace_event(ligne,5);
  command_FA(BuffSnd,Zmk,AwkZmk);
  iVar1 = CheckResource(nIndexCtx,"070000",&nPid);
  if (iVar1 == 0) {
    iVar1 = HsmQuery(nIndexCtx,nPid,BuffSnd,BuffRcv);
    if (iVar1 == 0x3ef) {
      iVar1 = 9;
      trace_event("HSM NOT AVAILABLE",1);
      trace_event("End   TranslateAwkFromZmkToLmk(NOT_AVAILABLE)",5);
    }
    else if (iVar1 == 3) {
      iVar1 = 9;
      trace_event("HSM MALFUNCTION DETECTED",1);
      trace_event("End   TranslateAwkFromZmkToLmk(MALFUNCTION)",5);
    }
    else {
      iVar1 = command_FB(BuffRcv,Key,CheckValue,sHsmResultCode);
      puVar6 = (uint *)Key;
      if (iVar1 == 0) {
        do {
          puVar5 = puVar6;
          uVar2 = *puVar5 + 0xfefefeff & ~*puVar5;
          uVar3 = uVar2 & 0x80808080;
          puVar6 = puVar5 + 1;
        } while (uVar3 == 0);
        bVar8 = (uVar2 & 0x8080) == 0;
        if (bVar8) {
          uVar3 = uVar3 >> 0x10;
        }
        if (bVar8) {
          puVar6 = (uint *)((long)puVar5 + 6);
        }
        pcVar7 = (char *)((long)puVar6 + ((-3 - (ulong)CARRY1((byte)uVar3,(byte)uVar3)) - (long)Key)
                         );
        memcpy(AwkLmk,Key,(size_t)pcVar7);
        *tmpFieldLen = (char)pcVar7;
        trace_event("End   TranslateAwkFromZmkToLmk(OK)",5);
        iVar1 = 0;
      }
      else {
        iVar1 = 2;
        trace_event("HSM Abnormal  DETECTED",1);
        trace_event("End   TranslateAwkFromZmkToLmk(CRYPTOGRAPHIC_ERROR)",5);
      }
    }
  }
  else {
    iVar1 = 9;
    trace_event("End   TranslateAwkFromZmkToLmk(TranslateAwkFromZmkToLmk)",1);
  }
  return iVar1;
}



// WARNING: Unknown calling convention

int TpkFromZmkToLmk(int nIndexCtx,uchar *pZmkKey,uchar *pTpkKey,uchar *pTpkLmk)

{
  int iVar1;
  long lVar2;
  uchar *puVar3;
  byte bVar4;
  uchar lErrCode [3];
  pid_t nPid;
  char check_out [7];
  char sLMKId [8];
  char sLine [512];
  uchar lHsmBuffIn [4096];
  uchar lHsmBuffOut [4096];
  
  bVar4 = 0;
  if (debug_option == 1) {
    sprintf(sLine,"Start TpkFromZmkToLmk(%.32s,%.32s)",pZmkKey,pTpkKey);
  }
  else {
    builtin_strncpy(sLine,"Start TpkFromZmkToLmk()",0x18);
  }
  trace_event(sLine,5);
  sprintf(sLine,"MFR1...TpkFromZmkToLmk_pZmkKey (%.64s)",pZmkKey);
  trace_event(sLine,5);
  sprintf(sLine,"MFR2...TpkFromZmkToLmk_pTpkKey (%.64s)",pTpkKey);
  trace_event(sLine,5);
  puVar3 = lHsmBuffIn;
  for (lVar2 = 0x200; lVar2 != 0; lVar2 = lVar2 + -1) {
    puVar3[0] = '\0';
    puVar3[1] = '\0';
    puVar3[2] = '\0';
    puVar3[3] = '\0';
    puVar3[4] = '\0';
    puVar3[5] = '\0';
    puVar3[6] = '\0';
    puVar3[7] = '\0';
    puVar3 = puVar3 + (ulong)bVar4 * -0x10 + 8;
  }
  sLMKId[0] = '\0';
  sLMKId[1] = '\0';
  sLMKId[2] = '\0';
  sLMKId[3] = '\0';
  sLMKId[4] = '\0';
  sLMKId[5] = '\0';
  sLMKId[6] = '\0';
  sLMKId[7] = '\0';
  puVar3 = lHsmBuffOut;
  for (lVar2 = 0x200; lVar2 != 0; lVar2 = lVar2 + -1) {
    puVar3[0] = '\0';
    puVar3[1] = '\0';
    puVar3[2] = '\0';
    puVar3[3] = '\0';
    puVar3[4] = '\0';
    puVar3[5] = '\0';
    puVar3[6] = '\0';
    puVar3[7] = '\0';
    puVar3 = puVar3 + (ulong)bVar4 * -0x10 + 8;
  }
  if (*pZmkKey == 'S') {
    sLMKId[2] = '\0';
    sLMKId[3] = '\0';
    sLMKId[4] = '\0';
    sLMKId[5] = '\0';
    sLMKId[6] = '\0';
    sLMKId[7] = '\0';
    sLMKId._0_2_ = *(ushort *)(pZmkKey + 0xf);
    command_A6((char *)lHsmBuffIn,"FFF",(char *)pZmkKey,(char *)pTpkKey,"71","N","00","S",sLMKId,"")
    ;
    iVar1 = CheckResource(nIndexCtx,"070000",&nPid);
    if ((iVar1 == 0) &&
       (iVar1 = HsmQuery(nIndexCtx,nPid,(char *)lHsmBuffIn,(char *)lHsmBuffOut), iVar1 != 0x3ef)) {
      if (iVar1 == 3) {
        trace_event("HSM MALFUNCTION DETECTED",1);
        trace_event("End   TpkFromZmkToLmk(SYSTEM_MALFUNCTION)",5);
        return 3;
      }
      iVar1 = command_A7((char *)lHsmBuffOut,(char *)pTpkLmk,check_out);
      if (iVar1 == 0) {
        if (debug_option == 1) {
          sprintf(sLine,"End   TpkFomZmkToLmk(%.32s)",pTpkLmk);
        }
        else {
          builtin_strncpy(sLine,"End   TpkFomZmkToLmk(OK)",0x19);
        }
        sprintf(sLine,"End   TpkFomZmkToLmk(%.32s)",pTpkLmk);
        trace_event(sLine,5);
        return 0;
      }
      trace_event("HSM Abnormal  DETECTED",1);
      trace_event("End   TpkZmkToLmk(CRYPTOGRAPHIC_ERROR)",5);
      return 2;
    }
    trace_event("HSM FOR VERIFICATION NOT AVAILABLE",1);
    trace_event("End   TpkFromZmkToLmk(HSM_UNAVAILABLE)",5);
    iVar1 = 9;
  }
  else {
    trace_event("Invalid ZMK Key scheme",1);
    trace_event("End   TpkFromZmkToLmk(NOK)",5);
    iVar1 = -1;
  }
  return iVar1;
}



// WARNING: Unknown calling convention

int export_key(int nIndexCtx,char *transKeyLmk,char *keyLmk,char *keyType,char *KeyZmk,
              char *Check_Value_Out)

{
  int iVar1;
  long lVar2;
  char *pcVar3;
  pid_t nPid;
  char ligne [512];
  char BuffSnd [1516];
  char BuffRcv [1516];
  
  Check_Value_Out[0] = '\0';
  Check_Value_Out[1] = '\0';
  Check_Value_Out[2] = '\0';
  Check_Value_Out[3] = '\0';
  Check_Value_Out[4] = '\0';
  Check_Value_Out[5] = '\0';
  Check_Value_Out[6] = '\0';
  Check_Value_Out[7] = '\0';
  Check_Value_Out[8] = '\0';
  Check_Value_Out[9] = '\0';
  Check_Value_Out[10] = '\0';
  Check_Value_Out[0xb] = '\0';
  Check_Value_Out[0xc] = '\0';
  Check_Value_Out[0xd] = '\0';
  Check_Value_Out[0xe] = '\0';
  Check_Value_Out[0xf] = '\0';
  pcVar3 = BuffSnd;
  for (lVar2 = 0xbd; lVar2 != 0; lVar2 = lVar2 + -1) {
    pcVar3[0] = '\0';
    pcVar3[1] = '\0';
    pcVar3[2] = '\0';
    pcVar3[3] = '\0';
    pcVar3[4] = '\0';
    pcVar3[5] = '\0';
    pcVar3[6] = '\0';
    pcVar3[7] = '\0';
    pcVar3 = pcVar3 + 8;
  }
  pcVar3[0] = '\0';
  pcVar3[1] = '\0';
  pcVar3[2] = '\0';
  pcVar3[3] = '\0';
  pcVar3 = BuffRcv;
  for (lVar2 = 0xbd; lVar2 != 0; lVar2 = lVar2 + -1) {
    pcVar3[0] = '\0';
    pcVar3[1] = '\0';
    pcVar3[2] = '\0';
    pcVar3[3] = '\0';
    pcVar3[4] = '\0';
    pcVar3[5] = '\0';
    pcVar3[6] = '\0';
    pcVar3[7] = '\0';
    pcVar3 = pcVar3 + 8;
  }
  pcVar3[0] = '\0';
  pcVar3[1] = '\0';
  pcVar3[2] = '\0';
  pcVar3[3] = '\0';
  command_A8(BuffSnd,keyType,transKeyLmk,keyLmk);
  if (debug_option == 1) {
    sprintf(ligne,"BuffSnd[%.100s]",BuffSnd);
    trace_event(ligne,5);
  }
  iVar1 = CheckResource(nIndexCtx,(char *)0x1,&nPid);
  if (iVar1 == 0) {
    iVar1 = HsmQuery(nIndexCtx,nPid,BuffSnd,BuffRcv);
    if (iVar1 == 0x3ef) {
      trace_event("HSM NOT AVAILABLE",1);
      trace_event("End   export_key(NOT_AVAILABLE)",5);
      iVar1 = 9;
    }
    else if (iVar1 == 3) {
      trace_event("HSM MALFUNCTION DETECTED",1);
      trace_event("End   export_key(MALFUNCTION)",5);
      iVar1 = 9;
    }
    else {
      iVar1 = command_A9(BuffRcv,KeyZmk,Check_Value_Out);
      if (iVar1 != 0) {
        trace_event("HSM Abnormal  DETECTED",1);
        trace_event("End   export_key(CRYPTOGRAPHIC_ERROR)",5);
        iVar1 = 2;
      }
    }
  }
  else {
    trace_event("Resource HSM VERIF Unavailable",1);
    iVar1 = 9;
  }
  return iVar1;
}



// WARNING: Unknown calling convention

int check_cavv_data(int nIndiceCtx,char *Pan,char *cavv_data,char *sHsmResultCode)

{
  int iVar1;
  long lVar2;
  uchar *puVar3;
  char *pcVar4;
  char autho_result [2];
  char second_factor [3];
  char key_indicator [3];
  char cavv_value [4];
  char service_code [4];
  pid_t nPid;
  char atn [5];
  char cavv_key [257];
  char CvkA [257];
  char CvkB [257];
  char sLine [512];
  uchar BuffSnd [1516];
  uchar BuffRcv [1516];
  
  pcVar4 = sLine;
  for (lVar2 = 0x40; lVar2 != 0; lVar2 = lVar2 + -1) {
    pcVar4[0] = '\0';
    pcVar4[1] = '\0';
    pcVar4[2] = '\0';
    pcVar4[3] = '\0';
    pcVar4[4] = '\0';
    pcVar4[5] = '\0';
    pcVar4[6] = '\0';
    pcVar4[7] = '\0';
    pcVar4 = pcVar4 + 8;
  }
  autho_result[0] = '\0';
  autho_result[1] = '\0';
  second_factor[0] = '\0';
  second_factor[1] = '\0';
  cavv_value[0] = '\0';
  cavv_value[1] = '\0';
  cavv_value[2] = '\0';
  cavv_value[3] = '\0';
  atn[0] = '\0';
  atn[1] = '\0';
  atn[2] = '\0';
  atn[3] = '\0';
  atn[4] = '\0';
  puVar3 = BuffSnd;
  for (lVar2 = 0xbd; lVar2 != 0; lVar2 = lVar2 + -1) {
    puVar3[0] = '\0';
    puVar3[1] = '\0';
    puVar3[2] = '\0';
    puVar3[3] = '\0';
    puVar3[4] = '\0';
    puVar3[5] = '\0';
    puVar3[6] = '\0';
    puVar3[7] = '\0';
    puVar3 = puVar3 + 8;
  }
  second_factor[2] = '\0';
  service_code[0] = '\0';
  service_code[1] = '\0';
  service_code[2] = '\0';
  service_code[3] = '\0';
  puVar3[0] = '\0';
  puVar3[1] = '\0';
  puVar3[2] = '\0';
  puVar3[3] = '\0';
  puVar3 = BuffRcv;
  for (lVar2 = 0xbd; lVar2 != 0; lVar2 = lVar2 + -1) {
    puVar3[0] = '\0';
    puVar3[1] = '\0';
    puVar3[2] = '\0';
    puVar3[3] = '\0';
    puVar3[4] = '\0';
    puVar3[5] = '\0';
    puVar3[6] = '\0';
    puVar3[7] = '\0';
    puVar3 = puVar3 + 8;
  }
  puVar3[0] = '\0';
  puVar3[1] = '\0';
  puVar3[2] = '\0';
  puVar3[3] = '\0';
  pcVar4 = cavv_key;
  for (lVar2 = 0x20; lVar2 != 0; lVar2 = lVar2 + -1) {
    pcVar4[0] = '\0';
    pcVar4[1] = '\0';
    pcVar4[2] = '\0';
    pcVar4[3] = '\0';
    pcVar4[4] = '\0';
    pcVar4[5] = '\0';
    pcVar4[6] = '\0';
    pcVar4[7] = '\0';
    pcVar4 = pcVar4 + 8;
  }
  *pcVar4 = '\0';
  pcVar4 = CvkA;
  for (lVar2 = 0x20; lVar2 != 0; lVar2 = lVar2 + -1) {
    pcVar4[0] = '\0';
    pcVar4[1] = '\0';
    pcVar4[2] = '\0';
    pcVar4[3] = '\0';
    pcVar4[4] = '\0';
    pcVar4[5] = '\0';
    pcVar4[6] = '\0';
    pcVar4[7] = '\0';
    pcVar4 = pcVar4 + 8;
  }
  *pcVar4 = '\0';
  pcVar4 = CvkB;
  for (lVar2 = 0x20; lVar2 != 0; lVar2 = lVar2 + -1) {
    pcVar4[0] = '\0';
    pcVar4[1] = '\0';
    pcVar4[2] = '\0';
    pcVar4[3] = '\0';
    pcVar4[4] = '\0';
    pcVar4[5] = '\0';
    pcVar4[6] = '\0';
    pcVar4[7] = '\0';
    pcVar4 = pcVar4 + 8;
  }
  *pcVar4 = '\0';
  key_indicator[2] = '\0';
  key_indicator[0] = '\0';
  key_indicator[1] = '\0';
  trace_event("Start check_cavv_data()",5);
  autho_result = *(char (*) [2])(cavv_data + 1);
  second_factor._0_2_ = *(undefined2 *)(cavv_data + 2);
  key_indicator._0_2_ = *(undefined2 *)(cavv_data + 4);
  cavv_value._0_3_ = *(undefined3 *)(cavv_data + 7);
  atn._0_4_ = *(undefined4 *)(cavv_data + 10);
  iVar1 = memcmp(key_indicator,&DAT_004d1ee1,2);
  if ((((iVar1 == 0) || (iVar1 = memcmp(key_indicator,&DAT_004d1efb,2), iVar1 == 0)) ||
      (iVar1 = memcmp(key_indicator,&DAT_004d1f75,2), iVar1 == 0)) ||
     (iVar1 = memcmp(key_indicator,&DAT_004d1fb6,2), iVar1 == 0)) {
    trace_event("CAVV GENERATED BY NETWORK: Not to be checked",5);
    builtin_strncpy(sHsmResultCode,"CZ00",4);
  }
  else {
    iVar1 = Get_CAVV_Key(nIndiceCtx,Pan,key_indicator,CvkA,CvkB);
    if (iVar1 != 0) {
      builtin_strncpy(sHsmResultCode,"UNVL",4);
      return 9;
    }
    if (debug_option == 1) {
      sprintf(sLine,"RESULT CODE                 : %.1s",autho_result);
      trace_event(sLine,5);
      sprintf(sLine,"SECOND FACTOR               : %.2s",second_factor);
      trace_event(sLine,5);
      sprintf(sLine,"ATN                         : %.4s",atn);
      trace_event(sLine,5);
      sprintf(sLine,"CAVV_KEY                    : %.32s",cavv_key);
      trace_event(sLine,5);
      sprintf(sLine,"CAVV                        : %.3s",cavv_value);
      trace_event(sLine,5);
      trace_event("- CAVV Verification ---------------",5);
    }
    else {
      trace_event("- CAVV Verification ---------------",5);
    }
    service_code[1] = second_factor[0];
    service_code[2] = second_factor[1];
    service_code[0] = autho_result[0];
    command_CY((char *)BuffSnd,Pan,service_code,atn,CvkA,CvkB,cavv_value);
    iVar1 = CheckResource(nIndiceCtx,"070000",&nPid);
    if ((iVar1 != 0) ||
       (iVar1 = HsmQuery(nIndiceCtx,nPid,(char *)BuffSnd,(char *)BuffRcv), iVar1 == 0x3ef)) {
      builtin_strncpy(sHsmResultCode,"UNVL",4);
      trace_event("HSM FOR VERIFICATION NOT AVAILABLE",1);
      trace_event("End   check_cavv_data(HSM_UNAVAILABLE)",5);
      return 9;
    }
    if (iVar1 == 3) {
      builtin_strncpy(sHsmResultCode,"UNVL",4);
      trace_event("HSM MALFUNCTION DETECTED",1);
      trace_event("End   check_cavv_data(MALFUNCTION)",5);
      return 3;
    }
    iVar1 = command_CZ((char *)BuffRcv,sHsmResultCode);
    if (iVar1 != 0) {
      if (iVar1 == 1) {
        trace_event("End   check_cavv_data(VERIFICATION_FAILED)",5);
        return 1;
      }
      if (iVar1 == 0x7d1) {
        trace_event("End check_cavv_data(ERROR_COMMAND)",5);
        return 3;
      }
      trace_event("End   check_cavv_data(CRYPTOGRAPHIC_ERROR)",5);
      return 2;
    }
  }
  trace_event("End   check_cavv_data(OK)",5);
  return 0;
}



// WARNING: Unknown calling convention

int check_aav_data(int nIndiceCtx,char *Pan,char *aav_data_b64,char *sHsmResultCode)

{
  undefined8 uVar1;
  int iVar2;
  uint uVar3;
  uint uVar4;
  ulong uVar5;
  long lVar6;
  char *pcVar7;
  uint *puVar8;
  uint *puVar9;
  uchar *puVar10;
  bool bVar11;
  pid_t nPid;
  char aav_value [16];
  char tsn [16];
  char auth_method [16];
  char control_byte [16];
  char key_id [16];
  char service_code [16];
  char str_temp [16];
  uchar BuffRcv [256];
  char aav_data [256];
  char aav_key [257];
  char CvkA [257];
  char CvkB [257];
  char sLine [512];
  uchar BuffSnd [1516];
  
  aav_value[0] = '\0';
  aav_value[1] = '\0';
  aav_value[2] = '\0';
  aav_value[3] = '\0';
  aav_value[4] = '\0';
  aav_value[5] = '\0';
  aav_value[6] = '\0';
  aav_value[7] = '\0';
  pcVar7 = sLine;
  for (lVar6 = 0x40; lVar6 != 0; lVar6 = lVar6 + -1) {
    pcVar7[0] = '\0';
    pcVar7[1] = '\0';
    pcVar7[2] = '\0';
    pcVar7[3] = '\0';
    pcVar7[4] = '\0';
    pcVar7[5] = '\0';
    pcVar7[6] = '\0';
    pcVar7[7] = '\0';
    pcVar7 = pcVar7 + 8;
  }
  aav_value[8] = '\0';
  aav_value[9] = '\0';
  aav_value[10] = '\0';
  aav_value[0xb] = '\0';
  aav_value[0xc] = '\0';
  aav_value[0xd] = '\0';
  aav_value[0xe] = '\0';
  aav_value[0xf] = '\0';
  tsn[0] = '\0';
  tsn[1] = '\0';
  tsn[2] = '\0';
  tsn[3] = '\0';
  tsn[4] = '\0';
  tsn[5] = '\0';
  tsn[6] = '\0';
  tsn[7] = '\0';
  tsn[8] = '\0';
  tsn[9] = '\0';
  tsn[10] = '\0';
  tsn[0xb] = '\0';
  tsn[0xc] = '\0';
  tsn[0xd] = '\0';
  tsn[0xe] = '\0';
  tsn[0xf] = '\0';
  auth_method[0] = '\0';
  auth_method[1] = '\0';
  auth_method[2] = '\0';
  auth_method[3] = '\0';
  auth_method[4] = '\0';
  auth_method[5] = '\0';
  auth_method[6] = '\0';
  auth_method[7] = '\0';
  auth_method[8] = '\0';
  auth_method[9] = '\0';
  auth_method[10] = '\0';
  auth_method[0xb] = '\0';
  auth_method[0xc] = '\0';
  auth_method[0xd] = '\0';
  auth_method[0xe] = '\0';
  auth_method[0xf] = '\0';
  control_byte[0] = '\0';
  control_byte[1] = '\0';
  control_byte[2] = '\0';
  control_byte[3] = '\0';
  control_byte[4] = '\0';
  control_byte[5] = '\0';
  control_byte[6] = '\0';
  control_byte[7] = '\0';
  control_byte[8] = '\0';
  control_byte[9] = '\0';
  control_byte[10] = '\0';
  control_byte[0xb] = '\0';
  control_byte[0xc] = '\0';
  control_byte[0xd] = '\0';
  control_byte[0xe] = '\0';
  control_byte[0xf] = '\0';
  key_id[0] = '\0';
  key_id[1] = '\0';
  key_id[2] = '\0';
  key_id[3] = '\0';
  key_id[4] = '\0';
  key_id[5] = '\0';
  key_id[6] = '\0';
  key_id[7] = '\0';
  key_id[8] = '\0';
  key_id[9] = '\0';
  key_id[10] = '\0';
  key_id[0xb] = '\0';
  key_id[0xc] = '\0';
  key_id[0xd] = '\0';
  key_id[0xe] = '\0';
  key_id[0xf] = '\0';
  service_code[0] = '\0';
  service_code[1] = '\0';
  service_code[2] = '\0';
  service_code[3] = '\0';
  service_code[4] = '\0';
  service_code[5] = '\0';
  service_code[6] = '\0';
  service_code[7] = '\0';
  service_code[8] = '\0';
  service_code[9] = '\0';
  service_code[10] = '\0';
  service_code[0xb] = '\0';
  service_code[0xc] = '\0';
  service_code[0xd] = '\0';
  service_code[0xe] = '\0';
  service_code[0xf] = '\0';
  puVar10 = BuffSnd;
  for (lVar6 = 0xbd; lVar6 != 0; lVar6 = lVar6 + -1) {
    puVar10[0] = '\0';
    puVar10[1] = '\0';
    puVar10[2] = '\0';
    puVar10[3] = '\0';
    puVar10[4] = '\0';
    puVar10[5] = '\0';
    puVar10[6] = '\0';
    puVar10[7] = '\0';
    puVar10 = puVar10 + 8;
  }
  puVar10[0] = '\0';
  puVar10[1] = '\0';
  puVar10[2] = '\0';
  puVar10[3] = '\0';
  puVar10 = BuffRcv;
  for (lVar6 = 0x20; lVar6 != 0; lVar6 = lVar6 + -1) {
    puVar10[0] = '\0';
    puVar10[1] = '\0';
    puVar10[2] = '\0';
    puVar10[3] = '\0';
    puVar10[4] = '\0';
    puVar10[5] = '\0';
    puVar10[6] = '\0';
    puVar10[7] = '\0';
    puVar10 = puVar10 + 8;
  }
  pcVar7 = aav_data;
  for (lVar6 = 0x20; lVar6 != 0; lVar6 = lVar6 + -1) {
    pcVar7[0] = '\0';
    pcVar7[1] = '\0';
    pcVar7[2] = '\0';
    pcVar7[3] = '\0';
    pcVar7[4] = '\0';
    pcVar7[5] = '\0';
    pcVar7[6] = '\0';
    pcVar7[7] = '\0';
    pcVar7 = pcVar7 + 8;
  }
  puVar9 = (uint *)aav_key;
  for (lVar6 = 0x20; lVar6 != 0; lVar6 = lVar6 + -1) {
    puVar9[0] = 0;
    puVar9[1] = 0;
    puVar9 = puVar9 + 2;
  }
  *(char *)puVar9 = '\0';
  pcVar7 = CvkA;
  for (lVar6 = 0x20; lVar6 != 0; lVar6 = lVar6 + -1) {
    pcVar7[0] = '\0';
    pcVar7[1] = '\0';
    pcVar7[2] = '\0';
    pcVar7[3] = '\0';
    pcVar7[4] = '\0';
    pcVar7[5] = '\0';
    pcVar7[6] = '\0';
    pcVar7[7] = '\0';
    pcVar7 = pcVar7 + 8;
  }
  *pcVar7 = '\0';
  pcVar7 = CvkB;
  for (lVar6 = 0x20; lVar6 != 0; lVar6 = lVar6 + -1) {
    pcVar7[0] = '\0';
    pcVar7[1] = '\0';
    pcVar7[2] = '\0';
    pcVar7[3] = '\0';
    pcVar7[4] = '\0';
    pcVar7[5] = '\0';
    pcVar7[6] = '\0';
    pcVar7[7] = '\0';
    pcVar7 = pcVar7 + 8;
  }
  str_temp[0] = '\0';
  str_temp[1] = '\0';
  str_temp[2] = '\0';
  str_temp[3] = '\0';
  str_temp[4] = '\0';
  str_temp[5] = '\0';
  str_temp[6] = '\0';
  str_temp[7] = '\0';
  str_temp[8] = '\0';
  str_temp[9] = '\0';
  str_temp[10] = '\0';
  str_temp[0xb] = '\0';
  str_temp[0xc] = '\0';
  str_temp[0xd] = '\0';
  str_temp[0xe] = '\0';
  str_temp[0xf] = '\0';
  *pcVar7 = '\0';
  trace_event("Start check_aav_data()",5);
  Base64_Decode(nIndiceCtx,aav_data_b64,aav_data);
  if ((((((aav_data[1] == '6') || (iVar2 = memcmp(aav_data_b64,&DAT_004cf29e,2), iVar2 == 0)) ||
        (iVar2 = memcmp(aav_data_b64,&DAT_004cf2a1,2), iVar2 == 0)) ||
       ((iVar2 = memcmp(aav_data_b64,&DAT_004cf2a4,2), iVar2 == 0 ||
        (iVar2 = memcmp(aav_data_b64,&DAT_004cf2a7,2), iVar2 == 0)))) ||
      ((iVar2 = memcmp(aav_data_b64,&DAT_004cf2aa,2), iVar2 == 0 ||
       ((iVar2 = memcmp(aav_data_b64,&DAT_004cf2ad,2), iVar2 == 0 ||
        (iVar2 = memcmp(aav_data_b64,&DAT_004cf2b0,2), iVar2 == 0)))))) ||
     ((iVar2 = memcmp(aav_data_b64,&DAT_004cf2b3,2), iVar2 == 0 ||
      (iVar2 = memcmp(aav_data_b64,&DAT_004cf2b6,2), iVar2 == 0)))) {
    trace_event("AAV GENERATED BY NETWORK(NOK)",5);
    trace_event("End check_aav_data(NOK)",5);
    iVar2 = -1;
  }
  else {
    str_temp[0] = aav_data[0];
    str_temp[1] = aav_data[1];
    uVar5 = strtol(str_temp,(char **)0x0,0x10);
    sprintf(str_temp,"%d",uVar5 & 0xffffffff);
    control_byte[0] = '0';
    control_byte[1] = '0';
    puVar9 = (uint *)str_temp;
    do {
      puVar8 = puVar9;
      uVar3 = *puVar8 + 0xfefefeff & ~*puVar8;
      uVar4 = uVar3 & 0x80808080;
      puVar9 = puVar8 + 1;
    } while (uVar4 == 0);
    bVar11 = (uVar3 & 0x8080) == 0;
    if (bVar11) {
      uVar4 = uVar4 >> 0x10;
    }
    if (bVar11) {
      puVar9 = (uint *)((long)puVar8 + 6);
    }
    pcVar7 = (char *)((long)puVar9 +
                     ((-3 - (ulong)CARRY1((byte)uVar4,(byte)uVar4)) - (long)str_temp));
    if (pcVar7 < (char *)0x3) {
      memcpy(control_byte + (2 - (long)pcVar7),str_temp,(size_t)pcVar7);
    }
    else {
      control_byte[0] = str_temp[1];
      control_byte[1] = str_temp[2];
    }
    auth_method[0] = aav_data[0x14];
    key_id[0] = aav_data[0x15];
    str_temp[0] = aav_data[0x16];
    str_temp[1] = aav_data[0x17];
    str_temp[2] = aav_data[0x18];
    str_temp[3] = aav_data[0x19];
    str_temp[4] = aav_data[0x1a];
    str_temp[5] = aav_data[0x1b];
    str_temp[6] = aav_data[0x1c];
    str_temp[7] = aav_data[0x1d];
    uVar5 = strtol(str_temp,(char **)0x0,0x10);
    sprintf(str_temp,"%d",uVar5 & 0xffffffff);
    builtin_strncpy(tsn,"0000",4);
    puVar9 = (uint *)str_temp;
    do {
      puVar8 = puVar9;
      uVar3 = *puVar8 + 0xfefefeff & ~*puVar8;
      uVar4 = uVar3 & 0x80808080;
      puVar9 = puVar8 + 1;
    } while (uVar4 == 0);
    bVar11 = (uVar3 & 0x8080) == 0;
    if (bVar11) {
      uVar4 = uVar4 >> 0x10;
    }
    if (bVar11) {
      puVar9 = (uint *)((long)puVar8 + 6);
    }
    pcVar7 = (char *)((long)puVar9 +
                     ((-3 - (ulong)CARRY1((byte)uVar4,(byte)uVar4)) - (long)str_temp));
    if (pcVar7 < (char *)0x5) {
      memcpy(tsn + (4 - (long)pcVar7),str_temp,(size_t)pcVar7);
    }
    else {
      tsn._0_4_ = *(undefined4 *)(service_code + (long)(pcVar7 + 0xc));
    }
    aav_value[2] = aav_data[0x21];
    aav_value[0] = aav_data[0x1f];
    aav_value[1] = aav_data[0x20];
    iVar2 = Get_UCAF_Key(nIndiceCtx,Pan,key_id,aav_key);
    if (iVar2 == 0) {
      puVar9 = (uint *)aav_key;
      if ((CvkA[0] == 'U') || (CvkA[0] == 'S')) {
        do {
          puVar8 = puVar9;
          uVar3 = *puVar8 + 0xfefefeff & ~*puVar8;
          uVar4 = uVar3 & 0x80808080;
          puVar9 = puVar8 + 1;
        } while (uVar4 == 0);
        bVar11 = (uVar3 & 0x8080) == 0;
        if (bVar11) {
          uVar4 = uVar4 >> 0x10;
        }
        if (bVar11) {
          puVar9 = (uint *)((long)puVar8 + 6);
        }
        memcpy(CvkA,aav_key,
               (size_t)((long)puVar9 +
                       ((-3 - (ulong)CARRY1((byte)uVar4,(byte)uVar4)) - (long)aav_key)));
      }
      if (debug_option == 1) {
        sprintf(sLine,"AUTHENTICATION METHOD       : %.1s",auth_method);
        trace_event(sLine,5);
        sprintf(sLine,"CONTROL BYTE                : %.2s",control_byte);
        trace_event(sLine,5);
        sprintf(sLine,"TRANSACTION SEQUENCE NUMBER : %.4s",tsn);
        trace_event(sLine,5);
        sprintf(sLine,"AAV_KEY                     : %.32s",aav_key);
        trace_event(sLine,5);
        sprintf(sLine,"UCAF/AAV                    : %.3s",aav_value);
        trace_event(sLine,5);
        trace_event("- UCAF / AAV Verification ---------------",5);
      }
      else {
        trace_event("- UCAF / AAV Verification ---------------",5);
      }
      uVar1 = control_byte._0_8_;
      service_code[1] = control_byte[0];
      service_code[2] = control_byte[1];
      service_code[0] = auth_method[0];
      control_byte._0_8_ = uVar1;
      command_CY((char *)BuffSnd,Pan,service_code,tsn,CvkA,CvkB,aav_value);
      iVar2 = CheckResource(nIndiceCtx,"070000",&nPid);
      if ((iVar2 == 0) &&
         (iVar2 = HsmQuery(nIndiceCtx,nPid,(char *)BuffSnd,(char *)BuffRcv), iVar2 != 0x3ef)) {
        if (iVar2 == 3) {
          builtin_strncpy(sHsmResultCode,"UNVL",4);
          trace_event("HSM MALFUNCTION DETECTED",1);
          trace_event("End   check_aav_data(MALFUNCTION)",5);
          iVar2 = 3;
        }
        else {
          iVar2 = command_CZ((char *)BuffRcv,sHsmResultCode);
          if (iVar2 == 0) {
            trace_event("End   check_aav_data(OK)",5);
            iVar2 = 0;
          }
          else if (iVar2 == 1) {
            trace_event("End   check_aav_data(VERIFICATION_FAILED)",5);
            iVar2 = 1;
          }
          else if (iVar2 == 0x7d1) {
            trace_event("End check_aav_data(ERROR_COMMAND)",5);
            iVar2 = 3;
          }
          else {
            trace_event("End   check_aav_data(CRYPTOGRAPHIC_ERROR)",5);
            iVar2 = 2;
          }
        }
      }
      else {
        builtin_strncpy(sHsmResultCode,"UNVL",4);
        trace_event("HSM FOR VERIFICATION NOT AVAILABLE",1);
        trace_event("End   check_aav_data(HSM_UNAVAILABLE)",5);
        iVar2 = 9;
      }
    }
    else {
      builtin_strncpy(sHsmResultCode,"UNVL",4);
      iVar2 = 9;
    }
  }
  return iVar2;
}



// WARNING: Unknown calling convention

int check_cvv_data(int nIndiceCtx,char *Pan,char *CvkA,char *CvkB,char *expiry_date,
                  char *service_code,char *cvv,char *sHsmResultCode)

{
  int iVar1;
  long lVar2;
  uchar *puVar3;
  byte bVar4;
  pid_t nPid;
  uchar BuffRcv [256];
  char sLine [512];
  uchar BuffSnd [1516];
  
  bVar4 = 0;
  trace_event("Start check_cvv_data()",5);
  puVar3 = BuffSnd;
  for (lVar2 = 0xbd; lVar2 != 0; lVar2 = lVar2 + -1) {
    puVar3[0] = '\0';
    puVar3[1] = '\0';
    puVar3[2] = '\0';
    puVar3[3] = '\0';
    puVar3[4] = '\0';
    puVar3[5] = '\0';
    puVar3[6] = '\0';
    puVar3[7] = '\0';
    puVar3 = puVar3 + (ulong)bVar4 * -0x10 + 8;
  }
  puVar3[0] = '\0';
  puVar3[1] = '\0';
  puVar3[2] = '\0';
  puVar3[3] = '\0';
  puVar3 = BuffRcv;
  for (lVar2 = 0x20; lVar2 != 0; lVar2 = lVar2 + -1) {
    puVar3[0] = '\0';
    puVar3[1] = '\0';
    puVar3[2] = '\0';
    puVar3[3] = '\0';
    puVar3[4] = '\0';
    puVar3[5] = '\0';
    puVar3[6] = '\0';
    puVar3[7] = '\0';
    puVar3 = puVar3 + (ulong)bVar4 * -0x10 + 8;
  }
  if (debug_option == 1) {
    sprintf(sLine,"SERVICE CODE                : %.3s",service_code);
    trace_event(sLine,5);
    sprintf(sLine,"EXPIRY DATE                 : %.4s",expiry_date);
    trace_event(sLine,5);
    sprintf(sLine,"CVKA                        : %.16s",CvkA);
    trace_event(sLine,5);
    sprintf(sLine,"CVKB                        : %.16s",CvkB);
    trace_event(sLine,5);
    iVar1 = memcmp(service_code,&DAT_004caed9,3);
    if (iVar1 == 0) {
      sprintf(sLine,"ICVV                        : %.3s",cvv);
    }
    else {
      sprintf(sLine,"CVV1                        : %.3s",cvv);
    }
    trace_event(sLine,5);
    trace_event("- CVV Verification ---------------",5);
  }
  command_CY((char *)BuffSnd,Pan,service_code,expiry_date,CvkA,CvkB,cvv);
  iVar1 = CheckResource(nIndiceCtx,"070000",&nPid);
  if ((iVar1 != 0) ||
     (iVar1 = HsmQuery(nIndiceCtx,nPid,(char *)BuffSnd,(char *)BuffRcv), iVar1 == 0x3ef)) {
    builtin_strncpy(sHsmResultCode,"UNVL",4);
    trace_event("HSM FOR VERIFICATION NOT AVAILABLE",1);
    trace_event("End   check_cvv_data(HSM_UNAVAILABLE)",5);
    return 9;
  }
  if (iVar1 == 3) {
    builtin_strncpy(sHsmResultCode,"UNVL",4);
    trace_event("HSM MALFUNCTION DETECTED",1);
    trace_event("End   check_cvv_data(MALFUNCTION)",5);
    return 3;
  }
  iVar1 = command_CZ((char *)BuffRcv,sHsmResultCode);
  if (iVar1 != 0) {
    if (iVar1 == 1) {
      trace_event("End   check_cvv_data(VERIFICATION_FAILED)",5);
      return 1;
    }
    if (iVar1 == 0x7d1) {
      trace_event("End check_cvv_data(ERROR_COMMAND)",5);
      return 3;
    }
    trace_event("End   check_cvv_data(CRYPTOGRAPHIC_ERROR)",5);
    return 2;
  }
  trace_event("End   check_cvv_data(OK)",5);
  return 0;
}



// WARNING: Unknown calling convention

int check_pvv_data(int nIndiceCtx,char *Pan,char *PvkA,char *PvkB,char *PinBlock,char *format,
                  char *trans_key,char *pvv,char mode,char *sHsmResultCode)

{
  int iVar1;
  long lVar2;
  uchar *puVar3;
  char *mess;
  pid_t nPid;
  char sLine [512];
  uchar BuffSnd [1516];
  uchar BuffRcv [1516];
  
  puVar3 = BuffSnd;
  for (lVar2 = 0xbd; lVar2 != 0; lVar2 = lVar2 + -1) {
    puVar3[0] = '\0';
    puVar3[1] = '\0';
    puVar3[2] = '\0';
    puVar3[3] = '\0';
    puVar3[4] = '\0';
    puVar3[5] = '\0';
    puVar3[6] = '\0';
    puVar3[7] = '\0';
    puVar3 = puVar3 + 8;
  }
  puVar3[0] = '\0';
  puVar3[1] = '\0';
  puVar3[2] = '\0';
  puVar3[3] = '\0';
  puVar3 = BuffRcv;
  for (lVar2 = 0xbd; lVar2 != 0; lVar2 = lVar2 + -1) {
    puVar3[0] = '\0';
    puVar3[1] = '\0';
    puVar3[2] = '\0';
    puVar3[3] = '\0';
    puVar3[4] = '\0';
    puVar3[5] = '\0';
    puVar3[6] = '\0';
    puVar3[7] = '\0';
    puVar3 = puVar3 + 8;
  }
  puVar3[0] = '\0';
  puVar3[1] = '\0';
  puVar3[2] = '\0';
  puVar3[3] = '\0';
  trace_event("Start check_pvv_data()",5);
  if (debug_option == 1) {
    sprintf(sLine,"PVKA                        : %.16s",PvkA);
    trace_event(sLine,5);
    sprintf(sLine,"PVKB                        : %.16s",PvkB);
    trace_event(sLine,5);
    sprintf(sLine,"PVV                         : %.5s",pvv);
    trace_event(sLine,5);
    sprintf(sLine,"PIN BLOCK                   : %.16s",PinBlock);
    trace_event(sLine,5);
    sprintf(sLine,"Format                      : %.2s",format);
    trace_event(sLine,5);
    if (mode == 'T') {
      sprintf(sLine,"TAK/TPK                     : %.16s",trans_key);
    }
    else {
      sprintf(sLine,"ZPK                         : %.16s",trans_key);
    }
    trace_event(sLine,5);
  }
  trace_event("- Start PVV Verification ---------------",5);
  sprintf(sLine,"MFR trans_key : %.16s",trans_key);
  trace_event(sLine,5);
  sprintf(sLine,"MFR PvkA : %.96s",PvkA);
  trace_event(sLine,5);
  sprintf(sLine,"MFR PvkB : %.96s",PvkB);
  trace_event(sLine,5);
  sprintf(sLine,"MFR1 PinBlock : %.32s",PinBlock);
  trace_event(sLine,5);
  sprintf(sLine,"MFR format : %.16s",format);
  trace_event(sLine,5);
  sprintf(sLine,"MFR Pan : %.16s",Pan);
  trace_event(sLine,5);
  sprintf(sLine,"MFR pvv : %.16s",pvv);
  trace_event(sLine,5);
  if (mode == 'T') {
    command_DC((char *)BuffSnd,trans_key,PvkA,PvkB,PinBlock,format,Pan,pvv);
  }
  else {
    command_EC((char *)BuffSnd,trans_key,PvkA,PvkB,PinBlock,format,Pan,pvv);
  }
  iVar1 = CheckResource(nIndiceCtx,"070000",&nPid);
  if (iVar1 == 0) {
    iVar1 = HsmQuery(nIndiceCtx,nPid,(char *)BuffSnd,(char *)BuffRcv);
    if (iVar1 == 0x3ef) {
      mess = "HSM FOR VERIFICATION NOT AVAILABLE";
      builtin_strncpy(sHsmResultCode,"UNVL",4);
    }
    else {
      if (iVar1 != 3) {
        if (mode == 'T') {
          iVar1 = command_DD((char *)BuffRcv,sHsmResultCode);
        }
        else {
          iVar1 = command_ED((char *)BuffRcv,sHsmResultCode);
        }
        if (iVar1 == 0) {
          trace_event("End   check_pvv_data(OK)",5);
          return 0;
        }
        if (iVar1 == 1) {
          trace_event("End   check_pvv_data(VERIFICATION_FAILED)",5);
          return 1;
        }
        if (iVar1 == 0x7d1) {
          trace_event("End   check_pvv_data(ERROR_COMMAND)",5);
          return 3;
        }
        trace_event("End   check_pvv_data(CRYPTOGRAPHIC_ERROR)",5);
        return 2;
      }
      mess = "HSM MALFUNCTION DETECTED";
      builtin_strncpy(sHsmResultCode,"UNVL",4);
    }
    trace_event(mess,1);
    trace_event("End   check_pvv_data(HSM_UNAVAILABLE)",5);
  }
  else {
    builtin_strncpy(sHsmResultCode,"UNVL",4);
    trace_event("HSM FOR VERIFICATION NOT AVAILABLE",1);
    trace_event("End   check_cvv_data(HSM_UNAVAILABLE)",5);
  }
  return 9;
}



// WARNING: Unknown calling convention

int check_pin_data(int nIndiceCtx,char *Pan,char *pin_tpk,char *pin_block_format,char *pin_key,
                  char *tpk_key,char *sHsmResultCode)

{
  int iVar1;
  long lVar2;
  uchar *puVar3;
  char *mess;
  byte bVar4;
  uchar error_code [3];
  pid_t nPid;
  uchar pin_block_clair_calcul [16];
  uchar pin_clair_recu [16];
  uchar pin_tpk_expand [17];
  uchar BuffSnd [128];
  uchar BuffRcv [128];
  char sLine [512];
  
  bVar4 = 0;
  if (debug_option == 1) {
    sprintf(sLine,"Start   check_pin_data(%d, %.19s, %.16s, %.2s, %.16s, %.16s)",
            (ulong)(uint)nIndiceCtx,Pan,pin_tpk,pin_block_format,pin_key,tpk_key);
  }
  else {
    builtin_strncpy(sLine,"Start   check_pin_data()",0x19);
  }
  trace_event(sLine,5);
  puVar3 = BuffSnd;
  for (lVar2 = 0x10; lVar2 != 0; lVar2 = lVar2 + -1) {
    puVar3[0] = '\0';
    puVar3[1] = '\0';
    puVar3[2] = '\0';
    puVar3[3] = '\0';
    puVar3[4] = '\0';
    puVar3[5] = '\0';
    puVar3[6] = '\0';
    puVar3[7] = '\0';
    puVar3 = puVar3 + (ulong)bVar4 * -0x10 + 8;
  }
  pin_tpk_expand[0x10] = '\0';
  pin_clair_recu[0] = '\0';
  pin_clair_recu[1] = '\0';
  pin_clair_recu[2] = '\0';
  pin_clair_recu[3] = '\0';
  pin_clair_recu[4] = '\0';
  pin_clair_recu[5] = '\0';
  pin_clair_recu[6] = '\0';
  pin_clair_recu[7] = '\0';
  pin_clair_recu[8] = '\0';
  pin_clair_recu[9] = '\0';
  pin_clair_recu[10] = '\0';
  pin_clair_recu[0xb] = '\0';
  pin_clair_recu[0xc] = '\0';
  pin_clair_recu[0xd] = '\0';
  pin_clair_recu[0xe] = '\0';
  pin_clair_recu[0xf] = '\0';
  pin_block_clair_calcul[0] = '\0';
  pin_block_clair_calcul[1] = '\0';
  pin_block_clair_calcul[2] = '\0';
  pin_block_clair_calcul[3] = '\0';
  pin_block_clair_calcul[4] = '\0';
  pin_block_clair_calcul[5] = '\0';
  pin_block_clair_calcul[6] = '\0';
  pin_block_clair_calcul[7] = '\0';
  pin_block_clair_calcul[8] = '\0';
  pin_block_clair_calcul[9] = '\0';
  pin_block_clair_calcul[10] = '\0';
  pin_block_clair_calcul[0xb] = '\0';
  pin_block_clair_calcul[0xc] = '\0';
  pin_block_clair_calcul[0xd] = '\0';
  pin_block_clair_calcul[0xe] = '\0';
  pin_block_clair_calcul[0xf] = '\0';
  puVar3 = BuffRcv;
  for (lVar2 = 0x10; lVar2 != 0; lVar2 = lVar2 + -1) {
    puVar3[0] = '\0';
    puVar3[1] = '\0';
    puVar3[2] = '\0';
    puVar3[3] = '\0';
    puVar3[4] = '\0';
    puVar3[5] = '\0';
    puVar3[6] = '\0';
    puVar3[7] = '\0';
    puVar3 = puVar3 + (ulong)bVar4 * -0x10 + 8;
  }
  pin_tpk_expand._0_8_ = *(undefined8 *)pin_tpk;
  pin_tpk_expand._8_8_ = *(undefined8 *)(pin_tpk + 8);
  command_HG((char *)BuffSnd,tpk_key,(char *)pin_tpk_expand);
  iVar1 = CheckResource(nIndiceCtx,"070000",&nPid);
  if (iVar1 == 0) {
    iVar1 = HsmQuery(nIndiceCtx,nPid,(char *)BuffSnd,(char *)BuffRcv);
    if (iVar1 == 0x3ef) {
      iVar1 = 5;
      mess = "HSM NOT AVAILABLE.";
      builtin_strncpy(sHsmResultCode,"UNVL",4);
    }
    else {
      if (iVar1 != 3) {
        iVar1 = command_HH((char *)BuffRcv,(char *)pin_clair_recu,sHsmResultCode);
        if (iVar1 == 0) {
          calc_pin_block(nIndiceCtx,Pan,pin_key,(char *)pin_block_clair_calcul);
          iVar1 = memcmp(pin_clair_recu,pin_block_clair_calcul,0x10);
          if (iVar1 != 0) {
            trace_event("End   check_pin_data(NOK)",5);
            return 1;
          }
          trace_event("End   check_pin_data(OK)",5);
          return 0;
        }
        if (iVar1 == 0x7d1) {
          trace_event("End   check_pin_data(ERROR_COMMAND)",5);
          return 3;
        }
        trace_event("End   check_pin_data(CRYPTOGRAPHIC_ERROR)",5);
        return 2;
      }
      iVar1 = 1;
      mess = "MALFUNCTION ERROR";
      builtin_strncpy(sHsmResultCode,"UNVL",4);
    }
  }
  else {
    mess = "HSM FOR VERIFICATION NOT AVAILABLE";
    iVar1 = 1;
    builtin_strncpy(sHsmResultCode,"UNVL",4);
  }
  trace_event(mess,iVar1);
  trace_event("End   check_pin_data(HSM_UNAVAILABLE)",5);
  return 9;
}



// WARNING: Unknown calling convention

int check_offset_data(int nIndiceCtx,char *Pan,char *PvkA,char *PinBlock,char *format,
                     char *trans_key,char *offset,char mode,char *sHsmResultCode,int PinLength)

{
  int iVar1;
  long lVar2;
  uchar *puVar3;
  char *mess;
  byte bVar4;
  pid_t nPid;
  char sLine [512];
  uchar BuffSnd [1516];
  uchar BuffRcv [1516];
  
  bVar4 = 0;
  trace_event("Start check_offset_data()",5);
  puVar3 = BuffSnd;
  for (lVar2 = 0xbd; lVar2 != 0; lVar2 = lVar2 + -1) {
    puVar3[0] = '\0';
    puVar3[1] = '\0';
    puVar3[2] = '\0';
    puVar3[3] = '\0';
    puVar3[4] = '\0';
    puVar3[5] = '\0';
    puVar3[6] = '\0';
    puVar3[7] = '\0';
    puVar3 = puVar3 + (ulong)bVar4 * -0x10 + 8;
  }
  puVar3[0] = '\0';
  puVar3[1] = '\0';
  puVar3[2] = '\0';
  puVar3[3] = '\0';
  puVar3 = BuffRcv;
  for (lVar2 = 0xbd; lVar2 != 0; lVar2 = lVar2 + -1) {
    puVar3[0] = '\0';
    puVar3[1] = '\0';
    puVar3[2] = '\0';
    puVar3[3] = '\0';
    puVar3[4] = '\0';
    puVar3[5] = '\0';
    puVar3[6] = '\0';
    puVar3[7] = '\0';
    puVar3 = puVar3 + (ulong)bVar4 * -0x10 + 8;
  }
  puVar3[0] = '\0';
  puVar3[1] = '\0';
  puVar3[2] = '\0';
  puVar3[3] = '\0';
  if (debug_option == 1) {
    sprintf(sLine,"PVKA                        : %.16s",PvkA);
    trace_event(sLine,5);
    sprintf(sLine,"OFFSET                      : %.12s",offset);
    trace_event(sLine,5);
    sprintf(sLine,"PIN BLOCK                   : %.16s",PinBlock);
    trace_event(sLine,5);
    sprintf(sLine,"Format                      : %.2s",format);
    trace_event(sLine,5);
    sprintf(sLine,"PIN Length                  : %02d",(ulong)(uint)PinLength);
    trace_event(sLine,5);
    if (mode == 'T') {
      sprintf(sLine,"TAK/TPK                     : %.16s",trans_key);
    }
    else {
      sprintf(sLine,"ZPK                         : %.16s",trans_key);
    }
    trace_event(sLine,5);
  }
  if (mode == 'T') {
    command_DA((char *)BuffSnd,trans_key,PvkA,PinBlock,format,Pan,offset,PinLength);
  }
  else {
    command_EA((char *)BuffSnd,trans_key,PvkA,PinBlock,format,Pan,offset);
  }
  iVar1 = CheckResource(nIndiceCtx,"070000",&nPid);
  if ((iVar1 == 0) &&
     (iVar1 = HsmQuery(nIndiceCtx,nPid,(char *)BuffSnd,(char *)BuffRcv), iVar1 != 0x3ef)) {
    if (iVar1 != 3) {
      if (mode == 'T') {
        iVar1 = command_DB((char *)BuffRcv,sHsmResultCode);
      }
      else {
        iVar1 = command_EB((char *)BuffRcv,sHsmResultCode);
      }
      if (iVar1 == 0) {
        trace_event("End   check_offset_data(OK)",5);
        return 0;
      }
      if (iVar1 == 1) {
        trace_event("End   check_offset_data(VERIFICATION_FAILED)",5);
        return 1;
      }
      if (iVar1 == 0x7d1) {
        trace_event("End   check_offset_data(ERROR_COMMAND)",5);
        return 3;
      }
      trace_event("End   check_offset_data(CRYPTOGRAPHIC_ERROR)",5);
      return 2;
    }
    mess = "HSM MALFUNCTION DETECTED";
    builtin_strncpy(sHsmResultCode,"UNVL",4);
  }
  else {
    mess = "HSM FOR VERIFICATION NOT AVAILABLE";
    builtin_strncpy(sHsmResultCode,"UNVL",4);
  }
  trace_event(mess,1);
  trace_event("End   check_offset_data(HSM_UNAVAILABLE)",5);
  return 9;
}



// WARNING: Unknown calling convention

int check_crpt_data_17(int nIndexCtx,char *sTlvBuffer,char *sHsmResultCode)

{
  char cSchemeId;
  int iVar1;
  uint uVar2;
  uint uVar3;
  int iVar4;
  size_t sVar5;
  long lVar6;
  uchar *puVar7;
  char *pcVar8;
  uint *puVar9;
  uint *puVar10;
  bool bVar11;
  byte bVar12;
  uchar sTrxType [2];
  uchar sAtc [3];
  uchar sCountryCode [3];
  uchar sCrncyCode [3];
  uchar sAip [3];
  uchar sTrxDate [4];
  int nLenWork;
  int nLenData;
  int nIccLen;
  pid_t nPid;
  uchar sUn [5];
  uchar sCvr [5];
  uchar sTvr [6];
  uchar sCrptAmount [7];
  uchar sOthrAmount [7];
  uchar sSeqNumber [9];
  uchar sFormatedPan [9];
  uchar sArqc [9];
  uchar sArpc [9];
  uchar sPan [23];
  uchar sArc [256];
  uchar sAC_Key [257];
  uchar BuffSnd [512];
  uchar BuffRcv [512];
  uchar sData [512];
  char szWork [512];
  char sIccData [512];
  char sTmpField [512];
  char sLine [512];
  TSTlvPrivate tlvInfo;
  
  bVar12 = 0;
  nLenWork = 0;
  nLenData = 0;
  nIccLen = 0;
  trace_event("Start check_crpt_data_17()",5);
  puVar7 = BuffSnd;
  for (lVar6 = 0x40; lVar6 != 0; lVar6 = lVar6 + -1) {
    puVar7[0] = '\0';
    puVar7[1] = '\0';
    puVar7[2] = '\0';
    puVar7[3] = '\0';
    puVar7[4] = '\0';
    puVar7[5] = '\0';
    puVar7[6] = '\0';
    puVar7[7] = '\0';
    puVar7 = puVar7 + (ulong)bVar12 * -0x10 + 8;
  }
  sAtc[0] = '\0';
  sAtc[1] = '\0';
  sCrptAmount[4] = '\0';
  sCrptAmount[5] = '\0';
  sFormatedPan[0] = '\0';
  sFormatedPan[1] = '\0';
  sFormatedPan[2] = '\0';
  sFormatedPan[3] = '\0';
  sFormatedPan[4] = '\0';
  sFormatedPan[5] = '\0';
  sFormatedPan[6] = '\0';
  sFormatedPan[7] = '\0';
  sFormatedPan[8] = '\0';
  sAtc[2] = '\0';
  puVar7 = BuffRcv;
  for (lVar6 = 0x40; lVar6 != 0; lVar6 = lVar6 + -1) {
    puVar7[0] = '\0';
    puVar7[1] = '\0';
    puVar7[2] = '\0';
    puVar7[3] = '\0';
    puVar7[4] = '\0';
    puVar7[5] = '\0';
    puVar7[6] = '\0';
    puVar7[7] = '\0';
    puVar7 = puVar7 + (ulong)bVar12 * -0x10 + 8;
  }
  sUn[0] = '\0';
  sUn[1] = '\0';
  sUn[2] = '\0';
  sUn[3] = '\0';
  sUn[4] = '\0';
  sCrptAmount[0] = '\0';
  sCrptAmount[1] = '\0';
  sCrptAmount[2] = '\0';
  sCrptAmount[3] = '\0';
  sCrptAmount[6] = '\0';
  puVar7 = sData;
  for (lVar6 = 0x40; lVar6 != 0; lVar6 = lVar6 + -1) {
    puVar7[0] = '\0';
    puVar7[1] = '\0';
    puVar7[2] = '\0';
    puVar7[3] = '\0';
    puVar7[4] = '\0';
    puVar7[5] = '\0';
    puVar7[6] = '\0';
    puVar7[7] = '\0';
    puVar7 = puVar7 + (ulong)bVar12 * -0x10 + 8;
  }
  sCvr[0] = '\0';
  sCvr[1] = '\0';
  sCvr[2] = '\0';
  sCvr[3] = '\0';
  sCvr[4] = '\0';
  sArqc[0] = '\0';
  sArqc[1] = '\0';
  sArqc[2] = '\0';
  sArqc[3] = '\0';
  sArqc[4] = '\0';
  sArqc[5] = '\0';
  sArqc[6] = '\0';
  sArqc[7] = '\0';
  sArqc[8] = '\0';
  puVar7 = sAC_Key;
  for (lVar6 = 0x20; lVar6 != 0; lVar6 = lVar6 + -1) {
    puVar7[0] = '\0';
    puVar7[1] = '\0';
    puVar7[2] = '\0';
    puVar7[3] = '\0';
    puVar7[4] = '\0';
    puVar7[5] = '\0';
    puVar7[6] = '\0';
    puVar7[7] = '\0';
    puVar7 = puVar7 + (ulong)bVar12 * -0x10 + 8;
  }
  sArpc[0] = '\0';
  sArpc[1] = '\0';
  sArpc[2] = '\0';
  sArpc[3] = '\0';
  sArpc[4] = '\0';
  sArpc[5] = '\0';
  sArpc[6] = '\0';
  sArpc[7] = '\0';
  sArpc[8] = '\0';
  *puVar7 = '\0';
  puVar7 = (uchar *)szWork;
  for (lVar6 = 0x40; lVar6 != 0; lVar6 = lVar6 + -1) {
    puVar7[0] = '\0';
    puVar7[1] = '\0';
    puVar7[2] = '\0';
    puVar7[3] = '\0';
    puVar7[4] = '\0';
    puVar7[5] = '\0';
    puVar7[6] = '\0';
    puVar7[7] = '\0';
    puVar7 = puVar7 + (ulong)bVar12 * -0x10 + 8;
  }
  puVar9 = (uint *)sTmpField;
  for (lVar6 = 0x40; lVar6 != 0; lVar6 = lVar6 + -1) {
    puVar9[0] = 0;
    puVar9[1] = 0;
    puVar9 = puVar9 + (ulong)bVar12 * -4 + 2;
  }
  puVar7 = sArc;
  for (lVar6 = 0x20; lVar6 != 0; lVar6 = lVar6 + -1) {
    puVar7[0] = '\0';
    puVar7[1] = '\0';
    puVar7[2] = '\0';
    puVar7[3] = '\0';
    puVar7[4] = '\0';
    puVar7[5] = '\0';
    puVar7[6] = '\0';
    puVar7[7] = '\0';
    puVar7 = puVar7 + (ulong)bVar12 * -0x10 + 8;
  }
  iVar1 = GetTlvBuffer("002",sTlvBuffer,(char *)sPan,&nLenData);
  if (iVar1 == 0) {
    sSeqNumber[0] = '\0';
    sSeqNumber[1] = '\0';
    sSeqNumber[2] = '\0';
    sSeqNumber[3] = '\0';
    sSeqNumber[4] = '\0';
    sSeqNumber[5] = '\0';
    sSeqNumber[6] = '\0';
    sSeqNumber[7] = '\0';
    sSeqNumber[8] = '\0';
    iVar1 = GetTlvBuffer("023",sTlvBuffer,(char *)sSeqNumber,&nLenData);
    if (iVar1 != 0) {
      builtin_strncpy(sHsmResultCode,"-PAN",4);
      pcVar8 = "ERROR WhiLe GetIsoIcTag(ISO_TAG_TRANS_SEQ_NUM) ";
      goto LAB_00470059;
    }
    sprintf(sLine,"SEQUENCE NUMBER             : %s",sSeqNumber);
    trace_event(sLine,5);
    trace_event("- CRYPTOGRAM Verification ---------------",5);
    iVar1 = Get_EMV_Key(nIndexCtx,(char *)sPan,"AC",(char *)sAC_Key);
    if (iVar1 != 0) {
      builtin_strncpy(sHsmResultCode,"-DMK",4);
      trace_event("INVALID KEY DMK ",1);
      trace_event("END   check_crpt_data_17(KEY_UNAVAILABLE)",5);
      return 3;
    }
    sprintf(sLine,"AC KEY IS                  : %s",sAC_Key);
    trace_event(sLine,5);
    builtin_strncpy(szWork,"0000000000000000",0x10);
    puVar9 = (uint *)sPan;
    do {
      puVar10 = puVar9;
      uVar2 = *puVar10 + 0xfefefeff & ~*puVar10;
      uVar3 = uVar2 & 0x80808080;
      puVar9 = puVar10 + 1;
    } while (uVar3 == 0);
    bVar11 = (uVar2 & 0x8080) == 0;
    if (bVar11) {
      uVar3 = uVar3 >> 0x10;
    }
    if (bVar11) {
      puVar9 = (uint *)((long)puVar10 + 6);
    }
    pcVar8 = (char *)((long)puVar9 + ((-3 - (ulong)CARRY1((byte)uVar3,(byte)uVar3)) - (long)sPan));
    memcpy(sTmpField,sPan,(size_t)pcVar8);
    *(undefined2 *)((long)sTmpField + (long)pcVar8) = sSeqNumber._1_2_;
    puVar9 = (uint *)sTmpField;
    do {
      puVar10 = puVar9;
      uVar2 = *puVar10 + 0xfefefeff & ~*puVar10;
      uVar3 = uVar2 & 0x80808080;
      puVar9 = puVar10 + 1;
    } while (uVar3 == 0);
    bVar11 = (uVar2 & 0x8080) == 0;
    if (bVar11) {
      uVar3 = uVar3 >> 0x10;
    }
    if (bVar11) {
      puVar9 = (uint *)((long)puVar10 + 6);
    }
    iVar1 = (((int)puVar9 + -3) - (uint)CARRY1((byte)uVar3,(byte)uVar3)) - (int)sTmpField;
    pcVar8 = (char *)(long)iVar1;
    nLenWork = iVar1;
    sVar5 = strlen(pcVar8);
    if (sVar5 < 0x10) {
      memcpy(szWork + (0x10 - iVar1),sTmpField,(size_t)pcVar8);
    }
    else {
      szWork._0_8_ = *(undefined8 *)(sIccData + 0x1f0 + (long)pcVar8);
      szWork._8_8_ = *(undefined8 *)(sIccData + 0x1f8 + (long)pcVar8);
    }
    AsciiToHex((uchar *)szWork,sFormatedPan,0x10);
    if (debug_option == 1) {
      sprintf(sLine,"PRE FORMATED PAN            : %s",szWork);
      trace_event(sLine,5);
    }
    iVar1 = GetTlvBuffer("055",sTlvBuffer,sIccData,&nIccLen);
    if (iVar1 == 0) {
      InitTlvPrivate(&tlvInfo);
      AnalyseTlvPrivate(sIccData,nIccLen,&tlvInfo);
      iVar1 = GetTlvBuffer("204",sTlvBuffer,szWork,&nLenWork);
      cSchemeId = '0';
      if (iVar1 == 0) {
        iVar1 = memcmp(szWork,"01",2);
        cSchemeId = '1' - (iVar1 == 0);
      }
      puVar7 = (uchar *)szWork;
      for (lVar6 = 0x40; lVar6 != 0; lVar6 = lVar6 + -1) {
        puVar7[0] = '\0';
        puVar7[1] = '\0';
        puVar7[2] = '\0';
        puVar7[3] = '\0';
        puVar7[4] = '\0';
        puVar7[5] = '\0';
        puVar7[6] = '\0';
        puVar7[7] = '\0';
        puVar7 = puVar7 + (ulong)bVar12 * -0x10 + 8;
      }
      sAtc[0] = '0';
      sAtc[1] = '0';
      iVar1 = GetTlvPrivate("C07",&tlvInfo,szWork,&nLenWork);
      if (iVar1 == 0) {
        AsciiToHex((uchar *)szWork,sAtc,4);
      }
      sprintf(sLine,"ATC                         : %s",szWork);
      trace_event(sLine,5);
      puVar7 = (uchar *)szWork;
      for (lVar6 = 0x40; lVar6 != 0; lVar6 = lVar6 + -1) {
        puVar7[0] = '\0';
        puVar7[1] = '\0';
        puVar7[2] = '\0';
        puVar7[3] = '\0';
        puVar7[4] = '\0';
        puVar7[5] = '\0';
        puVar7[6] = '\0';
        puVar7[7] = '\0';
        puVar7 = puVar7 + (ulong)bVar12 * -0x10 + 8;
      }
      iVar1 = GetTlvPrivate("C08",&tlvInfo,szWork,&nLenWork);
      if (iVar1 == 0) {
        AsciiToHex((uchar *)szWork,sUn,8);
      }
      sprintf(sLine,"UN                          : %s",szWork);
      trace_event(sLine,5);
      puVar7 = (uchar *)szWork;
      for (lVar6 = 0x40; lVar6 != 0; lVar6 = lVar6 + -1) {
        puVar7[0] = '\0';
        puVar7[1] = '\0';
        puVar7[2] = '\0';
        puVar7[3] = '\0';
        puVar7[4] = '\0';
        puVar7[5] = '\0';
        puVar7[6] = '\0';
        puVar7[7] = '\0';
        puVar7 = puVar7 + (ulong)bVar12 * -0x10 + 8;
      }
      nLenData = 0;
      iVar1 = GetTlvPrivate("C06",&tlvInfo,szWork,&nLenWork);
      if (iVar1 != 0) {
        sprintf(szWork,"%012d",0);
      }
      AsciiToHex((uchar *)szWork,sCrptAmount,0xc);
      sprintf(sLine,"CRPT AMOUNT                 : %s",szWork);
      trace_event(sLine,5);
      *(undefined4 *)(sData + nLenData) = sCrptAmount._0_4_;
      *(undefined2 *)(sData + (long)nLenData + 4) = sCrptAmount._4_2_;
      *(undefined4 *)(sData + (nLenData + 6)) = sUn._0_4_;
      iVar1 = nLenData + 10;
      nLenData = nLenData + 0xc;
      *(undefined2 *)(sData + iVar1) = sAtc._0_2_;
      puVar7 = (uchar *)szWork;
      for (lVar6 = 0x40; lVar6 != 0; lVar6 = lVar6 + -1) {
        puVar7[0] = '\0';
        puVar7[1] = '\0';
        puVar7[2] = '\0';
        puVar7[3] = '\0';
        puVar7[4] = '\0';
        puVar7[5] = '\0';
        puVar7[6] = '\0';
        puVar7[7] = '\0';
        puVar7 = puVar7 + (ulong)bVar12 * -0x10 + 8;
      }
      iVar1 = GetTlvPrivate("C20",&tlvInfo,szWork,&nLenWork);
      if (iVar1 != 0) {
        sprintf(szWork,"%32d",0);
      }
      sprintf(sLine,"CVR                          : %.2s",szWork + 8);
      AsciiToHex((uchar *)(szWork + 8),sCvr,2);
      lVar6 = (long)nLenData;
      nLenData = nLenData + 1;
      sData[lVar6] = sCvr[0];
      trace_event(sLine,5);
      puVar7 = (uchar *)szWork;
      for (lVar6 = 0x40; lVar6 != 0; lVar6 = lVar6 + -1) {
        puVar7[0] = '\0';
        puVar7[1] = '\0';
        puVar7[2] = '\0';
        puVar7[3] = '\0';
        puVar7[4] = '\0';
        puVar7[5] = '\0';
        puVar7[6] = '\0';
        puVar7[7] = '\0';
        puVar7 = puVar7 + (ulong)bVar12 * -0x10 + 8;
      }
      iVar1 = GetTlvPrivate("C01",&tlvInfo,szWork,&nLenWork);
      if (iVar1 == 0) {
        AsciiToHex((uchar *)szWork,sArqc,0x10);
      }
      sprintf(sLine,"ARQC                         : %s",szWork);
      trace_event(sLine,5);
      sArc[0] = '0';
      sArc[1] = '0';
      lVar6 = (long)nLenData;
      nLenData = nLenData + 3;
      puVar7 = sData + lVar6;
      szWork._0_8_ = szWork._0_8_ & 0xffffffffff000000;
      puVar7[0] = '\0';
      puVar7[1] = '\0';
      sData[lVar6 + 2] = '\0';
      iVar1 = command_KQ((char *)BuffSnd,cSchemeId,(char *)sAC_Key,(char *)sFormatedPan,(char *)sAtc
                         ,(char *)sUn,nLenData,(char *)sData,(char *)sArqc,(char *)sArc);
      iVar4 = CheckResource(nIndexCtx,"070000",&nPid);
      if ((iVar4 != 0) ||
         (iVar1 = HsmQueryBin(nIndexCtx,nPid,(char *)BuffSnd,iVar1,(char *)BuffRcv), iVar1 == 0x3ef)
         ) {
        builtin_strncpy(sHsmResultCode,"UNVL",4);
        trace_event("HSM FOR VERIFICATION NOT AVAILABLE",1);
        trace_event("End   check_cvv_data(HSM_UNAVAILABLE)",5);
        return 9;
      }
      if (iVar1 == 3) {
        builtin_strncpy(sHsmResultCode,"UNVL",4);
        trace_event("HSM MALFUNCTION DETECTED",1);
        trace_event("End   check_cvv_data(MALFUNCTION)",5);
        return 3;
      }
      iVar1 = command_KR((char *)BuffRcv,sHsmResultCode,(char *)sArpc);
      if (iVar1 != 0) {
        if (iVar1 == 1) {
          trace_event("End   check_crpt_data_17(VERIFICATION_FAILED)",5);
          return 1;
        }
        if (iVar1 == 0x7d1) {
          trace_event("End check_cvv_data(ERROR_COMMAND)",5);
          return 3;
        }
        trace_event("End   check_cvv_data(CRYPTOGRAPHIC_ERROR)",5);
        return 2;
      }
      puVar7 = (uchar *)szWork;
      for (lVar6 = 0x40; lVar6 != 0; lVar6 = lVar6 + -1) {
        puVar7[0] = '\0';
        puVar7[1] = '\0';
        puVar7[2] = '\0';
        puVar7[3] = '\0';
        puVar7[4] = '\0';
        puVar7[5] = '\0';
        puVar7[6] = '\0';
        puVar7[7] = '\0';
        puVar7 = puVar7 + (ulong)bVar12 * -0x10 + 8;
      }
      puVar9 = (uint *)sTmpField;
      for (lVar6 = 0x40; lVar6 != 0; lVar6 = lVar6 + -1) {
        puVar9[0] = 0;
        puVar9[1] = 0;
        puVar9 = puVar9 + (ulong)bVar12 * -4 + 2;
      }
      HexToAscii(sArpc,(uchar *)szWork,0x10);
      sprintf(szWork + 0x10,"%02X%02X",(ulong)sArc[0],(ulong)sArc[1]);
      sprintf(sLine,"==> Issuer Authen Data       : [%s]",szWork);
      trace_event(sLine,5);
      PutTlvPrivate("C23",&tlvInfo,szWork,0x14);
      nIccLen = PrivateBuildTlv(sIccData,&tlvInfo);
      PutTlvBuffer("055",sTlvBuffer,sIccData,nIccLen);
      trace_event("End   check_crpt_data_17(OK)",5);
      return 0;
    }
  }
  pcVar8 = "ERROR WhiLe GetTlvBuffer(AUTO_PAN) ";
  builtin_strncpy(sHsmResultCode,"-PAN",4);
LAB_00470059:
  trace_event(pcVar8,1);
  trace_event("END   check_crpt_data_17(NOK)",5);
  return 3;
}



// WARNING: Unknown calling convention

int check_crpt_data_dpas(int nIndexCtx,char *sTlvBuffer,char *sHsmResultCode)

{
  uchar uVar1;
  int iVar2;
  uint uVar3;
  uint uVar4;
  int iVar5;
  long lVar6;
  uint *puVar7;
  uint *puVar8;
  ulong uVar9;
  char *pcVar10;
  uchar *puVar11;
  bool bVar12;
  byte bVar13;
  int local_ad60;
  uchar sTrxType [2];
  uchar sAtc [3];
  uchar sCountryCode [3];
  uchar sCrncyCode [3];
  uchar sAip [3];
  uchar sTrxDate [4];
  int nLenWork;
  int nLenData;
  int nIccLen;
  pid_t nPid;
  uchar sUn [5];
  uchar sCvr [5];
  char v_icc_application_index [5];
  uchar sTvr [6];
  uchar sCrptAmount [7];
  uchar sOthrAmount [7];
  char v_issuing_bank_code [7];
  uchar sSeqNumber [9];
  uchar sFormatedPan [9];
  uchar sArqc [9];
  uchar sArpc [9];
  uchar sCsu [9];
  uchar sPan [23];
  uchar szIAD [33];
  char vCvr [33];
  uchar sAC_Key [256];
  uchar sArc [256];
  char sLine [512];
  uchar BuffSnd [4096];
  uchar BuffRcv [4096];
  uchar sData [4096];
  char szWork [4096];
  char sIccData [4096];
  char sTmpField [4096];
  char sTmpData [4096];
  char sIAD [4096];
  TSTlvPrivate tlvInfo;
  
  bVar13 = 0;
  nLenWork = 0;
  nLenData = 0;
  nIccLen = 0;
  trace_event("- CRYPTOGRAM Verification ---------------",5);
  trace_event("Start check_crpt_data_dpas()",5);
  puVar11 = BuffSnd;
  for (lVar6 = 0x200; lVar6 != 0; lVar6 = lVar6 + -1) {
    puVar11[0] = '\0';
    puVar11[1] = '\0';
    puVar11[2] = '\0';
    puVar11[3] = '\0';
    puVar11[4] = '\0';
    puVar11[5] = '\0';
    puVar11[6] = '\0';
    puVar11[7] = '\0';
    puVar11 = puVar11 + (ulong)bVar13 * -0x10 + 8;
  }
  sAtc[0] = '\0';
  sAtc[1] = '\0';
  sCrptAmount[4] = '\0';
  sCrptAmount[5] = '\0';
  sCountryCode[0] = '\0';
  sCountryCode[1] = '\0';
  sTvr[4] = '\0';
  sTvr[5] = '\0';
  sCrncyCode[0] = '\0';
  sCrncyCode[1] = '\0';
  sTrxType[0] = '\0';
  sTrxType[1] = '\0';
  sAip[0] = '\0';
  sAip[1] = '\0';
  sFormatedPan[0] = '\0';
  sFormatedPan[1] = '\0';
  sFormatedPan[2] = '\0';
  sFormatedPan[3] = '\0';
  sFormatedPan[4] = '\0';
  sFormatedPan[5] = '\0';
  sFormatedPan[6] = '\0';
  sFormatedPan[7] = '\0';
  sFormatedPan[8] = '\0';
  sAtc[2] = '\0';
  puVar11 = BuffRcv;
  for (lVar6 = 0x200; lVar6 != 0; lVar6 = lVar6 + -1) {
    puVar11[0] = '\0';
    puVar11[1] = '\0';
    puVar11[2] = '\0';
    puVar11[3] = '\0';
    puVar11[4] = '\0';
    puVar11[5] = '\0';
    puVar11[6] = '\0';
    puVar11[7] = '\0';
    puVar11 = puVar11 + (ulong)bVar13 * -0x10 + 8;
  }
  sUn[0] = '\0';
  sUn[1] = '\0';
  sUn[2] = '\0';
  sUn[3] = '\0';
  sUn[4] = '\0';
  sCrptAmount[0] = '\0';
  sCrptAmount[1] = '\0';
  sCrptAmount[2] = '\0';
  sCrptAmount[3] = '\0';
  sCrptAmount[6] = '\0';
  sOthrAmount[0] = '\0';
  sOthrAmount[1] = '\0';
  sOthrAmount[2] = '\0';
  sOthrAmount[3] = '\0';
  sOthrAmount[6] = '\0';
  sCountryCode[2] = '\0';
  sTvr[0] = '\0';
  sTvr[1] = '\0';
  sTvr[2] = '\0';
  sTvr[3] = '\0';
  sCrncyCode[2] = '\0';
  sTrxDate[0] = '\0';
  sTrxDate[1] = '\0';
  sTrxDate[2] = '\0';
  sTrxDate[3] = '\0';
  sAip[2] = '\0';
  puVar11 = sData;
  for (lVar6 = 0x200; lVar6 != 0; lVar6 = lVar6 + -1) {
    puVar11[0] = '\0';
    puVar11[1] = '\0';
    puVar11[2] = '\0';
    puVar11[3] = '\0';
    puVar11[4] = '\0';
    puVar11[5] = '\0';
    puVar11[6] = '\0';
    puVar11[7] = '\0';
    puVar11 = puVar11 + (ulong)bVar13 * -0x10 + 8;
  }
  sOthrAmount[4] = '\0';
  sOthrAmount[5] = '\0';
  sArqc[0] = '\0';
  sArqc[1] = '\0';
  sArqc[2] = '\0';
  sArqc[3] = '\0';
  sArqc[4] = '\0';
  sArqc[5] = '\0';
  sArqc[6] = '\0';
  sArqc[7] = '\0';
  sArqc[8] = '\0';
  puVar11 = sAC_Key;
  for (lVar6 = 0x20; lVar6 != 0; lVar6 = lVar6 + -1) {
    puVar11[0] = '\0';
    puVar11[1] = '\0';
    puVar11[2] = '\0';
    puVar11[3] = '\0';
    puVar11[4] = '\0';
    puVar11[5] = '\0';
    puVar11[6] = '\0';
    puVar11[7] = '\0';
    puVar11 = puVar11 + (ulong)bVar13 * -0x10 + 8;
  }
  sArpc[0] = '\0';
  sArpc[1] = '\0';
  sArpc[2] = '\0';
  sArpc[3] = '\0';
  sArpc[4] = '\0';
  sArpc[5] = '\0';
  sArpc[6] = '\0';
  sArpc[7] = '\0';
  sArpc[8] = '\0';
  sCsu[0] = '\0';
  sCsu[1] = '\0';
  sCsu[2] = '\0';
  sCsu[3] = '\0';
  sCsu[4] = '\0';
  sCsu[5] = '\0';
  sCsu[6] = '\0';
  sCsu[7] = '\0';
  sCsu[8] = '\0';
  vCvr[0] = '\0';
  vCvr[1] = '\0';
  vCvr[2] = '\0';
  vCvr[3] = '\0';
  vCvr[4] = '\0';
  vCvr[5] = '\0';
  vCvr[6] = '\0';
  vCvr[7] = '\0';
  vCvr[8] = '\0';
  vCvr[9] = '\0';
  vCvr[10] = '\0';
  vCvr[0xb] = '\0';
  vCvr[0xc] = '\0';
  vCvr[0xd] = '\0';
  vCvr[0xe] = '\0';
  vCvr[0xf] = '\0';
  vCvr[0x10] = '\0';
  vCvr[0x11] = '\0';
  vCvr[0x12] = '\0';
  vCvr[0x13] = '\0';
  vCvr[0x14] = '\0';
  vCvr[0x15] = '\0';
  vCvr[0x16] = '\0';
  vCvr[0x17] = '\0';
  vCvr[0x18] = '\0';
  vCvr[0x19] = '\0';
  vCvr[0x1a] = '\0';
  vCvr[0x1b] = '\0';
  vCvr[0x1c] = '\0';
  vCvr[0x1d] = '\0';
  vCvr[0x1e] = '\0';
  vCvr[0x1f] = '\0';
  vCvr[0x20] = '\0';
  puVar11 = (uchar *)szWork;
  for (lVar6 = 0x200; lVar6 != 0; lVar6 = lVar6 + -1) {
    puVar11[0] = '\0';
    puVar11[1] = '\0';
    puVar11[2] = '\0';
    puVar11[3] = '\0';
    puVar11[4] = '\0';
    puVar11[5] = '\0';
    puVar11[6] = '\0';
    puVar11[7] = '\0';
    puVar11 = puVar11 + (ulong)bVar13 * -0x10 + 8;
  }
  puVar8 = (uint *)sTmpField;
  for (lVar6 = 0x200; lVar6 != 0; lVar6 = lVar6 + -1) {
    puVar8[0] = 0;
    puVar8[1] = 0;
    puVar8 = puVar8 + (ulong)bVar13 * -4 + 2;
  }
  pcVar10 = sTmpData;
  for (lVar6 = 0x200; lVar6 != 0; lVar6 = lVar6 + -1) {
    pcVar10[0] = '\0';
    pcVar10[1] = '\0';
    pcVar10[2] = '\0';
    pcVar10[3] = '\0';
    pcVar10[4] = '\0';
    pcVar10[5] = '\0';
    pcVar10[6] = '\0';
    pcVar10[7] = '\0';
    pcVar10 = pcVar10 + (ulong)bVar13 * -0x10 + 8;
  }
  puVar11 = sArc;
  for (lVar6 = 0x20; lVar6 != 0; lVar6 = lVar6 + -1) {
    puVar11[0] = '\0';
    puVar11[1] = '\0';
    puVar11[2] = '\0';
    puVar11[3] = '\0';
    puVar11[4] = '\0';
    puVar11[5] = '\0';
    puVar11[6] = '\0';
    puVar11[7] = '\0';
    puVar11 = puVar11 + (ulong)bVar13 * -0x10 + 8;
  }
  iVar2 = GetTlvBuffer("002",sTlvBuffer,(char *)sPan,&nLenData);
  if (iVar2 == 0) {
    sSeqNumber[0] = '\0';
    sSeqNumber[1] = '\0';
    sSeqNumber[2] = '\0';
    sSeqNumber[3] = '\0';
    sSeqNumber[4] = '\0';
    sSeqNumber[5] = '\0';
    sSeqNumber[6] = '\0';
    sSeqNumber[7] = '\0';
    sSeqNumber[8] = '\0';
    iVar2 = GetTlvBuffer("023",sTlvBuffer,(char *)sSeqNumber,&nLenData);
    if (iVar2 != 0) {
      sSeqNumber[0] = '0';
      sSeqNumber[1] = '0';
      sSeqNumber[2] = '0';
      trace_event("ERROR WhiLe GetIsoIcTag(ISO_TAG_TRANS_SEQ_NUM) ",1);
    }
    sprintf(sLine,"SEQUENCE NUMBER             : %s",sSeqNumber);
    trace_event(sLine,5);
    iVar2 = Get_AC_Key(nIndexCtx,(char *)sPan,(char *)sAC_Key);
    if (iVar2 != 0) {
      builtin_strncpy(sHsmResultCode,"-DMK",4);
      trace_event("INVALID KEY DMK ",1);
      trace_event("END   check_crpt_data_dpas(KEY_UNAVAILABLE)",5);
      return 3;
    }
    sprintf(sLine,"AC KEY IS                  : %s",sAC_Key);
    trace_event(sLine,5);
    builtin_strncpy(szWork,"0000000000000000",0x10);
    puVar8 = (uint *)sPan;
    do {
      puVar7 = puVar8;
      uVar3 = *puVar7 + 0xfefefeff & ~*puVar7;
      uVar4 = uVar3 & 0x80808080;
      puVar8 = puVar7 + 1;
    } while (uVar4 == 0);
    bVar12 = (uVar3 & 0x8080) == 0;
    if (bVar12) {
      uVar4 = uVar4 >> 0x10;
    }
    if (bVar12) {
      puVar8 = (uint *)((long)puVar7 + 6);
    }
    pcVar10 = (char *)((long)puVar8 + ((-3 - (ulong)CARRY1((byte)uVar4,(byte)uVar4)) - (long)sPan));
    memcpy(sTmpField,sPan,(size_t)pcVar10);
    *(undefined2 *)((long)sTmpField + (long)pcVar10) = sSeqNumber._1_2_;
    puVar8 = (uint *)sTmpField;
    do {
      puVar7 = puVar8;
      uVar3 = *puVar7 + 0xfefefeff & ~*puVar7;
      uVar4 = uVar3 & 0x80808080;
      puVar8 = puVar7 + 1;
    } while (uVar4 == 0);
    bVar12 = (uVar3 & 0x8080) == 0;
    if (bVar12) {
      uVar4 = uVar4 >> 0x10;
    }
    if (bVar12) {
      puVar8 = (uint *)((long)puVar7 + 6);
    }
    nLenWork = (((int)puVar8 + -3) - (uint)CARRY1((byte)uVar4,(byte)uVar4)) - (int)sTmpField;
    if (nLenWork < 0x10) {
      memcpy(szWork + (0x10 - nLenWork),sTmpField,(long)nLenWork);
    }
    else {
      szWork._0_8_ = *(undefined8 *)(sIccData + (long)nLenWork + 0xff0);
      szWork._8_8_ = *(undefined8 *)(sIccData + (long)nLenWork + 0xff8);
    }
    AsciiToHex((uchar *)szWork,sFormatedPan,0x10);
    iVar2 = GetTlvBuffer("055",sTlvBuffer,sIccData,&nIccLen);
    if (iVar2 == 0) {
      InitTlvPrivate(&tlvInfo);
      AnalyseTlvPrivate(sIccData,nIccLen,&tlvInfo);
      puVar11 = (uchar *)szWork;
      for (lVar6 = 0x200; lVar6 != 0; lVar6 = lVar6 + -1) {
        puVar11[0] = '\0';
        puVar11[1] = '\0';
        puVar11[2] = '\0';
        puVar11[3] = '\0';
        puVar11[4] = '\0';
        puVar11[5] = '\0';
        puVar11[6] = '\0';
        puVar11[7] = '\0';
        puVar11 = puVar11 + (ulong)bVar13 * -0x10 + 8;
      }
      nLenData = 0;
      iVar2 = GetTlvPrivate("C06",&tlvInfo,szWork,&nLenWork);
      if (iVar2 != 0) {
        sprintf(szWork,"%012d",0);
      }
      AsciiToHex((uchar *)szWork,sCrptAmount,0xc);
      sprintf(sLine,"CRPT AMOUNT                 : %s",szWork);
      trace_event(sLine,5);
      lVar6 = (long)nLenData;
      nLenData = nLenData + 6;
      *(undefined4 *)(sData + lVar6) = sCrptAmount._0_4_;
      *(undefined2 *)(sData + lVar6 + 4) = sCrptAmount._4_2_;
      puVar11 = (uchar *)szWork;
      for (lVar6 = 0x200; lVar6 != 0; lVar6 = lVar6 + -1) {
        puVar11[0] = '\0';
        puVar11[1] = '\0';
        puVar11[2] = '\0';
        puVar11[3] = '\0';
        puVar11[4] = '\0';
        puVar11[5] = '\0';
        puVar11[6] = '\0';
        puVar11[7] = '\0';
        puVar11 = puVar11 + (ulong)bVar13 * -0x10 + 8;
      }
      iVar2 = GetTlvPrivate("C21",&tlvInfo,szWork,&nLenWork);
      if (iVar2 != 0) {
        sprintf(szWork,"%012d",0);
      }
      AsciiToHex((uchar *)szWork,sOthrAmount,0xc);
      sprintf(sLine,"OTHER AMOUNT                : %s",szWork);
      trace_event(sLine,5);
      lVar6 = (long)nLenData;
      nLenData = nLenData + 6;
      *(undefined4 *)(sData + lVar6) = sOthrAmount._0_4_;
      *(undefined2 *)(sData + lVar6 + 4) = sOthrAmount._4_2_;
      puVar11 = (uchar *)szWork;
      for (lVar6 = 0x200; lVar6 != 0; lVar6 = lVar6 + -1) {
        puVar11[0] = '\0';
        puVar11[1] = '\0';
        puVar11[2] = '\0';
        puVar11[3] = '\0';
        puVar11[4] = '\0';
        puVar11[5] = '\0';
        puVar11[6] = '\0';
        puVar11[7] = '\0';
        puVar11 = puVar11 + (ulong)bVar13 * -0x10 + 8;
      }
      iVar2 = GetTlvPrivate("C11",&tlvInfo,szWork,&nLenWork);
      if (iVar2 == 0) {
        AsciiToHex((uchar *)szWork,sCountryCode,4);
        sprintf(sLine,"COUNTRY CODE                : %s",szWork);
        trace_event(sLine,5);
        lVar6 = (long)nLenData;
        nLenData = nLenData + 2;
        *(undefined2 *)(sData + lVar6) = sCountryCode._0_2_;
        puVar11 = (uchar *)szWork;
        for (lVar6 = 0x200; lVar6 != 0; lVar6 = lVar6 + -1) {
          puVar11[0] = '\0';
          puVar11[1] = '\0';
          puVar11[2] = '\0';
          puVar11[3] = '\0';
          puVar11[4] = '\0';
          puVar11[5] = '\0';
          puVar11[6] = '\0';
          puVar11[7] = '\0';
          puVar11 = puVar11 + (ulong)bVar13 * -0x10 + 8;
        }
        iVar2 = GetTlvPrivate("C10",&tlvInfo,szWork,&nLenWork);
        if (iVar2 == 0) {
          AsciiToHex((uchar *)szWork,sTvr,10);
          sprintf(sLine,"TVR                         : %s",szWork);
          trace_event(sLine,5);
          lVar6 = (long)nLenData;
          nLenData = nLenData + 5;
          *(undefined4 *)(sData + lVar6) = sTvr._0_4_;
          sData[lVar6 + 4] = sTvr[4];
          puVar11 = (uchar *)szWork;
          for (lVar6 = 0x200; lVar6 != 0; lVar6 = lVar6 + -1) {
            puVar11[0] = '\0';
            puVar11[1] = '\0';
            puVar11[2] = '\0';
            puVar11[3] = '\0';
            puVar11[4] = '\0';
            puVar11[5] = '\0';
            puVar11[6] = '\0';
            puVar11[7] = '\0';
            puVar11 = puVar11 + (ulong)bVar13 * -0x10 + 8;
          }
          iVar2 = GetTlvPrivate("C03",&tlvInfo,szWork,&nLenWork);
          if (iVar2 == 0) {
            AsciiToHex((uchar *)szWork,sCrncyCode,4);
            sprintf(sLine,"CURRENCY CODE               : %s",szWork);
            trace_event(sLine,5);
            lVar6 = (long)nLenData;
            nLenData = nLenData + 2;
            *(undefined2 *)(sData + lVar6) = sCrncyCode._0_2_;
            puVar11 = (uchar *)szWork;
            for (lVar6 = 0x200; lVar6 != 0; lVar6 = lVar6 + -1) {
              puVar11[0] = '\0';
              puVar11[1] = '\0';
              puVar11[2] = '\0';
              puVar11[3] = '\0';
              puVar11[4] = '\0';
              puVar11[5] = '\0';
              puVar11[6] = '\0';
              puVar11[7] = '\0';
              puVar11 = puVar11 + (ulong)bVar13 * -0x10 + 8;
            }
            iVar2 = GetTlvPrivate("C04",&tlvInfo,szWork,&nLenWork);
            if (iVar2 == 0) {
              AsciiToHex((uchar *)szWork,sTrxDate,6);
              sprintf(sLine,"TRANSACTION DATE            : %s",szWork);
              trace_event(sLine,5);
              lVar6 = (long)nLenData;
              nLenData = nLenData + 3;
              *(undefined2 *)(sData + lVar6) = sTrxDate._0_2_;
              sData[lVar6 + 2] = sTrxDate[2];
              puVar11 = (uchar *)szWork;
              for (lVar6 = 0x200; lVar6 != 0; lVar6 = lVar6 + -1) {
                puVar11[0] = '\0';
                puVar11[1] = '\0';
                puVar11[2] = '\0';
                puVar11[3] = '\0';
                puVar11[4] = '\0';
                puVar11[5] = '\0';
                puVar11[6] = '\0';
                puVar11[7] = '\0';
                puVar11 = puVar11 + (ulong)bVar13 * -0x10 + 8;
              }
              iVar2 = GetTlvPrivate("C05",&tlvInfo,szWork,&nLenWork);
              if (iVar2 == 0) {
                AsciiToHex((uchar *)szWork,sTrxType,2);
                sprintf(sLine,"TRANSACTION TYPE            : %s",szWork);
                trace_event(sLine,5);
                lVar6 = (long)nLenData;
                nLenData = nLenData + 1;
                sData[lVar6] = sTrxType[0];
                puVar11 = (uchar *)szWork;
                for (lVar6 = 0x200; lVar6 != 0; lVar6 = lVar6 + -1) {
                  puVar11[0] = '\0';
                  puVar11[1] = '\0';
                  puVar11[2] = '\0';
                  puVar11[3] = '\0';
                  puVar11[4] = '\0';
                  puVar11[5] = '\0';
                  puVar11[6] = '\0';
                  puVar11[7] = '\0';
                  puVar11 = puVar11 + (ulong)bVar13 * -0x10 + 8;
                }
                iVar2 = GetTlvPrivate("C08",&tlvInfo,szWork,&nLenWork);
                if (iVar2 == 0) {
                  AsciiToHex((uchar *)szWork,sUn,8);
                }
                lVar6 = (long)nLenData;
                nLenData = nLenData + 4;
                *(undefined4 *)(sData + lVar6) = sUn._0_4_;
                sprintf(sLine,"UNPREDICTIBLE NUMBER        : %s",szWork);
                trace_event(sLine,5);
                puVar11 = (uchar *)szWork;
                for (lVar6 = 0x200; lVar6 != 0; lVar6 = lVar6 + -1) {
                  puVar11[0] = '\0';
                  puVar11[1] = '\0';
                  puVar11[2] = '\0';
                  puVar11[3] = '\0';
                  puVar11[4] = '\0';
                  puVar11[5] = '\0';
                  puVar11[6] = '\0';
                  puVar11[7] = '\0';
                  puVar11 = puVar11 + (ulong)bVar13 * -0x10 + 8;
                }
                iVar2 = GetTlvPrivate("C12",&tlvInfo,szWork,&nLenWork);
                if (iVar2 == 0) {
                  AsciiToHex((uchar *)szWork,sAip,4);
                  sprintf(sLine,"AIP                         : %s",szWork);
                  trace_event(sLine,5);
                  sAtc[0] = '0';
                  sAtc[1] = '0';
                  lVar6 = (long)nLenData;
                  nLenData = nLenData + 2;
                  *(undefined2 *)(sData + lVar6) = sAip._0_2_;
                  puVar11 = (uchar *)szWork;
                  for (lVar6 = 0x200; lVar6 != 0; lVar6 = lVar6 + -1) {
                    puVar11[0] = '\0';
                    puVar11[1] = '\0';
                    puVar11[2] = '\0';
                    puVar11[3] = '\0';
                    puVar11[4] = '\0';
                    puVar11[5] = '\0';
                    puVar11[6] = '\0';
                    puVar11[7] = '\0';
                    puVar11 = puVar11 + (ulong)bVar13 * -0x10 + 8;
                  }
                  iVar2 = GetTlvPrivate("C07",&tlvInfo,szWork,&nLenWork);
                  if (iVar2 == 0) {
                    AsciiToHex((uchar *)szWork,sAtc,4);
                  }
                  sprintf(sLine,"ATC                         : %s",szWork);
                  trace_event(sLine,5);
                  lVar6 = (long)nLenData;
                  nLenData = nLenData + 2;
                  *(undefined2 *)(sData + lVar6) = sAtc._0_2_;
                  iVar2 = GetTlvBuffer("205",sTlvBuffer,v_issuing_bank_code,&nLenWork);
                  if (iVar2 == 0) {
                    iVar2 = GetTlvBuffer("900",sTlvBuffer,v_icc_application_index,&nLenWork);
                    if (iVar2 == 0) {
                      puVar11 = (uchar *)sIAD;
                      for (lVar6 = 0x200; lVar6 != 0; lVar6 = lVar6 + -1) {
                        puVar11[0] = '\0';
                        puVar11[1] = '\0';
                        puVar11[2] = '\0';
                        puVar11[3] = '\0';
                        puVar11[4] = '\0';
                        puVar11[5] = '\0';
                        puVar11[6] = '\0';
                        puVar11[7] = '\0';
                        puVar11 = puVar11 + (ulong)bVar13 * -0x10 + 8;
                      }
                      iVar2 = GetTlvPrivate("C20",&tlvInfo,sIAD,&nLenWork);
                      if (iVar2 != 0) {
                        sprintf(sIAD,"%32d",0);
                      }
                      sprintf(sLine,"ISSUER APPLICATION DATA     : %s",sIAD);
                      trace_event(sLine,5);
                      iVar2 = memcmp(sIAD + 2,&DAT_004d1e6a,2);
                      if (iVar2 == 0) {
                        uVar9 = 0xffffffffffffffff;
                        puVar11 = (uchar *)sIAD;
                        do {
                          if (uVar9 == 0) break;
                          uVar9 = uVar9 - 1;
                          uVar1 = *puVar11;
                          puVar11 = puVar11 + (ulong)bVar13 * -2 + 1;
                        } while (uVar1 != '\0');
                        memcpy(vCvr,sIAD + 4,~uVar9 - 5);
                        sprintf(sLine,"CARD VERIF RESULT           : %s",vCvr);
                        trace_event(sLine,5);
                        lVar6 = -1;
                        puVar11 = (uchar *)vCvr;
                        do {
                          if (lVar6 == 0) break;
                          lVar6 = lVar6 + -1;
                          uVar1 = *puVar11;
                          puVar11 = puVar11 + (ulong)bVar13 * -2 + 1;
                        } while (uVar1 != '\0');
                        local_ad60 = ~(uint)lVar6 - 1;
                        AsciiToHex((uchar *)vCvr,szIAD,local_ad60);
                      }
                      else {
                        lVar6 = -1;
                        puVar11 = (uchar *)sIAD;
                        do {
                          if (lVar6 == 0) break;
                          lVar6 = lVar6 + -1;
                          uVar1 = *puVar11;
                          puVar11 = puVar11 + (ulong)bVar13 * -2 + 1;
                        } while (uVar1 != '\0');
                        local_ad60 = ~(uint)lVar6 - 1;
                        AsciiToHex((uchar *)sIAD,szIAD,local_ad60);
                      }
                      iVar2 = nLenData;
                      memcpy(sData + nLenData,szIAD,(long)(local_ad60 / 2));
                      puVar11 = (uchar *)szWork;
                      for (lVar6 = 0x200; lVar6 != 0; lVar6 = lVar6 + -1) {
                        puVar11[0] = '\0';
                        puVar11[1] = '\0';
                        puVar11[2] = '\0';
                        puVar11[3] = '\0';
                        puVar11[4] = '\0';
                        puVar11[5] = '\0';
                        puVar11[6] = '\0';
                        puVar11[7] = '\0';
                        puVar11 = puVar11 + (ulong)bVar13 * -0x10 + 8;
                      }
                      nLenData = iVar2 + local_ad60 / 2;
                      iVar2 = GetTlvPrivate("C01",&tlvInfo,szWork,&nLenWork);
                      if (iVar2 == 0) {
                        AsciiToHex((uchar *)szWork,sArqc,0x10);
                      }
                      sprintf(sLine,"ARQC                        : %s",szWork);
                      trace_event(sLine,5);
                      puVar11 = (uchar *)szWork;
                      for (lVar6 = 0x200; lVar6 != 0; lVar6 = lVar6 + -1) {
                        puVar11[0] = '\0';
                        puVar11[1] = '\0';
                        puVar11[2] = '\0';
                        puVar11[3] = '\0';
                        puVar11[4] = '\0';
                        puVar11[5] = '\0';
                        puVar11[6] = '\0';
                        puVar11[7] = '\0';
                        puVar11 = puVar11 + (ulong)bVar13 * -0x10 + 8;
                      }
                      builtin_strncpy(szWork,"001A",4);
                      AsciiToHex((uchar *)szWork,sArc,4);
                      sprintf(sLine,"ARPC-RC                     : %02x%02x",(ulong)sArc[0],
                              (ulong)sArc[1]);
                      trace_event(sLine,5);
                      lVar6 = (long)nLenData;
                      nLenData = nLenData + 1;
                      sData[lVar6] = 0x80;
                      sprintf(sLine,"nLenData                    : %d");
                      trace_event(sLine,5);
                      puVar11 = (uchar *)szWork;
                      for (lVar6 = 0x200; lVar6 != 0; lVar6 = lVar6 + -1) {
                        puVar11[0] = '\0';
                        puVar11[1] = '\0';
                        puVar11[2] = '\0';
                        puVar11[3] = '\0';
                        puVar11[4] = '\0';
                        puVar11[5] = '\0';
                        puVar11[6] = '\0';
                        puVar11[7] = '\0';
                        puVar11 = puVar11 + (ulong)bVar13 * -0x10 + 8;
                      }
                      builtin_strncpy(szWork,"001A0000",8);
                      AsciiToHex((uchar *)szWork,sCsu,8);
                      sprintf(sLine,"CSU                         : %s",szWork);
                      trace_event(sLine,5);
                      iVar2 = command_KW_DCI((char *)BuffSnd,'2',(char *)sAC_Key,
                                             (char *)sFormatedPan,(char *)sAtc,(char *)sUn,nLenData,
                                             (char *)sData,(char *)sArqc,(char *)sCsu,(char *)sArc);
                      iVar5 = CheckResource(nIndexCtx,"070000",&nPid);
                      if ((iVar5 != 0) ||
                         (iVar2 = HsmQueryBin(nIndexCtx,nPid,(char *)BuffSnd,iVar2,(char *)BuffRcv),
                         iVar2 == 0x3ef)) {
                        builtin_strncpy(sHsmResultCode,"UNVL",4);
                        trace_event("HSM FOR VERIFICATION NOT AVAILABLE",1);
                        trace_event("End   check_crpt_data_dpas(HSM_UNAVAILABLE)",5);
                        return 9;
                      }
                      if (iVar2 == 3) {
                        builtin_strncpy(sHsmResultCode,"UNVL",4);
                        trace_event("HSM MALFUNCTION DETECTED",1);
                        trace_event("End   check_crpt_data_dpas(MALFUNCTION)",5);
                        return 3;
                      }
                      iVar2 = command_KX((char *)BuffRcv,sHsmResultCode,(char *)sArpc);
                      if (iVar2 != 0) {
                        if (iVar2 == 1) {
                          trace_event("End   check_crpt_data_dpas(VERIFICATION_FAILED)",5);
                          return 1;
                        }
                        if (iVar2 == 0x7d1) {
                          trace_event("End check_crpt_data_dpas(ERROR_COMMAND)",5);
                          return 3;
                        }
                        trace_event("End   check_crpt_data_dpas(CRYPTOGRAPHIC_ERROR)",5);
                        return 2;
                      }
                      puVar11 = (uchar *)szWork;
                      for (lVar6 = 0x200; lVar6 != 0; lVar6 = lVar6 + -1) {
                        puVar11[0] = '\0';
                        puVar11[1] = '\0';
                        puVar11[2] = '\0';
                        puVar11[3] = '\0';
                        puVar11[4] = '\0';
                        puVar11[5] = '\0';
                        puVar11[6] = '\0';
                        puVar11[7] = '\0';
                        puVar11 = puVar11 + (ulong)bVar13 * -0x10 + 8;
                      }
                      HexToAscii(sArpc,(uchar *)szWork,0x10);
                      sprintf(szWork + 0x10,"%02X%02X",sCsu._0_8_ & 0xff,
                              (ulong)sCsu._0_8_ >> 8 & 0xff);
                      sprintf(sLine,"==> Issuer Authen Data       : [%s]",szWork);
                      trace_event(sLine,5);
                      PutTlvPrivate("C23",&tlvInfo,szWork,0x14);
                      nIccLen = PrivateBuildTlv(sIccData,&tlvInfo);
                      PutTlvBuffer("055",sTlvBuffer,sIccData,nIccLen);
                      trace_event("End   check_crpt_data_dpas(OK)",5);
                      return 0;
                    }
                    builtin_strncpy(sHsmResultCode,"-ICC",4);
                    pcVar10 = "ERROR WhiLe GetTlvBuffer(ICC_APPLICATION_INDX) ";
                  }
                  else {
                    builtin_strncpy(sHsmResultCode,"-ICC",4);
                    pcVar10 = "ERROR WhiLe GetTlvBuffer(AUTO_ISSUING_BANK) ";
                  }
                  goto LAB_00470c0d;
                }
                builtin_strncpy(sHsmResultCode,"---4",4);
                pcVar10 = "==> CANNOT CHECK CRYPTOGRAM.  <<CHIP_AIP_TAG>> NOT RECEIVED <==";
              }
              else {
                builtin_strncpy(sHsmResultCode,"---3",4);
                pcVar10 = "==> CANNOT CHECK CRYPTOGRAM.  <<CHIP_TRANS_TYPE_TAG>> NOT RECEIVED <==";
              }
            }
            else {
              builtin_strncpy(sHsmResultCode,"---4",4);
              pcVar10 = "==> CANNOT CHECK CRYPTOGRAM.  <<CHIP_TRANS_DATE_TAG>> NOT RECEIVED <==";
            }
          }
          else {
            builtin_strncpy(sHsmResultCode,"---3",4);
            pcVar10 = "==> CANNOT CHECK CRYPTOGRAM.  <<CHIP_TRANS_CUR_CODE_TAG>> NOT RECEIVED <==";
          }
        }
        else {
          builtin_strncpy(sHsmResultCode,"---2",4);
          pcVar10 = "==> CANNOT CHECK CRYPTOGRAM.  <<CHIP_TVR_TAG>> NOT RECEIVED <==";
        }
      }
      else {
        pcVar10 = "==> CANNOT CHECK CRYPTOGRAM.  <<CHIP_TERM_COUNTRY_CODE_TAG>> NOT RECEIVED <==";
        builtin_strncpy(sHsmResultCode,"---1",4);
      }
      trace_event(pcVar10,1);
      trace_event("END   check_crpt_data_dpas(CRYPTOGRAPHIC_ERROR)",5);
      return 2;
    }
    builtin_strncpy(sHsmResultCode,"-ICC",4);
    pcVar10 = "ERROR WhiLe GetTlvBuffer(AUTO_ICC_DATA) ";
  }
  else {
    pcVar10 = "ERROR WhiLe GetTlvBuffer(AUTO_PAN) ";
    builtin_strncpy(sHsmResultCode,"-PAN",4);
  }
LAB_00470c0d:
  trace_event(pcVar10,1);
  trace_event("END   check_crpt_data_dpas(NOK)",5);
  return 3;
}



// WARNING: Unknown calling convention

int check_data_authen(int nIndexCtx,char *sTlvBuffer,char *sHsmResultCode,char *sDacFlag)

{
  int iVar1;
  uint uVar2;
  uint uVar3;
  int iVar4;
  uchar *puVar5;
  long lVar6;
  uint *puVar7;
  uint *puVar8;
  char *pcVar9;
  bool bVar10;
  byte bVar11;
  uchar sAtc [3];
  uchar sDac [3];
  uchar sDn [3];
  int nLenWork;
  int nLenData;
  int nIccLen;
  pid_t nPid;
  uchar sUn [5];
  uchar sFormatedPan [9];
  uchar sSeqNumber [9];
  uchar sPan [23];
  uchar sAC_Key [256];
  char sLine [512];
  uchar BuffSnd [4096];
  uchar BuffRcv [4096];
  char szWork [4096];
  char sIccData [4096];
  char sTmpField [4096];
  char sTmpData [4096];
  TSTlvPrivate tlvInfo;
  
  bVar11 = 0;
  nLenWork = 0;
  nLenData = 0;
  nIccLen = 0;
  trace_event("Start check_data_authen()",5);
  sFormatedPan[0] = '\0';
  sFormatedPan[1] = '\0';
  sFormatedPan[2] = '\0';
  sFormatedPan[3] = '\0';
  sFormatedPan[4] = '\0';
  sFormatedPan[5] = '\0';
  sFormatedPan[6] = '\0';
  sFormatedPan[7] = '\0';
  sAtc[0] = '\0';
  sAtc[1] = '\0';
  puVar5 = BuffSnd;
  for (lVar6 = 0x200; lVar6 != 0; lVar6 = lVar6 + -1) {
    puVar5[0] = '\0';
    puVar5[1] = '\0';
    puVar5[2] = '\0';
    puVar5[3] = '\0';
    puVar5[4] = '\0';
    puVar5[5] = '\0';
    puVar5[6] = '\0';
    puVar5[7] = '\0';
    puVar5 = puVar5 + (ulong)bVar11 * -0x10 + 8;
  }
  sDac[0] = '\0';
  sDac[1] = '\0';
  sFormatedPan[8] = '\0';
  sAtc[2] = '\0';
  sUn[0] = '\0';
  sUn[1] = '\0';
  sUn[2] = '\0';
  sUn[3] = '\0';
  sUn[4] = '\0';
  sDac[2] = '\0';
  sDn[2] = '\0';
  puVar5 = BuffRcv;
  for (lVar6 = 0x200; lVar6 != 0; lVar6 = lVar6 + -1) {
    puVar5[0] = '\0';
    puVar5[1] = '\0';
    puVar5[2] = '\0';
    puVar5[3] = '\0';
    puVar5[4] = '\0';
    puVar5[5] = '\0';
    puVar5[6] = '\0';
    puVar5[7] = '\0';
    puVar5 = puVar5 + (ulong)bVar11 * -0x10 + 8;
  }
  puVar5 = sAC_Key;
  for (lVar6 = 0x20; lVar6 != 0; lVar6 = lVar6 + -1) {
    puVar5[0] = '\0';
    puVar5[1] = '\0';
    puVar5[2] = '\0';
    puVar5[3] = '\0';
    puVar5[4] = '\0';
    puVar5[5] = '\0';
    puVar5[6] = '\0';
    puVar5[7] = '\0';
    puVar5 = puVar5 + (ulong)bVar11 * -0x10 + 8;
  }
  puVar5 = (uchar *)szWork;
  for (lVar6 = 0x200; lVar6 != 0; lVar6 = lVar6 + -1) {
    puVar5[0] = '\0';
    puVar5[1] = '\0';
    puVar5[2] = '\0';
    puVar5[3] = '\0';
    puVar5[4] = '\0';
    puVar5[5] = '\0';
    puVar5[6] = '\0';
    puVar5[7] = '\0';
    puVar5 = puVar5 + (ulong)bVar11 * -0x10 + 8;
  }
  puVar8 = (uint *)sTmpField;
  for (lVar6 = 0x200; lVar6 != 0; lVar6 = lVar6 + -1) {
    puVar8[0] = 0;
    puVar8[1] = 0;
    puVar8 = puVar8 + (ulong)bVar11 * -4 + 2;
  }
  pcVar9 = sTmpData;
  for (lVar6 = 0x200; lVar6 != 0; lVar6 = lVar6 + -1) {
    pcVar9[0] = '\0';
    pcVar9[1] = '\0';
    pcVar9[2] = '\0';
    pcVar9[3] = '\0';
    pcVar9[4] = '\0';
    pcVar9[5] = '\0';
    pcVar9[6] = '\0';
    pcVar9[7] = '\0';
    pcVar9 = pcVar9 + (ulong)bVar11 * -0x10 + 8;
  }
  sDn[0] = '\0';
  sDn[1] = '\0';
  pcVar9 = sIccData;
  for (lVar6 = 0x200; lVar6 != 0; lVar6 = lVar6 + -1) {
    pcVar9[0] = '\0';
    pcVar9[1] = '\0';
    pcVar9[2] = '\0';
    pcVar9[3] = '\0';
    pcVar9[4] = '\0';
    pcVar9[5] = '\0';
    pcVar9[6] = '\0';
    pcVar9[7] = '\0';
    pcVar9 = pcVar9 + (ulong)bVar11 * -0x10 + 8;
  }
  iVar1 = GetTlvBuffer("002",sTlvBuffer,(char *)sPan,&nLenData);
  if (iVar1 == 0) {
    sSeqNumber[0] = '\0';
    sSeqNumber[1] = '\0';
    sSeqNumber[2] = '\0';
    sSeqNumber[3] = '\0';
    sSeqNumber[4] = '\0';
    sSeqNumber[5] = '\0';
    sSeqNumber[6] = '\0';
    sSeqNumber[7] = '\0';
    sSeqNumber[8] = '\0';
    iVar1 = GetTlvBuffer("023",sTlvBuffer,(char *)sSeqNumber,&nLenData);
    if (iVar1 != 0) {
      builtin_strncpy(sHsmResultCode,"-PAN",4);
      pcVar9 = "ERROR WhiLe GetIsoIcTag(ISO_TAG_TRANS_SEQ_NUM) ";
      goto LAB_00471d44;
    }
    iVar4 = 0;
    sprintf(sLine,"SEQUENCE NUMBER             : %s",sSeqNumber);
    trace_event(sLine,5);
    trace_event("- Data Authentication Verification ---------------",5);
    iVar1 = memcmp(sDacFlag,&DAT_004cf51a,3);
    if (iVar1 == 0) {
      iVar4 = Get_IM_Key(nIndexCtx,(char *)sPan,(char *)sAC_Key,"DAC");
    }
    iVar1 = memcmp(sDacFlag,&DAT_004cf51e,3);
    if (iVar1 == 0) {
      iVar4 = Get_IM_Key(nIndexCtx,(char *)sPan,(char *)sAC_Key,"IDN");
    }
    if (iVar4 != 0) {
      builtin_strncpy(sHsmResultCode,"-DMK",4);
      trace_event("INVALID KEY DMK ",1);
      trace_event("END   check_data_authen(KEY_UNAVAILABLE)",5);
      return 3;
    }
    sprintf(sLine,"AC KEY IS                  : %s",sAC_Key);
    trace_event(sLine,5);
    builtin_strncpy(szWork,"0000000000000000",0x10);
    puVar8 = (uint *)sPan;
    do {
      puVar7 = puVar8;
      uVar2 = *puVar7 + 0xfefefeff & ~*puVar7;
      uVar3 = uVar2 & 0x80808080;
      puVar8 = puVar7 + 1;
    } while (uVar3 == 0);
    bVar10 = (uVar2 & 0x8080) == 0;
    if (bVar10) {
      uVar3 = uVar3 >> 0x10;
    }
    if (bVar10) {
      puVar8 = (uint *)((long)puVar7 + 6);
    }
    pcVar9 = (char *)((long)puVar8 + ((-3 - (ulong)CARRY1((byte)uVar3,(byte)uVar3)) - (long)sPan));
    memcpy(sTmpField,sPan,(size_t)pcVar9);
    *(undefined2 *)((long)sTmpField + (long)pcVar9) = sSeqNumber._1_2_;
    puVar8 = (uint *)sTmpField;
    do {
      puVar7 = puVar8;
      uVar2 = *puVar7 + 0xfefefeff & ~*puVar7;
      uVar3 = uVar2 & 0x80808080;
      puVar8 = puVar7 + 1;
    } while (uVar3 == 0);
    bVar10 = (uVar2 & 0x8080) == 0;
    if (bVar10) {
      uVar3 = uVar3 >> 0x10;
    }
    if (bVar10) {
      puVar8 = (uint *)((long)puVar7 + 6);
    }
    nLenWork = (((int)puVar8 + -3) - (uint)CARRY1((byte)uVar3,(byte)uVar3)) - (int)sTmpField;
    if (nLenWork < 0x10) {
      memcpy(szWork + (0x10 - nLenWork),sTmpField,(long)nLenWork);
    }
    else {
      szWork._0_8_ = *(undefined8 *)(sIccData + (long)nLenWork + 0xff0);
      szWork._8_8_ = *(undefined8 *)(sIccData + (long)nLenWork + 0xff8);
    }
    AsciiToHex((uchar *)szWork,sFormatedPan,0x10);
    if (debug_option == 1) {
      sprintf(sLine,"PRE FORMATED PAN            : %s",szWork);
      trace_event(sLine,5);
    }
    iVar1 = GetTlvBuffer("055",sTlvBuffer,sIccData,&nIccLen);
    if (iVar1 == 0) {
      InitTlvPrivate(&tlvInfo);
      AnalyseTlvPrivate(sIccData,nIccLen,&tlvInfo);
      iVar1 = memcmp(sDacFlag,&DAT_004cf51a,3);
      sAtc[0] = '0';
      sAtc[1] = '0';
      puVar5 = (uchar *)szWork;
      for (lVar6 = 0x200; lVar6 != 0; lVar6 = lVar6 + -1) {
        puVar5[0] = '\0';
        puVar5[1] = '\0';
        puVar5[2] = '\0';
        puVar5[3] = '\0';
        puVar5[4] = '\0';
        puVar5[5] = '\0';
        puVar5[6] = '\0';
        puVar5[7] = '\0';
        puVar5 = puVar5 + (ulong)bVar11 * -0x10 + 8;
      }
      iVar4 = GetTlvPrivate("C07",&tlvInfo,szWork,&nLenWork);
      if (iVar4 == 0) {
        AsciiToHex((uchar *)szWork,sAtc,4);
      }
      sprintf(sLine,"ATC                         : %s",szWork);
      trace_event(sLine,5);
      puVar5 = (uchar *)szWork;
      for (lVar6 = 0x200; lVar6 != 0; lVar6 = lVar6 + -1) {
        puVar5[0] = '\0';
        puVar5[1] = '\0';
        puVar5[2] = '\0';
        puVar5[3] = '\0';
        puVar5[4] = '\0';
        puVar5[5] = '\0';
        puVar5[6] = '\0';
        puVar5[7] = '\0';
        puVar5 = puVar5 + (ulong)bVar11 * -0x10 + 8;
      }
      iVar4 = GetTlvPrivate("C08",&tlvInfo,szWork,&nLenWork);
      if (iVar4 == 0) {
        AsciiToHex((uchar *)szWork,sUn,8);
      }
      sprintf(sLine,"UN                          : %s",szWork);
      trace_event(sLine,5);
      puVar5 = (uchar *)szWork;
      for (lVar6 = 0x200; lVar6 != 0; lVar6 = lVar6 + -1) {
        puVar5[0] = '\0';
        puVar5[1] = '\0';
        puVar5[2] = '\0';
        puVar5[3] = '\0';
        puVar5[4] = '\0';
        puVar5[5] = '\0';
        puVar5[6] = '\0';
        puVar5[7] = '\0';
        puVar5 = puVar5 + (ulong)bVar11 * -0x10 + 8;
      }
      sprintf(sLine,"DAC                         : %s",szWork);
      trace_event(sLine,5);
      puVar5 = (uchar *)szWork;
      for (lVar6 = 0x200; lVar6 != 0; lVar6 = lVar6 + -1) {
        puVar5[0] = '\0';
        puVar5[1] = '\0';
        puVar5[2] = '\0';
        puVar5[3] = '\0';
        puVar5[4] = '\0';
        puVar5[5] = '\0';
        puVar5[6] = '\0';
        puVar5[7] = '\0';
        puVar5 = puVar5 + (ulong)bVar11 * -0x10 + 8;
      }
      sprintf(sLine,"IDN                        : %s",szWork);
      trace_event(sLine,5);
      iVar4 = memcmp(sDacFlag,&DAT_004cf51a,3);
      if (iVar4 == 0) {
        puVar5 = sDac;
      }
      else {
        puVar5 = sDn;
      }
      iVar1 = command_KS((char *)BuffSnd,'1' - (iVar1 == 0),'1',(char *)sAC_Key,(char *)sFormatedPan
                         ,(char *)sAtc,(char *)sUn,(char *)puVar5);
      iVar4 = CheckResource(nIndexCtx,"070000",&nPid);
      if ((iVar4 != 0) ||
         (iVar1 = HsmQueryBin(nIndexCtx,nPid,(char *)BuffSnd,iVar1,(char *)BuffRcv), iVar1 == 0x3ef)
         ) {
        builtin_strncpy(sHsmResultCode,"UNVL",4);
        trace_event("HSM FOR VERIFICATION NOT AVAILABLE",1);
        trace_event("End   check_data_authen(HSM_UNAVAILABLE)",5);
        return 9;
      }
      if (iVar1 == 3) {
        builtin_strncpy(sHsmResultCode,"UNVL",4);
        trace_event("HSM MALFUNCTION DETECTED",1);
        trace_event("End   check_data_authen(MALFUNCTION)",5);
        return 3;
      }
      puVar5 = (uchar *)szWork;
      for (lVar6 = 0x200; lVar6 != 0; lVar6 = lVar6 + -1) {
        puVar5[0] = '\0';
        puVar5[1] = '\0';
        puVar5[2] = '\0';
        puVar5[3] = '\0';
        puVar5[4] = '\0';
        puVar5[5] = '\0';
        puVar5[6] = '\0';
        puVar5[7] = '\0';
        puVar5 = puVar5 + (ulong)bVar11 * -0x10 + 8;
      }
      iVar1 = command_KT((char *)BuffRcv,sHsmResultCode,szWork);
      if (iVar1 != 0) {
        if (iVar1 == 1) {
          trace_event("End   check_data_authen(VERIFICATION_FAILED)",5);
          return 1;
        }
        if (iVar1 == 0x7d1) {
          trace_event("End check_data_authen(ERROR_COMMAND)",5);
          return 3;
        }
        trace_event("End   check_data_authen(CRYPTOGRAPHIC_ERROR)",5);
        return 2;
      }
      trace_event("End   check_data_authen(OK)",5);
      return 0;
    }
  }
  pcVar9 = "ERROR WhiLe GetTlvBuffer(AUTO_PAN) ";
  builtin_strncpy(sHsmResultCode,"-PAN",4);
LAB_00471d44:
  trace_event(pcVar9,1);
  trace_event("END   check_data_authen(NOK)",5);
  return 3;
}



// WARNING: Restarted to delay deadcode elimination for space: stack
// WARNING: Unknown calling convention

int gen_dpas_iss_script_data(int nIndexCtx,char *sTlvBuffer,char *sHsmResultCode)

{
  uchar uVar1;
  int iVar2;
  uint uVar3;
  uint uVar4;
  uint *puVar5;
  uint *puVar6;
  long lVar7;
  ulong uVar8;
  ulong uVar9;
  uchar *puVar10;
  char *pcVar11;
  uchar *puVar12;
  int nPlainTextLen;
  bool bVar13;
  byte bVar14;
  char *in_stack_fffffffffffeb998;
  char *in_stack_fffffffffffeb9a0;
  char *in_stack_fffffffffffeb9a8;
  uchar *in_stack_fffffffffffeb9b0;
  char in_stack_fffffffffffeb9b8;
  char cStack_1453e;
  byte bStack_1453d;
  uchar sAtc [3];
  int nLenWork;
  int nLenData;
  int nIccLen;
  int nSequence;
  int nSecureMsgLen;
  pid_t nPid;
  uchar sIccApplicationIndx [5];
  uchar sUn [5];
  char v_icc_application_index [5];
  char v_issuing_bank_code [7];
  uchar sBankCode [9];
  uchar sSeqNumber [9];
  uchar sFormatedPan [9];
  uchar sArqc [9];
  char sPan12 [13];
  uchar sARQC [17];
  char sTransDate [17];
  char sRefNbr [17];
  char sPinBlkBCD [17];
  uchar sPan [23];
  char sCvr [33];
  uchar sSMI_Key [256];
  uchar sSMC_Key [256];
  uchar sAC_Key [256];
  uchar sKEY_TYPE [256];
  uchar sTK_Key [256];
  char sProcCode [256];
  char sPinPek [256];
  char sPek [256];
  char sSrcPBFrmt [256];
  char IV [33];
  char sLine [512];
  uchar BuffSnd [4096];
  uchar BuffRcv [4096];
  uchar sIntegSessData [4096];
  uchar sPlainTextData [4096];
  uchar sCipherTextData [4096];
  uchar sMAC [4096];
  uchar sSecureMsgData [4096];
  uchar sIssCmdData [4096];
  uchar sIssCmdData2 [4096];
  uchar sIssScriptData [4096];
  uchar sAuthDeclFlag [4096];
  uchar sTag71 [4096];
  uchar sTag72 [4096];
  char szWork [4096];
  char sIccData [4096];
  char sTmpField [4096];
  char sTmpData [4096];
  TSTlvPrivate tlvInfo;
  
  bVar14 = 0;
  nLenWork = 0;
  nLenData = 0;
  nIccLen = 0;
  nSequence = 0;
  trace_event("Start gen_dpas_iss_script_data()",5);
  sBankCode[0] = '\0';
  sBankCode[1] = '\0';
  sBankCode[2] = '\0';
  sBankCode[3] = '\0';
  sBankCode[4] = '\0';
  sBankCode[5] = '\0';
  sBankCode[6] = '\0';
  sBankCode[7] = '\0';
  sBankCode[8] = '\0';
  sIccApplicationIndx[0] = '\0';
  sIccApplicationIndx[1] = '\0';
  sIccApplicationIndx[2] = '\0';
  sIccApplicationIndx[3] = '\0';
  puVar10 = BuffSnd;
  for (lVar7 = 0x200; lVar7 != 0; lVar7 = lVar7 + -1) {
    puVar10[0] = '\0';
    puVar10[1] = '\0';
    puVar10[2] = '\0';
    puVar10[3] = '\0';
    puVar10[4] = '\0';
    puVar10[5] = '\0';
    puVar10[6] = '\0';
    puVar10[7] = '\0';
    puVar10 = puVar10 + (ulong)bVar14 * -0x10 + 8;
  }
  sIccApplicationIndx[4] = '\0';
  sFormatedPan[0] = '\0';
  sFormatedPan[1] = '\0';
  sFormatedPan[2] = '\0';
  sFormatedPan[3] = '\0';
  sFormatedPan[4] = '\0';
  sFormatedPan[5] = '\0';
  sFormatedPan[6] = '\0';
  sFormatedPan[7] = '\0';
  sFormatedPan[8] = '\0';
  sArqc[0] = '\0';
  sArqc[1] = '\0';
  sArqc[2] = '\0';
  sArqc[3] = '\0';
  sArqc[4] = '\0';
  sArqc[5] = '\0';
  sArqc[6] = '\0';
  sArqc[7] = '\0';
  sArqc[8] = '\0';
  sARQC[0] = '\0';
  sARQC[1] = '\0';
  sARQC[2] = '\0';
  sARQC[3] = '\0';
  sARQC[4] = '\0';
  sARQC[5] = '\0';
  sARQC[6] = '\0';
  sARQC[7] = '\0';
  sARQC[8] = '\0';
  sARQC[9] = '\0';
  sARQC[10] = '\0';
  sARQC[0xb] = '\0';
  sARQC[0xc] = '\0';
  sARQC[0xd] = '\0';
  sARQC[0xe] = '\0';
  sARQC[0xf] = '\0';
  sARQC[0x10] = '\0';
  puVar10 = BuffRcv;
  for (lVar7 = 0x200; lVar7 != 0; lVar7 = lVar7 + -1) {
    puVar10[0] = '\0';
    puVar10[1] = '\0';
    puVar10[2] = '\0';
    puVar10[3] = '\0';
    puVar10[4] = '\0';
    puVar10[5] = '\0';
    puVar10[6] = '\0';
    puVar10[7] = '\0';
    puVar10 = puVar10 + (ulong)bVar14 * -0x10 + 8;
  }
  puVar10 = sPlainTextData;
  for (lVar7 = 0x200; lVar7 != 0; lVar7 = lVar7 + -1) {
    puVar10[0] = '\0';
    puVar10[1] = '\0';
    puVar10[2] = '\0';
    puVar10[3] = '\0';
    puVar10[4] = '\0';
    puVar10[5] = '\0';
    puVar10[6] = '\0';
    puVar10[7] = '\0';
    puVar10 = puVar10 + (ulong)bVar14 * -0x10 + 8;
  }
  puVar10 = sCipherTextData;
  for (lVar7 = 0x200; lVar7 != 0; lVar7 = lVar7 + -1) {
    puVar10[0] = '\0';
    puVar10[1] = '\0';
    puVar10[2] = '\0';
    puVar10[3] = '\0';
    puVar10[4] = '\0';
    puVar10[5] = '\0';
    puVar10[6] = '\0';
    puVar10[7] = '\0';
    puVar10 = puVar10 + (ulong)bVar14 * -0x10 + 8;
  }
  puVar10 = sSecureMsgData;
  for (lVar7 = 0x200; lVar7 != 0; lVar7 = lVar7 + -1) {
    puVar10[0] = '\0';
    puVar10[1] = '\0';
    puVar10[2] = '\0';
    puVar10[3] = '\0';
    puVar10[4] = '\0';
    puVar10[5] = '\0';
    puVar10[6] = '\0';
    puVar10[7] = '\0';
    puVar10 = puVar10 + (ulong)bVar14 * -0x10 + 8;
  }
  puVar10 = sIssScriptData;
  for (lVar7 = 0x200; lVar7 != 0; lVar7 = lVar7 + -1) {
    puVar10[0] = '\0';
    puVar10[1] = '\0';
    puVar10[2] = '\0';
    puVar10[3] = '\0';
    puVar10[4] = '\0';
    puVar10[5] = '\0';
    puVar10[6] = '\0';
    puVar10[7] = '\0';
    puVar10 = puVar10 + (ulong)bVar14 * -0x10 + 8;
  }
  puVar10 = sIntegSessData;
  for (lVar7 = 0x200; lVar7 != 0; lVar7 = lVar7 + -1) {
    puVar10[0] = '\0';
    puVar10[1] = '\0';
    puVar10[2] = '\0';
    puVar10[3] = '\0';
    puVar10[4] = '\0';
    puVar10[5] = '\0';
    puVar10[6] = '\0';
    puVar10[7] = '\0';
    puVar10 = puVar10 + (ulong)bVar14 * -0x10 + 8;
  }
  puVar10 = sMAC;
  for (lVar7 = 0x200; lVar7 != 0; lVar7 = lVar7 + -1) {
    puVar10[0] = '\0';
    puVar10[1] = '\0';
    puVar10[2] = '\0';
    puVar10[3] = '\0';
    puVar10[4] = '\0';
    puVar10[5] = '\0';
    puVar10[6] = '\0';
    puVar10[7] = '\0';
    puVar10 = puVar10 + (ulong)bVar14 * -0x10 + 8;
  }
  puVar10 = sSMI_Key;
  for (lVar7 = 0x20; lVar7 != 0; lVar7 = lVar7 + -1) {
    puVar10[0] = '\0';
    puVar10[1] = '\0';
    puVar10[2] = '\0';
    puVar10[3] = '\0';
    puVar10[4] = '\0';
    puVar10[5] = '\0';
    puVar10[6] = '\0';
    puVar10[7] = '\0';
    puVar10 = puVar10 + (ulong)bVar14 * -0x10 + 8;
  }
  puVar10 = sSMC_Key;
  for (lVar7 = 0x20; lVar7 != 0; lVar7 = lVar7 + -1) {
    puVar10[0] = '\0';
    puVar10[1] = '\0';
    puVar10[2] = '\0';
    puVar10[3] = '\0';
    puVar10[4] = '\0';
    puVar10[5] = '\0';
    puVar10[6] = '\0';
    puVar10[7] = '\0';
    puVar10 = puVar10 + (ulong)bVar14 * -0x10 + 8;
  }
  puVar10 = sAC_Key;
  for (lVar7 = 0x20; lVar7 != 0; lVar7 = lVar7 + -1) {
    puVar10[0] = '\0';
    puVar10[1] = '\0';
    puVar10[2] = '\0';
    puVar10[3] = '\0';
    puVar10[4] = '\0';
    puVar10[5] = '\0';
    puVar10[6] = '\0';
    puVar10[7] = '\0';
    puVar10 = puVar10 + (ulong)bVar14 * -0x10 + 8;
  }
  puVar10 = sTK_Key;
  for (lVar7 = 0x20; lVar7 != 0; lVar7 = lVar7 + -1) {
    puVar10[0] = '\0';
    puVar10[1] = '\0';
    puVar10[2] = '\0';
    puVar10[3] = '\0';
    puVar10[4] = '\0';
    puVar10[5] = '\0';
    puVar10[6] = '\0';
    puVar10[7] = '\0';
    puVar10 = puVar10 + (ulong)bVar14 * -0x10 + 8;
  }
  puVar6 = (uint *)szWork;
  for (lVar7 = 0x200; lVar7 != 0; lVar7 = lVar7 + -1) {
    puVar6[0] = 0;
    puVar6[1] = 0;
    puVar6 = puVar6 + (ulong)bVar14 * -4 + 2;
  }
  sCvr[0] = '\0';
  sCvr[1] = '\0';
  sCvr[2] = '\0';
  sCvr[3] = '\0';
  sCvr[4] = '\0';
  sCvr[5] = '\0';
  sCvr[6] = '\0';
  sCvr[7] = '\0';
  sCvr[8] = '\0';
  sCvr[9] = '\0';
  sCvr[10] = '\0';
  sCvr[0xb] = '\0';
  sCvr[0xc] = '\0';
  sCvr[0xd] = '\0';
  sCvr[0xe] = '\0';
  sCvr[0xf] = '\0';
  sCvr[0x10] = '\0';
  sCvr[0x11] = '\0';
  sCvr[0x12] = '\0';
  sCvr[0x13] = '\0';
  sCvr[0x14] = '\0';
  sCvr[0x15] = '\0';
  sCvr[0x16] = '\0';
  sCvr[0x17] = '\0';
  sCvr[0x18] = '\0';
  sCvr[0x19] = '\0';
  sCvr[0x1a] = '\0';
  sCvr[0x1b] = '\0';
  sCvr[0x1c] = '\0';
  sCvr[0x1d] = '\0';
  sCvr[0x1e] = '\0';
  sCvr[0x1f] = '\0';
  sCvr[0x20] = '\0';
  v_icc_application_index[0] = '\0';
  v_icc_application_index[1] = '\0';
  v_icc_application_index[2] = '\0';
  v_icc_application_index[3] = '\0';
  v_icc_application_index[4] = '\0';
  v_issuing_bank_code[0] = '\0';
  v_issuing_bank_code[1] = '\0';
  v_issuing_bank_code[2] = '\0';
  v_issuing_bank_code[3] = '\0';
  v_issuing_bank_code[6] = '\0';
  sTransDate[0] = '\0';
  sTransDate[1] = '\0';
  sTransDate[2] = '\0';
  sTransDate[3] = '\0';
  sTransDate[4] = '\0';
  sTransDate[5] = '\0';
  sTransDate[6] = '\0';
  sTransDate[7] = '\0';
  sTransDate[8] = '\0';
  sTransDate[9] = '\0';
  sTransDate[10] = '\0';
  sTransDate[0xb] = '\0';
  sTransDate[0xc] = '\0';
  sTransDate[0xd] = '\0';
  sTransDate[0xe] = '\0';
  sTransDate[0xf] = '\0';
  sTransDate[0x10] = '\0';
  puVar6 = (uint *)sTmpField;
  for (lVar7 = 0x200; lVar7 != 0; lVar7 = lVar7 + -1) {
    puVar6[0] = 0;
    puVar6[1] = 0;
    puVar6 = puVar6 + (ulong)bVar14 * -4 + 2;
  }
  puVar10 = (uchar *)sTmpData;
  for (lVar7 = 0x200; lVar7 != 0; lVar7 = lVar7 + -1) {
    puVar10[0] = '\0';
    puVar10[1] = '\0';
    puVar10[2] = '\0';
    puVar10[3] = '\0';
    puVar10[4] = '\0';
    puVar10[5] = '\0';
    puVar10[6] = '\0';
    puVar10[7] = '\0';
    puVar10 = puVar10 + (ulong)bVar14 * -0x10 + 8;
  }
  pcVar11 = sProcCode;
  for (lVar7 = 0x20; lVar7 != 0; lVar7 = lVar7 + -1) {
    pcVar11[0] = '\0';
    pcVar11[1] = '\0';
    pcVar11[2] = '\0';
    pcVar11[3] = '\0';
    pcVar11[4] = '\0';
    pcVar11[5] = '\0';
    pcVar11[6] = '\0';
    pcVar11[7] = '\0';
    pcVar11 = pcVar11 + (ulong)bVar14 * -0x10 + 8;
  }
  puVar10 = (uchar *)sPinPek;
  for (lVar7 = 0x20; lVar7 != 0; lVar7 = lVar7 + -1) {
    puVar10[0] = '\0';
    puVar10[1] = '\0';
    puVar10[2] = '\0';
    puVar10[3] = '\0';
    puVar10[4] = '\0';
    puVar10[5] = '\0';
    puVar10[6] = '\0';
    puVar10[7] = '\0';
    puVar10 = puVar10 + (ulong)bVar14 * -0x10 + 8;
  }
  pcVar11 = sPek;
  for (lVar7 = 0x20; lVar7 != 0; lVar7 = lVar7 + -1) {
    pcVar11[0] = '\0';
    pcVar11[1] = '\0';
    pcVar11[2] = '\0';
    pcVar11[3] = '\0';
    pcVar11[4] = '\0';
    pcVar11[5] = '\0';
    pcVar11[6] = '\0';
    pcVar11[7] = '\0';
    pcVar11 = pcVar11 + (ulong)bVar14 * -0x10 + 8;
  }
  pcVar11 = sSrcPBFrmt;
  for (lVar7 = 0x20; lVar7 != 0; lVar7 = lVar7 + -1) {
    pcVar11[0] = '\0';
    pcVar11[1] = '\0';
    pcVar11[2] = '\0';
    pcVar11[3] = '\0';
    pcVar11[4] = '\0';
    pcVar11[5] = '\0';
    pcVar11[6] = '\0';
    pcVar11[7] = '\0';
    pcVar11 = pcVar11 + (ulong)bVar14 * -0x10 + 8;
  }
  v_issuing_bank_code[4] = '\0';
  v_issuing_bank_code[5] = '\0';
  puVar10 = sTag71;
  for (lVar7 = 0x200; lVar7 != 0; lVar7 = lVar7 + -1) {
    puVar10[0] = '\0';
    puVar10[1] = '\0';
    puVar10[2] = '\0';
    puVar10[3] = '\0';
    puVar10[4] = '\0';
    puVar10[5] = '\0';
    puVar10[6] = '\0';
    puVar10[7] = '\0';
    puVar10 = puVar10 + (ulong)bVar14 * -0x10 + 8;
  }
  puVar10 = sTag72;
  for (lVar7 = 0x200; lVar7 != 0; lVar7 = lVar7 + -1) {
    puVar10[0] = '\0';
    puVar10[1] = '\0';
    puVar10[2] = '\0';
    puVar10[3] = '\0';
    puVar10[4] = '\0';
    puVar10[5] = '\0';
    puVar10[6] = '\0';
    puVar10[7] = '\0';
    puVar10 = puVar10 + (ulong)bVar14 * -0x10 + 8;
  }
  puVar10 = sIssCmdData;
  for (lVar7 = 0x200; lVar7 != 0; lVar7 = lVar7 + -1) {
    puVar10[0] = '\0';
    puVar10[1] = '\0';
    puVar10[2] = '\0';
    puVar10[3] = '\0';
    puVar10[4] = '\0';
    puVar10[5] = '\0';
    puVar10[6] = '\0';
    puVar10[7] = '\0';
    puVar10 = puVar10 + (ulong)bVar14 * -0x10 + 8;
  }
  puVar10 = sIssCmdData2;
  for (lVar7 = 0x200; lVar7 != 0; lVar7 = lVar7 + -1) {
    puVar10[0] = '\0';
    puVar10[1] = '\0';
    puVar10[2] = '\0';
    puVar10[3] = '\0';
    puVar10[4] = '\0';
    puVar10[5] = '\0';
    puVar10[6] = '\0';
    puVar10[7] = '\0';
    puVar10 = puVar10 + (ulong)bVar14 * -0x10 + 8;
  }
  iVar2 = GetTlvBuffer("205",sTlvBuffer,(char *)sBankCode,&nLenData);
  if (iVar2 != 0) {
LAB_00472768:
    pcVar11 = "ERROR WhiLe GetTlvBuffer(AUTO_ISSUING_BANK) ";
    goto LAB_00472774;
  }
  iVar2 = GetTlvBuffer("900",sTlvBuffer,(char *)sIccApplicationIndx,&nLenData);
  if (iVar2 == 0) {
    iVar2 = GetTlvBuffer("003",sTlvBuffer,sTmpField,&nLenData);
    if (iVar2 != 0) {
      pcVar11 = "ERROR WhiLe GetTlvBuffer(ProcessingCode) ";
      builtin_strncpy(sHsmResultCode,"-PCD",4);
      goto LAB_00472774;
    }
    sProcCode[0] = sTmpField[6];
    sProcCode[1] = sTmpField[7];
    iVar2 = GetTlvBuffer("002",sTlvBuffer,(char *)sPan,&nLenData);
    if (iVar2 == 0) {
      iVar2 = GetTlvBuffer("037",sTlvBuffer,sRefNbr,&nLenData);
      if (iVar2 != 0) {
        pcVar11 = "ERROR WhiLe GetTlvBuffer(Reference Number) ";
        builtin_strncpy(sHsmResultCode,"-PCD",4);
        goto LAB_00472774;
      }
      iVar2 = GetTlvBuffer("007",sTlvBuffer,sTransDate,&nLenData);
      if (iVar2 != 0) {
        pcVar11 = "ERROR WhiLe GetTlvBuffer(TRANS_DATE_TIME) ";
        builtin_strncpy(sHsmResultCode,"-PCD",4);
        goto LAB_00472774;
      }
      iVar2 = memcmp(sProcCode,&DAT_004aac5d,2);
      if (iVar2 == 0) {
        iVar2 = GetTlvBuffer("031",sTlvBuffer,sPinPek,&nLenData);
        if (iVar2 != 0) {
          builtin_strncpy(sHsmResultCode,"-PIN",4);
          trace_event("END   gen_dpas_iss_script_data(NOK) <ERROR ON GetTlvBuffer(AUTO_ACQUIRER_REF_DATA-NEW_PIN)>"
                      ,5);
          return 3;
        }
        iVar2 = GetTlvBuffer("048",sTlvBuffer,sTmpField,&nLenData);
        if (iVar2 != 0) {
          builtin_strncpy(sHsmResultCode,"-F48",4);
          trace_event("END   gen_dpas_iss_script_data(NOK) <ERROR ON GetTlvBuffer(AUTO_ADD_DATA_PRIVATE)>"
                      ,5);
          return 3;
        }
        InitTlvPrivate(&tlvInfo);
        AnalyseTlvPrivate(sTmpField,nLenData,&tlvInfo);
        iVar2 = GetTlvPrivate("P10",&tlvInfo,sPek,&nLenData);
        if (iVar2 != 0) {
          builtin_strncpy(sHsmResultCode,"-PEK",4);
          trace_event("END   gen_dpas_iss_script_data(NOK) <ERROR ON GetTlvPrivate(ENCR_PIN_BLOCK_KEY_TAG)>"
                      ,5);
          return 3;
        }
        iVar2 = GetTlvBuffer("053",sTlvBuffer,sTmpField,&nLenData);
        if (iVar2 != 0) {
          builtin_strncpy(sHsmResultCode,"-F48",4);
          trace_event("END   gen_dpas_iss_script_data(NOK) <ERROR ON GetTlvBuffer(AUTO_SECURITY_DATA)>"
                      ,5);
          return 3;
        }
        GetSecurityData(1,sTmpField,sSrcPBFrmt,&nLenData);
        iVar2 = Get_EMV_Key(nIndexCtx,(char *)sPan,"ENC",(char *)sSMC_Key);
        if (iVar2 != 0) {
          builtin_strncpy(sHsmResultCode,"-SMC",4);
          trace_event("END   gen_dpas_iss_script_data(KEY_UNAVAILABLE) <ERROR ON Get_EMV_Key(ENC)>",
                      5);
          return 3;
        }
        iVar2 = Get_EMV_Key(nIndexCtx,(char *)sPan,"AC",(char *)sAC_Key);
        cStack_1453e = '4';
        if (iVar2 != 0) {
          builtin_strncpy(sHsmResultCode,"-AC_",4);
          trace_event("END   gen_dpas_iss_script_data(KEY_UNAVAILABLE) <ERROR ON Get_EMV_Key(AC)>",5
                     );
          return 3;
        }
      }
      else {
        cStack_1453e = '0';
      }
      sSeqNumber[0] = '\0';
      sSeqNumber[1] = '\0';
      sSeqNumber[2] = '\0';
      sSeqNumber[3] = '\0';
      sSeqNumber[4] = '\0';
      sSeqNumber[5] = '\0';
      sSeqNumber[6] = '\0';
      sSeqNumber[7] = '\0';
      sSeqNumber[8] = '\0';
      iVar2 = GetTlvBuffer("023",sTlvBuffer,(char *)sSeqNumber,&nLenData);
      if (iVar2 != 0) {
        trace_event("DE23 MISSING.  USE THE ZERO VALUE",0);
        sprintf((char *)sSeqNumber,"%03d",0);
      }
      sprintf(sLine,"SEQUENCE NUMBER             =[%s]",sSeqNumber);
      trace_event(sLine,5);
      trace_event("- SMI/SMC PROCESSING ---------------",5);
      puVar6 = (uint *)szWork;
      do {
        puVar5 = puVar6;
        uVar3 = *puVar5 + 0xfefefeff & ~*puVar5;
        uVar4 = uVar3 & 0x80808080;
        puVar6 = puVar5 + 1;
      } while (uVar4 == 0);
      bVar13 = (uVar3 & 0x8080) == 0;
      if (bVar13) {
        uVar4 = uVar4 >> 0x10;
      }
      if (bVar13) {
        puVar6 = (uint *)((long)puVar5 + 6);
      }
      memset(szWork,0,(size_t)((long)puVar6 +
                              ((-3 - (ulong)CARRY1((byte)uVar4,(byte)uVar4)) - (long)szWork)));
      puVar6 = (uint *)sTmpField;
      do {
        puVar5 = puVar6;
        uVar3 = *puVar5 + 0xfefefeff & ~*puVar5;
        uVar4 = uVar3 & 0x80808080;
        puVar6 = puVar5 + 1;
      } while (uVar4 == 0);
      bVar13 = (uVar3 & 0x8080) == 0;
      if (bVar13) {
        uVar4 = uVar4 >> 0x10;
      }
      if (bVar13) {
        puVar6 = (uint *)((long)puVar5 + 6);
      }
      memset(sTmpField,0,
             (size_t)((long)puVar6 +
                     ((-3 - (ulong)CARRY1((byte)uVar4,(byte)uVar4)) - (long)sTmpField)));
      builtin_strncpy(szWork,"0000000000000000",0x10);
      puVar6 = (uint *)sPan;
      do {
        puVar5 = puVar6;
        uVar3 = *puVar5 + 0xfefefeff & ~*puVar5;
        uVar4 = uVar3 & 0x80808080;
        puVar6 = puVar5 + 1;
      } while (uVar4 == 0);
      bVar13 = (uVar3 & 0x8080) == 0;
      if (bVar13) {
        uVar4 = uVar4 >> 0x10;
      }
      if (bVar13) {
        puVar6 = (uint *)((long)puVar5 + 6);
      }
      pcVar11 = (char *)((long)puVar6 + ((-3 - (ulong)CARRY1((byte)uVar4,(byte)uVar4)) - (long)sPan)
                        );
      memcpy(sTmpField,sPan,(size_t)pcVar11);
      *(undefined2 *)((long)sTmpField + (long)pcVar11) = sSeqNumber._1_2_;
      puVar6 = (uint *)sTmpField;
      do {
        puVar5 = puVar6;
        uVar3 = *puVar5 + 0xfefefeff & ~*puVar5;
        uVar4 = uVar3 & 0x80808080;
        puVar6 = puVar5 + 1;
      } while (uVar4 == 0);
      bVar13 = (uVar3 & 0x8080) == 0;
      if (bVar13) {
        uVar4 = uVar4 >> 0x10;
      }
      if (bVar13) {
        puVar6 = (uint *)((long)puVar5 + 6);
      }
      nLenWork = (((int)puVar6 + -3) - (uint)CARRY1((byte)uVar4,(byte)uVar4)) - (int)sTmpField;
      if (nLenWork < 0x10) {
        memcpy((uchar *)((long)szWork + (long)(0x10 - nLenWork)),sTmpField,(long)nLenWork);
      }
      else {
        szWork._0_8_ = *(undefined8 *)(sIccData + (long)nLenWork + 0xff0);
        szWork._8_8_ = *(undefined8 *)(sIccData + (long)nLenWork + 0xff8);
      }
      AsciiToHex((uchar *)szWork,sFormatedPan,0x10);
      if (debug_option == 1) {
        sprintf(sLine,"PRE FORMATED PAN            =[%s]",szWork);
        trace_event(sLine,5);
      }
      iVar2 = GetTlvBuffer("055",sTlvBuffer,sIccData,&nIccLen);
      if (iVar2 == 0) {
        InitTlvPrivate(&tlvInfo);
        AnalyseTlvPrivate(sIccData,nIccLen,&tlvInfo);
        puVar6 = (uint *)szWork;
        for (lVar7 = 0x200; lVar7 != 0; lVar7 = lVar7 + -1) {
          puVar6[0] = 0;
          puVar6[1] = 0;
          puVar6 = puVar6 + (ulong)bVar14 * -4 + 2;
        }
        sAtc[0] = '0';
        sAtc[1] = '0';
        iVar2 = GetTlvPrivate("C07",&tlvInfo,szWork,&nLenWork);
        if (iVar2 == 0) {
          AsciiToHex((uchar *)szWork,sAtc,4);
        }
        sprintf(sLine,"ATC                         =[%s]",szWork);
        trace_event(sLine,5);
        builtin_memcpy(sKEY_TYPE,"MAC",4);
        iVar2 = Get_EMV_Key(nIndexCtx,(char *)sPan,(char *)sKEY_TYPE,(char *)sSMI_Key);
        if (iVar2 != 0) {
          builtin_strncpy(sHsmResultCode,"-SMI",4);
          trace_event("INVALID KEY DMK ",1);
          trace_event("END   gen_dpas_iss_script_data(KEY_UNAVAILABLE)",5);
          return 3;
        }
        sprintf(sLine,"%s KEY IS                  =[%s]",sKEY_TYPE,sSMI_Key);
        trace_event(sLine,5);
        iVar2 = GetTlvPrivate("C01",&tlvInfo,(char *)sARQC,&nLenWork);
        if (iVar2 == 0) {
          AsciiToHex(sARQC,sArqc,0x10);
        }
        sprintf(sLine,"ARQC                        =[%s]",sARQC);
        trace_event(sLine,5);
        puVar6 = (uint *)szWork;
        for (lVar7 = 0x200; lVar7 != 0; lVar7 = lVar7 + -1) {
          puVar6[0] = 0;
          puVar6[1] = 0;
          puVar6 = puVar6 + (ulong)bVar14 * -4 + 2;
        }
        iVar2 = GetTlvPrivate("C08",&tlvInfo,szWork,&nLenWork);
        if (iVar2 == 0) {
          AsciiToHex((uchar *)szWork,sUn,8);
        }
        sprintf(sLine,"UN                          =[%s]",szWork);
        trace_event(sLine,5);
        iVar2 = GetTlvBuffer("205",sTlvBuffer,v_issuing_bank_code,&nLenWork);
        if (iVar2 != 0) {
          builtin_strncpy(sHsmResultCode,"-ICC",4);
          goto LAB_00472768;
        }
        iVar2 = GetTlvBuffer("900",sTlvBuffer,v_icc_application_index,&nLenWork);
        if (iVar2 == 0) {
          puVar6 = (uint *)szWork;
          for (lVar7 = 0x200; lVar7 != 0; lVar7 = lVar7 + -1) {
            puVar6[0] = 0;
            puVar6[1] = 0;
            puVar6 = puVar6 + (ulong)bVar14 * -4 + 2;
          }
          iVar2 = GetTlvPrivate("C20",&tlvInfo,szWork,&nLenWork);
          if (iVar2 != 0) {
            sprintf(szWork,"%32d",0);
          }
          pcVar11 = sCvr;
          for (lVar7 = 0x21; lVar7 != 0; lVar7 = lVar7 + -1) {
            *pcVar11 = '\0';
            pcVar11 = pcVar11 + (ulong)bVar14 * -2 + 1;
          }
          GetCVRFromIAD(nIndexCtx,szWork,v_issuing_bank_code,v_icc_application_index,sCvr);
          Update_SentIssScripts(nIndexCtx,(char *)sPan,sCvr);
          iVar2 = CheckResource(nIndexCtx,"070000",&nPid);
          if (iVar2 != 0) {
LAB_00473880:
            builtin_strncpy(sHsmResultCode,"UNVL",4);
            trace_event("HSM FOR VERIFICATION NOT AVAILABLE",1);
            trace_event("End   gen_dpas_iss_script_data(HSM_UNAVAILABLE)",5);
            return 9;
          }
          nSequence = 0;
          bStack_1453d = 0x30;
          do {
            puVar6 = (uint *)szWork;
            for (lVar7 = 0x200; lVar7 != 0; lVar7 = lVar7 + -1) {
              puVar6[0] = 0;
              puVar6[1] = 0;
              puVar6 = puVar6 + (ulong)bVar14 * -4 + 2;
            }
            puVar10 = sIssCmdData;
            for (lVar7 = 0x200; lVar7 != 0; lVar7 = lVar7 + -1) {
              puVar10[0] = '\0';
              puVar10[1] = '\0';
              puVar10[2] = '\0';
              puVar10[3] = '\0';
              puVar10[4] = '\0';
              puVar10[5] = '\0';
              puVar10[6] = '\0';
              puVar10[7] = '\0';
              puVar10 = puVar10 + (ulong)bVar14 * -0x10 + 8;
            }
            puVar10 = sIssCmdData2;
            for (lVar7 = 0x200; lVar7 != 0; lVar7 = lVar7 + -1) {
              puVar10[0] = '\0';
              puVar10[1] = '\0';
              puVar10[2] = '\0';
              puVar10[3] = '\0';
              puVar10[4] = '\0';
              puVar10[5] = '\0';
              puVar10[6] = '\0';
              puVar10[7] = '\0';
              puVar10 = puVar10 + (ulong)bVar14 * -0x10 + 8;
            }
            puVar10 = sAuthDeclFlag;
            for (lVar7 = 0x200; lVar7 != 0; lVar7 = lVar7 + -1) {
              puVar10[0] = '\0';
              puVar10[1] = '\0';
              puVar10[2] = '\0';
              puVar10[3] = '\0';
              puVar10[4] = '\0';
              puVar10[5] = '\0';
              puVar10[6] = '\0';
              puVar10[7] = '\0';
              puVar10 = puVar10 + (ulong)bVar14 * -0x10 + 8;
            }
            puVar10 = sIntegSessData;
            for (lVar7 = 0x200; lVar7 != 0; lVar7 = lVar7 + -1) {
              puVar10[0] = '\0';
              puVar10[1] = '\0';
              puVar10[2] = '\0';
              puVar10[3] = '\0';
              puVar10[4] = '\0';
              puVar10[5] = '\0';
              puVar10[6] = '\0';
              puVar10[7] = '\0';
              puVar10 = puVar10 + (ulong)bVar14 * -0x10 + 8;
            }
            puVar10 = BuffSnd;
            for (lVar7 = 0x200; lVar7 != 0; lVar7 = lVar7 + -1) {
              puVar10[0] = '\0';
              puVar10[1] = '\0';
              puVar10[2] = '\0';
              puVar10[3] = '\0';
              puVar10[4] = '\0';
              puVar10[5] = '\0';
              puVar10[6] = '\0';
              puVar10[7] = '\0';
              puVar10 = puVar10 + (ulong)bVar14 * -0x10 + 8;
            }
            puVar10 = BuffRcv;
            for (lVar7 = 0x200; lVar7 != 0; lVar7 = lVar7 + -1) {
              puVar10[0] = '\0';
              puVar10[1] = '\0';
              puVar10[2] = '\0';
              puVar10[3] = '\0';
              puVar10[4] = '\0';
              puVar10[5] = '\0';
              puVar10[6] = '\0';
              puVar10[7] = '\0';
              puVar10 = puVar10 + (ulong)bVar14 * -0x10 + 8;
            }
            puVar10 = sPlainTextData;
            for (lVar7 = 0x200; lVar7 != 0; lVar7 = lVar7 + -1) {
              puVar10[0] = '\0';
              puVar10[1] = '\0';
              puVar10[2] = '\0';
              puVar10[3] = '\0';
              puVar10[4] = '\0';
              puVar10[5] = '\0';
              puVar10[6] = '\0';
              puVar10[7] = '\0';
              puVar10 = puVar10 + (ulong)bVar14 * -0x10 + 8;
            }
            iVar2 = memcmp(sProcCode,&DAT_004aac5d,2);
            if (iVar2 == 0) {
              puVar10 = "8424000210";
              puVar12 = sIssCmdData;
              for (lVar7 = 0xb; lVar7 != 0; lVar7 = lVar7 + -1) {
                *puVar12 = *puVar10;
                puVar10 = puVar10 + (ulong)bVar14 * -2 + 1;
                puVar12 = puVar12 + (ulong)bVar14 * -2 + 1;
              }
            }
            else {
              iVar2 = Get_IssScriptData(nIndexCtx,(char *)sPan,(char *)sIssCmdData,&nSequence,
                                        (char *)sAuthDeclFlag,sTransDate,sRefNbr);
              if (iVar2 != 0) {
                trace_event("==> Get_IssScriptData(!OK).  BREAK",5);
                break;
              }
            }
            sprintf(sLine,"ISSUER COMMAND DATA IS       =[%s]",sIssCmdData);
            trace_event(sLine,5);
            sprintf(sLine,"sAuthDeclFlag                =[%s]",sAuthDeclFlag);
            trace_event(sLine,5);
            puVar6 = (uint *)szWork;
            for (lVar7 = 0x200; lVar7 != 0; lVar7 = lVar7 + -1) {
              puVar6[0] = 0;
              puVar6[1] = 0;
              puVar6 = puVar6 + (ulong)bVar14 * -4 + 2;
            }
            sIssCmdData2[0] = sIssCmdData[0];
            sIssCmdData2[1] = sIssCmdData[1];
            sIssCmdData2[2] = sIssCmdData[2];
            sIssCmdData2[3] = sIssCmdData[3];
            sIssCmdData2[4] = sIssCmdData[4];
            sIssCmdData2[5] = sIssCmdData[5];
            sIssCmdData2[6] = sIssCmdData[6];
            sIssCmdData2[7] = sIssCmdData[7];
            sIssCmdData2[8] = sIssCmdData[8];
            sIssCmdData2[9] = sIssCmdData[9];
            iVar2 = memcmp(sProcCode,&DAT_004aac5d,2);
            if (iVar2 == 0) {
              builtin_memcpy(sIssCmdData2 + 10,"0000000000000000",0x10);
            }
            lVar7 = -1;
            puVar10 = sIssCmdData2;
            do {
              if (lVar7 == 0) break;
              lVar7 = lVar7 + -1;
              uVar1 = *puVar10;
              puVar10 = puVar10 + (ulong)bVar14 * -2 + 1;
            } while (uVar1 != '\0');
            AsciiToHex(sIssCmdData2,(uchar *)szWork,~(uint)lVar7 - 1);
            uVar8 = 0xffffffffffffffff;
            puVar10 = sIssCmdData2;
            do {
              if (uVar8 == 0) break;
              uVar8 = uVar8 - 1;
              uVar1 = *puVar10;
              puVar10 = puVar10 + (ulong)bVar14 * -2 + 1;
            } while (uVar1 != '\0');
            uVar8 = ~uVar8 - 1 >> 1;
            memcpy(sPlainTextData,szWork,uVar8);
            sIntegSessData[0] = '\0';
            sIntegSessData[1] = '\0';
            sIntegSessData[2] = '\0';
            sIntegSessData[3] = '\0';
            sIntegSessData[4] = '\0';
            sIntegSessData[5] = '\0';
            sIntegSessData[6] = sAtc[0];
            sIntegSessData[7] = sAtc[1];
            sprintf(sLine,"cSchemeId                \t  =[%c]",(ulong)bStack_1453d);
            trace_event(sLine,5);
            sprintf(sLine,"sAtc                \t\t  =[%s]",sAtc);
            trace_event(sLine,5);
            sprintf(sLine,"sIntegSessData                =[%s]",sIntegSessData);
            trace_event(sLine,5);
            AsciiToHex((uchar *)szWork,sIntegSessData,6);
            sprintf(sLine,"sIntegSessData  AsciiToHex    =[%s]",szWork);
            trace_event(sLine,5);
            iVar2 = memcmp(sProcCode,&DAT_004aac5d,2);
            nPlainTextLen = (int)uVar8;
            if (iVar2 == 0) {
              IV[1] = '4';
              IV[0] = '3';
              IV[2] = '\0';
              sprintf(szWork,"%022d",0);
              uVar8 = 0xffffffffffffffff;
              puVar6 = (uint *)sPan;
              do {
                if (uVar8 == 0) break;
                uVar8 = uVar8 - 1;
                uVar4 = *puVar6;
                puVar6 = (uint *)((long)puVar6 + (ulong)bVar14 * -2 + 1);
              } while ((char)uVar4 != '\0');
              memcpy(szWork + (0x16 - (~uVar8 - 1)),sPan,~uVar8 - 1);
              in_stack_fffffffffffeb9a8 = sPan12;
              sprintf(in_stack_fffffffffffeb9a8,szWork + 9);
              puVar10 = (uchar *)sPinBlkBCD;
              for (lVar7 = 0x11; lVar7 != 0; lVar7 = lVar7 + -1) {
                *puVar10 = '\0';
                puVar10 = puVar10 + (ulong)bVar14 * -2 + 1;
              }
              AsciiToHex((uchar *)sPinPek,(uchar *)sPinBlkBCD,0x10);
              in_stack_fffffffffffeb998 = sSrcPBFrmt;
              in_stack_fffffffffffeb9a0 = IV;
              in_stack_fffffffffffeb9b0 = sAC_Key;
              iVar2 = command_KY((char *)BuffSnd,'4','5',(char *)sSMI_Key,(char *)sFormatedPan,
                                 (char *)sIntegSessData,nPlainTextLen,(char *)sPlainTextData,
                                 (char *)sSMC_Key,sPek,(char *)sIntegSessData,0,8,sPinBlkBCD,
                                 sSrcPBFrmt,IV,in_stack_fffffffffffeb9a8,(char *)sAC_Key);
              iVar2 = HsmQueryBin(nIndexCtx,nPid,(char *)BuffSnd,iVar2,(char *)BuffRcv);
              if (iVar2 == 0x3ef) goto LAB_00473880;
              if (iVar2 == 3) {
LAB_00473cc1:
                builtin_strncpy(sHsmResultCode,"UNVL",4);
                trace_event("HSM MALFUNCTION DETECTED",1);
                trace_event("End   gen_dpas_iss_script_data(MALFUNCTION)",5);
                return 3;
              }
              iVar2 = command_KZ((char *)BuffRcv,'4',sHsmResultCode,(char *)sMAC,&nSecureMsgLen,
                                 (char *)sSecureMsgData);
              if (iVar2 != 0) {
LAB_00473c9c:
                if (iVar2 != 0x7d1) {
                  trace_event("End   gen_dpas_iss_script_data(CRYPTOGRAPHIC_ERROR)",5);
                  return 2;
                }
                trace_event("End   gen_dpas_iss_script_data(ERROR_COMMAND)",5);
                return 3;
              }
              cStack_1453e = '4';
              bStack_1453d = 0x32;
            }
            else {
              pcVar11 = IV;
              for (lVar7 = 0x21; lVar7 != 0; lVar7 = lVar7 + -1) {
                *pcVar11 = '\0';
                pcVar11 = pcVar11 + (ulong)bVar14 * -2 + 1;
              }
              builtin_strncpy(IV,"00000000000000000000000000000000",0x20);
              trace_event("command_KY_MAC",0);
              iVar2 = command_KY_MAC((char *)BuffSnd,cStack_1453e,bStack_1453d,(char *)sSMI_Key,IV,
                                     (char *)sFormatedPan,(char *)sAtc,(char *)sARQC,nPlainTextLen,
                                     (char *)sPlainTextData);
              HsmQueryBin(nIndexCtx,nPid,(char *)BuffSnd,iVar2,(char *)BuffRcv);
              command_KZ((char *)BuffRcv,cStack_1453e,sHsmResultCode,(char *)sMAC,&nSecureMsgLen,
                         (char *)sSecureMsgData);
              trace_event("KU COMMAND",0);
              iVar2 = command_KU((char *)BuffSnd,cStack_1453e,bStack_1453d,(char *)sSMI_Key,
                                 (char *)sFormatedPan,(char *)sIntegSessData,nPlainTextLen,
                                 (char *)sPlainTextData,"","","",0,0,"",in_stack_fffffffffffeb998,
                                 in_stack_fffffffffffeb9a0,in_stack_fffffffffffeb9a8,
                                 (char *)in_stack_fffffffffffeb9b0,in_stack_fffffffffffeb9b8);
              iVar2 = HsmQueryBin(nIndexCtx,nPid,(char *)BuffSnd,iVar2,(char *)BuffRcv);
              if (iVar2 == 0x3ef) goto LAB_00473880;
              if (iVar2 == 3) goto LAB_00473cc1;
              iVar2 = command_KV((char *)BuffRcv,cStack_1453e,sHsmResultCode,(char *)sMAC,
                                 &nSecureMsgLen,(char *)sSecureMsgData);
              if (iVar2 != 0) goto LAB_00473c9c;
            }
            puVar6 = (uint *)szWork;
            for (lVar7 = 0x200; lVar7 != 0; lVar7 = lVar7 + -1) {
              puVar6[0] = 0;
              puVar6[1] = 0;
              puVar6 = puVar6 + (ulong)bVar14 * -4 + 2;
            }
            puVar6 = (uint *)sTmpField;
            for (lVar7 = 0x200; lVar7 != 0; lVar7 = lVar7 + -1) {
              puVar6[0] = 0;
              puVar6[1] = 0;
              puVar6 = puVar6 + (ulong)bVar14 * -4 + 2;
            }
            puVar10 = (uchar *)sTmpData;
            for (lVar7 = 0x200; lVar7 != 0; lVar7 = lVar7 + -1) {
              puVar10[0] = '\0';
              puVar10[1] = '\0';
              puVar10[2] = '\0';
              puVar10[3] = '\0';
              puVar10[4] = '\0';
              puVar10[5] = '\0';
              puVar10[6] = '\0';
              puVar10[7] = '\0';
              puVar10 = puVar10 + (ulong)bVar14 * -0x10 + 8;
            }
            HexToAscii(sMAC,(uchar *)sTmpField,0x10);
            puVar10 = (uchar *)sTmpData;
            for (lVar7 = 0x200; lVar7 != 0; lVar7 = lVar7 + -1) {
              puVar10[0] = '\0';
              puVar10[1] = '\0';
              puVar10[2] = '\0';
              puVar10[3] = '\0';
              puVar10[4] = '\0';
              puVar10[5] = '\0';
              puVar10[6] = '\0';
              puVar10[7] = '\0';
              puVar10 = puVar10 + (ulong)bVar14 * -0x10 + 8;
            }
            HexToAscii(sSecureMsgData,(uchar *)sTmpData,nSecureMsgLen * 2);
            sprintf(sLine,"==> SECURE MESSAGING MAC        =[%s]",sTmpField);
            trace_event(sLine,5);
            sprintf(sLine,"==> SECURE MESSAGING DATA       =[%s]",sTmpData);
            trace_event(sLine,5);
            puVar10 = sIssScriptData;
            for (lVar7 = 0x200; lVar7 != 0; lVar7 = lVar7 + -1) {
              puVar10[0] = '\0';
              puVar10[1] = '\0';
              puVar10[2] = '\0';
              puVar10[3] = '\0';
              puVar10[4] = '\0';
              puVar10[5] = '\0';
              puVar10[6] = '\0';
              puVar10[7] = '\0';
              puVar10 = puVar10 + (ulong)bVar14 * -0x10 + 8;
            }
            uVar8 = 0xffffffffffffffff;
            puVar10 = sIssCmdData;
            do {
              if (uVar8 == 0) break;
              uVar8 = uVar8 - 1;
              uVar1 = *puVar10;
              puVar10 = puVar10 + (ulong)bVar14 * -2 + 1;
            } while (uVar1 != '\0');
            uVar9 = 0xffffffffffffffff;
            puVar6 = (uint *)sTmpField;
            do {
              if (uVar9 == 0) break;
              uVar9 = uVar9 - 1;
              uVar4 = *puVar6;
              puVar6 = (uint *)((long)puVar6 + (ulong)bVar14 * -2 + 1);
            } while ((uchar)uVar4 != '\0');
            sprintf((char *)sIssScriptData,"86%02X",
                    (long)nSecureMsgLen + ((~uVar8 - 2) + ~uVar9 >> 1));
            uVar8 = 0xffffffffffffffff;
            puVar10 = sIssCmdData;
            do {
              if (uVar8 == 0) break;
              uVar8 = uVar8 - 1;
              uVar1 = *puVar10;
              puVar10 = puVar10 + (ulong)bVar14 * -2 + 1;
            } while (uVar1 != '\0');
            uVar9 = 0xffffffffffffffff;
            puVar10 = sIssScriptData;
            do {
              if (uVar9 == 0) break;
              uVar9 = uVar9 - 1;
              uVar1 = *puVar10;
              puVar10 = puVar10 + (ulong)bVar14 * -2 + 1;
            } while (uVar1 != '\0');
            memcpy(sIssCmdData2 + ~uVar9 + 0xfff,sIssCmdData,~uVar8 - 1);
            uVar8 = 0xffffffffffffffff;
            puVar10 = sIssScriptData;
            do {
              if (uVar8 == 0) break;
              uVar8 = uVar8 - 1;
              uVar1 = *puVar10;
              puVar10 = puVar10 + (ulong)bVar14 * -2 + 1;
            } while (uVar1 != '\0');
            memcpy(sIssCmdData2 + ~uVar8 + 0xfff,sTmpData,(long)(nSecureMsgLen * 2));
            uVar8 = 0xffffffffffffffff;
            puVar6 = (uint *)sTmpField;
            do {
              if (uVar8 == 0) break;
              uVar8 = uVar8 - 1;
              uVar4 = *puVar6;
              puVar6 = (uint *)((long)puVar6 + (ulong)bVar14 * -2 + 1);
            } while ((uchar)uVar4 != '\0');
            uVar9 = 0xffffffffffffffff;
            puVar10 = sIssScriptData;
            do {
              if (uVar9 == 0) break;
              uVar9 = uVar9 - 1;
              uVar1 = *puVar10;
              puVar10 = puVar10 + (ulong)bVar14 * -2 + 1;
            } while (uVar1 != '\0');
            memcpy(sIssCmdData2 + ~uVar9 + 0xfff,sTmpField,~uVar8 - 1);
            uVar8 = 0xffffffffffffffff;
            puVar10 = sIssScriptData;
            do {
              if (uVar8 == 0) break;
              uVar8 = uVar8 - 1;
              uVar1 = *puVar10;
              puVar10 = puVar10 + (ulong)bVar14 * -2 + 1;
            } while (uVar1 != '\0');
            memcpy(sTag72,sIssScriptData,~uVar8 - 1);
            sprintf(sLine,"[%s]",sTag72);
            trace_event(sLine,5);
            iVar2 = memcmp(sProcCode,&DAT_004aac5d,2);
          } while (iVar2 != 0);
          if ((sTag71[0] == '\0') && (sTag72[0] == '\0')) {
            trace_event("End   gen_dpas_iss_script_data(NOK). NO ISSUER SCRIPT TO SEND",5);
            return -1;
          }
          lVar7 = -1;
          puVar10 = sTag72;
          do {
            if (lVar7 == 0) break;
            lVar7 = lVar7 + -1;
            uVar1 = *puVar10;
            puVar10 = puVar10 + (ulong)bVar14 * -2 + 1;
          } while (uVar1 != '\0');
          PutTlvPrivate("C33",&tlvInfo,(char *)sTag72,~(uint)lVar7 - 1);
          nIccLen = PrivateBuildTlv(sIccData,&tlvInfo);
          if (nIccLen != 0) {
            PutTlvBuffer("055",sTlvBuffer,sIccData,nIccLen);
          }
          trace_event("End   gen_dpas_iss_script_data(OK)",5);
          return 0;
        }
        builtin_strncpy(sHsmResultCode,"-ICC",4);
        goto LAB_004727cb;
      }
    }
    pcVar11 = "ERROR WhiLe GetTlvBuffer(AUTO_PAN) ";
    builtin_strncpy(sHsmResultCode,"-PAN",4);
  }
  else {
LAB_004727cb:
    pcVar11 = "ERROR WhiLe GetTlvBuffer(ICC_APPLICATION_INDX) ";
  }
LAB_00472774:
  trace_event(pcVar11,1);
  trace_event("END   gen_dpas_iss_script_data(NOK)",5);
  return 3;
}



// WARNING: Restarted to delay deadcode elimination for space: stack
// WARNING: Unknown calling convention

int gen_iss_script_data(int nIndexCtx,char *sTlvBuffer,char *sHsmResultCode)

{
  char cSchemeId;
  uchar uVar1;
  undefined8 uVar2;
  int iVar3;
  uint uVar4;
  uint uVar5;
  int iVar6;
  uint *puVar7;
  uint *puVar8;
  long lVar9;
  ulong uVar10;
  ulong uVar11;
  uchar *puVar12;
  char *pcVar13;
  uchar *puVar14;
  char *pcVar15;
  bool bVar16;
  byte bVar17;
  char *in_stack_fffffffffffec7d8;
  char *in_stack_fffffffffffec7e0;
  char *in_stack_fffffffffffec7e8;
  uchar *in_stack_fffffffffffec7f0;
  char cStack_13754;
  char cStack_13715;
  uchar sAtc [3];
  int nSecureMsgLen;
  int nLenWork;
  int nLenData;
  int nIccLen;
  int nSequence;
  pid_t nPid;
  uchar sUn [5];
  char v_icc_application_index [5];
  char v_issuing_bank_code [7];
  uchar sSeqNumber [9];
  uchar sFormatedPan [9];
  uchar sArqc [9];
  char sPinBlkBCD [9];
  char sPan12 [13];
  char sTransDate [17];
  char sRefNbr [17];
  uchar sPan [23];
  char sCvr [33];
  uchar sSMI_Key [256];
  uchar sSMC_Key [256];
  uchar sAC_Key [256];
  uchar sPVK_Key [256];
  uchar sPVKA [256];
  uchar sKEY_TYPE [256];
  uchar sTK_Key [256];
  char sProcCode [256];
  char sPinPek [256];
  char sPek [256];
  char sSrcPBFrmt [256];
  char sDestPBFrmt [256];
  char sLine [512];
  uchar BuffSnd [4096];
  uchar BuffRcv [4096];
  uchar sIntegSessData [4096];
  uchar sPlainTextData [4096];
  uchar sCipherTextData [4096];
  uchar sMAC [4096];
  uchar sSecureMsgData [4096];
  uchar sIssCmdData [4096];
  uchar sIssScriptData [4096];
  uchar sAuthDeclFlag [4096];
  uchar sTag71 [4096];
  uchar sTag72 [4096];
  char szWork [4096];
  char sIccData [4096];
  char sTmpField [4096];
  char sTmpData [4096];
  TSTlvPrivate tlvInfo;
  
  bVar17 = 0;
  nLenWork = 0;
  nLenData = 0;
  nIccLen = 0;
  nSequence = 0;
  trace_event("Start gen_iss_script_data()",5);
  sFormatedPan[0] = '\0';
  sFormatedPan[1] = '\0';
  sFormatedPan[2] = '\0';
  sFormatedPan[3] = '\0';
  sFormatedPan[4] = '\0';
  sFormatedPan[5] = '\0';
  sFormatedPan[6] = '\0';
  sFormatedPan[7] = '\0';
  sFormatedPan[8] = '\0';
  sArqc[0] = '\0';
  sArqc[1] = '\0';
  sArqc[2] = '\0';
  sArqc[3] = '\0';
  sArqc[4] = '\0';
  sArqc[5] = '\0';
  sArqc[6] = '\0';
  sArqc[7] = '\0';
  puVar12 = BuffSnd;
  for (lVar9 = 0x200; lVar9 != 0; lVar9 = lVar9 + -1) {
    puVar12[0] = '\0';
    puVar12[1] = '\0';
    puVar12[2] = '\0';
    puVar12[3] = '\0';
    puVar12[4] = '\0';
    puVar12[5] = '\0';
    puVar12[6] = '\0';
    puVar12[7] = '\0';
    puVar12 = puVar12 + (ulong)bVar17 * -0x10 + 8;
  }
  sArqc[8] = '\0';
  puVar12 = BuffRcv;
  for (lVar9 = 0x200; lVar9 != 0; lVar9 = lVar9 + -1) {
    puVar12[0] = '\0';
    puVar12[1] = '\0';
    puVar12[2] = '\0';
    puVar12[3] = '\0';
    puVar12[4] = '\0';
    puVar12[5] = '\0';
    puVar12[6] = '\0';
    puVar12[7] = '\0';
    puVar12 = puVar12 + (ulong)bVar17 * -0x10 + 8;
  }
  puVar12 = sPlainTextData;
  for (lVar9 = 0x200; lVar9 != 0; lVar9 = lVar9 + -1) {
    puVar12[0] = '\0';
    puVar12[1] = '\0';
    puVar12[2] = '\0';
    puVar12[3] = '\0';
    puVar12[4] = '\0';
    puVar12[5] = '\0';
    puVar12[6] = '\0';
    puVar12[7] = '\0';
    puVar12 = puVar12 + (ulong)bVar17 * -0x10 + 8;
  }
  puVar12 = sCipherTextData;
  for (lVar9 = 0x200; lVar9 != 0; lVar9 = lVar9 + -1) {
    puVar12[0] = '\0';
    puVar12[1] = '\0';
    puVar12[2] = '\0';
    puVar12[3] = '\0';
    puVar12[4] = '\0';
    puVar12[5] = '\0';
    puVar12[6] = '\0';
    puVar12[7] = '\0';
    puVar12 = puVar12 + (ulong)bVar17 * -0x10 + 8;
  }
  puVar12 = sSecureMsgData;
  for (lVar9 = 0x200; lVar9 != 0; lVar9 = lVar9 + -1) {
    puVar12[0] = '\0';
    puVar12[1] = '\0';
    puVar12[2] = '\0';
    puVar12[3] = '\0';
    puVar12[4] = '\0';
    puVar12[5] = '\0';
    puVar12[6] = '\0';
    puVar12[7] = '\0';
    puVar12 = puVar12 + (ulong)bVar17 * -0x10 + 8;
  }
  puVar12 = sIssScriptData;
  for (lVar9 = 0x200; lVar9 != 0; lVar9 = lVar9 + -1) {
    puVar12[0] = '\0';
    puVar12[1] = '\0';
    puVar12[2] = '\0';
    puVar12[3] = '\0';
    puVar12[4] = '\0';
    puVar12[5] = '\0';
    puVar12[6] = '\0';
    puVar12[7] = '\0';
    puVar12 = puVar12 + (ulong)bVar17 * -0x10 + 8;
  }
  puVar12 = sIntegSessData;
  for (lVar9 = 0x200; lVar9 != 0; lVar9 = lVar9 + -1) {
    puVar12[0] = '\0';
    puVar12[1] = '\0';
    puVar12[2] = '\0';
    puVar12[3] = '\0';
    puVar12[4] = '\0';
    puVar12[5] = '\0';
    puVar12[6] = '\0';
    puVar12[7] = '\0';
    puVar12 = puVar12 + (ulong)bVar17 * -0x10 + 8;
  }
  puVar12 = sMAC;
  for (lVar9 = 0x200; lVar9 != 0; lVar9 = lVar9 + -1) {
    puVar12[0] = '\0';
    puVar12[1] = '\0';
    puVar12[2] = '\0';
    puVar12[3] = '\0';
    puVar12[4] = '\0';
    puVar12[5] = '\0';
    puVar12[6] = '\0';
    puVar12[7] = '\0';
    puVar12 = puVar12 + (ulong)bVar17 * -0x10 + 8;
  }
  puVar12 = sSMI_Key;
  for (lVar9 = 0x20; lVar9 != 0; lVar9 = lVar9 + -1) {
    puVar12[0] = '\0';
    puVar12[1] = '\0';
    puVar12[2] = '\0';
    puVar12[3] = '\0';
    puVar12[4] = '\0';
    puVar12[5] = '\0';
    puVar12[6] = '\0';
    puVar12[7] = '\0';
    puVar12 = puVar12 + (ulong)bVar17 * -0x10 + 8;
  }
  puVar12 = sSMC_Key;
  for (lVar9 = 0x20; lVar9 != 0; lVar9 = lVar9 + -1) {
    puVar12[0] = '\0';
    puVar12[1] = '\0';
    puVar12[2] = '\0';
    puVar12[3] = '\0';
    puVar12[4] = '\0';
    puVar12[5] = '\0';
    puVar12[6] = '\0';
    puVar12[7] = '\0';
    puVar12 = puVar12 + (ulong)bVar17 * -0x10 + 8;
  }
  puVar12 = sAC_Key;
  for (lVar9 = 0x20; lVar9 != 0; lVar9 = lVar9 + -1) {
    puVar12[0] = '\0';
    puVar12[1] = '\0';
    puVar12[2] = '\0';
    puVar12[3] = '\0';
    puVar12[4] = '\0';
    puVar12[5] = '\0';
    puVar12[6] = '\0';
    puVar12[7] = '\0';
    puVar12 = puVar12 + (ulong)bVar17 * -0x10 + 8;
  }
  puVar12 = sTK_Key;
  for (lVar9 = 0x20; lVar9 != 0; lVar9 = lVar9 + -1) {
    puVar12[0] = '\0';
    puVar12[1] = '\0';
    puVar12[2] = '\0';
    puVar12[3] = '\0';
    puVar12[4] = '\0';
    puVar12[5] = '\0';
    puVar12[6] = '\0';
    puVar12[7] = '\0';
    puVar12 = puVar12 + (ulong)bVar17 * -0x10 + 8;
  }
  puVar8 = (uint *)szWork;
  for (lVar9 = 0x200; lVar9 != 0; lVar9 = lVar9 + -1) {
    puVar8[0] = 0;
    puVar8[1] = 0;
    puVar8 = puVar8 + (ulong)bVar17 * -4 + 2;
  }
  puVar8 = (uint *)sTmpField;
  for (lVar9 = 0x200; lVar9 != 0; lVar9 = lVar9 + -1) {
    puVar8[0] = 0;
    puVar8[1] = 0;
    puVar8 = puVar8 + (ulong)bVar17 * -4 + 2;
  }
  puVar12 = (uchar *)sTmpData;
  for (lVar9 = 0x200; lVar9 != 0; lVar9 = lVar9 + -1) {
    puVar12[0] = '\0';
    puVar12[1] = '\0';
    puVar12[2] = '\0';
    puVar12[3] = '\0';
    puVar12[4] = '\0';
    puVar12[5] = '\0';
    puVar12[6] = '\0';
    puVar12[7] = '\0';
    puVar12 = puVar12 + (ulong)bVar17 * -0x10 + 8;
  }
  pcVar13 = sProcCode;
  pcVar15 = pcVar13;
  for (lVar9 = 0x20; lVar9 != 0; lVar9 = lVar9 + -1) {
    pcVar15[0] = '\0';
    pcVar15[1] = '\0';
    pcVar15[2] = '\0';
    pcVar15[3] = '\0';
    pcVar15[4] = '\0';
    pcVar15[5] = '\0';
    pcVar15[6] = '\0';
    pcVar15[7] = '\0';
    pcVar15 = pcVar15 + (ulong)bVar17 * -0x10 + 8;
  }
  puVar12 = (uchar *)sPinPek;
  for (lVar9 = 0x20; lVar9 != 0; lVar9 = lVar9 + -1) {
    puVar12[0] = '\0';
    puVar12[1] = '\0';
    puVar12[2] = '\0';
    puVar12[3] = '\0';
    puVar12[4] = '\0';
    puVar12[5] = '\0';
    puVar12[6] = '\0';
    puVar12[7] = '\0';
    puVar12 = puVar12 + (ulong)bVar17 * -0x10 + 8;
  }
  v_issuing_bank_code[4] = '\0';
  v_issuing_bank_code[5] = '\0';
  sCvr[0] = '\0';
  sCvr[1] = '\0';
  sCvr[2] = '\0';
  sCvr[3] = '\0';
  sCvr[4] = '\0';
  sCvr[5] = '\0';
  sCvr[6] = '\0';
  sCvr[7] = '\0';
  sCvr[8] = '\0';
  sCvr[9] = '\0';
  sCvr[10] = '\0';
  sCvr[0xb] = '\0';
  sCvr[0xc] = '\0';
  sCvr[0xd] = '\0';
  sCvr[0xe] = '\0';
  sCvr[0xf] = '\0';
  sCvr[0x10] = '\0';
  sCvr[0x11] = '\0';
  sCvr[0x12] = '\0';
  sCvr[0x13] = '\0';
  sCvr[0x14] = '\0';
  sCvr[0x15] = '\0';
  sCvr[0x16] = '\0';
  sCvr[0x17] = '\0';
  sCvr[0x18] = '\0';
  sCvr[0x19] = '\0';
  sCvr[0x1a] = '\0';
  sCvr[0x1b] = '\0';
  sCvr[0x1c] = '\0';
  sCvr[0x1d] = '\0';
  sCvr[0x1e] = '\0';
  sCvr[0x1f] = '\0';
  sCvr[0x20] = '\0';
  v_icc_application_index[0] = '\0';
  v_icc_application_index[1] = '\0';
  v_icc_application_index[2] = '\0';
  v_icc_application_index[3] = '\0';
  v_icc_application_index[4] = '\0';
  v_issuing_bank_code[0] = '\0';
  v_issuing_bank_code[1] = '\0';
  v_issuing_bank_code[2] = '\0';
  v_issuing_bank_code[3] = '\0';
  v_issuing_bank_code[6] = '\0';
  pcVar15 = sPek;
  for (lVar9 = 0x20; lVar9 != 0; lVar9 = lVar9 + -1) {
    pcVar15[0] = '\0';
    pcVar15[1] = '\0';
    pcVar15[2] = '\0';
    pcVar15[3] = '\0';
    pcVar15[4] = '\0';
    pcVar15[5] = '\0';
    pcVar15[6] = '\0';
    pcVar15[7] = '\0';
    pcVar15 = pcVar15 + (ulong)bVar17 * -0x10 + 8;
  }
  sTransDate[0] = '\0';
  sTransDate[1] = '\0';
  sTransDate[2] = '\0';
  sTransDate[3] = '\0';
  sTransDate[4] = '\0';
  sTransDate[5] = '\0';
  sTransDate[6] = '\0';
  sTransDate[7] = '\0';
  sTransDate[8] = '\0';
  sTransDate[9] = '\0';
  sTransDate[10] = '\0';
  sTransDate[0xb] = '\0';
  sTransDate[0xc] = '\0';
  sTransDate[0xd] = '\0';
  sTransDate[0xe] = '\0';
  sTransDate[0xf] = '\0';
  sTransDate[0x10] = '\0';
  sRefNbr[0] = '\0';
  sRefNbr[1] = '\0';
  sRefNbr[2] = '\0';
  sRefNbr[3] = '\0';
  sRefNbr[4] = '\0';
  sRefNbr[5] = '\0';
  sRefNbr[6] = '\0';
  sRefNbr[7] = '\0';
  sRefNbr[8] = '\0';
  sRefNbr[9] = '\0';
  sRefNbr[10] = '\0';
  sRefNbr[0xb] = '\0';
  sRefNbr[0xc] = '\0';
  sRefNbr[0xd] = '\0';
  sRefNbr[0xe] = '\0';
  sRefNbr[0xf] = '\0';
  sRefNbr[0x10] = '\0';
  pcVar15 = sSrcPBFrmt;
  for (lVar9 = 0x20; lVar9 != 0; lVar9 = lVar9 + -1) {
    pcVar15[0] = '\0';
    pcVar15[1] = '\0';
    pcVar15[2] = '\0';
    pcVar15[3] = '\0';
    pcVar15[4] = '\0';
    pcVar15[5] = '\0';
    pcVar15[6] = '\0';
    pcVar15[7] = '\0';
    pcVar15 = pcVar15 + (ulong)bVar17 * -0x10 + 8;
  }
  puVar12 = sTag71;
  for (lVar9 = 0x200; lVar9 != 0; lVar9 = lVar9 + -1) {
    puVar12[0] = '\0';
    puVar12[1] = '\0';
    puVar12[2] = '\0';
    puVar12[3] = '\0';
    puVar12[4] = '\0';
    puVar12[5] = '\0';
    puVar12[6] = '\0';
    puVar12[7] = '\0';
    puVar12 = puVar12 + (ulong)bVar17 * -0x10 + 8;
  }
  puVar12 = sTag72;
  for (lVar9 = 0x200; lVar9 != 0; lVar9 = lVar9 + -1) {
    puVar12[0] = '\0';
    puVar12[1] = '\0';
    puVar12[2] = '\0';
    puVar12[3] = '\0';
    puVar12[4] = '\0';
    puVar12[5] = '\0';
    puVar12[6] = '\0';
    puVar12[7] = '\0';
    puVar12 = puVar12 + (ulong)bVar17 * -0x10 + 8;
  }
  puVar12 = sPVKA;
  for (lVar9 = 0x20; lVar9 != 0; lVar9 = lVar9 + -1) {
    puVar12[0] = '\0';
    puVar12[1] = '\0';
    puVar12[2] = '\0';
    puVar12[3] = '\0';
    puVar12[4] = '\0';
    puVar12[5] = '\0';
    puVar12[6] = '\0';
    puVar12[7] = '\0';
    puVar12 = puVar12 + (ulong)bVar17 * -0x10 + 8;
  }
  puVar12 = sPVK_Key;
  for (lVar9 = 0x20; lVar9 != 0; lVar9 = lVar9 + -1) {
    puVar12[0] = '\0';
    puVar12[1] = '\0';
    puVar12[2] = '\0';
    puVar12[3] = '\0';
    puVar12[4] = '\0';
    puVar12[5] = '\0';
    puVar12[6] = '\0';
    puVar12[7] = '\0';
    puVar12 = puVar12 + (ulong)bVar17 * -0x10 + 8;
  }
  iVar3 = GetTlvBuffer("204",sTlvBuffer,szWork,&nLenWork);
  if ((iVar3 == 0) && (iVar3 = memcmp(szWork,&DAT_004d1e47,2), iVar3 == 0)) {
    iVar3 = gen_dpas_iss_script_data(nIndexCtx,sTlvBuffer,sHsmResultCode);
    if (iVar3 != 0) {
      trace_event("End   gen_iss_script_data(NOK). gen_dpas_iss_script_data (NOK)",5);
      return -1;
    }
    trace_event("End   gen_iss_script_data(OK). gen_dpas_iss_script_data (OK)",5);
    return 0;
  }
  iVar3 = GetTlvBuffer("002",sTlvBuffer,(char *)sPan,&nLenData);
  if (iVar3 == 0) {
    iVar3 = GetTlvBuffer("003",sTlvBuffer,sTmpField,&nLenData);
    if (iVar3 != 0) {
      builtin_strncpy(sHsmResultCode,"-PCD",4);
      pcVar13 = "ERROR WhiLe GetTlvBuffer(ProcessingCode) ";
      goto LAB_004740c9;
    }
    iVar3 = GetTlvBuffer("037",sTlvBuffer,sRefNbr,&nLenData);
    if (iVar3 != 0) {
      builtin_strncpy(sHsmResultCode,"-PCD",4);
      pcVar13 = "ERROR WhiLe GetTlvBuffer(Reference Number) ";
      goto LAB_004740c9;
    }
    iVar3 = GetTlvBuffer("007",sTlvBuffer,sTransDate,&nLenData);
    if (iVar3 != 0) {
      builtin_strncpy(sHsmResultCode,"-PCD",4);
      pcVar13 = "ERROR WhiLe GetTlvBuffer(TRANS_DATE_TIME) ";
      goto LAB_004740c9;
    }
    sProcCode[0] = sTmpField[6];
    sProcCode[1] = sTmpField[7];
    iVar3 = memcmp(pcVar13,&DAT_004aac5d,2);
    if (iVar3 == 0) {
      iVar3 = GetTlvBuffer("031",sTlvBuffer,sPinPek,&nLenData);
      if (iVar3 != 0) {
        builtin_strncpy(sHsmResultCode,"-PIN",4);
        trace_event("END   gen_iss_script_data(NOK) <ERROR ON GetTlvBuffer(AUTO_ACQUIRER_REF_DATA-NEW_PIN)>"
                    ,5);
        return 3;
      }
      iVar3 = GetTlvBuffer("048",sTlvBuffer,sTmpField,&nLenData);
      if (iVar3 != 0) {
        builtin_strncpy(sHsmResultCode,"-F48",4);
        trace_event("END   gen_iss_script_data(NOK) <ERROR ON GetTlvBuffer(AUTO_ADD_DATA_PRIVATE)>",
                    5);
        return 3;
      }
      InitTlvPrivate(&tlvInfo);
      AnalyseTlvPrivate(sTmpField,nLenData,&tlvInfo);
      iVar3 = GetTlvPrivate("P10",&tlvInfo,sPek,&nLenData);
      if (iVar3 != 0) {
        builtin_strncpy(sHsmResultCode,"-PEK",4);
        trace_event("END   gen_iss_script_data(NOK) <ERROR ON GetTlvPrivate(ENCR_PIN_BLOCK_KEY_TAG)>"
                    ,5);
        return 3;
      }
      iVar3 = GetTlvBuffer("053",sTlvBuffer,sTmpField,&nLenData);
      if (iVar3 != 0) {
        builtin_strncpy(sHsmResultCode,"-F48",4);
        trace_event("END   gen_iss_script_data(NOK) <ERROR ON GetTlvBuffer(AUTO_SECURITY_DATA)>",5);
        return 3;
      }
      GetSecurityData(1,sTmpField,sSrcPBFrmt,&nLenData);
      iVar3 = Get_EMV_Key(nIndexCtx,(char *)sPan,"ENC",(char *)sSMC_Key);
      if (iVar3 != 0) {
        builtin_strncpy(sHsmResultCode,"-SMC",4);
        trace_event("END   gen_iss_script_data(KEY_UNAVAILABLE) <ERROR ON Get_EMV_Key(ENC)>",5);
        return 3;
      }
      iVar3 = Get_EMV_Key(nIndexCtx,(char *)sPan,"AC",(char *)sAC_Key);
      if (iVar3 != 0) {
        builtin_strncpy(sHsmResultCode,"-AC_",4);
        trace_event("END   gen_iss_script_data(KEY_UNAVAILABLE) <ERROR ON Get_EMV_Key(AC)>",5);
        return 3;
      }
      cStack_13754 = '4';
      cStack_13715 = '4';
    }
    else {
      cStack_13754 = '0';
      cStack_13715 = '0';
    }
    sSeqNumber[0] = '\0';
    sSeqNumber[1] = '\0';
    sSeqNumber[2] = '\0';
    sSeqNumber[3] = '\0';
    sSeqNumber[4] = '\0';
    sSeqNumber[5] = '\0';
    sSeqNumber[6] = '\0';
    sSeqNumber[7] = '\0';
    sSeqNumber[8] = '\0';
    iVar3 = GetTlvBuffer("023",sTlvBuffer,(char *)sSeqNumber,&nLenData);
    if (iVar3 != 0) {
      trace_event("DE23 MISSING.  USE THE ZERO VALUE",0);
      sprintf((char *)sSeqNumber,"%03d",0);
    }
    sprintf(sLine,"SEQUENCE NUMBER             =[%s]",sSeqNumber);
    trace_event(sLine,5);
    trace_event("- SMI/SMC PROCESSING ---------------",5);
    puVar8 = (uint *)szWork;
    do {
      puVar7 = puVar8;
      uVar4 = *puVar7 + 0xfefefeff & ~*puVar7;
      uVar5 = uVar4 & 0x80808080;
      puVar8 = puVar7 + 1;
    } while (uVar5 == 0);
    bVar16 = (uVar4 & 0x8080) == 0;
    if (bVar16) {
      uVar5 = uVar5 >> 0x10;
    }
    if (bVar16) {
      puVar8 = (uint *)((long)puVar7 + 6);
    }
    memset(szWork,0,(size_t)((long)puVar8 +
                            ((-3 - (ulong)CARRY1((byte)uVar5,(byte)uVar5)) - (long)szWork)));
    puVar8 = (uint *)sTmpField;
    do {
      puVar7 = puVar8;
      uVar4 = *puVar7 + 0xfefefeff & ~*puVar7;
      uVar5 = uVar4 & 0x80808080;
      puVar8 = puVar7 + 1;
    } while (uVar5 == 0);
    bVar16 = (uVar4 & 0x8080) == 0;
    if (bVar16) {
      uVar5 = uVar5 >> 0x10;
    }
    if (bVar16) {
      puVar8 = (uint *)((long)puVar7 + 6);
    }
    memset(sTmpField,0,
           (size_t)((long)puVar8 + ((-3 - (ulong)CARRY1((byte)uVar5,(byte)uVar5)) - (long)sTmpField)
                   ));
    builtin_strncpy(szWork,"0000000000000000",0x10);
    puVar8 = (uint *)sPan;
    do {
      puVar7 = puVar8;
      uVar4 = *puVar7 + 0xfefefeff & ~*puVar7;
      uVar5 = uVar4 & 0x80808080;
      puVar8 = puVar7 + 1;
    } while (uVar5 == 0);
    bVar16 = (uVar4 & 0x8080) == 0;
    if (bVar16) {
      uVar5 = uVar5 >> 0x10;
    }
    if (bVar16) {
      puVar8 = (uint *)((long)puVar7 + 6);
    }
    pcVar15 = (char *)((long)puVar8 + ((-3 - (ulong)CARRY1((byte)uVar5,(byte)uVar5)) - (long)sPan));
    memcpy(sTmpField,sPan,(size_t)pcVar15);
    *(undefined2 *)((long)sTmpField + (long)pcVar15) = sSeqNumber._1_2_;
    puVar8 = (uint *)sTmpField;
    do {
      puVar7 = puVar8;
      uVar4 = *puVar7 + 0xfefefeff & ~*puVar7;
      uVar5 = uVar4 & 0x80808080;
      puVar8 = puVar7 + 1;
    } while (uVar5 == 0);
    bVar16 = (uVar4 & 0x8080) == 0;
    if (bVar16) {
      uVar5 = uVar5 >> 0x10;
    }
    if (bVar16) {
      puVar8 = (uint *)((long)puVar7 + 6);
    }
    nLenWork = (((int)puVar8 + -3) - (uint)CARRY1((byte)uVar5,(byte)uVar5)) - (int)sTmpField;
    if (nLenWork < 0x10) {
      memcpy((uchar *)((long)szWork + (long)(0x10 - nLenWork)),sTmpField,(long)nLenWork);
    }
    else {
      szWork._0_8_ = *(undefined8 *)(sIccData + (long)nLenWork + 0xff0);
      szWork._8_8_ = *(undefined8 *)(sIccData + (long)nLenWork + 0xff8);
    }
    AsciiToHex((uchar *)szWork,sFormatedPan,0x10);
    if (debug_option == 1) {
      sprintf(sLine,"PRE FORMATED PAN            =[%s]",szWork);
      trace_event(sLine,5);
    }
    iVar3 = GetTlvBuffer("055",sTlvBuffer,sIccData,&nIccLen);
    if (iVar3 == 0) {
      InitTlvPrivate(&tlvInfo);
      AnalyseTlvPrivate(sIccData,nIccLen,&tlvInfo);
      iVar3 = GetTlvBuffer("204",sTlvBuffer,szWork,&nLenWork);
      cSchemeId = '0';
      if (iVar3 == 0) {
        iVar3 = memcmp(szWork,"01",2);
        cSchemeId = '1' - (iVar3 == 0);
      }
      puVar8 = (uint *)szWork;
      for (lVar9 = 0x200; lVar9 != 0; lVar9 = lVar9 + -1) {
        puVar8[0] = 0;
        puVar8[1] = 0;
        puVar8 = puVar8 + (ulong)bVar17 * -4 + 2;
      }
      sAtc[0] = '0';
      sAtc[1] = '0';
      iVar3 = GetTlvPrivate("C07",&tlvInfo,szWork,&nLenWork);
      if (iVar3 == 0) {
        AsciiToHex((uchar *)szWork,sAtc,4);
      }
      sprintf(sLine,"ATC                         =[%s]",szWork);
      trace_event(sLine,5);
      builtin_memcpy(sKEY_TYPE,"MAC",4);
      iVar3 = Get_EMV_Key(nIndexCtx,(char *)sPan,(char *)sKEY_TYPE,(char *)sSMI_Key);
      if (iVar3 != 0) {
        builtin_strncpy(sHsmResultCode,"-SMI",4);
        trace_event("INVALID KEY DMK ",1);
        trace_event("END   gen_iss_script_data(KEY_UNAVAILABLE)",5);
        return 3;
      }
      sprintf(sLine,"%s KEY IS                  =[%s]",sKEY_TYPE,sSMI_Key);
      trace_event(sLine,5);
      puVar8 = (uint *)szWork;
      for (lVar9 = 0x200; lVar9 != 0; lVar9 = lVar9 + -1) {
        puVar8[0] = 0;
        puVar8[1] = 0;
        puVar8 = puVar8 + (ulong)bVar17 * -4 + 2;
      }
      iVar3 = GetTlvPrivate("C01",&tlvInfo,szWork,&nLenWork);
      if (iVar3 == 0) {
        AsciiToHex((uchar *)szWork,sArqc,0x10);
      }
      sprintf(sLine,"ARQC                        =[%s]",szWork);
      trace_event(sLine,5);
      puVar8 = (uint *)szWork;
      for (lVar9 = 0x200; lVar9 != 0; lVar9 = lVar9 + -1) {
        puVar8[0] = 0;
        puVar8[1] = 0;
        puVar8 = puVar8 + (ulong)bVar17 * -4 + 2;
      }
      iVar3 = GetTlvPrivate("C08",&tlvInfo,szWork,&nLenWork);
      if (iVar3 == 0) {
        AsciiToHex((uchar *)szWork,sUn,8);
      }
      sprintf(sLine,"UN                          =[%s]",szWork);
      trace_event(sLine,5);
      iVar3 = GetTlvBuffer("205",sTlvBuffer,v_issuing_bank_code,&nLenWork);
      if (iVar3 != 0) {
        builtin_strncpy(sHsmResultCode,"-ICC",4);
        pcVar13 = "ERROR WhiLe GetTlvBuffer(AUTO_ISSUING_BANK) ";
        goto LAB_004740c9;
      }
      iVar3 = GetTlvBuffer("900",sTlvBuffer,v_icc_application_index,&nLenWork);
      if (iVar3 != 0) {
        builtin_strncpy(sHsmResultCode,"-ICC",4);
        pcVar13 = "ERROR WhiLe GetTlvBuffer(ICC_APPLICATION_INDX) ";
        goto LAB_004740c9;
      }
      puVar8 = (uint *)szWork;
      for (lVar9 = 0x200; lVar9 != 0; lVar9 = lVar9 + -1) {
        puVar8[0] = 0;
        puVar8[1] = 0;
        puVar8 = puVar8 + (ulong)bVar17 * -4 + 2;
      }
      iVar3 = GetTlvPrivate("C20",&tlvInfo,szWork,&nLenWork);
      if (iVar3 != 0) {
        sprintf(szWork,"%32d",0);
      }
      pcVar15 = sCvr;
      for (lVar9 = 0x21; lVar9 != 0; lVar9 = lVar9 + -1) {
        *pcVar15 = '\0';
        pcVar15 = pcVar15 + (ulong)bVar17 * -2 + 1;
      }
      GetCVRFromIAD(nIndexCtx,szWork,v_issuing_bank_code,v_icc_application_index,sCvr);
      Update_SentIssScripts(nIndexCtx,(char *)sPan,sCvr);
      iVar3 = CheckResource(nIndexCtx,"070000",&nPid);
      if (iVar3 != 0) {
LAB_004752e7:
        builtin_strncpy(sHsmResultCode,"UNVL",4);
        trace_event("HSM FOR VERIFICATION NOT AVAILABLE",1);
        trace_event("End   gen_iss_script_data(HSM_UNAVAILABLE)",5);
        return 9;
      }
      nSequence = 0;
      do {
        puVar8 = (uint *)szWork;
        for (lVar9 = 0x200; lVar9 != 0; lVar9 = lVar9 + -1) {
          puVar8[0] = 0;
          puVar8[1] = 0;
          puVar8 = puVar8 + (ulong)bVar17 * -4 + 2;
        }
        puVar12 = sIssCmdData;
        for (lVar9 = 0x200; lVar9 != 0; lVar9 = lVar9 + -1) {
          puVar12[0] = '\0';
          puVar12[1] = '\0';
          puVar12[2] = '\0';
          puVar12[3] = '\0';
          puVar12[4] = '\0';
          puVar12[5] = '\0';
          puVar12[6] = '\0';
          puVar12[7] = '\0';
          puVar12 = puVar12 + (ulong)bVar17 * -0x10 + 8;
        }
        puVar12 = sAuthDeclFlag;
        for (lVar9 = 0x200; lVar9 != 0; lVar9 = lVar9 + -1) {
          puVar12[0] = '\0';
          puVar12[1] = '\0';
          puVar12[2] = '\0';
          puVar12[3] = '\0';
          puVar12[4] = '\0';
          puVar12[5] = '\0';
          puVar12[6] = '\0';
          puVar12[7] = '\0';
          puVar12 = puVar12 + (ulong)bVar17 * -0x10 + 8;
        }
        puVar12 = sIntegSessData;
        for (lVar9 = 0x200; lVar9 != 0; lVar9 = lVar9 + -1) {
          puVar12[0] = '\0';
          puVar12[1] = '\0';
          puVar12[2] = '\0';
          puVar12[3] = '\0';
          puVar12[4] = '\0';
          puVar12[5] = '\0';
          puVar12[6] = '\0';
          puVar12[7] = '\0';
          puVar12 = puVar12 + (ulong)bVar17 * -0x10 + 8;
        }
        puVar12 = BuffSnd;
        for (lVar9 = 0x200; lVar9 != 0; lVar9 = lVar9 + -1) {
          puVar12[0] = '\0';
          puVar12[1] = '\0';
          puVar12[2] = '\0';
          puVar12[3] = '\0';
          puVar12[4] = '\0';
          puVar12[5] = '\0';
          puVar12[6] = '\0';
          puVar12[7] = '\0';
          puVar12 = puVar12 + (ulong)bVar17 * -0x10 + 8;
        }
        puVar12 = BuffRcv;
        for (lVar9 = 0x200; lVar9 != 0; lVar9 = lVar9 + -1) {
          puVar12[0] = '\0';
          puVar12[1] = '\0';
          puVar12[2] = '\0';
          puVar12[3] = '\0';
          puVar12[4] = '\0';
          puVar12[5] = '\0';
          puVar12[6] = '\0';
          puVar12[7] = '\0';
          puVar12 = puVar12 + (ulong)bVar17 * -0x10 + 8;
        }
        puVar12 = sPlainTextData;
        for (lVar9 = 0x200; lVar9 != 0; lVar9 = lVar9 + -1) {
          puVar12[0] = '\0';
          puVar12[1] = '\0';
          puVar12[2] = '\0';
          puVar12[3] = '\0';
          puVar12[4] = '\0';
          puVar12[5] = '\0';
          puVar12[6] = '\0';
          puVar12[7] = '\0';
          puVar12 = puVar12 + (ulong)bVar17 * -0x10 + 8;
        }
        iVar3 = memcmp(pcVar13,&DAT_004aac5d,2);
        if (iVar3 == 0) {
          puVar12 = "8424000210";
          puVar14 = sIssCmdData;
          for (lVar9 = 0xb; lVar9 != 0; lVar9 = lVar9 + -1) {
            *puVar14 = *puVar12;
            puVar12 = puVar12 + (ulong)bVar17 * -2 + 1;
            puVar14 = puVar14 + (ulong)bVar17 * -2 + 1;
          }
          if (cSchemeId == '0') {
            puVar12 = "8424000218";
            puVar14 = sIssCmdData;
            for (lVar9 = 0xb; lVar9 != 0; lVar9 = lVar9 + -1) {
              *puVar14 = *puVar12;
              puVar12 = puVar12 + (ulong)bVar17 * -2 + 1;
              puVar14 = puVar14 + (ulong)bVar17 * -2 + 1;
            }
            sprintf(sLine,"ISSUER COMMAND DATA IS       =[%s]",sIssCmdData);
            trace_event(sLine,5);
            sprintf(sLine,"sAuthDeclFlag                =[%s]",sAuthDeclFlag);
            trace_event(sLine,5);
          }
          else {
            sprintf(sLine,"ISSUER COMMAND DATA IS       =[%s]",sIssCmdData);
            trace_event(sLine,5);
            sprintf(sLine,"sAuthDeclFlag                =[%s]",sAuthDeclFlag);
            trace_event(sLine,5);
LAB_00474ba0:
            if (1 < nSequence) {
              FctIncrimentRandBy1((char *)sArqc,(char *)sArqc);
            }
          }
        }
        else {
          iVar3 = Get_IssScriptData(nIndexCtx,(char *)sPan,(char *)sIssCmdData,&nSequence,
                                    (char *)sAuthDeclFlag,sTransDate,sRefNbr);
          if (iVar3 != 0) {
            trace_event("==> Get_IssScriptData(!OK).  BREAK",5);
            break;
          }
          sprintf(sLine,"ISSUER COMMAND DATA IS       =[%s]",sIssCmdData);
          trace_event(sLine,5);
          sprintf(sLine,"sAuthDeclFlag                =[%s]",sAuthDeclFlag);
          trace_event(sLine,5);
          if (cSchemeId == '1') goto LAB_00474ba0;
        }
        puVar8 = (uint *)szWork;
        for (lVar9 = 0x200; lVar9 != 0; lVar9 = lVar9 + -1) {
          puVar8[0] = 0;
          puVar8[1] = 0;
          puVar8 = puVar8 + (ulong)bVar17 * -4 + 2;
        }
        lVar9 = -1;
        puVar12 = sIssCmdData;
        do {
          if (lVar9 == 0) break;
          lVar9 = lVar9 + -1;
          uVar1 = *puVar12;
          puVar12 = puVar12 + (ulong)bVar17 * -2 + 1;
        } while (uVar1 != '\0');
        AsciiToHex(sIssCmdData,(uchar *)szWork,~(uint)lVar9 - 1);
        uVar2 = szWork._0_8_;
        uVar10 = 0xffffffffffffffff;
        sPlainTextData[0] = szWork[0];
        sPlainTextData[1] = szWork[1];
        sPlainTextData[2] = szWork[2];
        sPlainTextData[3] = szWork[3];
        szWork[4] = SUB81(uVar2,4);
        sPlainTextData[4] = szWork[4];
        sPlainTextData[5] = sAtc[0];
        sPlainTextData[6] = sAtc[1];
        sPlainTextData[7] = sArqc[0];
        sPlainTextData[8] = sArqc[1];
        sPlainTextData[9] = sArqc[2];
        sPlainTextData[10] = sArqc[3];
        sPlainTextData[0xb] = sArqc[4];
        sPlainTextData[0xc] = sArqc[5];
        sPlainTextData[0xd] = sArqc[6];
        sPlainTextData[0xe] = sArqc[7];
        iVar3 = 0xf;
        puVar12 = sIssCmdData;
        do {
          if (uVar10 == 0) break;
          uVar10 = uVar10 - 1;
          uVar1 = *puVar12;
          puVar12 = puVar12 + (ulong)bVar17 * -2 + 1;
        } while (uVar1 != '\0');
        szWork._0_8_ = uVar2;
        if (10 < ~uVar10 - 1) {
          uVar10 = ~uVar10 - 0xb >> 1;
          iVar3 = (int)uVar10 + 0xf;
          memcpy(sPlainTextData + 0xf,szWork + 5,uVar10);
        }
        if (cSchemeId == '1') {
          sIntegSessData[0] = sArqc[0];
          sIntegSessData[1] = sArqc[1];
          sIntegSessData[2] = sArqc[2];
          sIntegSessData[3] = sArqc[3];
          sIntegSessData[4] = sArqc[4];
          sIntegSessData[5] = sArqc[5];
          sIntegSessData[6] = sArqc[6];
          sIntegSessData[7] = sArqc[7];
        }
        else {
          sIntegSessData[6] = sAtc[0];
          sIntegSessData[7] = sAtc[1];
        }
        iVar6 = memcmp(pcVar13,&DAT_004aac5d,2);
        if (iVar6 == 0) {
          sDestPBFrmt[0] = '4';
          sDestPBFrmt[1] = '1';
          sDestPBFrmt[2] = '\0';
          if (cSchemeId == '1') {
            sDestPBFrmt[0] = '3';
            sDestPBFrmt[1] = '4';
          }
          sprintf(szWork,"%022d",0);
          uVar10 = 0xffffffffffffffff;
          puVar8 = (uint *)sPan;
          do {
            if (uVar10 == 0) break;
            uVar10 = uVar10 - 1;
            uVar5 = *puVar8;
            puVar8 = (uint *)((long)puVar8 + (ulong)bVar17 * -2 + 1);
          } while ((char)uVar5 != '\0');
          memcpy(szWork + (0x16 - (~uVar10 - 1)),sPan,~uVar10 - 1);
          in_stack_fffffffffffec7e8 = sPan12;
          sprintf(in_stack_fffffffffffec7e8,szWork + 9);
          puVar12 = (uchar *)sPinBlkBCD;
          for (lVar9 = 9; lVar9 != 0; lVar9 = lVar9 + -1) {
            *puVar12 = '\0';
            puVar12 = puVar12 + (ulong)bVar17 * -2 + 1;
          }
          AsciiToHex((uchar *)sPinPek,(uchar *)sPinBlkBCD,0x10);
          in_stack_fffffffffffec7d8 = sSrcPBFrmt;
          in_stack_fffffffffffec7e0 = sDestPBFrmt;
          in_stack_fffffffffffec7f0 = sAC_Key;
          iVar3 = command_KU((char *)BuffSnd,cStack_13754,cSchemeId,(char *)sSMI_Key,
                             (char *)sFormatedPan,(char *)sIntegSessData,iVar3,
                             (char *)sPlainTextData,(char *)sSMC_Key,sPek,(char *)sIntegSessData,
                             iVar3,8,sPinBlkBCD,sSrcPBFrmt,sDestPBFrmt,in_stack_fffffffffffec7e8,
                             (char *)sAC_Key,(char)pcVar13);
        }
        else {
          iVar3 = command_KU((char *)BuffSnd,cStack_13754,cSchemeId,(char *)sSMI_Key,
                             (char *)sFormatedPan,(char *)sIntegSessData,iVar3,
                             (char *)sPlainTextData,"","","",0,0,"",in_stack_fffffffffffec7d8,
                             in_stack_fffffffffffec7e0,in_stack_fffffffffffec7e8,
                             (char *)in_stack_fffffffffffec7f0,(char)pcVar13);
        }
        iVar3 = HsmQueryBin(nIndexCtx,nPid,(char *)BuffSnd,iVar3,(char *)BuffRcv);
        if (iVar3 == 0x3ef) goto LAB_004752e7;
        if (iVar3 == 3) {
          builtin_strncpy(sHsmResultCode,"UNVL",4);
          trace_event("HSM MALFUNCTION DETECTED",1);
          trace_event("End   gen_iss_script_data(MALFUNCTION)",5);
          return 3;
        }
        iVar3 = command_KV((char *)BuffRcv,cStack_13754,sHsmResultCode,(char *)sMAC,&nSecureMsgLen,
                           (char *)sSecureMsgData);
        if (iVar3 != 0) {
          if (iVar3 != 0x7d1) {
            trace_event("End   gen_iss_script_data(CRYPTOGRAPHIC_ERROR)",5);
            return 2;
          }
          trace_event("End   gen_iss_script_data(ERROR_COMMAND)",5);
          return 3;
        }
        puVar8 = (uint *)szWork;
        for (lVar9 = 0x200; lVar9 != 0; lVar9 = lVar9 + -1) {
          puVar8[0] = 0;
          puVar8[1] = 0;
          puVar8 = puVar8 + (ulong)bVar17 * -4 + 2;
        }
        puVar8 = (uint *)sTmpField;
        for (lVar9 = 0x200; lVar9 != 0; lVar9 = lVar9 + -1) {
          puVar8[0] = 0;
          puVar8[1] = 0;
          puVar8 = puVar8 + (ulong)bVar17 * -4 + 2;
        }
        puVar12 = (uchar *)sTmpData;
        for (lVar9 = 0x200; lVar9 != 0; lVar9 = lVar9 + -1) {
          puVar12[0] = '\0';
          puVar12[1] = '\0';
          puVar12[2] = '\0';
          puVar12[3] = '\0';
          puVar12[4] = '\0';
          puVar12[5] = '\0';
          puVar12[6] = '\0';
          puVar12[7] = '\0';
          puVar12 = puVar12 + (ulong)bVar17 * -0x10 + 8;
        }
        HexToAscii(sMAC,(uchar *)sTmpField,0x10);
        if (cStack_13715 == '0') {
          nSecureMsgLen = 0;
        }
        else {
          puVar12 = (uchar *)sTmpData;
          for (lVar9 = 0x200; lVar9 != 0; lVar9 = lVar9 + -1) {
            puVar12[0] = '\0';
            puVar12[1] = '\0';
            puVar12[2] = '\0';
            puVar12[3] = '\0';
            puVar12[4] = '\0';
            puVar12[5] = '\0';
            puVar12[6] = '\0';
            puVar12[7] = '\0';
            puVar12 = puVar12 + (ulong)bVar17 * -0x10 + 8;
          }
          HexToAscii(sSecureMsgData,(uchar *)sTmpData,nSecureMsgLen * 2);
        }
        sprintf(sLine,"==> SECURE MESSAGING MAC       =[%s]",sTmpField);
        trace_event(sLine,5);
        puVar12 = sIssScriptData;
        for (lVar9 = 0x200; lVar9 != 0; lVar9 = lVar9 + -1) {
          puVar12[0] = '\0';
          puVar12[1] = '\0';
          puVar12[2] = '\0';
          puVar12[3] = '\0';
          puVar12[4] = '\0';
          puVar12[5] = '\0';
          puVar12[6] = '\0';
          puVar12[7] = '\0';
          puVar12 = puVar12 + (ulong)bVar17 * -0x10 + 8;
        }
        uVar10 = 0xffffffffffffffff;
        puVar12 = sIssCmdData;
        do {
          if (uVar10 == 0) break;
          uVar10 = uVar10 - 1;
          uVar1 = *puVar12;
          puVar12 = puVar12 + (ulong)bVar17 * -2 + 1;
        } while (uVar1 != '\0');
        uVar11 = 0xffffffffffffffff;
        puVar8 = (uint *)sTmpField;
        do {
          if (uVar11 == 0) break;
          uVar11 = uVar11 - 1;
          uVar5 = *puVar8;
          puVar8 = (uint *)((long)puVar8 + (ulong)bVar17 * -2 + 1);
        } while ((uchar)uVar5 != '\0');
        sprintf((char *)sIssScriptData,"86%02X",(long)nSecureMsgLen + ((~uVar10 - 2) + ~uVar11 >> 1)
               );
        uVar10 = 0xffffffffffffffff;
        puVar12 = sIssCmdData;
        do {
          if (uVar10 == 0) break;
          uVar10 = uVar10 - 1;
          uVar1 = *puVar12;
          puVar12 = puVar12 + (ulong)bVar17 * -2 + 1;
        } while (uVar1 != '\0');
        uVar11 = 0xffffffffffffffff;
        puVar12 = sIssScriptData;
        do {
          if (uVar11 == 0) break;
          uVar11 = uVar11 - 1;
          uVar1 = *puVar12;
          puVar12 = puVar12 + (ulong)bVar17 * -2 + 1;
        } while (uVar1 != '\0');
        memcpy(sIssCmdData + ~uVar11 + 0xfff,sIssCmdData,~uVar10 - 1);
        uVar10 = 0xffffffffffffffff;
        puVar12 = sIssScriptData;
        do {
          if (uVar10 == 0) break;
          uVar10 = uVar10 - 1;
          uVar1 = *puVar12;
          puVar12 = puVar12 + (ulong)bVar17 * -2 + 1;
        } while (uVar1 != '\0');
        memcpy(sIssCmdData + ~uVar10 + 0xfff,sTmpData,(long)(nSecureMsgLen * 2));
        uVar10 = 0xffffffffffffffff;
        puVar8 = (uint *)sTmpField;
        do {
          if (uVar10 == 0) break;
          uVar10 = uVar10 - 1;
          uVar5 = *puVar8;
          puVar8 = (uint *)((long)puVar8 + (ulong)bVar17 * -2 + 1);
        } while ((uchar)uVar5 != '\0');
        uVar11 = 0xffffffffffffffff;
        puVar12 = sIssScriptData;
        do {
          if (uVar11 == 0) break;
          uVar11 = uVar11 - 1;
          uVar1 = *puVar12;
          puVar12 = puVar12 + (ulong)bVar17 * -2 + 1;
        } while (uVar1 != '\0');
        memcpy(sIssCmdData + ~uVar11 + 0xfff,sTmpField,~uVar10 - 1);
        if ((sAuthDeclFlag[0] == 'Y') || (cStack_13715 != '0')) {
          uVar10 = 0xffffffffffffffff;
          puVar12 = sIssScriptData;
          do {
            if (uVar10 == 0) break;
            uVar10 = uVar10 - 1;
            uVar1 = *puVar12;
            puVar12 = puVar12 + (ulong)bVar17 * -2 + 1;
          } while (uVar1 != '\0');
          uVar11 = 0xffffffffffffffff;
          puVar12 = sTag71;
          do {
            if (uVar11 == 0) break;
            uVar11 = uVar11 - 1;
            uVar1 = *puVar12;
            puVar12 = puVar12 + (ulong)bVar17 * -2 + 1;
          } while (uVar1 != '\0');
          memcpy(sAuthDeclFlag + ~uVar11 + 0xfff,sIssScriptData,~uVar10 - 1);
        }
        else {
          uVar10 = 0xffffffffffffffff;
          puVar12 = sIssScriptData;
          do {
            if (uVar10 == 0) break;
            uVar10 = uVar10 - 1;
            uVar1 = *puVar12;
            puVar12 = puVar12 + (ulong)bVar17 * -2 + 1;
          } while (uVar1 != '\0');
          uVar11 = 0xffffffffffffffff;
          puVar12 = sTag72;
          do {
            if (uVar11 == 0) break;
            uVar11 = uVar11 - 1;
            uVar1 = *puVar12;
            puVar12 = puVar12 + (ulong)bVar17 * -2 + 1;
          } while (uVar1 != '\0');
          memcpy(sTag71 + ~uVar11 + 0xfff,sIssScriptData,~uVar10 - 1);
        }
        iVar3 = memcmp(pcVar13,&DAT_004aac5d,2);
      } while (iVar3 != 0);
      if (sTag71[0] == '\0') {
        if (sTag72[0] == '\0') {
          trace_event("End   gen_iss_script_data(NOK). NO ISSUER SCRIPT TO SEND",5);
          return -1;
        }
      }
      else {
        puVar12 = "9F180441424344";
        puVar8 = (uint *)szWork;
        for (lVar9 = 0xe; lVar9 != 0; lVar9 = lVar9 + -1) {
          *(uchar *)puVar8 = *puVar12;
          puVar12 = puVar12 + (ulong)bVar17 * -2 + 1;
          puVar8 = (uint *)((long)puVar8 + (ulong)bVar17 * -2 + 1);
        }
        nLenWork = 0xe;
        uVar10 = 0xffffffffffffffff;
        puVar12 = sTag71;
        do {
          if (uVar10 == 0) break;
          uVar10 = uVar10 - 1;
          uVar1 = *puVar12;
          puVar12 = puVar12 + (ulong)bVar17 * -2 + 1;
        } while (uVar1 != '\0');
        memcpy(puVar8,sTag71,~uVar10 - 1);
        nLenWork = (int)(~uVar10 - 1) + 0xe;
        PutTlvPrivate("C32",&tlvInfo,szWork,nLenWork);
        if (sTag72[0] == '\0') goto LAB_0047511d;
      }
      puVar12 = "9F180445464748";
      puVar8 = (uint *)szWork;
      for (lVar9 = 0xe; lVar9 != 0; lVar9 = lVar9 + -1) {
        *(uchar *)puVar8 = *puVar12;
        puVar12 = puVar12 + (ulong)bVar17 * -2 + 1;
        puVar8 = (uint *)((long)puVar8 + (ulong)bVar17 * -2 + 1);
      }
      nLenWork = 0xe;
      uVar10 = 0xffffffffffffffff;
      puVar12 = sTag72;
      do {
        if (uVar10 == 0) break;
        uVar10 = uVar10 - 1;
        uVar1 = *puVar12;
        puVar12 = puVar12 + (ulong)bVar17 * -2 + 1;
      } while (uVar1 != '\0');
      memcpy(puVar8,sTag72,~uVar10 - 1);
      nLenWork = (int)(~uVar10 - 1) + 0xe;
      PutTlvPrivate("C33",&tlvInfo,szWork,nLenWork);
LAB_0047511d:
      nIccLen = PrivateBuildTlv(sIccData,&tlvInfo);
      if (nIccLen != 0) {
        PutTlvBuffer("055",sTlvBuffer,sIccData,nIccLen);
      }
      trace_event("End   gen_iss_script_data(OK)",5);
      return 0;
    }
  }
  pcVar13 = "ERROR WhiLe GetTlvBuffer(AUTO_PAN) ";
  builtin_strncpy(sHsmResultCode,"-PAN",4);
LAB_004740c9:
  trace_event(pcVar13,1);
  trace_event("END   gen_iss_script_data(NOK)",5);
  return 3;
}



// WARNING: Unknown calling convention

int check_cvc3_data(int nIndiceCtx,char *sMkcvc3,char *sPan,char *sPanSeqNo,char *sExpiryDate,
                   char *sServiceCode,char *sAtc,char *sDcvv,char *sIvcvc3,int nDataLen,char *sData,
                   char *sUn,char *sCvc3,char *sHsmResultCode)

{
  int iVar1;
  long lVar2;
  uchar *puVar3;
  byte bVar4;
  pid_t nPid;
  uchar BuffRcv [256];
  char sLine [512];
  uchar BuffSnd [1516];
  
  bVar4 = 0;
  trace_event("Start check_cvc3_data()",5);
  puVar3 = BuffSnd;
  for (lVar2 = 0xbd; lVar2 != 0; lVar2 = lVar2 + -1) {
    puVar3[0] = '\0';
    puVar3[1] = '\0';
    puVar3[2] = '\0';
    puVar3[3] = '\0';
    puVar3[4] = '\0';
    puVar3[5] = '\0';
    puVar3[6] = '\0';
    puVar3[7] = '\0';
    puVar3 = puVar3 + (ulong)bVar4 * -0x10 + 8;
  }
  puVar3[0] = '\0';
  puVar3[1] = '\0';
  puVar3[2] = '\0';
  puVar3[3] = '\0';
  puVar3 = BuffRcv;
  for (lVar2 = 0x20; lVar2 != 0; lVar2 = lVar2 + -1) {
    puVar3[0] = '\0';
    puVar3[1] = '\0';
    puVar3[2] = '\0';
    puVar3[3] = '\0';
    puVar3[4] = '\0';
    puVar3[5] = '\0';
    puVar3[6] = '\0';
    puVar3[7] = '\0';
    puVar3 = puVar3 + (ulong)bVar4 * -0x10 + 8;
  }
  sprintf(sLine,"PAN  SEQUENCE NUMBER        : %s",sPanSeqNo);
  trace_event(sLine,5);
  sprintf(sLine,"EXPIRY DATE        : %s",sExpiryDate);
  trace_event(sLine,5);
  sprintf(sLine,"SERVICE CODE       : %s",sServiceCode);
  trace_event(sLine,5);
  sprintf(sLine,"MKCVC3 KEY       : %s",sMkcvc3);
  trace_event(sLine,5);
  sprintf(sLine,"ATC        : %s",sAtc);
  trace_event(sLine,5);
  sprintf(sLine,"DCVV        : %s",sDcvv);
  trace_event(sLine,5);
  sprintf(sLine,"IVCVC3        : %s",sIvcvc3);
  trace_event(sLine,5);
  sprintf(sLine,"DATA LENGHT        : %d",(ulong)(uint)nDataLen);
  trace_event(sLine,5);
  sprintf(sLine,"DATA        : %s",sData);
  trace_event(sLine,5);
  sprintf(sLine,"UN        : %s",sUn);
  trace_event(sLine,5);
  sprintf(sLine,"CVC3        : %s",sCvc3);
  trace_event(sLine,5);
  command_PM((char *)BuffSnd,'1','2',sMkcvc3,sPan,sPanSeqNo,sExpiryDate,sServiceCode,sAtc,sDcvv,
             sIvcvc3,nDataLen,sData,sUn,sCvc3);
  iVar1 = CheckResource(nIndiceCtx,"070000",&nPid);
  if ((iVar1 != 0) ||
     (iVar1 = HsmQuery(nIndiceCtx,nPid,(char *)BuffSnd,(char *)BuffRcv), iVar1 == 0x3ef)) {
    builtin_strncpy(sHsmResultCode,"UNVL",4);
    trace_event("HSM FOR VERIFICATION NOT AVAILABLE",1);
    trace_event("End   check_cvc3_data(HSM_UNAVAILABLE)",5);
    return 9;
  }
  if (iVar1 == 3) {
    builtin_strncpy(sHsmResultCode,"UNVL",4);
    trace_event("HSM MALFUNCTION DETECTED",1);
    trace_event("End   check_cvc3_data(MALFUNCTION)",5);
    return 3;
  }
  iVar1 = command_PN((char *)BuffRcv,sHsmResultCode);
  if (iVar1 != 0) {
    if (iVar1 == 1) {
      trace_event("End   check_cvc3_data(VERIFICATION_FAILED)",5);
      return 1;
    }
    if (iVar1 == 0x7d1) {
      trace_event("End check_cvc3_data(ERROR_COMMAND)",5);
      return 3;
    }
    trace_event("End   check_cvc3_data(CRYPTOGRAPHIC_ERROR)",5);
    return 2;
  }
  trace_event("End   check_cvc3_data(OK)",5);
  return 0;
}



// WARNING: Restarted to delay deadcode elimination for space: stack
// WARNING: Unknown calling convention

int check_crpt_data_18(int nIndexCtx,char *sTlvBuffer,char *sHsmResultCode)

{
  char cSchemeId;
  int iVar1;
  uint uVar2;
  uint uVar3;
  int iVar4;
  long lVar5;
  uint *puVar6;
  uint *puVar7;
  long lVar8;
  uchar *puVar9;
  char *pcVar10;
  uchar *puVar11;
  bool bVar12;
  byte bVar13;
  uchar sTrxType [2];
  uchar sAtc [3];
  uchar sCountryCode [3];
  uchar sCrncyCode [3];
  uchar sAip [3];
  uchar sTrxDate [4];
  int nLenWork;
  int nLenData;
  int nIccLen;
  pid_t nPid;
  uchar sUn [5];
  uchar sTermCountCOde [5];
  uchar sCvr [5];
  uchar sCsu [5];
  uchar sTvr [6];
  uchar sCrptAmount [7];
  uchar sOthrAmount [7];
  uchar sSeqNumber [9];
  uchar sFormatedPan [9];
  uchar sArqc [9];
  uchar sArpc [9];
  uchar sCsu_val [9];
  uchar sPan [23];
  uchar sAC_Key [256];
  uchar sArc [256];
  char sLine [512];
  uchar BuffSnd [4096];
  uchar BuffRcv [4096];
  uchar sData [4096];
  char szWork [4096];
  char sIccData [4096];
  char sTmpField [4096];
  char sTmpData [4096];
  char sLength [4096];
  char sLengthData [4096];
  char sIAD [4096];
  TSTlvPrivate tlvInfo;
  
  bVar13 = 0;
  nLenWork = 0;
  nLenData = 0;
  nIccLen = 0;
  trace_event("Start check_crpt_data_18( New)",5);
  puVar9 = BuffSnd;
  for (lVar5 = 0x200; lVar5 != 0; lVar5 = lVar5 + -1) {
    puVar9[0] = '\0';
    puVar9[1] = '\0';
    puVar9[2] = '\0';
    puVar9[3] = '\0';
    puVar9[4] = '\0';
    puVar9[5] = '\0';
    puVar9[6] = '\0';
    puVar9[7] = '\0';
    puVar9 = puVar9 + (ulong)bVar13 * -0x10 + 8;
  }
  sAtc[0] = '\0';
  sAtc[1] = '\0';
  sCrptAmount[4] = '\0';
  sCrptAmount[5] = '\0';
  sCountryCode[0] = '\0';
  sCountryCode[1] = '\0';
  sTvr[4] = '\0';
  sTvr[5] = '\0';
  sCrncyCode[0] = '\0';
  sCrncyCode[1] = '\0';
  sTrxType[0] = '\0';
  sTrxType[1] = '\0';
  sAip[0] = '\0';
  sAip[1] = '\0';
  sFormatedPan[0] = '\0';
  sFormatedPan[1] = '\0';
  sFormatedPan[2] = '\0';
  sFormatedPan[3] = '\0';
  sFormatedPan[4] = '\0';
  sFormatedPan[5] = '\0';
  sFormatedPan[6] = '\0';
  sFormatedPan[7] = '\0';
  sFormatedPan[8] = '\0';
  sAtc[2] = '\0';
  puVar9 = BuffRcv;
  for (lVar5 = 0x200; lVar5 != 0; lVar5 = lVar5 + -1) {
    puVar9[0] = '\0';
    puVar9[1] = '\0';
    puVar9[2] = '\0';
    puVar9[3] = '\0';
    puVar9[4] = '\0';
    puVar9[5] = '\0';
    puVar9[6] = '\0';
    puVar9[7] = '\0';
    puVar9 = puVar9 + (ulong)bVar13 * -0x10 + 8;
  }
  sUn[0] = '\0';
  sUn[1] = '\0';
  sUn[2] = '\0';
  sUn[3] = '\0';
  sUn[4] = '\0';
  sCrptAmount[0] = '\0';
  sCrptAmount[1] = '\0';
  sCrptAmount[2] = '\0';
  sCrptAmount[3] = '\0';
  sCrptAmount[6] = '\0';
  sOthrAmount[0] = '\0';
  sOthrAmount[1] = '\0';
  sOthrAmount[2] = '\0';
  sOthrAmount[3] = '\0';
  sOthrAmount[6] = '\0';
  sCountryCode[2] = '\0';
  sTvr[0] = '\0';
  sTvr[1] = '\0';
  sTvr[2] = '\0';
  sTvr[3] = '\0';
  sCrncyCode[2] = '\0';
  puVar9 = sData;
  for (lVar5 = 0x200; lVar5 != 0; lVar5 = lVar5 + -1) {
    puVar9[0] = '\0';
    puVar9[1] = '\0';
    puVar9[2] = '\0';
    puVar9[3] = '\0';
    puVar9[4] = '\0';
    puVar9[5] = '\0';
    puVar9[6] = '\0';
    puVar9[7] = '\0';
    puVar9 = puVar9 + (ulong)bVar13 * -0x10 + 8;
  }
  sTrxDate[0] = '\0';
  sTrxDate[1] = '\0';
  sTrxDate[2] = '\0';
  sTrxDate[3] = '\0';
  sAip[2] = '\0';
  sOthrAmount[4] = '\0';
  sOthrAmount[5] = '\0';
  sArqc[0] = '\0';
  sArqc[1] = '\0';
  sArqc[2] = '\0';
  sArqc[3] = '\0';
  sArqc[4] = '\0';
  sArqc[5] = '\0';
  sArqc[6] = '\0';
  sArqc[7] = '\0';
  sArqc[8] = '\0';
  sArpc[0] = '\0';
  sArpc[1] = '\0';
  sArpc[2] = '\0';
  sArpc[3] = '\0';
  sArpc[4] = '\0';
  sArpc[5] = '\0';
  sArpc[6] = '\0';
  sArpc[7] = '\0';
  sArpc[8] = '\0';
  sCsu_val[0] = '\0';
  sCsu_val[1] = '\0';
  sCsu_val[2] = '\0';
  sCsu_val[3] = '\0';
  sCsu_val[4] = '\0';
  sCsu_val[5] = '\0';
  sCsu_val[6] = '\0';
  sCsu_val[7] = '\0';
  sCsu_val[8] = '\0';
  sCsu[0] = '\0';
  sCsu[1] = '\0';
  sCsu[2] = '\0';
  sCsu[3] = '\0';
  puVar9 = sAC_Key;
  for (lVar5 = 0x20; lVar5 != 0; lVar5 = lVar5 + -1) {
    puVar9[0] = '\0';
    puVar9[1] = '\0';
    puVar9[2] = '\0';
    puVar9[3] = '\0';
    puVar9[4] = '\0';
    puVar9[5] = '\0';
    puVar9[6] = '\0';
    puVar9[7] = '\0';
    puVar9 = puVar9 + (ulong)bVar13 * -0x10 + 8;
  }
  sCsu[4] = '\0';
  puVar9 = (uchar *)szWork;
  for (lVar5 = 0x200; lVar5 != 0; lVar5 = lVar5 + -1) {
    puVar9[0] = '\0';
    puVar9[1] = '\0';
    puVar9[2] = '\0';
    puVar9[3] = '\0';
    puVar9[4] = '\0';
    puVar9[5] = '\0';
    puVar9[6] = '\0';
    puVar9[7] = '\0';
    puVar9 = puVar9 + (ulong)bVar13 * -0x10 + 8;
  }
  puVar7 = (uint *)sTmpField;
  for (lVar5 = 0x200; lVar5 != 0; lVar5 = lVar5 + -1) {
    puVar7[0] = 0;
    puVar7[1] = 0;
    puVar7 = puVar7 + (ulong)bVar13 * -4 + 2;
  }
  pcVar10 = sTmpData;
  for (lVar5 = 0x200; lVar5 != 0; lVar5 = lVar5 + -1) {
    pcVar10[0] = '\0';
    pcVar10[1] = '\0';
    pcVar10[2] = '\0';
    pcVar10[3] = '\0';
    pcVar10[4] = '\0';
    pcVar10[5] = '\0';
    pcVar10[6] = '\0';
    pcVar10[7] = '\0';
    pcVar10 = pcVar10 + (ulong)bVar13 * -0x10 + 8;
  }
  puVar9 = sArc;
  for (lVar5 = 0x20; lVar5 != 0; lVar5 = lVar5 + -1) {
    puVar9[0] = '\0';
    puVar9[1] = '\0';
    puVar9[2] = '\0';
    puVar9[3] = '\0';
    puVar9[4] = '\0';
    puVar9[5] = '\0';
    puVar9[6] = '\0';
    puVar9[7] = '\0';
    puVar9 = puVar9 + (ulong)bVar13 * -0x10 + 8;
  }
  puVar9 = (uchar *)sIAD;
  for (lVar5 = 0x200; lVar5 != 0; lVar5 = lVar5 + -1) {
    puVar9[0] = '\0';
    puVar9[1] = '\0';
    puVar9[2] = '\0';
    puVar9[3] = '\0';
    puVar9[4] = '\0';
    puVar9[5] = '\0';
    puVar9[6] = '\0';
    puVar9[7] = '\0';
    puVar9 = puVar9 + (ulong)bVar13 * -0x10 + 8;
  }
  puVar9 = (uchar *)sLength;
  for (lVar5 = 0x200; lVar5 != 0; lVar5 = lVar5 + -1) {
    puVar9[0] = '\0';
    puVar9[1] = '\0';
    puVar9[2] = '\0';
    puVar9[3] = '\0';
    puVar9[4] = '\0';
    puVar9[5] = '\0';
    puVar9[6] = '\0';
    puVar9[7] = '\0';
    puVar9 = puVar9 + (ulong)bVar13 * -0x10 + 8;
  }
  puVar9 = (uchar *)sLengthData;
  for (lVar5 = 0x200; lVar5 != 0; lVar5 = lVar5 + -1) {
    puVar9[0] = '\0';
    puVar9[1] = '\0';
    puVar9[2] = '\0';
    puVar9[3] = '\0';
    puVar9[4] = '\0';
    puVar9[5] = '\0';
    puVar9[6] = '\0';
    puVar9[7] = '\0';
    puVar9 = puVar9 + (ulong)bVar13 * -0x10 + 8;
  }
  iVar1 = GetTlvBuffer("002",sTlvBuffer,(char *)sPan,&nLenData);
  if (iVar1 == 0) {
    sSeqNumber[0] = '\0';
    sSeqNumber[1] = '\0';
    sSeqNumber[2] = '\0';
    sSeqNumber[3] = '\0';
    sSeqNumber[4] = '\0';
    sSeqNumber[5] = '\0';
    sSeqNumber[6] = '\0';
    sSeqNumber[7] = '\0';
    sSeqNumber[8] = '\0';
    iVar1 = GetTlvBuffer("023",sTlvBuffer,(char *)sSeqNumber,&nLenData);
    if (iVar1 != 0) {
      builtin_strncpy(sHsmResultCode,"-PAN",4);
      pcVar10 = "ERROR WhiLe GetIsoIcTag(ISO_TAG_TRANS_SEQ_NUM) ";
      goto LAB_00475c3e;
    }
    sprintf(sLine,"SEQUENCE NUMBER             : %s",sSeqNumber);
    trace_event(sLine,5);
    trace_event("- CRYPTOGRAM Verification ---------------",5);
    iVar1 = Get_AC_Key(nIndexCtx,(char *)sPan,(char *)sAC_Key);
    if (iVar1 != 0) {
      builtin_strncpy(sHsmResultCode,"-DMK",4);
      trace_event("INVALID KEY DMK ",1);
      trace_event("END   check_crpt_data_18(KEY_UNAVAILABLE)",5);
      return 3;
    }
    sprintf(sLine,"AC KEY IS                  : %s",sAC_Key);
    trace_event(sLine,5);
    builtin_strncpy(szWork,"0000000000000000",0x10);
    puVar7 = (uint *)sPan;
    do {
      puVar6 = puVar7;
      uVar2 = *puVar6 + 0xfefefeff & ~*puVar6;
      uVar3 = uVar2 & 0x80808080;
      puVar7 = puVar6 + 1;
    } while (uVar3 == 0);
    bVar12 = (uVar2 & 0x8080) == 0;
    if (bVar12) {
      uVar3 = uVar3 >> 0x10;
    }
    if (bVar12) {
      puVar7 = (uint *)((long)puVar6 + 6);
    }
    pcVar10 = (char *)((long)puVar7 + ((-3 - (ulong)CARRY1((byte)uVar3,(byte)uVar3)) - (long)sPan));
    memcpy(sTmpField,sPan,(size_t)pcVar10);
    *(undefined2 *)((long)sTmpField + (long)pcVar10) = sSeqNumber._1_2_;
    puVar7 = (uint *)sTmpField;
    do {
      puVar6 = puVar7;
      uVar2 = *puVar6 + 0xfefefeff & ~*puVar6;
      uVar3 = uVar2 & 0x80808080;
      puVar7 = puVar6 + 1;
    } while (uVar3 == 0);
    bVar12 = (uVar2 & 0x8080) == 0;
    if (bVar12) {
      uVar3 = uVar3 >> 0x10;
    }
    if (bVar12) {
      puVar7 = (uint *)((long)puVar6 + 6);
    }
    nLenWork = (((int)puVar7 + -3) - (uint)CARRY1((byte)uVar3,(byte)uVar3)) - (int)sTmpField;
    if (nLenWork < 0x10) {
      memcpy(szWork + (0x10 - nLenWork),sTmpField,(long)nLenWork);
    }
    else {
      szWork._0_8_ = *(undefined8 *)(sIccData + (long)nLenWork + 0xff0);
      szWork._8_8_ = *(undefined8 *)(sIccData + (long)nLenWork + 0xff8);
    }
    AsciiToHex((uchar *)szWork,sFormatedPan,0x10);
    if (debug_option == 1) {
      sprintf(sLine,"PRE FORMATED PAN   -    : %s",szWork);
      trace_event(sLine,5);
    }
    iVar1 = GetTlvBuffer("055",sTlvBuffer,sIccData,&nIccLen);
    if (iVar1 == 0) {
      InitTlvPrivate(&tlvInfo);
      AnalyseTlvPrivate(sIccData,nIccLen,&tlvInfo);
      iVar1 = GetTlvBuffer("204",sTlvBuffer,szWork,&nLenWork);
      cSchemeId = '2';
      if (iVar1 == 0) {
        iVar1 = memcmp(szWork,"01",2);
        cSchemeId = ~-(iVar1 == 0) + 0x32;
      }
      puVar9 = (uchar *)szWork;
      for (lVar5 = 0x200; lVar5 != 0; lVar5 = lVar5 + -1) {
        puVar9[0] = '\0';
        puVar9[1] = '\0';
        puVar9[2] = '\0';
        puVar9[3] = '\0';
        puVar9[4] = '\0';
        puVar9[5] = '\0';
        puVar9[6] = '\0';
        puVar9[7] = '\0';
        puVar9 = puVar9 + (ulong)bVar13 * -0x10 + 8;
      }
      sAtc[0] = '0';
      sAtc[1] = '0';
      iVar1 = GetTlvPrivate("C07",&tlvInfo,szWork,&nLenWork);
      if (iVar1 == 0) {
        AsciiToHex((uchar *)szWork,sAtc,4);
      }
      sprintf(sLine,"ATC                         : %s",szWork);
      trace_event(sLine,5);
      puVar9 = (uchar *)szWork;
      for (lVar5 = 0x200; lVar5 != 0; lVar5 = lVar5 + -1) {
        puVar9[0] = '\0';
        puVar9[1] = '\0';
        puVar9[2] = '\0';
        puVar9[3] = '\0';
        puVar9[4] = '\0';
        puVar9[5] = '\0';
        puVar9[6] = '\0';
        puVar9[7] = '\0';
        puVar9 = puVar9 + (ulong)bVar13 * -0x10 + 8;
      }
      iVar1 = GetTlvPrivate("C08",&tlvInfo,szWork,&nLenWork);
      if (iVar1 == 0) {
        AsciiToHex((uchar *)szWork,sUn,8);
      }
      sprintf(sLine,"UN                          : %s",szWork);
      trace_event(sLine,5);
      puVar9 = (uchar *)szWork;
      for (lVar5 = 0x200; lVar5 != 0; lVar5 = lVar5 + -1) {
        puVar9[0] = '\0';
        puVar9[1] = '\0';
        puVar9[2] = '\0';
        puVar9[3] = '\0';
        puVar9[4] = '\0';
        puVar9[5] = '\0';
        puVar9[6] = '\0';
        puVar9[7] = '\0';
        puVar9 = puVar9 + (ulong)bVar13 * -0x10 + 8;
      }
      nLenData = 0;
      iVar1 = GetTlvPrivate("C06",&tlvInfo,szWork,&nLenWork);
      if (iVar1 != 0) {
        sprintf(szWork,"%012d",0);
      }
      AsciiToHex((uchar *)szWork,sCrptAmount,0xc);
      sprintf(sLine,"CRPT AMOUNT                 : %s",szWork);
      trace_event(sLine,5);
      lVar5 = (long)nLenData;
      nLenData = nLenData + 6;
      *(undefined4 *)(sData + lVar5) = sCrptAmount._0_4_;
      *(undefined2 *)(sData + lVar5 + 4) = sCrptAmount._4_2_;
      puVar9 = (uchar *)szWork;
      for (lVar5 = 0x200; lVar5 != 0; lVar5 = lVar5 + -1) {
        puVar9[0] = '\0';
        puVar9[1] = '\0';
        puVar9[2] = '\0';
        puVar9[3] = '\0';
        puVar9[4] = '\0';
        puVar9[5] = '\0';
        puVar9[6] = '\0';
        puVar9[7] = '\0';
        puVar9 = puVar9 + (ulong)bVar13 * -0x10 + 8;
      }
      iVar1 = GetTlvPrivate("C21",&tlvInfo,szWork,&nLenWork);
      if (iVar1 != 0) {
        sprintf(szWork,"%012d",0);
      }
      AsciiToHex((uchar *)szWork,sOthrAmount,0xc);
      sprintf(sLine,"OTHER AMOUNT                 : %s",szWork);
      trace_event(sLine,5);
      lVar5 = (long)nLenData;
      nLenData = nLenData + 6;
      *(undefined4 *)(sData + lVar5) = sOthrAmount._0_4_;
      *(undefined2 *)(sData + lVar5 + 4) = sOthrAmount._4_2_;
      puVar9 = (uchar *)szWork;
      for (lVar5 = 0x200; lVar5 != 0; lVar5 = lVar5 + -1) {
        puVar9[0] = '\0';
        puVar9[1] = '\0';
        puVar9[2] = '\0';
        puVar9[3] = '\0';
        puVar9[4] = '\0';
        puVar9[5] = '\0';
        puVar9[6] = '\0';
        puVar9[7] = '\0';
        puVar9 = puVar9 + (ulong)bVar13 * -0x10 + 8;
      }
      iVar1 = GetTlvPrivate("C11",&tlvInfo,szWork,&nLenWork);
      if (iVar1 == 0) {
        AsciiToHex((uchar *)szWork,sCountryCode,4);
        sprintf(sLine,"COUNTRY CODE                 : %s",szWork);
        trace_event(sLine,5);
        lVar5 = (long)nLenData;
        nLenData = nLenData + 2;
        *(undefined2 *)(sData + lVar5) = sCountryCode._0_2_;
        puVar9 = (uchar *)szWork;
        for (lVar5 = 0x200; lVar5 != 0; lVar5 = lVar5 + -1) {
          puVar9[0] = '\0';
          puVar9[1] = '\0';
          puVar9[2] = '\0';
          puVar9[3] = '\0';
          puVar9[4] = '\0';
          puVar9[5] = '\0';
          puVar9[6] = '\0';
          puVar9[7] = '\0';
          puVar9 = puVar9 + (ulong)bVar13 * -0x10 + 8;
        }
        iVar1 = GetTlvPrivate("C10",&tlvInfo,szWork,&nLenWork);
        if (iVar1 == 0) {
          AsciiToHex((uchar *)szWork,sTvr,10);
          sprintf(sLine,"TVR                          : %s",szWork);
          trace_event(sLine,5);
          lVar5 = (long)nLenData;
          nLenData = nLenData + 5;
          *(undefined4 *)(sData + lVar5) = sTvr._0_4_;
          sData[lVar5 + 4] = sTvr[4];
          puVar9 = (uchar *)szWork;
          for (lVar5 = 0x200; lVar5 != 0; lVar5 = lVar5 + -1) {
            puVar9[0] = '\0';
            puVar9[1] = '\0';
            puVar9[2] = '\0';
            puVar9[3] = '\0';
            puVar9[4] = '\0';
            puVar9[5] = '\0';
            puVar9[6] = '\0';
            puVar9[7] = '\0';
            puVar9 = puVar9 + (ulong)bVar13 * -0x10 + 8;
          }
          iVar1 = GetTlvPrivate("C03",&tlvInfo,szWork,&nLenWork);
          if (iVar1 == 0) {
            AsciiToHex((uchar *)szWork,sCrncyCode,4);
            sprintf(sLine,"CURRENCY CODE                : %s",szWork);
            trace_event(sLine,5);
            lVar5 = (long)nLenData;
            nLenData = nLenData + 2;
            *(undefined2 *)(sData + lVar5) = sCrncyCode._0_2_;
            puVar9 = (uchar *)szWork;
            for (lVar5 = 0x200; lVar5 != 0; lVar5 = lVar5 + -1) {
              puVar9[0] = '\0';
              puVar9[1] = '\0';
              puVar9[2] = '\0';
              puVar9[3] = '\0';
              puVar9[4] = '\0';
              puVar9[5] = '\0';
              puVar9[6] = '\0';
              puVar9[7] = '\0';
              puVar9 = puVar9 + (ulong)bVar13 * -0x10 + 8;
            }
            iVar1 = GetTlvPrivate("C04",&tlvInfo,szWork,&nLenWork);
            if (iVar1 == 0) {
              AsciiToHex((uchar *)szWork,sTrxDate,6);
              sprintf(sLine,"TRANSACTION DATE             : %s",szWork);
              trace_event(sLine,5);
              lVar5 = (long)nLenData;
              nLenData = nLenData + 3;
              *(undefined2 *)(sData + lVar5) = sTrxDate._0_2_;
              sData[lVar5 + 2] = sTrxDate[2];
              puVar9 = (uchar *)szWork;
              for (lVar5 = 0x200; lVar5 != 0; lVar5 = lVar5 + -1) {
                puVar9[0] = '\0';
                puVar9[1] = '\0';
                puVar9[2] = '\0';
                puVar9[3] = '\0';
                puVar9[4] = '\0';
                puVar9[5] = '\0';
                puVar9[6] = '\0';
                puVar9[7] = '\0';
                puVar9 = puVar9 + (ulong)bVar13 * -0x10 + 8;
              }
              iVar1 = GetTlvPrivate("C05",&tlvInfo,szWork,&nLenWork);
              if (iVar1 == 0) {
                AsciiToHex((uchar *)szWork,sTrxType,2);
                sprintf(sLine,"TRANSACTION TYPE             : %s",szWork);
                trace_event(sLine,5);
                sData[nLenData] = sTrxType[0];
                iVar1 = nLenData + 1;
                nLenData = nLenData + 5;
                *(undefined4 *)(sData + iVar1) = sUn._0_4_;
                puVar9 = (uchar *)szWork;
                for (lVar5 = 0x200; lVar5 != 0; lVar5 = lVar5 + -1) {
                  puVar9[0] = '\0';
                  puVar9[1] = '\0';
                  puVar9[2] = '\0';
                  puVar9[3] = '\0';
                  puVar9[4] = '\0';
                  puVar9[5] = '\0';
                  puVar9[6] = '\0';
                  puVar9[7] = '\0';
                  puVar9 = puVar9 + (ulong)bVar13 * -0x10 + 8;
                }
                iVar1 = GetTlvPrivate("C12",&tlvInfo,szWork,&nLenWork);
                if (iVar1 == 0) {
                  AsciiToHex((uchar *)szWork,sAip,4);
                  sprintf(sLine,"AIP                          : %s",szWork);
                  trace_event(sLine,5);
                  *(undefined2 *)(sData + nLenData) = sAip._0_2_;
                  iVar1 = nLenData + 2;
                  nLenData = nLenData + 4;
                  *(undefined2 *)(sData + iVar1) = sAtc._0_2_;
                  puVar9 = (uchar *)szWork;
                  for (lVar5 = 0x200; lVar5 != 0; lVar5 = lVar5 + -1) {
                    puVar9[0] = '\0';
                    puVar9[1] = '\0';
                    puVar9[2] = '\0';
                    puVar9[3] = '\0';
                    puVar9[4] = '\0';
                    puVar9[5] = '\0';
                    puVar9[6] = '\0';
                    puVar9[7] = '\0';
                    puVar9 = puVar9 + (ulong)bVar13 * -0x10 + 8;
                  }
                  iVar1 = GetTlvPrivate("C20",&tlvInfo,szWork,&nLenWork);
                  if (iVar1 == 0) {
                    AsciiToHex((uchar *)szWork,(uchar *)sIAD,0xe);
                    sprintf(sLine,"AZE--IAD--szWork  : [%s]",szWork);
                    trace_event(sLine,5);
                  }
                  sprintf(sLine,"IAD                          : %s",szWork);
                  trace_event(sLine,5);
                  lVar8 = (long)nLenData;
                  nLenData = nLenData + 7;
                  puVar9 = (uchar *)sIAD;
                  puVar11 = sData + lVar8;
                  for (lVar5 = 7; lVar5 != 0; lVar5 = lVar5 + -1) {
                    *puVar11 = *puVar9;
                    puVar9 = puVar9 + (ulong)bVar13 * -2 + 1;
                    puVar11 = puVar11 + (ulong)bVar13 * -2 + 1;
                  }
                  puVar9 = (uchar *)"80000000000000";
                  puVar11 = (uchar *)sLength;
                  for (lVar5 = 0xe; lVar5 != 0; lVar5 = lVar5 + -1) {
                    *puVar11 = *puVar9;
                    puVar9 = puVar9 + (ulong)bVar13 * -2 + 1;
                    puVar11 = puVar11 + (ulong)bVar13 * -2 + 1;
                  }
                  puVar9 = (uchar *)sLengthData;
                  for (lVar5 = 0x200; lVar5 != 0; lVar5 = lVar5 + -1) {
                    puVar9[0] = '\0';
                    puVar9[1] = '\0';
                    puVar9[2] = '\0';
                    puVar9[3] = '\0';
                    puVar9[4] = '\0';
                    puVar9[5] = '\0';
                    puVar9[6] = '\0';
                    puVar9[7] = '\0';
                    puVar9 = puVar9 + (ulong)bVar13 * -0x10 + 8;
                  }
                  AsciiToHex((uchar *)sLength,(uchar *)sLengthData,0xe);
                  lVar8 = (long)nLenData;
                  nLenData = nLenData + 7;
                  puVar9 = (uchar *)sLengthData;
                  puVar11 = sData + lVar8;
                  for (lVar5 = 7; lVar5 != 0; lVar5 = lVar5 + -1) {
                    *puVar11 = *puVar9;
                    puVar9 = puVar9 + (ulong)bVar13 * -2 + 1;
                    puVar11 = puVar11 + (ulong)bVar13 * -2 + 1;
                  }
                  puVar9 = (uchar *)szWork;
                  for (lVar5 = 0x200; lVar5 != 0; lVar5 = lVar5 + -1) {
                    puVar9[0] = '\0';
                    puVar9[1] = '\0';
                    puVar9[2] = '\0';
                    puVar9[3] = '\0';
                    puVar9[4] = '\0';
                    puVar9[5] = '\0';
                    puVar9[6] = '\0';
                    puVar9[7] = '\0';
                    puVar9 = puVar9 + (ulong)bVar13 * -0x10 + 8;
                  }
                  iVar1 = GetTlvPrivate("C01",&tlvInfo,szWork,&nLenWork);
                  if (iVar1 == 0) {
                    AsciiToHex((uchar *)szWork,sArqc,0x10);
                  }
                  sprintf(sLine,"ARQC                         : %s",szWork);
                  trace_event(sLine,5);
                  builtin_memcpy(sCsu_val,"03820000",8);
                  sArc[0] = '0';
                  sArc[1] = '0';
                  AsciiToHex(sCsu_val,sCsu,8);
                  sprintf(sLine,"==> CSU VALUE2       : [%s]",sCsu_val);
                  trace_event(sLine,5);
                  lVar5 = (long)nLenData;
                  nLenData = nLenData + 1;
                  szWork._0_8_ = szWork._0_8_ & 0xffffffffff000000;
                  sData[lVar5] = '\0';
                  iVar1 = command_KW((char *)BuffSnd,cSchemeId,(char *)sAC_Key,(char *)sFormatedPan,
                                     (char *)sAtc,(char *)sUn,nLenData,(char *)sData,(char *)sArqc,
                                     (char *)sCsu);
                  iVar4 = CheckResource(nIndexCtx,"070000",&nPid);
                  if ((iVar4 != 0) ||
                     (iVar1 = HsmQueryBin(nIndexCtx,nPid,(char *)BuffSnd,iVar1,(char *)BuffRcv),
                     iVar1 == 0x3ef)) {
                    builtin_strncpy(sHsmResultCode,"UNVL",4);
                    trace_event("HSM FOR VERIFICATION NOT AVAILABLE",1);
                    trace_event("End   check_cvv_data(HSM_UNAVAILABLE)",5);
                    return 9;
                  }
                  if (iVar1 == 3) {
                    builtin_strncpy(sHsmResultCode,"UNVL",4);
                    trace_event("HSM MALFUNCTION DETECTED",1);
                    trace_event("End   check_cvv_data(MALFUNCTION)",5);
                    return 3;
                  }
                  iVar1 = command_KX((char *)BuffRcv,sHsmResultCode,(char *)sArpc);
                  if (iVar1 != 0) {
                    if (iVar1 == 1) {
                      trace_event("End   check_crpt_data_18(VERIFICATION_FAILED)",5);
                      return 1;
                    }
                    if (iVar1 == 0x7d1) {
                      trace_event("End check_cvv_data(ERROR_COMMAND)",5);
                      return 3;
                    }
                    trace_event("End   check_cvv_data(CRYPTOGRAPHIC_ERROR)",5);
                    return 2;
                  }
                  puVar9 = (uchar *)szWork;
                  for (lVar5 = 0x200; lVar5 != 0; lVar5 = lVar5 + -1) {
                    puVar9[0] = '\0';
                    puVar9[1] = '\0';
                    puVar9[2] = '\0';
                    puVar9[3] = '\0';
                    puVar9[4] = '\0';
                    puVar9[5] = '\0';
                    puVar9[6] = '\0';
                    puVar9[7] = '\0';
                    puVar9 = puVar9 + (ulong)bVar13 * -0x10 + 8;
                  }
                  puVar7 = (uint *)sTmpField;
                  for (lVar5 = 0x200; lVar5 != 0; lVar5 = lVar5 + -1) {
                    puVar7[0] = 0;
                    puVar7[1] = 0;
                    puVar7 = puVar7 + (ulong)bVar13 * -4 + 2;
                  }
                  HexToAscii(sArpc,(uchar *)szWork,0x10);
                  szWork[8] = sCsu_val[0];
                  szWork[9] = sCsu_val[1];
                  szWork[10] = sCsu_val[2];
                  szWork[0xb] = sCsu_val[3];
                  szWork[0xc] = sCsu_val[4];
                  szWork[0xd] = sCsu_val[5];
                  szWork[0xe] = sCsu_val[6];
                  szWork[0xf] = sCsu_val[7];
                  sprintf(sLine,"==> Issuer Authen Data LBE     : [%s]",szWork);
                  trace_event(sLine,5);
                  PutTlvPrivate("C23",&tlvInfo,szWork,0x10);
                  nIccLen = PrivateBuildTlv(sIccData,&tlvInfo);
                  PutTlvBuffer("055",sTlvBuffer,sIccData,nIccLen);
                  trace_event("End   check_crpt_data_18(OK)",5);
                  return 0;
                }
                builtin_strncpy(sHsmResultCode,"---4",4);
                pcVar10 = "==> CANNOT CHECK CRYPTOGRAM.  <<CHIP_AIP_TAG>> NOT RECEIVED <==";
              }
              else {
                builtin_strncpy(sHsmResultCode,"---3",4);
                pcVar10 = "==> CANNOT CHECK CRYPTOGRAM.  <<CHIP_TRANS_TYPE_TAG>> NOT RECEIVED <==";
              }
            }
            else {
              builtin_strncpy(sHsmResultCode,"---4",4);
              pcVar10 = "==> CANNOT CHECK CRYPTOGRAM.  <<CHIP_TRANS_DATE_TAG>> NOT RECEIVED <==";
            }
          }
          else {
            builtin_strncpy(sHsmResultCode,"---3",4);
            pcVar10 = "==> CANNOT CHECK CRYPTOGRAM.  <<CHIP_TRANS_CUR_CODE_TAG>> NOT RECEIVED <==";
          }
        }
        else {
          builtin_strncpy(sHsmResultCode,"---2",4);
          pcVar10 = "==> CANNOT CHECK CRYPTOGRAM.  <<CHIP_TVR_TAG>> NOT RECEIVED <==";
        }
      }
      else {
        pcVar10 = "==> CANNOT CHECK CRYPTOGRAM.  <<CHIP_TERM_COUNTRY_CODE_TAG>> NOT RECEIVED <==";
        builtin_strncpy(sHsmResultCode,"---1",4);
      }
      trace_event(pcVar10,1);
      trace_event("END   check_crpt_data(CRYPTOGRAPHIC_ERROR)",5);
      return 2;
    }
  }
  pcVar10 = "ERROR WhiLe GetTlvBuffer(AUTO_PAN) ";
  builtin_strncpy(sHsmResultCode,"-PAN",4);
LAB_00475c3e:
  trace_event(pcVar10,1);
  trace_event("END   check_crpt_data_18(NOK)",5);
  return 3;
}



// WARNING: Restarted to delay deadcode elimination for space: stack
// WARNING: Unknown calling convention

int check_crpt_data_ccd(int nIndexCtx,char *sTlvBuffer,char *sHsmResultCode)

{
  int iVar1;
  uint uVar2;
  uint uVar3;
  int iVar4;
  ulong uVar5;
  long lVar6;
  uint *puVar7;
  uint *puVar8;
  ulong uVar9;
  uchar *puVar10;
  char *pcVar11;
  uchar *puVar12;
  uchar *puVar13;
  uchar *puVar14;
  bool bVar15;
  byte bVar16;
  uchar sTrxType [2];
  uchar sAtc [3];
  uchar sCountryCode [3];
  uchar sCrncyCode [3];
  uchar sAip [3];
  uchar sTrxDate [4];
  int nLenWork;
  int nLenData;
  int nIccLen;
  pid_t nPid;
  uchar sUn [5];
  uchar sTermCountCOde [5];
  uchar sCvr [5];
  uchar sCsu [5];
  uchar sTvr [6];
  uchar sCrptAmount [7];
  uchar sOthrAmount [7];
  uchar sSeqNumber [9];
  uchar sFormatedPan [9];
  uchar sArqc [9];
  uchar sArpc [9];
  uchar sCsu_val [9];
  uchar sPan [23];
  uchar sAC_Key [256];
  uchar sArc [256];
  char sLine [512];
  uchar BuffSnd [4096];
  uchar BuffRcv [4096];
  uchar sData [4096];
  char szWork [4096];
  char sIccData [4096];
  char sTmpField [4096];
  char sTmpData [4096];
  char sLength [4096];
  char sLengthData [4096];
  char sIAD [4096];
  TSTlvPrivate tlvInfo;
  
  bVar16 = 0;
  nLenWork = 0;
  nLenData = 0;
  nIccLen = 0;
  trace_event("Start check_crpt_data_ccd( New)",5);
  puVar10 = BuffSnd;
  for (lVar6 = 0x200; lVar6 != 0; lVar6 = lVar6 + -1) {
    puVar10[0] = '\0';
    puVar10[1] = '\0';
    puVar10[2] = '\0';
    puVar10[3] = '\0';
    puVar10[4] = '\0';
    puVar10[5] = '\0';
    puVar10[6] = '\0';
    puVar10[7] = '\0';
    puVar10 = puVar10 + (ulong)bVar16 * -0x10 + 8;
  }
  sAtc[0] = '\0';
  sAtc[1] = '\0';
  sCrptAmount[4] = '\0';
  sCrptAmount[5] = '\0';
  sCountryCode[0] = '\0';
  sCountryCode[1] = '\0';
  sTvr[4] = '\0';
  sTvr[5] = '\0';
  sCrncyCode[0] = '\0';
  sCrncyCode[1] = '\0';
  sTrxType[0] = '\0';
  sTrxType[1] = '\0';
  sAip[0] = '\0';
  sAip[1] = '\0';
  sFormatedPan[0] = '\0';
  sFormatedPan[1] = '\0';
  sFormatedPan[2] = '\0';
  sFormatedPan[3] = '\0';
  sFormatedPan[4] = '\0';
  sFormatedPan[5] = '\0';
  sFormatedPan[6] = '\0';
  sFormatedPan[7] = '\0';
  sFormatedPan[8] = '\0';
  sAtc[2] = '\0';
  puVar10 = BuffRcv;
  for (lVar6 = 0x200; lVar6 != 0; lVar6 = lVar6 + -1) {
    puVar10[0] = '\0';
    puVar10[1] = '\0';
    puVar10[2] = '\0';
    puVar10[3] = '\0';
    puVar10[4] = '\0';
    puVar10[5] = '\0';
    puVar10[6] = '\0';
    puVar10[7] = '\0';
    puVar10 = puVar10 + (ulong)bVar16 * -0x10 + 8;
  }
  sUn[0] = '\0';
  sUn[1] = '\0';
  sUn[2] = '\0';
  sUn[3] = '\0';
  sUn[4] = '\0';
  sCrptAmount[0] = '\0';
  sCrptAmount[1] = '\0';
  sCrptAmount[2] = '\0';
  sCrptAmount[3] = '\0';
  sCrptAmount[6] = '\0';
  sOthrAmount[0] = '\0';
  sOthrAmount[1] = '\0';
  sOthrAmount[2] = '\0';
  sOthrAmount[3] = '\0';
  sOthrAmount[6] = '\0';
  sCountryCode[2] = '\0';
  sTvr[0] = '\0';
  sTvr[1] = '\0';
  sTvr[2] = '\0';
  sTvr[3] = '\0';
  sCrncyCode[2] = '\0';
  puVar10 = sData;
  for (lVar6 = 0x200; lVar6 != 0; lVar6 = lVar6 + -1) {
    puVar10[0] = '\0';
    puVar10[1] = '\0';
    puVar10[2] = '\0';
    puVar10[3] = '\0';
    puVar10[4] = '\0';
    puVar10[5] = '\0';
    puVar10[6] = '\0';
    puVar10[7] = '\0';
    puVar10 = puVar10 + (ulong)bVar16 * -0x10 + 8;
  }
  sTrxDate[0] = '\0';
  sTrxDate[1] = '\0';
  sTrxDate[2] = '\0';
  sTrxDate[3] = '\0';
  sAip[2] = '\0';
  sOthrAmount[4] = '\0';
  sOthrAmount[5] = '\0';
  sArqc[0] = '\0';
  sArqc[1] = '\0';
  sArqc[2] = '\0';
  sArqc[3] = '\0';
  sArqc[4] = '\0';
  sArqc[5] = '\0';
  sArqc[6] = '\0';
  sArqc[7] = '\0';
  sArqc[8] = '\0';
  sArpc[0] = '\0';
  sArpc[1] = '\0';
  sArpc[2] = '\0';
  sArpc[3] = '\0';
  sArpc[4] = '\0';
  sArpc[5] = '\0';
  sArpc[6] = '\0';
  sArpc[7] = '\0';
  sArpc[8] = '\0';
  sCsu_val[0] = '\0';
  sCsu_val[1] = '\0';
  sCsu_val[2] = '\0';
  sCsu_val[3] = '\0';
  sCsu_val[4] = '\0';
  sCsu_val[5] = '\0';
  sCsu_val[6] = '\0';
  sCsu_val[7] = '\0';
  sCsu_val[8] = '\0';
  sCsu[0] = '\0';
  sCsu[1] = '\0';
  sCsu[2] = '\0';
  sCsu[3] = '\0';
  puVar10 = sAC_Key;
  for (lVar6 = 0x20; lVar6 != 0; lVar6 = lVar6 + -1) {
    puVar10[0] = '\0';
    puVar10[1] = '\0';
    puVar10[2] = '\0';
    puVar10[3] = '\0';
    puVar10[4] = '\0';
    puVar10[5] = '\0';
    puVar10[6] = '\0';
    puVar10[7] = '\0';
    puVar10 = puVar10 + (ulong)bVar16 * -0x10 + 8;
  }
  sCsu[4] = '\0';
  puVar10 = (uchar *)szWork;
  for (lVar6 = 0x200; lVar6 != 0; lVar6 = lVar6 + -1) {
    puVar10[0] = '\0';
    puVar10[1] = '\0';
    puVar10[2] = '\0';
    puVar10[3] = '\0';
    puVar10[4] = '\0';
    puVar10[5] = '\0';
    puVar10[6] = '\0';
    puVar10[7] = '\0';
    puVar10 = puVar10 + (ulong)bVar16 * -0x10 + 8;
  }
  puVar8 = (uint *)sTmpField;
  for (lVar6 = 0x200; lVar6 != 0; lVar6 = lVar6 + -1) {
    puVar8[0] = 0;
    puVar8[1] = 0;
    puVar8 = puVar8 + (ulong)bVar16 * -4 + 2;
  }
  pcVar11 = sTmpData;
  for (lVar6 = 0x200; lVar6 != 0; lVar6 = lVar6 + -1) {
    pcVar11[0] = '\0';
    pcVar11[1] = '\0';
    pcVar11[2] = '\0';
    pcVar11[3] = '\0';
    pcVar11[4] = '\0';
    pcVar11[5] = '\0';
    pcVar11[6] = '\0';
    pcVar11[7] = '\0';
    pcVar11 = pcVar11 + (ulong)bVar16 * -0x10 + 8;
  }
  puVar10 = sArc;
  for (lVar6 = 0x20; lVar6 != 0; lVar6 = lVar6 + -1) {
    puVar10[0] = '\0';
    puVar10[1] = '\0';
    puVar10[2] = '\0';
    puVar10[3] = '\0';
    puVar10[4] = '\0';
    puVar10[5] = '\0';
    puVar10[6] = '\0';
    puVar10[7] = '\0';
    puVar10 = puVar10 + (ulong)bVar16 * -0x10 + 8;
  }
  puVar10 = (uchar *)sIAD;
  puVar13 = puVar10;
  for (lVar6 = 0x200; lVar6 != 0; lVar6 = lVar6 + -1) {
    puVar13[0] = '\0';
    puVar13[1] = '\0';
    puVar13[2] = '\0';
    puVar13[3] = '\0';
    puVar13[4] = '\0';
    puVar13[5] = '\0';
    puVar13[6] = '\0';
    puVar13[7] = '\0';
    puVar13 = puVar13 + (ulong)bVar16 * -0x10 + 8;
  }
  pcVar11 = sLength;
  for (lVar6 = 0x200; lVar6 != 0; lVar6 = lVar6 + -1) {
    pcVar11[0] = '\0';
    pcVar11[1] = '\0';
    pcVar11[2] = '\0';
    pcVar11[3] = '\0';
    pcVar11[4] = '\0';
    pcVar11[5] = '\0';
    pcVar11[6] = '\0';
    pcVar11[7] = '\0';
    pcVar11 = pcVar11 + (ulong)bVar16 * -0x10 + 8;
  }
  pcVar11 = sLengthData;
  for (lVar6 = 0x200; lVar6 != 0; lVar6 = lVar6 + -1) {
    pcVar11[0] = '\0';
    pcVar11[1] = '\0';
    pcVar11[2] = '\0';
    pcVar11[3] = '\0';
    pcVar11[4] = '\0';
    pcVar11[5] = '\0';
    pcVar11[6] = '\0';
    pcVar11[7] = '\0';
    pcVar11 = pcVar11 + (ulong)bVar16 * -0x10 + 8;
  }
  iVar1 = GetTlvBuffer("002",sTlvBuffer,(char *)sPan,&nLenData);
  if (iVar1 == 0) {
    sSeqNumber[0] = '\0';
    sSeqNumber[1] = '\0';
    sSeqNumber[2] = '\0';
    sSeqNumber[3] = '\0';
    sSeqNumber[4] = '\0';
    sSeqNumber[5] = '\0';
    sSeqNumber[6] = '\0';
    sSeqNumber[7] = '\0';
    sSeqNumber[8] = '\0';
    iVar1 = GetTlvBuffer("023",sTlvBuffer,(char *)sSeqNumber,&nLenData);
    if (iVar1 != 0) {
      builtin_strncpy(sHsmResultCode,"-PAN",4);
      pcVar11 = "ERROR WhiLe GetIsoIcTag(ISO_TAG_TRANS_SEQ_NUM) ";
      goto LAB_00476d4a;
    }
    sprintf(sLine,"SEQUENCE NUMBER             : %s",sSeqNumber);
    trace_event(sLine,5);
    trace_event("- CRYPTOGRAM Verification ---------------",5);
    iVar1 = Get_AC_Key(nIndexCtx,(char *)sPan,(char *)sAC_Key);
    if (iVar1 != 0) {
      builtin_strncpy(sHsmResultCode,"-DMK",4);
      trace_event("INVALID KEY DMK ",1);
      trace_event("END   check_crpt_data_ccd(KEY_UNAVAILABLE)",5);
      return 3;
    }
    sprintf(sLine,"AC KEY IS                  : %s",sAC_Key);
    trace_event(sLine,5);
    builtin_strncpy(szWork,"0000000000000000",0x10);
    puVar8 = (uint *)sPan;
    do {
      puVar7 = puVar8;
      uVar2 = *puVar7 + 0xfefefeff & ~*puVar7;
      uVar3 = uVar2 & 0x80808080;
      puVar8 = puVar7 + 1;
    } while (uVar3 == 0);
    bVar15 = (uVar2 & 0x8080) == 0;
    if (bVar15) {
      uVar3 = uVar3 >> 0x10;
    }
    if (bVar15) {
      puVar8 = (uint *)((long)puVar7 + 6);
    }
    pcVar11 = (char *)((long)puVar8 + ((-3 - (ulong)CARRY1((byte)uVar3,(byte)uVar3)) - (long)sPan));
    memcpy(sTmpField,sPan,(size_t)pcVar11);
    *(undefined2 *)((long)sTmpField + (long)pcVar11) = sSeqNumber._1_2_;
    puVar8 = (uint *)sTmpField;
    do {
      puVar7 = puVar8;
      uVar2 = *puVar7 + 0xfefefeff & ~*puVar7;
      uVar3 = uVar2 & 0x80808080;
      puVar8 = puVar7 + 1;
    } while (uVar3 == 0);
    bVar15 = (uVar2 & 0x8080) == 0;
    if (bVar15) {
      uVar3 = uVar3 >> 0x10;
    }
    if (bVar15) {
      puVar8 = (uint *)((long)puVar7 + 6);
    }
    nLenWork = (((int)puVar8 + -3) - (uint)CARRY1((byte)uVar3,(byte)uVar3)) - (int)sTmpField;
    if (nLenWork < 0x10) {
      memcpy(szWork + (0x10 - nLenWork),sTmpField,(long)nLenWork);
    }
    else {
      szWork._0_8_ = *(undefined8 *)(sIccData + (long)nLenWork + 0xff0);
      szWork._8_8_ = *(undefined8 *)(sIccData + (long)nLenWork + 0xff8);
    }
    AsciiToHex((uchar *)szWork,sFormatedPan,0x10);
    if (debug_option == 1) {
      sprintf(sLine,"PRE FORMATED PAN   -    : %s",szWork);
      trace_event(sLine,5);
    }
    iVar1 = GetTlvBuffer("055",sTlvBuffer,sIccData,&nIccLen);
    if (iVar1 == 0) {
      InitTlvPrivate(&tlvInfo);
      AnalyseTlvPrivate(sIccData,nIccLen,&tlvInfo);
      puVar13 = (uchar *)szWork;
      for (lVar6 = 0x200; lVar6 != 0; lVar6 = lVar6 + -1) {
        puVar13[0] = '\0';
        puVar13[1] = '\0';
        puVar13[2] = '\0';
        puVar13[3] = '\0';
        puVar13[4] = '\0';
        puVar13[5] = '\0';
        puVar13[6] = '\0';
        puVar13[7] = '\0';
        puVar13 = puVar13 + (ulong)bVar16 * -0x10 + 8;
      }
      sAtc[0] = '0';
      sAtc[1] = '0';
      iVar1 = GetTlvPrivate("C07",&tlvInfo,szWork,&nLenWork);
      if (iVar1 == 0) {
        AsciiToHex((uchar *)szWork,sAtc,4);
      }
      sprintf(sLine,"ATC                         : %s",szWork);
      trace_event(sLine,5);
      puVar13 = (uchar *)szWork;
      for (lVar6 = 0x200; lVar6 != 0; lVar6 = lVar6 + -1) {
        puVar13[0] = '\0';
        puVar13[1] = '\0';
        puVar13[2] = '\0';
        puVar13[3] = '\0';
        puVar13[4] = '\0';
        puVar13[5] = '\0';
        puVar13[6] = '\0';
        puVar13[7] = '\0';
        puVar13 = puVar13 + (ulong)bVar16 * -0x10 + 8;
      }
      iVar1 = GetTlvPrivate("C08",&tlvInfo,szWork,&nLenWork);
      if (iVar1 == 0) {
        AsciiToHex((uchar *)szWork,sUn,8);
      }
      sprintf(sLine,"UN                          : %s",szWork);
      trace_event(sLine,5);
      puVar13 = (uchar *)szWork;
      for (lVar6 = 0x200; lVar6 != 0; lVar6 = lVar6 + -1) {
        puVar13[0] = '\0';
        puVar13[1] = '\0';
        puVar13[2] = '\0';
        puVar13[3] = '\0';
        puVar13[4] = '\0';
        puVar13[5] = '\0';
        puVar13[6] = '\0';
        puVar13[7] = '\0';
        puVar13 = puVar13 + (ulong)bVar16 * -0x10 + 8;
      }
      nLenData = 0;
      iVar1 = GetTlvPrivate("C06",&tlvInfo,szWork,&nLenWork);
      if (iVar1 != 0) {
        sprintf(szWork,"%012d",0);
      }
      AsciiToHex((uchar *)szWork,sCrptAmount,0xc);
      sprintf(sLine,"CRPT AMOUNT                 : %s",szWork);
      trace_event(sLine,5);
      lVar6 = (long)nLenData;
      nLenData = nLenData + 6;
      *(undefined4 *)(sData + lVar6) = sCrptAmount._0_4_;
      *(undefined2 *)(sData + lVar6 + 4) = sCrptAmount._4_2_;
      puVar13 = (uchar *)szWork;
      for (lVar6 = 0x200; lVar6 != 0; lVar6 = lVar6 + -1) {
        puVar13[0] = '\0';
        puVar13[1] = '\0';
        puVar13[2] = '\0';
        puVar13[3] = '\0';
        puVar13[4] = '\0';
        puVar13[5] = '\0';
        puVar13[6] = '\0';
        puVar13[7] = '\0';
        puVar13 = puVar13 + (ulong)bVar16 * -0x10 + 8;
      }
      iVar1 = GetTlvPrivate("C21",&tlvInfo,szWork,&nLenWork);
      if (iVar1 != 0) {
        sprintf(szWork,"%012d",0);
      }
      AsciiToHex((uchar *)szWork,sOthrAmount,0xc);
      sprintf(sLine,"OTHER AMOUNT                 : %s",szWork);
      trace_event(sLine,5);
      lVar6 = (long)nLenData;
      nLenData = nLenData + 6;
      *(undefined4 *)(sData + lVar6) = sOthrAmount._0_4_;
      *(undefined2 *)(sData + lVar6 + 4) = sOthrAmount._4_2_;
      puVar13 = (uchar *)szWork;
      for (lVar6 = 0x200; lVar6 != 0; lVar6 = lVar6 + -1) {
        puVar13[0] = '\0';
        puVar13[1] = '\0';
        puVar13[2] = '\0';
        puVar13[3] = '\0';
        puVar13[4] = '\0';
        puVar13[5] = '\0';
        puVar13[6] = '\0';
        puVar13[7] = '\0';
        puVar13 = puVar13 + (ulong)bVar16 * -0x10 + 8;
      }
      iVar1 = GetTlvPrivate("C11",&tlvInfo,szWork,&nLenWork);
      if (iVar1 == 0) {
        AsciiToHex((uchar *)szWork,sCountryCode,4);
        sprintf(sLine,"COUNTRY CODE                 : %s",szWork);
        trace_event(sLine,5);
        lVar6 = (long)nLenData;
        nLenData = nLenData + 2;
        *(undefined2 *)(sData + lVar6) = sCountryCode._0_2_;
        puVar13 = (uchar *)szWork;
        for (lVar6 = 0x200; lVar6 != 0; lVar6 = lVar6 + -1) {
          puVar13[0] = '\0';
          puVar13[1] = '\0';
          puVar13[2] = '\0';
          puVar13[3] = '\0';
          puVar13[4] = '\0';
          puVar13[5] = '\0';
          puVar13[6] = '\0';
          puVar13[7] = '\0';
          puVar13 = puVar13 + (ulong)bVar16 * -0x10 + 8;
        }
        iVar1 = GetTlvPrivate("C10",&tlvInfo,szWork,&nLenWork);
        if (iVar1 == 0) {
          AsciiToHex((uchar *)szWork,sTvr,10);
          sprintf(sLine,"TVR                          : %s",szWork);
          trace_event(sLine,5);
          lVar6 = (long)nLenData;
          nLenData = nLenData + 5;
          *(undefined4 *)(sData + lVar6) = sTvr._0_4_;
          sData[lVar6 + 4] = sTvr[4];
          puVar13 = (uchar *)szWork;
          for (lVar6 = 0x200; lVar6 != 0; lVar6 = lVar6 + -1) {
            puVar13[0] = '\0';
            puVar13[1] = '\0';
            puVar13[2] = '\0';
            puVar13[3] = '\0';
            puVar13[4] = '\0';
            puVar13[5] = '\0';
            puVar13[6] = '\0';
            puVar13[7] = '\0';
            puVar13 = puVar13 + (ulong)bVar16 * -0x10 + 8;
          }
          iVar1 = GetTlvPrivate("C03",&tlvInfo,szWork,&nLenWork);
          if (iVar1 == 0) {
            AsciiToHex((uchar *)szWork,sCrncyCode,4);
            sprintf(sLine,"CURRENCY CODE                : %s",szWork);
            trace_event(sLine,5);
            lVar6 = (long)nLenData;
            nLenData = nLenData + 2;
            *(undefined2 *)(sData + lVar6) = sCrncyCode._0_2_;
            puVar13 = (uchar *)szWork;
            for (lVar6 = 0x200; lVar6 != 0; lVar6 = lVar6 + -1) {
              puVar13[0] = '\0';
              puVar13[1] = '\0';
              puVar13[2] = '\0';
              puVar13[3] = '\0';
              puVar13[4] = '\0';
              puVar13[5] = '\0';
              puVar13[6] = '\0';
              puVar13[7] = '\0';
              puVar13 = puVar13 + (ulong)bVar16 * -0x10 + 8;
            }
            iVar1 = GetTlvPrivate("C04",&tlvInfo,szWork,&nLenWork);
            if (iVar1 == 0) {
              AsciiToHex((uchar *)szWork,sTrxDate,6);
              sprintf(sLine,"TRANSACTION DATE             : %s",szWork);
              trace_event(sLine,5);
              lVar6 = (long)nLenData;
              nLenData = nLenData + 3;
              *(undefined2 *)(sData + lVar6) = sTrxDate._0_2_;
              sData[lVar6 + 2] = sTrxDate[2];
              puVar13 = (uchar *)szWork;
              for (lVar6 = 0x200; lVar6 != 0; lVar6 = lVar6 + -1) {
                puVar13[0] = '\0';
                puVar13[1] = '\0';
                puVar13[2] = '\0';
                puVar13[3] = '\0';
                puVar13[4] = '\0';
                puVar13[5] = '\0';
                puVar13[6] = '\0';
                puVar13[7] = '\0';
                puVar13 = puVar13 + (ulong)bVar16 * -0x10 + 8;
              }
              iVar1 = GetTlvPrivate("C05",&tlvInfo,szWork,&nLenWork);
              if (iVar1 == 0) {
                AsciiToHex((uchar *)szWork,sTrxType,2);
                sprintf(sLine,"TRANSACTION TYPE             : %s",szWork);
                trace_event(sLine,5);
                sData[nLenData] = sTrxType[0];
                iVar1 = nLenData + 1;
                nLenData = nLenData + 5;
                *(undefined4 *)(sData + iVar1) = sUn._0_4_;
                puVar13 = (uchar *)szWork;
                for (lVar6 = 0x200; lVar6 != 0; lVar6 = lVar6 + -1) {
                  puVar13[0] = '\0';
                  puVar13[1] = '\0';
                  puVar13[2] = '\0';
                  puVar13[3] = '\0';
                  puVar13[4] = '\0';
                  puVar13[5] = '\0';
                  puVar13[6] = '\0';
                  puVar13[7] = '\0';
                  puVar13 = puVar13 + (ulong)bVar16 * -0x10 + 8;
                }
                iVar1 = GetTlvPrivate("C12",&tlvInfo,szWork,&nLenWork);
                if (iVar1 == 0) {
                  AsciiToHex((uchar *)szWork,sAip,4);
                  sprintf(sLine,"AIP                          : %s",szWork);
                  trace_event(sLine,5);
                  *(undefined2 *)(sData + nLenData) = sAip._0_2_;
                  iVar1 = nLenData + 2;
                  nLenData = nLenData + 4;
                  *(undefined2 *)(sData + iVar1) = sAtc._0_2_;
                  puVar13 = (uchar *)szWork;
                  for (lVar6 = 0x200; lVar6 != 0; lVar6 = lVar6 + -1) {
                    puVar13[0] = '\0';
                    puVar13[1] = '\0';
                    puVar13[2] = '\0';
                    puVar13[3] = '\0';
                    puVar13[4] = '\0';
                    puVar13[5] = '\0';
                    puVar13[6] = '\0';
                    puVar13[7] = '\0';
                    puVar13 = puVar13 + (ulong)bVar16 * -0x10 + 8;
                  }
                  iVar1 = GetTlvPrivate("C20",&tlvInfo,szWork,&nLenWork);
                  if (iVar1 == 0) {
                    AsciiToHex((uchar *)szWork,puVar10,0x40);
                    sprintf(sLine,"AZE--IAD--szWork  : [%s]",szWork);
                    trace_event(sLine,5);
                  }
                  sprintf(sLine,"IAD                          : %s",szWork);
                  trace_event(sLine,5);
                  uVar5 = 0x20;
                  puVar12 = sData + nLenData;
                  bVar15 = ((ulong)puVar12 & 1) != 0;
                  puVar13 = puVar12;
                  if (bVar15) {
                    puVar13 = sData + (ulong)bVar16 * -2 + (long)nLenData + 1;
                    puVar10 = (uchar *)(sIAD + (ulong)bVar16 * -2 + 1);
                    *puVar12 = sIAD[0];
                    uVar5 = 0x1f;
                  }
                  puVar12 = puVar10;
                  puVar14 = puVar13;
                  if (((ulong)puVar13 & 2) != 0) {
                    uVar5 = (ulong)((int)uVar5 - 2);
                    puVar14 = puVar13 + (ulong)bVar16 * -4 + 2;
                    puVar12 = puVar10 + (ulong)bVar16 * -4 + 2;
                    *(undefined2 *)puVar13 = *(undefined2 *)puVar10;
                  }
                  for (uVar9 = uVar5 >> 2; uVar9 != 0; uVar9 = uVar9 - 1) {
                    *(undefined4 *)puVar14 = *(undefined4 *)puVar12;
                    puVar12 = puVar12 + (ulong)bVar16 * -8 + 4;
                    puVar14 = puVar14 + (ulong)bVar16 * -8 + 4;
                  }
                  lVar6 = 0;
                  if ((uVar5 & 2) != 0) {
                    *(undefined2 *)puVar14 = *(undefined2 *)puVar12;
                    lVar6 = 2;
                  }
                  if (bVar15) {
                    puVar14[lVar6] = puVar12[lVar6];
                  }
                  puVar10 = (uchar *)szWork;
                  for (lVar6 = 0x200; lVar6 != 0; lVar6 = lVar6 + -1) {
                    puVar10[0] = '\0';
                    puVar10[1] = '\0';
                    puVar10[2] = '\0';
                    puVar10[3] = '\0';
                    puVar10[4] = '\0';
                    puVar10[5] = '\0';
                    puVar10[6] = '\0';
                    puVar10[7] = '\0';
                    puVar10 = puVar10 + (ulong)bVar16 * -0x10 + 8;
                  }
                  nLenData = nLenData + 0x20;
                  iVar1 = GetTlvPrivate("C01",&tlvInfo,szWork,&nLenWork);
                  if (iVar1 == 0) {
                    AsciiToHex((uchar *)szWork,sArqc,0x10);
                  }
                  sprintf(sLine,"ARQC                         : %s",szWork);
                  trace_event(sLine,5);
                  builtin_memcpy(sCsu_val,"00820000",8);
                  AsciiToHex(sCsu_val,sCsu,8);
                  sprintf(sLine,"==> CSU VALUE       : [%s]",sCsu_val);
                  trace_event(sLine,5);
                  szWork[0] = -0x80;
                  lVar6 = (long)nLenData;
                  nLenData = nLenData + 1;
                  sData[lVar6] = 0x80;
                  iVar1 = command_KW((char *)BuffSnd,'2',(char *)sAC_Key,(char *)sFormatedPan,
                                     (char *)sAtc,(char *)sUn,nLenData,(char *)sData,(char *)sArqc,
                                     (char *)sCsu);
                  iVar4 = CheckResource(nIndexCtx,"070000",&nPid);
                  if ((iVar4 != 0) ||
                     (iVar1 = HsmQueryBin(nIndexCtx,nPid,(char *)BuffSnd,iVar1,(char *)BuffRcv),
                     iVar1 == 0x3ef)) {
                    builtin_strncpy(sHsmResultCode,"UNVL",4);
                    trace_event("HSM FOR VERIFICATION NOT AVAILABLE",1);
                    trace_event("End   check_cvv_data(HSM_UNAVAILABLE)",5);
                    return 9;
                  }
                  if (iVar1 == 3) {
                    builtin_strncpy(sHsmResultCode,"UNVL",4);
                    trace_event("HSM MALFUNCTION DETECTED",1);
                    trace_event("End   check_cvv_data(MALFUNCTION)",5);
                    return 3;
                  }
                  iVar1 = command_KX((char *)BuffRcv,sHsmResultCode,(char *)sArpc);
                  if (iVar1 != 0) {
                    if (iVar1 == 1) {
                      trace_event("End   check_crpt_data_ccd(VERIFICATION_FAILED)",5);
                      return 1;
                    }
                    if (iVar1 == 0x7d1) {
                      trace_event("End check_cvv_data(ERROR_COMMAND)",5);
                      return 3;
                    }
                    trace_event("End   check_cvv_data(CRYPTOGRAPHIC_ERROR)",5);
                    return 2;
                  }
                  puVar10 = (uchar *)szWork;
                  for (lVar6 = 0x200; lVar6 != 0; lVar6 = lVar6 + -1) {
                    puVar10[0] = '\0';
                    puVar10[1] = '\0';
                    puVar10[2] = '\0';
                    puVar10[3] = '\0';
                    puVar10[4] = '\0';
                    puVar10[5] = '\0';
                    puVar10[6] = '\0';
                    puVar10[7] = '\0';
                    puVar10 = puVar10 + (ulong)bVar16 * -0x10 + 8;
                  }
                  puVar8 = (uint *)sTmpField;
                  for (lVar6 = 0x200; lVar6 != 0; lVar6 = lVar6 + -1) {
                    puVar8[0] = 0;
                    puVar8[1] = 0;
                    puVar8 = puVar8 + (ulong)bVar16 * -4 + 2;
                  }
                  HexToAscii(sArpc,(uchar *)szWork,0x10);
                  szWork[8] = sCsu_val[0];
                  szWork[9] = sCsu_val[1];
                  szWork[10] = sCsu_val[2];
                  szWork[0xb] = sCsu_val[3];
                  szWork[0xc] = sCsu_val[4];
                  szWork[0xd] = sCsu_val[5];
                  szWork[0xe] = sCsu_val[6];
                  szWork[0xf] = sCsu_val[7];
                  sprintf(sLine,"==> Issuer Authen Data CCD     : [%s]",szWork);
                  trace_event(sLine,5);
                  PutTlvPrivate("C23",&tlvInfo,szWork,0x10);
                  nIccLen = PrivateBuildTlv(sIccData,&tlvInfo);
                  PutTlvBuffer("055",sTlvBuffer,sIccData,nIccLen);
                  trace_event("End   check_crpt_data_ccd(OK)",5);
                  return 0;
                }
                builtin_strncpy(sHsmResultCode,"---4",4);
                pcVar11 = "==> CANNOT CHECK CRYPTOGRAM.  <<CHIP_AIP_TAG>> NOT RECEIVED <==";
              }
              else {
                builtin_strncpy(sHsmResultCode,"---3",4);
                pcVar11 = "==> CANNOT CHECK CRYPTOGRAM.  <<CHIP_TRANS_TYPE_TAG>> NOT RECEIVED <==";
              }
            }
            else {
              builtin_strncpy(sHsmResultCode,"---4",4);
              pcVar11 = "==> CANNOT CHECK CRYPTOGRAM.  <<CHIP_TRANS_DATE_TAG>> NOT RECEIVED <==";
            }
          }
          else {
            builtin_strncpy(sHsmResultCode,"---3",4);
            pcVar11 = "==> CANNOT CHECK CRYPTOGRAM.  <<CHIP_TRANS_CUR_CODE_TAG>> NOT RECEIVED <==";
          }
        }
        else {
          builtin_strncpy(sHsmResultCode,"---2",4);
          pcVar11 = "==> CANNOT CHECK CRYPTOGRAM.  <<CHIP_TVR_TAG>> NOT RECEIVED <==";
        }
      }
      else {
        pcVar11 = "==> CANNOT CHECK CRYPTOGRAM.  <<CHIP_TERM_COUNTRY_CODE_TAG>> NOT RECEIVED <==";
        builtin_strncpy(sHsmResultCode,"---1",4);
      }
      trace_event(pcVar11,1);
      trace_event("END   check_crpt_data(CRYPTOGRAPHIC_ERROR)",5);
      return 2;
    }
  }
  pcVar11 = "ERROR WhiLe GetTlvBuffer(AUTO_PAN) ";
  builtin_strncpy(sHsmResultCode,"-PAN",4);
LAB_00476d4a:
  trace_event(pcVar11,1);
  trace_event("END   check_crpt_data_ccd(NOK)",5);
  return 3;
}



// WARNING: Unknown calling convention

int check_crpt_data(int nIndexCtx,char *sTlvBuffer,char *sHsmResultCode)

{
  char cSchemeId;
  uchar uVar1;
  char cVar2;
  int iVar3;
  uint uVar4;
  uint uVar5;
  long lVar6;
  ulong uVar7;
  int iVar8;
  uint *puVar9;
  uint *puVar10;
  char *pcVar11;
  uchar *puVar12;
  bool bVar13;
  byte bVar14;
  ulong in_stack_ffffffffffff7a28;
  ulong in_stack_ffffffffffff7a30;
  ulong in_stack_ffffffffffff7a38;
  ulong in_stack_ffffffffffff7a40;
  uchar sTrxType [2];
  uchar sAtc [3];
  uchar sCountryCode [3];
  uchar sCrncyCode [3];
  uchar sAip [3];
  char sNetworkCode [3];
  uchar sTrxDate [4];
  int nLenWork;
  int nLenData;
  int nIccLen;
  pid_t nPid;
  uchar sUn [5];
  uchar sCvr [5];
  char v_icc_application_index [5];
  uchar sTvr [6];
  uchar sCrptAmount [7];
  uchar sOthrAmount [7];
  char v_issuing_bank_code [7];
  uchar sSeqNumber [9];
  uchar sFormatedPan [9];
  uchar sArqc [9];
  uchar sArpc [9];
  uchar sPan [23];
  char vCvr [33];
  uchar sArc [256];
  uchar sAC_Key [257];
  uchar BuffSnd [512];
  uchar BuffRcv [512];
  char sLine [512];
  uchar sData [1024];
  char szWork [4096];
  char sIccData [4096];
  char sTmpField [4096];
  char sTmpData [4096];
  char sIAD [4096];
  TSTlvPrivate tlvInfo;
  
  bVar14 = 0;
  nLenWork = 0;
  nLenData = 0;
  nIccLen = 0;
  trace_event("Start check_crpt_data()",5);
  puVar12 = BuffSnd;
  for (lVar6 = 0x40; lVar6 != 0; lVar6 = lVar6 + -1) {
    puVar12[0] = '\0';
    puVar12[1] = '\0';
    puVar12[2] = '\0';
    puVar12[3] = '\0';
    puVar12[4] = '\0';
    puVar12[5] = '\0';
    puVar12[6] = '\0';
    puVar12[7] = '\0';
    puVar12 = puVar12 + (ulong)bVar14 * -0x10 + 8;
  }
  sAtc[0] = '\0';
  sAtc[1] = '\0';
  sCrptAmount[4] = '\0';
  sCrptAmount[5] = '\0';
  sCountryCode[0] = '\0';
  sCountryCode[1] = '\0';
  sTvr[4] = '\0';
  sTvr[5] = '\0';
  sCrncyCode[0] = '\0';
  sCrncyCode[1] = '\0';
  sTrxType[0] = '\0';
  sTrxType[1] = '\0';
  sAip[0] = '\0';
  sAip[1] = '\0';
  sFormatedPan[0] = '\0';
  sFormatedPan[1] = '\0';
  sFormatedPan[2] = '\0';
  sFormatedPan[3] = '\0';
  sFormatedPan[4] = '\0';
  sFormatedPan[5] = '\0';
  sFormatedPan[6] = '\0';
  sFormatedPan[7] = '\0';
  sFormatedPan[8] = '\0';
  sAtc[2] = '\0';
  puVar12 = BuffRcv;
  for (lVar6 = 0x40; lVar6 != 0; lVar6 = lVar6 + -1) {
    puVar12[0] = '\0';
    puVar12[1] = '\0';
    puVar12[2] = '\0';
    puVar12[3] = '\0';
    puVar12[4] = '\0';
    puVar12[5] = '\0';
    puVar12[6] = '\0';
    puVar12[7] = '\0';
    puVar12 = puVar12 + (ulong)bVar14 * -0x10 + 8;
  }
  sUn[0] = '\0';
  sUn[1] = '\0';
  sUn[2] = '\0';
  sUn[3] = '\0';
  sUn[4] = '\0';
  sCrptAmount[0] = '\0';
  sCrptAmount[1] = '\0';
  sCrptAmount[2] = '\0';
  sCrptAmount[3] = '\0';
  sCrptAmount[6] = '\0';
  sOthrAmount[0] = '\0';
  sOthrAmount[1] = '\0';
  sOthrAmount[2] = '\0';
  sOthrAmount[3] = '\0';
  sOthrAmount[6] = '\0';
  sCountryCode[2] = '\0';
  sTvr[0] = '\0';
  sTvr[1] = '\0';
  sTvr[2] = '\0';
  sTvr[3] = '\0';
  sCrncyCode[2] = '\0';
  sTrxDate[0] = '\0';
  sTrxDate[1] = '\0';
  sTrxDate[2] = '\0';
  sTrxDate[3] = '\0';
  sAip[2] = '\0';
  puVar12 = sData;
  for (lVar6 = 0x80; lVar6 != 0; lVar6 = lVar6 + -1) {
    puVar12[0] = '\0';
    puVar12[1] = '\0';
    puVar12[2] = '\0';
    puVar12[3] = '\0';
    puVar12[4] = '\0';
    puVar12[5] = '\0';
    puVar12[6] = '\0';
    puVar12[7] = '\0';
    puVar12 = puVar12 + (ulong)bVar14 * -0x10 + 8;
  }
  sCvr[0] = '\0';
  sCvr[1] = '\0';
  sCvr[2] = '\0';
  sCvr[3] = '\0';
  sCvr[4] = '\0';
  sOthrAmount[4] = '\0';
  sOthrAmount[5] = '\0';
  sArqc[0] = '\0';
  sArqc[1] = '\0';
  sArqc[2] = '\0';
  sArqc[3] = '\0';
  sArqc[4] = '\0';
  sArqc[5] = '\0';
  sArqc[6] = '\0';
  sArqc[7] = '\0';
  sArqc[8] = '\0';
  puVar12 = sAC_Key;
  for (lVar6 = 0x20; lVar6 != 0; lVar6 = lVar6 + -1) {
    puVar12[0] = '\0';
    puVar12[1] = '\0';
    puVar12[2] = '\0';
    puVar12[3] = '\0';
    puVar12[4] = '\0';
    puVar12[5] = '\0';
    puVar12[6] = '\0';
    puVar12[7] = '\0';
    puVar12 = puVar12 + (ulong)bVar14 * -0x10 + 8;
  }
  sNetworkCode[0] = '\0';
  sNetworkCode[1] = '\0';
  sNetworkCode[2] = '\0';
  sPan[0] = '\0';
  sPan[1] = '\0';
  sPan[2] = '\0';
  sPan[3] = '\0';
  sPan[4] = '\0';
  sPan[5] = '\0';
  sPan[6] = '\0';
  sPan[7] = '\0';
  sPan[8] = '\0';
  sPan[9] = '\0';
  sPan[10] = '\0';
  sPan[0xb] = '\0';
  sPan[0xc] = '\0';
  sPan[0xd] = '\0';
  sPan[0xe] = '\0';
  sPan[0xf] = '\0';
  sPan[0x10] = '\0';
  sPan[0x11] = '\0';
  sPan[0x12] = '\0';
  sPan[0x13] = '\0';
  sPan[0x14] = '\0';
  sPan[0x15] = '\0';
  sPan[0x16] = '\0';
  v_icc_application_index[0] = '\0';
  v_icc_application_index[1] = '\0';
  v_icc_application_index[2] = '\0';
  v_icc_application_index[3] = '\0';
  v_icc_application_index[4] = '\0';
  v_issuing_bank_code[0] = '\0';
  v_issuing_bank_code[1] = '\0';
  v_issuing_bank_code[2] = '\0';
  v_issuing_bank_code[3] = '\0';
  *puVar12 = '\0';
  puVar12 = (uchar *)szWork;
  for (lVar6 = 0x200; lVar6 != 0; lVar6 = lVar6 + -1) {
    puVar12[0] = '\0';
    puVar12[1] = '\0';
    puVar12[2] = '\0';
    puVar12[3] = '\0';
    puVar12[4] = '\0';
    puVar12[5] = '\0';
    puVar12[6] = '\0';
    puVar12[7] = '\0';
    puVar12 = puVar12 + (ulong)bVar14 * -0x10 + 8;
  }
  v_issuing_bank_code[4] = '\0';
  v_issuing_bank_code[5] = '\0';
  v_issuing_bank_code[6] = '\0';
  vCvr[0] = '\0';
  vCvr[1] = '\0';
  vCvr[2] = '\0';
  vCvr[3] = '\0';
  vCvr[4] = '\0';
  vCvr[5] = '\0';
  vCvr[6] = '\0';
  vCvr[7] = '\0';
  vCvr[8] = '\0';
  vCvr[9] = '\0';
  vCvr[10] = '\0';
  vCvr[0xb] = '\0';
  vCvr[0xc] = '\0';
  vCvr[0xd] = '\0';
  vCvr[0xe] = '\0';
  vCvr[0xf] = '\0';
  vCvr[0x10] = '\0';
  vCvr[0x11] = '\0';
  vCvr[0x12] = '\0';
  vCvr[0x13] = '\0';
  vCvr[0x14] = '\0';
  vCvr[0x15] = '\0';
  vCvr[0x16] = '\0';
  vCvr[0x17] = '\0';
  vCvr[0x18] = '\0';
  vCvr[0x19] = '\0';
  vCvr[0x1a] = '\0';
  vCvr[0x1b] = '\0';
  vCvr[0x1c] = '\0';
  vCvr[0x1d] = '\0';
  vCvr[0x1e] = '\0';
  vCvr[0x1f] = '\0';
  vCvr[0x20] = '\0';
  sArpc[0] = '\0';
  sArpc[1] = '\0';
  sArpc[2] = '\0';
  sArpc[3] = '\0';
  sArpc[4] = '\0';
  sArpc[5] = '\0';
  sArpc[6] = '\0';
  sArpc[7] = '\0';
  sArpc[8] = '\0';
  pcVar11 = sLine;
  for (lVar6 = 0x40; lVar6 != 0; lVar6 = lVar6 + -1) {
    pcVar11[0] = '\0';
    pcVar11[1] = '\0';
    pcVar11[2] = '\0';
    pcVar11[3] = '\0';
    pcVar11[4] = '\0';
    pcVar11[5] = '\0';
    pcVar11[6] = '\0';
    pcVar11[7] = '\0';
    pcVar11 = pcVar11 + (ulong)bVar14 * -0x10 + 8;
  }
  puVar10 = (uint *)sTmpField;
  for (lVar6 = 0x200; lVar6 != 0; lVar6 = lVar6 + -1) {
    puVar10[0] = 0;
    puVar10[1] = 0;
    puVar10 = puVar10 + (ulong)bVar14 * -4 + 2;
  }
  pcVar11 = sTmpData;
  for (lVar6 = 0x200; lVar6 != 0; lVar6 = lVar6 + -1) {
    pcVar11[0] = '\0';
    pcVar11[1] = '\0';
    pcVar11[2] = '\0';
    pcVar11[3] = '\0';
    pcVar11[4] = '\0';
    pcVar11[5] = '\0';
    pcVar11[6] = '\0';
    pcVar11[7] = '\0';
    pcVar11 = pcVar11 + (ulong)bVar14 * -0x10 + 8;
  }
  puVar12 = sArc;
  for (lVar6 = 0x20; lVar6 != 0; lVar6 = lVar6 + -1) {
    puVar12[0] = '\0';
    puVar12[1] = '\0';
    puVar12[2] = '\0';
    puVar12[3] = '\0';
    puVar12[4] = '\0';
    puVar12[5] = '\0';
    puVar12[6] = '\0';
    puVar12[7] = '\0';
    puVar12 = puVar12 + (ulong)bVar14 * -0x10 + 8;
  }
  pcVar11 = sIccData;
  for (lVar6 = 0x200; lVar6 != 0; lVar6 = lVar6 + -1) {
    pcVar11[0] = '\0';
    pcVar11[1] = '\0';
    pcVar11[2] = '\0';
    pcVar11[3] = '\0';
    pcVar11[4] = '\0';
    pcVar11[5] = '\0';
    pcVar11[6] = '\0';
    pcVar11[7] = '\0';
    pcVar11 = pcVar11 + (ulong)bVar14 * -0x10 + 8;
  }
  pcVar11 = sIAD;
  for (lVar6 = 0x200; lVar6 != 0; lVar6 = lVar6 + -1) {
    pcVar11[0] = '\0';
    pcVar11[1] = '\0';
    pcVar11[2] = '\0';
    pcVar11[3] = '\0';
    pcVar11[4] = '\0';
    pcVar11[5] = '\0';
    pcVar11[6] = '\0';
    pcVar11[7] = '\0';
    pcVar11 = pcVar11 + (ulong)bVar14 * -0x10 + 8;
  }
  iVar3 = GetTlvBuffer("204",sTlvBuffer,szWork,&nLenWork);
  if ((iVar3 == 0) && (iVar3 = memcmp(szWork,"01",2), iVar3 == 0)) {
    iVar3 = GetTlvBuffer("055",sTlvBuffer,sIccData,&nIccLen);
    if (iVar3 == 0) {
      InitTlvPrivate(&tlvInfo);
      AnalyseTlvPrivate(sIccData,nIccLen,&tlvInfo);
      GetTlvPrivate("C20",&tlvInfo,szWork,&nLenWork);
      sprintf(sLine,"--IAD                         : %s",szWork);
      trace_event(sLine,5);
      iVar3 = memcmp(szWork + 4,&DAT_004d1f75,2);
      if (iVar3 == 0) {
        trace_event("Start check_crpt_data_18 Contactless(...)",5);
        iVar3 = check_crpt_data_18(nIndexCtx,sTlvBuffer,sHsmResultCode);
        return iVar3;
      }
      iVar3 = memcmp(szWork + 4,&DAT_004d1efb,2);
      if (iVar3 == 0) {
        iVar3 = check_crpt_data_17(nIndexCtx,sTlvBuffer,sHsmResultCode);
        return iVar3;
      }
      iVar3 = memcmp(szWork + 2,&DAT_004cf7e1,2);
      if (iVar3 == 0) {
        iVar3 = check_crpt_data_ccd(nIndexCtx,sTlvBuffer,sHsmResultCode);
        return iVar3;
      }
      goto LAB_00477e3e;
    }
    builtin_strncpy(sHsmResultCode,"-ICC",4);
  }
  else {
LAB_00477e3e:
    iVar3 = GetTlvBuffer("204",sTlvBuffer,szWork,&nLenWork);
    if ((iVar3 == 0) && (iVar3 = memcmp(szWork,&DAT_004d1e47,2), iVar3 == 0)) {
      iVar3 = check_crpt_data_dpas(nIndexCtx,sTlvBuffer,sHsmResultCode);
      return iVar3;
    }
    iVar3 = GetTlvBuffer("002",sTlvBuffer,(char *)sPan,&nLenData);
    if (iVar3 == 0) {
      sSeqNumber[0] = '\0';
      sSeqNumber[1] = '\0';
      sSeqNumber[2] = '\0';
      sSeqNumber[3] = '\0';
      sSeqNumber[4] = '\0';
      sSeqNumber[5] = '\0';
      sSeqNumber[6] = '\0';
      sSeqNumber[7] = '\0';
      sSeqNumber[8] = '\0';
      iVar3 = GetTlvBuffer("023",sTlvBuffer,(char *)sSeqNumber,&nLenData);
      if (iVar3 != 0) {
        trace_event("DE23 MISSING.  USE THE ZERO VALUE",0);
        sprintf((char *)sSeqNumber,"%03d",0);
      }
      if (debug_option == 1) {
        sprintf(sLine,"SEQUENCE NUMBER             : %s",sSeqNumber);
        trace_event(sLine,5);
      }
      trace_event("- CRYPTOGRAM Verification ---------------",5);
      iVar3 = Get_EMV_Key(nIndexCtx,(char *)sPan,"AC",(char *)sAC_Key);
      if (iVar3 != 0) {
        pcVar11 = "INVALID KEY DMK ";
        builtin_strncpy(sHsmResultCode,"-DMK",4);
LAB_004783db:
        trace_event(pcVar11,1);
        trace_event("END   check_crpt_data(KEY_UNAVAILABLE)",5);
        return 3;
      }
      if (debug_option == 1) {
        sprintf(sLine,"AC KEY IS                   : %s",sAC_Key);
        trace_event(sLine,5);
      }
      builtin_strncpy(szWork,"0000000000000000",0x10);
      puVar10 = (uint *)sPan;
      do {
        puVar9 = puVar10;
        uVar4 = *puVar9 + 0xfefefeff & ~*puVar9;
        uVar5 = uVar4 & 0x80808080;
        puVar10 = puVar9 + 1;
      } while (uVar5 == 0);
      bVar13 = (uVar4 & 0x8080) == 0;
      if (bVar13) {
        uVar5 = uVar5 >> 0x10;
      }
      if (bVar13) {
        puVar10 = (uint *)((long)puVar9 + 6);
      }
      pcVar11 = (char *)((long)puVar10 +
                        ((-3 - (ulong)CARRY1((byte)uVar5,(byte)uVar5)) - (long)sPan));
      memcpy(sTmpField,sPan,(size_t)pcVar11);
      *(undefined2 *)((long)sTmpField + (long)pcVar11) = sSeqNumber._1_2_;
      puVar10 = (uint *)sTmpField;
      do {
        puVar9 = puVar10;
        uVar4 = *puVar9 + 0xfefefeff & ~*puVar9;
        uVar5 = uVar4 & 0x80808080;
        puVar10 = puVar9 + 1;
      } while (uVar5 == 0);
      bVar13 = (uVar4 & 0x8080) == 0;
      if (bVar13) {
        uVar5 = uVar5 >> 0x10;
      }
      if (bVar13) {
        puVar10 = (uint *)((long)puVar9 + 6);
      }
      nLenWork = (((int)puVar10 + -3) - (uint)CARRY1((byte)uVar5,(byte)uVar5)) - (int)sTmpField;
      if (nLenWork < 0x10) {
        memcpy(szWork + (0x10 - nLenWork),sTmpField,(long)nLenWork);
      }
      else {
        szWork._0_8_ = *(undefined8 *)(sIccData + (long)nLenWork + 0xff0);
        szWork._8_8_ = *(undefined8 *)(sIccData + (long)nLenWork + 0xff8);
      }
      AsciiToHex((uchar *)szWork,sFormatedPan,0x10);
      iVar3 = GetTlvBuffer("055",sTlvBuffer,sIccData,&nIccLen);
      if (iVar3 == 0) {
        InitTlvPrivate(&tlvInfo);
        nLenWork = AnalyseTlvPrivate(sIccData,nIccLen,&tlvInfo);
        iVar3 = GetTlvBuffer("204",sTlvBuffer,sNetworkCode,&nLenWork);
        cSchemeId = '0';
        if (iVar3 == 0) {
          iVar3 = memcmp(sNetworkCode,&DAT_004a7e3d,2);
          cSchemeId = '1';
          if (iVar3 != 0) {
            iVar3 = memcmp(sNetworkCode,&DAT_004d1e8d,2);
            cSchemeId = ~-(iVar3 == 0) + 0x31;
          }
        }
        puVar12 = (uchar *)szWork;
        for (lVar6 = 0x200; lVar6 != 0; lVar6 = lVar6 + -1) {
          puVar12[0] = '\0';
          puVar12[1] = '\0';
          puVar12[2] = '\0';
          puVar12[3] = '\0';
          puVar12[4] = '\0';
          puVar12[5] = '\0';
          puVar12[6] = '\0';
          puVar12[7] = '\0';
          puVar12 = puVar12 + (ulong)bVar14 * -0x10 + 8;
        }
        sAtc[0] = '0';
        sAtc[1] = '0';
        iVar3 = GetTlvPrivate("C07",&tlvInfo,szWork,&nLenWork);
        if (iVar3 == 0) {
          AsciiToHex((uchar *)szWork,sAtc,4);
        }
        if (debug_option == 1) {
          sprintf(sLine,"ATC                         : %s",szWork);
          trace_event(sLine,5);
        }
        puVar12 = (uchar *)szWork;
        for (lVar6 = 0x200; lVar6 != 0; lVar6 = lVar6 + -1) {
          puVar12[0] = '\0';
          puVar12[1] = '\0';
          puVar12[2] = '\0';
          puVar12[3] = '\0';
          puVar12[4] = '\0';
          puVar12[5] = '\0';
          puVar12[6] = '\0';
          puVar12[7] = '\0';
          puVar12 = puVar12 + (ulong)bVar14 * -0x10 + 8;
        }
        iVar3 = GetTlvPrivate("C08",&tlvInfo,szWork,&nLenWork);
        if (iVar3 == 0) {
          AsciiToHex((uchar *)szWork,sUn,8);
        }
        sprintf(sLine,"UN                           : %s",szWork);
        trace_event(sLine,5);
        puVar12 = (uchar *)szWork;
        for (lVar6 = 0x200; lVar6 != 0; lVar6 = lVar6 + -1) {
          puVar12[0] = '\0';
          puVar12[1] = '\0';
          puVar12[2] = '\0';
          puVar12[3] = '\0';
          puVar12[4] = '\0';
          puVar12[5] = '\0';
          puVar12[6] = '\0';
          puVar12[7] = '\0';
          puVar12 = puVar12 + (ulong)bVar14 * -0x10 + 8;
        }
        nLenData = 0;
        iVar3 = GetTlvPrivate("C06",&tlvInfo,szWork,&nLenWork);
        if (iVar3 != 0) {
          sprintf(szWork,"%012d",0);
        }
        AsciiToHex((uchar *)szWork,sCrptAmount,0xc);
        sprintf(sLine,"CRPT AMOUNT                  : %s",szWork);
        trace_event(sLine,5);
        lVar6 = (long)nLenData;
        nLenData = nLenData + 6;
        *(undefined4 *)(sData + lVar6) = sCrptAmount._0_4_;
        *(undefined2 *)(sData + lVar6 + 4) = sCrptAmount._4_2_;
        puVar12 = (uchar *)szWork;
        for (lVar6 = 0x200; lVar6 != 0; lVar6 = lVar6 + -1) {
          puVar12[0] = '\0';
          puVar12[1] = '\0';
          puVar12[2] = '\0';
          puVar12[3] = '\0';
          puVar12[4] = '\0';
          puVar12[5] = '\0';
          puVar12[6] = '\0';
          puVar12[7] = '\0';
          puVar12 = puVar12 + (ulong)bVar14 * -0x10 + 8;
        }
        iVar3 = GetTlvPrivate("C21",&tlvInfo,szWork,&nLenWork);
        if (iVar3 != 0) {
          sprintf(szWork,"%012d",0);
        }
        AsciiToHex((uchar *)szWork,sOthrAmount,0xc);
        sprintf(sLine,"OTHER AMOUNT                 : %s",szWork);
        trace_event(sLine,5);
        lVar6 = (long)nLenData;
        nLenData = nLenData + 6;
        *(undefined4 *)(sData + lVar6) = sOthrAmount._0_4_;
        *(undefined2 *)(sData + lVar6 + 4) = sOthrAmount._4_2_;
        puVar12 = (uchar *)szWork;
        for (lVar6 = 0x200; lVar6 != 0; lVar6 = lVar6 + -1) {
          puVar12[0] = '\0';
          puVar12[1] = '\0';
          puVar12[2] = '\0';
          puVar12[3] = '\0';
          puVar12[4] = '\0';
          puVar12[5] = '\0';
          puVar12[6] = '\0';
          puVar12[7] = '\0';
          puVar12 = puVar12 + (ulong)bVar14 * -0x10 + 8;
        }
        iVar3 = GetTlvPrivate("C11",&tlvInfo,szWork,&nLenWork);
        if (iVar3 != 0) {
          pcVar11 = "==> CANNOT CHECK CRYPTOGRAM.  <<CHIP_TERM_COUNTRY_CODE_TAG>> NOT RECEIVED <==";
          builtin_strncpy(sHsmResultCode,"---1",4);
LAB_0047834e:
          trace_event(pcVar11,1);
          trace_event("END   check_crpt_data(CRYPTOGRAPHIC_ERROR)",5);
          return 2;
        }
        AsciiToHex((uchar *)szWork,sCountryCode,4);
        sprintf(sLine,"COUNTRY CODE                 : %s",szWork);
        trace_event(sLine,5);
        lVar6 = (long)nLenData;
        nLenData = nLenData + 2;
        *(undefined2 *)(sData + lVar6) = sCountryCode._0_2_;
        puVar12 = (uchar *)szWork;
        for (lVar6 = 0x200; lVar6 != 0; lVar6 = lVar6 + -1) {
          puVar12[0] = '\0';
          puVar12[1] = '\0';
          puVar12[2] = '\0';
          puVar12[3] = '\0';
          puVar12[4] = '\0';
          puVar12[5] = '\0';
          puVar12[6] = '\0';
          puVar12[7] = '\0';
          puVar12 = puVar12 + (ulong)bVar14 * -0x10 + 8;
        }
        iVar3 = GetTlvPrivate("C10",&tlvInfo,szWork,&nLenWork);
        if (iVar3 != 0) {
          builtin_strncpy(sHsmResultCode,"---2",4);
          pcVar11 = "==> CANNOT CHECK CRYPTOGRAM.  <<CHIP_TVR_TAG>> NOT RECEIVED <==";
          goto LAB_0047834e;
        }
        AsciiToHex((uchar *)szWork,sTvr,10);
        sprintf(sLine,"TVR                          : %s",szWork);
        trace_event(sLine,5);
        lVar6 = (long)nLenData;
        nLenData = nLenData + 5;
        *(undefined4 *)(sData + lVar6) = sTvr._0_4_;
        sData[lVar6 + 4] = sTvr[4];
        puVar12 = (uchar *)szWork;
        for (lVar6 = 0x200; lVar6 != 0; lVar6 = lVar6 + -1) {
          puVar12[0] = '\0';
          puVar12[1] = '\0';
          puVar12[2] = '\0';
          puVar12[3] = '\0';
          puVar12[4] = '\0';
          puVar12[5] = '\0';
          puVar12[6] = '\0';
          puVar12[7] = '\0';
          puVar12 = puVar12 + (ulong)bVar14 * -0x10 + 8;
        }
        iVar3 = GetTlvPrivate("C03",&tlvInfo,szWork,&nLenWork);
        if (iVar3 != 0) {
          builtin_strncpy(sHsmResultCode,"---3",4);
          pcVar11 = "==> CANNOT CHECK CRYPTOGRAM.  <<CHIP_TRANS_CUR_CODE_TAG>> NOT RECEIVED <==";
          goto LAB_0047834e;
        }
        AsciiToHex((uchar *)szWork,sCrncyCode,4);
        sprintf(sLine,"CURRENCY CODE                : %s",szWork);
        trace_event(sLine,5);
        lVar6 = (long)nLenData;
        nLenData = nLenData + 2;
        *(undefined2 *)(sData + lVar6) = sCrncyCode._0_2_;
        puVar12 = (uchar *)szWork;
        for (lVar6 = 0x200; lVar6 != 0; lVar6 = lVar6 + -1) {
          puVar12[0] = '\0';
          puVar12[1] = '\0';
          puVar12[2] = '\0';
          puVar12[3] = '\0';
          puVar12[4] = '\0';
          puVar12[5] = '\0';
          puVar12[6] = '\0';
          puVar12[7] = '\0';
          puVar12 = puVar12 + (ulong)bVar14 * -0x10 + 8;
        }
        iVar3 = GetTlvPrivate("C04",&tlvInfo,szWork,&nLenWork);
        if (iVar3 != 0) {
          builtin_strncpy(sHsmResultCode,"---4",4);
          pcVar11 = "==> CANNOT CHECK CRYPTOGRAM.  <<CHIP_TRANS_DATE_TAG>> NOT RECEIVED <==";
          goto LAB_0047834e;
        }
        AsciiToHex((uchar *)szWork,sTrxDate,6);
        sprintf(sLine,"TRANSACTION DATE             : %s",szWork);
        trace_event(sLine,5);
        lVar6 = (long)nLenData;
        nLenData = nLenData + 3;
        *(undefined2 *)(sData + lVar6) = sTrxDate._0_2_;
        sData[lVar6 + 2] = sTrxDate[2];
        puVar12 = (uchar *)szWork;
        for (lVar6 = 0x200; lVar6 != 0; lVar6 = lVar6 + -1) {
          puVar12[0] = '\0';
          puVar12[1] = '\0';
          puVar12[2] = '\0';
          puVar12[3] = '\0';
          puVar12[4] = '\0';
          puVar12[5] = '\0';
          puVar12[6] = '\0';
          puVar12[7] = '\0';
          puVar12 = puVar12 + (ulong)bVar14 * -0x10 + 8;
        }
        iVar3 = GetTlvPrivate("C05",&tlvInfo,szWork,&nLenWork);
        if (iVar3 != 0) {
          builtin_strncpy(sHsmResultCode,"---3",4);
          pcVar11 = "==> CANNOT CHECK CRYPTOGRAM.  <<CHIP_TRANS_TYPE_TAG>> NOT RECEIVED <==";
          goto LAB_0047834e;
        }
        AsciiToHex((uchar *)szWork,sTrxType,2);
        sprintf(sLine,"TRANSACTION TYPE             : %s",szWork);
        trace_event(sLine,5);
        sData[nLenData] = sTrxType[0];
        iVar3 = nLenData + 1;
        nLenData = nLenData + 5;
        *(undefined4 *)(sData + iVar3) = sUn._0_4_;
        puVar12 = (uchar *)szWork;
        for (lVar6 = 0x200; lVar6 != 0; lVar6 = lVar6 + -1) {
          puVar12[0] = '\0';
          puVar12[1] = '\0';
          puVar12[2] = '\0';
          puVar12[3] = '\0';
          puVar12[4] = '\0';
          puVar12[5] = '\0';
          puVar12[6] = '\0';
          puVar12[7] = '\0';
          puVar12 = puVar12 + (ulong)bVar14 * -0x10 + 8;
        }
        iVar3 = GetTlvPrivate("C12",&tlvInfo,szWork,&nLenWork);
        if (iVar3 != 0) {
          builtin_strncpy(sHsmResultCode,"---4",4);
          pcVar11 = "==> CANNOT CHECK CRYPTOGRAM.  <<CHIP_AIP_TAG>> NOT RECEIVED <==";
          goto LAB_0047834e;
        }
        AsciiToHex((uchar *)szWork,sAip,4);
        if (debug_option == 1) {
          sprintf(sLine,"AIP                          : %s",szWork);
          trace_event(sLine,5);
        }
        *(undefined2 *)(sData + nLenData) = sAip._0_2_;
        iVar3 = nLenData + 2;
        nLenData = nLenData + 4;
        *(undefined2 *)(sData + iVar3) = sAtc._0_2_;
        iVar3 = GetTlvBuffer("205",sTlvBuffer,v_issuing_bank_code,&nLenWork);
        if (iVar3 == 0) {
          iVar3 = GetTlvBuffer("900",sTlvBuffer,v_icc_application_index,&nLenWork);
          if (iVar3 != 0) {
            builtin_strncpy(sHsmResultCode,"-ICC",4);
            pcVar11 = "ERROR WhiLe GetTlvBuffer(ICC_APPLICATION_INDX) ";
            goto LAB_00477eb3;
          }
          pcVar11 = sIAD;
          for (lVar6 = 0x200; lVar6 != 0; lVar6 = lVar6 + -1) {
            pcVar11[0] = '\0';
            pcVar11[1] = '\0';
            pcVar11[2] = '\0';
            pcVar11[3] = '\0';
            pcVar11[4] = '\0';
            pcVar11[5] = '\0';
            pcVar11[6] = '\0';
            pcVar11[7] = '\0';
            pcVar11 = pcVar11 + (ulong)bVar14 * -0x10 + 8;
          }
          iVar3 = GetTlvPrivate("C20",&tlvInfo,sIAD,&nLenWork);
          if (iVar3 != 0) {
            sprintf(sIAD,"%32d",0);
          }
          puVar12 = (uchar *)vCvr;
          for (lVar6 = 0x21; lVar6 != 0; lVar6 = lVar6 + -1) {
            *puVar12 = '\0';
            puVar12 = puVar12 + (ulong)bVar14 * -2 + 1;
          }
          iVar3 = GetCVRFromIAD(nIndexCtx,sIAD,v_issuing_bank_code,v_icc_application_index,vCvr);
          if (iVar3 != 0) {
            builtin_strncpy(sHsmResultCode,"-CVR",4);
            pcVar11 = "INVALID CVR ";
            goto LAB_004783db;
          }
          sprintf(sLine,"CVR                          : [%s]",vCvr);
          trace_event(sLine,5);
          lVar6 = -1;
          puVar12 = (uchar *)vCvr;
          do {
            if (lVar6 == 0) break;
            lVar6 = lVar6 + -1;
            uVar1 = *puVar12;
            puVar12 = puVar12 + (ulong)bVar14 * -2 + 1;
          } while (uVar1 != '\0');
          iVar8 = ~(uint)lVar6 - 1;
          AsciiToHex((uchar *)vCvr,sCvr,iVar8);
          iVar3 = nLenData;
          iVar8 = iVar8 / 2;
          memcpy(sData + nLenData,sCvr,(long)iVar8);
          nLenData = iVar3 + iVar8;
          puVar12 = (uchar *)szWork;
          for (lVar6 = 0x200; lVar6 != 0; lVar6 = lVar6 + -1) {
            puVar12[0] = '\0';
            puVar12[1] = '\0';
            puVar12[2] = '\0';
            puVar12[3] = '\0';
            puVar12[4] = '\0';
            puVar12[5] = '\0';
            puVar12[6] = '\0';
            puVar12[7] = '\0';
            puVar12 = puVar12 + (ulong)bVar14 * -0x10 + 8;
          }
          iVar3 = GetTlvPrivate("C01",&tlvInfo,szWork,&nLenWork);
          if (iVar3 == 0) {
            AsciiToHex((uchar *)szWork,sArqc,0x10);
          }
          if (debug_option == 1) {
            sprintf(sLine,"ARQC                         : %s",szWork);
            trace_event(sLine,5);
          }
          puVar12 = (uchar *)szWork;
          for (lVar6 = 0x200; lVar6 != 0; lVar6 = lVar6 + -1) {
            puVar12[0] = '\0';
            puVar12[1] = '\0';
            puVar12[2] = '\0';
            puVar12[3] = '\0';
            puVar12[4] = '\0';
            puVar12[5] = '\0';
            puVar12[6] = '\0';
            puVar12[7] = '\0';
            puVar12 = puVar12 + (ulong)bVar14 * -0x10 + 8;
          }
          iVar3 = GetTlvPrivate("C24",&tlvInfo,szWork,&nLenWork);
          if (iVar3 == 0) {
            AsciiToHex((uchar *)szWork,sArc,4);
            puVar12 = (uchar *)szWork;
            for (lVar6 = 0x200; lVar6 != 0; lVar6 = lVar6 + -1) {
              puVar12[0] = '\0';
              puVar12[1] = '\0';
              puVar12[2] = '\0';
              puVar12[3] = '\0';
              puVar12[4] = '\0';
              puVar12[5] = '\0';
              puVar12[6] = '\0';
              puVar12[7] = '\0';
              puVar12 = puVar12 + (ulong)bVar14 * -0x10 + 8;
            }
            if (cSchemeId != '1') goto LAB_00478d49;
          }
          else {
            builtin_strncpy(szWork,"3030",5);
            if (cSchemeId != '1') {
              AsciiToHex((uchar *)szWork,sArc,4);
              puVar12 = (uchar *)szWork;
              for (lVar6 = 0x200; lVar6 != 0; lVar6 = lVar6 + -1) {
                puVar12[0] = '\0';
                puVar12[1] = '\0';
                puVar12[2] = '\0';
                puVar12[3] = '\0';
                puVar12[4] = '\0';
                puVar12[5] = '\0';
                puVar12[6] = '\0';
                puVar12[7] = '\0';
                puVar12 = puVar12 + (ulong)bVar14 * -0x10 + 8;
              }
              goto LAB_00478d49;
            }
            uVar7 = 0xffffffffffffffff;
            pcVar11 = sIAD;
            do {
              if (uVar7 == 0) break;
              uVar7 = uVar7 - 1;
              cVar2 = *pcVar11;
              pcVar11 = pcVar11 + (ulong)bVar14 * -2 + 1;
            } while (cVar2 != '\0');
            if ((0x23 < ~uVar7 - 1) && (iVar3 = memcmp(sNetworkCode,&DAT_004d1e8d,2), iVar3 != 0)) {
              builtin_strncpy(szWork,"0010",5);
              iVar3 = GetTlvBuffer("039",sTlvBuffer,sTmpField,&nLenWork);
              if ((iVar3 == 0) && (iVar3 = memcmp(sTmpField,"000",3), iVar3 != 0)) {
                builtin_strncpy(szWork,"0000",5);
              }
            }
            AsciiToHex((uchar *)szWork,sArc,4);
            puVar12 = (uchar *)szWork;
            for (lVar6 = 0x200; lVar6 != 0; lVar6 = lVar6 + -1) {
              puVar12[0] = '\0';
              puVar12[1] = '\0';
              puVar12[2] = '\0';
              puVar12[3] = '\0';
              puVar12[4] = '\0';
              puVar12[5] = '\0';
              puVar12[6] = '\0';
              puVar12[7] = '\0';
              puVar12 = puVar12 + (ulong)bVar14 * -0x10 + 8;
            }
          }
          iVar3 = memcmp(sNetworkCode,&DAT_004d1e8d,2);
          if (iVar3 != 0) {
            lVar6 = (long)nLenData;
            nLenData = nLenData + 1;
            sData[lVar6] = 0x80;
          }
LAB_00478d49:
          if (debug_option == 1) {
            sprintf(sLine,"szWork                       : %02x%02x%02x%02x%02x%02x%02x%02x",0,0,0,0,
                    in_stack_ffffffffffff7a28 & 0xffffffff00000000,
                    in_stack_ffffffffffff7a30 & 0xffffffff00000000,
                    in_stack_ffffffffffff7a38 & 0xffffffff00000000,
                    in_stack_ffffffffffff7a40 & 0xffffffff00000000);
            trace_event(sLine,5);
            sprintf(sLine,"ARPC-RC                      : %02x%02x",(ulong)sArc[0],(ulong)sArc[1]);
            trace_event(sLine,5);
          }
          sprintf(sLine,"123 EBL sNetworkCode: [%s]",sNetworkCode);
          trace_event(sLine,5);
          iVar3 = memcmp(sNetworkCode,&DAT_004d1ee1,2);
          if (iVar3 == 0) {
            iVar3 = command_JS((char *)BuffSnd,(char *)sAC_Key,(char *)sFormatedPan,(char *)sAtc,
                               nLenData,(char *)sData,(char *)sArqc,(char *)sArc);
          }
          else {
            iVar3 = command_KQ((char *)BuffSnd,cSchemeId,(char *)sAC_Key,(char *)sFormatedPan,
                               (char *)sAtc,(char *)sUn,nLenData,(char *)sData,(char *)sArqc,
                               (char *)sArc);
          }
          iVar8 = CheckResource(nIndexCtx,"070000",&nPid);
          if ((iVar8 != 0) ||
             (iVar3 = HsmQueryBin(nIndexCtx,nPid,(char *)BuffSnd,iVar3,(char *)BuffRcv),
             iVar3 == 0x3ef)) {
            builtin_strncpy(sHsmResultCode,"UNVL",4);
            trace_event("HSM FOR VERIFICATION NOT AVAILABLE",1);
            trace_event("End   check_crpt_data(HSM_UNAVAILABLE)",5);
            return 9;
          }
          if (iVar3 == 3) {
            builtin_strncpy(sHsmResultCode,"UNVL",4);
            trace_event("HSM MALFUNCTION DETECTED",1);
            trace_event("End   check_crpt_data(MALFUNCTION)",5);
            return 3;
          }
          iVar3 = memcmp(sNetworkCode,&DAT_004d1ee1,2);
          if (iVar3 == 0) {
            iVar3 = command_JT((char *)BuffRcv,sHsmResultCode,(char *)sArpc);
          }
          else {
            iVar3 = command_KR((char *)BuffRcv,sHsmResultCode,(char *)sArpc);
          }
          if (iVar3 != 0) {
            if (iVar3 == 1) {
              puVar12 = (uchar *)szWork;
              for (lVar6 = 0x200; lVar6 != 0; lVar6 = lVar6 + -1) {
                puVar12[0] = '\0';
                puVar12[1] = '\0';
                puVar12[2] = '\0';
                puVar12[3] = '\0';
                puVar12[4] = '\0';
                puVar12[5] = '\0';
                puVar12[6] = '\0';
                puVar12[7] = '\0';
                puVar12 = puVar12 + (ulong)bVar14 * -0x10 + 8;
              }
              puVar10 = (uint *)sTmpField;
              for (lVar6 = 0x200; lVar6 != 0; lVar6 = lVar6 + -1) {
                puVar10[0] = 0;
                puVar10[1] = 0;
                puVar10 = puVar10 + (ulong)bVar14 * -4 + 2;
              }
              HexToAscii(sArpc,(uchar *)szWork,0x10);
              sprintf(szWork + 0x10,"%02X%02X",(ulong)sArc[0],(ulong)sArc[1]);
              PutTlvPrivate("C23",&tlvInfo,szWork,0x14);
              nIccLen = PrivateBuildTlv(sIccData,&tlvInfo);
              PutTlvBuffer("055",sTlvBuffer,sIccData,nIccLen);
              trace_event("End   check_crpt_data(VERIFICATION_FAILED)",5);
              return 1;
            }
            if (iVar3 != 0x7d1) {
              trace_event("End   check_crpt_data(CRYPTOGRAPHIC_ERROR)",5);
              return 2;
            }
            trace_event("End check_crpt_data(ERROR_COMMAND)",5);
            return 3;
          }
          puVar12 = (uchar *)szWork;
          for (lVar6 = 0x200; lVar6 != 0; lVar6 = lVar6 + -1) {
            puVar12[0] = '\0';
            puVar12[1] = '\0';
            puVar12[2] = '\0';
            puVar12[3] = '\0';
            puVar12[4] = '\0';
            puVar12[5] = '\0';
            puVar12[6] = '\0';
            puVar12[7] = '\0';
            puVar12 = puVar12 + (ulong)bVar14 * -0x10 + 8;
          }
          puVar10 = (uint *)sTmpField;
          for (lVar6 = 0x200; lVar6 != 0; lVar6 = lVar6 + -1) {
            puVar10[0] = 0;
            puVar10[1] = 0;
            puVar10 = puVar10 + (ulong)bVar14 * -4 + 2;
          }
          HexToAscii(sArpc,(uchar *)szWork,0x10);
          if ((cSchemeId == '1') && (iVar3 = memcmp(sNetworkCode,&DAT_004d1e8d,2), iVar3 != 0)) {
            builtin_strncpy(szWork + 0x10,"0010",4);
          }
          else {
            builtin_strncpy(szWork + 0x10,"3030",4);
          }
          sprintf(sLine,"==> Issuer Authen Data       : [%s]",szWork);
          trace_event(sLine,5);
          PutTlvPrivate("C23",&tlvInfo,szWork,0x14);
          nIccLen = PrivateBuildTlv(sIccData,&tlvInfo);
          PutTlvBuffer("055",sTlvBuffer,sIccData,nIccLen);
          trace_event("End   check_crpt_data(OK)",5);
          return 0;
        }
        builtin_strncpy(sHsmResultCode,"-ICC",4);
        pcVar11 = "ERROR WhiLe GetTlvBuffer(AUTO_ISSUING_BANK) ";
        goto LAB_00477eb3;
      }
    }
    builtin_strncpy(sHsmResultCode,"-PAN",4);
  }
  pcVar11 = "ERROR WhiLe GetTlvBuffer(AUTO_PAN) ";
LAB_00477eb3:
  trace_event(pcVar11,1);
  trace_event("END   check_crpt_data(NOK)",5);
  return 3;
}



// WARNING: Unknown calling convention

int Sha256_ALgo(char *sData,char *sDataHash)

{
  uint uVar1;
  uint uVar2;
  long lVar3;
  uint *puVar4;
  uint *puVar5;
  uint *puVar6;
  SHA256_CTX *pSVar7;
  bool bVar8;
  byte bVar9;
  uint8_t results [32];
  SHA256_CTX ctx;
  uchar val [256];
  
  bVar9 = 0;
  pSVar7 = (SHA256_CTX *)results;
  trace_event("Start Sha256_ALgo",5);
  puVar6 = (uint *)val;
  for (lVar3 = 0x20; puVar4 = (uint *)val, lVar3 != 0; lVar3 = lVar3 + -1) {
    puVar6[0] = 0;
    puVar6[1] = 0;
    puVar6 = puVar6 + (ulong)bVar9 * -4 + 2;
  }
  do {
    puVar5 = (uint *)((long)puVar4 + 1);
    __isoc99_sscanf(sData,"%2hhx",puVar4);
    puVar6 = (uint *)val;
    puVar4 = puVar5;
    sData = sData + 2;
  } while (puVar5 != (uint *)&stack0xffffffffffffffd8);
  do {
    puVar4 = puVar6;
    uVar1 = *puVar4 + 0xfefefeff & ~*puVar4;
    uVar2 = uVar1 & 0x80808080;
    puVar6 = puVar4 + 1;
  } while (uVar2 == 0);
  bVar8 = (uVar1 & 0x8080) == 0;
  if (bVar8) {
    uVar2 = uVar2 >> 0x10;
  }
  if (bVar8) {
    puVar6 = (uint *)((long)puVar4 + 6);
  }
  SHA256_Init((SHA256_CTX *)&ctx);
  SHA256_Update((SHA256_CTX *)&ctx,val,
                (long)(int)((((int)puVar6 + -3) - (uint)CARRY1((byte)uVar2,(byte)uVar2)) - (int)val)
               );
  SHA256_Final(results,(SHA256_CTX *)&ctx);
  do {
    puVar6 = pSVar7->h;
    pSVar7 = (SHA256_CTX *)((long)pSVar7->h + 1);
    sprintf(sDataHash,"%02X",(ulong)(byte)*puVar6);
    sDataHash = sDataHash + 2;
  } while (pSVar7 != &ctx);
  trace_event("End Sha256_ALgo",5);
  return 0;
}



// WARNING: Unknown calling convention

int xorReduction(char *hexstring,char *output)

{
  byte bVar1;
  int iVar2;
  size_t sVar3;
  ulong uVar4;
  long lVar5;
  uchar *puVar6;
  uchar *puVar7;
  byte *pbVar8;
  char *pcVar9;
  uint uVar10;
  uchar res [5];
  char result [9];
  uchar val [33];
  char sLine [257];
  
  pcVar9 = sLine;
  for (lVar5 = 0x20; lVar5 != 0; lVar5 = lVar5 + -1) {
    pcVar9[0] = '\0';
    pcVar9[1] = '\0';
    pcVar9[2] = '\0';
    pcVar9[3] = '\0';
    pcVar9[4] = '\0';
    pcVar9[5] = '\0';
    pcVar9[6] = '\0';
    pcVar9[7] = '\0';
    pcVar9 = pcVar9 + 8;
  }
  *pcVar9 = '\0';
  sprintf(sLine,"Start xorReduction hexstring=(%s)",hexstring);
  trace_event(sLine,5);
  sVar3 = strlen(hexstring);
  iVar2 = (int)(sVar3 >> 1);
  if (0 < iVar2) {
    uVar4 = (ulong)(iVar2 - 1);
    puVar6 = val;
    puVar7 = val + 1;
    while( true ) {
      __isoc99_sscanf(hexstring,"%2hhx",puVar6);
      if (puVar7 == val + 1 + uVar4) break;
      puVar6 = puVar7;
      puVar7 = puVar7 + 1;
      hexstring = hexstring + 2;
    }
    lVar5 = 0;
    do {
      uVar10 = (uint)lVar5 & 3;
      pbVar8 = val + lVar5;
      lVar5 = lVar5 + 1;
      res[uVar10] = res[uVar10] ^ *pbVar8;
    } while (lVar5 != uVar4 + 1);
  }
  pbVar8 = res;
  pcVar9 = result;
  do {
    bVar1 = *pbVar8;
    pbVar8 = pbVar8 + 1;
    sprintf(pcVar9,"%02X",(ulong)bVar1);
    pcVar9 = pcVar9 + 2;
  } while (pbVar8 != res + 4);
  *(undefined8 *)output = result._0_8_;
  sprintf(sLine,"End xorReduction output=(%s) result=(%s)",output,result);
  trace_event(sLine,5);
  return 0;
}



// WARNING: Unknown calling convention

int check_aav_data_2_0(int nIndiceCtx,char *Pan,char *sDSTranID,char *aav_data_b64,
                      char *sHsmResultCode)

{
  undefined4 uVar1;
  undefined8 uVar2;
  int iVar3;
  uint uVar4;
  uint uVar5;
  size_t sVar6;
  long lVar7;
  uint *puVar8;
  uint *puVar9;
  char *pcVar10;
  ulong uVar11;
  uchar *puVar12;
  bool bVar13;
  pid_t nPid;
  char txnNone [4];
  char tmpField [5];
  char cavvNonce [9];
  char aav_value [16];
  char tsn [16];
  char auth_method [16];
  char control_byte [16];
  char key_id [16];
  char service_code [16];
  char str_temp [16];
  char CvkA [17];
  char CvkB [17];
  char acStack_7bb [3];
  char decimalNonceStr [24];
  char aav_key [33];
  char sDSTransactionID [37];
  uchar BuffSnd [256];
  uchar BuffRcv [256];
  char aav_data [256];
  char concatDetails [256];
  char hashValue [256];
  char sLine [512];
  
  aav_value[0] = '\0';
  aav_value[1] = '\0';
  aav_value[2] = '\0';
  aav_value[3] = '\0';
  aav_value[4] = '\0';
  aav_value[5] = '\0';
  aav_value[6] = '\0';
  aav_value[7] = '\0';
  aav_value[8] = '\0';
  aav_value[9] = '\0';
  aav_value[10] = '\0';
  aav_value[0xb] = '\0';
  aav_value[0xc] = '\0';
  aav_value[0xd] = '\0';
  aav_value[0xe] = '\0';
  aav_value[0xf] = '\0';
  pcVar10 = sLine;
  for (lVar7 = 0x40; lVar7 != 0; lVar7 = lVar7 + -1) {
    pcVar10[0] = '\0';
    pcVar10[1] = '\0';
    pcVar10[2] = '\0';
    pcVar10[3] = '\0';
    pcVar10[4] = '\0';
    pcVar10[5] = '\0';
    pcVar10[6] = '\0';
    pcVar10[7] = '\0';
    pcVar10 = pcVar10 + 8;
  }
  tsn[0] = '\0';
  tsn[1] = '\0';
  tsn[2] = '\0';
  tsn[3] = '\0';
  tsn[4] = '\0';
  tsn[5] = '\0';
  tsn[6] = '\0';
  tsn[7] = '\0';
  tsn[8] = '\0';
  tsn[9] = '\0';
  tsn[10] = '\0';
  tsn[0xb] = '\0';
  tsn[0xc] = '\0';
  tsn[0xd] = '\0';
  tsn[0xe] = '\0';
  tsn[0xf] = '\0';
  auth_method[0] = '\0';
  auth_method[1] = '\0';
  auth_method[2] = '\0';
  auth_method[3] = '\0';
  auth_method[4] = '\0';
  auth_method[5] = '\0';
  auth_method[6] = '\0';
  auth_method[7] = '\0';
  auth_method[8] = '\0';
  auth_method[9] = '\0';
  auth_method[10] = '\0';
  auth_method[0xb] = '\0';
  auth_method[0xc] = '\0';
  auth_method[0xd] = '\0';
  auth_method[0xe] = '\0';
  auth_method[0xf] = '\0';
  control_byte[0] = '\0';
  control_byte[1] = '\0';
  control_byte[2] = '\0';
  control_byte[3] = '\0';
  control_byte[4] = '\0';
  control_byte[5] = '\0';
  control_byte[6] = '\0';
  control_byte[7] = '\0';
  control_byte[8] = '\0';
  control_byte[9] = '\0';
  control_byte[10] = '\0';
  control_byte[0xb] = '\0';
  control_byte[0xc] = '\0';
  control_byte[0xd] = '\0';
  control_byte[0xe] = '\0';
  control_byte[0xf] = '\0';
  aav_key[0] = '\0';
  aav_key[1] = '\0';
  aav_key[2] = '\0';
  aav_key[3] = '\0';
  aav_key[4] = '\0';
  aav_key[5] = '\0';
  aav_key[6] = '\0';
  aav_key[7] = '\0';
  aav_key[8] = '\0';
  aav_key[9] = '\0';
  aav_key[10] = '\0';
  aav_key[0xb] = '\0';
  aav_key[0xc] = '\0';
  aav_key[0xd] = '\0';
  aav_key[0xe] = '\0';
  aav_key[0xf] = '\0';
  aav_key[0x10] = '\0';
  aav_key[0x11] = '\0';
  aav_key[0x12] = '\0';
  aav_key[0x13] = '\0';
  aav_key[0x14] = '\0';
  aav_key[0x15] = '\0';
  aav_key[0x16] = '\0';
  aav_key[0x17] = '\0';
  puVar12 = BuffSnd;
  for (lVar7 = 0x20; lVar7 != 0; lVar7 = lVar7 + -1) {
    puVar12[0] = '\0';
    puVar12[1] = '\0';
    puVar12[2] = '\0';
    puVar12[3] = '\0';
    puVar12[4] = '\0';
    puVar12[5] = '\0';
    puVar12[6] = '\0';
    puVar12[7] = '\0';
    puVar12 = puVar12 + 8;
  }
  aav_key[0x18] = '\0';
  aav_key[0x19] = '\0';
  aav_key[0x1a] = '\0';
  aav_key[0x1b] = '\0';
  aav_key[0x1c] = '\0';
  aav_key[0x1d] = '\0';
  aav_key[0x1e] = '\0';
  aav_key[0x1f] = '\0';
  aav_key[0x20] = '\0';
  key_id[0] = '\0';
  key_id[1] = '\0';
  key_id[2] = '\0';
  key_id[3] = '\0';
  key_id[4] = '\0';
  key_id[5] = '\0';
  key_id[6] = '\0';
  key_id[7] = '\0';
  key_id[8] = '\0';
  key_id[9] = '\0';
  key_id[10] = '\0';
  key_id[0xb] = '\0';
  key_id[0xc] = '\0';
  key_id[0xd] = '\0';
  key_id[0xe] = '\0';
  key_id[0xf] = '\0';
  service_code[0] = '\0';
  service_code[1] = '\0';
  service_code[2] = '\0';
  service_code[3] = '\0';
  service_code[4] = '\0';
  service_code[5] = '\0';
  service_code[6] = '\0';
  service_code[7] = '\0';
  service_code[8] = '\0';
  service_code[9] = '\0';
  service_code[10] = '\0';
  service_code[0xb] = '\0';
  service_code[0xc] = '\0';
  service_code[0xd] = '\0';
  service_code[0xe] = '\0';
  service_code[0xf] = '\0';
  CvkA[0] = '\0';
  CvkA[1] = '\0';
  CvkA[2] = '\0';
  CvkA[3] = '\0';
  CvkA[4] = '\0';
  CvkA[5] = '\0';
  CvkA[6] = '\0';
  CvkA[7] = '\0';
  puVar12 = BuffRcv;
  for (lVar7 = 0x20; lVar7 != 0; lVar7 = lVar7 + -1) {
    puVar12[0] = '\0';
    puVar12[1] = '\0';
    puVar12[2] = '\0';
    puVar12[3] = '\0';
    puVar12[4] = '\0';
    puVar12[5] = '\0';
    puVar12[6] = '\0';
    puVar12[7] = '\0';
    puVar12 = puVar12 + 8;
  }
  CvkA[8] = '\0';
  CvkA[9] = '\0';
  CvkA[10] = '\0';
  CvkA[0xb] = '\0';
  CvkA[0xc] = '\0';
  CvkA[0xd] = '\0';
  CvkA[0xe] = '\0';
  CvkA[0xf] = '\0';
  CvkA[0x10] = '\0';
  CvkB[0] = '\0';
  CvkB[1] = '\0';
  CvkB[2] = '\0';
  CvkB[3] = '\0';
  CvkB[4] = '\0';
  CvkB[5] = '\0';
  CvkB[6] = '\0';
  CvkB[7] = '\0';
  CvkB[8] = '\0';
  CvkB[9] = '\0';
  CvkB[10] = '\0';
  CvkB[0xb] = '\0';
  CvkB[0xc] = '\0';
  CvkB[0xd] = '\0';
  CvkB[0xe] = '\0';
  CvkB[0xf] = '\0';
  CvkB[0x10] = '\0';
  str_temp[0] = '\0';
  str_temp[1] = '\0';
  str_temp[2] = '\0';
  str_temp[3] = '\0';
  str_temp[4] = '\0';
  str_temp[5] = '\0';
  str_temp[6] = '\0';
  str_temp[7] = '\0';
  str_temp[8] = '\0';
  str_temp[9] = '\0';
  str_temp[10] = '\0';
  str_temp[0xb] = '\0';
  str_temp[0xc] = '\0';
  str_temp[0xd] = '\0';
  str_temp[0xe] = '\0';
  str_temp[0xf] = '\0';
  txnNone[0] = '\0';
  txnNone[1] = '\0';
  txnNone[2] = '\0';
  txnNone[3] = '\0';
  cavvNonce[0] = '\0';
  cavvNonce[1] = '\0';
  cavvNonce[2] = '\0';
  cavvNonce[3] = '\0';
  cavvNonce[4] = '\0';
  cavvNonce[5] = '\0';
  cavvNonce[6] = '\0';
  cavvNonce[7] = '\0';
  pcVar10 = aav_data;
  for (lVar7 = 0x20; lVar7 != 0; lVar7 = lVar7 + -1) {
    pcVar10[0] = '\0';
    pcVar10[1] = '\0';
    pcVar10[2] = '\0';
    pcVar10[3] = '\0';
    pcVar10[4] = '\0';
    pcVar10[5] = '\0';
    pcVar10[6] = '\0';
    pcVar10[7] = '\0';
    pcVar10 = pcVar10 + 8;
  }
  cavvNonce[8] = '\0';
  decimalNonceStr[0] = '\0';
  decimalNonceStr[1] = '\0';
  decimalNonceStr[2] = '\0';
  decimalNonceStr[3] = '\0';
  decimalNonceStr[4] = '\0';
  decimalNonceStr[5] = '\0';
  decimalNonceStr[6] = '\0';
  decimalNonceStr[7] = '\0';
  decimalNonceStr[8] = '\0';
  decimalNonceStr[9] = '\0';
  decimalNonceStr[10] = '\0';
  decimalNonceStr[0xb] = '\0';
  decimalNonceStr[0xc] = '\0';
  decimalNonceStr[0xd] = '\0';
  decimalNonceStr[0xe] = '\0';
  decimalNonceStr[0xf] = '\0';
  decimalNonceStr[0x10] = '\0';
  decimalNonceStr[0x11] = '\0';
  decimalNonceStr[0x12] = '\0';
  decimalNonceStr[0x13] = '\0';
  decimalNonceStr[0x14] = '\0';
  decimalNonceStr[0x15] = '\0';
  decimalNonceStr[0x16] = '\0';
  decimalNonceStr[0x17] = '\0';
  pcVar10 = concatDetails;
  for (lVar7 = 0x20; lVar7 != 0; lVar7 = lVar7 + -1) {
    pcVar10[0] = '\0';
    pcVar10[1] = '\0';
    pcVar10[2] = '\0';
    pcVar10[3] = '\0';
    pcVar10[4] = '\0';
    pcVar10[5] = '\0';
    pcVar10[6] = '\0';
    pcVar10[7] = '\0';
    pcVar10 = pcVar10 + 8;
  }
  pcVar10 = hashValue;
  for (lVar7 = 0x20; lVar7 != 0; lVar7 = lVar7 + -1) {
    pcVar10[0] = '\0';
    pcVar10[1] = '\0';
    pcVar10[2] = '\0';
    pcVar10[3] = '\0';
    pcVar10[4] = '\0';
    pcVar10[5] = '\0';
    pcVar10[6] = '\0';
    pcVar10[7] = '\0';
    pcVar10 = pcVar10 + 8;
  }
  puVar9 = (uint *)sDSTransactionID;
  for (lVar7 = 4; lVar7 != 0; lVar7 = lVar7 + -1) {
    puVar9[0] = 0;
    puVar9[1] = 0;
    puVar9 = puVar9 + 2;
  }
  *puVar9 = 0;
  *(undefined1 *)(puVar9 + 1) = 0;
  trace_event("Start check_aav_data_2_0()",5);
  Base64_Decode(nIndiceCtx,aav_data_b64,aav_data);
  sprintf(sLine,"aav_data_b64:%s",aav_data_b64);
  trace_event(sLine,5);
  if (debug_option == 1) {
    sprintf(sLine,"aav_data:%s",aav_data);
    trace_event(sLine,5);
  }
  if ((((((aav_data[1] == '6') || (iVar3 = memcmp(aav_data_b64,&DAT_004cf29e,2), iVar3 == 0)) ||
        (iVar3 = memcmp(aav_data_b64,&DAT_004cf2a1,2), iVar3 == 0)) ||
       ((iVar3 = memcmp(aav_data_b64,&DAT_004cf2a4,2), iVar3 == 0 ||
        (iVar3 = memcmp(aav_data_b64,&DAT_004cf2a7,2), iVar3 == 0)))) ||
      ((iVar3 = memcmp(aav_data_b64,&DAT_004cf2aa,2), iVar3 == 0 ||
       ((iVar3 = memcmp(aav_data_b64,&DAT_004cf2ad,2), iVar3 == 0 ||
        (iVar3 = memcmp(aav_data_b64,&DAT_004cf2b0,2), iVar3 == 0)))))) ||
     ((iVar3 = memcmp(aav_data_b64,&DAT_004cf2b3,2), iVar3 == 0 ||
      (iVar3 = memcmp(aav_data_b64,&DAT_004cf2b6,2), iVar3 == 0)))) {
    trace_event("AAV GENERATED BY NETWORK(NOK)",5);
    trace_event("End check_aav_data(NOK)",5);
    return -1;
  }
  control_byte[0] = aav_data[0];
  control_byte[1] = aav_data[1];
  auth_method[0] = aav_data[2];
  auth_method[1] = aav_data[3];
  iVar3 = 0;
  aav_value[2] = aav_data[6];
  aav_value[0] = aav_data[4];
  aav_value[1] = aav_data[5];
  key_id[0] = aav_data[7];
  txnNone[0] = aav_data[8];
  txnNone[1] = aav_data[9];
  txnNone[2] = aav_data[10];
  txnNone[3] = aav_data[0xb];
  sVar6 = strlen(sDSTranID);
  for (uVar11 = 0; uVar11 < sVar6; uVar11 = uVar11 + 1) {
    if (sDSTranID[uVar11] != '-') {
      lVar7 = (long)iVar3;
      iVar3 = iVar3 + 1;
      sDSTransactionID[lVar7] = sDSTranID[uVar11];
      sVar6 = strlen(sDSTranID);
    }
  }
  sprintf(sLine,"sDSTransactionID:%s",sDSTransactionID);
  trace_event(sLine,5);
  puVar9 = (uint *)sDSTransactionID;
  do {
    puVar8 = puVar9;
    uVar4 = *puVar8 + 0xfefefeff & ~*puVar8;
    uVar5 = uVar4 & 0x80808080;
    puVar9 = puVar8 + 1;
  } while (uVar5 == 0);
  bVar13 = (uVar4 & 0x8080) == 0;
  if (bVar13) {
    uVar5 = uVar5 >> 0x10;
  }
  if (bVar13) {
    puVar9 = (uint *)((long)puVar8 + 6);
  }
  sVar6 = (long)puVar9 + ((-3 - (ulong)CARRY1((byte)uVar5,(byte)uVar5)) - (long)sDSTransactionID);
  memcpy(concatDetails,sDSTransactionID,sVar6);
  *(char (*) [4])(aav_data + sVar6 + 0x100) = txnNone;
  concatDetails[sVar6 + 4] = '0';
  concatDetails[sVar6 + 5] = key_id[0];
  sprintf(sLine,"concatDetails:%s",concatDetails);
  trace_event(sLine,5);
  Sha256_ALgo(concatDetails,hashValue);
  sprintf(sLine,"hashValue:%s",hashValue);
  trace_event(sLine,5);
  xorReduction(hashValue,cavvNonce);
  if (debug_option == 1) {
    sprintf(sLine,"cavvNonce value:%s",cavvNonce);
    trace_event(sLine,5);
  }
  lVar7 = strtol(cavvNonce,(char **)0x0,0x10);
  if (debug_option == 1) {
    sprintf(sLine,"decimalNonce:%ld",lVar7);
    trace_event(sLine,5);
  }
  sprintf(str_temp,"%ld",lVar7);
  uVar2 = decimalNonceStr._0_8_;
  puVar9 = (uint *)str_temp;
  do {
    puVar8 = puVar9;
    uVar4 = *puVar8 + 0xfefefeff & ~*puVar8;
    uVar5 = uVar4 & 0x80808080;
    puVar9 = puVar8 + 1;
  } while (uVar5 == 0);
  bVar13 = (uVar4 & 0x8080) == 0;
  if (bVar13) {
    uVar5 = uVar5 >> 0x10;
  }
  if (bVar13) {
    puVar9 = (uint *)((long)puVar8 + 6);
  }
  lVar7 = (-3 - (ulong)CARRY1((byte)uVar5,(byte)uVar5)) - (long)str_temp;
  pcVar10 = (char *)((long)puVar9 + lVar7);
  if (pcVar10 < (char *)0x7) {
    memcpy(decimalNonceStr,str_temp,(size_t)pcVar10);
    builtin_strncpy(decimalNonceStr + (long)puVar9 + lVar7,"0000",4);
    decimalNonceStr[(long)(pcVar10 + 6)] = '0';
    (decimalNonceStr + (long)(pcVar10 + 4))[0] = '0';
    (decimalNonceStr + (long)(pcVar10 + 4))[1] = '0';
  }
  else {
    uVar1 = *(undefined4 *)(service_code + (long)(pcVar10 + 9));
    decimalNonceStr[0] = (char)uVar1;
    decimalNonceStr[1] = (char)((uint)uVar1 >> 8);
    decimalNonceStr[2] = (char)((uint)uVar1 >> 0x10);
    decimalNonceStr[3] = (char)((uint)uVar1 >> 0x18);
    decimalNonceStr._4_2_ = *(undefined2 *)(service_code + (long)(pcVar10 + 0xd));
    decimalNonceStr[0] = (char)uVar1;
    decimalNonceStr[1] = (char)((uint)uVar1 >> 8);
    decimalNonceStr[2] = (char)((uint)uVar1 >> 0x10);
    decimalNonceStr[3] = (char)((uint)uVar1 >> 0x18);
    decimalNonceStr[7] = SUB81(uVar2,7);
    decimalNonceStr[6] = service_code[(long)(pcVar10 + 0xf)];
  }
  if (debug_option == 1) {
    sprintf(sLine,"decimalNonceStr:%s",decimalNonceStr);
    trace_event(sLine,5);
  }
  uVar2 = decimalNonceStr._0_8_;
  tsn[0] = decimalNonceStr[0];
  tsn[1] = decimalNonceStr[1];
  tsn[2] = decimalNonceStr[2];
  tsn[3] = decimalNonceStr[3];
  service_code._0_3_ = SUB83(uVar2,4);
  decimalNonceStr._0_8_ = uVar2;
  iVar3 = Get_UCAF_Key(nIndiceCtx,Pan,key_id,aav_key);
  if (iVar3 != 0) {
    builtin_strncpy(sHsmResultCode,"UNVL",4);
    return 9;
  }
  CvkA[0] = aav_key[0];
  CvkA[1] = aav_key[1];
  CvkA[2] = aav_key[2];
  CvkA[3] = aav_key[3];
  CvkA[4] = aav_key[4];
  CvkA[5] = aav_key[5];
  CvkA[6] = aav_key[6];
  CvkA[7] = aav_key[7];
  CvkA[8] = aav_key[8];
  CvkA[9] = aav_key[9];
  CvkA[10] = aav_key[10];
  CvkA[0xb] = aav_key[0xb];
  CvkA[0xc] = aav_key[0xc];
  CvkA[0xd] = aav_key[0xd];
  CvkA[0xe] = aav_key[0xe];
  CvkA[0xf] = aav_key[0xf];
  CvkB[0] = aav_key[0x10];
  CvkB[1] = aav_key[0x11];
  CvkB[2] = aav_key[0x12];
  CvkB[3] = aav_key[0x13];
  CvkB[4] = aav_key[0x14];
  CvkB[5] = aav_key[0x15];
  CvkB[6] = aav_key[0x16];
  CvkB[7] = aav_key[0x17];
  CvkB[8] = aav_key[0x18];
  CvkB[9] = aav_key[0x19];
  CvkB[10] = aav_key[0x1a];
  CvkB[0xb] = aav_key[0x1b];
  CvkB[0xc] = aav_key[0x1c];
  CvkB[0xd] = aav_key[0x1d];
  CvkB[0xe] = aav_key[0x1e];
  CvkB[0xf] = aav_key[0x1f];
  if (debug_option == 1) {
    sprintf(sLine,"AUTHENTICATION METHOD       : %.1s",auth_method);
    trace_event(sLine,5);
    sprintf(sLine,"CONTROL BYTE                : %.2s",control_byte);
    trace_event(sLine,5);
    sprintf(sLine,"TRANSACTION SEQUENCE NUMBER : %.4s",tsn);
    trace_event(sLine,5);
    sprintf(sLine,"AAV_KEY                     : %.32s",aav_key);
    trace_event(sLine,5);
    sprintf(sLine,"UCAF/AAV                    : %.3s",aav_value);
    trace_event(sLine,5);
    sprintf(sLine,"service_code                : %.3s",service_code);
    trace_event(sLine,5);
    trace_event("- UCAF / AAV Verification ---------------",5);
  }
  else {
    trace_event("- UCAF / AAV Verification ---------------",5);
  }
  command_CY((char *)BuffSnd,Pan,service_code,tsn,CvkA,CvkB,aav_value);
  iVar3 = CheckResource(nIndiceCtx,"070000",&nPid);
  if (iVar3 != 0) {
    builtin_strncpy(sHsmResultCode,"UNVL",4);
    trace_event("HSM FOR VERIFICATION NOT AVAILABLE",1);
    trace_event("End   check_aav_data(HSM_UNAVAILABLE)",5);
    return 9;
  }
  iVar3 = HsmQuery(nIndiceCtx,nPid,(char *)BuffSnd,(char *)BuffRcv);
  if (iVar3 == 0x3ef) {
    builtin_strncpy(sHsmResultCode,"UNVL",4);
    trace_event("HSM FOR VERIFICATION NOT AVAILABLE",1);
    trace_event("End   check_aav_data_2_0(HSM_UNAVAILABLE)",5);
    return 9;
  }
  if (iVar3 != 3) {
    iVar3 = command_CZ((char *)BuffRcv,sHsmResultCode);
    if (iVar3 == 0) {
      trace_event("End   check_aav_data_2_0(OK)",5);
      return 0;
    }
    if (iVar3 != 1) {
      if (iVar3 == 0x7d1) {
        trace_event("End check_aav_data_2_0(ERROR_COMMAND)",5);
        return 3;
      }
      trace_event("End   check_aav_data_2_0(CRYPTOGRAPHIC_ERROR)",5);
      return 2;
    }
    trace_event("End   check_aav_data_2_0(VERIFICATION_FAILED)",5);
    return 1;
  }
  builtin_strncpy(sHsmResultCode,"UNVL",4);
  trace_event("HSM MALFUNCTION DETECTED",1);
  trace_event("End   check_aav_data_2_0(MALFUNCTION)",5);
  return 3;
}



// WARNING: Unknown calling convention

int xorReduction_err(char *hexstring,char *output)

{
  byte *pbVar1;
  byte bVar2;
  int iVar3;
  size_t sVar4;
  long lVar5;
  uint uVar6;
  uchar *puVar7;
  uchar *puVar8;
  byte *pbVar9;
  char *__s;
  ulong uVar10;
  uchar res [4];
  byte local_64 [12];
  char result [8];
  uchar val [32];
  
  pbVar9 = res;
  sVar4 = strlen(hexstring);
  iVar3 = (int)(sVar4 >> 1);
  if (0 < iVar3) {
    uVar10 = (ulong)(iVar3 - 1);
    puVar7 = val;
    puVar8 = val + 1;
    while( true ) {
      __isoc99_sscanf(hexstring,"%2hhx",puVar7);
      if (puVar8 == val + 1 + uVar10) break;
      puVar7 = puVar8;
      puVar8 = puVar8 + 1;
      hexstring = hexstring + 2;
    }
    lVar5 = 0;
    do {
      uVar6 = (uint)lVar5 & 3;
      pbVar1 = val + lVar5;
      lVar5 = lVar5 + 1;
      res[uVar6] = res[uVar6] ^ *pbVar1;
    } while (lVar5 != uVar10 + 1);
  }
  __s = result;
  do {
    bVar2 = *pbVar9;
    pbVar9 = pbVar9 + 1;
    sprintf(__s,"%02X",(ulong)bVar2);
    __s = __s + 2;
  } while (pbVar9 != local_64);
  return 0;
}



// WARNING: Unknown calling convention

char * GetProdErrorText(char *err_code)

{
  int iVar1;
  long lVar2;
  
  iVar1 = memcmp(prod_err[0].error_code,err_code,4);
  if (iVar1 == 0) {
    lVar2 = 0;
  }
  else {
    iVar1 = memcmp(prod_err[1].error_code,err_code,4);
    if (iVar1 == 0) {
      lVar2 = 1;
    }
    else {
      iVar1 = memcmp(prod_err[2].error_code,err_code,4);
      if (iVar1 == 0) {
        lVar2 = 2;
      }
      else {
        iVar1 = memcmp(prod_err[3].error_code,err_code,4);
        if (iVar1 == 0) {
          lVar2 = 3;
        }
        else {
          iVar1 = memcmp(prod_err[4].error_code,err_code,4);
          if (iVar1 == 0) {
            lVar2 = 4;
          }
          else {
            iVar1 = memcmp(prod_err[5].error_code,err_code,4);
            if (iVar1 == 0) {
              lVar2 = 5;
            }
            else {
              iVar1 = memcmp(prod_err[6].error_code,err_code,4);
              if (iVar1 == 0) {
                lVar2 = 6;
              }
              else {
                iVar1 = memcmp(prod_err[7].error_code,err_code,4);
                if (iVar1 == 0) {
                  lVar2 = 7;
                }
                else {
                  iVar1 = memcmp(prod_err[8].error_code,err_code,4);
                  if (iVar1 == 0) {
                    lVar2 = 8;
                  }
                  else {
                    iVar1 = memcmp(prod_err[9].error_code,err_code,4);
                    if (iVar1 == 0) {
                      lVar2 = 9;
                    }
                    else {
                      iVar1 = memcmp(prod_err[10].error_code,err_code,4);
                      if (iVar1 == 0) {
                        lVar2 = 10;
                      }
                      else {
                        iVar1 = memcmp(prod_err[0xb].error_code,err_code,4);
                        if (iVar1 == 0) {
                          lVar2 = 0xb;
                        }
                        else {
                          iVar1 = memcmp(prod_err[0xc].error_code,err_code,4);
                          if (iVar1 != 0) {
                            return "Unknown Reason";
                          }
                          lVar2 = 0xc;
                        }
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    }
  }
  return prod_err[lVar2].error_text;
}



// WARNING: Unknown calling convention

int ProductionErrorStatus(int nIndiceCtx,char *sTlvBuffer,char *error_code)

{
  char *pcVar1;
  char error_text [30];
  char sLine [512];
  
  PutProdTlvBuffer("P01",sTlvBuffer,error_code,4);
  error_text[0] = '\0';
  error_text[1] = '\0';
  error_text[2] = '\0';
  error_text[3] = '\0';
  error_text[4] = '\0';
  error_text[5] = '\0';
  error_text[6] = '\0';
  error_text[7] = '\0';
  error_text[8] = '\0';
  error_text[9] = '\0';
  error_text[10] = '\0';
  error_text[0xb] = '\0';
  error_text[0xc] = '\0';
  error_text[0xd] = '\0';
  error_text[0xe] = '\0';
  error_text[0xf] = '\0';
  error_text[0x10] = '\0';
  error_text[0x11] = '\0';
  error_text[0x12] = '\0';
  error_text[0x13] = '\0';
  error_text[0x14] = '\0';
  error_text[0x15] = '\0';
  error_text[0x16] = '\0';
  error_text[0x17] = '\0';
  error_text[0x18] = '\0';
  error_text[0x19] = '\0';
  error_text[0x1a] = '\0';
  error_text[0x1b] = '\0';
  error_text[0x1c] = '\0';
  error_text[0x1d] = '\0';
  pcVar1 = GetProdErrorText(error_code);
  pcVar1 = stpcpy(error_text,pcVar1);
  PutProdTlvBuffer("P02",sTlvBuffer,error_text,(int)pcVar1 - (int)error_text);
  sprintf(sLine,"PRODUCTION <error_code>:<%.4s> <error_text>:<%s>",error_code,error_text);
  trace_event(sLine,5);
  return 0;
}



// WARNING: Unknown calling convention

int Cvv1Calculation(int nIndiceCtx,char *sTlvBuffer)

{
  int iVar1;
  char *mess;
  int nLength;
  char sCVV1 [4];
  char sServiceCode [4];
  pid_t nPid;
  char sHsmResultCode [5];
  char sExpiryDate [5];
  char sCVKA [17];
  char sCVKB [17];
  char sPan [23];
  char ligne [512];
  uchar BuffSnd [4096];
  uchar BuffRcv [4096];
  
  iVar1 = GetProdTlvBuffer("P04",sTlvBuffer,sPan,&nLength);
  if (iVar1 == 0) {
    iVar1 = GetProdTlvBuffer("P05",sTlvBuffer,sCVKA,&nLength);
    mess = "CVKA is Missing";
    if (iVar1 == 0) {
      iVar1 = GetProdTlvBuffer("P06",sTlvBuffer,sCVKB,&nLength);
      if (iVar1 == 0) {
        iVar1 = GetProdTlvBuffer("P07",sTlvBuffer,sServiceCode,&nLength);
        if (iVar1 != 0) {
          trace_event("Service Code is Missing",1);
          iVar1 = ProductionErrorStatus(nIndiceCtx,sTlvBuffer,"0004");
          return iVar1;
        }
        iVar1 = GetProdTlvBuffer("P08",sTlvBuffer,sExpiryDate,&nLength);
        if (iVar1 != 0) {
          trace_event("Expiry Date is Missing",1);
          iVar1 = ProductionErrorStatus(nIndiceCtx,sTlvBuffer,"0005");
          return iVar1;
        }
        iVar1 = CheckResource(nIndiceCtx,"070000",&nPid);
        if (iVar1 != 0) {
          trace_event("Resource HSM PROD Unavailable",1);
          iVar1 = ProductionErrorStatus(nIndiceCtx,sTlvBuffer,"0006");
          return iVar1;
        }
        command_CW((char *)BuffSnd,sCVKA,sCVKB,sPan,sExpiryDate,sServiceCode);
        iVar1 = HsmQuery(nIndiceCtx,nPid,(char *)BuffSnd,(char *)BuffRcv);
        if (iVar1 == 0) {
          iVar1 = command_CX((char *)BuffRcv,sCVV1,sHsmResultCode);
          if (iVar1 == 0) {
            if (debug_option == 1) {
              sprintf(ligne,"sCVV1  : %.3s ",sCVV1);
              trace_event(ligne,5);
            }
            PutProdTlvBuffer("P10",sTlvBuffer,sCVV1,3);
            return 0;
          }
          trace_event("HSM Processing Malfunction",1);
          iVar1 = ProductionErrorStatus(nIndiceCtx,sTlvBuffer,"0008");
          return iVar1;
        }
        trace_event("HSM Communication Malfunction",1);
        iVar1 = ProductionErrorStatus(nIndiceCtx,sTlvBuffer,"0007");
        return iVar1;
      }
      mess = "CVKB is Missing";
    }
    trace_event(mess,1);
    iVar1 = ProductionErrorStatus(nIndiceCtx,sTlvBuffer,"0003");
  }
  else {
    trace_event("Pan is Missing",1);
    iVar1 = ProductionErrorStatus(nIndiceCtx,sTlvBuffer,"0002");
  }
  return iVar1;
}



// WARNING: Unknown calling convention

int Cvv2Calculation(int nIndiceCtx,char *sTlvBuffer)

{
  int iVar1;
  char *mess;
  int nLength;
  char sCVV2 [4];
  pid_t nPid;
  char sHsmResultCode [5];
  char sExpiryDate [5];
  char sExpSwip [5];
  char sCVKA [17];
  char sCVKB [17];
  char sPan [23];
  uchar BuffSnd [4096];
  uchar BuffRcv [4096];
  
  iVar1 = GetProdTlvBuffer("P04",sTlvBuffer,sPan,&nLength);
  if (iVar1 == 0) {
    iVar1 = GetProdTlvBuffer("P05",sTlvBuffer,sCVKA,&nLength);
    mess = "CVKA is Missing";
    if (iVar1 == 0) {
      iVar1 = GetProdTlvBuffer("P06",sTlvBuffer,sCVKB,&nLength);
      if (iVar1 == 0) {
        iVar1 = GetProdTlvBuffer("P08",sTlvBuffer,sExpiryDate,&nLength);
        if (iVar1 != 0) {
          trace_event("Expiry Date is Missing",1);
          iVar1 = ProductionErrorStatus(nIndiceCtx,sTlvBuffer,"0005");
          return iVar1;
        }
        iVar1 = CheckResource(nIndiceCtx,"070000",&nPid);
        if (iVar1 != 0) {
          trace_event("Resource HSM PROD Unavailable",1);
          iVar1 = ProductionErrorStatus(nIndiceCtx,sTlvBuffer,"0006");
          return iVar1;
        }
        command_CW((char *)BuffSnd,sCVKA,sCVKB,sPan,sExpiryDate,"000");
        iVar1 = HsmQuery(nIndiceCtx,nPid,(char *)BuffSnd,(char *)BuffRcv);
        if (iVar1 != 0) {
          trace_event("HSM Communication Malfunction",1);
          iVar1 = ProductionErrorStatus(nIndiceCtx,sTlvBuffer,"0007");
          return iVar1;
        }
        iVar1 = command_CX((char *)BuffRcv,sCVV2,sHsmResultCode);
        if (iVar1 == 0) {
          PutProdTlvBuffer("P09",sTlvBuffer,sCVV2,3);
          return 0;
        }
        trace_event("HSM Processing Malfunction",1);
        iVar1 = ProductionErrorStatus(nIndiceCtx,sTlvBuffer,"0008");
        return iVar1;
      }
      mess = "CVKB is Missing";
    }
    trace_event(mess,1);
    iVar1 = ProductionErrorStatus(nIndiceCtx,sTlvBuffer,"0003");
  }
  else {
    trace_event("Pan is Missing",1);
    iVar1 = ProductionErrorStatus(nIndiceCtx,sTlvBuffer,"0002");
  }
  return iVar1;
}



// WARNING: Unknown calling convention

int PvvCalculation(int nIndiceCtx,char *sTlvBuffer)

{
  int iVar1;
  long lVar2;
  char *pcVar3;
  uchar *puVar4;
  byte bVar5;
  char sPVKIndex [2];
  int nLength;
  pid_t nPid;
  char sHsmResultCode [5];
  char sPVV [5];
  char pin_lmk [6];
  char sPan [23];
  char sPVKA [257];
  char sPVKB [257];
  uchar BuffSnd [4096];
  uchar BuffRcv [4096];
  
  bVar5 = 0;
  sPan[0x14] = '\0';
  sPan[0x15] = '\0';
  pin_lmk[4] = '\0';
  pin_lmk[5] = '\0';
  sPan[0] = '\0';
  sPan[1] = '\0';
  sPan[2] = '\0';
  sPan[3] = '\0';
  sPan[4] = '\0';
  sPan[5] = '\0';
  sPan[6] = '\0';
  sPan[7] = '\0';
  pcVar3 = sPVKA;
  for (lVar2 = 0x20; lVar2 != 0; lVar2 = lVar2 + -1) {
    pcVar3[0] = '\0';
    pcVar3[1] = '\0';
    pcVar3[2] = '\0';
    pcVar3[3] = '\0';
    pcVar3[4] = '\0';
    pcVar3[5] = '\0';
    pcVar3[6] = '\0';
    pcVar3[7] = '\0';
    pcVar3 = pcVar3 + 8;
  }
  sPan[8] = '\0';
  sPan[9] = '\0';
  sPan[10] = '\0';
  sPan[0xb] = '\0';
  sPan[0xc] = '\0';
  sPan[0xd] = '\0';
  sPan[0xe] = '\0';
  sPan[0xf] = '\0';
  sPan[0x10] = '\0';
  sPan[0x11] = '\0';
  sPan[0x12] = '\0';
  sPan[0x13] = '\0';
  sPan[0x16] = '\0';
  sHsmResultCode[0] = '\0';
  sHsmResultCode[1] = '\0';
  sHsmResultCode[2] = '\0';
  sHsmResultCode[3] = '\0';
  sHsmResultCode[4] = '\0';
  pin_lmk[0] = '\0';
  pin_lmk[1] = '\0';
  pin_lmk[2] = '\0';
  pin_lmk[3] = '\0';
  sPVV[0] = '\0';
  sPVV[1] = '\0';
  sPVV[2] = '\0';
  sPVV[3] = '\0';
  sPVV[4] = '\0';
  *pcVar3 = '\0';
  pcVar3 = sPVKB;
  for (lVar2 = 0x20; lVar2 != 0; lVar2 = lVar2 + -1) {
    pcVar3[0] = '\0';
    pcVar3[1] = '\0';
    pcVar3[2] = '\0';
    pcVar3[3] = '\0';
    pcVar3[4] = '\0';
    pcVar3[5] = '\0';
    pcVar3[6] = '\0';
    pcVar3[7] = '\0';
    pcVar3 = pcVar3 + 8;
  }
  *pcVar3 = '\0';
  puVar4 = BuffSnd;
  for (lVar2 = 0x200; lVar2 != 0; lVar2 = lVar2 + -1) {
    puVar4[0] = '\0';
    puVar4[1] = '\0';
    puVar4[2] = '\0';
    puVar4[3] = '\0';
    puVar4[4] = '\0';
    puVar4[5] = '\0';
    puVar4[6] = '\0';
    puVar4[7] = '\0';
    puVar4 = puVar4 + 8;
  }
  puVar4 = BuffRcv;
  for (lVar2 = 0x200; lVar2 != 0; lVar2 = lVar2 + -1) {
    puVar4[0] = '\0';
    puVar4[1] = '\0';
    puVar4[2] = '\0';
    puVar4[3] = '\0';
    puVar4[4] = '\0';
    puVar4[5] = '\0';
    puVar4[6] = '\0';
    puVar4[7] = '\0';
    puVar4 = puVar4 + 8;
  }
  sPVKIndex[0] = '\0';
  sPVKIndex[1] = '\0';
  iVar1 = GetProdTlvBuffer("P04",sTlvBuffer,sPan,&nLength);
  if (iVar1 != 0) {
    trace_event("Pan is Missing",1);
    iVar1 = ProductionErrorStatus(nIndiceCtx,sTlvBuffer,"0002");
    return iVar1;
  }
  iVar1 = GetProdTlvBuffer("P12",sTlvBuffer,sPVKA,&nLength);
  if (iVar1 != 0) {
    trace_event("PVKA is Missing",1);
    iVar1 = ProductionErrorStatus(nIndiceCtx,sTlvBuffer,"0009");
    return iVar1;
  }
  if ((sPVKA[0] != 'S') && (iVar1 = GetProdTlvBuffer("P13",sTlvBuffer,sPVKB,&nLength), iVar1 != 0))
  {
    trace_event("PVKB is Missing",1);
    iVar1 = ProductionErrorStatus(nIndiceCtx,sTlvBuffer,"0010");
    return iVar1;
  }
  iVar1 = GetProdTlvBuffer("P11",sTlvBuffer,sPVKIndex,&nLength);
  pcVar3 = "PVK Index is Missing";
  if (iVar1 != 0) {
LAB_0047adf0:
    trace_event(pcVar3,1);
    iVar1 = ProductionErrorStatus(nIndiceCtx,sTlvBuffer,"0011");
    return iVar1;
  }
  command_EE((char *)BuffSnd,sPVKA,"0000",sPan);
  iVar1 = CheckResource(nIndiceCtx,"070000",&nPid);
  if (iVar1 != 0) {
    trace_event("Resource HSM PROD Unavailable",1);
    iVar1 = ProductionErrorStatus(nIndiceCtx,sTlvBuffer,"0006");
    return iVar1;
  }
  iVar1 = HsmQuery(nIndiceCtx,nPid,(char *)BuffSnd,(char *)BuffRcv);
  if (iVar1 == 0) {
    iVar1 = command_EF((char *)BuffRcv,pin_lmk,sHsmResultCode);
    if (iVar1 == 0) {
      iVar1 = GetProdTlvBuffer("P14",sTlvBuffer,pin_lmk,&nLength);
      if (iVar1 != 0) {
        pcVar3 = "pin_lmk Index is Missing";
        goto LAB_0047adf0;
      }
      puVar4 = BuffSnd;
      for (lVar2 = 0x200; lVar2 != 0; lVar2 = lVar2 + -1) {
        puVar4[0] = '\0';
        puVar4[1] = '\0';
        puVar4[2] = '\0';
        puVar4[3] = '\0';
        puVar4[4] = '\0';
        puVar4[5] = '\0';
        puVar4[6] = '\0';
        puVar4[7] = '\0';
        puVar4 = puVar4 + (ulong)bVar5 * -0x10 + 8;
      }
      puVar4 = BuffRcv;
      for (lVar2 = 0x200; lVar2 != 0; lVar2 = lVar2 + -1) {
        puVar4[0] = '\0';
        puVar4[1] = '\0';
        puVar4[2] = '\0';
        puVar4[3] = '\0';
        puVar4[4] = '\0';
        puVar4[5] = '\0';
        puVar4[6] = '\0';
        puVar4[7] = '\0';
        puVar4 = puVar4 + (ulong)bVar5 * -0x10 + 8;
      }
      command_DG((char *)BuffSnd,sPVKA,sPVKB,pin_lmk,sPan,sPVKIndex);
      iVar1 = HsmQuery(nIndiceCtx,nPid,(char *)BuffSnd,(char *)BuffRcv);
      if (iVar1 != 0) goto LAB_0047ae10;
      iVar1 = command_DH((char *)BuffRcv,sPVV,sHsmResultCode);
      if (iVar1 == 0) {
        trace_event("PVV Calculation Done",5);
        PutProdTlvBuffer("P15",sTlvBuffer,sPVV,4);
        return 0;
      }
    }
    trace_event("HSM Processing Malfunction",1);
    iVar1 = ProductionErrorStatus(nIndiceCtx,sTlvBuffer,"0008");
  }
  else {
LAB_0047ae10:
    trace_event("HSM Communication Malfunction",1);
    iVar1 = ProductionErrorStatus(nIndiceCtx,sTlvBuffer,"0007");
  }
  return iVar1;
}



// WARNING: Unknown calling convention

int PinCalculation(int nIndiceCtx,char *sTlvBuffer)

{
  int iVar1;
  char sPVKIndex [2];
  int nLength;
  pid_t nPid;
  char sHsmResultCode [5];
  char pin_lmk [6];
  char sPVKA [17];
  char sPVKB [17];
  char sPan [23];
  uchar BuffSnd [4096];
  uchar BuffRcv [4096];
  
  iVar1 = GetProdTlvBuffer("P04",sTlvBuffer,sPan,&nLength);
  if (iVar1 == 0) {
    iVar1 = GetProdTlvBuffer("P12",sTlvBuffer,sPVKA,&nLength);
    if (iVar1 == 0) {
      iVar1 = GetProdTlvBuffer("P13",sTlvBuffer,sPVKB,&nLength);
      if (iVar1 == 0) {
        iVar1 = GetProdTlvBuffer("P11",sTlvBuffer,sPVKIndex,&nLength);
        if (iVar1 == 0) {
          command_EE((char *)BuffSnd,sPVKA,"0000",sPan);
          iVar1 = CheckResource(nIndiceCtx,"070000",&nPid);
          if (iVar1 == 0) {
            iVar1 = HsmQuery(nIndiceCtx,nPid,(char *)BuffSnd,(char *)BuffRcv);
            if (iVar1 == 0) {
              iVar1 = command_EF((char *)BuffRcv,pin_lmk,sHsmResultCode);
              if (iVar1 == 0) {
                PutProdTlvBuffer("P14",sTlvBuffer,pin_lmk,5);
                trace_event("PIN Calculation Done",5);
                iVar1 = 0;
              }
              else {
                trace_event("HSM Processing Malfunction",1);
                iVar1 = ProductionErrorStatus(nIndiceCtx,sTlvBuffer,"0008");
              }
            }
            else {
              trace_event("HSM Communication Malfunction",1);
              iVar1 = ProductionErrorStatus(nIndiceCtx,sTlvBuffer,"0007");
            }
          }
          else {
            trace_event("Resource HSM PROD Unavailable",1);
            iVar1 = ProductionErrorStatus(nIndiceCtx,sTlvBuffer,"0006");
          }
        }
        else {
          trace_event("PVK Index is Missing",1);
          iVar1 = ProductionErrorStatus(nIndiceCtx,sTlvBuffer,"0011");
        }
      }
      else {
        trace_event("PVKB is Missing",1);
        iVar1 = ProductionErrorStatus(nIndiceCtx,sTlvBuffer,"0010");
      }
    }
    else {
      trace_event("PVKA is Missing",1);
      iVar1 = ProductionErrorStatus(nIndiceCtx,sTlvBuffer,"0009");
    }
  }
  else {
    trace_event("Pan is Missing",1);
    iVar1 = ProductionErrorStatus(nIndiceCtx,sTlvBuffer,"0002");
  }
  return iVar1;
}



// WARNING: Unknown calling convention

int PinPrint(int nIndiceCtx,char *sTlvBuffer)

{
  int iVar1;
  uint uVar2;
  ulong uVar3;
  char *pcVar5;
  long lVar6;
  byte bVar7;
  char sPVKIndex [2];
  int nLength;
  pid_t nPid;
  char sHsmResultCode [5];
  char pin_lmk [6];
  char sPrintField5 [8];
  char sPrintField6 [8];
  char sPVKA [17];
  char sPVKB [17];
  char sPan [23];
  char sPrintField0 [25];
  char sPrintField2 [31];
  char sPrintField1 [41];
  char sPrintField4 [71];
  char sPrintField3 [91];
  uchar BuffSnd [4096];
  uchar BuffRcv [4096];
  ulong uVar4;
  
  bVar7 = 0;
  iVar1 = GetProdTlvBuffer("P04",sTlvBuffer,sPan,&nLength);
  if (iVar1 != 0) {
    trace_event("Pan is Missing",1);
    iVar1 = ProductionErrorStatus(nIndiceCtx,sTlvBuffer,"0002");
    return iVar1;
  }
  iVar1 = GetProdTlvBuffer("P12",sTlvBuffer,sPVKA,&nLength);
  if (iVar1 != 0) {
    trace_event("PVKA is Missing",1);
    iVar1 = ProductionErrorStatus(nIndiceCtx,sTlvBuffer,"0009");
    return iVar1;
  }
  iVar1 = GetProdTlvBuffer("P13",sTlvBuffer,sPVKB,&nLength);
  if (iVar1 != 0) {
    trace_event("PVKB is Missing",1);
    iVar1 = ProductionErrorStatus(nIndiceCtx,sTlvBuffer,"0010");
    return iVar1;
  }
  iVar1 = GetProdTlvBuffer("P11",sTlvBuffer,sPVKIndex,&nLength);
  if (iVar1 != 0) {
    trace_event("PVK Index is Missing",1);
    iVar1 = ProductionErrorStatus(nIndiceCtx,sTlvBuffer,"0011");
    return iVar1;
  }
  command_EE((char *)BuffSnd,sPVKA,"0000",sPan);
  iVar1 = CheckResource(nIndiceCtx,"070000",&nPid);
  if (iVar1 != 0) {
    trace_event("Resource HSM PROD Unavailable",1);
    iVar1 = ProductionErrorStatus(nIndiceCtx,sTlvBuffer,"0006");
    return iVar1;
  }
  iVar1 = HsmQuery(nIndiceCtx,nPid,(char *)BuffSnd,(char *)BuffRcv);
  if (iVar1 == 0) {
    iVar1 = command_EF((char *)BuffRcv,pin_lmk,sHsmResultCode);
    if (iVar1 == 0) {
      PutProdTlvBuffer("P14",sTlvBuffer,pin_lmk,5);
      iVar1 = GetProdTlvBuffer("P16",sTlvBuffer,sPrintField0,&nLength);
      if (iVar1 != 0) {
        sPrintField0[0] = '\0';
        sPrintField0[1] = '\0';
        sPrintField0[2] = '\0';
        sPrintField0[3] = '\0';
        sPrintField0[4] = '\0';
        sPrintField0[5] = '\0';
        sPrintField0[6] = '\0';
        sPrintField0[7] = '\0';
        sPrintField0[8] = '\0';
        sPrintField0[9] = '\0';
        sPrintField0[10] = '\0';
        sPrintField0[0xb] = '\0';
        sPrintField0[0xc] = '\0';
        sPrintField0[0xd] = '\0';
        sPrintField0[0xe] = '\0';
        sPrintField0[0xf] = '\0';
        sPrintField0[0x10] = '\0';
        sPrintField0[0x11] = '\0';
        sPrintField0[0x12] = '\0';
        sPrintField0[0x13] = '\0';
        sPrintField0[0x14] = '\0';
        sPrintField0[0x15] = '\0';
        sPrintField0[0x16] = '\0';
        sPrintField0[0x17] = '\0';
        sPrintField0[0x18] = '\0';
      }
      iVar1 = GetProdTlvBuffer("P17",sTlvBuffer,sPrintField1,&nLength);
      if (iVar1 != 0) {
        pcVar5 = sPrintField1;
        for (lVar6 = 5; lVar6 != 0; lVar6 = lVar6 + -1) {
          pcVar5[0] = '\0';
          pcVar5[1] = '\0';
          pcVar5[2] = '\0';
          pcVar5[3] = '\0';
          pcVar5[4] = '\0';
          pcVar5[5] = '\0';
          pcVar5[6] = '\0';
          pcVar5[7] = '\0';
          pcVar5 = pcVar5 + (ulong)bVar7 * -0x10 + 8;
        }
        *pcVar5 = '\0';
      }
      iVar1 = GetProdTlvBuffer("P18",sTlvBuffer,sPrintField2,&nLength);
      if (iVar1 != 0) {
        uVar3 = 0;
        do {
          uVar2 = (int)uVar3 + 8;
          uVar4 = (ulong)uVar2;
          pcVar5 = sPrintField2 + uVar3;
          pcVar5[0] = '\0';
          pcVar5[1] = '\0';
          pcVar5[2] = '\0';
          pcVar5[3] = '\0';
          pcVar5[4] = '\0';
          pcVar5[5] = '\0';
          pcVar5[6] = '\0';
          pcVar5[7] = '\0';
          uVar3 = uVar4;
        } while (uVar2 < 0x18);
        pcVar5 = sPrintField2 + uVar4;
        pcVar5[0] = '\0';
        pcVar5[1] = '\0';
        pcVar5[2] = '\0';
        pcVar5[3] = '\0';
        (sPrintField2 + uVar4 + 4)[0] = '\0';
        (sPrintField2 + uVar4 + 4)[1] = '\0';
        sPrintField2[uVar4 + 6] = '\0';
      }
      iVar1 = GetProdTlvBuffer("P19",sTlvBuffer,sPrintField3,&nLength);
      if (iVar1 != 0) {
        pcVar5 = sPrintField3;
        for (lVar6 = 0xb; lVar6 != 0; lVar6 = lVar6 + -1) {
          pcVar5[0] = '\0';
          pcVar5[1] = '\0';
          pcVar5[2] = '\0';
          pcVar5[3] = '\0';
          pcVar5[4] = '\0';
          pcVar5[5] = '\0';
          pcVar5[6] = '\0';
          pcVar5[7] = '\0';
          pcVar5 = pcVar5 + (ulong)bVar7 * -0x10 + 8;
        }
        pcVar5[0] = '\0';
        pcVar5[1] = '\0';
        pcVar5[2] = '\0';
      }
      iVar1 = GetProdTlvBuffer("P20",sTlvBuffer,sPrintField4,&nLength);
      if (iVar1 != 0) {
        pcVar5 = sPrintField4;
        for (lVar6 = 8; lVar6 != 0; lVar6 = lVar6 + -1) {
          pcVar5[0] = '\0';
          pcVar5[1] = '\0';
          pcVar5[2] = '\0';
          pcVar5[3] = '\0';
          pcVar5[4] = '\0';
          pcVar5[5] = '\0';
          pcVar5[6] = '\0';
          pcVar5[7] = '\0';
          pcVar5 = pcVar5 + (ulong)bVar7 * -0x10 + 8;
        }
        pcVar5[0] = '\0';
        pcVar5[1] = '\0';
        pcVar5[2] = '\0';
        pcVar5[3] = '\0';
        pcVar5[4] = '\0';
        pcVar5[5] = '\0';
        pcVar5[6] = '\0';
      }
      iVar1 = GetProdTlvBuffer("P21",sTlvBuffer,sPrintField5,&nLength);
      if (iVar1 != 0) {
        sPrintField5[0] = '\0';
        sPrintField5[1] = '\0';
        sPrintField5[2] = '\0';
        sPrintField5[3] = '\0';
        sPrintField5[4] = '\0';
        sPrintField5[5] = '\0';
        sPrintField5[6] = '\0';
        sPrintField5[7] = '\0';
      }
      iVar1 = GetProdTlvBuffer("P22",sTlvBuffer,sPrintField6,&nLength);
      if (iVar1 != 0) {
        sPrintField6[0] = '\0';
        sPrintField6[1] = '\0';
        sPrintField6[2] = '\0';
        sPrintField6[3] = '\0';
        sPrintField6[4] = '\0';
        sPrintField6[5] = '\0';
        sPrintField6[6] = '\0';
        sPrintField6[7] = '\0';
      }
      command_PE((char *)BuffSnd,sPan,pin_lmk,sPrintField0,sPrintField1,sPrintField2,sPrintField3,
                 sPrintField4,sPrintField5,sPrintField6);
      iVar1 = HsmQuery(nIndiceCtx,nPid,(char *)BuffSnd,(char *)BuffRcv);
      if (iVar1 != 0) goto LAB_0047b5a0;
      iVar1 = command_PZ((char *)BuffRcv,sHsmResultCode);
      if (iVar1 == 0) {
        sleep(3);
        return 0;
      }
    }
    trace_event("HSM Processing Malfunction",1);
    iVar1 = ProductionErrorStatus(nIndiceCtx,sTlvBuffer,"0008");
  }
  else {
LAB_0047b5a0:
    trace_event("HSM Communication Malfunction",1);
    iVar1 = ProductionErrorStatus(nIndiceCtx,sTlvBuffer,"0007");
  }
  return iVar1;
}



// WARNING: Unknown calling convention

int ProdPinPvv(int nIndiceCtx,char *sTlvBuffer)

{
  int iVar1;
  long lVar2;
  uchar *puVar3;
  char sPVKIndex [2];
  int nLength;
  pid_t nPid;
  char sHsmResultCode [5];
  char sPVV [5];
  char sPVKA [17];
  char sPVKB [17];
  char pin_lmk [17];
  char sPan [23];
  uchar BuffSnd [4096];
  uchar BuffRcv [4096];
  
  sPan[0x14] = '\0';
  sPan[0x15] = '\0';
  sPVKIndex[0] = '\0';
  sPVKIndex[1] = '\0';
  sPan[0] = '\0';
  sPan[1] = '\0';
  sPan[2] = '\0';
  sPan[3] = '\0';
  sPan[4] = '\0';
  sPan[5] = '\0';
  sPan[6] = '\0';
  sPan[7] = '\0';
  sPan[8] = '\0';
  sPan[9] = '\0';
  sPan[10] = '\0';
  sPan[0xb] = '\0';
  sPan[0xc] = '\0';
  sPan[0xd] = '\0';
  sPan[0xe] = '\0';
  sPan[0xf] = '\0';
  sPan[0x10] = '\0';
  sPan[0x11] = '\0';
  sPan[0x12] = '\0';
  sPan[0x13] = '\0';
  sPan[0x16] = '\0';
  sPVKA[0] = '\0';
  sPVKA[1] = '\0';
  sPVKA[2] = '\0';
  sPVKA[3] = '\0';
  sPVKA[4] = '\0';
  sPVKA[5] = '\0';
  sPVKA[6] = '\0';
  sPVKA[7] = '\0';
  puVar3 = BuffSnd;
  for (lVar2 = 0x200; lVar2 != 0; lVar2 = lVar2 + -1) {
    puVar3[0] = '\0';
    puVar3[1] = '\0';
    puVar3[2] = '\0';
    puVar3[3] = '\0';
    puVar3[4] = '\0';
    puVar3[5] = '\0';
    puVar3[6] = '\0';
    puVar3[7] = '\0';
    puVar3 = puVar3 + 8;
  }
  sPVKA[8] = '\0';
  sPVKA[9] = '\0';
  sPVKA[10] = '\0';
  sPVKA[0xb] = '\0';
  sPVKA[0xc] = '\0';
  sPVKA[0xd] = '\0';
  sPVKA[0xe] = '\0';
  sPVKA[0xf] = '\0';
  sPVKA[0x10] = '\0';
  sPVKB[0] = '\0';
  sPVKB[1] = '\0';
  sPVKB[2] = '\0';
  sPVKB[3] = '\0';
  sPVKB[4] = '\0';
  sPVKB[5] = '\0';
  sPVKB[6] = '\0';
  sPVKB[7] = '\0';
  sPVKB[8] = '\0';
  sPVKB[9] = '\0';
  sPVKB[10] = '\0';
  sPVKB[0xb] = '\0';
  sPVKB[0xc] = '\0';
  sPVKB[0xd] = '\0';
  sPVKB[0xe] = '\0';
  sPVKB[0xf] = '\0';
  sPVKB[0x10] = '\0';
  sHsmResultCode[0] = '\0';
  sHsmResultCode[1] = '\0';
  sHsmResultCode[2] = '\0';
  sHsmResultCode[3] = '\0';
  sHsmResultCode[4] = '\0';
  pin_lmk[0] = '\0';
  pin_lmk[1] = '\0';
  pin_lmk[2] = '\0';
  pin_lmk[3] = '\0';
  pin_lmk[4] = '\0';
  pin_lmk[5] = '\0';
  pin_lmk[6] = '\0';
  pin_lmk[7] = '\0';
  pin_lmk[8] = '\0';
  pin_lmk[9] = '\0';
  pin_lmk[10] = '\0';
  pin_lmk[0xb] = '\0';
  pin_lmk[0xc] = '\0';
  pin_lmk[0xd] = '\0';
  pin_lmk[0xe] = '\0';
  pin_lmk[0xf] = '\0';
  pin_lmk[0x10] = '\0';
  sPVV[0] = '\0';
  sPVV[1] = '\0';
  sPVV[2] = '\0';
  sPVV[3] = '\0';
  puVar3 = BuffRcv;
  for (lVar2 = 0x200; lVar2 != 0; lVar2 = lVar2 + -1) {
    puVar3[0] = '\0';
    puVar3[1] = '\0';
    puVar3[2] = '\0';
    puVar3[3] = '\0';
    puVar3[4] = '\0';
    puVar3[5] = '\0';
    puVar3[6] = '\0';
    puVar3[7] = '\0';
    puVar3 = puVar3 + 8;
  }
  sPVV[4] = '\0';
  trace_event(" Start  ProdPinPvv()",5);
  iVar1 = GetProdTlvBuffer("P04",sTlvBuffer,sPan,&nLength);
  if (iVar1 == 0) {
    iVar1 = GetProdTlvBuffer("P12",sTlvBuffer,sPVKA,&nLength);
    if (iVar1 == 0) {
      iVar1 = GetProdTlvBuffer("P13",sTlvBuffer,sPVKB,&nLength);
      if (iVar1 == 0) {
        iVar1 = GetProdTlvBuffer("P11",sTlvBuffer,sPVKIndex,&nLength);
        if (iVar1 == 0) {
          iVar1 = GetProdTlvBuffer("P14",sTlvBuffer,pin_lmk,&nLength);
          if (iVar1 == 0) {
            command_DG((char *)BuffSnd,sPVKA,sPVKB,pin_lmk,sPan,sPVKIndex);
            iVar1 = CheckResource(nIndiceCtx,"070000",&nPid);
            if (iVar1 == 0) {
              iVar1 = HsmQuery(nIndiceCtx,nPid,(char *)BuffSnd,(char *)BuffRcv);
              if (iVar1 == 0) {
                iVar1 = command_DH((char *)BuffRcv,sPVV,sHsmResultCode);
                if (iVar1 == 0) {
                  PutProdTlvBuffer("P15",sTlvBuffer,sPVV,4);
                  trace_event(" End  ProdPinPvv()",5);
                  iVar1 = 0;
                }
                else {
                  trace_event("HSM Processing Malfunction",1);
                  iVar1 = ProductionErrorStatus(nIndiceCtx,sTlvBuffer,"0008");
                }
              }
              else {
                trace_event("HSM Communication Malfunction",1);
                iVar1 = ProductionErrorStatus(nIndiceCtx,sTlvBuffer,"0007");
              }
            }
            else {
              trace_event("Resource HSM PROD Unavailable",1);
              iVar1 = ProductionErrorStatus(nIndiceCtx,sTlvBuffer,"0006");
            }
          }
          else {
            trace_event("Pin Block is Missing",1);
            iVar1 = ProductionErrorStatus(nIndiceCtx,sTlvBuffer,"0012");
          }
        }
        else {
          trace_event("PVK Index is Missing",1);
          iVar1 = ProductionErrorStatus(nIndiceCtx,sTlvBuffer,"0011");
        }
      }
      else {
        trace_event("PVKB is Missing",1);
        iVar1 = ProductionErrorStatus(nIndiceCtx,sTlvBuffer,"0010");
      }
    }
    else {
      trace_event("PVKA is Missing",1);
      iVar1 = ProductionErrorStatus(nIndiceCtx,sTlvBuffer,"0009");
    }
  }
  else {
    trace_event("Pan is Missing",1);
    iVar1 = ProductionErrorStatus(nIndiceCtx,sTlvBuffer,"0002");
  }
  return iVar1;
}



// WARNING: Unknown calling convention

int ProdPinOffset(int nIndiceCtx,char *sTlvBuffer)

{
  int iVar1;
  uint uVar2;
  uint uVar3;
  long lVar4;
  uint *puVar5;
  uint *puVar6;
  uchar *puVar7;
  char *pcVar8;
  bool bVar9;
  byte bVar10;
  char sPVKIndex [2];
  char sPinLength [3];
  pid_t nPid;
  int nLength;
  char sHsmResultCode [5];
  char sPinOffset [13];
  char pin_lmk [17];
  char sPan [23];
  char sPVKA [257];
  char detail [512];
  uchar BuffSnd [4096];
  uchar BuffRcv [4096];
  
  bVar10 = 0;
  trace_event("Start ProdPinOffset()",5);
  puVar7 = BuffSnd;
  for (lVar4 = 0x200; lVar4 != 0; lVar4 = lVar4 + -1) {
    puVar7[0] = '\0';
    puVar7[1] = '\0';
    puVar7[2] = '\0';
    puVar7[3] = '\0';
    puVar7[4] = '\0';
    puVar7[5] = '\0';
    puVar7[6] = '\0';
    puVar7[7] = '\0';
    puVar7 = puVar7 + (ulong)bVar10 * -0x10 + 8;
  }
  pin_lmk[0] = '\0';
  pin_lmk[1] = '\0';
  pin_lmk[2] = '\0';
  pin_lmk[3] = '\0';
  pin_lmk[4] = '\0';
  pin_lmk[5] = '\0';
  pin_lmk[6] = '\0';
  pin_lmk[7] = '\0';
  pin_lmk[8] = '\0';
  pin_lmk[9] = '\0';
  pin_lmk[10] = '\0';
  pin_lmk[0xb] = '\0';
  pin_lmk[0xc] = '\0';
  pin_lmk[0xd] = '\0';
  pin_lmk[0xe] = '\0';
  pin_lmk[0xf] = '\0';
  sPan[0x14] = '\0';
  sPan[0x15] = '\0';
  pin_lmk[0x10] = '\0';
  sPinOffset[0] = '\0';
  sPinOffset[1] = '\0';
  sPinOffset[2] = '\0';
  sPinOffset[3] = '\0';
  sPinOffset[4] = '\0';
  sPinOffset[5] = '\0';
  sPinOffset[6] = '\0';
  sPinOffset[7] = '\0';
  puVar7 = BuffRcv;
  for (lVar4 = 0x200; lVar4 != 0; lVar4 = lVar4 + -1) {
    puVar7[0] = '\0';
    puVar7[1] = '\0';
    puVar7[2] = '\0';
    puVar7[3] = '\0';
    puVar7[4] = '\0';
    puVar7[5] = '\0';
    puVar7[6] = '\0';
    puVar7[7] = '\0';
    puVar7 = puVar7 + (ulong)bVar10 * -0x10 + 8;
  }
  sPinOffset[8] = '\0';
  sPinOffset[9] = '\0';
  sPinOffset[10] = '\0';
  sPinOffset[0xb] = '\0';
  sPinOffset[0xc] = '\0';
  sPan[0] = '\0';
  sPan[1] = '\0';
  sPan[2] = '\0';
  sPan[3] = '\0';
  sPan[4] = '\0';
  sPan[5] = '\0';
  sPan[6] = '\0';
  sPan[7] = '\0';
  sPan[8] = '\0';
  sPan[9] = '\0';
  sPan[10] = '\0';
  sPan[0xb] = '\0';
  sPan[0xc] = '\0';
  sPan[0xd] = '\0';
  sPan[0xe] = '\0';
  sPan[0xf] = '\0';
  sPan[0x10] = '\0';
  sPan[0x11] = '\0';
  sPan[0x12] = '\0';
  sPan[0x13] = '\0';
  sPan[0x16] = '\0';
  sHsmResultCode[0] = '\0';
  sHsmResultCode[1] = '\0';
  sHsmResultCode[2] = '\0';
  sHsmResultCode[3] = '\0';
  sHsmResultCode[4] = '\0';
  sPinLength[2] = '\0';
  pcVar8 = sPVKA;
  for (lVar4 = 0x20; lVar4 != 0; lVar4 = lVar4 + -1) {
    pcVar8[0] = '\0';
    pcVar8[1] = '\0';
    pcVar8[2] = '\0';
    pcVar8[3] = '\0';
    pcVar8[4] = '\0';
    pcVar8[5] = '\0';
    pcVar8[6] = '\0';
    pcVar8[7] = '\0';
    pcVar8 = pcVar8 + (ulong)bVar10 * -0x10 + 8;
  }
  *pcVar8 = '\0';
  sPinLength[0] = '\0';
  sPinLength[1] = '\0';
  pcVar8 = detail;
  for (lVar4 = 0x40; lVar4 != 0; lVar4 = lVar4 + -1) {
    pcVar8[0] = '\0';
    pcVar8[1] = '\0';
    pcVar8[2] = '\0';
    pcVar8[3] = '\0';
    pcVar8[4] = '\0';
    pcVar8[5] = '\0';
    pcVar8[6] = '\0';
    pcVar8[7] = '\0';
    pcVar8 = pcVar8 + (ulong)bVar10 * -0x10 + 8;
  }
  iVar1 = GetProdTlvBuffer("P04",sTlvBuffer,sPan,&nLength);
  if (iVar1 == 0) {
    iVar1 = GetProdTlvBuffer("P12",sTlvBuffer,sPVKA,&nLength);
    if (iVar1 == 0) {
      iVar1 = GetProdTlvBuffer("P14",sTlvBuffer,pin_lmk,&nLength);
      if (iVar1 == 0) {
        iVar1 = GetProdTlvBuffer("P24",sTlvBuffer,sPinLength,&nLength);
        if (iVar1 == 0) {
          command_DE((char *)BuffSnd,sPVKA,pin_lmk,sPan);
          iVar1 = CheckResource(nIndiceCtx,"070000",&nPid);
          if (iVar1 == 0) {
            iVar1 = HsmQuery(nIndiceCtx,nPid,(char *)BuffSnd,(char *)BuffRcv);
            if (iVar1 == 0) {
              iVar1 = command_DF((char *)BuffRcv,sPinOffset,sHsmResultCode);
              puVar6 = (uint *)sPinOffset;
              if (iVar1 == 0) {
                do {
                  puVar5 = puVar6;
                  uVar2 = *puVar5 + 0xfefefeff & ~*puVar5;
                  uVar3 = uVar2 & 0x80808080;
                  puVar6 = puVar5 + 1;
                } while (uVar3 == 0);
                bVar9 = (uVar2 & 0x8080) == 0;
                if (bVar9) {
                  uVar3 = uVar3 >> 0x10;
                }
                if (bVar9) {
                  puVar6 = (uint *)((long)puVar5 + 6);
                }
                PutProdTlvBuffer("P23",sTlvBuffer,sPinOffset,
                                 (((int)puVar6 + -3) - (uint)CARRY1((byte)uVar3,(byte)uVar3)) -
                                 (int)sPinOffset);
                trace_event("End   ProdPinOffset()",5);
                iVar1 = 0;
              }
              else {
                trace_event("HSM Processing Malfunction",1);
                iVar1 = ProductionErrorStatus(nIndiceCtx,sTlvBuffer,"0008");
              }
            }
            else {
              trace_event("HSM Communication Malfunction",1);
              iVar1 = ProductionErrorStatus(nIndiceCtx,sTlvBuffer,"0007");
            }
          }
          else {
            trace_event("Resource HSM PROD Unavailable",1);
            iVar1 = ProductionErrorStatus(nIndiceCtx,sTlvBuffer,"0006");
          }
        }
        else {
          trace_event("Pin Length Missing",1);
          iVar1 = ProductionErrorStatus(nIndiceCtx,sTlvBuffer,"0013");
        }
      }
      else {
        trace_event("Pin Block is Missing",1);
        iVar1 = ProductionErrorStatus(nIndiceCtx,sTlvBuffer,"0012");
      }
    }
    else {
      trace_event("PVKA is Missing",1);
      iVar1 = ProductionErrorStatus(nIndiceCtx,sTlvBuffer,"0009");
    }
  }
  else {
    trace_event("Pan is Missing",1);
    iVar1 = ProductionErrorStatus(nIndiceCtx,sTlvBuffer,"0002");
  }
  return iVar1;
}



// WARNING: Unknown calling convention

int ProdPinOffsetOfcustomerPIN
              (int nIndiceCtx,char *sTpk_Zpk,char *sPVK,char *sPinBlk,char *sPinBlkFmt,char *sPan,
              char *sPinOffset)

{
  int iVar1;
  long lVar2;
  uchar *puVar3;
  byte bVar4;
  pid_t nPid;
  char sHsmResultCode [5];
  char sDecTable [32];
  uchar BuffSnd [1516];
  uchar BuffRcv [1516];
  
  bVar4 = 0;
  trace_event("Start ProdPinOffsetOfcustomerPIN()",5);
  puVar3 = BuffSnd;
  for (lVar2 = 0xbd; lVar2 != 0; lVar2 = lVar2 + -1) {
    puVar3[0] = '\0';
    puVar3[1] = '\0';
    puVar3[2] = '\0';
    puVar3[3] = '\0';
    puVar3[4] = '\0';
    puVar3[5] = '\0';
    puVar3[6] = '\0';
    puVar3[7] = '\0';
    puVar3 = puVar3 + (ulong)bVar4 * -0x10 + 8;
  }
  sDecTable[0] = '\0';
  sDecTable[1] = '\0';
  sDecTable[2] = '\0';
  sDecTable[3] = '\0';
  sDecTable[4] = '\0';
  sDecTable[5] = '\0';
  sDecTable[6] = '\0';
  sDecTable[7] = '\0';
  sDecTable[8] = '\0';
  sDecTable[9] = '\0';
  sDecTable[10] = '\0';
  sDecTable[0xb] = '\0';
  sDecTable[0xc] = '\0';
  sDecTable[0xd] = '\0';
  sDecTable[0xe] = '\0';
  sDecTable[0xf] = '\0';
  sDecTable[0x10] = '\0';
  sDecTable[0x11] = '\0';
  sDecTable[0x12] = '\0';
  sDecTable[0x13] = '\0';
  sDecTable[0x14] = '\0';
  sDecTable[0x15] = '\0';
  sDecTable[0x16] = '\0';
  sDecTable[0x17] = '\0';
  sDecTable[0x18] = '\0';
  sDecTable[0x19] = '\0';
  sDecTable[0x1a] = '\0';
  sDecTable[0x1b] = '\0';
  sDecTable[0x1c] = '\0';
  sDecTable[0x1d] = '\0';
  sDecTable[0x1e] = '\0';
  sDecTable[0x1f] = '\0';
  puVar3[0] = '\0';
  puVar3[1] = '\0';
  puVar3[2] = '\0';
  puVar3[3] = '\0';
  puVar3 = BuffRcv;
  for (lVar2 = 0xbd; lVar2 != 0; lVar2 = lVar2 + -1) {
    puVar3[0] = '\0';
    puVar3[1] = '\0';
    puVar3[2] = '\0';
    puVar3[3] = '\0';
    puVar3[4] = '\0';
    puVar3[5] = '\0';
    puVar3[6] = '\0';
    puVar3[7] = '\0';
    puVar3 = puVar3 + (ulong)bVar4 * -0x10 + 8;
  }
  puVar3[0] = '\0';
  puVar3[1] = '\0';
  puVar3[2] = '\0';
  puVar3[3] = '\0';
  iVar1 = GetGlobalsVar(0,"DECIMALISATION_TABLE",sDecTable);
  if (iVar1 != 0) {
    builtin_strncpy(sDecTable,"0123456789012345",0x10);
  }
  command_BK((char *)BuffSnd,sPVK,sTpk_Zpk,sPinBlk,sPinBlkFmt,sPan,sDecTable);
  iVar1 = CheckResource(nIndiceCtx,"070000",&nPid);
  if (iVar1 == 0) {
    iVar1 = HsmQuery(nIndiceCtx,nPid,(char *)BuffSnd,(char *)BuffRcv);
    if (iVar1 == 0) {
      iVar1 = command_BL((char *)BuffRcv,sPinOffset,sHsmResultCode);
      if (iVar1 == 0) {
        trace_event("End   ProdPinOffsetOfcustomerPIN()",5);
        iVar1 = 0;
      }
      else {
        iVar1 = -1;
        trace_event("HSM Processing Malfunction",1);
      }
    }
    else {
      iVar1 = -1;
      trace_event("HSM Communication Malfunction",1);
    }
  }
  else {
    iVar1 = -1;
    trace_event("Resource HSM PROD Unavailable",1);
  }
  return iVar1;
}



// WARNING: Unknown calling convention

int generate_ABA_PVV(int nIndexCtx,char *pTpk_Zpk,char *pPvk,char *pPinBlk,char *pPinBlkFmt,
                    char *pCardNbr,char *pPvkI,char *pPvv)

{
  int iVar1;
  long lVar2;
  uchar *puVar3;
  byte bVar4;
  uchar lErrCode [3];
  pid_t nPid;
  char sLine [512];
  uchar lHsmBuffIn [4096];
  uchar lHsmBuffOut [4096];
  
  bVar4 = 0;
  if (debug_option == 1) {
    sprintf(sLine,"Start generate_ABA_PVV(%.16s,%.16s,%.2s,%.22s)",pTpk_Zpk);
    trace_event(sLine,5);
  }
  else {
    trace_event("Start generate_ABA_PVV()",5);
  }
  lErrCode[2] = '\0';
  puVar3 = lHsmBuffIn;
  for (lVar2 = 0x200; lVar2 != 0; lVar2 = lVar2 + -1) {
    puVar3[0] = '\0';
    puVar3[1] = '\0';
    puVar3[2] = '\0';
    puVar3[3] = '\0';
    puVar3[4] = '\0';
    puVar3[5] = '\0';
    puVar3[6] = '\0';
    puVar3[7] = '\0';
    puVar3 = puVar3 + (ulong)bVar4 * -0x10 + 8;
  }
  puVar3 = lHsmBuffOut;
  for (lVar2 = 0x200; lVar2 != 0; lVar2 = lVar2 + -1) {
    puVar3[0] = '\0';
    puVar3[1] = '\0';
    puVar3[2] = '\0';
    puVar3[3] = '\0';
    puVar3[4] = '\0';
    puVar3[5] = '\0';
    puVar3[6] = '\0';
    puVar3[7] = '\0';
    puVar3 = puVar3 + (ulong)bVar4 * -0x10 + 8;
  }
  lErrCode[0] = '\0';
  lErrCode[1] = '\0';
  command_FW((char *)lHsmBuffIn,pTpk_Zpk,pPvk,pPinBlk,pPinBlkFmt,pCardNbr,pPvkI);
  iVar1 = CheckResource(nIndexCtx,"070000",&nPid);
  if ((iVar1 != 0) ||
     (iVar1 = HsmQuery(nIndexCtx,nPid,(char *)lHsmBuffIn,(char *)lHsmBuffOut), iVar1 == 0x3ef)) {
    trace_event("HSM FOR VERIFICATION NOT AVAILABLE",1);
    trace_event("End   generate_ABA_PVV(HSM_UNAVAILABLE)",5);
    return 9;
  }
  if (iVar1 == 3) {
    trace_event("HSM MALFUNCTION DETECTED",1);
    trace_event("End   generate_ABA_PVV(SYSTEM_MALFUNCTION)",5);
    return 3;
  }
  command_FX((char *)lHsmBuffOut,pPvv,(char *)lErrCode);
  iVar1 = memcmp(lErrCode,"01",2);
  if (iVar1 != 0) {
    iVar1 = memcmp(lErrCode,"00",2);
    if (iVar1 != 0) {
      trace_event("End   generate_ABA_PVV(SYSTEM_MALFUNCTION)",5);
      return 0x38d;
    }
    if (debug_option != 1) {
      trace_event("End   generate_ABA_PVV(OK)",5);
      return 0;
    }
    sprintf(sLine,"End   generate_ABA_PVV(%.16s)",pPvv);
    trace_event(sLine,5);
    return 0;
  }
  trace_event("End   generate_ABA_PVV(NOK)",5);
  return -1;
}



// WARNING: Type propagation algorithm not settling
// WARNING: Unknown calling convention

int Production(int nIndiceCtx,char *sTlvBuffer)

{
  char cVar1;
  char cVar2;
  char cVar3;
  int iVar4;
  char cVar5;
  uint uVar6;
  char *pPinBlk;
  uint uVar7;
  char *pPvk;
  char *extraout_RDX;
  char *extraout_RDX_00;
  char *extraout_RDX_01;
  char *pPinBlkFmt;
  char *in_R9;
  undefined4 in_stack_ffffffffffffff98;
  uint in_stack_ffffffffffffff9c;
  uint in_stack_ffffffffffffffa0;
  uint in_stack_ffffffffffffffa4;
  int nLength;
  char sProdFlagsBuffer [10];
  
  trace_event("Production() Start ",5);
  sProdFlagsBuffer[8] = '\0';
  sProdFlagsBuffer[9] = '\0';
  sProdFlagsBuffer[0] = '\0';
  sProdFlagsBuffer[1] = '\0';
  sProdFlagsBuffer[2] = '\0';
  sProdFlagsBuffer[3] = '\0';
  sProdFlagsBuffer[4] = '\0';
  sProdFlagsBuffer[5] = '\0';
  sProdFlagsBuffer[6] = '\0';
  sProdFlagsBuffer[7] = '\0';
  PrintProdTlvBuffer(sTlvBuffer);
  iVar4 = GetProdTlvBuffer("P03",sTlvBuffer,sProdFlagsBuffer,&nLength);
  if (iVar4 != 0) {
    trace_event("Production Flags Buffer is Missing",1);
    iVar4 = ProductionErrorStatus(nIndiceCtx,sTlvBuffer,"0001");
    return iVar4;
  }
  pPinBlkFmt = (char *)(ulong)(byte)sProdFlagsBuffer[1];
  pPinBlk = (char *)(ulong)(byte)sProdFlagsBuffer[2];
  uVar6 = (uint)(byte)sProdFlagsBuffer[2];
  pPvk = (char *)(ulong)(byte)sProdFlagsBuffer[3];
  uVar7 = (uint)(byte)sProdFlagsBuffer[3];
  cVar1 = sProdFlagsBuffer[4];
  cVar2 = sProdFlagsBuffer[5];
  cVar3 = sProdFlagsBuffer[6];
  cVar5 = sProdFlagsBuffer[1];
  if (sProdFlagsBuffer[0] == 'Y') {
    uVar7 = (uint)(byte)sProdFlagsBuffer[3];
    uVar6 = (uint)(byte)sProdFlagsBuffer[2];
    in_stack_ffffffffffffff9c = (uint)(byte)sProdFlagsBuffer[1];
    Cvv1Calculation(nIndiceCtx,sTlvBuffer);
    pPinBlkFmt = (char *)(ulong)in_stack_ffffffffffffff9c;
    pPvk = (char *)(ulong)uVar7;
    pPinBlk = (char *)(ulong)uVar6;
    in_stack_ffffffffffffffa0 = uVar6;
    in_stack_ffffffffffffffa4 = uVar7;
    cVar5 = (char)in_stack_ffffffffffffff9c;
  }
  if (cVar5 == 'Y') {
    Cvv2Calculation(nIndiceCtx,sTlvBuffer);
    pPinBlk = (char *)(ulong)uVar6;
    pPvk = (char *)(ulong)uVar7;
    cVar5 = (char)uVar6;
    in_stack_ffffffffffffff9c = uVar6;
    in_stack_ffffffffffffffa0 = uVar7;
  }
  else {
    cVar5 = (char)pPinBlk;
  }
  if (cVar5 == 'Y') {
    in_stack_ffffffffffffff9c = (uint)pPvk;
    generate_ABA_PVV(nIndiceCtx,sTlvBuffer,pPvk,pPinBlk,pPinBlkFmt,in_R9,
                     (char *)CONCAT44(in_stack_ffffffffffffff9c,in_stack_ffffffffffffff98),
                     (char *)CONCAT44(in_stack_ffffffffffffffa4,in_stack_ffffffffffffffa0));
    pPvk = (char *)(ulong)in_stack_ffffffffffffff9c;
    cVar5 = (char)in_stack_ffffffffffffff9c;
  }
  else {
    cVar5 = (char)pPvk;
  }
  if (cVar5 == 'Y') {
    PinCalculation(nIndiceCtx,sTlvBuffer);
    pPvk = extraout_RDX;
  }
  if (cVar1 == 'Y') {
    PinPrint(nIndiceCtx,sTlvBuffer);
    pPvk = extraout_RDX_00;
  }
  if (cVar2 == 'Y') {
    generate_ABA_PVV(nIndiceCtx,sTlvBuffer,pPvk,pPinBlk,pPinBlkFmt,in_R9,
                     (char *)CONCAT44(in_stack_ffffffffffffff9c,in_stack_ffffffffffffff98),
                     (char *)CONCAT44(in_stack_ffffffffffffffa4,in_stack_ffffffffffffffa0));
    pPvk = extraout_RDX_01;
  }
  if (cVar3 == 'Y') {
    ProdPinOffsetOfcustomerPIN
              (nIndiceCtx,sTlvBuffer,pPvk,pPinBlk,pPinBlkFmt,in_R9,
               (char *)CONCAT44(in_stack_ffffffffffffff9c,in_stack_ffffffffffffff98));
  }
  trace_event("Production() End ",5);
  return 0;
}



// WARNING: Unknown calling convention

int GetCVK(int nIndiceCtx,char *sPan,char *CVKA,char *CVKB)

{
  int iVar1;
  size_t __n;
  ulong uVar2;
  uint uVar3;
  uchar *puVar4;
  bool bVar5;
  byte bVar6;
  uchar auStack_2674 [272];
  uchar auStack_2564 [7672];
  int response;
  anon_struct_16_2_43c7b5cf T_LMK_ID;
  anon_struct_26_2_43c7b5cf T_Pan;
  sqlca sqlca;
  anon_struct_260_2_43c7b5cf T_CVKA;
  anon_struct_260_2_43c7b5cf T_CVKB;
  char sLine [512];
  sqlexd_conflict8 sqlstm;
  
  bVar6 = 0;
  if (debug_option == 1) {
    strlen(sPan);
    sprintf(sLine,"Start GetCVK(%d,%s,%d)",(ulong)(uint)nIndiceCtx,sPan);
  }
  else {
    builtin_strncpy(sLine,"Start Ge",8);
    builtin_strncpy(sLine + 8,"tCVK()",7);
  }
  trace_event(sLine,5);
  puVar4 = T_CVKA.arr + 2;
  uVar3 = 0xff;
  T_CVKA.arr[0] = '\0';
  T_CVKA.arr[1] = '\0';
  bVar5 = ((ulong)puVar4 & 4) != 0;
  if (bVar5) {
    T_CVKA.arr[2] = '\0';
    T_CVKA.arr[3] = '\0';
    T_CVKA.arr[4] = '\0';
    T_CVKA.arr[5] = '\0';
    uVar3 = 0xfb;
    puVar4 = T_CVKA.arr + 6;
  }
  for (uVar2 = (ulong)(uVar3 >> 3); uVar2 != 0; uVar2 = uVar2 - 1) {
    puVar4[0] = '\0';
    puVar4[1] = '\0';
    puVar4[2] = '\0';
    puVar4[3] = '\0';
    puVar4[4] = '\0';
    puVar4[5] = '\0';
    puVar4[6] = '\0';
    puVar4[7] = '\0';
    puVar4 = puVar4 + (ulong)bVar6 * -0x10 + 8;
  }
  if (!bVar5) {
    puVar4[0] = '\0';
    puVar4[1] = '\0';
    puVar4[2] = '\0';
    puVar4[3] = '\0';
    puVar4 = puVar4 + 4;
  }
  puVar4[0] = '\0';
  puVar4[1] = '\0';
  puVar4[2] = '\0';
  T_CVKB.arr[0] = '\0';
  T_CVKB.arr[1] = '\0';
  T_CVKA.len = 0;
  uVar3 = 0xff;
  puVar4 = T_CVKB.arr + 2;
  bVar5 = ((ulong)puVar4 & 4) != 0;
  if (bVar5) {
    T_CVKB.arr[2] = '\0';
    T_CVKB.arr[3] = '\0';
    T_CVKB.arr[4] = '\0';
    T_CVKB.arr[5] = '\0';
    uVar3 = 0xfb;
    puVar4 = T_CVKB.arr + 6;
  }
  for (uVar2 = (ulong)(uVar3 >> 3); uVar2 != 0; uVar2 = uVar2 - 1) {
    puVar4[0] = '\0';
    puVar4[1] = '\0';
    puVar4[2] = '\0';
    puVar4[3] = '\0';
    puVar4[4] = '\0';
    puVar4[5] = '\0';
    puVar4[6] = '\0';
    puVar4[7] = '\0';
    puVar4 = puVar4 + (ulong)bVar6 * -0x10 + 8;
  }
  if (!bVar5) {
    puVar4[0] = '\0';
    puVar4[1] = '\0';
    puVar4[2] = '\0';
    puVar4[3] = '\0';
    puVar4 = puVar4 + 4;
  }
  puVar4[0] = '\0';
  puVar4[1] = '\0';
  puVar4[2] = '\0';
  T_LMK_ID.len = 0;
  T_Pan.len = 0x16;
  T_CVKB.len = 0;
  T_Pan.arr[0x14] = '\0';
  T_Pan.arr[0x15] = '\0';
  T_LMK_ID.arr[0] = '\0';
  T_LMK_ID.arr[1] = '\0';
  T_LMK_ID.arr[2] = '\0';
  T_LMK_ID.arr[3] = '\0';
  T_LMK_ID.arr[4] = '\0';
  T_LMK_ID.arr[5] = '\0';
  T_LMK_ID.arr[6] = '\0';
  T_LMK_ID.arr[7] = '\0';
  T_LMK_ID.arr[8] = '\0';
  T_LMK_ID.arr[9] = '\0';
  T_LMK_ID.arr[10] = '\0';
  T_LMK_ID.arr[0xb] = '\0';
  T_LMK_ID.arr[0xc] = '\0';
  T_Pan.arr[0] = '\0';
  T_Pan.arr[1] = '\0';
  T_Pan.arr[2] = '\0';
  T_Pan.arr[3] = '\0';
  T_Pan.arr[4] = '\0';
  T_Pan.arr[5] = '\0';
  T_Pan.arr[6] = '\0';
  T_Pan.arr[7] = '\0';
  T_Pan.arr[8] = '\0';
  T_Pan.arr[9] = '\0';
  T_Pan.arr[10] = '\0';
  T_Pan.arr[0xb] = '\0';
  T_Pan.arr[0xc] = '\0';
  T_Pan.arr[0xd] = '\0';
  T_Pan.arr[0xe] = '\0';
  T_Pan.arr[0xf] = '\0';
  T_Pan.arr[0x10] = '\0';
  T_Pan.arr[0x11] = '\0';
  T_Pan.arr[0x12] = '\0';
  T_Pan.arr[0x13] = '\0';
  T_Pan.arr[0x16] = '\0';
  __n = strlen(sPan);
  memcpy(T_Pan.arr,sPan,__n);
  sqlstm.sqladtp = &sqladt;
  T_Pan.len = (ushort)__n;
  sqlstm.sqlety = 0x1100;
  sqlstm.sqltdsp = &sqltds;
  sqlstm.sqadto[0] = 0;
  sqlstm.sqtdso[0] = 0;
  sqlstm.sqadto[1] = 0;
  sqlstm.stmt = 
  "begin :response := PCRD_GET_HSM_KEY . GET_CVK_KEY ( :T_Pan , :T_CVKA , :T_CVKB , :T_LMK_ID ) ; END ;"
  ;
  sqlstm.sqtdso[1] = 0;
  response = 0x38d;
  sqlstm.sqlvsn = 0xc;
  sqlstm.cud = sqlcud0;
  sqlstm.sqhstv[0] = (uchar *)&response;
  sqlstm.arrsiz = 5;
  sqlstm.iters = 1;
  sqlstm.offset = 5;
  sqlstm.occurs = 0;
  sqlstm.sqhstl[0] = 4;
  sqlstm.sqhsts[0] = 0;
  sqlstm.sqindv[0] = (short *)0x0;
  sqlstm.sqinds[0] = 0;
  sqlstm.sqharm[0] = 0;
  sqlstm.sqhstl[1] = 0x19;
  sqlstm.sqhsts[1] = 0;
  sqlstm.sqindv[1] = (short *)0x0;
  sqlstm.sqinds[1] = 0;
  sqlstm.sqharm[1] = 0;
  sqlstm.sqhstl[2] = 0x103;
  sqlstm.sqhsts[2] = 0;
  sqlstm.sqindv[2] = (short *)0x0;
  sqlstm.sqadto[2] = 0;
  sqlstm.sqtdso[2] = 0;
  sqlstm.sqadto[3] = 0;
  sqlstm.sqinds[2] = 0;
  sqlstm.sqtdso[3] = 0;
  sqlstm.sqharm[2] = 0;
  sqlstm.sqadto[4] = 0;
  sqlstm.sqtdso[4] = 0;
  sqlstm.sqphsv = sqlstm.sqhstv;
  sqlstm.sqhstl[3] = 0x103;
  sqlstm.sqphsl = sqlstm.sqhstl;
  sqlstm.sqhsts[3] = 0;
  sqlstm.sqindv[3] = (short *)0x0;
  sqlstm.sqinds[3] = 0;
  sqlstm.sqphss = sqlstm.sqhsts;
  sqlstm.sqharm[3] = 0;
  sqlstm.sqhstl[4] = 0xf;
  sqlstm.sqpind = sqlstm.sqindv;
  sqlstm.sqhsts[4] = 0;
  sqlstm.sqindv[4] = (short *)0x0;
  sqlstm.sqinds[4] = 0;
  sqlstm.sqpins = sqlstm.sqinds;
  sqlstm.sqharm[4] = 0;
  sqlstm.sqparm = sqlstm.sqharm;
  sqlstm.sqparc = sqlstm.sqharc;
  sqlstm.sqpadto = sqlstm.sqadto;
  sqlstm.sqptdso = sqlstm.sqtdso;
  sqlstm.sqlest = (uchar *)&sqlca;
  sqlstm.sqhstv[1] = (uchar *)&T_Pan;
  sqlstm.sqhstv[2] = (uchar *)&T_CVKA;
  sqlstm.sqhstv[3] = (uchar *)&T_CVKB;
  sqlstm.sqhstv[4] = (uchar *)&T_LMK_ID;
  sqlcxt((long)nIndiceCtx * 0x10 + 0x713948,&sqlctx,&sqlstm,&sqlfpn);
  if (sqlca.sqlcode < 0) {
    strcpy(sLine,sqlca.sqlerrm.sqlerrmc);
    trace_event(sLine,1);
    trace_event("End  GetCVK(MALFUNCTION)",5);
    iVar1 = 3;
  }
  else if (response == 0) {
    memcpy(CVKA,T_CVKA.arr,(ulong)T_CVKA.len);
    memcpy(CVKB,T_CVKB.arr,(ulong)T_CVKB.len);
    if (debug_option == 1) {
      sprintf(sLine,"End   GetCVK(%.32s,%.32s)",CVKA,CVKB);
    }
    else {
      builtin_strncpy(sLine,"End   GetCVK(OK)",0x11);
    }
    trace_event(sLine,5);
    iVar1 = 0;
  }
  else {
    trace_event("End   GetCVK(NOK)",5);
    iVar1 = -1;
  }
  return iVar1;
}



// WARNING: Unknown calling convention

int SaveAWKKeyExchange(int nIndiceCtx,char *resource_id,char *AwK,char *Check_value)

{
  int iVar1;
  size_t sVar2;
  ulong uVar3;
  ulong uVar4;
  uchar *puVar5;
  uchar *puVar6;
  uint uVar7;
  bool bVar8;
  byte bVar9;
  uchar auStack_2566 [7946];
  int response;
  char T_resource_id [7];
  anon_struct_20_2_43c7b5cf T_check_value;
  sqlca sqlca;
  anon_struct_260_2_43c7b5cf T_AwK;
  char sLine [512];
  sqlexd_conflict8 sqlstm;
  
  bVar9 = 0;
  if (debug_option == 1) {
    sprintf(sLine,"Start SaveAWKKeyExchange(%.6s, %.48s, %.16s)",resource_id,AwK,Check_value);
  }
  else {
    sprintf(sLine,"Start SaveAWKKeyExchange(%.6s)",resource_id);
  }
  trace_event(sLine,5);
  puVar5 = T_AwK.arr + 2;
  uVar7 = 0xff;
  T_AwK.arr[0] = '\0';
  T_AwK.arr[1] = '\0';
  bVar8 = ((ulong)puVar5 & 4) != 0;
  if (bVar8) {
    T_AwK.arr[2] = '\0';
    T_AwK.arr[3] = '\0';
    T_AwK.arr[4] = '\0';
    T_AwK.arr[5] = '\0';
    uVar7 = 0xfb;
    puVar5 = T_AwK.arr + 6;
  }
  for (uVar3 = (ulong)(uVar7 >> 3); uVar3 != 0; uVar3 = uVar3 - 1) {
    puVar5[0] = '\0';
    puVar5[1] = '\0';
    puVar5[2] = '\0';
    puVar5[3] = '\0';
    puVar5[4] = '\0';
    puVar5[5] = '\0';
    puVar5[6] = '\0';
    puVar5[7] = '\0';
    puVar5 = puVar5 + (ulong)bVar9 * -0x10 + 8;
  }
  if (!bVar8) {
    puVar5[0] = '\0';
    puVar5[1] = '\0';
    puVar5[2] = '\0';
    puVar5[3] = '\0';
    puVar5 = puVar5 + 4;
  }
  puVar5[0] = '\0';
  puVar5[1] = '\0';
  puVar5[2] = '\0';
  T_resource_id._0_4_ = *(undefined4 *)resource_id;
  T_check_value.len = 0x10;
  T_resource_id._4_2_ = *(undefined2 *)(resource_id + 4);
  puVar5 = T_AwK.arr;
  T_AwK.len = 0;
  T_resource_id[6] = '\0';
  T_check_value.arr[0] = '\0';
  T_check_value.arr[1] = '\0';
  T_check_value.arr[2] = '\0';
  T_check_value.arr[3] = '\0';
  T_check_value.arr[4] = '\0';
  T_check_value.arr[5] = '\0';
  T_check_value.arr[6] = '\0';
  T_check_value.arr[7] = '\0';
  T_check_value.arr[8] = '\0';
  T_check_value.arr[9] = '\0';
  T_check_value.arr[10] = '\0';
  T_check_value.arr[0xb] = '\0';
  T_check_value.arr[0xc] = '\0';
  T_check_value.arr[0xd] = '\0';
  T_check_value.arr[0xe] = '\0';
  T_check_value.arr[0xf] = '\0';
  T_check_value.arr[0x10] = '\0';
  sVar2 = strlen(AwK);
  memcpy(puVar5,AwK,sVar2);
  T_AwK.len = (ushort)sVar2;
  sVar2 = strlen(Check_value);
  memcpy(T_check_value.arr,Check_value,sVar2);
  T_check_value.len = (ushort)sVar2;
  response = 0x38d;
  sqlstm.sqladtp = &sqladt;
  sqlstm.sqlvsn = 0xc;
  sqlstm.arrsiz = 5;
  sqlstm.sqltdsp = &sqltds;
  sqlstm.iters = 1;
  sqlstm.offset = 0x28;
  sqlstm.stmt = 
  "begin :response := PCRD_GET_HSM_KEY . SAVE_AWK_KEY_EXCHANGE ( :T_resource_id , :T_AwK , :T_check_value ) ; END ;"
  ;
  sqlstm.sqlety = 0x1100;
  sqlstm.occurs = 0;
  sqlstm.sqhstl[0] = 4;
  sqlstm.cud = sqlcud0;
  sqlstm.sqhstv[0] = (uchar *)&response;
  sqlstm.sqhsts[0] = 0;
  sqlstm.sqindv[0] = (short *)0x0;
  sqlstm.sqinds[0] = 0;
  sqlstm.sqharm[0] = 0;
  sqlstm.sqadto[0] = 0;
  sqlstm.sqhstl[1] = 7;
  sqlstm.sqtdso[0] = 0;
  sqlstm.sqhsts[1] = 0;
  sqlstm.sqadto[1] = 0;
  sqlstm.sqindv[1] = (short *)0x0;
  sqlstm.sqtdso[1] = 0;
  sqlstm.sqinds[1] = 0;
  sqlstm.sqharm[1] = 0;
  sqlstm.sqhstl[2] = 0x103;
  sqlstm.sqhsts[2] = 0;
  sqlstm.sqindv[2] = (short *)0x0;
  sqlstm.sqadto[3] = 0;
  sqlstm.sqadto[2] = 0;
  sqlstm.sqtdso[3] = 0;
  sqlstm.sqtdso[2] = 0;
  sqlstm.sqphsv = sqlstm.sqhstv;
  sqlstm.sqinds[2] = 0;
  sqlstm.sqharm[2] = 0;
  sqlstm.sqphsl = sqlstm.sqhstl;
  sqlstm.sqhstl[3] = 0x13;
  sqlstm.sqhsts[3] = 0;
  sqlstm.sqphss = sqlstm.sqhsts;
  sqlstm.sqindv[3] = (short *)0x0;
  sqlstm.sqinds[3] = 0;
  sqlstm.sqharm[3] = 0;
  sqlstm.sqpind = sqlstm.sqindv;
  sqlstm.sqpins = sqlstm.sqinds;
  sqlstm.sqparm = sqlstm.sqharm;
  sqlstm.sqparc = sqlstm.sqharc;
  sqlstm.sqpadto = sqlstm.sqadto;
  sqlstm.sqptdso = sqlstm.sqtdso;
  sqlstm.sqlest = (uchar *)&sqlca;
  sqlstm.sqhstv[1] = (uchar *)T_resource_id;
  sqlstm.sqhstv[2] = (uchar *)&T_AwK;
  sqlstm.sqhstv[3] = (uchar *)&T_check_value;
  sqlcxt((long)nIndiceCtx * 0x10 + 0x713948,&sqlctx);
  uVar3 = 0x101;
  if (sqlca.sqlcode < 0) {
    if (((ulong)puVar5 & 2) != 0) {
      puVar5 = T_AwK.arr + 2;
      uVar3 = 0xff;
      T_AwK.arr[0] = '\0';
      T_AwK.arr[1] = '\0';
    }
    if (((ulong)puVar5 & 4) != 0) {
      puVar5[0] = '\0';
      puVar5[1] = '\0';
      puVar5[2] = '\0';
      puVar5[3] = '\0';
      uVar3 = (ulong)((int)uVar3 - 4);
      puVar5 = puVar5 + 4;
    }
    for (uVar4 = uVar3 >> 3; uVar4 != 0; uVar4 = uVar4 - 1) {
      puVar5[0] = '\0';
      puVar5[1] = '\0';
      puVar5[2] = '\0';
      puVar5[3] = '\0';
      puVar5[4] = '\0';
      puVar5[5] = '\0';
      puVar5[6] = '\0';
      puVar5[7] = '\0';
      puVar5 = puVar5 + (ulong)bVar9 * -0x10 + 8;
    }
    if ((uVar3 & 4) != 0) {
      puVar5[0] = '\0';
      puVar5[1] = '\0';
      puVar5[2] = '\0';
      puVar5[3] = '\0';
      puVar5 = puVar5 + 4;
    }
    puVar6 = puVar5;
    if ((uVar3 & 2) != 0) {
      puVar6 = puVar5 + 2;
      puVar5[0] = '\0';
      puVar5[1] = '\0';
    }
    *puVar6 = '\0';
    strcpy(sLine,sqlca.sqlerrm.sqlerrmc);
    trace_event(sLine,1);
    trace_event("End  SaveAWKKeyExchange (MALFUNCTION)",5);
    iVar1 = 3;
  }
  else {
    if (((ulong)puVar5 & 2) != 0) {
      puVar5 = T_AwK.arr + 2;
      uVar3 = 0xff;
      T_AwK.arr[0] = '\0';
      T_AwK.arr[1] = '\0';
    }
    if (((ulong)puVar5 & 4) != 0) {
      puVar5[0] = '\0';
      puVar5[1] = '\0';
      puVar5[2] = '\0';
      puVar5[3] = '\0';
      uVar3 = (ulong)((int)uVar3 - 4);
      puVar5 = puVar5 + 4;
    }
    for (uVar4 = uVar3 >> 3; uVar4 != 0; uVar4 = uVar4 - 1) {
      puVar5[0] = '\0';
      puVar5[1] = '\0';
      puVar5[2] = '\0';
      puVar5[3] = '\0';
      puVar5[4] = '\0';
      puVar5[5] = '\0';
      puVar5[6] = '\0';
      puVar5[7] = '\0';
      puVar5 = puVar5 + (ulong)bVar9 * -0x10 + 8;
    }
    if ((uVar3 & 4) != 0) {
      puVar5[0] = '\0';
      puVar5[1] = '\0';
      puVar5[2] = '\0';
      puVar5[3] = '\0';
      puVar5 = puVar5 + 4;
    }
    if ((uVar3 & 2) != 0) {
      puVar5[0] = '\0';
      puVar5[1] = '\0';
      puVar5 = puVar5 + 2;
    }
    *puVar5 = '\0';
    if (response == 0) {
      trace_event("End   SaveAWKKeyExchange(OK)",5);
      iVar1 = 0;
    }
    else {
      trace_event("End   SaveAWKKeyExchange(NOK)",5);
      iVar1 = -1;
    }
  }
  return iVar1;
}



// WARNING: Unknown calling convention

int SetAWKKeyExchange(int nIndiceCtx,char *resource_id,char *Check_value)

{
  int iVar1;
  size_t __n;
  int response;
  char T_resource_id [7];
  anon_struct_20_2_43c7b5cf T_check_value;
  sqlca sqlca;
  char sLine [512];
  sqlexd_conflict8 sqlstm;
  
  if (debug_option == 1) {
    sprintf(sLine,"Start SetAWKKeyExchange(%.6s, %.16s)",resource_id,Check_value);
  }
  else {
    sprintf(sLine,"Start SetAWKKeyExchange(%.6s)",resource_id);
  }
  trace_event(sLine,5);
  T_resource_id._0_4_ = *(undefined4 *)resource_id;
  T_check_value.len = 0x10;
  T_resource_id[6] = '\0';
  T_check_value.arr[0] = '\0';
  T_check_value.arr[1] = '\0';
  T_check_value.arr[2] = '\0';
  T_check_value.arr[3] = '\0';
  T_check_value.arr[4] = '\0';
  T_check_value.arr[5] = '\0';
  T_check_value.arr[6] = '\0';
  T_check_value.arr[7] = '\0';
  T_check_value.arr[8] = '\0';
  T_check_value.arr[9] = '\0';
  T_check_value.arr[10] = '\0';
  T_check_value.arr[0xb] = '\0';
  T_check_value.arr[0xc] = '\0';
  T_check_value.arr[0xd] = '\0';
  T_check_value.arr[0xe] = '\0';
  T_check_value.arr[0xf] = '\0';
  T_resource_id._4_2_ = *(undefined2 *)(resource_id + 4);
  T_check_value.arr[0x10] = '\0';
  __n = strlen(Check_value);
  memcpy(T_check_value.arr,Check_value,__n);
  T_check_value.len = (ushort)__n;
  sqlstm.sqlest = (uchar *)&sqlca;
  sqlstm.sqladtp = &sqladt;
  sqlstm.sqadto[0] = 0;
  sqlstm.sqltdsp = &sqltds;
  sqlstm.sqlety = 0x1100;
  sqlstm.sqtdso[0] = 0;
  sqlstm.sqadto[1] = 0;
  sqlstm.stmt = 
  "begin :response := PCRD_GET_HSM_KEY . SET_AWK_KEY_EXCHANGE ( :T_resource_id , :T_check_value ) ; END ;"
  ;
  sqlstm.sqtdso[1] = 0;
  response = 0x38d;
  sqlstm.sqlvsn = 0xc;
  sqlstm.cud = sqlcud0;
  sqlstm.sqhstv[0] = (uchar *)&response;
  sqlstm.arrsiz = 5;
  sqlstm.iters = 1;
  sqlstm.offset = 0x47;
  sqlstm.sqphsv = sqlstm.sqhstv;
  sqlstm.occurs = 0;
  sqlstm.sqhstl[0] = 4;
  sqlstm.sqhsts[0] = 0;
  sqlstm.sqindv[0] = (short *)0x0;
  sqlstm.sqinds[0] = 0;
  sqlstm.sqharm[0] = 0;
  sqlstm.sqhstl[1] = 7;
  sqlstm.sqhsts[1] = 0;
  sqlstm.sqindv[1] = (short *)0x0;
  sqlstm.sqinds[1] = 0;
  sqlstm.sqharm[1] = 0;
  sqlstm.sqhstl[2] = 0x13;
  sqlstm.sqhsts[2] = 0;
  sqlstm.sqindv[2] = (short *)0x0;
  sqlstm.sqinds[2] = 0;
  sqlstm.sqphsl = sqlstm.sqhstl;
  sqlstm.sqharm[2] = 0;
  sqlstm.sqadto[2] = 0;
  sqlstm.sqphss = sqlstm.sqhsts;
  sqlstm.sqtdso[2] = 0;
  sqlstm.sqpind = sqlstm.sqindv;
  sqlstm.sqpins = sqlstm.sqinds;
  sqlstm.sqparm = sqlstm.sqharm;
  sqlstm.sqparc = sqlstm.sqharc;
  sqlstm.sqpadto = sqlstm.sqadto;
  sqlstm.sqptdso = sqlstm.sqtdso;
  sqlstm.sqhstv[1] = (uchar *)T_resource_id;
  sqlstm.sqhstv[2] = (uchar *)&T_check_value;
  sqlcxt((long)nIndiceCtx * 0x10 + 0x713948,&sqlctx,&sqlstm,&sqlfpn);
  if (sqlca.sqlcode < 0) {
    strcpy(sLine,sqlca.sqlerrm.sqlerrmc);
    trace_event(sLine,1);
    trace_event("End  SetAWKKeyExchange (MALFUNCTION)",5);
    iVar1 = 3;
  }
  else if (response == 0) {
    trace_event("End   SetAWKKeyExchange(OK)",5);
    iVar1 = 0;
  }
  else {
    trace_event("End   SetAWKKeyExchange(NOK)",5);
    iVar1 = -1;
  }
  return iVar1;
}



// WARNING: Unknown calling convention

int SaveZPKKey(int nIndiceCtx,char *pResourceId,char *pZpkLmk,char *pZpkZmk,char *pCheckValue)

{
  size_t sVar1;
  long lVar2;
  uchar *puVar3;
  byte bVar4;
  int hRet;
  anon_struct_10_2_43c7b5cf hResourceId;
  char hZpkLmk [257];
  char hZpkZmk [257];
  char hCheckValue [257];
  char detail [512];
  sqlexd_conflict8 sqlstm;
  
  bVar4 = 0;
  if (debug_option == 1) {
    sprintf(detail,"Start SaveZPKKey(%s,%.16s,%.16s)",pResourceId,pZpkLmk,pZpkZmk);
  }
  else {
    sprintf(detail,"Start SaveZPKKey(%s)",pResourceId);
  }
  trace_event(detail,5);
  hResourceId.arr[4] = '\0';
  hResourceId.arr[5] = '\0';
  puVar3 = (uchar *)hZpkLmk;
  for (lVar2 = 0x20; lVar2 != 0; lVar2 = lVar2 + -1) {
    puVar3[0] = '\0';
    puVar3[1] = '\0';
    puVar3[2] = '\0';
    puVar3[3] = '\0';
    puVar3[4] = '\0';
    puVar3[5] = '\0';
    puVar3[6] = '\0';
    puVar3[7] = '\0';
    puVar3 = puVar3 + (ulong)bVar4 * -0x10 + 8;
  }
  hResourceId.len = 0;
  hResourceId.arr[0] = '\0';
  hResourceId.arr[1] = '\0';
  hResourceId.arr[2] = '\0';
  hResourceId.arr[3] = '\0';
  hResourceId.arr[6] = '\0';
  *puVar3 = '\0';
  puVar3 = (uchar *)hZpkZmk;
  for (lVar2 = 0x20; lVar2 != 0; lVar2 = lVar2 + -1) {
    puVar3[0] = '\0';
    puVar3[1] = '\0';
    puVar3[2] = '\0';
    puVar3[3] = '\0';
    puVar3[4] = '\0';
    puVar3[5] = '\0';
    puVar3[6] = '\0';
    puVar3[7] = '\0';
    puVar3 = puVar3 + (ulong)bVar4 * -0x10 + 8;
  }
  *puVar3 = '\0';
  puVar3 = (uchar *)hCheckValue;
  for (lVar2 = 0x20; lVar2 != 0; lVar2 = lVar2 + -1) {
    puVar3[0] = '\0';
    puVar3[1] = '\0';
    puVar3[2] = '\0';
    puVar3[3] = '\0';
    puVar3[4] = '\0';
    puVar3[5] = '\0';
    puVar3[6] = '\0';
    puVar3[7] = '\0';
    puVar3 = puVar3 + (ulong)bVar4 * -0x10 + 8;
  }
  *puVar3 = '\0';
  sVar1 = strlen(pResourceId);
  memcpy(hResourceId.arr,pResourceId,sVar1);
  hResourceId.len = (ushort)sVar1;
  sVar1 = strlen(pZpkLmk);
  memcpy(hZpkLmk,pZpkLmk,sVar1);
  sVar1 = strlen(pZpkZmk);
  memcpy(hZpkZmk,pZpkZmk,sVar1);
  sVar1 = strlen(pCheckValue);
  memcpy(hCheckValue,pCheckValue,sVar1);
  sqlstm.sqladtp = &sqladt;
  sqlstm.sqlety = 0x1100;
  sqlstm.sqltdsp = &sqltds;
  sqlstm.sqadto[0] = 0;
  sqlstm.sqtdso[0] = 0;
  sqlstm.sqadto[1] = 0;
  sqlstm.stmt = 
  "begin :hRet := PCRD_GET_HSM_KEY . SAVE_ZPK_KEY ( :hResourceId , :hZpkLmk , :hZpkZmk , :hCheckValue ) ; END ;"
  ;
  sqlstm.sqtdso[1] = 0;
  sqlstm.sqlvsn = 0xc;
  sqlstm.cud = sqlcud0;
  sqlstm.sqhstv[0] = (uchar *)&hRet;
  sqlstm.arrsiz = 5;
  sqlstm.iters = 1;
  sqlstm.offset = 0x62;
  sqlstm.sqlest = (uchar *)&sqlca;
  sqlstm.occurs = 0;
  sqlstm.sqhstl[0] = 4;
  sqlstm.sqhsts[0] = 0;
  sqlstm.sqindv[0] = (short *)0x0;
  sqlstm.sqinds[0] = 0;
  sqlstm.sqharm[0] = 0;
  sqlstm.sqhstl[1] = 9;
  sqlstm.sqhsts[1] = 0;
  sqlstm.sqindv[1] = (short *)0x0;
  sqlstm.sqinds[1] = 0;
  sqlstm.sqharm[1] = 0;
  sqlstm.sqhstl[2] = 0x101;
  sqlstm.sqhsts[2] = 0;
  sqlstm.sqindv[2] = (short *)0x0;
  sqlstm.sqinds[2] = 0;
  sqlstm.sqadto[3] = 0;
  sqlstm.sqtdso[3] = 0;
  sqlstm.sqadto[4] = 0;
  sqlstm.sqharm[2] = 0;
  sqlstm.sqtdso[4] = 0;
  sqlstm.sqphsv = sqlstm.sqhstv;
  sqlstm.sqadto[2] = 0;
  sqlstm.sqtdso[2] = 0;
  sqlstm.sqphsl = sqlstm.sqhstl;
  sqlstm.sqhstl[3] = 0x101;
  sqlstm.sqphss = sqlstm.sqhsts;
  sqlstm.sqhsts[3] = 0;
  sqlstm.sqindv[3] = (short *)0x0;
  sqlstm.sqinds[3] = 0;
  sqlstm.sqpind = sqlstm.sqindv;
  sqlstm.sqharm[3] = 0;
  sqlstm.sqhstl[4] = 0x101;
  sqlstm.sqpins = sqlstm.sqinds;
  sqlstm.sqhsts[4] = 0;
  sqlstm.sqindv[4] = (short *)0x0;
  sqlstm.sqinds[4] = 0;
  sqlstm.sqparm = sqlstm.sqharm;
  sqlstm.sqharm[4] = 0;
  sqlstm.sqparc = sqlstm.sqharc;
  sqlstm.sqpadto = sqlstm.sqadto;
  sqlstm.sqptdso = sqlstm.sqtdso;
  sqlstm.sqhstv[1] = (uchar *)&hResourceId;
  sqlstm.sqhstv[2] = (uchar *)hZpkLmk;
  sqlstm.sqhstv[3] = (uchar *)hZpkZmk;
  sqlstm.sqhstv[4] = (uchar *)hCheckValue;
  sqlcxt((long)nIndiceCtx * 0x10 + 0x713948,&sqlctx,&sqlstm,&sqlfpn);
  if (sqlca.sqlcode < 0) {
    sprintf(detail,"%.79s",0x715952);
    trace_event(detail,1);
    trace_event("End   SaveZPKKey(ERROR)",1);
    hRet = 1;
  }
  else if (hRet == 0) {
    builtin_strncpy(detail,"End   SaveZPKKey",0x10);
    builtin_strncpy(detail + 0x10,"(OK)",4);
    detail._20_2_ = (ushort)(byte)detail[0x15] << 8;
    trace_event(detail,5);
    hRet = 0;
  }
  else {
    builtin_strncpy(detail,"End   SaveZPKKey(NOK)",0x16);
    trace_event(detail,5);
  }
  return hRet;
}



// WARNING: Removing unreachable block (ram,0x0047df3b)
// WARNING: Unknown calling convention

int GetIssuerZPK(int nIndiceCtx,char *sPan,char *sZPK)

{
  int iVar1;
  size_t __n;
  ulong uVar2;
  ulong uVar3;
  uint uVar4;
  uchar *puVar5;
  bool bVar6;
  byte bVar7;
  uchar auStack_2366 [7962];
  int response;
  anon_struct_26_2_43c7b5cf T_Pan;
  sqlca sqlca;
  anon_struct_260_2_43c7b5cf T_ZPK;
  char sLine [512];
  undefined2 local_58;
  undefined2 local_56;
  undefined2 local_54;
  undefined2 local_48;
  undefined2 local_46;
  undefined2 local_44;
  
  bVar7 = 0;
  trace_event("Start GetIssuerZPK()",5);
  puVar5 = T_ZPK.arr + 2;
  uVar4 = 0xff;
  T_ZPK.arr[0] = '\0';
  T_ZPK.arr[1] = '\0';
  bVar6 = ((ulong)puVar5 & 4) != 0;
  if (bVar6) {
    T_ZPK.arr[2] = '\0';
    T_ZPK.arr[3] = '\0';
    T_ZPK.arr[4] = '\0';
    T_ZPK.arr[5] = '\0';
    uVar4 = 0xfb;
    puVar5 = T_ZPK.arr + 6;
  }
  for (uVar2 = (ulong)(uVar4 >> 3); uVar2 != 0; uVar2 = uVar2 - 1) {
    puVar5[0] = '\0';
    puVar5[1] = '\0';
    puVar5[2] = '\0';
    puVar5[3] = '\0';
    puVar5[4] = '\0';
    puVar5[5] = '\0';
    puVar5[6] = '\0';
    puVar5[7] = '\0';
    puVar5 = puVar5 + (ulong)bVar7 * -0x10 + 8;
  }
  if (!bVar6) {
    puVar5[0] = '\0';
    puVar5[1] = '\0';
    puVar5[2] = '\0';
    puVar5[3] = '\0';
    puVar5 = puVar5 + 4;
  }
  puVar5[0] = '\0';
  puVar5[1] = '\0';
  puVar5[2] = '\0';
  T_ZPK.len = 0;
  T_Pan.arr[0] = '\0';
  T_Pan.arr[1] = '\0';
  T_Pan.arr[2] = '\0';
  T_Pan.arr[3] = '\0';
  T_Pan.arr[4] = '\0';
  T_Pan.arr[5] = '\0';
  T_Pan.arr[6] = '\0';
  T_Pan.arr[7] = '\0';
  T_Pan.arr[8] = '\0';
  T_Pan.arr[9] = '\0';
  T_Pan.arr[10] = '\0';
  T_Pan.arr[0xb] = '\0';
  T_Pan.arr[0xc] = '\0';
  T_Pan.arr[0xd] = '\0';
  T_Pan.arr[0xe] = '\0';
  T_Pan.arr[0xf] = '\0';
  T_Pan.arr[0x10] = '\0';
  T_Pan.arr[0x11] = '\0';
  T_Pan.arr[0x12] = '\0';
  T_Pan.arr[0x13] = '\0';
  T_Pan.arr[0x14] = '\0';
  T_Pan.arr[0x15] = '\0';
  T_Pan.arr[0x16] = '\0';
  __n = strlen(sPan);
  memcpy(T_Pan.arr,sPan,__n);
  T_Pan.len = (ushort)__n;
  response = 0x38d;
  sLine[0] = '\f';
  sLine[1] = '\0';
  sLine[2] = '\0';
  sLine[3] = '\0';
  sLine[4] = '\0';
  sLine[5] = '\0';
  sLine[6] = '\0';
  sLine[7] = '\0';
  sLine[8] = '\x05';
  sLine[9] = '\0';
  sLine[10] = '\0';
  sLine[0xb] = '\0';
  sLine._56_8_ = &sqladt;
  sLine[0xc] = '\x01';
  sLine[0xd] = '\0';
  sLine[0xe] = '\0';
  sLine[0xf] = '\0';
  sLine[0x10] = -0x7b;
  sLine[0x11] = '\0';
  sLine[0x12] = '\0';
  sLine[0x13] = '\0';
  sLine._64_8_ = &sqltds;
  sLine[0x18] = '\0';
  sLine[0x19] = '\0';
  sLine[0x1a] = '\0';
  sLine[0x1b] = '\0';
  sLine[0xf0] = '\x04';
  sLine[0xf1] = '\0';
  sLine[0xf2] = '\0';
  sLine[0xf3] = '\0';
  sLine[0xf4] = '\0';
  sLine[0xf5] = '\0';
  sLine[0xf6] = '\0';
  sLine[0xf7] = '\0';
  sLine[0x130] = '\0';
  sLine[0x131] = '\0';
  sLine[0x132] = '\0';
  sLine[0x133] = '\0';
  sLine._48_8_ = s_begin__response____PCRD_GET_HSM__004d2e78;
  sLine[0x150] = '\0';
  sLine[0x151] = '\0';
  sLine[0x152] = '\0';
  sLine[0x153] = '\0';
  sLine[0x154] = '\0';
  sLine[0x155] = '\0';
  sLine[0x156] = '\0';
  sLine[0x157] = '\0';
  sLine[400] = '\0';
  sLine[0x191] = '\0';
  sLine[0x192] = '\0';
  sLine[0x193] = '\0';
  sLine[0x1b0] = '\0';
  sLine[0x1b1] = '\0';
  sLine[0x1b2] = '\0';
  sLine[0x1b3] = '\0';
  sLine[0x1b4] = '\0';
  sLine[0x1b5] = '\0';
  sLine[0x1b6] = '\0';
  sLine[0x1b7] = '\0';
  sLine._32_8_ = sqlcud0;
  sLine[0x16] = '\0';
  sLine[0x17] = '\x11';
  sLine._176_8_ = &response;
  sLine[0xf8] = '\x19';
  sLine[0xf9] = '\0';
  sLine[0xfa] = '\0';
  sLine[0xfb] = '\0';
  sLine[0xfc] = '\0';
  sLine[0xfd] = '\0';
  sLine[0xfe] = '\0';
  sLine[0xff] = '\0';
  sLine[0x134] = '\0';
  sLine[0x135] = '\0';
  sLine[0x136] = '\0';
  sLine[0x137] = '\0';
  sLine[0x158] = '\0';
  sLine[0x159] = '\0';
  sLine[0x15a] = '\0';
  sLine[0x15b] = '\0';
  sLine[0x15c] = '\0';
  sLine[0x15d] = '\0';
  sLine[0x15e] = '\0';
  sLine[0x15f] = '\0';
  sLine[0x194] = '\0';
  sLine[0x195] = '\0';
  sLine[0x196] = '\0';
  sLine[0x197] = '\0';
  local_58 = 0;
  sLine[0x1b8] = '\0';
  sLine[0x1b9] = '\0';
  sLine[0x1ba] = '\0';
  sLine[0x1bb] = '\0';
  sLine[0x1bc] = '\0';
  sLine[0x1bd] = '\0';
  sLine[0x1be] = '\0';
  sLine[0x1bf] = '\0';
  local_48 = 0;
  local_56 = 0;
  sLine[0x100] = '\x03';
  sLine[0x101] = '\x01';
  sLine[0x102] = '\0';
  sLine[0x103] = '\0';
  sLine[0x104] = '\0';
  sLine[0x105] = '\0';
  sLine[0x106] = '\0';
  sLine[0x107] = '\0';
  local_46 = 0;
  sLine._72_8_ = sLine + 0xb0;
  sLine[0x138] = '\0';
  sLine[0x139] = '\0';
  sLine[0x13a] = '\0';
  sLine[0x13b] = '\0';
  sLine[0x160] = '\0';
  sLine[0x161] = '\0';
  sLine[0x162] = '\0';
  sLine[0x163] = '\0';
  sLine[0x164] = '\0';
  sLine[0x165] = '\0';
  sLine[0x166] = '\0';
  sLine[0x167] = '\0';
  sLine[0x198] = '\0';
  sLine[0x199] = '\0';
  sLine[0x19a] = '\0';
  sLine[0x19b] = '\0';
  sLine._80_8_ = sLine + 0xf0;
  local_44 = 0;
  local_54 = 0;
  sLine._88_8_ = sLine + 0x130;
  sLine[0x1c0] = '\0';
  sLine[0x1c1] = '\0';
  sLine[0x1c2] = '\0';
  sLine[0x1c3] = '\0';
  sLine[0x1c4] = '\0';
  sLine[0x1c5] = '\0';
  sLine[0x1c6] = '\0';
  sLine[0x1c7] = '\0';
  sLine._96_8_ = sLine + 0x150;
  sLine._104_8_ = sLine + 400;
  sLine._112_8_ = sLine + 0x1b0;
  sLine._120_8_ = sLine + 0x1f0;
  sLine._128_8_ = &local_58;
  sLine._136_8_ = &local_48;
  sLine._40_8_ = &sqlca;
  sLine._184_8_ = &T_Pan;
  sLine._192_8_ = &T_ZPK;
  sqlcxt((long)nIndiceCtx * 0x10 + 0x713948,&sqlctx,sLine,&sqlfpn);
  if (sqlca.sqlcode < 0) {
    puVar5 = T_ZPK.arr + 2;
    uVar4 = 0xff;
    T_ZPK.arr[0] = '\0';
    T_ZPK.arr[1] = '\0';
    bVar6 = ((ulong)puVar5 & 4) != 0;
    if (bVar6) {
      T_ZPK.arr[2] = '\0';
      T_ZPK.arr[3] = '\0';
      T_ZPK.arr[4] = '\0';
      T_ZPK.arr[5] = '\0';
      uVar4 = 0xfb;
      puVar5 = T_ZPK.arr + 6;
    }
    for (uVar2 = (ulong)(uVar4 >> 3); uVar2 != 0; uVar2 = uVar2 - 1) {
      puVar5[0] = '\0';
      puVar5[1] = '\0';
      puVar5[2] = '\0';
      puVar5[3] = '\0';
      puVar5[4] = '\0';
      puVar5[5] = '\0';
      puVar5[6] = '\0';
      puVar5[7] = '\0';
      puVar5 = puVar5 + (ulong)bVar7 * -0x10 + 8;
    }
    if (!bVar6) {
      puVar5[0] = '\0';
      puVar5[1] = '\0';
      puVar5[2] = '\0';
      puVar5[3] = '\0';
      puVar5 = puVar5 + 4;
    }
    puVar5[0] = '\0';
    puVar5[1] = '\0';
    puVar5[2] = '\0';
    T_Pan.arr[0] = '\0';
    T_Pan.arr[1] = '\0';
    T_Pan.arr[2] = '\0';
    T_Pan.arr[3] = '\0';
    T_Pan.arr[4] = '\0';
    T_Pan.arr[5] = '\0';
    T_Pan.arr[6] = '\0';
    T_Pan.arr[7] = '\0';
    T_Pan.arr[0x14] = '\0';
    T_Pan.arr[0x15] = '\0';
    T_Pan.arr[8] = '\0';
    T_Pan.arr[9] = '\0';
    T_Pan.arr[10] = '\0';
    T_Pan.arr[0xb] = '\0';
    T_Pan.arr[0xc] = '\0';
    T_Pan.arr[0xd] = '\0';
    T_Pan.arr[0xe] = '\0';
    T_Pan.arr[0xf] = '\0';
    T_Pan.arr[0x10] = '\0';
    T_Pan.arr[0x11] = '\0';
    T_Pan.arr[0x12] = '\0';
    T_Pan.arr[0x13] = '\0';
    T_Pan.arr[0x16] = '\0';
    strcpy(sLine,sqlca.sqlerrm.sqlerrmc);
    trace_event(sLine,1);
    trace_event("End  GetIssuerZPK (MALFUNCTION)",5);
    iVar1 = 3;
  }
  else if (response == 0) {
    uVar2 = (ulong)T_ZPK.len;
    puVar5 = T_ZPK.arr;
    memcpy(sZPK,puVar5,uVar2);
    sZPK[uVar2] = '\0';
    uVar2 = 0x101;
    if (((ulong)puVar5 & 2) != 0) {
      puVar5 = T_ZPK.arr + 2;
      uVar2 = 0xff;
      T_ZPK.arr[0] = '\0';
      T_ZPK.arr[1] = '\0';
    }
    if (((ulong)puVar5 & 4) != 0) {
      puVar5[0] = '\0';
      puVar5[1] = '\0';
      puVar5[2] = '\0';
      puVar5[3] = '\0';
      uVar2 = (ulong)((int)uVar2 - 4);
      puVar5 = puVar5 + 4;
    }
    for (uVar3 = uVar2 >> 3; uVar3 != 0; uVar3 = uVar3 - 1) {
      puVar5[0] = '\0';
      puVar5[1] = '\0';
      puVar5[2] = '\0';
      puVar5[3] = '\0';
      puVar5[4] = '\0';
      puVar5[5] = '\0';
      puVar5[6] = '\0';
      puVar5[7] = '\0';
      puVar5 = puVar5 + (ulong)bVar7 * -0x10 + 8;
    }
    if ((uVar2 & 4) != 0) {
      puVar5[0] = '\0';
      puVar5[1] = '\0';
      puVar5[2] = '\0';
      puVar5[3] = '\0';
      puVar5 = puVar5 + 4;
    }
    if ((uVar2 & 2) != 0) {
      puVar5[0] = '\0';
      puVar5[1] = '\0';
      puVar5 = puVar5 + 2;
    }
    *puVar5 = '\0';
    T_Pan.arr[0] = '\0';
    T_Pan.arr[1] = '\0';
    T_Pan.arr[2] = '\0';
    T_Pan.arr[3] = '\0';
    T_Pan.arr[4] = '\0';
    T_Pan.arr[5] = '\0';
    T_Pan.arr[6] = '\0';
    T_Pan.arr[7] = '\0';
    T_Pan.arr[0x14] = '\0';
    T_Pan.arr[0x15] = '\0';
    T_Pan.arr[8] = '\0';
    T_Pan.arr[9] = '\0';
    T_Pan.arr[10] = '\0';
    T_Pan.arr[0xb] = '\0';
    T_Pan.arr[0xc] = '\0';
    T_Pan.arr[0xd] = '\0';
    T_Pan.arr[0xe] = '\0';
    T_Pan.arr[0xf] = '\0';
    T_Pan.arr[0x10] = '\0';
    T_Pan.arr[0x11] = '\0';
    T_Pan.arr[0x12] = '\0';
    T_Pan.arr[0x13] = '\0';
    T_Pan.arr[0x16] = '\0';
    trace_event("End   GetPinKey(OK)",5);
    iVar1 = 0;
  }
  else {
    puVar5 = T_ZPK.arr + 2;
    uVar4 = 0xff;
    T_ZPK.arr[0] = '\0';
    T_ZPK.arr[1] = '\0';
    bVar6 = ((ulong)puVar5 & 4) != 0;
    if (bVar6) {
      T_ZPK.arr[2] = '\0';
      T_ZPK.arr[3] = '\0';
      T_ZPK.arr[4] = '\0';
      T_ZPK.arr[5] = '\0';
      uVar4 = 0xfb;
      puVar5 = T_ZPK.arr + 6;
    }
    for (uVar2 = (ulong)(uVar4 >> 3); uVar2 != 0; uVar2 = uVar2 - 1) {
      puVar5[0] = '\0';
      puVar5[1] = '\0';
      puVar5[2] = '\0';
      puVar5[3] = '\0';
      puVar5[4] = '\0';
      puVar5[5] = '\0';
      puVar5[6] = '\0';
      puVar5[7] = '\0';
      puVar5 = puVar5 + (ulong)bVar7 * -0x10 + 8;
    }
    if (!bVar6) {
      puVar5[0] = '\0';
      puVar5[1] = '\0';
      puVar5[2] = '\0';
      puVar5[3] = '\0';
      puVar5 = puVar5 + 4;
    }
    puVar5[0] = '\0';
    puVar5[1] = '\0';
    puVar5[2] = '\0';
    T_Pan.arr[0] = '\0';
    T_Pan.arr[1] = '\0';
    T_Pan.arr[2] = '\0';
    T_Pan.arr[3] = '\0';
    T_Pan.arr[4] = '\0';
    T_Pan.arr[5] = '\0';
    T_Pan.arr[6] = '\0';
    T_Pan.arr[7] = '\0';
    T_Pan.arr[0x14] = '\0';
    T_Pan.arr[0x15] = '\0';
    T_Pan.arr[8] = '\0';
    T_Pan.arr[9] = '\0';
    T_Pan.arr[10] = '\0';
    T_Pan.arr[0xb] = '\0';
    T_Pan.arr[0xc] = '\0';
    T_Pan.arr[0xd] = '\0';
    T_Pan.arr[0xe] = '\0';
    T_Pan.arr[0xf] = '\0';
    T_Pan.arr[0x10] = '\0';
    T_Pan.arr[0x11] = '\0';
    T_Pan.arr[0x12] = '\0';
    T_Pan.arr[0x13] = '\0';
    T_Pan.arr[0x16] = '\0';
    trace_event("End   GetIssuerZPK(NOK)",5);
    iVar1 = -1;
  }
  return iVar1;
}



// WARNING: Unknown calling convention

int GetPVK(int nIndiceCtx,char *sPan,char pvki,char *PVKA,char *PVKB)

{
  int iVar1;
  size_t __n;
  ulong uVar2;
  uint uVar3;
  uchar *puVar4;
  bool bVar5;
  byte bVar6;
  uchar auStack_2674 [272];
  uchar auStack_2564 [7656];
  char local_77c [12];
  int response;
  int T_PVKI;
  anon_struct_16_2_43c7b5cf T_LMK_ID;
  anon_struct_26_2_43c7b5cf T_Pan;
  sqlca sqlca;
  anon_struct_260_2_43c7b5cf T_PVKA;
  anon_struct_260_2_43c7b5cf T_PVKB;
  char sLine [512];
  sqlexd_conflict8 sqlstm;
  
  bVar6 = 0;
  local_77c[0] = pvki;
  if (debug_option == 1) {
    sprintf(sLine,"Start GetPVK(%.16s,%c)",sPan,(ulong)(uint)(int)pvki);
  }
  else {
    builtin_strncpy(sLine,"Start Ge",8);
    builtin_strncpy(sLine + 8,"tPVK()",7);
  }
  trace_event(sLine,5);
  puVar4 = T_PVKA.arr + 2;
  T_PVKA.arr[0] = '\0';
  T_PVKA.arr[1] = '\0';
  uVar3 = 0xff;
  bVar5 = ((ulong)puVar4 & 4) != 0;
  if (bVar5) {
    T_PVKA.arr[2] = '\0';
    T_PVKA.arr[3] = '\0';
    T_PVKA.arr[4] = '\0';
    T_PVKA.arr[5] = '\0';
    uVar3 = 0xfb;
    puVar4 = T_PVKA.arr + 6;
  }
  for (uVar2 = (ulong)(uVar3 >> 3); uVar2 != 0; uVar2 = uVar2 - 1) {
    puVar4[0] = '\0';
    puVar4[1] = '\0';
    puVar4[2] = '\0';
    puVar4[3] = '\0';
    puVar4[4] = '\0';
    puVar4[5] = '\0';
    puVar4[6] = '\0';
    puVar4[7] = '\0';
    puVar4 = puVar4 + (ulong)bVar6 * -0x10 + 8;
  }
  if (!bVar5) {
    puVar4[0] = '\0';
    puVar4[1] = '\0';
    puVar4[2] = '\0';
    puVar4[3] = '\0';
    puVar4 = puVar4 + 4;
  }
  puVar4[0] = '\0';
  puVar4[1] = '\0';
  puVar4[2] = '\0';
  T_PVKA.len = 0;
  T_PVKB.arr[0] = '\0';
  T_PVKB.arr[1] = '\0';
  uVar3 = 0xff;
  puVar4 = T_PVKB.arr + 2;
  bVar5 = ((ulong)puVar4 & 4) != 0;
  if (bVar5) {
    T_PVKB.arr[2] = '\0';
    T_PVKB.arr[3] = '\0';
    T_PVKB.arr[4] = '\0';
    T_PVKB.arr[5] = '\0';
    uVar3 = 0xfb;
    puVar4 = T_PVKB.arr + 6;
  }
  for (uVar2 = (ulong)(uVar3 >> 3); uVar2 != 0; uVar2 = uVar2 - 1) {
    puVar4[0] = '\0';
    puVar4[1] = '\0';
    puVar4[2] = '\0';
    puVar4[3] = '\0';
    puVar4[4] = '\0';
    puVar4[5] = '\0';
    puVar4[6] = '\0';
    puVar4[7] = '\0';
    puVar4 = puVar4 + (ulong)bVar6 * -0x10 + 8;
  }
  if (!bVar5) {
    puVar4[0] = '\0';
    puVar4[1] = '\0';
    puVar4[2] = '\0';
    puVar4[3] = '\0';
    puVar4 = puVar4 + 4;
  }
  puVar4[0] = '\0';
  puVar4[1] = '\0';
  puVar4[2] = '\0';
  T_LMK_ID.len = 0;
  T_Pan.len = 0x16;
  T_PVKB.len = 0;
  T_Pan.arr[0x14] = '\0';
  T_Pan.arr[0x15] = '\0';
  T_LMK_ID.arr[0] = '\0';
  T_LMK_ID.arr[1] = '\0';
  T_LMK_ID.arr[2] = '\0';
  T_LMK_ID.arr[3] = '\0';
  T_LMK_ID.arr[4] = '\0';
  T_LMK_ID.arr[5] = '\0';
  T_LMK_ID.arr[6] = '\0';
  T_LMK_ID.arr[7] = '\0';
  T_LMK_ID.arr[8] = '\0';
  T_LMK_ID.arr[9] = '\0';
  T_LMK_ID.arr[10] = '\0';
  T_LMK_ID.arr[0xb] = '\0';
  T_LMK_ID.arr[0xc] = '\0';
  T_Pan.arr[0] = '\0';
  T_Pan.arr[1] = '\0';
  T_Pan.arr[2] = '\0';
  T_Pan.arr[3] = '\0';
  T_Pan.arr[4] = '\0';
  T_Pan.arr[5] = '\0';
  T_Pan.arr[6] = '\0';
  T_Pan.arr[7] = '\0';
  T_Pan.arr[8] = '\0';
  T_Pan.arr[9] = '\0';
  T_Pan.arr[10] = '\0';
  T_Pan.arr[0xb] = '\0';
  T_Pan.arr[0xc] = '\0';
  T_Pan.arr[0xd] = '\0';
  T_Pan.arr[0xe] = '\0';
  T_Pan.arr[0xf] = '\0';
  T_Pan.arr[0x10] = '\0';
  T_Pan.arr[0x11] = '\0';
  T_Pan.arr[0x12] = '\0';
  T_Pan.arr[0x13] = '\0';
  T_Pan.arr[0x16] = '\0';
  T_PVKI = 0;
  __n = strlen(sPan);
  memcpy(T_Pan.arr,sPan,__n);
  T_Pan.len = (ushort)__n;
  T_PVKI = atoi(local_77c);
  sprintf(sLine,"PVKI=[%d]",(ulong)(uint)T_PVKI);
  trace_event(sLine,5);
  sqlstm.sqladtp = &sqladt;
  sqlstm.sqlety = 0x1100;
  sqlstm.sqadto[0] = 0;
  sqlstm.sqltdsp = &sqltds;
  sqlstm.sqtdso[0] = 0;
  sqlstm.sqadto[1] = 0;
  sqlstm.sqtdso[1] = 0;
  sqlstm.stmt = 
  "begin :response := PCRD_GET_HSM_KEY . GET_PVK_KEY_VERIF ( :T_Pan , :T_PVKI , :T_PVKA , :T_PVKB , :T_LMK_ID ) ; END ;"
  ;
  response = 0x38d;
  sqlstm.sqlvsn = 0xc;
  sqlstm.arrsiz = 6;
  sqlstm.cud = sqlcud0;
  sqlstm.sqhstv[0] = (uchar *)&response;
  sqlstm.iters = 1;
  sqlstm.offset = 0xa0;
  sqlstm.sqhstv[2] = (uchar *)&T_PVKI;
  sqlstm.occurs = 0;
  sqlstm.sqhstl[0] = 4;
  sqlstm.sqhsts[0] = 0;
  sqlstm.sqindv[0] = (short *)0x0;
  sqlstm.sqinds[0] = 0;
  sqlstm.sqharm[0] = 0;
  sqlstm.sqhstl[1] = 0x19;
  sqlstm.sqhsts[1] = 0;
  sqlstm.sqindv[1] = (short *)0x0;
  sqlstm.sqinds[1] = 0;
  sqlstm.sqharm[1] = 0;
  sqlstm.sqhstl[2] = 4;
  sqlstm.sqhsts[2] = 0;
  sqlstm.sqindv[2] = (short *)0x0;
  sqlstm.sqinds[2] = 0;
  sqlstm.sqharm[2] = 0;
  sqlstm.sqadto[2] = 0;
  sqlstm.sqadto[5] = 0;
  sqlstm.sqtdso[2] = 0;
  sqlstm.sqadto[3] = 0;
  sqlstm.sqtdso[5] = 0;
  sqlstm.sqtdso[3] = 0;
  sqlstm.sqadto[4] = 0;
  sqlstm.sqhstl[3] = 0x103;
  sqlstm.sqtdso[4] = 0;
  sqlstm.sqphsv = sqlstm.sqhstv;
  sqlstm.sqhsts[3] = 0;
  sqlstm.sqindv[3] = (short *)0x0;
  sqlstm.sqinds[3] = 0;
  sqlstm.sqphsl = sqlstm.sqhstl;
  sqlstm.sqharm[3] = 0;
  sqlstm.sqhstl[4] = 0x103;
  sqlstm.sqphss = sqlstm.sqhsts;
  sqlstm.sqhsts[4] = 0;
  sqlstm.sqindv[4] = (short *)0x0;
  sqlstm.sqinds[4] = 0;
  sqlstm.sqpind = sqlstm.sqindv;
  sqlstm.sqharm[4] = 0;
  sqlstm.sqhstl[5] = 0xf;
  sqlstm.sqpins = sqlstm.sqinds;
  sqlstm.sqhsts[5] = 0;
  sqlstm.sqindv[5] = (short *)0x0;
  sqlstm.sqinds[5] = 0;
  sqlstm.sqparm = sqlstm.sqharm;
  sqlstm.sqharm[5] = 0;
  sqlstm.sqparc = sqlstm.sqharc;
  sqlstm.sqpadto = sqlstm.sqadto;
  sqlstm.sqptdso = sqlstm.sqtdso;
  sqlstm.sqlest = (uchar *)&sqlca;
  sqlstm.sqhstv[1] = (uchar *)&T_Pan;
  sqlstm.sqhstv[3] = (uchar *)&T_PVKA;
  sqlstm.sqhstv[4] = (uchar *)&T_PVKB;
  sqlstm.sqhstv[5] = (uchar *)&T_LMK_ID;
  sqlcxt((long)nIndiceCtx * 0x10 + 0x713948,&sqlctx,&sqlstm,&sqlfpn);
  if (sqlca.sqlcode < 0) {
    strcpy(sLine,sqlca.sqlerrm.sqlerrmc);
    trace_event(sLine,1);
    trace_event("End  GetPVK(MALFUNCTION)",5);
    iVar1 = 3;
  }
  else if (response == 0) {
    memcpy(PVKA,T_PVKA.arr,(ulong)T_PVKA.len);
    memcpy(PVKB,T_PVKB.arr,(ulong)T_PVKB.len);
    if (debug_option == 1) {
      sprintf(sLine,"End   GetPVK(%.16s,%.16s)",PVKA,PVKB);
    }
    else {
      builtin_strncpy(sLine,"End   GetPVK(OK)",0x11);
    }
    trace_event(sLine,5);
    iVar1 = 0;
  }
  else {
    trace_event("End   GetPVK(NOK)",5);
    iVar1 = -1;
  }
  return iVar1;
}



// WARNING: Unknown calling convention

int GetZMK(int nIndiceCtx,char *resource_id,char *ZmK)

{
  int iVar1;
  ulong uVar2;
  uchar *puVar3;
  uint uVar4;
  bool bVar5;
  byte bVar6;
  uchar auStack_2564 [7976];
  int response;
  char T_resource_id [7];
  sqlca sqlca;
  anon_struct_260_2_43c7b5cf T_ZmK;
  char sLine [512];
  sqlexd_conflict8 sqlstm;
  
  bVar6 = 0;
  sprintf(sLine,"Start GetZMK (%.6s)",resource_id);
  trace_event(sLine,5);
  puVar3 = T_ZmK.arr + 2;
  uVar4 = 0xff;
  T_ZmK.arr[0] = '\0';
  T_ZmK.arr[1] = '\0';
  bVar5 = ((ulong)puVar3 & 4) != 0;
  if (bVar5) {
    T_ZmK.arr[2] = '\0';
    T_ZmK.arr[3] = '\0';
    T_ZmK.arr[4] = '\0';
    T_ZmK.arr[5] = '\0';
    uVar4 = 0xfb;
    puVar3 = T_ZmK.arr + 6;
  }
  for (uVar2 = (ulong)(uVar4 >> 3); uVar2 != 0; uVar2 = uVar2 - 1) {
    puVar3[0] = '\0';
    puVar3[1] = '\0';
    puVar3[2] = '\0';
    puVar3[3] = '\0';
    puVar3[4] = '\0';
    puVar3[5] = '\0';
    puVar3[6] = '\0';
    puVar3[7] = '\0';
    puVar3 = puVar3 + (ulong)bVar6 * -0x10 + 8;
  }
  if (!bVar5) {
    puVar3[0] = '\0';
    puVar3[1] = '\0';
    puVar3[2] = '\0';
    puVar3[3] = '\0';
    puVar3 = puVar3 + 4;
  }
  puVar3[0] = '\0';
  puVar3[1] = '\0';
  puVar3[2] = '\0';
  T_resource_id._0_4_ = *(undefined4 *)resource_id;
  T_resource_id[6] = '\0';
  T_ZmK.len = 0;
  T_resource_id._4_2_ = *(undefined2 *)(resource_id + 4);
  sprintf(sLine,"GET_ZMK_KEY (%.6s)",T_resource_id);
  trace_event(sLine,5);
  sqlstm.sqphsv = sqlstm.sqhstv;
  sqlstm.sqladtp = &sqladt;
  sqlstm.sqlety = 0x1100;
  sqlstm.sqadto[0] = 0;
  sqlstm.sqltdsp = &sqltds;
  sqlstm.sqtdso[0] = 0;
  sqlstm.sqadto[1] = 0;
  sqlstm.stmt = 
  "begin :response := PCRD_GET_HSM_KEY . GET_ZMK_KEY ( :T_resource_id , :T_ZmK ) ; END ;";
  sqlstm.sqtdso[1] = 0;
  response = 0x38d;
  sqlstm.sqlvsn = 0xc;
  sqlstm.cud = sqlcud0;
  sqlstm.sqhstv[0] = (uchar *)&response;
  sqlstm.arrsiz = 6;
  sqlstm.iters = 1;
  sqlstm.offset = 199;
  sqlstm.occurs = 0;
  sqlstm.sqhstl[0] = 4;
  sqlstm.sqhsts[0] = 0;
  sqlstm.sqindv[0] = (short *)0x0;
  sqlstm.sqinds[0] = 0;
  sqlstm.sqharm[0] = 0;
  sqlstm.sqhstl[1] = 7;
  sqlstm.sqhsts[1] = 0;
  sqlstm.sqindv[1] = (short *)0x0;
  sqlstm.sqinds[1] = 0;
  sqlstm.sqharm[1] = 0;
  sqlstm.sqhstl[2] = 0x103;
  sqlstm.sqhsts[2] = 0;
  sqlstm.sqindv[2] = (short *)0x0;
  sqlstm.sqinds[2] = 0;
  sqlstm.sqharm[2] = 0;
  sqlstm.sqphsl = sqlstm.sqhstl;
  sqlstm.sqadto[2] = 0;
  sqlstm.sqphss = sqlstm.sqhsts;
  sqlstm.sqtdso[2] = 0;
  sqlstm.sqpind = sqlstm.sqindv;
  sqlstm.sqpins = sqlstm.sqinds;
  sqlstm.sqparm = sqlstm.sqharm;
  sqlstm.sqparc = sqlstm.sqharc;
  sqlstm.sqpadto = sqlstm.sqadto;
  sqlstm.sqptdso = sqlstm.sqtdso;
  sqlstm.sqlest = (uchar *)&sqlca;
  sqlstm.sqhstv[1] = (uchar *)T_resource_id;
  sqlstm.sqhstv[2] = (uchar *)&T_ZmK;
  sqlcxt((long)nIndiceCtx * 0x10 + 0x713948,&sqlctx,&sqlstm,&sqlfpn);
  if (sqlca.sqlcode < 0) {
    strcpy(sLine,sqlca.sqlerrm.sqlerrmc);
    trace_event(sLine,1);
    trace_event("End  GetZMK(MALFUNCTION)",5);
    iVar1 = 3;
  }
  else {
    sprintf(sLine,"response :  (%d)",(ulong)(uint)response);
    trace_event(sLine,5);
    if (response == 0) {
      memcpy(ZmK,T_ZmK.arr,(ulong)T_ZmK.len);
      if (debug_option == 1) {
        sprintf(sLine,"End   GetZMK (%.256s)",ZmK);
      }
      else {
        builtin_strncpy(sLine,"End   GetZMK (OK)",0x12);
      }
      trace_event(sLine,5);
      iVar1 = 0;
    }
    else {
      trace_event("End   GetZMK (NOK)",5);
      iVar1 = -1;
    }
  }
  return iVar1;
}



// WARNING: Unknown calling convention

int SetAWK(int nIndiceCtx,char *resource_id,char *AwK,char *Check_value)

{
  int iVar1;
  size_t sVar2;
  ulong uVar3;
  uchar *puVar4;
  uint uVar5;
  bool bVar6;
  byte bVar7;
  uchar auStack_2564 [7944];
  int response;
  char T_resource_id [7];
  anon_struct_20_2_43c7b5cf T_check_value;
  sqlca sqlca;
  anon_struct_260_2_43c7b5cf T_AwK;
  char sLine [512];
  sqlexd_conflict8 sqlstm;
  
  bVar7 = 0;
  if (debug_option == 1) {
    sprintf(sLine,"Start SetAWK(%.6s, %.48s, %.16s)",resource_id,AwK);
  }
  else {
    sprintf(sLine,"Start set_AwK(%.6s)",resource_id);
  }
  trace_event(sLine,5);
  puVar4 = T_AwK.arr + 2;
  uVar5 = 0xff;
  T_AwK.arr[0] = '\0';
  T_AwK.arr[1] = '\0';
  bVar6 = ((ulong)puVar4 & 4) != 0;
  if (bVar6) {
    T_AwK.arr[2] = '\0';
    T_AwK.arr[3] = '\0';
    T_AwK.arr[4] = '\0';
    T_AwK.arr[5] = '\0';
    uVar5 = 0xfb;
    puVar4 = T_AwK.arr + 6;
  }
  for (uVar3 = (ulong)(uVar5 >> 3); uVar3 != 0; uVar3 = uVar3 - 1) {
    puVar4[0] = '\0';
    puVar4[1] = '\0';
    puVar4[2] = '\0';
    puVar4[3] = '\0';
    puVar4[4] = '\0';
    puVar4[5] = '\0';
    puVar4[6] = '\0';
    puVar4[7] = '\0';
    puVar4 = puVar4 + (ulong)bVar7 * -0x10 + 8;
  }
  if (!bVar6) {
    puVar4[0] = '\0';
    puVar4[1] = '\0';
    puVar4[2] = '\0';
    puVar4[3] = '\0';
    puVar4 = puVar4 + 4;
  }
  puVar4[0] = '\0';
  puVar4[1] = '\0';
  puVar4[2] = '\0';
  T_resource_id._0_4_ = *(undefined4 *)resource_id;
  T_resource_id[6] = '\0';
  T_resource_id._4_2_ = *(undefined2 *)(resource_id + 4);
  T_check_value.len = 0x10;
  T_AwK.len = 0;
  T_check_value.arr[0] = '\0';
  T_check_value.arr[1] = '\0';
  T_check_value.arr[2] = '\0';
  T_check_value.arr[3] = '\0';
  T_check_value.arr[4] = '\0';
  T_check_value.arr[5] = '\0';
  T_check_value.arr[6] = '\0';
  T_check_value.arr[7] = '\0';
  T_check_value.arr[8] = '\0';
  T_check_value.arr[9] = '\0';
  T_check_value.arr[10] = '\0';
  T_check_value.arr[0xb] = '\0';
  T_check_value.arr[0xc] = '\0';
  T_check_value.arr[0xd] = '\0';
  T_check_value.arr[0xe] = '\0';
  T_check_value.arr[0xf] = '\0';
  T_check_value.arr[0x10] = '\0';
  sVar2 = strlen(AwK);
  memcpy(T_AwK.arr,AwK,sVar2);
  T_AwK.len = (ushort)sVar2;
  sVar2 = strlen(Check_value);
  memcpy(T_check_value.arr,Check_value,sVar2);
  sqlstm.sqladtp = &sqladt;
  T_check_value.len = (ushort)sVar2;
  sqlstm.sqltdsp = &sqltds;
  sqlstm.sqlety = 0x1100;
  sqlstm.sqadto[0] = 0;
  sqlstm.sqtdso[0] = 0;
  sqlstm.stmt = 
  "begin :response := PCRD_GET_HSM_KEY . SET_AWK_KEY ( :T_resource_id , :T_AwK , :T_check_value ) ; END ;"
  ;
  sqlstm.sqadto[1] = 0;
  sqlstm.sqtdso[1] = 0;
  sqlstm.cud = sqlcud0;
  sqlstm.sqhstv[0] = (uchar *)&response;
  response = 0x38d;
  sqlstm.sqlvsn = 0xc;
  sqlstm.arrsiz = 6;
  sqlstm.sqphsv = sqlstm.sqhstv;
  sqlstm.iters = 1;
  sqlstm.offset = 0xe2;
  sqlstm.occurs = 0;
  sqlstm.sqhstl[0] = 4;
  sqlstm.sqhsts[0] = 0;
  sqlstm.sqindv[0] = (short *)0x0;
  sqlstm.sqinds[0] = 0;
  sqlstm.sqharm[0] = 0;
  sqlstm.sqhstl[1] = 7;
  sqlstm.sqhsts[1] = 0;
  sqlstm.sqindv[1] = (short *)0x0;
  sqlstm.sqinds[1] = 0;
  sqlstm.sqharm[1] = 0;
  sqlstm.sqhstl[2] = 0x103;
  sqlstm.sqhsts[2] = 0;
  sqlstm.sqindv[2] = (short *)0x0;
  sqlstm.sqphsl = sqlstm.sqhstl;
  sqlstm.sqinds[2] = 0;
  sqlstm.sqharm[2] = 0;
  sqlstm.sqadto[2] = 0;
  sqlstm.sqphss = sqlstm.sqhsts;
  sqlstm.sqtdso[2] = 0;
  sqlstm.sqhstl[3] = 0x13;
  sqlstm.sqpind = sqlstm.sqindv;
  sqlstm.sqhsts[3] = 0;
  sqlstm.sqindv[3] = (short *)0x0;
  sqlstm.sqinds[3] = 0;
  sqlstm.sqpins = sqlstm.sqinds;
  sqlstm.sqharm[3] = 0;
  sqlstm.sqadto[3] = 0;
  sqlstm.sqtdso[3] = 0;
  sqlstm.sqparm = sqlstm.sqharm;
  sqlstm.sqparc = sqlstm.sqharc;
  sqlstm.sqpadto = sqlstm.sqadto;
  sqlstm.sqptdso = sqlstm.sqtdso;
  sqlstm.sqlest = (uchar *)&sqlca;
  sqlstm.sqhstv[1] = (uchar *)T_resource_id;
  sqlstm.sqhstv[2] = (uchar *)&T_AwK;
  sqlstm.sqhstv[3] = (uchar *)&T_check_value;
  sqlcxt((long)nIndiceCtx * 0x10 + 0x713948,&sqlctx,&sqlstm,&sqlfpn);
  if (sqlca.sqlcode < 0) {
    strcpy(sLine,sqlca.sqlerrm.sqlerrmc);
    trace_event(sLine,1);
    trace_event("End  SetAWK (MALFUNCTION)",5);
    iVar1 = 3;
  }
  else if (response == 0) {
    trace_event("End   SetAWK(OK)",5);
    iVar1 = 0;
  }
  else {
    trace_event("End   SetAWK(NOK)",5);
    iVar1 = -1;
  }
  return iVar1;
}



// WARNING: Unknown calling convention

int SetIWK(int nIndiceCtx,char *resource_id,char *IwK,char *Check_value)

{
  int iVar1;
  size_t sVar2;
  ulong uVar3;
  uchar *puVar4;
  uint uVar5;
  bool bVar6;
  byte bVar7;
  uchar auStack_2564 [7944];
  int response;
  char T_resource_id [7];
  anon_struct_20_2_43c7b5cf T_check_value;
  sqlca sqlca;
  anon_struct_260_2_43c7b5cf T_IwK;
  char sLine [512];
  sqlexd_conflict8 sqlstm;
  
  bVar7 = 0;
  if (debug_option == 1) {
    sprintf(sLine,"Start set_IwK(%.6s, \n %.256s, \n %.16s)",resource_id,IwK);
  }
  else {
    sprintf(sLine,"Start set_IwK(%.6s)",resource_id);
  }
  trace_event(sLine,5);
  puVar4 = T_IwK.arr + 2;
  uVar5 = 0xff;
  T_IwK.arr[0] = '\0';
  T_IwK.arr[1] = '\0';
  bVar6 = ((ulong)puVar4 & 4) != 0;
  if (bVar6) {
    T_IwK.arr[2] = '\0';
    T_IwK.arr[3] = '\0';
    T_IwK.arr[4] = '\0';
    T_IwK.arr[5] = '\0';
    uVar5 = 0xfb;
    puVar4 = T_IwK.arr + 6;
  }
  for (uVar3 = (ulong)(uVar5 >> 3); uVar3 != 0; uVar3 = uVar3 - 1) {
    puVar4[0] = '\0';
    puVar4[1] = '\0';
    puVar4[2] = '\0';
    puVar4[3] = '\0';
    puVar4[4] = '\0';
    puVar4[5] = '\0';
    puVar4[6] = '\0';
    puVar4[7] = '\0';
    puVar4 = puVar4 + (ulong)bVar7 * -0x10 + 8;
  }
  if (!bVar6) {
    puVar4[0] = '\0';
    puVar4[1] = '\0';
    puVar4[2] = '\0';
    puVar4[3] = '\0';
    puVar4 = puVar4 + 4;
  }
  puVar4[0] = '\0';
  puVar4[1] = '\0';
  puVar4[2] = '\0';
  T_resource_id._0_4_ = *(undefined4 *)resource_id;
  T_resource_id[6] = '\0';
  T_resource_id._4_2_ = *(undefined2 *)(resource_id + 4);
  T_check_value.len = 0x10;
  T_check_value.arr[0] = '\0';
  T_check_value.arr[1] = '\0';
  T_check_value.arr[2] = '\0';
  T_check_value.arr[3] = '\0';
  T_check_value.arr[4] = '\0';
  T_check_value.arr[5] = '\0';
  T_check_value.arr[6] = '\0';
  T_check_value.arr[7] = '\0';
  T_check_value.arr[8] = '\0';
  T_check_value.arr[9] = '\0';
  T_check_value.arr[10] = '\0';
  T_check_value.arr[0xb] = '\0';
  T_check_value.arr[0xc] = '\0';
  T_check_value.arr[0xd] = '\0';
  T_check_value.arr[0xe] = '\0';
  T_check_value.arr[0xf] = '\0';
  T_check_value.arr[0x10] = '\0';
  sVar2 = strlen(IwK);
  memcpy(T_IwK.arr,IwK,sVar2);
  T_IwK.len = (ushort)sVar2;
  sVar2 = strlen(Check_value);
  memcpy(T_check_value.arr,Check_value,sVar2);
  sqlstm.sqladtp = &sqladt;
  T_check_value.len = (ushort)sVar2;
  sqlstm.sqltdsp = &sqltds;
  sqlstm.sqlety = 0x1100;
  sqlstm.sqadto[0] = 0;
  sqlstm.sqtdso[0] = 0;
  sqlstm.stmt = 
  "begin :response := PCRD_GET_HSM_KEY . SET_IWK_KEY ( :T_resource_id , :T_IwK , :T_check_value ) ; END ;"
  ;
  sqlstm.sqadto[1] = 0;
  sqlstm.sqtdso[1] = 0;
  response = 0x38d;
  sqlstm.cud = sqlcud0;
  sqlstm.sqhstv[0] = (uchar *)&response;
  sqlstm.sqlvsn = 0xc;
  sqlstm.arrsiz = 6;
  sqlstm.iters = 1;
  sqlstm.sqphsv = sqlstm.sqhstv;
  sqlstm.offset = 0x101;
  sqlstm.occurs = 0;
  sqlstm.sqhstl[0] = 4;
  sqlstm.sqhsts[0] = 0;
  sqlstm.sqindv[0] = (short *)0x0;
  sqlstm.sqinds[0] = 0;
  sqlstm.sqharm[0] = 0;
  sqlstm.sqhstl[1] = 7;
  sqlstm.sqhsts[1] = 0;
  sqlstm.sqindv[1] = (short *)0x0;
  sqlstm.sqinds[1] = 0;
  sqlstm.sqharm[1] = 0;
  sqlstm.sqhstl[2] = 0x103;
  sqlstm.sqhsts[2] = 0;
  sqlstm.sqindv[2] = (short *)0x0;
  sqlstm.sqphsl = sqlstm.sqhstl;
  sqlstm.sqinds[2] = 0;
  sqlstm.sqharm[2] = 0;
  sqlstm.sqphss = sqlstm.sqhsts;
  sqlstm.sqadto[2] = 0;
  sqlstm.sqtdso[2] = 0;
  sqlstm.sqhstl[3] = 0x13;
  sqlstm.sqpind = sqlstm.sqindv;
  sqlstm.sqhsts[3] = 0;
  sqlstm.sqindv[3] = (short *)0x0;
  sqlstm.sqinds[3] = 0;
  sqlstm.sqpins = sqlstm.sqinds;
  sqlstm.sqharm[3] = 0;
  sqlstm.sqadto[3] = 0;
  sqlstm.sqtdso[3] = 0;
  sqlstm.sqparm = sqlstm.sqharm;
  sqlstm.sqparc = sqlstm.sqharc;
  sqlstm.sqpadto = sqlstm.sqadto;
  sqlstm.sqptdso = sqlstm.sqtdso;
  sqlstm.sqlest = (uchar *)&sqlca;
  sqlstm.sqhstv[1] = (uchar *)T_resource_id;
  sqlstm.sqhstv[2] = (uchar *)&T_IwK;
  sqlstm.sqhstv[3] = (uchar *)&T_check_value;
  sqlcxt((long)nIndiceCtx * 0x10 + 0x713948,&sqlctx,&sqlstm,&sqlfpn);
  if (sqlca.sqlcode < 0) {
    strcpy(sLine,sqlca.sqlerrm.sqlerrmc);
    trace_event(sLine,1);
    trace_event("End  SetIWK (MALFUNCTION)",5);
    iVar1 = 3;
  }
  else if (response == 0) {
    trace_event("End   SetIWK(OK)",5);
    iVar1 = 0;
  }
  else {
    trace_event("End   SetIWK(NOK)",5);
    iVar1 = -1;
  }
  return iVar1;
}



// WARNING: Unknown calling convention

int GetAWK(int nIndiceCtx,char *resource_id,char *AwK)

{
  int iVar1;
  ulong uVar2;
  uchar *puVar3;
  uint uVar4;
  bool bVar5;
  byte bVar6;
  uchar auStack_2554 [7976];
  int response;
  char T_resource_id [7];
  sqlca sqlca;
  anon_struct_260_2_43c7b5cf T_AwK;
  char sLine [512];
  sqlexd_conflict8 sqlstm;
  
  bVar6 = 0;
  sprintf(sLine,"Start GetAWK(%.6s)",resource_id);
  trace_event(sLine,5);
  puVar3 = T_AwK.arr + 2;
  uVar4 = 0xff;
  T_AwK.arr[0] = '\0';
  T_AwK.arr[1] = '\0';
  bVar5 = ((ulong)puVar3 & 4) != 0;
  if (bVar5) {
    T_AwK.arr[2] = '\0';
    T_AwK.arr[3] = '\0';
    T_AwK.arr[4] = '\0';
    T_AwK.arr[5] = '\0';
    uVar4 = 0xfb;
    puVar3 = T_AwK.arr + 6;
  }
  for (uVar2 = (ulong)(uVar4 >> 3); uVar2 != 0; uVar2 = uVar2 - 1) {
    puVar3[0] = '\0';
    puVar3[1] = '\0';
    puVar3[2] = '\0';
    puVar3[3] = '\0';
    puVar3[4] = '\0';
    puVar3[5] = '\0';
    puVar3[6] = '\0';
    puVar3[7] = '\0';
    puVar3 = puVar3 + (ulong)bVar6 * -0x10 + 8;
  }
  if (!bVar5) {
    puVar3[0] = '\0';
    puVar3[1] = '\0';
    puVar3[2] = '\0';
    puVar3[3] = '\0';
    puVar3 = puVar3 + 4;
  }
  puVar3[0] = '\0';
  puVar3[1] = '\0';
  puVar3[2] = '\0';
  T_AwK.len = 0;
  T_resource_id._0_4_ = *(undefined4 *)resource_id;
  sqlstm.sqhstv[1] = (uchar *)T_resource_id;
  sqlstm.sqladtp = &sqladt;
  sqlstm.stmt = 
  "begin :response := PCRD_GET_HSM_KEY . GET_AWK_KEY ( :T_resource_id , :T_AwK ) ; END ;";
  T_resource_id._4_2_ = *(undefined2 *)(resource_id + 4);
  sqlstm.sqlest = (uchar *)&sqlca;
  sqlstm.sqltdsp = &sqltds;
  sqlstm.sqlety = 0x1100;
  sqlstm.sqtdso[0] = 0;
  sqlstm.cud = sqlcud0;
  sqlstm.sqhstv[0] = (uchar *)&response;
  sqlstm.sqadto[0] = 0;
  sqlstm.sqadto[1] = 0;
  T_resource_id[6] = '\0';
  sqlstm.sqphsv = sqlstm.sqhstv;
  response = 0x38d;
  sqlstm.sqlvsn = 0xc;
  sqlstm.arrsiz = 6;
  sqlstm.iters = 1;
  sqlstm.offset = 0x120;
  sqlstm.occurs = 0;
  sqlstm.sqhstl[0] = 4;
  sqlstm.sqhsts[0] = 0;
  sqlstm.sqindv[0] = (short *)0x0;
  sqlstm.sqinds[0] = 0;
  sqlstm.sqharm[0] = 0;
  sqlstm.sqhstl[1] = 7;
  sqlstm.sqhsts[1] = 0;
  sqlstm.sqindv[1] = (short *)0x0;
  sqlstm.sqinds[1] = 0;
  sqlstm.sqharm[1] = 0;
  sqlstm.sqtdso[1] = 0;
  sqlstm.sqphsl = sqlstm.sqhstl;
  sqlstm.sqphss = sqlstm.sqhsts;
  sqlstm.sqhstl[2] = 0x103;
  sqlstm.sqhsts[2] = 0;
  sqlstm.sqindv[2] = (short *)0x0;
  sqlstm.sqpind = sqlstm.sqindv;
  sqlstm.sqinds[2] = 0;
  sqlstm.sqharm[2] = 0;
  sqlstm.sqpins = sqlstm.sqinds;
  sqlstm.sqadto[2] = 0;
  sqlstm.sqtdso[2] = 0;
  sqlstm.sqparm = sqlstm.sqharm;
  sqlstm.sqparc = sqlstm.sqharc;
  sqlstm.sqpadto = sqlstm.sqadto;
  sqlstm.sqptdso = sqlstm.sqtdso;
  sqlstm.sqhstv[2] = (uchar *)&T_AwK;
  sqlcxt((long)nIndiceCtx * 0x10 + 0x713948,&sqlctx,&sqlstm,&sqlfpn);
  if (-1 < sqlca.sqlcode) {
    if (response == 0) {
      memcpy(AwK,T_AwK.arr,(ulong)T_AwK.len);
      if (debug_option == 1) {
        sprintf(sLine,"End   GetAWK(%.256s)",AwK);
      }
      else {
        builtin_strncpy(sLine,"End   GetAWK(OK)",0x11);
      }
      trace_event(sLine,5);
      iVar1 = 0;
    }
    else {
      trace_event("End   GetAWK(NOK)",5);
      iVar1 = -1;
    }
    return iVar1;
  }
  strcpy(sLine,sqlca.sqlerrm.sqlerrmc);
  trace_event(sLine,1);
  trace_event("End  GetAWK (MALFUNCTION)",5);
  return 3;
}



// WARNING: Unknown calling convention

int GetIWK(int nIndiceCtx,char *resource_id,char *IwK)

{
  int iVar1;
  ulong uVar2;
  uchar *puVar3;
  uint uVar4;
  bool bVar5;
  byte bVar6;
  uchar auStack_2554 [7976];
  int response;
  char T_resource_id [7];
  sqlca sqlca;
  anon_struct_260_2_43c7b5cf T_IwK;
  char sLine [512];
  sqlexd_conflict8 sqlstm;
  
  bVar6 = 0;
  sprintf(sLine,"Start GetIWK(%.6s)",resource_id);
  trace_event(sLine,5);
  puVar3 = T_IwK.arr + 2;
  uVar4 = 0xff;
  T_IwK.arr[0] = '\0';
  T_IwK.arr[1] = '\0';
  bVar5 = ((ulong)puVar3 & 4) != 0;
  if (bVar5) {
    T_IwK.arr[2] = '\0';
    T_IwK.arr[3] = '\0';
    T_IwK.arr[4] = '\0';
    T_IwK.arr[5] = '\0';
    uVar4 = 0xfb;
    puVar3 = T_IwK.arr + 6;
  }
  for (uVar2 = (ulong)(uVar4 >> 3); uVar2 != 0; uVar2 = uVar2 - 1) {
    puVar3[0] = '\0';
    puVar3[1] = '\0';
    puVar3[2] = '\0';
    puVar3[3] = '\0';
    puVar3[4] = '\0';
    puVar3[5] = '\0';
    puVar3[6] = '\0';
    puVar3[7] = '\0';
    puVar3 = puVar3 + (ulong)bVar6 * -0x10 + 8;
  }
  if (!bVar5) {
    puVar3[0] = '\0';
    puVar3[1] = '\0';
    puVar3[2] = '\0';
    puVar3[3] = '\0';
    puVar3 = puVar3 + 4;
  }
  puVar3[0] = '\0';
  puVar3[1] = '\0';
  puVar3[2] = '\0';
  T_IwK.len = 0;
  T_resource_id._0_4_ = *(undefined4 *)resource_id;
  sqlstm.sqhstv[1] = (uchar *)T_resource_id;
  sqlstm.sqladtp = &sqladt;
  sqlstm.stmt = 
  "begin :response := PCRD_GET_HSM_KEY . GET_IWK_KEY ( :T_resource_id , :T_IwK ) ; END ;";
  T_resource_id._4_2_ = *(undefined2 *)(resource_id + 4);
  sqlstm.sqlest = (uchar *)&sqlca;
  sqlstm.sqltdsp = &sqltds;
  sqlstm.sqlety = 0x1100;
  sqlstm.sqtdso[0] = 0;
  sqlstm.cud = sqlcud0;
  sqlstm.sqhstv[0] = (uchar *)&response;
  sqlstm.sqadto[0] = 0;
  sqlstm.sqadto[1] = 0;
  T_resource_id[6] = '\0';
  sqlstm.sqphsv = sqlstm.sqhstv;
  response = 0x38d;
  sqlstm.sqlvsn = 0xc;
  sqlstm.arrsiz = 6;
  sqlstm.iters = 1;
  sqlstm.offset = 0x13b;
  sqlstm.occurs = 0;
  sqlstm.sqhstl[0] = 4;
  sqlstm.sqhsts[0] = 0;
  sqlstm.sqindv[0] = (short *)0x0;
  sqlstm.sqinds[0] = 0;
  sqlstm.sqharm[0] = 0;
  sqlstm.sqhstl[1] = 7;
  sqlstm.sqhsts[1] = 0;
  sqlstm.sqindv[1] = (short *)0x0;
  sqlstm.sqinds[1] = 0;
  sqlstm.sqharm[1] = 0;
  sqlstm.sqtdso[1] = 0;
  sqlstm.sqphsl = sqlstm.sqhstl;
  sqlstm.sqphss = sqlstm.sqhsts;
  sqlstm.sqhstl[2] = 0x103;
  sqlstm.sqhsts[2] = 0;
  sqlstm.sqindv[2] = (short *)0x0;
  sqlstm.sqpind = sqlstm.sqindv;
  sqlstm.sqinds[2] = 0;
  sqlstm.sqharm[2] = 0;
  sqlstm.sqpins = sqlstm.sqinds;
  sqlstm.sqadto[2] = 0;
  sqlstm.sqtdso[2] = 0;
  sqlstm.sqparm = sqlstm.sqharm;
  sqlstm.sqparc = sqlstm.sqharc;
  sqlstm.sqpadto = sqlstm.sqadto;
  sqlstm.sqptdso = sqlstm.sqtdso;
  sqlstm.sqhstv[2] = (uchar *)&T_IwK;
  sqlcxt((long)nIndiceCtx * 0x10 + 0x713948,&sqlctx,&sqlstm,&sqlfpn);
  if (-1 < sqlca.sqlcode) {
    if (response == 0) {
      memcpy(IwK,T_IwK.arr,(ulong)T_IwK.len);
      if (debug_option == 1) {
        sprintf(sLine,"End   GetIWK(%.256s)",IwK);
      }
      else {
        builtin_strncpy(sLine,"End   GetIWK(OK)",0x11);
      }
      trace_event(sLine,5);
      iVar1 = 0;
    }
    else {
      trace_event("End   GetIWK(NOK)",5);
      iVar1 = -1;
    }
    return iVar1;
  }
  strcpy(sLine,sqlca.sqlerrm.sqlerrmc);
  trace_event(sLine,1);
  trace_event("End  GetIWK (MALFUNCTION)",5);
  return 3;
}



// WARNING: Unknown calling convention

int GetTPK(int nIndiceCtx,char *terminal_nbr,char *TPK1,char *TPK2)

{
  int iVar1;
  size_t __n;
  ulong uVar2;
  uint uVar3;
  uchar *puVar4;
  bool bVar5;
  byte bVar6;
  uchar auStack_2674 [272];
  uchar auStack_2564 [7688];
  int response;
  anon_struct_18_2_43c7b5cf T_terminal_nbr;
  sqlca sqlca;
  anon_struct_260_2_43c7b5cf T_TPK1;
  anon_struct_260_2_43c7b5cf T_TPK2;
  char sLine [512];
  sqlexd_conflict8 sqlstm;
  
  bVar6 = 0;
  sprintf(sLine,"Start GetTPK(%.15s)",terminal_nbr);
  trace_event(sLine,5);
  puVar4 = T_TPK1.arr + 2;
  T_TPK1.arr[0] = '\0';
  T_TPK1.arr[1] = '\0';
  uVar3 = 0xff;
  bVar5 = ((ulong)puVar4 & 4) != 0;
  if (bVar5) {
    T_TPK1.arr[2] = '\0';
    T_TPK1.arr[3] = '\0';
    T_TPK1.arr[4] = '\0';
    T_TPK1.arr[5] = '\0';
    uVar3 = 0xfb;
    puVar4 = T_TPK1.arr + 6;
  }
  for (uVar2 = (ulong)(uVar3 >> 3); uVar2 != 0; uVar2 = uVar2 - 1) {
    puVar4[0] = '\0';
    puVar4[1] = '\0';
    puVar4[2] = '\0';
    puVar4[3] = '\0';
    puVar4[4] = '\0';
    puVar4[5] = '\0';
    puVar4[6] = '\0';
    puVar4[7] = '\0';
    puVar4 = puVar4 + (ulong)bVar6 * -0x10 + 8;
  }
  if (!bVar5) {
    puVar4[0] = '\0';
    puVar4[1] = '\0';
    puVar4[2] = '\0';
    puVar4[3] = '\0';
    puVar4 = puVar4 + 4;
  }
  puVar4[0] = '\0';
  puVar4[1] = '\0';
  puVar4[2] = '\0';
  uVar3 = 0xff;
  T_TPK1.len = 0;
  puVar4 = T_TPK2.arr + 2;
  T_TPK2.arr[0] = '\0';
  T_TPK2.arr[1] = '\0';
  bVar5 = ((ulong)puVar4 & 4) != 0;
  if (bVar5) {
    T_TPK2.arr[2] = '\0';
    T_TPK2.arr[3] = '\0';
    T_TPK2.arr[4] = '\0';
    T_TPK2.arr[5] = '\0';
    uVar3 = 0xfb;
    puVar4 = T_TPK2.arr + 6;
  }
  for (uVar2 = (ulong)(uVar3 >> 3); uVar2 != 0; uVar2 = uVar2 - 1) {
    puVar4[0] = '\0';
    puVar4[1] = '\0';
    puVar4[2] = '\0';
    puVar4[3] = '\0';
    puVar4[4] = '\0';
    puVar4[5] = '\0';
    puVar4[6] = '\0';
    puVar4[7] = '\0';
    puVar4 = puVar4 + (ulong)bVar6 * -0x10 + 8;
  }
  if (!bVar5) {
    puVar4[0] = '\0';
    puVar4[1] = '\0';
    puVar4[2] = '\0';
    puVar4[3] = '\0';
    puVar4 = puVar4 + 4;
  }
  puVar4[0] = '\0';
  puVar4[1] = '\0';
  puVar4[2] = '\0';
  T_TPK2.len = 0;
  T_terminal_nbr.arr[0] = '\0';
  T_terminal_nbr.arr[1] = '\0';
  T_terminal_nbr.arr[2] = '\0';
  T_terminal_nbr.arr[3] = '\0';
  T_terminal_nbr.arr[4] = '\0';
  T_terminal_nbr.arr[5] = '\0';
  T_terminal_nbr.arr[6] = '\0';
  T_terminal_nbr.arr[7] = '\0';
  T_terminal_nbr.arr[8] = '\0';
  T_terminal_nbr.arr[9] = '\0';
  T_terminal_nbr.arr[10] = '\0';
  T_terminal_nbr.arr[0xb] = '\0';
  T_terminal_nbr.arr[0xc] = '\0';
  T_terminal_nbr.arr[0xd] = '\0';
  T_terminal_nbr.arr[0xe] = '\0';
  T_terminal_nbr.arr[0xf] = '\0';
  __n = strlen(terminal_nbr);
  memcpy(T_terminal_nbr.arr,terminal_nbr,__n);
  sqlstm.sqladtp = &sqladt;
  T_terminal_nbr.len = (ushort)__n;
  sqlstm.sqlety = 0x1100;
  sqlstm.sqltdsp = &sqltds;
  sqlstm.sqadto[0] = 0;
  sqlstm.sqtdso[0] = 0;
  sqlstm.stmt = 
  "begin :response := PCRD_GET_HSM_KEY . GET_TPK_KEY ( :T_terminal_nbr , :T_TPK1 , :T_TPK2 ) ; END ;"
  ;
  sqlstm.sqadto[1] = 0;
  sqlstm.sqtdso[1] = 0;
  response = 3;
  sqlstm.cud = sqlcud0;
  sqlstm.sqhstv[0] = (uchar *)&response;
  sqlstm.sqlvsn = 0xc;
  sqlstm.arrsiz = 6;
  sqlstm.iters = 1;
  sqlstm.offset = 0x156;
  sqlstm.occurs = 0;
  sqlstm.sqhstl[0] = 4;
  sqlstm.sqhsts[0] = 0;
  sqlstm.sqindv[0] = (short *)0x0;
  sqlstm.sqinds[0] = 0;
  sqlstm.sqharm[0] = 0;
  sqlstm.sqhstl[1] = 0x12;
  sqlstm.sqhsts[1] = 0;
  sqlstm.sqindv[1] = (short *)0x0;
  sqlstm.sqinds[1] = 0;
  sqlstm.sqharm[1] = 0;
  sqlstm.sqhstl[2] = 0x103;
  sqlstm.sqhsts[2] = 0;
  sqlstm.sqindv[2] = (short *)0x0;
  sqlstm.sqinds[2] = 0;
  sqlstm.sqtdso[3] = 0;
  sqlstm.sqphsv = sqlstm.sqhstv;
  sqlstm.sqtdso[2] = 0;
  sqlstm.sqphsl = sqlstm.sqhstl;
  sqlstm.sqharm[2] = 0;
  sqlstm.sqadto[2] = 0;
  sqlstm.sqphss = sqlstm.sqhsts;
  sqlstm.sqhstl[3] = 0x103;
  sqlstm.sqhsts[3] = 0;
  sqlstm.sqpind = sqlstm.sqindv;
  sqlstm.sqindv[3] = (short *)0x0;
  sqlstm.sqinds[3] = 0;
  sqlstm.sqharm[3] = 0;
  sqlstm.sqpins = sqlstm.sqinds;
  sqlstm.sqadto[3] = 0;
  sqlstm.sqparm = sqlstm.sqharm;
  sqlstm.sqparc = sqlstm.sqharc;
  sqlstm.sqpadto = sqlstm.sqadto;
  sqlstm.sqptdso = sqlstm.sqtdso;
  sqlstm.sqlest = (uchar *)&sqlca;
  sqlstm.sqhstv[1] = (uchar *)&T_terminal_nbr;
  sqlstm.sqhstv[2] = (uchar *)&T_TPK1;
  sqlstm.sqhstv[3] = (uchar *)&T_TPK2;
  sqlcxt((long)nIndiceCtx * 0x10 + 0x713948,&sqlctx,&sqlstm,&sqlfpn);
  if (sqlca.sqlcode < 0) {
    strcpy(sLine,sqlca.sqlerrm.sqlerrmc);
    trace_event(sLine,1);
    trace_event("End  GetTPK (MALFUNCTION)",5);
    iVar1 = 3;
  }
  else if (response == 0) {
    memcpy(TPK1,T_TPK1.arr,(ulong)T_TPK1.len);
    memcpy(TPK2,T_TPK2.arr,(ulong)T_TPK2.len);
    if (debug_option == 1) {
      sprintf(sLine,"End   GetTPK(  %.32s,%.32s)",TPK1,TPK2);
    }
    else {
      sLine._16_2_ = sLine._16_2_ & 0xff00;
      builtin_strncpy(sLine,"End   GetTPK(OK)",0x10);
    }
    trace_event(sLine,5);
    iVar1 = 0;
  }
  else {
    builtin_strncpy(sLine,"End   GetTPK(NOK)",0x12);
    trace_event(sLine,5);
    iVar1 = -1;
  }
  return iVar1;
}



// WARNING: Unknown calling convention

int GetTAK(int nIndiceCtx,char *terminal_nbr,char *TAK1,char *TAK2)

{
  int iVar1;
  size_t __n;
  ulong uVar2;
  uint uVar3;
  uchar *puVar4;
  bool bVar5;
  byte bVar6;
  uchar auStack_2674 [272];
  uchar auStack_2564 [7688];
  int response;
  anon_struct_18_2_43c7b5cf T_terminal_nbr;
  sqlca sqlca;
  anon_struct_260_2_43c7b5cf T_TAK1;
  anon_struct_260_2_43c7b5cf T_TAK2;
  char sLine [512];
  sqlexd_conflict8 sqlstm;
  
  bVar6 = 0;
  sprintf(sLine,"Start GetTAK(%.15s)",terminal_nbr);
  trace_event(sLine,5);
  puVar4 = T_TAK1.arr + 2;
  uVar3 = 0xff;
  T_TAK1.arr[0] = '\0';
  T_TAK1.arr[1] = '\0';
  bVar5 = ((ulong)puVar4 & 4) != 0;
  if (bVar5) {
    T_TAK1.arr[2] = '\0';
    T_TAK1.arr[3] = '\0';
    T_TAK1.arr[4] = '\0';
    T_TAK1.arr[5] = '\0';
    uVar3 = 0xfb;
    puVar4 = T_TAK1.arr + 6;
  }
  for (uVar2 = (ulong)(uVar3 >> 3); uVar2 != 0; uVar2 = uVar2 - 1) {
    puVar4[0] = '\0';
    puVar4[1] = '\0';
    puVar4[2] = '\0';
    puVar4[3] = '\0';
    puVar4[4] = '\0';
    puVar4[5] = '\0';
    puVar4[6] = '\0';
    puVar4[7] = '\0';
    puVar4 = puVar4 + (ulong)bVar6 * -0x10 + 8;
  }
  if (!bVar5) {
    puVar4[0] = '\0';
    puVar4[1] = '\0';
    puVar4[2] = '\0';
    puVar4[3] = '\0';
    puVar4 = puVar4 + 4;
  }
  puVar4[0] = '\0';
  puVar4[1] = '\0';
  puVar4[2] = '\0';
  uVar3 = 0xff;
  T_TAK2.arr[0] = '\0';
  T_TAK2.arr[1] = '\0';
  puVar4 = T_TAK2.arr + 2;
  bVar5 = ((ulong)puVar4 & 4) != 0;
  if (bVar5) {
    T_TAK2.arr[2] = '\0';
    T_TAK2.arr[3] = '\0';
    T_TAK2.arr[4] = '\0';
    T_TAK2.arr[5] = '\0';
    uVar3 = 0xfb;
    puVar4 = T_TAK2.arr + 6;
  }
  for (uVar2 = (ulong)(uVar3 >> 3); uVar2 != 0; uVar2 = uVar2 - 1) {
    puVar4[0] = '\0';
    puVar4[1] = '\0';
    puVar4[2] = '\0';
    puVar4[3] = '\0';
    puVar4[4] = '\0';
    puVar4[5] = '\0';
    puVar4[6] = '\0';
    puVar4[7] = '\0';
    puVar4 = puVar4 + (ulong)bVar6 * -0x10 + 8;
  }
  if (!bVar5) {
    puVar4[0] = '\0';
    puVar4[1] = '\0';
    puVar4[2] = '\0';
    puVar4[3] = '\0';
    puVar4 = puVar4 + 4;
  }
  puVar4[0] = '\0';
  puVar4[1] = '\0';
  puVar4[2] = '\0';
  T_terminal_nbr.arr[0] = '\0';
  T_terminal_nbr.arr[1] = '\0';
  T_terminal_nbr.arr[2] = '\0';
  T_terminal_nbr.arr[3] = '\0';
  T_terminal_nbr.arr[4] = '\0';
  T_terminal_nbr.arr[5] = '\0';
  T_terminal_nbr.arr[6] = '\0';
  T_terminal_nbr.arr[7] = '\0';
  T_terminal_nbr.arr[8] = '\0';
  T_terminal_nbr.arr[9] = '\0';
  T_terminal_nbr.arr[10] = '\0';
  T_terminal_nbr.arr[0xb] = '\0';
  T_terminal_nbr.arr[0xc] = '\0';
  T_terminal_nbr.arr[0xd] = '\0';
  T_terminal_nbr.arr[0xe] = '\0';
  T_terminal_nbr.arr[0xf] = '\0';
  __n = strlen(terminal_nbr);
  memcpy(T_terminal_nbr.arr,terminal_nbr,__n);
  sqlstm.sqladtp = &sqladt;
  T_terminal_nbr.len = (ushort)__n;
  sqlstm.sqlety = 0x1100;
  sqlstm.sqltdsp = &sqltds;
  sqlstm.sqadto[0] = 0;
  sqlstm.sqtdso[0] = 0;
  sqlstm.stmt = 
  "begin :response := PCRD_GET_HSM_KEY . GET_TAK_KEY ( :T_terminal_nbr , :T_TAK1 , :T_TAK2 ) ; END ;"
  ;
  sqlstm.sqadto[1] = 0;
  sqlstm.sqtdso[1] = 0;
  response = 3;
  sqlstm.cud = sqlcud0;
  sqlstm.sqhstv[0] = (uchar *)&response;
  sqlstm.sqlvsn = 0xc;
  sqlstm.arrsiz = 6;
  sqlstm.iters = 1;
  sqlstm.sqphsv = sqlstm.sqhstv;
  sqlstm.offset = 0x175;
  sqlstm.occurs = 0;
  sqlstm.sqhstl[0] = 4;
  sqlstm.sqhsts[0] = 0;
  sqlstm.sqindv[0] = (short *)0x0;
  sqlstm.sqinds[0] = 0;
  sqlstm.sqharm[0] = 0;
  sqlstm.sqhstl[1] = 0x12;
  sqlstm.sqhsts[1] = 0;
  sqlstm.sqindv[1] = (short *)0x0;
  sqlstm.sqinds[1] = 0;
  sqlstm.sqharm[1] = 0;
  sqlstm.sqhstl[2] = 0x103;
  sqlstm.sqhsts[2] = 0;
  sqlstm.sqindv[2] = (short *)0x0;
  sqlstm.sqinds[2] = 0;
  sqlstm.sqphsl = sqlstm.sqhstl;
  sqlstm.sqadto[3] = 0;
  sqlstm.sqphss = sqlstm.sqhsts;
  sqlstm.sqharm[2] = 0;
  sqlstm.sqadto[2] = 0;
  sqlstm.sqtdso[2] = 0;
  sqlstm.sqpind = sqlstm.sqindv;
  sqlstm.sqhstl[3] = 0x103;
  sqlstm.sqpins = sqlstm.sqinds;
  sqlstm.sqhsts[3] = 0;
  sqlstm.sqindv[3] = (short *)0x0;
  sqlstm.sqinds[3] = 0;
  sqlstm.sqparm = sqlstm.sqharm;
  sqlstm.sqharm[3] = 0;
  sqlstm.sqtdso[3] = 0;
  sqlstm.sqparc = sqlstm.sqharc;
  sqlstm.sqpadto = sqlstm.sqadto;
  sqlstm.sqptdso = sqlstm.sqtdso;
  sqlstm.sqlest = (uchar *)&sqlca;
  sqlstm.sqhstv[1] = (uchar *)&T_terminal_nbr;
  sqlstm.sqhstv[2] = (uchar *)&T_TAK1;
  sqlstm.sqhstv[3] = (uchar *)&T_TAK2;
  sqlcxt((long)nIndiceCtx * 0x10 + 0x713948,&sqlctx,&sqlstm,&sqlfpn);
  if (sqlca.sqlcode < 0) {
    strcpy(sLine,sqlca.sqlerrm.sqlerrmc);
    trace_event(sLine,1);
    trace_event("End  GetTAK (MALFUNCTION)",5);
    iVar1 = 3;
  }
  else if (response == 0) {
    memcpy(TAK1,T_TAK1.arr,(ulong)T_TAK1.len);
    memcpy(TAK2,T_TAK2.arr,(ulong)T_TAK2.len);
    if (debug_option == 1) {
      sprintf(sLine,"End   GetTAK(%.16s,%.16s)",TAK1,TAK2);
    }
    else {
      sLine._16_2_ = sLine._16_2_ & 0xff00;
      builtin_strncpy(sLine,"End   GetTAK(OK)",0x10);
    }
    trace_event(sLine,5);
    iVar1 = 0;
  }
  else {
    builtin_strncpy(sLine,"End   GetTAK(NOK)",0x12);
    trace_event(sLine,5);
    iVar1 = -1;
  }
  return iVar1;
}



// WARNING: Unknown calling convention

int GetTMK(int nIndiceCtx,char *terminal_nbr,char *TMK1)

{
  int iVar1;
  size_t __n;
  ulong uVar2;
  uint uVar3;
  uchar *puVar4;
  bool bVar5;
  byte bVar6;
  uchar auStack_2564 [7960];
  int response;
  anon_struct_18_2_43c7b5cf T_terminal_nbr;
  sqlca sqlca;
  anon_struct_260_2_43c7b5cf T_TMK1;
  char sLine [512];
  sqlexd_conflict8 sqlstm;
  
  bVar6 = 0;
  sprintf(sLine,"Start GetTMK(|%.15s|)",terminal_nbr);
  trace_event(sLine,5);
  puVar4 = T_TMK1.arr + 2;
  uVar3 = 0xff;
  T_TMK1.arr[0] = '\0';
  T_TMK1.arr[1] = '\0';
  bVar5 = ((ulong)puVar4 & 4) != 0;
  if (bVar5) {
    T_TMK1.arr[2] = '\0';
    T_TMK1.arr[3] = '\0';
    T_TMK1.arr[4] = '\0';
    T_TMK1.arr[5] = '\0';
    uVar3 = 0xfb;
    puVar4 = T_TMK1.arr + 6;
  }
  for (uVar2 = (ulong)(uVar3 >> 3); uVar2 != 0; uVar2 = uVar2 - 1) {
    puVar4[0] = '\0';
    puVar4[1] = '\0';
    puVar4[2] = '\0';
    puVar4[3] = '\0';
    puVar4[4] = '\0';
    puVar4[5] = '\0';
    puVar4[6] = '\0';
    puVar4[7] = '\0';
    puVar4 = puVar4 + (ulong)bVar6 * -0x10 + 8;
  }
  if (!bVar5) {
    puVar4[0] = '\0';
    puVar4[1] = '\0';
    puVar4[2] = '\0';
    puVar4[3] = '\0';
    puVar4 = puVar4 + 4;
  }
  puVar4[0] = '\0';
  puVar4[1] = '\0';
  puVar4[2] = '\0';
  T_TMK1.len = 0;
  T_terminal_nbr.arr[0] = '\0';
  T_terminal_nbr.arr[1] = '\0';
  T_terminal_nbr.arr[2] = '\0';
  T_terminal_nbr.arr[3] = '\0';
  T_terminal_nbr.arr[4] = '\0';
  T_terminal_nbr.arr[5] = '\0';
  T_terminal_nbr.arr[6] = '\0';
  T_terminal_nbr.arr[7] = '\0';
  T_terminal_nbr.arr[8] = '\0';
  T_terminal_nbr.arr[9] = '\0';
  T_terminal_nbr.arr[10] = '\0';
  T_terminal_nbr.arr[0xb] = '\0';
  T_terminal_nbr.arr[0xc] = '\0';
  T_terminal_nbr.arr[0xd] = '\0';
  T_terminal_nbr.arr[0xe] = '\0';
  T_terminal_nbr.arr[0xf] = '\0';
  __n = strlen(terminal_nbr);
  memcpy(T_terminal_nbr.arr,terminal_nbr,__n);
  sqlstm.sqphsv = sqlstm.sqhstv;
  sqlstm.sqladtp = &sqladt;
  T_terminal_nbr.len = (ushort)__n;
  sqlstm.sqlety = 0x1100;
  sqlstm.sqltdsp = &sqltds;
  sqlstm.sqadto[0] = 0;
  sqlstm.sqtdso[0] = 0;
  sqlstm.stmt = 
  "begin :response := PCRD_GET_HSM_KEY . GET_TMK_KEY ( :T_terminal_nbr , :T_TMK1 ) ; END ;";
  sqlstm.sqadto[1] = 0;
  sqlstm.sqtdso[1] = 0;
  response = 3;
  sqlstm.cud = sqlcud0;
  sqlstm.sqhstv[0] = (uchar *)&response;
  sqlstm.sqlvsn = 0xc;
  sqlstm.arrsiz = 6;
  sqlstm.iters = 1;
  sqlstm.offset = 0x194;
  sqlstm.occurs = 0;
  sqlstm.sqhstl[0] = 4;
  sqlstm.sqhsts[0] = 0;
  sqlstm.sqindv[0] = (short *)0x0;
  sqlstm.sqinds[0] = 0;
  sqlstm.sqharm[0] = 0;
  sqlstm.sqhstl[1] = 0x12;
  sqlstm.sqhsts[1] = 0;
  sqlstm.sqindv[1] = (short *)0x0;
  sqlstm.sqinds[1] = 0;
  sqlstm.sqharm[1] = 0;
  sqlstm.sqhstl[2] = 0x103;
  sqlstm.sqhsts[2] = 0;
  sqlstm.sqindv[2] = (short *)0x0;
  sqlstm.sqinds[2] = 0;
  sqlstm.sqphsl = sqlstm.sqhstl;
  sqlstm.sqharm[2] = 0;
  sqlstm.sqphss = sqlstm.sqhsts;
  sqlstm.sqadto[2] = 0;
  sqlstm.sqtdso[2] = 0;
  sqlstm.sqpind = sqlstm.sqindv;
  sqlstm.sqpins = sqlstm.sqinds;
  sqlstm.sqparm = sqlstm.sqharm;
  sqlstm.sqparc = sqlstm.sqharc;
  sqlstm.sqpadto = sqlstm.sqadto;
  sqlstm.sqptdso = sqlstm.sqtdso;
  sqlstm.sqlest = (uchar *)&sqlca;
  sqlstm.sqhstv[1] = (uchar *)&T_terminal_nbr;
  sqlstm.sqhstv[2] = (uchar *)&T_TMK1;
  sqlcxt((long)nIndiceCtx * 0x10 + 0x713948,&sqlctx,&sqlstm,&sqlfpn);
  if (sqlca.sqlcode < 0) {
    strcpy(sLine,sqlca.sqlerrm.sqlerrmc);
    trace_event(sLine,1);
    trace_event("End  GetTMK (MALFUNCTION)",5);
    iVar1 = 3;
  }
  else if (response == 0) {
    memcpy(TMK1,T_TMK1.arr,(ulong)T_TMK1.len);
    if (debug_option == 1) {
      sprintf(sLine,"End   GetTMK(%s)",TMK1);
    }
    else {
      builtin_strncpy(sLine,"End   Ge",8);
      builtin_strncpy(sLine + 8,"tTMK()",7);
    }
    trace_event(sLine,5);
    iVar1 = 0;
  }
  else {
    builtin_strncpy(sLine,"End   GetTMK(NOK)",0x12);
    trace_event(sLine,5);
    iVar1 = -1;
  }
  return iVar1;
}



// WARNING: Removing unreachable block (ram,0x00480f55)
// WARNING: Removing unreachable block (ram,0x00480fab)
// WARNING: Unknown calling convention

int GetMAC(int nIndiceCtx,char *terminal_number,char type,char *MAC1,char *MAC2)

{
  int iVar1;
  size_t __n;
  ulong uVar2;
  uint uVar3;
  uchar *puVar4;
  bool bVar5;
  byte bVar6;
  char T_type [2];
  int response;
  anon_struct_18_2_43c7b5cf T_terminal_number;
  sqlca sqlca;
  anon_struct_260_2_43c7b5cf T_MAC1;
  anon_struct_260_2_43c7b5cf T_MAC2;
  char sLine [512];
  sqlexd_conflict8 sqlstm;
  
  bVar6 = 0;
  sprintf(sLine,"Debut GetMAC(%c,%s)",(ulong)(uint)(int)type,terminal_number);
  trace_event(sLine,5);
  puVar4 = T_MAC1.arr + 2;
  uVar3 = 0x102;
  T_MAC1.arr[0] = '\0';
  T_MAC1.arr[1] = '\0';
  bVar5 = ((ulong)puVar4 & 4) != 0;
  if (bVar5) {
    T_MAC1.arr[2] = '\0';
    T_MAC1.arr[3] = '\0';
    T_MAC1.arr[4] = '\0';
    T_MAC1.arr[5] = '\0';
    uVar3 = 0xfe;
    puVar4 = T_MAC1.arr + 6;
  }
  for (uVar2 = (ulong)(uVar3 >> 3); uVar2 != 0; uVar2 = uVar2 - 1) {
    puVar4[0] = '\0';
    puVar4[1] = '\0';
    puVar4[2] = '\0';
    puVar4[3] = '\0';
    puVar4[4] = '\0';
    puVar4[5] = '\0';
    puVar4[6] = '\0';
    puVar4[7] = '\0';
    puVar4 = puVar4 + (ulong)bVar6 * -0x10 + 8;
  }
  if (bVar5) {
    puVar4[0] = '\0';
    puVar4[1] = '\0';
    puVar4[2] = '\0';
    puVar4[3] = '\0';
    puVar4 = puVar4 + 4;
  }
  puVar4[0] = '\0';
  puVar4[1] = '\0';
  T_MAC2.arr[0] = '\0';
  T_MAC2.arr[1] = '\0';
  uVar3 = 0x102;
  puVar4 = T_MAC2.arr + 2;
  bVar5 = ((ulong)puVar4 & 4) != 0;
  if (bVar5) {
    T_MAC2.arr[2] = '\0';
    T_MAC2.arr[3] = '\0';
    T_MAC2.arr[4] = '\0';
    T_MAC2.arr[5] = '\0';
    uVar3 = 0xfe;
    puVar4 = T_MAC2.arr + 6;
  }
  for (uVar2 = (ulong)(uVar3 >> 3); uVar2 != 0; uVar2 = uVar2 - 1) {
    puVar4[0] = '\0';
    puVar4[1] = '\0';
    puVar4[2] = '\0';
    puVar4[3] = '\0';
    puVar4[4] = '\0';
    puVar4[5] = '\0';
    puVar4[6] = '\0';
    puVar4[7] = '\0';
    puVar4 = puVar4 + (ulong)bVar6 * -0x10 + 8;
  }
  if (bVar5) {
    puVar4[0] = '\0';
    puVar4[1] = '\0';
    puVar4[2] = '\0';
    puVar4[3] = '\0';
    puVar4 = puVar4 + 4;
  }
  puVar4[0] = '\0';
  puVar4[1] = '\0';
  T_MAC1.len = 0;
  T_terminal_number.len = 0xf;
  T_MAC2.len = 0;
  T_type[0] = '\0';
  T_terminal_number.arr[0] = '\0';
  T_terminal_number.arr[1] = '\0';
  T_terminal_number.arr[2] = '\0';
  T_terminal_number.arr[3] = '\0';
  T_terminal_number.arr[4] = '\0';
  T_terminal_number.arr[5] = '\0';
  T_terminal_number.arr[6] = '\0';
  T_terminal_number.arr[7] = '\0';
  __n = strlen(terminal_number);
  memcpy(T_terminal_number.arr,terminal_number,__n);
  sqlstm.sqladtp = &sqladt;
  T_terminal_number.len = (ushort)__n;
  sqlstm.sqlety = 0x1100;
  sqlstm.sqltdsp = &sqltds;
  sqlstm.sqadto[0] = 0;
  sqlstm.sqtdso[0] = 0;
  sqlstm.stmt = 
  "begin :response := PCRD_GET_HSM_KEY . GET_MAC_KEY ( :T_terminal_number , :T_type , :T_MAC1 , :T_MAC2 ) ; END ;"
  ;
  sqlstm.sqadto[1] = 0;
  sqlstm.sqtdso[1] = 0;
  response = 0x38d;
  sqlstm.cud = sqlcud0;
  sqlstm.sqhstv[0] = (uchar *)&response;
  sqlstm.sqlvsn = 0xc;
  sqlstm.arrsiz = 6;
  sqlstm.iters = 1;
  sqlstm.sqhstv[2] = (uchar *)T_type;
  sqlstm.offset = 0x1af;
  sqlstm.occurs = 0;
  sqlstm.sqhstl[0] = 4;
  sqlstm.sqhsts[0] = 0;
  sqlstm.sqindv[0] = (short *)0x0;
  sqlstm.sqinds[0] = 0;
  sqlstm.sqharm[0] = 0;
  sqlstm.sqhstl[1] = 0x12;
  sqlstm.sqhsts[1] = 0;
  sqlstm.sqindv[1] = (short *)0x0;
  sqlstm.sqinds[1] = 0;
  sqlstm.sqharm[1] = 0;
  sqlstm.sqhstl[2] = 2;
  sqlstm.sqhsts[2] = 0;
  sqlstm.sqadto[3] = 0;
  sqlstm.sqtdso[3] = 0;
  sqlstm.sqadto[4] = 0;
  sqlstm.sqindv[2] = (short *)0x0;
  sqlstm.sqtdso[4] = 0;
  sqlstm.sqphsv = sqlstm.sqhstv;
  sqlstm.sqinds[2] = 0;
  sqlstm.sqharm[2] = 0;
  sqlstm.sqadto[2] = 0;
  sqlstm.sqphsl = sqlstm.sqhstl;
  sqlstm.sqtdso[2] = 0;
  sqlstm.sqphss = sqlstm.sqhsts;
  sqlstm.sqhstl[3] = 0x103;
  sqlstm.sqhsts[3] = 0;
  sqlstm.sqpind = sqlstm.sqindv;
  sqlstm.sqindv[3] = (short *)0x0;
  sqlstm.sqinds[3] = 0;
  sqlstm.sqharm[3] = 0;
  sqlstm.sqpins = sqlstm.sqinds;
  sqlstm.sqhstl[4] = 0x103;
  sqlstm.sqhsts[4] = 0;
  sqlstm.sqparm = sqlstm.sqharm;
  sqlstm.sqindv[4] = (short *)0x0;
  sqlstm.sqinds[4] = 0;
  sqlstm.sqharm[4] = 0;
  sqlstm.sqparc = sqlstm.sqharc;
  sqlstm.sqpadto = sqlstm.sqadto;
  sqlstm.sqptdso = sqlstm.sqtdso;
  T_type[0] = type;
  sqlstm.sqlest = (uchar *)&sqlca;
  sqlstm.sqhstv[1] = (uchar *)&T_terminal_number;
  sqlstm.sqhstv[3] = (uchar *)&T_MAC1;
  sqlstm.sqhstv[4] = (uchar *)&T_MAC2;
  sqlcxt((long)nIndiceCtx * 0x10 + 0x713948,&sqlctx,&sqlstm,&sqlfpn);
  if (sqlca.sqlcode < 0) {
    strcpy(sLine,sqlca.sqlerrm.sqlerrmc);
    trace_event(sLine,1);
    trace_event("End  GetMAC (MALFUNCTION)",5);
    iVar1 = 3;
  }
  else if (response == 0) {
    memcpy(MAC1,T_MAC1.arr,(ulong)T_MAC1.len);
    memcpy(MAC2,T_MAC2.arr,(ulong)T_MAC2.len);
    if (debug_option == 1) {
      sprintf(sLine,"-->MAC1 : %s,MAC2 : %s",MAC1,MAC2);
      trace_event(sLine,5);
    }
    trace_event("Fin   GetMAC(OK)",5);
    iVar1 = 0;
  }
  else {
    trace_event("Fin   GetMAC(NOK)",5);
    iVar1 = -1;
  }
  return iVar1;
}



// WARNING: Unknown calling convention

int GetPinKey(int nIndiceCtx,char *sPan,char *PinKey)

{
  int iVar1;
  size_t __n;
  ulong uVar2;
  uint uVar3;
  uchar *puVar4;
  bool bVar5;
  byte bVar6;
  uchar auStack_2364 [7960];
  int response;
  anon_struct_26_2_43c7b5cf T_Pan;
  sqlca sqlca;
  anon_struct_260_2_43c7b5cf T_PinKey;
  char sLine [512];
  undefined2 local_58;
  undefined2 local_56;
  undefined2 local_54;
  undefined2 local_48;
  undefined2 local_46;
  undefined2 local_44;
  
  bVar6 = 0;
  trace_event("Debut GetPinKey  ",5);
  puVar4 = T_PinKey.arr + 2;
  uVar3 = 0xff;
  T_PinKey.arr[0] = '\0';
  T_PinKey.arr[1] = '\0';
  bVar5 = ((ulong)puVar4 & 4) != 0;
  if (bVar5) {
    T_PinKey.arr[2] = '\0';
    T_PinKey.arr[3] = '\0';
    T_PinKey.arr[4] = '\0';
    T_PinKey.arr[5] = '\0';
    uVar3 = 0xfb;
    puVar4 = T_PinKey.arr + 6;
  }
  for (uVar2 = (ulong)(uVar3 >> 3); uVar2 != 0; uVar2 = uVar2 - 1) {
    puVar4[0] = '\0';
    puVar4[1] = '\0';
    puVar4[2] = '\0';
    puVar4[3] = '\0';
    puVar4[4] = '\0';
    puVar4[5] = '\0';
    puVar4[6] = '\0';
    puVar4[7] = '\0';
    puVar4 = puVar4 + (ulong)bVar6 * -0x10 + 8;
  }
  if (!bVar5) {
    puVar4[0] = '\0';
    puVar4[1] = '\0';
    puVar4[2] = '\0';
    puVar4[3] = '\0';
    puVar4 = puVar4 + 4;
  }
  puVar4[0] = '\0';
  puVar4[1] = '\0';
  puVar4[2] = '\0';
  T_Pan.len = 0x16;
  T_Pan.arr[0x14] = '\0';
  T_Pan.arr[0x15] = '\0';
  T_Pan.arr[0] = '\0';
  T_Pan.arr[1] = '\0';
  T_Pan.arr[2] = '\0';
  T_Pan.arr[3] = '\0';
  T_Pan.arr[4] = '\0';
  T_Pan.arr[5] = '\0';
  T_Pan.arr[6] = '\0';
  T_Pan.arr[7] = '\0';
  T_Pan.arr[8] = '\0';
  T_Pan.arr[9] = '\0';
  T_Pan.arr[10] = '\0';
  T_Pan.arr[0xb] = '\0';
  T_Pan.arr[0xc] = '\0';
  T_Pan.arr[0xd] = '\0';
  T_Pan.arr[0xe] = '\0';
  T_Pan.arr[0xf] = '\0';
  T_Pan.arr[0x10] = '\0';
  T_Pan.arr[0x11] = '\0';
  T_Pan.arr[0x12] = '\0';
  T_Pan.arr[0x13] = '\0';
  T_Pan.arr[0x16] = '\0';
  __n = strlen(sPan);
  memcpy(T_Pan.arr,sPan,__n);
  sLine._56_8_ = &sqladt;
  T_Pan.len = (ushort)__n;
  sLine[0x16] = '\0';
  sLine[0x17] = '\x11';
  local_58 = 0;
  sLine._64_8_ = &sqltds;
  local_48 = 0;
  local_56 = 0;
  local_46 = 0;
  sLine._48_8_ = s_begin__response____PCRD_GET_HSM__004d3328;
  response = 0x38d;
  sLine[0] = '\f';
  sLine[1] = '\0';
  sLine[2] = '\0';
  sLine[3] = '\0';
  sLine[4] = '\0';
  sLine[5] = '\0';
  sLine[6] = '\0';
  sLine[7] = '\0';
  sLine[8] = '\x06';
  sLine[9] = '\0';
  sLine[10] = '\0';
  sLine[0xb] = '\0';
  sLine._32_8_ = sqlcud0;
  sLine._176_8_ = &response;
  sLine[0xc] = '\x01';
  sLine[0xd] = '\0';
  sLine[0xe] = '\0';
  sLine[0xf] = '\0';
  sLine[0x10] = -0x2e;
  sLine[0x11] = '\x01';
  sLine[0x12] = '\0';
  sLine[0x13] = '\0';
  sLine[0x18] = '\0';
  sLine[0x19] = '\0';
  sLine[0x1a] = '\0';
  sLine[0x1b] = '\0';
  sLine[0xf0] = '\x04';
  sLine[0xf1] = '\0';
  sLine[0xf2] = '\0';
  sLine[0xf3] = '\0';
  sLine[0xf4] = '\0';
  sLine[0xf5] = '\0';
  sLine[0xf6] = '\0';
  sLine[0xf7] = '\0';
  sLine[0x130] = '\0';
  sLine[0x131] = '\0';
  sLine[0x132] = '\0';
  sLine[0x133] = '\0';
  sLine[0x150] = '\0';
  sLine[0x151] = '\0';
  sLine[0x152] = '\0';
  sLine[0x153] = '\0';
  sLine[0x154] = '\0';
  sLine[0x155] = '\0';
  sLine[0x156] = '\0';
  sLine[0x157] = '\0';
  sLine[400] = '\0';
  sLine[0x191] = '\0';
  sLine[0x192] = '\0';
  sLine[0x193] = '\0';
  sLine[0x1b0] = '\0';
  sLine[0x1b1] = '\0';
  sLine[0x1b2] = '\0';
  sLine[0x1b3] = '\0';
  sLine[0x1b4] = '\0';
  sLine[0x1b5] = '\0';
  sLine[0x1b6] = '\0';
  sLine[0x1b7] = '\0';
  sLine[0xf8] = '\x19';
  sLine[0xf9] = '\0';
  sLine[0xfa] = '\0';
  sLine[0xfb] = '\0';
  sLine[0xfc] = '\0';
  sLine[0xfd] = '\0';
  sLine[0xfe] = '\0';
  sLine[0xff] = '\0';
  sLine[0x134] = '\0';
  sLine[0x135] = '\0';
  sLine[0x136] = '\0';
  sLine[0x137] = '\0';
  sLine[0x158] = '\0';
  sLine[0x159] = '\0';
  sLine[0x15a] = '\0';
  sLine[0x15b] = '\0';
  sLine[0x15c] = '\0';
  sLine[0x15d] = '\0';
  sLine[0x15e] = '\0';
  sLine[0x15f] = '\0';
  sLine[0x194] = '\0';
  sLine[0x195] = '\0';
  sLine[0x196] = '\0';
  sLine[0x197] = '\0';
  sLine[0x1b8] = '\0';
  sLine[0x1b9] = '\0';
  sLine[0x1ba] = '\0';
  sLine[0x1bb] = '\0';
  sLine[0x1bc] = '\0';
  sLine[0x1bd] = '\0';
  sLine[0x1be] = '\0';
  sLine[0x1bf] = '\0';
  sLine[0x100] = '\x03';
  sLine[0x101] = '\x01';
  sLine[0x102] = '\0';
  sLine[0x103] = '\0';
  sLine[0x104] = '\0';
  sLine[0x105] = '\0';
  sLine[0x106] = '\0';
  sLine[0x107] = '\0';
  sLine[0x138] = '\0';
  sLine[0x139] = '\0';
  sLine[0x13a] = '\0';
  sLine[0x13b] = '\0';
  sLine[0x160] = '\0';
  sLine[0x161] = '\0';
  sLine[0x162] = '\0';
  sLine[0x163] = '\0';
  sLine[0x164] = '\0';
  sLine[0x165] = '\0';
  sLine[0x166] = '\0';
  sLine[0x167] = '\0';
  sLine[0x198] = '\0';
  sLine[0x199] = '\0';
  sLine[0x19a] = '\0';
  sLine[0x19b] = '\0';
  local_44 = 0;
  sLine[0x1c0] = '\0';
  sLine[0x1c1] = '\0';
  sLine[0x1c2] = '\0';
  sLine[0x1c3] = '\0';
  sLine[0x1c4] = '\0';
  sLine[0x1c5] = '\0';
  sLine[0x1c6] = '\0';
  sLine[0x1c7] = '\0';
  local_54 = 0;
  sLine._72_8_ = sLine + 0xb0;
  sLine._80_8_ = sLine + 0xf0;
  sLine._88_8_ = sLine + 0x130;
  sLine._96_8_ = sLine + 0x150;
  sLine._104_8_ = sLine + 400;
  sLine._112_8_ = sLine + 0x1b0;
  sLine._120_8_ = sLine + 0x1f0;
  sLine._128_8_ = &local_58;
  sLine._136_8_ = &local_48;
  sLine._40_8_ = &sqlca;
  sLine._184_8_ = &T_Pan;
  sLine._192_8_ = &T_PinKey;
  sqlcxt((long)nIndiceCtx * 0x10 + 0x713948,&sqlctx,sLine,&sqlfpn);
  if (sqlca.sqlcode < 0) {
    strcpy(sLine,sqlca.sqlerrm.sqlerrmc);
    trace_event(sLine,1);
    trace_event("End  GetPinKey (MALFUNCTION)",5);
    iVar1 = 3;
  }
  else if (response == 0) {
    memcpy(PinKey,T_PinKey.arr,(ulong)T_PinKey.len);
    trace_event("Fin   GetPinKey(OK)",5);
    iVar1 = 0;
  }
  else {
    trace_event("Fin   GetPinKey(NOK)",5);
    iVar1 = -1;
  }
  return iVar1;
}



// WARNING: Unknown calling convention

int GetAwkZmk(int nIndiceCtx,char *resource_id,char *AwK)

{
  int iVar1;
  ulong uVar2;
  uchar *puVar3;
  uint uVar4;
  bool bVar5;
  byte bVar6;
  uchar auStack_2554 [7976];
  int response;
  char T_resource_id [7];
  sqlca sqlca;
  anon_struct_260_2_43c7b5cf T_AwK;
  char sLine [512];
  sqlexd_conflict8 sqlstm;
  
  bVar6 = 0;
  sprintf(sLine,"Start GetAwkZmk(%.6s)",resource_id);
  trace_event(sLine,5);
  puVar3 = T_AwK.arr + 2;
  uVar4 = 0xff;
  T_AwK.arr[0] = '\0';
  T_AwK.arr[1] = '\0';
  bVar5 = ((ulong)puVar3 & 4) != 0;
  if (bVar5) {
    T_AwK.arr[2] = '\0';
    T_AwK.arr[3] = '\0';
    T_AwK.arr[4] = '\0';
    T_AwK.arr[5] = '\0';
    uVar4 = 0xfb;
    puVar3 = T_AwK.arr + 6;
  }
  for (uVar2 = (ulong)(uVar4 >> 3); uVar2 != 0; uVar2 = uVar2 - 1) {
    puVar3[0] = '\0';
    puVar3[1] = '\0';
    puVar3[2] = '\0';
    puVar3[3] = '\0';
    puVar3[4] = '\0';
    puVar3[5] = '\0';
    puVar3[6] = '\0';
    puVar3[7] = '\0';
    puVar3 = puVar3 + (ulong)bVar6 * -0x10 + 8;
  }
  if (!bVar5) {
    puVar3[0] = '\0';
    puVar3[1] = '\0';
    puVar3[2] = '\0';
    puVar3[3] = '\0';
    puVar3 = puVar3 + 4;
  }
  puVar3[0] = '\0';
  puVar3[1] = '\0';
  puVar3[2] = '\0';
  T_resource_id._0_4_ = *(undefined4 *)resource_id;
  sqlstm.sqhstv[1] = (uchar *)T_resource_id;
  sqlstm.sqladtp = &sqladt;
  sqlstm.stmt = 
  "begin :response := PCRD_GET_HSM_KEY . GET_AWK_KEY_UNDER_ZMK ( :T_resource_id , :T_AwK ) ; END ;";
  T_resource_id._4_2_ = *(undefined2 *)(resource_id + 4);
  sqlstm.sqlest = (uchar *)&sqlca;
  sqlstm.sqltdsp = &sqltds;
  sqlstm.sqadto[0] = 0;
  sqlstm.cud = sqlcud0;
  sqlstm.sqadto[1] = 0;
  sqlstm.sqtdso[0] = 0;
  sqlstm.sqlety = 0x1100;
  sqlstm.sqhstv[0] = (uchar *)&response;
  sqlstm.sqtdso[1] = 0;
  T_resource_id[6] = '\0';
  response = 0x38d;
  sqlstm.sqphsv = sqlstm.sqhstv;
  sqlstm.sqlvsn = 0xc;
  sqlstm.arrsiz = 6;
  sqlstm.iters = 1;
  sqlstm.offset = 0x1ed;
  sqlstm.occurs = 0;
  sqlstm.sqhstl[0] = 4;
  sqlstm.sqhsts[0] = 0;
  sqlstm.sqindv[0] = (short *)0x0;
  sqlstm.sqinds[0] = 0;
  sqlstm.sqharm[0] = 0;
  sqlstm.sqhstl[1] = 7;
  sqlstm.sqhsts[1] = 0;
  sqlstm.sqindv[1] = (short *)0x0;
  sqlstm.sqinds[1] = 0;
  sqlstm.sqharm[1] = 0;
  sqlstm.sqphsl = sqlstm.sqhstl;
  sqlstm.sqhstl[2] = 0x103;
  sqlstm.sqhsts[2] = 0;
  sqlstm.sqphss = sqlstm.sqhsts;
  sqlstm.sqindv[2] = (short *)0x0;
  sqlstm.sqinds[2] = 0;
  sqlstm.sqharm[2] = 0;
  sqlstm.sqpind = sqlstm.sqindv;
  sqlstm.sqadto[2] = 0;
  sqlstm.sqtdso[2] = 0;
  sqlstm.sqpins = sqlstm.sqinds;
  sqlstm.sqparm = sqlstm.sqharm;
  sqlstm.sqparc = sqlstm.sqharc;
  sqlstm.sqpadto = sqlstm.sqadto;
  sqlstm.sqptdso = sqlstm.sqtdso;
  sqlstm.sqhstv[2] = (uchar *)&T_AwK;
  sqlcxt((long)nIndiceCtx * 0x10 + 0x713948,&sqlctx,&sqlstm,&sqlfpn);
  if (-1 < sqlca.sqlcode) {
    if (response == 0) {
      memcpy(AwK,T_AwK.arr,(ulong)T_AwK.len);
      if (debug_option == 1) {
        sprintf(sLine,"End   GetAwkZmk(%.16s)",AwK);
      }
      else {
        builtin_strncpy(sLine + 0x10,"OK)",4);
        builtin_strncpy(sLine,"End   GetAwkZmk(",0x10);
      }
      trace_event(sLine,5);
      iVar1 = 0;
    }
    else {
      trace_event("End   GetAwkZmk(NOK)",5);
      iVar1 = -1;
    }
    return iVar1;
  }
  strcpy(sLine,sqlca.sqlerrm.sqlerrmc);
  trace_event(sLine,1);
  trace_event("End  GetAwkZmk (MALFUNCTION)",5);
  return 3;
}



// WARNING: Unknown calling convention

int GetPVKPinKey(int nIndiceCtx,char *sPan,char *PVKA,char *PVKB)

{
  int iVar1;
  size_t __n;
  int response;
  anon_struct_16_2_43c7b5cf T_LMK_ID;
  char T_PVKA [17];
  char T_PVKB [17];
  anon_struct_26_2_43c7b5cf T_Pan;
  sqlca sqlca;
  char sLine [512];
  sqlexd_conflict8 sqlstm;
  
  if (debug_option == 1) {
    sprintf(sLine,"Start GetPVKPinKey(%.16s)",sPan);
  }
  else {
    builtin_strncpy(sLine + 0x10,"ey()",4);
    builtin_strncpy(sLine,"Start GetPVKPinK",0x10);
    sLine._20_2_ = sLine._20_2_ & 0xff00;
  }
  trace_event(sLine,5);
  T_Pan.arr[0] = '\0';
  T_Pan.arr[1] = '\0';
  T_Pan.arr[2] = '\0';
  T_Pan.arr[3] = '\0';
  T_Pan.arr[4] = '\0';
  T_Pan.arr[5] = '\0';
  T_Pan.arr[6] = '\0';
  T_Pan.arr[7] = '\0';
  T_LMK_ID.len = 0;
  T_LMK_ID.arr[0] = '\0';
  T_LMK_ID.arr[1] = '\0';
  T_LMK_ID.arr[2] = '\0';
  T_LMK_ID.arr[3] = '\0';
  T_LMK_ID.arr[4] = '\0';
  T_LMK_ID.arr[5] = '\0';
  T_LMK_ID.arr[6] = '\0';
  T_LMK_ID.arr[7] = '\0';
  T_LMK_ID.arr[8] = '\0';
  T_LMK_ID.arr[9] = '\0';
  T_LMK_ID.arr[10] = '\0';
  T_LMK_ID.arr[0xb] = '\0';
  T_LMK_ID.arr[0xc] = '\0';
  T_Pan.arr[8] = '\0';
  T_Pan.arr[9] = '\0';
  T_Pan.arr[10] = '\0';
  T_Pan.arr[0xb] = '\0';
  T_Pan.arr[0xc] = '\0';
  T_Pan.arr[0xd] = '\0';
  T_Pan.arr[0xe] = '\0';
  T_Pan.arr[0xf] = '\0';
  T_Pan.arr[0x10] = '\0';
  T_Pan.arr[0x11] = '\0';
  T_Pan.arr[0x12] = '\0';
  T_Pan.arr[0x13] = '\0';
  T_Pan.arr[0x14] = '\0';
  T_Pan.arr[0x15] = '\0';
  T_Pan.arr[0x16] = '\0';
  T_Pan.len = 0x16;
  T_PVKA[0] = '\0';
  T_PVKA[1] = '\0';
  T_PVKA[2] = '\0';
  T_PVKA[3] = '\0';
  T_PVKA[4] = '\0';
  T_PVKA[5] = '\0';
  T_PVKA[6] = '\0';
  T_PVKA[7] = '\0';
  T_PVKA[8] = '\0';
  T_PVKA[9] = '\0';
  T_PVKA[10] = '\0';
  T_PVKA[0xb] = '\0';
  T_PVKA[0xc] = '\0';
  T_PVKA[0xd] = '\0';
  T_PVKA[0xe] = '\0';
  T_PVKA[0xf] = '\0';
  T_PVKA[0x10] = '\0';
  T_PVKB[0] = '\0';
  T_PVKB[1] = '\0';
  T_PVKB[2] = '\0';
  T_PVKB[3] = '\0';
  T_PVKB[4] = '\0';
  T_PVKB[5] = '\0';
  T_PVKB[6] = '\0';
  T_PVKB[7] = '\0';
  T_PVKB[8] = '\0';
  T_PVKB[9] = '\0';
  T_PVKB[10] = '\0';
  T_PVKB[0xb] = '\0';
  T_PVKB[0xc] = '\0';
  T_PVKB[0xd] = '\0';
  T_PVKB[0xe] = '\0';
  T_PVKB[0xf] = '\0';
  T_PVKB[0x10] = '\0';
  __n = strlen(sPan);
  memcpy(T_Pan.arr,sPan,__n);
  T_Pan.len = (ushort)__n;
  if (debug_option == 1) {
    sprintf(sLine,"T_Pan.arr=[%s], T_Pan.len=[%d])",T_Pan.arr,__n & 0xffff);
    trace_event(sLine,5);
  }
  sqlstm.sqlest = (uchar *)&sqlca;
  sqlstm.sqphsv = sqlstm.sqhstv;
  sqlstm.sqhstv[2] = (uchar *)T_PVKA;
  sqlstm.sqladtp = &sqladt;
  sqlstm.sqltdsp = &sqltds;
  sqlstm.sqlety = 0x1100;
  sqlstm.sqhstv[3] = (uchar *)T_PVKB;
  sqlstm.stmt = 
  "begin :response := PCRD_GET_HSM_KEY . GET_PVK_KEY ( :T_Pan , :T_PVKA , :T_PVKB , :T_LMK_ID ) ; END ;"
  ;
  sqlstm.sqadto[0] = 0;
  sqlstm.sqtdso[0] = 0;
  sqlstm.sqadto[1] = 0;
  sqlstm.cud = sqlcud0;
  sqlstm.sqhstv[0] = (uchar *)&response;
  sqlstm.sqtdso[1] = 0;
  response = 0x38d;
  sqlstm.sqlvsn = 0xc;
  sqlstm.arrsiz = 6;
  sqlstm.iters = 1;
  sqlstm.offset = 0x208;
  sqlstm.occurs = 0;
  sqlstm.sqhstl[0] = 4;
  sqlstm.sqhsts[0] = 0;
  sqlstm.sqindv[0] = (short *)0x0;
  sqlstm.sqinds[0] = 0;
  sqlstm.sqharm[0] = 0;
  sqlstm.sqhstl[1] = 0x19;
  sqlstm.sqhsts[1] = 0;
  sqlstm.sqindv[1] = (short *)0x0;
  sqlstm.sqinds[1] = 0;
  sqlstm.sqharm[1] = 0;
  sqlstm.sqhstl[2] = 0x11;
  sqlstm.sqhsts[2] = 0;
  sqlstm.sqindv[2] = (short *)0x0;
  sqlstm.sqinds[2] = 0;
  sqlstm.sqphsl = sqlstm.sqhstl;
  sqlstm.sqtdso[3] = 0;
  sqlstm.sqphss = sqlstm.sqhsts;
  sqlstm.sqadto[4] = 0;
  sqlstm.sqadto[2] = 0;
  sqlstm.sqharm[2] = 0;
  sqlstm.sqpind = sqlstm.sqindv;
  sqlstm.sqtdso[4] = 0;
  sqlstm.sqpins = sqlstm.sqinds;
  sqlstm.sqtdso[2] = 0;
  sqlstm.sqhstl[3] = 0x11;
  sqlstm.sqparm = sqlstm.sqharm;
  sqlstm.sqhsts[3] = 0;
  sqlstm.sqindv[3] = (short *)0x0;
  sqlstm.sqinds[3] = 0;
  sqlstm.sqparc = sqlstm.sqharc;
  sqlstm.sqharm[3] = 0;
  sqlstm.sqadto[3] = 0;
  sqlstm.sqhstl[4] = 0xf;
  sqlstm.sqpadto = sqlstm.sqadto;
  sqlstm.sqhsts[4] = 0;
  sqlstm.sqindv[4] = (short *)0x0;
  sqlstm.sqinds[4] = 0;
  sqlstm.sqptdso = sqlstm.sqtdso;
  sqlstm.sqharm[4] = 0;
  sqlstm.sqhstv[1] = (uchar *)&T_Pan;
  sqlstm.sqhstv[4] = (uchar *)&T_LMK_ID;
  sqlcxt((long)nIndiceCtx * 0x10 + 0x713948,&sqlctx,&sqlstm,&sqlfpn);
  if (sqlca.sqlcode < 0) {
    strcpy(sLine,sqlca.sqlerrm.sqlerrmc);
    trace_event(sLine,1);
    trace_event("End  GetPVKPinKey(MALFUNCTION)",5);
    iVar1 = 3;
  }
  else if (response == 0) {
    *(undefined8 *)PVKA = T_PVKA._0_8_;
    *(undefined8 *)(PVKA + 8) = T_PVKA._8_8_;
    *(undefined8 *)PVKB = T_PVKB._0_8_;
    *(undefined8 *)(PVKB + 8) = T_PVKB._8_8_;
    if (debug_option == 1) {
      sprintf(sLine,"End   GetPVKPinKey(%.16s,%.16s)",PVKA,PVKB);
    }
    else {
      builtin_strncpy(sLine,"End   GetPVKPinKey(OK)",0x17);
    }
    trace_event(sLine,5);
    iVar1 = 0;
  }
  else {
    trace_event("End   GetPVKPinKey(NOK)",5);
    iVar1 = -1;
  }
  return iVar1;
}



// WARNING: Unknown calling convention

int Get_AC_Key(int nIndiceCtx,char *sPan,char *sAC_Key)

{
  int iVar1;
  size_t __n;
  void *pvVar2;
  ulong uVar3;
  uint uVar4;
  uchar *puVar5;
  bool bVar6;
  byte bVar7;
  uchar auStack_2564 [7948];
  int response;
  anon_struct_26_2_43c7b5cf T_Pan;
  sqlca sqlca;
  anon_struct_260_2_43c7b5cf T_AC_Key;
  char sLine [512];
  sqlexd_conflict8 sqlstm;
  
  bVar7 = 0;
  if (debug_option == 1) {
    sprintf(sLine,"Start Get_AC_Key(%.16s)",sPan);
  }
  else {
    builtin_strncpy(sLine + 0x10,"(OK)",5);
    builtin_strncpy(sLine,"Start Get_AC_Key",0x10);
  }
  trace_event(sLine,5);
  puVar5 = T_AC_Key.arr + 2;
  T_Pan.arr[0] = '\0';
  T_Pan.arr[1] = '\0';
  T_Pan.arr[2] = '\0';
  T_Pan.arr[3] = '\0';
  T_Pan.arr[4] = '\0';
  T_Pan.arr[5] = '\0';
  T_Pan.arr[6] = '\0';
  T_Pan.arr[7] = '\0';
  T_Pan.arr[0x14] = '\0';
  T_Pan.arr[0x15] = '\0';
  T_Pan.arr[8] = '\0';
  T_Pan.arr[9] = '\0';
  T_Pan.arr[10] = '\0';
  T_Pan.arr[0xb] = '\0';
  T_Pan.arr[0xc] = '\0';
  T_Pan.arr[0xd] = '\0';
  T_Pan.arr[0xe] = '\0';
  T_Pan.arr[0xf] = '\0';
  T_Pan.len = 0;
  bVar6 = ((ulong)puVar5 & 4) != 0;
  T_Pan.arr[0x10] = '\0';
  T_Pan.arr[0x11] = '\0';
  T_Pan.arr[0x12] = '\0';
  T_Pan.arr[0x13] = '\0';
  T_Pan.arr[0x16] = '\0';
  uVar4 = 0xff;
  T_AC_Key.arr[0] = '\0';
  T_AC_Key.arr[1] = '\0';
  if (bVar6) {
    T_AC_Key.arr[2] = '\0';
    T_AC_Key.arr[3] = '\0';
    T_AC_Key.arr[4] = '\0';
    T_AC_Key.arr[5] = '\0';
    uVar4 = 0xfb;
    puVar5 = T_AC_Key.arr + 6;
  }
  for (uVar3 = (ulong)(uVar4 >> 3); uVar3 != 0; uVar3 = uVar3 - 1) {
    puVar5[0] = '\0';
    puVar5[1] = '\0';
    puVar5[2] = '\0';
    puVar5[3] = '\0';
    puVar5[4] = '\0';
    puVar5[5] = '\0';
    puVar5[6] = '\0';
    puVar5[7] = '\0';
    puVar5 = puVar5 + (ulong)bVar7 * -0x10 + 8;
  }
  if (!bVar6) {
    puVar5[0] = '\0';
    puVar5[1] = '\0';
    puVar5[2] = '\0';
    puVar5[3] = '\0';
    puVar5 = puVar5 + 4;
  }
  puVar5[0] = '\0';
  puVar5[1] = '\0';
  puVar5[2] = '\0';
  T_AC_Key.len = 0;
  __n = strlen(sPan);
  pvVar2 = memcpy(T_Pan.arr,sPan,__n);
  T_Pan.len = (ushort)__n;
  if (debug_option == 1) {
    sprintf(sLine,"T_Pan.arr=[%s], T_Pan.len=[%d])",pvVar2);
    trace_event(sLine,5);
  }
  sqlstm.sqlest = (uchar *)&sqlca;
  sqlstm.sqlety = 0x1100;
  sqlstm.sqladtp = &sqladt;
  sqlstm.sqadto[0] = 0;
  sqlstm.sqltdsp = &sqltds;
  sqlstm.sqtdso[0] = 0;
  sqlstm.sqadto[1] = 0;
  sqlstm.sqtdso[1] = 0;
  sqlstm.stmt = "begin :response := PCRD_GET_HSM_KEY_2 . GET_AC_KEY ( :T_Pan , :T_AC_Key ) ; END ;";
  response = 0x38d;
  sqlstm.sqlvsn = 0xc;
  sqlstm.arrsiz = 6;
  sqlstm.cud = sqlcud0;
  sqlstm.sqhstv[0] = (uchar *)&response;
  sqlstm.iters = 1;
  sqlstm.offset = 0x22b;
  sqlstm.sqphsv = sqlstm.sqhstv;
  sqlstm.occurs = 0;
  sqlstm.sqhstl[0] = 4;
  sqlstm.sqhsts[0] = 0;
  sqlstm.sqindv[0] = (short *)0x0;
  sqlstm.sqinds[0] = 0;
  sqlstm.sqharm[0] = 0;
  sqlstm.sqhstl[1] = 0x19;
  sqlstm.sqhsts[1] = 0;
  sqlstm.sqindv[1] = (short *)0x0;
  sqlstm.sqinds[1] = 0;
  sqlstm.sqharm[1] = 0;
  sqlstm.sqhstl[2] = 0x103;
  sqlstm.sqhsts[2] = 0;
  sqlstm.sqindv[2] = (short *)0x0;
  sqlstm.sqinds[2] = 0;
  sqlstm.sqharm[2] = 0;
  sqlstm.sqphsl = sqlstm.sqhstl;
  sqlstm.sqadto[2] = 0;
  sqlstm.sqphss = sqlstm.sqhsts;
  sqlstm.sqtdso[2] = 0;
  sqlstm.sqpind = sqlstm.sqindv;
  sqlstm.sqpins = sqlstm.sqinds;
  sqlstm.sqparm = sqlstm.sqharm;
  sqlstm.sqparc = sqlstm.sqharc;
  sqlstm.sqpadto = sqlstm.sqadto;
  sqlstm.sqptdso = sqlstm.sqtdso;
  sqlstm.sqhstv[1] = (uchar *)&T_Pan;
  sqlstm.sqhstv[2] = (uchar *)&T_AC_Key;
  sqlcxt((long)nIndiceCtx * 0x10 + 0x713948,&sqlctx,&sqlstm,&sqlfpn);
  if (sqlca.sqlcode < 0) {
    sprintf(sLine,"[%.100s]",sqlca.sqlerrm.sqlerrmc);
    trace_event(sLine,1);
    trace_event("End  Get_AC_Key(MALFUNCTION)",5);
    iVar1 = 3;
  }
  else if (response == 0) {
    memcpy(sAC_Key,T_AC_Key.arr,(ulong)T_AC_Key.len);
    if (debug_option == 1) {
      sprintf(sLine,"End   Get_AC_Key(%s)",sAC_Key);
    }
    else {
      builtin_strncpy(sLine + 0x10,"(OK)",5);
      builtin_strncpy(sLine,"End   Get_AC_Key",0x10);
    }
    trace_event(sLine,5);
    iVar1 = 0;
  }
  else {
    trace_event("End   Get_AC_Key(NOK)",5);
    iVar1 = -1;
  }
  return iVar1;
}



// WARNING: Unknown calling convention

int GET_EMV_KEYS(int nIndiceCtx,char *p_card_number,char *p_issuing_bank_code,char *p_issuing_bin,
                char *p_product_code,char *p_icc_application_index,char *p_key_code,char *sEMV_key)

{
  int iVar1;
  size_t sVar2;
  long lVar3;
  ulong uVar4;
  uint uVar5;
  char **ppcVar6;
  uchar *puVar7;
  bool bVar8;
  byte bVar9;
  uchar auStack_2564 [7688];
  int response;
  anon_struct_6_2_43c7b5cf T_PRODUCT_CODE;
  anon_struct_8_2_43c7b5cf T_ICC_APP_INDX;
  anon_struct_8_2_43c7b5cf_conflict T_KEY_CODE;
  anon_struct_10_2_43c7b5cf T_ISSUING_BANK_CODE;
  anon_struct_14_2_43c7b5cf T_ISSUING_BIN;
  anon_struct_26_2_43c7b5cf T_Pan;
  sqlca sqlca;
  char *CardTrunc [23];
  anon_struct_260_2_43c7b5cf T_EMV_Key;
  char sLine [512];
  sqlexd_conflict8 sqlstm;
  
  bVar9 = 0;
  ppcVar6 = CardTrunc;
  for (lVar3 = 0x17; lVar3 != 0; lVar3 = lVar3 + -1) {
    *ppcVar6 = (char *)0x0;
    ppcVar6 = ppcVar6 + 1;
  }
  if (debug_option == 1) {
    sprintf(sLine,"Start GET_EMV_KEYS(%.16s)",p_card_number);
  }
  else {
    builtin_strncpy(sLine + 0x10,"YS()",4);
    builtin_strncpy(sLine,"Start GET_EMV_KE",0x10);
    sLine._20_2_ = sLine._20_2_ & 0xff00;
  }
  trace_event(sLine,5);
  puVar7 = T_EMV_Key.arr + 2;
  T_Pan.arr[0] = '\0';
  T_Pan.arr[1] = '\0';
  T_Pan.arr[2] = '\0';
  T_Pan.arr[3] = '\0';
  T_Pan.arr[4] = '\0';
  T_Pan.arr[5] = '\0';
  T_Pan.arr[6] = '\0';
  T_Pan.arr[7] = '\0';
  T_Pan.arr[0x14] = '\0';
  T_Pan.arr[0x15] = '\0';
  T_Pan.arr[8] = '\0';
  T_Pan.arr[9] = '\0';
  T_Pan.arr[10] = '\0';
  T_Pan.arr[0xb] = '\0';
  T_Pan.arr[0xc] = '\0';
  T_Pan.arr[0xd] = '\0';
  T_Pan.arr[0xe] = '\0';
  T_Pan.arr[0xf] = '\0';
  T_Pan.len = 0;
  bVar8 = ((ulong)puVar7 & 4) != 0;
  T_Pan.arr[0x10] = '\0';
  T_Pan.arr[0x11] = '\0';
  T_Pan.arr[0x12] = '\0';
  T_Pan.arr[0x13] = '\0';
  T_Pan.arr[0x16] = '\0';
  uVar5 = 0xff;
  T_EMV_Key.arr[0] = '\0';
  T_EMV_Key.arr[1] = '\0';
  if (bVar8) {
    T_EMV_Key.arr[2] = '\0';
    T_EMV_Key.arr[3] = '\0';
    T_EMV_Key.arr[4] = '\0';
    T_EMV_Key.arr[5] = '\0';
    uVar5 = 0xfb;
    puVar7 = T_EMV_Key.arr + 6;
  }
  for (uVar4 = (ulong)(uVar5 >> 3); uVar4 != 0; uVar4 = uVar4 - 1) {
    puVar7[0] = '\0';
    puVar7[1] = '\0';
    puVar7[2] = '\0';
    puVar7[3] = '\0';
    puVar7[4] = '\0';
    puVar7[5] = '\0';
    puVar7[6] = '\0';
    puVar7[7] = '\0';
    puVar7 = puVar7 + (ulong)bVar9 * -0x10 + 8;
  }
  if (!bVar8) {
    puVar7[0] = '\0';
    puVar7[1] = '\0';
    puVar7[2] = '\0';
    puVar7[3] = '\0';
    puVar7 = puVar7 + 4;
  }
  puVar7[0] = '\0';
  puVar7[1] = '\0';
  puVar7[2] = '\0';
  T_ISSUING_BANK_CODE.arr[4] = '\0';
  T_ISSUING_BANK_CODE.arr[5] = '\0';
  T_ICC_APP_INDX.len = 0;
  T_ISSUING_BANK_CODE.len = 0;
  T_ISSUING_BIN.len = 0;
  T_PRODUCT_CODE.len = 0;
  T_KEY_CODE.arr[4] = '\0';
  T_KEY_CODE.arr[5] = '\0';
  T_EMV_Key.len = 0;
  T_ISSUING_BANK_CODE.arr[0] = '\0';
  T_ISSUING_BANK_CODE.arr[1] = '\0';
  T_ISSUING_BANK_CODE.arr[2] = '\0';
  T_ISSUING_BANK_CODE.arr[3] = '\0';
  T_ISSUING_BANK_CODE.arr[6] = '\0';
  T_ISSUING_BIN.arr[0] = '\0';
  T_ISSUING_BIN.arr[1] = '\0';
  T_ISSUING_BIN.arr[2] = '\0';
  T_ISSUING_BIN.arr[3] = '\0';
  T_ISSUING_BIN.arr[4] = '\0';
  T_ISSUING_BIN.arr[5] = '\0';
  T_ISSUING_BIN.arr[6] = '\0';
  T_ISSUING_BIN.arr[7] = '\0';
  T_ISSUING_BIN.arr[8] = '\0';
  T_ISSUING_BIN.arr[9] = '\0';
  T_ISSUING_BIN.arr[10] = '\0';
  T_ISSUING_BIN.arr[0xb] = '\0';
  T_PRODUCT_CODE.arr[0] = '\0';
  T_PRODUCT_CODE.arr[1] = '\0';
  T_PRODUCT_CODE.arr[2] = '\0';
  T_PRODUCT_CODE.arr[3] = '\0';
  T_ICC_APP_INDX.arr[0] = '\0';
  T_ICC_APP_INDX.arr[1] = '\0';
  T_ICC_APP_INDX.arr[2] = '\0';
  T_ICC_APP_INDX.arr[3] = '\0';
  T_ICC_APP_INDX.arr[4] = '\0';
  T_KEY_CODE.arr[0] = '\0';
  T_KEY_CODE.arr[1] = '\0';
  T_KEY_CODE.arr[2] = '\0';
  T_KEY_CODE.arr[3] = '\0';
  T_KEY_CODE.len = 0;
  sVar2 = strlen(p_card_number);
  memcpy(T_Pan.arr,p_card_number,sVar2);
  T_Pan.len = (ushort)sVar2;
  sVar2 = strlen(p_issuing_bank_code);
  memcpy(T_ISSUING_BANK_CODE.arr,p_issuing_bank_code,sVar2);
  T_ISSUING_BANK_CODE.len = (ushort)sVar2;
  sprintf(sLine,"T_ISSUING_BANK_CODE.arr=[%s], T_ISSUING_BANK_CODE.len=[%d])",
          T_ISSUING_BANK_CODE.arr,sVar2 & 0xffff);
  trace_event(sLine,5);
  sVar2 = strlen(p_issuing_bin);
  memcpy(T_ISSUING_BIN.arr,p_issuing_bin,sVar2);
  T_ISSUING_BIN.len = (ushort)sVar2;
  sprintf(sLine,"T_ISSUING_BIN.arr=[%s], T_ISSUING_BIN.len=[%d])",T_ISSUING_BIN.arr,sVar2 & 0xffff);
  trace_event(sLine,5);
  sVar2 = strlen(p_product_code);
  memcpy(T_PRODUCT_CODE.arr,p_product_code,sVar2);
  T_PRODUCT_CODE.len = (ushort)sVar2;
  sprintf(sLine,"T_PRODUCT_CODE.arr=[%s], T_PRODUCT_CODE.len=[%d])",T_PRODUCT_CODE.arr,
          sVar2 & 0xffff);
  trace_event(sLine,5);
  sVar2 = strlen(p_icc_application_index);
  memcpy(T_ICC_APP_INDX.arr,p_icc_application_index,sVar2);
  T_ICC_APP_INDX.len = (ushort)sVar2;
  sprintf(sLine,"T_ICC_APP_INDX.arr=[%s], T_ICC_APP_INDX.len=[%d])",T_ICC_APP_INDX.arr,
          sVar2 & 0xffff);
  trace_event(sLine,5);
  sVar2 = strlen(p_key_code);
  memcpy(T_KEY_CODE.arr,p_key_code,sVar2);
  T_KEY_CODE.len = (ushort)sVar2;
  sprintf(sLine,"T_KEY_CODE.arr=[%s], T_KEY_CODE.len=[%d])",T_KEY_CODE.arr,sVar2 & 0xffff);
  trace_event(sLine,5);
  sqlstm.sqlety = 0x1100;
  sqlstm.sqhstv[0] = (uchar *)&response;
  sqlstm.sqlest = (uchar *)&sqlca;
  sqlstm.sqladtp = &sqladt;
  sqlstm.sqltdsp = &sqltds;
  sqlstm.sqadto[0] = 0;
  sqlstm.sqtdso[0] = 0;
  sqlstm.stmt = 
  "begin :response := PCRD_GET_HSM_KEY_2 . GET_EMV_KEYS ( :T_Pan , :T_ISSUING_BANK_CODE , :T_ISSUING_BIN , :T_PRODUCT_CODE , :T_ICC_APP_INDX , :T_KEY_CODE , :T_EMV_Key ) ; END ;"
  ;
  sqlstm.sqadto[1] = 0;
  sqlstm.cud = sqlcud0;
  sqlstm.sqtdso[1] = 0;
  response = 0x38d;
  sqlstm.sqlvsn = 0xc;
  sqlstm.arrsiz = 8;
  sqlstm.iters = 1;
  sqlstm.offset = 0x246;
  sqlstm.occurs = 0;
  sqlstm.sqhstl[0] = 4;
  sqlstm.sqhsts[0] = 0;
  sqlstm.sqindv[0] = (short *)0x0;
  sqlstm.sqinds[0] = 0;
  sqlstm.sqharm[0] = 0;
  sqlstm.sqhstl[1] = 0x19;
  sqlstm.sqhsts[1] = 0;
  sqlstm.sqindv[1] = (short *)0x0;
  sqlstm.sqinds[1] = 0;
  sqlstm.sqharm[1] = 0;
  sqlstm.sqhstl[2] = 9;
  sqlstm.sqhsts[2] = 0;
  sqlstm.sqindv[2] = (short *)0x0;
  sqlstm.sqinds[2] = 0;
  sqlstm.sqadto[5] = 0;
  sqlstm.sqadto[2] = 0;
  sqlstm.sqtdso[2] = 0;
  sqlstm.sqadto[3] = 0;
  sqlstm.sqtdso[3] = 0;
  sqlstm.sqadto[4] = 0;
  sqlstm.sqtdso[4] = 0;
  sqlstm.sqtdso[5] = 0;
  sqlstm.sqharm[2] = 0;
  sqlstm.sqhstl[3] = 0xe;
  sqlstm.sqhsts[3] = 0;
  sqlstm.sqindv[3] = (short *)0x0;
  sqlstm.sqinds[3] = 0;
  sqlstm.sqharm[3] = 0;
  sqlstm.sqhstl[4] = 6;
  sqlstm.sqhsts[4] = 0;
  sqlstm.sqindv[4] = (short *)0x0;
  sqlstm.sqinds[4] = 0;
  sqlstm.sqharm[4] = 0;
  sqlstm.sqhstl[5] = 7;
  sqlstm.sqhsts[5] = 0;
  sqlstm.sqindv[5] = (short *)0x0;
  sqlstm.sqinds[5] = 0;
  sqlstm.sqharm[5] = 0;
  sqlstm.sqhstl[6] = 8;
  sqlstm.sqhsts[6] = 0;
  sqlstm.sqtdso[7] = 0;
  sqlstm.sqphsv = sqlstm.sqhstv;
  sqlstm.sqindv[6] = (short *)0x0;
  sqlstm.sqinds[6] = 0;
  sqlstm.sqphsl = sqlstm.sqhstl;
  sqlstm.sqharm[6] = 0;
  sqlstm.sqadto[6] = 0;
  sqlstm.sqtdso[6] = 0;
  sqlstm.sqphss = sqlstm.sqhsts;
  sqlstm.sqpind = sqlstm.sqindv;
  sqlstm.sqhstl[7] = 0x103;
  sqlstm.sqhsts[7] = 0;
  sqlstm.sqindv[7] = (short *)0x0;
  sqlstm.sqpins = sqlstm.sqinds;
  sqlstm.sqinds[7] = 0;
  sqlstm.sqharm[7] = 0;
  sqlstm.sqadto[7] = 0;
  sqlstm.sqparm = sqlstm.sqharm;
  sqlstm.sqparc = sqlstm.sqharc;
  sqlstm.sqpadto = sqlstm.sqadto;
  sqlstm.sqptdso = sqlstm.sqtdso;
  sqlstm.sqhstv[1] = (uchar *)&T_Pan;
  sqlstm.sqhstv[2] = (uchar *)&T_ISSUING_BANK_CODE;
  sqlstm.sqhstv[3] = (uchar *)&T_ISSUING_BIN;
  sqlstm.sqhstv[4] = (uchar *)&T_PRODUCT_CODE;
  sqlstm.sqhstv[5] = (uchar *)&T_ICC_APP_INDX;
  sqlstm.sqhstv[6] = (uchar *)&T_KEY_CODE;
  sqlstm.sqhstv[7] = (uchar *)&T_EMV_Key;
  sqlcxt((long)nIndiceCtx * 0x10 + 0x713948,&sqlctx,&sqlstm,&sqlfpn);
  if (sqlca.sqlcode < 0) {
    sprintf(sLine,"[%.100s]",sqlca.sqlerrm.sqlerrmc);
    trace_event(sLine,1);
    trace_event("End  GET_EMV_KEYS(MALFUNCTION)",5);
    iVar1 = 3;
  }
  else if (response == 0) {
    memcpy(sEMV_key,T_EMV_Key.arr,(ulong)T_EMV_Key.len);
    if (debug_option == 1) {
      sprintf(sLine,"End   GET_EMV_KEYS(%s)",sEMV_key);
    }
    else {
      builtin_strncpy(sLine,"End   GET_EMV_KEYS(OK)",0x17);
    }
    trace_event(sLine,5);
    iVar1 = 0;
  }
  else {
    trace_event("End   GET_EMV_KEYS(NOK)",5);
    iVar1 = -1;
  }
  return iVar1;
}



// WARNING: Unknown calling convention

int GetResourceTMK(int nIndiceCtx,char *resource_id,char *TmK)

{
  int iVar1;
  ulong uVar2;
  uint uVar3;
  uchar *puVar4;
  bool bVar5;
  int response;
  char T_resource_id [7];
  sqlca sqlca;
  anon_struct_260_2_43c7b5cf T_TmK;
  char sLine [512];
  sqlexd_conflict8 sqlstm;
  
  uVar3 = 0xff;
  T_TmK.arr[0] = '\0';
  T_TmK.arr[1] = '\0';
  puVar4 = T_TmK.arr + 2;
  bVar5 = ((ulong)puVar4 & 4) != 0;
  if (bVar5) {
    T_TmK.arr[2] = '\0';
    T_TmK.arr[3] = '\0';
    T_TmK.arr[4] = '\0';
    T_TmK.arr[5] = '\0';
    uVar3 = 0xfb;
    puVar4 = T_TmK.arr + 6;
  }
  for (uVar2 = (ulong)(uVar3 >> 3); uVar2 != 0; uVar2 = uVar2 - 1) {
    puVar4[0] = '\0';
    puVar4[1] = '\0';
    puVar4[2] = '\0';
    puVar4[3] = '\0';
    puVar4[4] = '\0';
    puVar4[5] = '\0';
    puVar4[6] = '\0';
    puVar4[7] = '\0';
    puVar4 = puVar4 + 8;
  }
  if (!bVar5) {
    puVar4[0] = '\0';
    puVar4[1] = '\0';
    puVar4[2] = '\0';
    puVar4[3] = '\0';
    puVar4 = puVar4 + 4;
  }
  puVar4[0] = '\0';
  puVar4[1] = '\0';
  puVar4[2] = '\0';
  T_resource_id._0_4_ = *(undefined4 *)resource_id;
  T_resource_id[6] = '\0';
  T_TmK.len = 0;
  T_resource_id._4_2_ = *(undefined2 *)(resource_id + 4);
  sprintf(sLine,"Start GetResourceTMK (%.6s)",T_resource_id);
  trace_event(sLine,5);
  sqlstm.sqphsv = sqlstm.sqhstv;
  sqlstm.sqladtp = &sqladt;
  sqlstm.sqlety = 0x1100;
  sqlstm.sqadto[0] = 0;
  sqlstm.sqltdsp = &sqltds;
  sqlstm.sqtdso[0] = 0;
  sqlstm.sqadto[1] = 0;
  sqlstm.stmt = 
  "begin :response := PCRD_GET_HSM_KEY . GET_RES_TMK_KEY ( :T_resource_id , :T_TmK ) ; END ;";
  sqlstm.sqtdso[1] = 0;
  response = 0x38d;
  sqlstm.sqlvsn = 0xc;
  sqlstm.cud = sqlcud0;
  sqlstm.sqhstv[0] = (uchar *)&response;
  sqlstm.arrsiz = 8;
  sqlstm.iters = 1;
  sqlstm.offset = 0x275;
  sqlstm.occurs = 0;
  sqlstm.sqhstl[0] = 4;
  sqlstm.sqhsts[0] = 0;
  sqlstm.sqindv[0] = (short *)0x0;
  sqlstm.sqinds[0] = 0;
  sqlstm.sqharm[0] = 0;
  sqlstm.sqhstl[1] = 7;
  sqlstm.sqhsts[1] = 0;
  sqlstm.sqindv[1] = (short *)0x0;
  sqlstm.sqinds[1] = 0;
  sqlstm.sqharm[1] = 0;
  sqlstm.sqhstl[2] = 0x103;
  sqlstm.sqhsts[2] = 0;
  sqlstm.sqindv[2] = (short *)0x0;
  sqlstm.sqinds[2] = 0;
  sqlstm.sqharm[2] = 0;
  sqlstm.sqphsl = sqlstm.sqhstl;
  sqlstm.sqadto[2] = 0;
  sqlstm.sqphss = sqlstm.sqhsts;
  sqlstm.sqtdso[2] = 0;
  sqlstm.sqpind = sqlstm.sqindv;
  sqlstm.sqpins = sqlstm.sqinds;
  sqlstm.sqparm = sqlstm.sqharm;
  sqlstm.sqparc = sqlstm.sqharc;
  sqlstm.sqpadto = sqlstm.sqadto;
  sqlstm.sqptdso = sqlstm.sqtdso;
  sqlstm.sqlest = (uchar *)&sqlca;
  sqlstm.sqhstv[1] = (uchar *)T_resource_id;
  sqlstm.sqhstv[2] = (uchar *)&T_TmK;
  sqlcxt((long)nIndiceCtx * 0x10 + 0x713948,&sqlctx,&sqlstm,&sqlfpn);
  if (sqlca.sqlcode < 0) {
    strcpy(sLine,sqlca.sqlerrm.sqlerrmc);
    trace_event(sLine,1);
    trace_event("End  GetResourceTMK(MALFUNCTION)",5);
    iVar1 = 3;
  }
  else {
    sprintf(sLine,"response :  (%d)",(ulong)(uint)response);
    trace_event(sLine,5);
    if (response == 0) {
      memcpy(TmK,T_TmK.arr,(ulong)T_TmK.len);
      if (debug_option == 1) {
        sprintf(sLine,"End   GetResourceTMK (%.256s)",TmK);
      }
      else {
        builtin_strncpy(sLine,"End   GetResourceTMK (OK)",0x1a);
      }
      trace_event(sLine,5);
      iVar1 = 0;
    }
    else {
      trace_event("End   GetResourceTMK (NOK)",5);
      iVar1 = -1;
    }
  }
  return iVar1;
}



// WARNING: Unknown calling convention

int GetCVRFromIAD(int nIndiceCtx,char *Iss_App_Data,char *Iss_Bank_Code,char *Icc_App_Index,
                 char *Cvr)

{
  int iVar1;
  size_t sVar2;
  ulong uVar3;
  long lVar4;
  uint uVar5;
  uchar *puVar6;
  bool bVar7;
  byte bVar8;
  uchar auStack_2644 [8104];
  int response;
  char T_Icc_App_Index [5];
  char T_Iss_Bank_Code [7];
  anon_struct_68_2_43c7b5cf T_Cvr;
  sqlca sqlca;
  char T_Iss_App_Data [257];
  char sLine [512];
  sqlexd_conflict8 sqlstm;
  
  bVar8 = 0;
  sVar2 = strlen(Iss_App_Data);
  sprintf(sLine,"Start GetCVRFromIAD:IAD(%s),len(%d),Iss(%s),Icc(%s)",Iss_App_Data,sVar2);
  trace_event(sLine,5);
  puVar6 = T_Cvr.arr + 2;
  uVar5 = 0x3f;
  T_Cvr.arr[0] = '\0';
  T_Cvr.arr[1] = '\0';
  bVar7 = ((ulong)puVar6 & 4) != 0;
  if (bVar7) {
    T_Cvr.arr[2] = '\0';
    T_Cvr.arr[3] = '\0';
    T_Cvr.arr[4] = '\0';
    T_Cvr.arr[5] = '\0';
    uVar5 = 0x3b;
    puVar6 = T_Cvr.arr + 6;
  }
  for (uVar3 = (ulong)(uVar5 >> 3); uVar3 != 0; uVar3 = uVar3 - 1) {
    puVar6[0] = '\0';
    puVar6[1] = '\0';
    puVar6[2] = '\0';
    puVar6[3] = '\0';
    puVar6[4] = '\0';
    puVar6[5] = '\0';
    puVar6[6] = '\0';
    puVar6[7] = '\0';
    puVar6 = puVar6 + (ulong)bVar8 * -0x10 + 8;
  }
  if (!bVar7) {
    puVar6[0] = '\0';
    puVar6[1] = '\0';
    puVar6[2] = '\0';
    puVar6[3] = '\0';
    puVar6 = puVar6 + 4;
  }
  puVar6[0] = '\0';
  puVar6[1] = '\0';
  puVar6[2] = '\0';
  T_Cvr.len = 0;
  puVar6 = (uchar *)T_Iss_App_Data;
  for (lVar4 = 0x20; lVar4 != 0; lVar4 = lVar4 + -1) {
    puVar6[0] = '\0';
    puVar6[1] = '\0';
    puVar6[2] = '\0';
    puVar6[3] = '\0';
    puVar6[4] = '\0';
    puVar6[5] = '\0';
    puVar6[6] = '\0';
    puVar6[7] = '\0';
    puVar6 = puVar6 + (ulong)bVar8 * -0x10 + 8;
  }
  *puVar6 = '\0';
  sVar2 = strlen(Iss_App_Data);
  memcpy(T_Iss_App_Data,Iss_App_Data,sVar2);
  T_Icc_App_Index[0] = '\0';
  T_Icc_App_Index[1] = '\0';
  T_Icc_App_Index[2] = '\0';
  T_Icc_App_Index[3] = '\0';
  T_Icc_App_Index[4] = '\0';
  sVar2 = strlen(Icc_App_Index);
  memcpy(T_Icc_App_Index,Icc_App_Index,sVar2);
  T_Iss_Bank_Code[0] = '\0';
  T_Iss_Bank_Code[1] = '\0';
  T_Iss_Bank_Code[2] = '\0';
  T_Iss_Bank_Code[3] = '\0';
  T_Iss_Bank_Code[4] = '\0';
  T_Iss_Bank_Code[5] = '\0';
  T_Iss_Bank_Code[6] = '\0';
  sVar2 = strlen(Iss_Bank_Code);
  memcpy(T_Iss_Bank_Code,Iss_Bank_Code,sVar2);
  sqlstm.sqlest = (uchar *)&sqlca;
  sqlstm.sqladtp = &sqladt;
  sqlstm.sqadto[0] = 0;
  sqlstm.sqtdso[0] = 0;
  sqlstm.sqltdsp = &sqltds;
  sqlstm.sqlety = 0x1100;
  sqlstm.sqadto[1] = 0;
  sqlstm.stmt = 
  "begin :response := PCRD_EMV_TOOLS . GET_EMV_IAD_CVR ( :T_Iss_Bank_Code , :T_Iss_App_Data , :T_Icc_App_Index , :T_Cvr ) ; END ;"
  ;
  sqlstm.sqtdso[1] = 0;
  response = 0x38d;
  sqlstm.cud = sqlcud0;
  sqlstm.sqhstv[0] = (uchar *)&response;
  sqlstm.sqlvsn = 0xc;
  sqlstm.arrsiz = 8;
  sqlstm.iters = 1;
  sqlstm.offset = 0x290;
  sqlstm.occurs = 0;
  sqlstm.sqhstl[0] = 4;
  sqlstm.sqhsts[0] = 0;
  sqlstm.sqindv[0] = (short *)0x0;
  sqlstm.sqinds[0] = 0;
  sqlstm.sqharm[0] = 0;
  sqlstm.sqhstl[1] = 7;
  sqlstm.sqhsts[1] = 0;
  sqlstm.sqindv[1] = (short *)0x0;
  sqlstm.sqinds[1] = 0;
  sqlstm.sqharm[1] = 0;
  sqlstm.sqhstl[2] = 0x101;
  sqlstm.sqhsts[2] = 0;
  sqlstm.sqindv[2] = (short *)0x0;
  sqlstm.sqinds[2] = 0;
  sqlstm.sqharm[2] = 0;
  sqlstm.sqadto[4] = 0;
  sqlstm.sqtdso[4] = 0;
  sqlstm.sqphsv = sqlstm.sqhstv;
  sqlstm.sqadto[2] = 0;
  sqlstm.sqphsl = sqlstm.sqhstl;
  sqlstm.sqtdso[2] = 0;
  sqlstm.sqhstl[3] = 5;
  sqlstm.sqhsts[3] = 0;
  sqlstm.sqphss = sqlstm.sqhsts;
  sqlstm.sqindv[3] = (short *)0x0;
  sqlstm.sqpind = sqlstm.sqindv;
  sqlstm.sqinds[3] = 0;
  sqlstm.sqharm[3] = 0;
  sqlstm.sqadto[3] = 0;
  sqlstm.sqpins = sqlstm.sqinds;
  sqlstm.sqtdso[3] = 0;
  sqlstm.sqhstl[4] = 0x43;
  sqlstm.sqparm = sqlstm.sqharm;
  sqlstm.sqhsts[4] = 0;
  sqlstm.sqindv[4] = (short *)0x0;
  sqlstm.sqinds[4] = 0;
  sqlstm.sqparc = sqlstm.sqharc;
  sqlstm.sqharm[4] = 0;
  sqlstm.sqpadto = sqlstm.sqadto;
  sqlstm.sqptdso = sqlstm.sqtdso;
  sqlstm.sqhstv[1] = (uchar *)T_Iss_Bank_Code;
  sqlstm.sqhstv[2] = (uchar *)T_Iss_App_Data;
  sqlstm.sqhstv[3] = (uchar *)T_Icc_App_Index;
  sqlstm.sqhstv[4] = (uchar *)&T_Cvr;
  sqlcxt((long)nIndiceCtx * 0x10 + 0x713948,&sqlctx,&sqlstm,&sqlfpn);
  if (sqlca.sqlcode < 0) {
    strcpy(sLine,sqlca.sqlerrm.sqlerrmc);
    trace_event(sLine,1);
    trace_event("End  GetCVRFromIAD(MALFUNCTION)",5);
    iVar1 = 3;
  }
  else if (response == 0) {
    memcpy(Cvr,T_Cvr.arr,(ulong)T_Cvr.len);
    sprintf(sLine,"End   GetCVRFromIAD (%s)",Cvr);
    trace_event(sLine,5);
    iVar1 = 0;
  }
  else {
    trace_event("End   GetCVRFromIAD (NOK)",5);
    iVar1 = -1;
  }
  return iVar1;
}



// WARNING: Unknown calling convention

int Get_EMV_Key(int nIndexCtx,char *sPan,char *sKeyCode,char *sEmvKey)

{
  int iVar1;
  size_t sVar2;
  void *pvVar3;
  ulong uVar4;
  uint uVar5;
  uchar *puVar6;
  bool bVar7;
  byte bVar8;
  uchar auStack_2564 [7944];
  int response;
  anon_struct_8_2_43c7b5cf T_KeyCode;
  anon_struct_26_2_43c7b5cf T_Pan;
  sqlca sqlca;
  anon_struct_260_2_43c7b5cf T_EmvKey;
  char sLine [512];
  sqlexd_conflict8 sqlstm;
  
  bVar8 = 0;
  if (debug_option == 1) {
    sprintf(sLine,"Start Get_EMV_Key(%s,%s)",sPan,sKeyCode);
  }
  else {
    sprintf(sLine,"Start Get_EMV_Key(%s)");
  }
  trace_event(sLine,5);
  T_Pan.arr[0] = '\0';
  T_Pan.arr[1] = '\0';
  T_Pan.arr[2] = '\0';
  T_Pan.arr[3] = '\0';
  T_Pan.arr[4] = '\0';
  T_Pan.arr[5] = '\0';
  T_Pan.arr[6] = '\0';
  T_Pan.arr[7] = '\0';
  puVar6 = T_EmvKey.arr + 2;
  T_Pan.arr[0x14] = '\0';
  T_Pan.arr[0x15] = '\0';
  T_Pan.arr[8] = '\0';
  T_Pan.arr[9] = '\0';
  T_Pan.arr[10] = '\0';
  T_Pan.arr[0xb] = '\0';
  T_Pan.arr[0xc] = '\0';
  T_Pan.arr[0xd] = '\0';
  T_Pan.arr[0xe] = '\0';
  T_Pan.arr[0xf] = '\0';
  T_Pan.len = 0x16;
  T_Pan.arr[0x10] = '\0';
  T_Pan.arr[0x11] = '\0';
  T_Pan.arr[0x12] = '\0';
  T_Pan.arr[0x13] = '\0';
  T_KeyCode.len = 4;
  bVar7 = ((ulong)puVar6 & 4) != 0;
  T_Pan.arr[0x16] = '\0';
  T_KeyCode.arr[0] = '\0';
  T_KeyCode.arr[1] = '\0';
  T_KeyCode.arr[2] = '\0';
  T_KeyCode.arr[3] = '\0';
  uVar5 = 0xff;
  T_KeyCode.arr[4] = '\0';
  T_EmvKey.arr[0] = '\0';
  T_EmvKey.arr[1] = '\0';
  if (bVar7) {
    T_EmvKey.arr[2] = '\0';
    T_EmvKey.arr[3] = '\0';
    T_EmvKey.arr[4] = '\0';
    T_EmvKey.arr[5] = '\0';
    uVar5 = 0xfb;
    puVar6 = T_EmvKey.arr + 6;
  }
  for (uVar4 = (ulong)(uVar5 >> 3); uVar4 != 0; uVar4 = uVar4 - 1) {
    puVar6[0] = '\0';
    puVar6[1] = '\0';
    puVar6[2] = '\0';
    puVar6[3] = '\0';
    puVar6[4] = '\0';
    puVar6[5] = '\0';
    puVar6[6] = '\0';
    puVar6[7] = '\0';
    puVar6 = puVar6 + (ulong)bVar8 * -0x10 + 8;
  }
  if (!bVar7) {
    puVar6[0] = '\0';
    puVar6[1] = '\0';
    puVar6[2] = '\0';
    puVar6[3] = '\0';
    puVar6 = puVar6 + 4;
  }
  puVar6[0] = '\0';
  puVar6[1] = '\0';
  puVar6[2] = '\0';
  T_EmvKey.len = 0x100;
  sVar2 = strlen(sPan);
  pvVar3 = memcpy(T_Pan.arr,sPan,sVar2);
  T_Pan.len = (ushort)sVar2;
  if (debug_option == 1) {
    sprintf(sLine,"T_Pan     .len=[%d] .arr=[%s]",sVar2 & 0xffff,pvVar3);
    trace_event(sLine,5);
  }
  sVar2 = strlen(sKeyCode);
  pvVar3 = memcpy(T_KeyCode.arr,sKeyCode,sVar2);
  T_KeyCode.len = (ushort)sVar2;
  sprintf(sLine,"1T_KeyCode .len=[%d] .arr=[%s]",sVar2 & 0xffff,pvVar3);
  trace_event(sLine,5);
  sqlstm.sqladtp = &sqladt;
  sqlstm.sqlety = 0x1100;
  sqlstm.sqadto[0] = 0;
  sqlstm.sqltdsp = &sqltds;
  sqlstm.sqtdso[0] = 0;
  sqlstm.sqadto[1] = 0;
  sqlstm.stmt = 
  "begin :response := PCRD_GET_HSM_KEY_2 . GET_EMV_KEY ( :T_Pan , :T_KeyCode , :T_EmvKey ) ; commit ; END ;"
  ;
  sqlstm.sqtdso[1] = 0;
  response = 0x38d;
  sqlstm.cud = sqlcud0;
  sqlstm.sqhstv[0] = (uchar *)&response;
  sqlstm.sqlvsn = 0xc;
  sqlstm.arrsiz = 8;
  sqlstm.iters = 1;
  sqlstm.sqphsv = sqlstm.sqhstv;
  sqlstm.offset = 0x2b3;
  sqlstm.occurs = 0;
  sqlstm.sqhstl[0] = 4;
  sqlstm.sqhsts[0] = 0;
  sqlstm.sqindv[0] = (short *)0x0;
  sqlstm.sqinds[0] = 0;
  sqlstm.sqharm[0] = 0;
  sqlstm.sqhstl[1] = 0x19;
  sqlstm.sqhsts[1] = 0;
  sqlstm.sqindv[1] = (short *)0x0;
  sqlstm.sqinds[1] = 0;
  sqlstm.sqharm[1] = 0;
  sqlstm.sqhstl[2] = 7;
  sqlstm.sqhsts[2] = 0;
  sqlstm.sqindv[2] = (short *)0x0;
  sqlstm.sqinds[2] = 0;
  sqlstm.sqharm[2] = 0;
  sqlstm.sqphsl = sqlstm.sqhstl;
  sqlstm.sqadto[2] = 0;
  sqlstm.sqphss = sqlstm.sqhsts;
  sqlstm.sqtdso[2] = 0;
  sqlstm.sqhstl[3] = 0x103;
  sqlstm.sqpind = sqlstm.sqindv;
  sqlstm.sqhsts[3] = 0;
  sqlstm.sqindv[3] = (short *)0x0;
  sqlstm.sqpins = sqlstm.sqinds;
  sqlstm.sqinds[3] = 0;
  sqlstm.sqharm[3] = 0;
  sqlstm.sqadto[3] = 0;
  sqlstm.sqparm = sqlstm.sqharm;
  sqlstm.sqtdso[3] = 0;
  sqlstm.sqparc = sqlstm.sqharc;
  sqlstm.sqpadto = sqlstm.sqadto;
  sqlstm.sqptdso = sqlstm.sqtdso;
  sqlstm.sqlest = (uchar *)&sqlca;
  sqlstm.sqhstv[1] = (uchar *)&T_Pan;
  sqlstm.sqhstv[2] = (uchar *)&T_KeyCode;
  sqlstm.sqhstv[3] = (uchar *)&T_EmvKey;
  sqlcxt((long)nIndexCtx * 0x10 + 0x713948,&sqlctx,&sqlstm,&sqlfpn);
  if (sqlca.sqlcode < 0) {
    sprintf(sLine,"[%.100s]",sqlca.sqlerrm.sqlerrmc);
    trace_event(sLine,1);
    trace_event("End  Get_EMV_Key(MALFUNCTION)",5);
    iVar1 = 3;
  }
  else {
    sprintf(sLine,"response : %d",(ulong)(uint)response);
    trace_event(sLine,5);
    if (response == 0) {
      memcpy(sEmvKey,T_EmvKey.arr,(ulong)T_EmvKey.len);
      if (debug_option == 1) {
        sprintf(sLine,"End   Get_EMV_Key(OK). sEmvKey=[%s]",sEmvKey);
      }
      else {
        builtin_strncpy(sLine,"End   Get_EMV_Key(OK)",0x16);
      }
      trace_event(sLine,5);
      iVar1 = 0;
    }
    else {
      trace_event("End   Get_EMV_Key(NOK)",5);
      iVar1 = -1;
    }
  }
  return iVar1;
}



// WARNING: Unknown calling convention

int Get_IssScriptData(int nIndexCtx,char *sPan,char *sIssScriptData,int *pSequence,
                     char *pAuthDeclineFlag,char *pTransDate,char *pRefNbr)

{
  int iVar1;
  size_t sVar2;
  void *pvVar3;
  ulong uVar4;
  uint uVar5;
  uchar *puVar6;
  bool bVar7;
  byte bVar8;
  uchar auStack_2564 [7868];
  short pl_null_IssScriptData_ind;
  short pl_null_AuthDeclineFlag_ind;
  anon_struct_4_2_43c7b5cf T_auth_decline_flag;
  int response;
  int T_Sequence;
  anon_struct_20_2_43c7b5cf T_RRN;
  anon_struct_20_2_43c7b5cf T_TRANDTIME;
  anon_struct_26_2_43c7b5cf T_Pan;
  sqlca sqlca;
  anon_struct_260_2_43c7b5cf T_IssScriptData;
  char sLine [512];
  sqlexd_conflict8 sqlstm;
  
  bVar8 = 0;
  if (debug_option == 1) {
    sprintf(sLine,"Start Get_IssScriptData(%s)",sPan);
    trace_event(sLine,5);
  }
  else {
    builtin_strncpy(sLine,"Start Get_IssScriptData(",0x18);
    builtin_strncpy(sLine + 0x18,"OK)",4);
    trace_event(sLine,5);
  }
  puVar6 = T_IssScriptData.arr + 2;
  T_TRANDTIME.len = 0;
  bVar7 = ((ulong)puVar6 & 4) != 0;
  T_Pan.arr[0] = '\0';
  T_Pan.arr[1] = '\0';
  T_Pan.arr[2] = '\0';
  T_Pan.arr[3] = '\0';
  T_Pan.arr[4] = '\0';
  T_Pan.arr[5] = '\0';
  T_Pan.arr[6] = '\0';
  T_Pan.arr[7] = '\0';
  T_RRN.arr[0] = '\0';
  T_RRN.arr[1] = '\0';
  T_RRN.arr[2] = '\0';
  T_RRN.arr[3] = '\0';
  T_RRN.arr[4] = '\0';
  T_RRN.arr[5] = '\0';
  T_RRN.arr[6] = '\0';
  T_RRN.arr[7] = '\0';
  T_TRANDTIME.arr[0] = '\0';
  T_TRANDTIME.arr[1] = '\0';
  T_TRANDTIME.arr[2] = '\0';
  T_TRANDTIME.arr[3] = '\0';
  T_TRANDTIME.arr[4] = '\0';
  T_TRANDTIME.arr[5] = '\0';
  T_TRANDTIME.arr[6] = '\0';
  T_TRANDTIME.arr[7] = '\0';
  T_Pan.arr[8] = '\0';
  T_Pan.arr[9] = '\0';
  T_Pan.arr[10] = '\0';
  T_Pan.arr[0xb] = '\0';
  T_Pan.arr[0xc] = '\0';
  T_Pan.arr[0xd] = '\0';
  T_Pan.arr[0xe] = '\0';
  T_Pan.arr[0xf] = '\0';
  uVar5 = 0xff;
  T_Pan.arr[0x10] = '\0';
  T_Pan.arr[0x11] = '\0';
  T_Pan.arr[0x12] = '\0';
  T_Pan.arr[0x13] = '\0';
  T_Pan.arr[0x14] = '\0';
  T_Pan.arr[0x15] = '\0';
  T_Pan.arr[0x16] = '\0';
  T_RRN.arr[8] = '\0';
  T_RRN.arr[9] = '\0';
  T_RRN.arr[10] = '\0';
  T_RRN.arr[0xb] = '\0';
  T_RRN.arr[0xc] = '\0';
  T_RRN.arr[0xd] = '\0';
  T_RRN.arr[0xe] = '\0';
  T_RRN.arr[0xf] = '\0';
  T_RRN.arr[0x10] = '\0';
  T_TRANDTIME.arr[8] = '\0';
  T_TRANDTIME.arr[9] = '\0';
  T_TRANDTIME.arr[10] = '\0';
  T_TRANDTIME.arr[0xb] = '\0';
  T_TRANDTIME.arr[0xc] = '\0';
  T_TRANDTIME.arr[0xd] = '\0';
  T_TRANDTIME.arr[0xe] = '\0';
  T_TRANDTIME.arr[0xf] = '\0';
  T_TRANDTIME.arr[0x10] = '\0';
  T_Pan.len = 0;
  T_RRN.len = 0;
  T_IssScriptData.arr[0] = '\0';
  T_IssScriptData.arr[1] = '\0';
  if (bVar7) {
    T_IssScriptData.arr[2] = '\0';
    T_IssScriptData.arr[3] = '\0';
    T_IssScriptData.arr[4] = '\0';
    T_IssScriptData.arr[5] = '\0';
    uVar5 = 0xfb;
    puVar6 = T_IssScriptData.arr + 6;
  }
  for (uVar4 = (ulong)(uVar5 >> 3); uVar4 != 0; uVar4 = uVar4 - 1) {
    puVar6[0] = '\0';
    puVar6[1] = '\0';
    puVar6[2] = '\0';
    puVar6[3] = '\0';
    puVar6[4] = '\0';
    puVar6[5] = '\0';
    puVar6[6] = '\0';
    puVar6[7] = '\0';
    puVar6 = puVar6 + (ulong)bVar8 * -0x10 + 8;
  }
  if (!bVar7) {
    puVar6[0] = '\0';
    puVar6[1] = '\0';
    puVar6[2] = '\0';
    puVar6[3] = '\0';
    puVar6 = puVar6 + 4;
  }
  puVar6[0] = '\0';
  puVar6[1] = '\0';
  puVar6[2] = '\0';
  T_auth_decline_flag.len = 0;
  T_IssScriptData.len = 0;
  T_auth_decline_flag.arr[0] = '\0';
  T_auth_decline_flag.arr[1] = '\0';
  sVar2 = strlen(sPan);
  pvVar3 = memcpy(T_Pan.arr,sPan,sVar2);
  T_Pan.len = (ushort)sVar2;
  if (debug_option == 1) {
    sprintf(sLine,"T_Pan.arr=[%s], T_Pan.len=[%d])",pvVar3);
    trace_event(sLine,5);
  }
  sVar2 = strlen(pRefNbr);
  memcpy(T_RRN.arr,pRefNbr,sVar2);
  T_RRN.len = (ushort)sVar2;
  sVar2 = strlen(pTransDate);
  memcpy(T_TRANDTIME.arr,pTransDate,sVar2);
  T_Sequence = *pSequence;
  T_TRANDTIME.len = (ushort)sVar2;
  sprintf(sLine,"T_Sequence=[%d])");
  trace_event(sLine,5);
  sqlstm.sqladtp = &sqladt;
  sqlstm.sqlety = 0x1100;
  sqlstm.sqadto[0] = 0;
  sqlstm.sqtdso[0] = 0;
  sqlstm.sqltdsp = &sqltds;
  sqlstm.sqadto[1] = 0;
  sqlstm.sqtdso[1] = 0;
  sqlstm.stmt = 
  "begin :response := PCRD_GET_HSM_KEY_2 . GET_ISS_SCRIPT_DATA ( :T_Pan , :T_IssScriptData:pl_null_IssScriptData_ind , :T_Sequence , :T_TRANDTIME , :T_RRN , :T_auth_decline_flag:pl_null_AuthDeclineFlag_ind ) ; END ;"
  ;
  response = 0x38d;
  sqlstm.sqlvsn = 0xc;
  sqlstm.arrsiz = 8;
  sqlstm.cud = sqlcud0;
  sqlstm.sqhstv[0] = (uchar *)&response;
  sqlstm.iters = 1;
  sqlstm.offset = 0x2d2;
  sqlstm.occurs = 0;
  sqlstm.sqhstl[0] = 4;
  sqlstm.sqhsts[0] = 0;
  sqlstm.sqindv[0] = (short *)0x0;
  sqlstm.sqindv[2] = &pl_null_IssScriptData_ind;
  sqlstm.sqinds[0] = 0;
  sqlstm.sqharm[0] = 0;
  sqlstm.sqhstl[1] = 0x19;
  sqlstm.sqhstv[3] = (uchar *)&T_Sequence;
  sqlstm.sqhsts[1] = 0;
  sqlstm.sqindv[1] = (short *)0x0;
  sqlstm.sqinds[1] = 0;
  sqlstm.sqharm[1] = 0;
  sqlstm.sqhstl[2] = 0x103;
  sqlstm.sqhsts[2] = 0;
  sqlstm.sqinds[2] = 0;
  sqlstm.sqadto[4] = 0;
  sqlstm.sqhstv[6] = (uchar *)&T_auth_decline_flag;
  sqlstm.sqtdso[4] = 0;
  sqlstm.sqadto[2] = 0;
  sqlstm.sqadto[5] = 0;
  sqlstm.sqtdso[2] = 0;
  sqlstm.sqtdso[5] = 0;
  sqlstm.sqindv[6] = &pl_null_AuthDeclineFlag_ind;
  sqlstm.sqadto[3] = 0;
  sqlstm.sqharm[2] = 0;
  sqlstm.sqhstl[3] = 4;
  sqlstm.sqhsts[3] = 0;
  sqlstm.sqindv[3] = (short *)0x0;
  sqlstm.sqinds[3] = 0;
  sqlstm.sqharm[3] = 0;
  sqlstm.sqtdso[3] = 0;
  sqlstm.sqhstl[4] = 0x13;
  sqlstm.sqhsts[4] = 0;
  sqlstm.sqindv[4] = (short *)0x0;
  sqlstm.sqinds[4] = 0;
  sqlstm.sqharm[4] = 0;
  sqlstm.sqhstl[5] = 0x13;
  sqlstm.sqhsts[5] = 0;
  sqlstm.sqindv[5] = (short *)0x0;
  sqlstm.sqinds[5] = 0;
  sqlstm.sqharm[5] = 0;
  sqlstm.sqhstl[6] = 4;
  sqlstm.sqhsts[6] = 0;
  sqlstm.sqinds[6] = 0;
  sqlstm.sqharm[6] = 0;
  sqlstm.sqadto[6] = 0;
  sqlstm.sqtdso[6] = 0;
  sqlstm.sqphsv = sqlstm.sqhstv;
  sqlstm.sqphsl = sqlstm.sqhstl;
  sqlstm.sqphss = sqlstm.sqhsts;
  sqlstm.sqpind = sqlstm.sqindv;
  sqlstm.sqpins = sqlstm.sqinds;
  sqlstm.sqparm = sqlstm.sqharm;
  sqlstm.sqparc = sqlstm.sqharc;
  sqlstm.sqpadto = sqlstm.sqadto;
  sqlstm.sqptdso = sqlstm.sqtdso;
  sqlstm.sqlest = (uchar *)&sqlca;
  sqlstm.sqhstv[1] = (uchar *)&T_Pan;
  sqlstm.sqhstv[2] = (uchar *)&T_IssScriptData;
  sqlstm.sqhstv[4] = (uchar *)&T_TRANDTIME;
  sqlstm.sqhstv[5] = (uchar *)&T_RRN;
  sqlcxt((long)nIndexCtx * 0x10 + 0x713948,&sqlctx,&sqlstm,&sqlfpn);
  if (sqlca.sqlcode < 0) {
    sprintf(sLine,"[%.100s]",sqlca.sqlerrm.sqlerrmc);
    trace_event(sLine,1);
    trace_event("End  Get_IssScriptData(MALFUNCTION)",5);
    iVar1 = 3;
  }
  else if (response == 0) {
    memcpy(sIssScriptData,T_IssScriptData.arr,(ulong)T_IssScriptData.len);
    *pSequence = T_Sequence;
    memcpy(pAuthDeclineFlag,T_auth_decline_flag.arr,(ulong)T_auth_decline_flag.len);
    sprintf(sLine,
            "End   Get_IssScriptData(OK). pSequence=[%d], sIssScriptData=[%s], pAuthDeclineFlag=[%s]"
            ,(ulong)(uint)*pSequence,sIssScriptData,pAuthDeclineFlag);
    trace_event(sLine,5);
    iVar1 = 0;
  }
  else if (pl_null_IssScriptData_ind == -1) {
    trace_event("End   Get_IssScriptData(NOK) <NO ISSUER SCRIPT TO SEND>",5);
    iVar1 = -1;
  }
  else {
    trace_event("End   Get_IssScriptData(NOK)",5);
    iVar1 = -1;
  }
  return iVar1;
}



// WARNING: Unknown calling convention

int Update_SentIssScripts(int nIndexCtx,char *sPan,char *sCVR)

{
  size_t sVar1;
  void *pvVar2;
  ulong uVar3;
  uint uVar4;
  uchar *puVar5;
  bool bVar6;
  byte bVar7;
  uchar auStack_2414 [6806];
  short pl_null_err_msg_ind;
  int response;
  anon_struct_26_2_43c7b5cf T_Pan;
  anon_struct_36_2_43c7b5cf T_CVR;
  sqlca sqlca;
  char sLine [512];
  sqlexd_conflict8 sqlstm;
  anon_struct_1028_2_43c7b5cf T_err_msg;
  
  bVar7 = 0;
  if (debug_option == 1) {
    sprintf(sLine,"Start Update_SentIssScripts(%s)",sPan);
    trace_event(sLine,5);
  }
  else {
    builtin_strncpy(sLine,"Start Update_SentIssScripts()",0x1e);
    trace_event(sLine,5);
  }
  T_Pan.arr[0] = '\0';
  T_Pan.arr[1] = '\0';
  T_Pan.arr[2] = '\0';
  T_Pan.arr[3] = '\0';
  T_Pan.arr[4] = '\0';
  T_Pan.arr[5] = '\0';
  T_Pan.arr[6] = '\0';
  T_Pan.arr[7] = '\0';
  T_CVR.arr[0] = '\0';
  T_CVR.arr[1] = '\0';
  T_CVR.arr[2] = '\0';
  T_CVR.arr[3] = '\0';
  T_CVR.arr[4] = '\0';
  T_CVR.arr[5] = '\0';
  T_CVR.arr[6] = '\0';
  T_CVR.arr[7] = '\0';
  T_Pan.arr[0x14] = '\0';
  T_Pan.arr[0x15] = '\0';
  puVar5 = T_err_msg.arr + 2;
  T_Pan.len = 0;
  T_Pan.arr[8] = '\0';
  T_Pan.arr[9] = '\0';
  T_Pan.arr[10] = '\0';
  T_Pan.arr[0xb] = '\0';
  T_Pan.arr[0xc] = '\0';
  T_Pan.arr[0xd] = '\0';
  T_Pan.arr[0xe] = '\0';
  T_Pan.arr[0xf] = '\0';
  T_CVR.len = 0;
  bVar6 = ((ulong)puVar5 & 4) != 0;
  T_Pan.arr[0x10] = '\0';
  T_Pan.arr[0x11] = '\0';
  T_Pan.arr[0x12] = '\0';
  T_Pan.arr[0x13] = '\0';
  T_Pan.arr[0x16] = '\0';
  uVar4 = 0x3ff;
  T_CVR.arr[8] = '\0';
  T_CVR.arr[9] = '\0';
  T_CVR.arr[10] = '\0';
  T_CVR.arr[0xb] = '\0';
  T_CVR.arr[0xc] = '\0';
  T_CVR.arr[0xd] = '\0';
  T_CVR.arr[0xe] = '\0';
  T_CVR.arr[0xf] = '\0';
  T_CVR.arr[0x10] = '\0';
  T_CVR.arr[0x11] = '\0';
  T_CVR.arr[0x12] = '\0';
  T_CVR.arr[0x13] = '\0';
  T_CVR.arr[0x14] = '\0';
  T_CVR.arr[0x15] = '\0';
  T_CVR.arr[0x16] = '\0';
  T_CVR.arr[0x17] = '\0';
  T_CVR.arr[0x18] = '\0';
  T_CVR.arr[0x19] = '\0';
  T_CVR.arr[0x1a] = '\0';
  T_CVR.arr[0x1b] = '\0';
  T_CVR.arr[0x1c] = '\0';
  T_CVR.arr[0x1d] = '\0';
  T_CVR.arr[0x1e] = '\0';
  T_CVR.arr[0x1f] = '\0';
  T_CVR.arr[0x20] = '\0';
  T_err_msg.arr[0] = '\0';
  T_err_msg.arr[1] = '\0';
  if (bVar6) {
    T_err_msg.arr[2] = '\0';
    T_err_msg.arr[3] = '\0';
    T_err_msg.arr[4] = '\0';
    T_err_msg.arr[5] = '\0';
    uVar4 = 0x3fb;
    puVar5 = T_err_msg.arr + 6;
  }
  for (uVar3 = (ulong)(uVar4 >> 3); uVar3 != 0; uVar3 = uVar3 - 1) {
    puVar5[0] = '\0';
    puVar5[1] = '\0';
    puVar5[2] = '\0';
    puVar5[3] = '\0';
    puVar5[4] = '\0';
    puVar5[5] = '\0';
    puVar5[6] = '\0';
    puVar5[7] = '\0';
    puVar5 = puVar5 + (ulong)bVar7 * -0x10 + 8;
  }
  if (!bVar6) {
    puVar5[0] = '\0';
    puVar5[1] = '\0';
    puVar5[2] = '\0';
    puVar5[3] = '\0';
    puVar5 = puVar5 + 4;
  }
  puVar5[0] = '\0';
  puVar5[1] = '\0';
  puVar5[2] = '\0';
  T_err_msg.len = 0;
  sVar1 = strlen(sPan);
  pvVar2 = memcpy(T_Pan.arr,sPan,sVar1);
  T_Pan.len = (ushort)sVar1;
  if (debug_option == 1) {
    sprintf(sLine,"T_Pan.arr=[%s], T_Pan.len=[%d])",pvVar2,sVar1 & 0xffff);
    trace_event(sLine,5);
  }
  sVar1 = strlen(sCVR);
  pvVar2 = memcpy(T_CVR.arr,sCVR,sVar1);
  T_CVR.len = (ushort)sVar1;
  sprintf(sLine,"T_CVR.arr=[%s], T_CVR.len=[%d])",pvVar2);
  trace_event(sLine,5);
  sqlstm.sqlest = (uchar *)&sqlca;
  sqlstm.sqadto[0] = 0;
  sqlstm.sqladtp = &sqladt;
  sqlstm.sqtdso[0] = 0;
  sqlstm.sqadto[1] = 0;
  sqlstm.sqltdsp = &sqltds;
  sqlstm.sqtdso[1] = 0;
  response = 0x38d;
  sqlstm.stmt = 
  "begin :response := PCRD_GET_HSM_KEY_2 . UPDATE_SENT_ISS_SCRIPTS ( :T_Pan , :T_CVR , :T_err_msg:pl_null_err_msg_ind ) ; END ;"
  ;
  sqlstm.sqlvsn = 0xc;
  sqlstm.arrsiz = 8;
  sqlstm.iters = 1;
  sqlstm.cud = sqlcud0;
  sqlstm.offset = 0x2fd;
  sqlstm.sqlety = 0x1100;
  sqlstm.sqhstv[0] = (uchar *)&response;
  sqlstm.occurs = 0;
  sqlstm.sqhstl[0] = 4;
  sqlstm.sqindv[3] = &pl_null_err_msg_ind;
  sqlstm.sqhsts[0] = 0;
  sqlstm.sqindv[0] = (short *)0x0;
  sqlstm.sqinds[0] = 0;
  sqlstm.sqharm[0] = 0;
  sqlstm.sqhstl[1] = 0x19;
  sqlstm.sqhsts[1] = 0;
  sqlstm.sqindv[1] = (short *)0x0;
  sqlstm.sqinds[1] = 0;
  sqlstm.sqharm[1] = 0;
  sqlstm.sqhstl[2] = 0x23;
  sqlstm.sqhsts[2] = 0;
  sqlstm.sqindv[2] = (short *)0x0;
  sqlstm.sqinds[2] = 0;
  sqlstm.sqharm[2] = 0;
  sqlstm.sqphsv = sqlstm.sqhstv;
  sqlstm.sqadto[2] = 0;
  sqlstm.sqtdso[2] = 0;
  sqlstm.sqphsl = sqlstm.sqhstl;
  sqlstm.sqhstl[3] = 0x403;
  sqlstm.sqhsts[3] = 0;
  sqlstm.sqphss = sqlstm.sqhsts;
  sqlstm.sqinds[3] = 0;
  sqlstm.sqpind = sqlstm.sqindv;
  sqlstm.sqharm[3] = 0;
  sqlstm.sqadto[3] = 0;
  sqlstm.sqtdso[3] = 0;
  sqlstm.sqpins = sqlstm.sqinds;
  sqlstm.sqparm = sqlstm.sqharm;
  sqlstm.sqparc = sqlstm.sqharc;
  sqlstm.sqpadto = sqlstm.sqadto;
  sqlstm.sqptdso = sqlstm.sqtdso;
  sqlstm.sqhstv[1] = (uchar *)&T_Pan;
  sqlstm.sqhstv[2] = (uchar *)&T_CVR;
  sqlstm.sqhstv[3] = (uchar *)&T_err_msg;
  sqlcxt((long)nIndexCtx * 0x10 + 0x713948,&sqlctx,&sqlstm,&sqlfpn);
  if (sqlca.sqlcode < 0) {
    sprintf(sLine,"[%.100s]",sqlca.sqlerrm.sqlerrmc);
    trace_event(sLine,1);
    trace_event("End  Update_SentIssScripts(MALFUNCTION)",5);
    response = 3;
  }
  else {
    sprintf(sLine,"T_err_msg.len=[%d], T_err_msg.arr=[%s])",(ulong)T_err_msg.len,T_err_msg.arr);
    trace_event(sLine,5);
    sprintf(sLine,"End   Update_SentIssScripts(%d)",(ulong)(uint)response);
    trace_event(sLine,5);
  }
  return response;
}



// WARNING: Unknown calling convention

int GetBDK(int nIndiceCtx,char *terminal_nbr,char *BDK1)

{
  int iVar1;
  size_t __n;
  ulong uVar2;
  uint uVar3;
  uchar *puVar4;
  bool bVar5;
  byte bVar6;
  uchar auStack_2564 [7960];
  int response;
  anon_struct_18_2_43c7b5cf T_terminal_nbr;
  sqlca sqlca;
  anon_struct_260_2_43c7b5cf T_BDK1;
  char sLine [512];
  sqlexd_conflict8 sqlstm;
  
  bVar6 = 0;
  sprintf(sLine,"Start GetBDK(%.15s)",terminal_nbr);
  trace_event(sLine,5);
  puVar4 = T_BDK1.arr + 2;
  uVar3 = 0xff;
  T_BDK1.arr[0] = '\0';
  T_BDK1.arr[1] = '\0';
  bVar5 = ((ulong)puVar4 & 4) != 0;
  if (bVar5) {
    T_BDK1.arr[2] = '\0';
    T_BDK1.arr[3] = '\0';
    T_BDK1.arr[4] = '\0';
    T_BDK1.arr[5] = '\0';
    uVar3 = 0xfb;
    puVar4 = T_BDK1.arr + 6;
  }
  for (uVar2 = (ulong)(uVar3 >> 3); uVar2 != 0; uVar2 = uVar2 - 1) {
    puVar4[0] = '\0';
    puVar4[1] = '\0';
    puVar4[2] = '\0';
    puVar4[3] = '\0';
    puVar4[4] = '\0';
    puVar4[5] = '\0';
    puVar4[6] = '\0';
    puVar4[7] = '\0';
    puVar4 = puVar4 + (ulong)bVar6 * -0x10 + 8;
  }
  if (!bVar5) {
    puVar4[0] = '\0';
    puVar4[1] = '\0';
    puVar4[2] = '\0';
    puVar4[3] = '\0';
    puVar4 = puVar4 + 4;
  }
  puVar4[0] = '\0';
  puVar4[1] = '\0';
  puVar4[2] = '\0';
  T_terminal_nbr.arr[0] = '\0';
  T_terminal_nbr.arr[1] = '\0';
  T_terminal_nbr.arr[2] = '\0';
  T_terminal_nbr.arr[3] = '\0';
  T_terminal_nbr.arr[4] = '\0';
  T_terminal_nbr.arr[5] = '\0';
  T_terminal_nbr.arr[6] = '\0';
  T_terminal_nbr.arr[7] = '\0';
  T_terminal_nbr.arr[8] = '\0';
  T_terminal_nbr.arr[9] = '\0';
  T_terminal_nbr.arr[10] = '\0';
  T_terminal_nbr.arr[0xb] = '\0';
  T_terminal_nbr.arr[0xc] = '\0';
  T_terminal_nbr.arr[0xd] = '\0';
  T_terminal_nbr.arr[0xe] = '\0';
  T_terminal_nbr.arr[0xf] = '\0';
  __n = strlen(terminal_nbr);
  memcpy(T_terminal_nbr.arr,terminal_nbr,__n);
  sqlstm.sqphsv = sqlstm.sqhstv;
  sqlstm.sqladtp = &sqladt;
  T_terminal_nbr.len = (ushort)__n;
  sqlstm.sqlety = 0x1100;
  sqlstm.sqltdsp = &sqltds;
  sqlstm.sqadto[0] = 0;
  sqlstm.sqtdso[0] = 0;
  sqlstm.sqadto[1] = 0;
  sqlstm.stmt = 
  "begin :response := PCRD_POS_DUKPT_KEY_MNG . GET_BDK_KEY ( :T_terminal_nbr , :T_BDK1 ) ; END ;";
  sqlstm.sqtdso[1] = 0;
  response = 3;
  sqlstm.sqlvsn = 0xc;
  sqlstm.cud = sqlcud0;
  sqlstm.sqhstv[0] = (uchar *)&response;
  sqlstm.arrsiz = 8;
  sqlstm.iters = 1;
  sqlstm.offset = 0x31c;
  sqlstm.occurs = 0;
  sqlstm.sqhstl[0] = 4;
  sqlstm.sqhsts[0] = 0;
  sqlstm.sqindv[0] = (short *)0x0;
  sqlstm.sqinds[0] = 0;
  sqlstm.sqharm[0] = 0;
  sqlstm.sqhstl[1] = 0x12;
  sqlstm.sqhsts[1] = 0;
  sqlstm.sqindv[1] = (short *)0x0;
  sqlstm.sqinds[1] = 0;
  sqlstm.sqharm[1] = 0;
  sqlstm.sqhstl[2] = 0x103;
  sqlstm.sqhsts[2] = 0;
  sqlstm.sqindv[2] = (short *)0x0;
  sqlstm.sqinds[2] = 0;
  sqlstm.sqphsl = sqlstm.sqhstl;
  sqlstm.sqharm[2] = 0;
  sqlstm.sqphss = sqlstm.sqhsts;
  sqlstm.sqadto[2] = 0;
  sqlstm.sqtdso[2] = 0;
  sqlstm.sqpind = sqlstm.sqindv;
  sqlstm.sqpins = sqlstm.sqinds;
  sqlstm.sqparm = sqlstm.sqharm;
  sqlstm.sqparc = sqlstm.sqharc;
  sqlstm.sqpadto = sqlstm.sqadto;
  sqlstm.sqptdso = sqlstm.sqtdso;
  sqlstm.sqlest = (uchar *)&sqlca;
  sqlstm.sqhstv[1] = (uchar *)&T_terminal_nbr;
  sqlstm.sqhstv[2] = (uchar *)&T_BDK1;
  sqlcxt((long)nIndiceCtx * 0x10 + 0x713948,&sqlctx,&sqlstm,&sqlfpn);
  if (sqlca.sqlcode < 0) {
    strcpy(sLine,sqlca.sqlerrm.sqlerrmc);
    trace_event(sLine,1);
    trace_event("End  GetBDK (MALFUNCTION)",5);
    iVar1 = 3;
  }
  else if (response == 0) {
    memcpy(BDK1,T_BDK1.arr,(ulong)T_BDK1.len);
    sprintf(sLine,"End   GetBDK(  %.32s)",BDK1);
    trace_event(sLine,5);
    iVar1 = 0;
  }
  else {
    builtin_strncpy(sLine,"End   GetBDK(NOK)",0x12);
    trace_event(sLine,5);
    iVar1 = -1;
  }
  return iVar1;
}



// WARNING: Unknown calling convention

int Get_IM_Key(int nIndiceCtx,char *sPan,char *sIW_Key,char *type)

{
  int iVar1;
  size_t sVar2;
  ulong uVar3;
  uint uVar4;
  uchar *puVar5;
  bool bVar6;
  byte bVar7;
  uchar auStack_2564 [7944];
  int response;
  anon_struct_6_2_43c7b5cf T_Type;
  anon_struct_26_2_43c7b5cf T_Pan;
  sqlca sqlca;
  anon_struct_260_2_43c7b5cf T_IwK;
  char sLine [512];
  sqlexd_conflict8 sqlstm;
  
  bVar7 = 0;
  sprintf(sLine,"Start Get_IM_Key(%.6s)",sPan);
  trace_event(sLine,5);
  puVar5 = T_IwK.arr + 2;
  uVar4 = 0xff;
  T_IwK.arr[0] = '\0';
  T_IwK.arr[1] = '\0';
  bVar6 = ((ulong)puVar5 & 4) != 0;
  if (bVar6) {
    T_IwK.arr[2] = '\0';
    T_IwK.arr[3] = '\0';
    T_IwK.arr[4] = '\0';
    T_IwK.arr[5] = '\0';
    uVar4 = 0xfb;
    puVar5 = T_IwK.arr + 6;
  }
  for (uVar3 = (ulong)(uVar4 >> 3); uVar3 != 0; uVar3 = uVar3 - 1) {
    puVar5[0] = '\0';
    puVar5[1] = '\0';
    puVar5[2] = '\0';
    puVar5[3] = '\0';
    puVar5[4] = '\0';
    puVar5[5] = '\0';
    puVar5[6] = '\0';
    puVar5[7] = '\0';
    puVar5 = puVar5 + (ulong)bVar7 * -0x10 + 8;
  }
  if (!bVar6) {
    puVar5[0] = '\0';
    puVar5[1] = '\0';
    puVar5[2] = '\0';
    puVar5[3] = '\0';
    puVar5 = puVar5 + 4;
  }
  puVar5[0] = '\0';
  puVar5[1] = '\0';
  puVar5[2] = '\0';
  T_Type.len = 0;
  T_IwK.len = 0;
  T_Type.arr[0] = '\0';
  T_Type.arr[1] = '\0';
  T_Type.arr[2] = '\0';
  T_Type.arr[3] = '\0';
  sVar2 = strlen(type);
  memcpy(T_Type.arr,type,sVar2);
  T_Type.len = (ushort)sVar2;
  sprintf(sLine,"T_Type.arr=[%s], T_Type.len=[%d])",T_Type.arr,sVar2 & 0xffff);
  trace_event(sLine,5);
  T_Pan.len = 0;
  T_Pan.arr[0x14] = '\0';
  T_Pan.arr[0x15] = '\0';
  T_Pan.arr[0] = '\0';
  T_Pan.arr[1] = '\0';
  T_Pan.arr[2] = '\0';
  T_Pan.arr[3] = '\0';
  T_Pan.arr[4] = '\0';
  T_Pan.arr[5] = '\0';
  T_Pan.arr[6] = '\0';
  T_Pan.arr[7] = '\0';
  T_Pan.arr[8] = '\0';
  T_Pan.arr[9] = '\0';
  T_Pan.arr[10] = '\0';
  T_Pan.arr[0xb] = '\0';
  T_Pan.arr[0xc] = '\0';
  T_Pan.arr[0xd] = '\0';
  T_Pan.arr[0xe] = '\0';
  T_Pan.arr[0xf] = '\0';
  T_Pan.arr[0x10] = '\0';
  T_Pan.arr[0x11] = '\0';
  T_Pan.arr[0x12] = '\0';
  T_Pan.arr[0x13] = '\0';
  T_Pan.arr[0x16] = '\0';
  sVar2 = strlen(sPan);
  memcpy(T_Pan.arr,sPan,sVar2);
  T_Pan.len = (ushort)sVar2;
  sprintf(sLine,"T_Pan.arr=[%s], T_Pan.len=[%d])",T_Pan.arr,sVar2 & 0xffff);
  trace_event(sLine,5);
  sqlstm.sqlety = 0x1100;
  sqlstm.sqadto[0] = 0;
  sqlstm.sqladtp = &sqladt;
  sqlstm.sqltdsp = &sqltds;
  sqlstm.sqtdso[0] = 0;
  sqlstm.stmt = 
  "begin :response := PCRD_GET_HSM_KEY_2 . GET_EMV_KEY ( :T_Pan , :T_Type , :T_IwK ) ; END ;";
  sqlstm.sqadto[1] = 0;
  response = 0x38d;
  sqlstm.cud = sqlcud0;
  sqlstm.sqhstv[0] = (uchar *)&response;
  sqlstm.sqlvsn = 0xc;
  sqlstm.arrsiz = 8;
  sqlstm.iters = 1;
  sqlstm.offset = 0x337;
  sqlstm.occurs = 0;
  sqlstm.sqhstl[0] = 4;
  sqlstm.sqhsts[0] = 0;
  sqlstm.sqindv[0] = (short *)0x0;
  sqlstm.sqinds[0] = 0;
  sqlstm.sqharm[0] = 0;
  sqlstm.sqhstl[1] = 0x19;
  sqlstm.sqhsts[1] = 0;
  sqlstm.sqindv[1] = (short *)0x0;
  sqlstm.sqinds[1] = 0;
  sqlstm.sqharm[1] = 0;
  sqlstm.sqtdso[1] = 0;
  sqlstm.sqhstl[2] = 6;
  sqlstm.sqhsts[2] = 0;
  sqlstm.sqindv[2] = (short *)0x0;
  sqlstm.sqtdso[2] = 0;
  sqlstm.sqadto[3] = 0;
  sqlstm.sqinds[2] = 0;
  sqlstm.sqtdso[3] = 0;
  sqlstm.sqphsv = sqlstm.sqhstv;
  sqlstm.sqharm[2] = 0;
  sqlstm.sqadto[2] = 0;
  sqlstm.sqphsl = sqlstm.sqhstl;
  sqlstm.sqhstl[3] = 0x103;
  sqlstm.sqphss = sqlstm.sqhsts;
  sqlstm.sqhsts[3] = 0;
  sqlstm.sqindv[3] = (short *)0x0;
  sqlstm.sqinds[3] = 0;
  sqlstm.sqpind = sqlstm.sqindv;
  sqlstm.sqharm[3] = 0;
  sqlstm.sqpins = sqlstm.sqinds;
  sqlstm.sqparm = sqlstm.sqharm;
  sqlstm.sqparc = sqlstm.sqharc;
  sqlstm.sqpadto = sqlstm.sqadto;
  sqlstm.sqptdso = sqlstm.sqtdso;
  sqlstm.sqlest = (uchar *)&sqlca;
  sqlstm.sqhstv[1] = (uchar *)&T_Pan;
  sqlstm.sqhstv[2] = (uchar *)&T_Type;
  sqlstm.sqhstv[3] = (uchar *)&T_IwK;
  sqlcxt((long)nIndiceCtx * 0x10 + 0x713948,&sqlctx,&sqlstm,&sqlfpn);
  if (sqlca.sqlcode < 0) {
    strcpy(sLine,sqlca.sqlerrm.sqlerrmc);
    trace_event(sLine,1);
    trace_event("End  Get_IM_Key (MALFUNCTION)",5);
    iVar1 = 3;
  }
  else if (response == 0) {
    memcpy(sIW_Key,T_IwK.arr,(ulong)T_IwK.len);
    sprintf(sLine,"End   GetAwkZmk(%.16s)",sIW_Key);
    trace_event(sLine,5);
    iVar1 = 0;
  }
  else {
    trace_event("End   Get_IM_Key(NOK)",5);
    iVar1 = -1;
  }
  return iVar1;
}



// WARNING: Unknown calling convention

int GetAwkWithCV(int nIndiceCtx,char *resource_id,char *AwK,char *CheckValue)

{
  int iVar1;
  ulong uVar2;
  uchar *puVar3;
  uint uVar4;
  bool bVar5;
  byte bVar6;
  uchar auStack_2564 [7944];
  int response;
  char T_resource_id [7];
  anon_struct_20_2_43c7b5cf T_CheckValue;
  sqlca sqlca;
  anon_struct_260_2_43c7b5cf T_AwK;
  char sLine [512];
  sqlexd_conflict8 sqlstm;
  
  bVar6 = 0;
  sprintf(sLine,"Start GetAWK(%.6s)",resource_id);
  trace_event(sLine,5);
  puVar3 = T_AwK.arr + 2;
  uVar4 = 0xff;
  T_AwK.arr[0] = '\0';
  T_AwK.arr[1] = '\0';
  bVar5 = ((ulong)puVar3 & 4) != 0;
  if (bVar5) {
    T_AwK.arr[2] = '\0';
    T_AwK.arr[3] = '\0';
    T_AwK.arr[4] = '\0';
    T_AwK.arr[5] = '\0';
    uVar4 = 0xfb;
    puVar3 = T_AwK.arr + 6;
  }
  for (uVar2 = (ulong)(uVar4 >> 3); uVar2 != 0; uVar2 = uVar2 - 1) {
    puVar3[0] = '\0';
    puVar3[1] = '\0';
    puVar3[2] = '\0';
    puVar3[3] = '\0';
    puVar3[4] = '\0';
    puVar3[5] = '\0';
    puVar3[6] = '\0';
    puVar3[7] = '\0';
    puVar3 = puVar3 + (ulong)bVar6 * -0x10 + 8;
  }
  if (!bVar5) {
    puVar3[0] = '\0';
    puVar3[1] = '\0';
    puVar3[2] = '\0';
    puVar3[3] = '\0';
    puVar3 = puVar3 + 4;
  }
  puVar3[0] = '\0';
  puVar3[1] = '\0';
  puVar3[2] = '\0';
  T_resource_id._0_4_ = *(undefined4 *)resource_id;
  T_AwK.len = 0;
  T_CheckValue.len = 0;
  sqlstm.sqhstv[3] = (uchar *)&T_CheckValue;
  sqlstm.sqhstv[1] = (uchar *)T_resource_id;
  T_resource_id._4_2_ = *(undefined2 *)(resource_id + 4);
  sqlstm.sqlest = (uchar *)&sqlca;
  sqlstm.sqladtp = &sqladt;
  sqlstm.sqltdsp = &sqltds;
  T_CheckValue.arr[0] = '\0';
  T_CheckValue.arr[1] = '\0';
  T_CheckValue.arr[2] = '\0';
  T_CheckValue.arr[3] = '\0';
  T_CheckValue.arr[4] = '\0';
  T_CheckValue.arr[5] = '\0';
  T_CheckValue.arr[6] = '\0';
  T_CheckValue.arr[7] = '\0';
  sqlstm.stmt = 
  "begin :response := PCRD_GET_HSM_KEY_3 . GET_AWK_KEY_WITH_CV ( :T_resource_id , :T_AwK , :T_CheckValue ) ; END ;"
  ;
  sqlstm.sqhstv[0] = (uchar *)&response;
  sqlstm.cud = sqlcud0;
  sqlstm.sqlety = 0x1100;
  sqlstm.sqadto[0] = 0;
  sqlstm.sqphsv = sqlstm.sqhstv;
  sqlstm.sqtdso[0] = 0;
  T_CheckValue.arr[8] = '\0';
  T_CheckValue.arr[9] = '\0';
  T_CheckValue.arr[10] = '\0';
  T_CheckValue.arr[0xb] = '\0';
  T_CheckValue.arr[0xc] = '\0';
  T_CheckValue.arr[0xd] = '\0';
  T_CheckValue.arr[0xe] = '\0';
  T_CheckValue.arr[0xf] = '\0';
  T_CheckValue.arr[0x10] = '\0';
  T_resource_id[6] = '\0';
  response = 0x38d;
  sqlstm.sqlvsn = 0xc;
  sqlstm.arrsiz = 8;
  sqlstm.iters = 1;
  sqlstm.offset = 0x356;
  sqlstm.occurs = 0;
  sqlstm.sqhstl[0] = 4;
  sqlstm.sqhsts[0] = 0;
  sqlstm.sqindv[0] = (short *)0x0;
  sqlstm.sqinds[0] = 0;
  sqlstm.sqharm[0] = 0;
  sqlstm.sqhstl[1] = 7;
  sqlstm.sqhsts[1] = 0;
  sqlstm.sqindv[1] = (short *)0x0;
  sqlstm.sqphsl = sqlstm.sqhstl;
  sqlstm.sqadto[2] = 0;
  sqlstm.sqphss = sqlstm.sqhsts;
  sqlstm.sqtdso[2] = 0;
  sqlstm.sqinds[1] = 0;
  sqlstm.sqharm[1] = 0;
  sqlstm.sqpind = sqlstm.sqindv;
  sqlstm.sqadto[3] = 0;
  sqlstm.sqadto[1] = 0;
  sqlstm.sqpins = sqlstm.sqinds;
  sqlstm.sqtdso[3] = 0;
  sqlstm.sqtdso[1] = 0;
  sqlstm.sqparm = sqlstm.sqharm;
  sqlstm.sqhstl[2] = 0x103;
  sqlstm.sqhsts[2] = 0;
  sqlstm.sqindv[2] = (short *)0x0;
  sqlstm.sqparc = sqlstm.sqharc;
  sqlstm.sqinds[2] = 0;
  sqlstm.sqharm[2] = 0;
  sqlstm.sqpadto = sqlstm.sqadto;
  sqlstm.sqhstl[3] = 0x13;
  sqlstm.sqhsts[3] = 0;
  sqlstm.sqindv[3] = (short *)0x0;
  sqlstm.sqptdso = sqlstm.sqtdso;
  sqlstm.sqinds[3] = 0;
  sqlstm.sqharm[3] = 0;
  sqlstm.sqhstv[2] = (uchar *)&T_AwK;
  sqlcxt((long)nIndiceCtx * 0x10 + 0x713948,&sqlctx,&sqlstm,&sqlfpn);
  if (sqlca.sqlcode < 0) {
    strcpy(sLine,sqlca.sqlerrm.sqlerrmc);
    trace_event(sLine,1);
    trace_event("End  GetAwkWithCV (MALFUNCTION)",5);
    iVar1 = 3;
  }
  else if (response == 0) {
    memcpy(AwK,T_AwK.arr,(ulong)T_AwK.len);
    *(undefined4 *)CheckValue = T_CheckValue.arr._0_4_;
    if (debug_option == 1) {
      sprintf(sLine,"End   GetAwkWithCV(%.256s, %s)",AwK,CheckValue);
    }
    else {
      builtin_strncpy(sLine,"End   GetAwkWithCV(OK)",0x17);
    }
    trace_event(sLine,5);
    iVar1 = 0;
  }
  else {
    trace_event("End   GetAwkWithCV(NOK)",5);
    iVar1 = -1;
  }
  return iVar1;
}



// WARNING: Unknown calling convention

int Get_CAVV_Key(int nIndiceCtx,char *sPan,char *sKey_Ind,char *CVKA,char *CVKB)

{
  int iVar1;
  size_t __n;
  size_t __n_00;
  ulong uVar2;
  uint uVar3;
  uchar *puVar4;
  bool bVar5;
  byte bVar6;
  uchar auStack_2674 [272];
  uchar auStack_2564 [7660];
  int response;
  anon_struct_6_2_43c7b5cf T_KEY_IND;
  anon_struct_26_2_43c7b5cf T_Pan;
  sqlca sqlca;
  anon_struct_260_2_43c7b5cf T_CVKA;
  anon_struct_260_2_43c7b5cf T_CVKB;
  char sLine [512];
  sqlexd_conflict8 sqlstm;
  
  bVar6 = 0;
  if (debug_option == 1) {
    sprintf(sLine,"Start Get_CAVV_Key(%.16s,%s)",sPan,sKey_Ind);
    trace_event(sLine,5);
  }
  else {
    builtin_strncpy(sLine,"Start Get_CAVV_Key(OK)",0x17);
    trace_event(sLine,5);
  }
  T_Pan.arr[0] = '\0';
  T_Pan.arr[1] = '\0';
  T_Pan.arr[2] = '\0';
  T_Pan.arr[3] = '\0';
  T_Pan.arr[4] = '\0';
  T_Pan.arr[5] = '\0';
  T_Pan.arr[6] = '\0';
  T_Pan.arr[7] = '\0';
  puVar4 = T_CVKA.arr + 2;
  T_Pan.arr[8] = '\0';
  T_Pan.arr[9] = '\0';
  T_Pan.arr[10] = '\0';
  T_Pan.arr[0xb] = '\0';
  T_Pan.arr[0xc] = '\0';
  T_Pan.arr[0xd] = '\0';
  T_Pan.arr[0xe] = '\0';
  T_Pan.arr[0xf] = '\0';
  T_Pan.arr[0x10] = '\0';
  T_Pan.arr[0x11] = '\0';
  T_Pan.arr[0x12] = '\0';
  T_Pan.arr[0x13] = '\0';
  T_Pan.arr[0x14] = '\0';
  T_Pan.arr[0x15] = '\0';
  T_Pan.arr[0x16] = '\0';
  uVar3 = 0xff;
  bVar5 = ((ulong)puVar4 & 4) != 0;
  T_Pan.len = 0;
  T_CVKA.arr[0] = '\0';
  T_CVKA.arr[1] = '\0';
  if (bVar5) {
    T_CVKA.arr[2] = '\0';
    T_CVKA.arr[3] = '\0';
    T_CVKA.arr[4] = '\0';
    T_CVKA.arr[5] = '\0';
    uVar3 = 0xfb;
    puVar4 = T_CVKA.arr + 6;
  }
  for (uVar2 = (ulong)(uVar3 >> 3); uVar2 != 0; uVar2 = uVar2 - 1) {
    puVar4[0] = '\0';
    puVar4[1] = '\0';
    puVar4[2] = '\0';
    puVar4[3] = '\0';
    puVar4[4] = '\0';
    puVar4[5] = '\0';
    puVar4[6] = '\0';
    puVar4[7] = '\0';
    puVar4 = puVar4 + (ulong)bVar6 * -0x10 + 8;
  }
  if (!bVar5) {
    puVar4[0] = '\0';
    puVar4[1] = '\0';
    puVar4[2] = '\0';
    puVar4[3] = '\0';
    puVar4 = puVar4 + 4;
  }
  puVar4[0] = '\0';
  puVar4[1] = '\0';
  puVar4[2] = '\0';
  T_CVKB.arr[0] = '\0';
  T_CVKB.arr[1] = '\0';
  T_CVKA.len = 0;
  uVar3 = 0xff;
  puVar4 = T_CVKB.arr + 2;
  bVar5 = ((ulong)puVar4 & 4) != 0;
  if (bVar5) {
    T_CVKB.arr[2] = '\0';
    T_CVKB.arr[3] = '\0';
    T_CVKB.arr[4] = '\0';
    T_CVKB.arr[5] = '\0';
    uVar3 = 0xfb;
    puVar4 = T_CVKB.arr + 6;
  }
  for (uVar2 = (ulong)(uVar3 >> 3); uVar2 != 0; uVar2 = uVar2 - 1) {
    puVar4[0] = '\0';
    puVar4[1] = '\0';
    puVar4[2] = '\0';
    puVar4[3] = '\0';
    puVar4[4] = '\0';
    puVar4[5] = '\0';
    puVar4[6] = '\0';
    puVar4[7] = '\0';
    puVar4 = puVar4 + (ulong)bVar6 * -0x10 + 8;
  }
  if (!bVar5) {
    puVar4[0] = '\0';
    puVar4[1] = '\0';
    puVar4[2] = '\0';
    puVar4[3] = '\0';
    puVar4 = puVar4 + 4;
  }
  puVar4[0] = '\0';
  puVar4[1] = '\0';
  puVar4[2] = '\0';
  T_CVKB.len = 0;
  T_KEY_IND.len = 0;
  T_KEY_IND.arr[0] = '\0';
  T_KEY_IND.arr[1] = '\0';
  T_KEY_IND.arr[2] = '\0';
  __n = strlen(sPan);
  memcpy(T_Pan.arr,sPan,__n);
  T_Pan.len = (ushort)__n;
  __n_00 = strlen(sKey_Ind);
  memcpy(T_KEY_IND.arr,sKey_Ind,__n_00);
  T_KEY_IND.len = (ushort)__n_00;
  if (debug_option == 1) {
    sprintf(sLine,"T_Pan.arr=[%s], T_Pan.len=[%d])",T_Pan.arr,__n & 0xffff);
    trace_event(sLine,5);
  }
  sqlstm.sqlest = (uchar *)&sqlca;
  sqlstm.sqladtp = &sqladt;
  sqlstm.sqlety = 0x1100;
  sqlstm.sqadto[0] = 0;
  sqlstm.sqltdsp = &sqltds;
  sqlstm.sqtdso[0] = 0;
  sqlstm.sqadto[1] = 0;
  sqlstm.stmt = 
  "begin :response := PCRD_GET_HSM_KEY . GET_CAVV_KEY ( :T_Pan , :T_KEY_IND , :T_CVKA , :T_CVKB ) ; END ;"
  ;
  sqlstm.sqtdso[1] = 0;
  response = 0x38d;
  sqlstm.cud = sqlcud0;
  sqlstm.sqhstv[0] = (uchar *)&response;
  sqlstm.sqlvsn = 0xc;
  sqlstm.arrsiz = 8;
  sqlstm.iters = 1;
  sqlstm.offset = 0x375;
  sqlstm.occurs = 0;
  sqlstm.sqhstl[0] = 4;
  sqlstm.sqhsts[0] = 0;
  sqlstm.sqindv[0] = (short *)0x0;
  sqlstm.sqinds[0] = 0;
  sqlstm.sqharm[0] = 0;
  sqlstm.sqhstl[1] = 0x19;
  sqlstm.sqhsts[1] = 0;
  sqlstm.sqindv[1] = (short *)0x0;
  sqlstm.sqinds[1] = 0;
  sqlstm.sqharm[1] = 0;
  sqlstm.sqhstl[2] = 5;
  sqlstm.sqhsts[2] = 0;
  sqlstm.sqindv[2] = (short *)0x0;
  sqlstm.sqinds[2] = 0;
  sqlstm.sqharm[2] = 0;
  sqlstm.sqtdso[3] = 0;
  sqlstm.sqadto[4] = 0;
  sqlstm.sqtdso[4] = 0;
  sqlstm.sqphsv = sqlstm.sqhstv;
  sqlstm.sqadto[2] = 0;
  sqlstm.sqtdso[2] = 0;
  sqlstm.sqphsl = sqlstm.sqhstl;
  sqlstm.sqhstl[3] = 0x103;
  sqlstm.sqhsts[3] = 0;
  sqlstm.sqphss = sqlstm.sqhsts;
  sqlstm.sqindv[3] = (short *)0x0;
  sqlstm.sqinds[3] = 0;
  sqlstm.sqharm[3] = 0;
  sqlstm.sqpind = sqlstm.sqindv;
  sqlstm.sqadto[3] = 0;
  sqlstm.sqhstl[4] = 0x103;
  sqlstm.sqpins = sqlstm.sqinds;
  sqlstm.sqhsts[4] = 0;
  sqlstm.sqindv[4] = (short *)0x0;
  sqlstm.sqinds[4] = 0;
  sqlstm.sqparm = sqlstm.sqharm;
  sqlstm.sqharm[4] = 0;
  sqlstm.sqparc = sqlstm.sqharc;
  sqlstm.sqpadto = sqlstm.sqadto;
  sqlstm.sqptdso = sqlstm.sqtdso;
  sqlstm.sqhstv[1] = (uchar *)&T_Pan;
  sqlstm.sqhstv[2] = (uchar *)&T_KEY_IND;
  sqlstm.sqhstv[3] = (uchar *)&T_CVKA;
  sqlstm.sqhstv[4] = (uchar *)&T_CVKB;
  sqlcxt((long)nIndiceCtx * 0x10 + 0x713948,&sqlctx,&sqlstm,&sqlfpn);
  if (sqlca.sqlcode < 0) {
    sprintf(sLine,"[%.100s]",sqlca.sqlerrm.sqlerrmc);
    trace_event(sLine,1);
    trace_event("End  Get_CAVV_Key(MALFUNCTION)",5);
    iVar1 = 3;
  }
  else if (response == 0) {
    memcpy(CVKA,T_CVKA.arr,(ulong)T_CVKA.len);
    memcpy(CVKB,T_CVKB.arr,(ulong)T_CVKB.len);
    if (debug_option == 1) {
      sprintf(sLine,"End   Get_CAVV_Key(%.32s,%.32s)",CVKA,CVKB);
    }
    else {
      builtin_strncpy(sLine,"End   Get_CAVV_Key(OK)",0x17);
    }
    trace_event(sLine,5);
    iVar1 = 0;
  }
  else {
    trace_event("End   Get_CAVV_Key(NOK)",5);
    iVar1 = -1;
  }
  return iVar1;
}



// WARNING: Unknown calling convention

int Get_UCAF_Key(int nIndiceCtx,char *sPan,char *sKey_Ind,char *sUCAF_KEY)

{
  int iVar1;
  size_t __n;
  size_t __n_00;
  ulong uVar2;
  uint uVar3;
  uchar *puVar4;
  bool bVar5;
  byte bVar6;
  uchar auStack_2564 [7932];
  int response;
  anon_struct_6_2_43c7b5cf T_KEY_IND;
  anon_struct_26_2_43c7b5cf T_Pan;
  sqlca sqlca;
  anon_struct_260_2_43c7b5cf T_UCAF_KEY;
  char sLine [512];
  sqlexd_conflict8 sqlstm;
  
  bVar6 = 0;
  if (debug_option == 1) {
    sprintf(sLine,"Start Get_UCAF_Key(%.16s)",sPan);
    trace_event(sLine,5);
  }
  else {
    builtin_strncpy(sLine,"Start Get_UCAF_Key(OK)",0x17);
    trace_event(sLine,5);
  }
  T_Pan.arr[0] = '\0';
  T_Pan.arr[1] = '\0';
  T_Pan.arr[2] = '\0';
  T_Pan.arr[3] = '\0';
  T_Pan.arr[4] = '\0';
  T_Pan.arr[5] = '\0';
  T_Pan.arr[6] = '\0';
  T_Pan.arr[7] = '\0';
  puVar4 = T_UCAF_KEY.arr + 2;
  T_Pan.arr[8] = '\0';
  T_Pan.arr[9] = '\0';
  T_Pan.arr[10] = '\0';
  T_Pan.arr[0xb] = '\0';
  T_Pan.arr[0xc] = '\0';
  T_Pan.arr[0xd] = '\0';
  T_Pan.arr[0xe] = '\0';
  T_Pan.arr[0xf] = '\0';
  T_Pan.arr[0x10] = '\0';
  T_Pan.arr[0x11] = '\0';
  T_Pan.arr[0x12] = '\0';
  T_Pan.arr[0x13] = '\0';
  T_Pan.arr[0x14] = '\0';
  T_Pan.arr[0x15] = '\0';
  T_Pan.arr[0x16] = '\0';
  bVar5 = ((ulong)puVar4 & 4) != 0;
  T_Pan.len = 0;
  T_UCAF_KEY.arr[0] = '\0';
  T_UCAF_KEY.arr[1] = '\0';
  uVar3 = 0xff;
  if (bVar5) {
    T_UCAF_KEY.arr[2] = '\0';
    T_UCAF_KEY.arr[3] = '\0';
    T_UCAF_KEY.arr[4] = '\0';
    T_UCAF_KEY.arr[5] = '\0';
    uVar3 = 0xfb;
    puVar4 = T_UCAF_KEY.arr + 6;
  }
  for (uVar2 = (ulong)(uVar3 >> 3); uVar2 != 0; uVar2 = uVar2 - 1) {
    puVar4[0] = '\0';
    puVar4[1] = '\0';
    puVar4[2] = '\0';
    puVar4[3] = '\0';
    puVar4[4] = '\0';
    puVar4[5] = '\0';
    puVar4[6] = '\0';
    puVar4[7] = '\0';
    puVar4 = puVar4 + (ulong)bVar6 * -0x10 + 8;
  }
  if (!bVar5) {
    puVar4[0] = '\0';
    puVar4[1] = '\0';
    puVar4[2] = '\0';
    puVar4[3] = '\0';
    puVar4 = puVar4 + 4;
  }
  puVar4[0] = '\0';
  puVar4[1] = '\0';
  puVar4[2] = '\0';
  T_UCAF_KEY.len = 0;
  T_KEY_IND.arr[0] = '\0';
  T_KEY_IND.arr[1] = '\0';
  T_KEY_IND.arr[2] = '\0';
  T_KEY_IND.len = 0;
  __n = strlen(sPan);
  memcpy(T_Pan.arr,sPan,__n);
  T_Pan.len = (ushort)__n;
  __n_00 = strlen(sKey_Ind);
  memcpy(T_KEY_IND.arr,sKey_Ind,__n_00);
  T_KEY_IND.len = (ushort)__n_00;
  if (debug_option == 1) {
    sprintf(sLine,"T_Pan.arr=[%s], T_Pan.len=[%d])",T_Pan.arr,__n & 0xffff);
    trace_event(sLine,5);
  }
  sqlstm.sqlest = (uchar *)&sqlca;
  sqlstm.sqladtp = &sqladt;
  sqlstm.sqadto[0] = 0;
  sqlstm.sqtdso[0] = 0;
  sqlstm.sqltdsp = &sqltds;
  sqlstm.sqlety = 0x1100;
  sqlstm.sqadto[1] = 0;
  sqlstm.stmt = 
  "begin :response := PCRD_GET_HSM_KEY . GET_UCAF_KEY ( :T_Pan , :T_KEY_IND , :T_UCAF_KEY ) ; END ;"
  ;
  sqlstm.sqtdso[1] = 0;
  response = 0x38d;
  sqlstm.cud = sqlcud0;
  sqlstm.sqhstv[0] = (uchar *)&response;
  sqlstm.sqlvsn = 0xc;
  sqlstm.arrsiz = 8;
  sqlstm.iters = 1;
  sqlstm.sqphsv = sqlstm.sqhstv;
  sqlstm.offset = 0x398;
  sqlstm.occurs = 0;
  sqlstm.sqhstl[0] = 4;
  sqlstm.sqhsts[0] = 0;
  sqlstm.sqindv[0] = (short *)0x0;
  sqlstm.sqinds[0] = 0;
  sqlstm.sqharm[0] = 0;
  sqlstm.sqhstl[1] = 0x19;
  sqlstm.sqhsts[1] = 0;
  sqlstm.sqindv[1] = (short *)0x0;
  sqlstm.sqinds[1] = 0;
  sqlstm.sqharm[1] = 0;
  sqlstm.sqhstl[2] = 5;
  sqlstm.sqhsts[2] = 0;
  sqlstm.sqindv[2] = (short *)0x0;
  sqlstm.sqinds[2] = 0;
  sqlstm.sqharm[2] = 0;
  sqlstm.sqphsl = sqlstm.sqhstl;
  sqlstm.sqadto[2] = 0;
  sqlstm.sqphss = sqlstm.sqhsts;
  sqlstm.sqtdso[2] = 0;
  sqlstm.sqhstl[3] = 0x103;
  sqlstm.sqpind = sqlstm.sqindv;
  sqlstm.sqhsts[3] = 0;
  sqlstm.sqindv[3] = (short *)0x0;
  sqlstm.sqpins = sqlstm.sqinds;
  sqlstm.sqinds[3] = 0;
  sqlstm.sqharm[3] = 0;
  sqlstm.sqadto[3] = 0;
  sqlstm.sqparm = sqlstm.sqharm;
  sqlstm.sqtdso[3] = 0;
  sqlstm.sqparc = sqlstm.sqharc;
  sqlstm.sqpadto = sqlstm.sqadto;
  sqlstm.sqptdso = sqlstm.sqtdso;
  sqlstm.sqhstv[1] = (uchar *)&T_Pan;
  sqlstm.sqhstv[2] = (uchar *)&T_KEY_IND;
  sqlstm.sqhstv[3] = (uchar *)&T_UCAF_KEY;
  sqlcxt((long)nIndiceCtx * 0x10 + 0x713948,&sqlctx,&sqlstm,&sqlfpn);
  if (sqlca.sqlcode < 0) {
    sprintf(sLine,"[%.100s]",sqlca.sqlerrm.sqlerrmc);
    trace_event(sLine,1);
    trace_event("End  Get_UCAF_Key(MALFUNCTION)",5);
    iVar1 = 3;
  }
  else if (response == 0) {
    memcpy(sUCAF_KEY,T_UCAF_KEY.arr,(ulong)T_UCAF_KEY.len);
    if (debug_option == 1) {
      sprintf(sLine,"End   Get_UCAF_Key(%s)",sUCAF_KEY);
    }
    else {
      builtin_strncpy(sLine,"End   Get_UCAF_Key(OK)",0x17);
    }
    trace_event(sLine,5);
    iVar1 = 0;
  }
  else {
    trace_event("End   Get_UCAF_Key(NOK)",5);
    iVar1 = -1;
  }
  return iVar1;
}



// WARNING: Unknown calling convention

int Base64_Decode(int nIndiceCtx,char *data_in,char *data_out)

{
  int iVar1;
  size_t __n;
  ulong uVar2;
  uint uVar3;
  uchar *puVar4;
  bool bVar5;
  byte bVar6;
  uchar auStack_2674 [272];
  uchar auStack_2564 [7724];
  sqlca sqlca;
  anon_struct_260_2_43c7b5cf T_DATA_IN;
  anon_struct_260_2_43c7b5cf T_DATA_OUT;
  char sLine [512];
  sqlexd_conflict8 sqlstm;
  
  bVar6 = 0;
  if (debug_option == 1) {
    sprintf(sLine,"Start Base64_Decode (%s)",data_in);
    trace_event(sLine,5);
  }
  else {
    builtin_strncpy(sLine,"Start Base64_Dec",0x10);
    builtin_strncpy(sLine + 0x10,"ode",4);
    trace_event(sLine,5);
  }
  uVar3 = 0xff;
  T_DATA_IN.arr[0] = '\0';
  T_DATA_IN.arr[1] = '\0';
  puVar4 = T_DATA_IN.arr + 2;
  bVar5 = ((ulong)puVar4 & 4) != 0;
  if (bVar5) {
    T_DATA_IN.arr[2] = '\0';
    T_DATA_IN.arr[3] = '\0';
    T_DATA_IN.arr[4] = '\0';
    T_DATA_IN.arr[5] = '\0';
    uVar3 = 0xfb;
    puVar4 = T_DATA_IN.arr + 6;
  }
  for (uVar2 = (ulong)(uVar3 >> 3); uVar2 != 0; uVar2 = uVar2 - 1) {
    puVar4[0] = '\0';
    puVar4[1] = '\0';
    puVar4[2] = '\0';
    puVar4[3] = '\0';
    puVar4[4] = '\0';
    puVar4[5] = '\0';
    puVar4[6] = '\0';
    puVar4[7] = '\0';
    puVar4 = puVar4 + (ulong)bVar6 * -0x10 + 8;
  }
  if (!bVar5) {
    puVar4[0] = '\0';
    puVar4[1] = '\0';
    puVar4[2] = '\0';
    puVar4[3] = '\0';
    puVar4 = puVar4 + 4;
  }
  puVar4[0] = '\0';
  puVar4[1] = '\0';
  puVar4[2] = '\0';
  T_DATA_IN.len = 0;
  T_DATA_OUT.arr[0] = '\0';
  T_DATA_OUT.arr[1] = '\0';
  uVar3 = 0xff;
  puVar4 = T_DATA_OUT.arr + 2;
  bVar5 = ((ulong)puVar4 & 4) != 0;
  if (bVar5) {
    T_DATA_OUT.arr[2] = '\0';
    T_DATA_OUT.arr[3] = '\0';
    T_DATA_OUT.arr[4] = '\0';
    T_DATA_OUT.arr[5] = '\0';
    uVar3 = 0xfb;
    puVar4 = T_DATA_OUT.arr + 6;
  }
  for (uVar2 = (ulong)(uVar3 >> 3); uVar2 != 0; uVar2 = uVar2 - 1) {
    puVar4[0] = '\0';
    puVar4[1] = '\0';
    puVar4[2] = '\0';
    puVar4[3] = '\0';
    puVar4[4] = '\0';
    puVar4[5] = '\0';
    puVar4[6] = '\0';
    puVar4[7] = '\0';
    puVar4 = puVar4 + (ulong)bVar6 * -0x10 + 8;
  }
  if (!bVar5) {
    puVar4[0] = '\0';
    puVar4[1] = '\0';
    puVar4[2] = '\0';
    puVar4[3] = '\0';
    puVar4 = puVar4 + 4;
  }
  puVar4[0] = '\0';
  puVar4[1] = '\0';
  puVar4[2] = '\0';
  T_DATA_OUT.len = 0;
  __n = strlen(data_in);
  memcpy(T_DATA_IN.arr,data_in,__n);
  sqlstm.sqlety = 0x1100;
  sqlstm.sqphsv = sqlstm.sqhstv;
  sqlstm.sqladtp = &sqladt;
  sqlstm.sqphsl = sqlstm.sqhstl;
  sqlstm.sqltdsp = &sqltds;
  sqlstm.sqadto[0] = 0;
  sqlstm.sqphss = sqlstm.sqhsts;
  sqlstm.sqtdso[0] = 0;
  sqlstm.stmt = 
  "begin :T_DATA_OUT := UTL_ENCODE . BASE64_DECODE ( UTL_RAW . CAST_TO_RAW ( :T_DATA_IN ) ) ; END ;"
  ;
  sqlstm.sqadto[1] = 0;
  sqlstm.sqpind = sqlstm.sqindv;
  sqlstm.sqtdso[1] = 0;
  sqlstm.cud = sqlcud0;
  T_DATA_IN.len = (ushort)__n;
  sqlstm.sqpins = sqlstm.sqinds;
  sqlstm.sqlvsn = 0xc;
  sqlstm.arrsiz = 8;
  sqlstm.iters = 1;
  sqlstm.sqparm = sqlstm.sqharm;
  sqlstm.offset = 0x3b7;
  sqlstm.occurs = 0;
  sqlstm.sqhstl[0] = 0x103;
  sqlstm.sqhsts[0] = 0;
  sqlstm.sqindv[0] = (short *)0x0;
  sqlstm.sqinds[0] = 0;
  sqlstm.sqharm[0] = 0;
  sqlstm.sqhstl[1] = 0x103;
  sqlstm.sqhsts[1] = 0;
  sqlstm.sqindv[1] = (short *)0x0;
  sqlstm.sqinds[1] = 0;
  sqlstm.sqharm[1] = 0;
  sqlstm.sqparc = sqlstm.sqharc;
  sqlstm.sqpadto = sqlstm.sqadto;
  sqlstm.sqptdso = sqlstm.sqtdso;
  sqlstm.sqlest = (uchar *)&sqlca;
  sqlstm.sqhstv[0] = (uchar *)&T_DATA_OUT;
  sqlstm.sqhstv[1] = (uchar *)&T_DATA_IN;
  sqlcxt((long)nIndiceCtx * 0x10 + 0x713948,&sqlctx,&sqlstm,&sqlfpn);
  if (sqlca.sqlcode < 0) {
    sprintf(sLine,"[%.100s]",sqlca.sqlerrm.sqlerrmc);
    trace_event(sLine,1);
    trace_event("End  Base64_Decode(MALFUNCTION)",5);
    iVar1 = 1;
  }
  else {
    memcpy(data_out,T_DATA_OUT.arr,(ulong)T_DATA_OUT.len);
    if (debug_option == 1) {
      sprintf(sLine,"End   Base64_Decode(%s)",data_out);
    }
    else {
      builtin_strncpy(sLine,"End   Base64_Decode(OK)",0x18);
    }
    trace_event(sLine,5);
    iVar1 = 0;
  }
  return iVar1;
}



// WARNING: Unknown calling convention

int Get_Cvc3_Key(int nIndiceCtx,char *sPan,char *sCvc3_Key)

{
  int iVar1;
  size_t __n;
  void *pvVar2;
  ulong uVar3;
  uint uVar4;
  uchar *puVar5;
  bool bVar6;
  byte bVar7;
  uchar auStack_2564 [7948];
  int response;
  anon_struct_26_2_43c7b5cf T_Pan;
  sqlca sqlca;
  anon_struct_260_2_43c7b5cf T_Cvc3_Key;
  char sLine [512];
  sqlexd_conflict8 sqlstm;
  
  bVar7 = 0;
  if (debug_option == 1) {
    sprintf(sLine,"Start Get_Cvc3_Key(%.16s)",sPan);
    trace_event(sLine,5);
  }
  else {
    builtin_strncpy(sLine,"Start Get_Cvc3_Key(OK)",0x17);
    trace_event(sLine,5);
  }
  T_Pan.arr[0] = '\0';
  T_Pan.arr[1] = '\0';
  T_Pan.arr[2] = '\0';
  T_Pan.arr[3] = '\0';
  T_Pan.arr[4] = '\0';
  T_Pan.arr[5] = '\0';
  T_Pan.arr[6] = '\0';
  T_Pan.arr[7] = '\0';
  uVar4 = 0xff;
  puVar5 = T_Cvc3_Key.arr + 2;
  T_Pan.arr[0x14] = '\0';
  T_Pan.arr[0x15] = '\0';
  T_Pan.len = 0;
  T_Pan.arr[8] = '\0';
  T_Pan.arr[9] = '\0';
  T_Pan.arr[10] = '\0';
  T_Pan.arr[0xb] = '\0';
  T_Pan.arr[0xc] = '\0';
  T_Pan.arr[0xd] = '\0';
  T_Pan.arr[0xe] = '\0';
  T_Pan.arr[0xf] = '\0';
  bVar6 = ((ulong)puVar5 & 4) != 0;
  T_Pan.arr[0x10] = '\0';
  T_Pan.arr[0x11] = '\0';
  T_Pan.arr[0x12] = '\0';
  T_Pan.arr[0x13] = '\0';
  T_Pan.arr[0x16] = '\0';
  T_Cvc3_Key.arr[0] = '\0';
  T_Cvc3_Key.arr[1] = '\0';
  if (bVar6) {
    T_Cvc3_Key.arr[2] = '\0';
    T_Cvc3_Key.arr[3] = '\0';
    T_Cvc3_Key.arr[4] = '\0';
    T_Cvc3_Key.arr[5] = '\0';
    uVar4 = 0xfb;
    puVar5 = T_Cvc3_Key.arr + 6;
  }
  for (uVar3 = (ulong)(uVar4 >> 3); uVar3 != 0; uVar3 = uVar3 - 1) {
    puVar5[0] = '\0';
    puVar5[1] = '\0';
    puVar5[2] = '\0';
    puVar5[3] = '\0';
    puVar5[4] = '\0';
    puVar5[5] = '\0';
    puVar5[6] = '\0';
    puVar5[7] = '\0';
    puVar5 = puVar5 + (ulong)bVar7 * -0x10 + 8;
  }
  if (!bVar6) {
    puVar5[0] = '\0';
    puVar5[1] = '\0';
    puVar5[2] = '\0';
    puVar5[3] = '\0';
    puVar5 = puVar5 + 4;
  }
  puVar5[0] = '\0';
  puVar5[1] = '\0';
  puVar5[2] = '\0';
  T_Cvc3_Key.len = 0;
  __n = strlen(sPan);
  pvVar2 = memcpy(T_Pan.arr,sPan,__n);
  T_Pan.len = (ushort)__n;
  if (debug_option == 1) {
    sprintf(sLine,"T_Pan.arr=[%s], T_Pan.len=[%d])",pvVar2,__n & 0xffff);
    trace_event(sLine,5);
  }
  sqlstm.sqlest = (uchar *)&sqlca;
  sqlstm.sqladtp = &sqladt;
  sqlstm.sqadto[0] = 0;
  sqlstm.sqtdso[0] = 0;
  sqlstm.sqltdsp = &sqltds;
  sqlstm.sqlety = 0x1100;
  sqlstm.sqadto[1] = 0;
  sqlstm.stmt = 
  "begin :response := PCRD_GET_HSM_KEY . GET_CVC3_KEY ( :T_Pan , :T_Cvc3_Key ) ; END ;";
  sqlstm.sqtdso[1] = 0;
  response = 0x38d;
  sqlstm.sqlvsn = 0xc;
  sqlstm.cud = sqlcud0;
  sqlstm.sqhstv[0] = (uchar *)&response;
  sqlstm.arrsiz = 8;
  sqlstm.iters = 1;
  sqlstm.offset = 0x3ce;
  sqlstm.sqphsv = sqlstm.sqhstv;
  sqlstm.occurs = 0;
  sqlstm.sqhstl[0] = 4;
  sqlstm.sqhsts[0] = 0;
  sqlstm.sqindv[0] = (short *)0x0;
  sqlstm.sqinds[0] = 0;
  sqlstm.sqharm[0] = 0;
  sqlstm.sqhstl[1] = 0x19;
  sqlstm.sqhsts[1] = 0;
  sqlstm.sqindv[1] = (short *)0x0;
  sqlstm.sqinds[1] = 0;
  sqlstm.sqharm[1] = 0;
  sqlstm.sqhstl[2] = 0x103;
  sqlstm.sqhsts[2] = 0;
  sqlstm.sqindv[2] = (short *)0x0;
  sqlstm.sqinds[2] = 0;
  sqlstm.sqharm[2] = 0;
  sqlstm.sqphsl = sqlstm.sqhstl;
  sqlstm.sqadto[2] = 0;
  sqlstm.sqphss = sqlstm.sqhsts;
  sqlstm.sqtdso[2] = 0;
  sqlstm.sqpind = sqlstm.sqindv;
  sqlstm.sqpins = sqlstm.sqinds;
  sqlstm.sqparm = sqlstm.sqharm;
  sqlstm.sqparc = sqlstm.sqharc;
  sqlstm.sqpadto = sqlstm.sqadto;
  sqlstm.sqptdso = sqlstm.sqtdso;
  sqlstm.sqhstv[1] = (uchar *)&T_Pan;
  sqlstm.sqhstv[2] = (uchar *)&T_Cvc3_Key;
  sqlcxt((long)nIndiceCtx * 0x10 + 0x713948,&sqlctx,&sqlstm,&sqlfpn);
  if (sqlca.sqlcode < 0) {
    sprintf(sLine,"[%.100s]",sqlca.sqlerrm.sqlerrmc);
    trace_event(sLine,1);
    trace_event("End  Get_Cvc3_Key(MALFUNCTION)",5);
    iVar1 = 3;
  }
  else if (response == 0) {
    memcpy(sCvc3_Key,T_Cvc3_Key.arr,(ulong)T_Cvc3_Key.len);
    if (debug_option == 1) {
      sprintf(sLine,"End   Get_Cvc3_Key(%s)",sCvc3_Key);
    }
    else {
      builtin_strncpy(sLine,"End   Get_Cvc3_Key(OK)",0x17);
    }
    trace_event(sLine,5);
    iVar1 = 0;
  }
  else {
    trace_event("End   Get_Cvc3_Key(NOK)",5);
    iVar1 = -1;
  }
  return iVar1;
}



// WARNING: Removing unreachable block (ram,0x00487915)
// WARNING: Removing unreachable block (ram,0x00487a60)
// WARNING: Removing unreachable block (ram,0x00487910)
// WARNING: Removing unreachable block (ram,0x00487a9a)
// WARNING: Unknown calling convention

int GetTMKAndTransKey(int nIndiceCtx,char *terminal_nbr,char *TMK1,char *TMK2)

{
  int iVar1;
  size_t __n;
  ulong uVar2;
  ulong uVar3;
  uint uVar4;
  uchar *puVar5;
  bool bVar6;
  byte bVar7;
  uchar auStack_2676 [274];
  uchar auStack_2564 [7672];
  int response;
  anon_struct_10_2_43c7b5cf T_AcqBank;
  anon_struct_18_2_43c7b5cf T_terminal_nbr;
  sqlca sqlca;
  anon_struct_260_2_43c7b5cf T_TMK1;
  anon_struct_260_2_43c7b5cf T_TMK2;
  char sLine [512];
  sqlexd_conflict8 sqlstm;
  
  bVar7 = 0;
  sprintf(sLine,"Start GetTMKAndTransKey(|%.15s|)",terminal_nbr);
  trace_event(sLine,5);
  puVar5 = T_TMK1.arr + 2;
  uVar4 = 0xff;
  T_TMK1.arr[0] = '\0';
  T_TMK1.arr[1] = '\0';
  bVar6 = ((ulong)puVar5 & 4) != 0;
  if (bVar6) {
    T_TMK1.arr[2] = '\0';
    T_TMK1.arr[3] = '\0';
    T_TMK1.arr[4] = '\0';
    T_TMK1.arr[5] = '\0';
    uVar4 = 0xfb;
    puVar5 = T_TMK1.arr + 6;
  }
  for (uVar2 = (ulong)(uVar4 >> 3); uVar2 != 0; uVar2 = uVar2 - 1) {
    puVar5[0] = '\0';
    puVar5[1] = '\0';
    puVar5[2] = '\0';
    puVar5[3] = '\0';
    puVar5[4] = '\0';
    puVar5[5] = '\0';
    puVar5[6] = '\0';
    puVar5[7] = '\0';
    puVar5 = puVar5 + (ulong)bVar7 * -0x10 + 8;
  }
  if (!bVar6) {
    puVar5[0] = '\0';
    puVar5[1] = '\0';
    puVar5[2] = '\0';
    puVar5[3] = '\0';
    puVar5 = puVar5 + 4;
  }
  puVar5[0] = '\0';
  puVar5[1] = '\0';
  puVar5[2] = '\0';
  uVar4 = 0xff;
  T_TMK1.len = 0;
  puVar5 = T_TMK2.arr + 2;
  T_TMK2.arr[0] = '\0';
  T_TMK2.arr[1] = '\0';
  bVar6 = ((ulong)puVar5 & 4) != 0;
  if (bVar6) {
    T_TMK2.arr[2] = '\0';
    T_TMK2.arr[3] = '\0';
    T_TMK2.arr[4] = '\0';
    T_TMK2.arr[5] = '\0';
    uVar4 = 0xfb;
    puVar5 = T_TMK2.arr + 6;
  }
  for (uVar2 = (ulong)(uVar4 >> 3); uVar2 != 0; uVar2 = uVar2 - 1) {
    puVar5[0] = '\0';
    puVar5[1] = '\0';
    puVar5[2] = '\0';
    puVar5[3] = '\0';
    puVar5[4] = '\0';
    puVar5[5] = '\0';
    puVar5[6] = '\0';
    puVar5[7] = '\0';
    puVar5 = puVar5 + (ulong)bVar7 * -0x10 + 8;
  }
  if (!bVar6) {
    puVar5[0] = '\0';
    puVar5[1] = '\0';
    puVar5[2] = '\0';
    puVar5[3] = '\0';
    puVar5 = puVar5 + 4;
  }
  puVar5[0] = '\0';
  puVar5[1] = '\0';
  puVar5[2] = '\0';
  T_TMK2.len = 0;
  T_terminal_nbr.arr[0] = '\0';
  T_terminal_nbr.arr[1] = '\0';
  T_terminal_nbr.arr[2] = '\0';
  T_terminal_nbr.arr[3] = '\0';
  T_terminal_nbr.arr[4] = '\0';
  T_terminal_nbr.arr[5] = '\0';
  T_terminal_nbr.arr[6] = '\0';
  T_terminal_nbr.arr[7] = '\0';
  T_terminal_nbr.arr[8] = '\0';
  T_terminal_nbr.arr[9] = '\0';
  T_terminal_nbr.arr[10] = '\0';
  T_terminal_nbr.arr[0xb] = '\0';
  T_terminal_nbr.arr[0xc] = '\0';
  T_terminal_nbr.arr[0xd] = '\0';
  T_terminal_nbr.arr[0xe] = '\0';
  T_terminal_nbr.arr[0xf] = '\0';
  T_AcqBank.arr[0] = '\0';
  T_AcqBank.arr[1] = '\0';
  T_AcqBank.arr[2] = '\0';
  T_AcqBank.arr[3] = '\0';
  T_AcqBank.arr[4] = '\0';
  T_AcqBank.arr[5] = '\0';
  T_AcqBank.arr[6] = '\0';
  __n = strlen(terminal_nbr);
  memcpy(T_terminal_nbr.arr,terminal_nbr,__n);
  sqlstm.sqlety = 0x1100;
  sqlstm.sqladtp = &sqladt;
  T_terminal_nbr.len = (ushort)__n;
  sqlstm.sqadto[0] = 0;
  sqlstm.sqltdsp = &sqltds;
  sqlstm.sqtdso[0] = 0;
  sqlstm.sqadto[1] = 0;
  sqlstm.stmt = 
  "begin :response := PCRD_GET_HSM_KEY . GET_TMK_AND_TRANS_KEY ( :T_terminal_nbr , :T_TMK1 , :T_TMK2 ) ; END ;"
  ;
  sqlstm.sqtdso[1] = 0;
  response = 3;
  sqlstm.sqlvsn = 0xc;
  sqlstm.cud = sqlcud0;
  sqlstm.sqhstv[0] = (uchar *)&response;
  sqlstm.arrsiz = 8;
  sqlstm.iters = 1;
  sqlstm.offset = 0x3e9;
  sqlstm.sqphsv = sqlstm.sqhstv;
  sqlstm.occurs = 0;
  sqlstm.sqhstl[0] = 4;
  sqlstm.sqhsts[0] = 0;
  sqlstm.sqindv[0] = (short *)0x0;
  sqlstm.sqinds[0] = 0;
  sqlstm.sqharm[0] = 0;
  sqlstm.sqhstl[1] = 0x12;
  sqlstm.sqhsts[1] = 0;
  sqlstm.sqindv[1] = (short *)0x0;
  sqlstm.sqinds[1] = 0;
  sqlstm.sqharm[1] = 0;
  sqlstm.sqhstl[2] = 0x103;
  sqlstm.sqhsts[2] = 0;
  sqlstm.sqindv[2] = (short *)0x0;
  sqlstm.sqinds[2] = 0;
  sqlstm.sqphsl = sqlstm.sqhstl;
  sqlstm.sqtdso[3] = 0;
  sqlstm.sqharm[2] = 0;
  sqlstm.sqphss = sqlstm.sqhsts;
  sqlstm.sqadto[2] = 0;
  sqlstm.sqtdso[2] = 0;
  sqlstm.sqpind = sqlstm.sqindv;
  sqlstm.sqhstl[3] = 0x103;
  sqlstm.sqhsts[3] = 0;
  sqlstm.sqpins = sqlstm.sqinds;
  sqlstm.sqindv[3] = (short *)0x0;
  sqlstm.sqinds[3] = 0;
  sqlstm.sqharm[3] = 0;
  sqlstm.sqparm = sqlstm.sqharm;
  sqlstm.sqadto[3] = 0;
  sqlstm.sqparc = sqlstm.sqharc;
  sqlstm.sqpadto = sqlstm.sqadto;
  sqlstm.sqptdso = sqlstm.sqtdso;
  sqlstm.sqlest = (uchar *)&sqlca;
  sqlstm.sqhstv[1] = (uchar *)&T_terminal_nbr;
  sqlstm.sqhstv[2] = (uchar *)&T_TMK1;
  sqlstm.sqhstv[3] = (uchar *)&T_TMK2;
  sqlcxt((long)nIndiceCtx * 0x10 + 0x713948,&sqlctx,&sqlstm,&sqlfpn);
  if (sqlca.sqlcode < 0) {
    puVar5 = T_TMK1.arr + 2;
    uVar4 = 0xff;
    T_TMK1.arr[0] = '\0';
    T_TMK1.arr[1] = '\0';
    bVar6 = ((ulong)puVar5 & 4) != 0;
    if (bVar6) {
      T_TMK1.arr[2] = '\0';
      T_TMK1.arr[3] = '\0';
      T_TMK1.arr[4] = '\0';
      T_TMK1.arr[5] = '\0';
      uVar4 = 0xfb;
      puVar5 = T_TMK1.arr + 6;
    }
    for (uVar2 = (ulong)(uVar4 >> 3); uVar2 != 0; uVar2 = uVar2 - 1) {
      puVar5[0] = '\0';
      puVar5[1] = '\0';
      puVar5[2] = '\0';
      puVar5[3] = '\0';
      puVar5[4] = '\0';
      puVar5[5] = '\0';
      puVar5[6] = '\0';
      puVar5[7] = '\0';
      puVar5 = puVar5 + (ulong)bVar7 * -0x10 + 8;
    }
    if (!bVar6) {
      puVar5[0] = '\0';
      puVar5[1] = '\0';
      puVar5[2] = '\0';
      puVar5[3] = '\0';
      puVar5 = puVar5 + 4;
    }
    puVar5[0] = '\0';
    puVar5[1] = '\0';
    puVar5[2] = '\0';
    puVar5 = T_TMK2.arr + 2;
    uVar4 = 0xff;
    T_TMK2.arr[0] = '\0';
    T_TMK2.arr[1] = '\0';
    bVar6 = ((ulong)puVar5 & 4) != 0;
    if (bVar6) {
      T_TMK2.arr[2] = '\0';
      T_TMK2.arr[3] = '\0';
      T_TMK2.arr[4] = '\0';
      T_TMK2.arr[5] = '\0';
      uVar4 = 0xfb;
      puVar5 = T_TMK2.arr + 6;
    }
    for (uVar2 = (ulong)(uVar4 >> 3); uVar2 != 0; uVar2 = uVar2 - 1) {
      puVar5[0] = '\0';
      puVar5[1] = '\0';
      puVar5[2] = '\0';
      puVar5[3] = '\0';
      puVar5[4] = '\0';
      puVar5[5] = '\0';
      puVar5[6] = '\0';
      puVar5[7] = '\0';
      puVar5 = puVar5 + (ulong)bVar7 * -0x10 + 8;
    }
    if (!bVar6) {
      puVar5[0] = '\0';
      puVar5[1] = '\0';
      puVar5[2] = '\0';
      puVar5[3] = '\0';
      puVar5 = puVar5 + 4;
    }
    puVar5[0] = '\0';
    puVar5[1] = '\0';
    puVar5[2] = '\0';
    strcpy(sLine,sqlca.sqlerrm.sqlerrmc);
    trace_event(sLine,1);
    trace_event("End  GetTMK (MALFUNCTION)",5);
    iVar1 = 3;
  }
  else if (response == 0) {
    puVar5 = T_TMK1.arr;
    memcpy(TMK1,puVar5,(ulong)T_TMK1.len);
    memcpy(TMK2,T_TMK2.arr,(ulong)T_TMK2.len);
    uVar2 = 0x101;
    if (((ulong)puVar5 & 2) != 0) {
      puVar5 = T_TMK1.arr + 2;
      uVar2 = 0xff;
      T_TMK1.arr[0] = '\0';
      T_TMK1.arr[1] = '\0';
    }
    if (((ulong)puVar5 & 4) != 0) {
      puVar5[0] = '\0';
      puVar5[1] = '\0';
      puVar5[2] = '\0';
      puVar5[3] = '\0';
      uVar2 = (ulong)((int)uVar2 - 4);
      puVar5 = puVar5 + 4;
    }
    for (uVar3 = uVar2 >> 3; uVar3 != 0; uVar3 = uVar3 - 1) {
      puVar5[0] = '\0';
      puVar5[1] = '\0';
      puVar5[2] = '\0';
      puVar5[3] = '\0';
      puVar5[4] = '\0';
      puVar5[5] = '\0';
      puVar5[6] = '\0';
      puVar5[7] = '\0';
      puVar5 = puVar5 + (ulong)bVar7 * -0x10 + 8;
    }
    if ((uVar2 & 4) != 0) {
      puVar5[0] = '\0';
      puVar5[1] = '\0';
      puVar5[2] = '\0';
      puVar5[3] = '\0';
      puVar5 = puVar5 + 4;
    }
    if ((uVar2 & 2) != 0) {
      puVar5[0] = '\0';
      puVar5[1] = '\0';
      puVar5 = puVar5 + 2;
    }
    *puVar5 = '\0';
    puVar5 = T_TMK2.arr + 2;
    uVar4 = 0xff;
    T_TMK2.arr[0] = '\0';
    T_TMK2.arr[1] = '\0';
    bVar6 = ((ulong)puVar5 & 4) != 0;
    if (bVar6) {
      T_TMK2.arr[2] = '\0';
      T_TMK2.arr[3] = '\0';
      T_TMK2.arr[4] = '\0';
      T_TMK2.arr[5] = '\0';
      uVar4 = 0xfb;
      puVar5 = T_TMK2.arr + 6;
    }
    for (uVar2 = (ulong)(uVar4 >> 3); uVar2 != 0; uVar2 = uVar2 - 1) {
      puVar5[0] = '\0';
      puVar5[1] = '\0';
      puVar5[2] = '\0';
      puVar5[3] = '\0';
      puVar5[4] = '\0';
      puVar5[5] = '\0';
      puVar5[6] = '\0';
      puVar5[7] = '\0';
      puVar5 = puVar5 + (ulong)bVar7 * -0x10 + 8;
    }
    if (!bVar6) {
      puVar5[0] = '\0';
      puVar5[1] = '\0';
      puVar5[2] = '\0';
      puVar5[3] = '\0';
      puVar5 = puVar5 + 4;
    }
    puVar5[0] = '\0';
    puVar5[1] = '\0';
    puVar5[2] = '\0';
    if (debug_option == 1) {
      sprintf(sLine,"End   GetTMK(%s,%s)",TMK1,TMK2);
    }
    else {
      builtin_strncpy(sLine,"End   Ge",8);
      builtin_strncpy(sLine + 8,"tTMK()",7);
    }
    trace_event(sLine,5);
    iVar1 = 0;
  }
  else {
    puVar5 = T_TMK1.arr + 2;
    uVar4 = 0xff;
    T_TMK1.arr[0] = '\0';
    T_TMK1.arr[1] = '\0';
    bVar6 = ((ulong)puVar5 & 4) != 0;
    if (bVar6) {
      T_TMK1.arr[2] = '\0';
      T_TMK1.arr[3] = '\0';
      T_TMK1.arr[4] = '\0';
      T_TMK1.arr[5] = '\0';
      uVar4 = 0xfb;
      puVar5 = T_TMK1.arr + 6;
    }
    for (uVar2 = (ulong)(uVar4 >> 3); uVar2 != 0; uVar2 = uVar2 - 1) {
      puVar5[0] = '\0';
      puVar5[1] = '\0';
      puVar5[2] = '\0';
      puVar5[3] = '\0';
      puVar5[4] = '\0';
      puVar5[5] = '\0';
      puVar5[6] = '\0';
      puVar5[7] = '\0';
      puVar5 = puVar5 + (ulong)bVar7 * -0x10 + 8;
    }
    if (!bVar6) {
      puVar5[0] = '\0';
      puVar5[1] = '\0';
      puVar5[2] = '\0';
      puVar5[3] = '\0';
      puVar5 = puVar5 + 4;
    }
    puVar5[0] = '\0';
    puVar5[1] = '\0';
    puVar5[2] = '\0';
    puVar5 = T_TMK2.arr + 2;
    uVar4 = 0xff;
    T_TMK2.arr[0] = '\0';
    T_TMK2.arr[1] = '\0';
    bVar6 = ((ulong)puVar5 & 4) != 0;
    if (bVar6) {
      T_TMK2.arr[2] = '\0';
      T_TMK2.arr[3] = '\0';
      T_TMK2.arr[4] = '\0';
      T_TMK2.arr[5] = '\0';
      uVar4 = 0xfb;
      puVar5 = T_TMK2.arr + 6;
    }
    for (uVar2 = (ulong)(uVar4 >> 3); uVar2 != 0; uVar2 = uVar2 - 1) {
      puVar5[0] = '\0';
      puVar5[1] = '\0';
      puVar5[2] = '\0';
      puVar5[3] = '\0';
      puVar5[4] = '\0';
      puVar5[5] = '\0';
      puVar5[6] = '\0';
      puVar5[7] = '\0';
      puVar5 = puVar5 + (ulong)bVar7 * -0x10 + 8;
    }
    if (!bVar6) {
      puVar5[0] = '\0';
      puVar5[1] = '\0';
      puVar5[2] = '\0';
      puVar5[3] = '\0';
      puVar5 = puVar5 + 4;
    }
    puVar5[0] = '\0';
    puVar5[1] = '\0';
    puVar5[2] = '\0';
    builtin_strncpy(sLine,"End   GetTMK(NOK)",0x12);
    trace_event(sLine,5);
    iVar1 = -1;
  }
  return iVar1;
}



// WARNING: Type propagation algorithm not settling
// WARNING: Unknown calling convention

void InitTlvProd(TSTlvProd *tlvInfo)

{
  ulong uVar1;
  int *piVar2;
  int *piVar3;
  TSTlvProd *pTVar4;
  TSTlvProd *pTVar5;
  char *pcVar6;
  char *pcVar7;
  int iVar8;
  uint uVar9;
  bool bVar11;
  ulong uVar10;
  
  piVar2 = tlvInfo->nPosTlv;
  uVar10 = 0xf9c;
  iVar8 = 0xf9c;
  bVar11 = ((ulong)piVar2 & 1) != 0;
  if (bVar11) {
    piVar2 = (int *)((long)tlvInfo->nPosTlv + 1);
    *(undefined1 *)tlvInfo->nPosTlv = 0;
    uVar10 = 0xf9b;
    iVar8 = 0xf9b;
  }
  if (((ulong)piVar2 & 2) == 0) {
    uVar9 = (uint)uVar10;
  }
  else {
    uVar9 = iVar8 - 2;
    uVar10 = (ulong)uVar9;
    *(undefined2 *)piVar2 = 0;
    piVar2 = (int *)((long)piVar2 + 2);
  }
  if (((ulong)piVar2 & 4) != 0) {
    *piVar2 = 0;
    uVar10 = (ulong)(uVar9 - 4);
    piVar2 = piVar2 + 1;
  }
  for (uVar1 = uVar10 >> 3; uVar1 != 0; uVar1 = uVar1 - 1) {
    piVar2[0] = 0;
    piVar2[1] = 0;
    piVar2 = piVar2 + 2;
  }
  if ((uVar10 & 4) != 0) {
    *piVar2 = 0;
    piVar2 = piVar2 + 1;
  }
  piVar3 = piVar2;
  if ((uVar10 & 2) != 0) {
    piVar3 = (int *)((long)piVar2 + 2);
    *(undefined2 *)piVar2 = 0;
  }
  if (bVar11) {
    *(undefined1 *)piVar3 = 0;
  }
  bVar11 = ((ulong)tlvInfo & 1) != 0;
  uVar10 = 0xf9c;
  iVar8 = 0xf9c;
  if (bVar11) {
    pTVar4 = (TSTlvProd *)((long)tlvInfo->nPresent + 1);
    *(undefined1 *)tlvInfo->nPresent = 0xff;
    uVar10 = 0xf9b;
    iVar8 = 0xf9b;
    uVar1 = (ulong)pTVar4 & 2;
  }
  else {
    uVar1 = (ulong)tlvInfo & 2;
    pTVar4 = tlvInfo;
  }
  if (uVar1 == 0) {
    uVar9 = (uint)uVar10;
  }
  else {
    uVar9 = iVar8 - 2;
    uVar10 = (ulong)uVar9;
    *(undefined2 *)pTVar4->nPresent = 0xffff;
    pTVar4 = (TSTlvProd *)((long)pTVar4->nPresent + 2);
  }
  if (((ulong)pTVar4 & 4) != 0) {
    pTVar4->nPresent[0] = -1;
    uVar10 = (ulong)(uVar9 - 4);
    pTVar4 = (TSTlvProd *)(pTVar4->nPresent + 1);
  }
  for (uVar1 = uVar10 >> 3; uVar1 != 0; uVar1 = uVar1 - 1) {
    pTVar4->nPresent[0] = -1;
    pTVar4->nPresent[1] = -1;
    pTVar4 = (TSTlvProd *)(pTVar4->nPresent + 2);
  }
  if ((uVar10 & 4) != 0) {
    pTVar4->nPresent[0] = -1;
    pTVar4 = (TSTlvProd *)(pTVar4->nPresent + 1);
  }
  pTVar5 = pTVar4;
  if ((uVar10 & 2) != 0) {
    pTVar5 = (TSTlvProd *)((long)pTVar4->nPresent + 2);
    *(undefined2 *)pTVar4->nPresent = 0xffff;
  }
  if (bVar11) {
    *(undefined1 *)pTVar5->nPresent = 0xff;
  }
  pcVar7 = tlvInfo->sTlvData;
  tlvInfo->nLength = 0;
  uVar10 = 0x1002;
  iVar8 = 0x1002;
  bVar11 = ((ulong)pcVar7 & 1) != 0;
  if (bVar11) {
    pcVar7 = tlvInfo->sTlvData + 1;
    tlvInfo->sTlvData[0] = '\0';
    uVar10 = 0x1001;
    iVar8 = 0x1001;
  }
  if (((ulong)pcVar7 & 2) == 0) {
    uVar9 = (uint)uVar10;
    pcVar6 = pcVar7;
  }
  else {
    pcVar6 = pcVar7 + 2;
    uVar9 = iVar8 - 2;
    uVar10 = (ulong)uVar9;
    pcVar7[0] = '\0';
    pcVar7[1] = '\0';
  }
  if (((ulong)pcVar6 & 4) != 0) {
    pcVar6[0] = '\0';
    pcVar6[1] = '\0';
    pcVar6[2] = '\0';
    pcVar6[3] = '\0';
    uVar10 = (ulong)(uVar9 - 4);
    pcVar6 = pcVar6 + 4;
  }
  for (uVar1 = uVar10 >> 3; uVar1 != 0; uVar1 = uVar1 - 1) {
    pcVar6[0] = '\0';
    pcVar6[1] = '\0';
    pcVar6[2] = '\0';
    pcVar6[3] = '\0';
    pcVar6[4] = '\0';
    pcVar6[5] = '\0';
    pcVar6[6] = '\0';
    pcVar6[7] = '\0';
    pcVar6 = pcVar6 + 8;
  }
  if ((uVar10 & 4) != 0) {
    pcVar6[0] = '\0';
    pcVar6[1] = '\0';
    pcVar6[2] = '\0';
    pcVar6[3] = '\0';
    pcVar6 = pcVar6 + 4;
  }
  pcVar7 = pcVar6;
  if ((uVar10 & 2) != 0) {
    pcVar7 = pcVar6 + 2;
    pcVar6[0] = '\0';
    pcVar6[1] = '\0';
  }
  if (bVar11) {
    *pcVar7 = '\0';
  }
  return;
}



// WARNING: Unknown calling convention

void AdjustTlvProd(TSTlvProd *tlvInfo,int nIndice,int nLength)

{
  int *piVar1;
  
  if (nIndice < 999) {
    do {
      piVar1 = tlvInfo->nPresent + nIndice;
      if (*piVar1 == 0) {
        piVar1[999] = piVar1[999] + nLength;
      }
      nIndice = nIndice + 1;
    } while (nIndice != 999);
  }
  return;
}



// WARNING: Unknown calling convention

int GetTlvProdIndice(char *szTlvName)

{
  int iVar1;
  int iVar2;
  tlv_info_t *__s2;
  
  __s2 = tab_TlvProdInfo;
  iVar2 = 0;
  do {
    iVar1 = memcmp(szTlvName,__s2,3);
    if (iVar1 == 0) {
      return iVar2;
    }
    iVar2 = iVar2 + 1;
    __s2 = __s2 + 1;
  } while (iVar2 != 0x18);
  return -1;
}



// WARNING: Unknown calling convention

int GetTlvProdType(int nIndice)

{
  return tab_TlvProdInfo[nIndice].nType;
}



// WARNING: Unknown calling convention

int GetTlvProdLength(int nIndice)

{
  return tab_TlvProdInfo[nIndice].nLength;
}



// WARNING: Unknown calling convention

int GetTlvProd(char *tlv_name,TSTlvProd *tlvInfo,char *data,int *length)

{
  int *piVar1;
  int nIndice;
  uint uVar2;
  long lVar3;
  char szAscTlvLen [4];
  
  szAscTlvLen[0] = '\0';
  szAscTlvLen[1] = '\0';
  szAscTlvLen[2] = '\0';
  szAscTlvLen[3] = '\0';
  nIndice = GetTlvProdIndice(tlv_name);
  if (nIndice != -1) {
    uVar2 = GetTlvProdType(nIndice);
    piVar1 = tlvInfo->nPresent + nIndice;
    GetTlvProdLength(nIndice);
    if (*piVar1 != -1) {
      szAscTlvLen._0_3_ = *(undefined3 *)(tlvInfo->sTlvData + (long)piVar1[999] + 3);
      lVar3 = strtol(szAscTlvLen,(char **)0x0,10);
      *length = (int)lVar3;
      if (1 < uVar2) {
        return -1;
      }
      memcpy(data,tlvInfo->sTlvData + (long)piVar1[999] + 6,(long)(int)lVar3);
      data[*length] = '\0';
      return 0;
    }
  }
  return -1;
}



// WARNING: Unknown calling convention

int AddTlvProd(char *tlv_name,TSTlvProd *tlvInfo,char *data,int length)

{
  int *piVar1;
  int iVar2;
  uint uVar3;
  char szAscTlvLen [4];
  
  szAscTlvLen[0] = '\0';
  szAscTlvLen[1] = '\0';
  szAscTlvLen[2] = '\0';
  szAscTlvLen[3] = '\0';
  if (length != 0) {
    iVar2 = GetTlvProdIndice(tlv_name);
    if (iVar2 != -1) {
      uVar3 = GetTlvProdType(iVar2);
      GetTlvProdLength(iVar2);
      piVar1 = tlvInfo->nPresent + iVar2;
      sprintf(szAscTlvLen,"%.3d",(ulong)(uint)length);
      if (*piVar1 != 0) {
        if (uVar3 < 2) {
          memcpy(tlvInfo->sTlvData + (long)tlvInfo->nLength + 6,data,(long)length);
        }
        iVar2 = tlvInfo->nLength;
        *(undefined2 *)(tlvInfo->sTlvData + iVar2) = *(undefined2 *)tlv_name;
        tlvInfo->sTlvData[(long)iVar2 + 2] = tlv_name[2];
        iVar2 = tlvInfo->nLength;
        *(undefined2 *)(tlvInfo->sTlvData + (long)iVar2 + 3) = szAscTlvLen._0_2_;
        tlvInfo->sTlvData[(long)iVar2 + 5] = szAscTlvLen[2];
        iVar2 = tlvInfo->nLength;
        *piVar1 = 0;
        piVar1[999] = iVar2;
        tlvInfo->nLength = iVar2 + 6 + length;
        return 0;
      }
    }
  }
  return -1;
}



// WARNING: Unknown calling convention

int PutTlvProd(char *tlv_name,TSTlvProd *tlvInfo,char *data,int length)

{
  int *piVar1;
  int iVar2;
  uint uVar3;
  long lVar4;
  char *pcVar5;
  int iVar6;
  long lVar7;
  byte bVar8;
  char szAscTlvLen [4];
  char szOldTlvLen [4];
  char szLastPart [4098];
  
  bVar8 = 0;
  szAscTlvLen[0] = '\0';
  szAscTlvLen[1] = '\0';
  szAscTlvLen[2] = '\0';
  szAscTlvLen[3] = '\0';
  szOldTlvLen[0] = '\0';
  szOldTlvLen[1] = '\0';
  szOldTlvLen[2] = '\0';
  szOldTlvLen[3] = '\0';
  if ((length == 0) || (iVar2 = GetTlvProdIndice(tlv_name), iVar2 == -1)) {
    return -1;
  }
  uVar3 = GetTlvProdType(iVar2);
  GetTlvProdLength(iVar2);
  sprintf(szAscTlvLen,"%.3d",(ulong)(uint)length);
  pcVar5 = szLastPart;
  for (lVar4 = 0x200; lVar4 != 0; lVar4 = lVar4 + -1) {
    pcVar5[0] = '\0';
    pcVar5[1] = '\0';
    pcVar5[2] = '\0';
    pcVar5[3] = '\0';
    pcVar5[4] = '\0';
    pcVar5[5] = '\0';
    pcVar5[6] = '\0';
    pcVar5[7] = '\0';
    pcVar5 = pcVar5 + (ulong)bVar8 * -0x10 + 8;
  }
  pcVar5[0] = '\0';
  pcVar5[1] = '\0';
  piVar1 = tlvInfo->nPresent + iVar2;
  if (*piVar1 != 0) {
    if (uVar3 < 2) {
      memcpy(tlvInfo->sTlvData + (long)tlvInfo->nLength + 6,data,(long)length);
    }
    iVar2 = tlvInfo->nLength;
    *(undefined2 *)(tlvInfo->sTlvData + iVar2) = *(undefined2 *)tlv_name;
    tlvInfo->sTlvData[(long)iVar2 + 2] = tlv_name[2];
    iVar2 = tlvInfo->nLength;
    *(undefined2 *)(tlvInfo->sTlvData + (long)iVar2 + 3) = szAscTlvLen._0_2_;
    tlvInfo->sTlvData[(long)iVar2 + 5] = szAscTlvLen[2];
    iVar2 = tlvInfo->nLength;
    *piVar1 = 0;
    piVar1[999] = iVar2;
    tlvInfo->nLength = iVar2 + 6 + length;
    return 0;
  }
  if (1 < uVar3) {
    return 0;
  }
                    // WARNING: Ignoring partial resolution of indirect
  szOldTlvLen._0_2_ = *(undefined2 *)(tlvInfo->sTlvData + (long)piVar1[999] + 3);
  lVar4 = strtol(szOldTlvLen,(char **)0x0,10);
  lVar7 = (long)piVar1[999];
  iVar6 = (int)lVar4;
  memcpy(szLastPart,tlvInfo->sTlvData + lVar7 + iVar6 + 6,
         (long)(((tlvInfo->nLength - piVar1[999]) + -6) - iVar6));
  *(undefined2 *)(tlvInfo->sTlvData + lVar7 + 3) = szAscTlvLen._0_2_;
  tlvInfo->sTlvData[lVar7 + 5] = szAscTlvLen[2];
  memcpy(tlvInfo->sTlvData + (long)piVar1[999] + 6,data,(long)length);
  memcpy(tlvInfo->sTlvData + (long)length + (long)piVar1[999] + 6,szLastPart,
         (long)(((tlvInfo->nLength - piVar1[999]) + -6) - iVar6));
  tlvInfo->nLength = tlvInfo->nLength + (length - iVar6);
  AdjustTlvProd(tlvInfo,iVar2 + 1,length - iVar6);
  return 0;
}



// WARNING: Unknown calling convention

int ProdBuildTlv(char *buffer_snd,TSTlvProd *tlvInfo)

{
  char sLLLL [5];
  
  sLLLL[0] = '\0';
  sLLLL[1] = '\0';
  sLLLL[2] = '\0';
  sLLLL[3] = '\0';
  sLLLL[4] = '\0';
  sprintf(sLLLL,"%04d",(ulong)(uint)tlvInfo->nLength);
  *(undefined4 *)buffer_snd = sLLLL._0_4_;
  memcpy(buffer_snd + 4,tlvInfo->sTlvData,(long)tlvInfo->nLength);
  return tlvInfo->nLength + 4;
}



// WARNING: Unknown calling convention

int PutProdTlvBuffer(char *tlv_name,char *tlvbuffer,char *data,int length)

{
  int iVar1;
  undefined4 in_register_0000000c;
  int iVar2;
  char sLine [512];
  TSTlvProd tlvInfo;
  
  sprintf(sLine,"TAG : %s Length = %d, .%.4s",tlv_name,CONCAT44(in_register_0000000c,length),
          tlvbuffer);
  trace_event(sLine,1);
  InitTlvProd(&tlvInfo);
  AnalyseTlvProd(tlvbuffer,&tlvInfo);
  iVar1 = PutTlvProd(tlv_name,&tlvInfo,data,length);
  iVar2 = -1;
  if (iVar1 == 0) {
    ProdBuildTlv(tlvbuffer,&tlvInfo);
    iVar2 = 0;
  }
  return iVar2;
}



// WARNING: Unknown calling convention

int GetProdTlvBuffer(char *tlv_name,char *tlvbuffer,char *data,int *length)

{
  int iVar1;
  size_t sVar2;
  TSTlvProd tlvInfo;
  
  InitTlvProd(&tlvInfo);
  sVar2 = strlen(tlvbuffer);
  if (sVar2 < 4) {
    trace_event("PutTlvBuffer ECHEC LENGTH ",5);
    iVar1 = -1;
  }
  else {
    AnalyseTlvProd(tlvbuffer,&tlvInfo);
    iVar1 = GetTlvProd(tlv_name,&tlvInfo,data,length);
  }
  return iVar1;
}



// WARNING: Unknown calling convention

int PrintProdTlvBuffer(char *sTlvBuffer)

{
  t_tlv_print *ptVar1;
  int iVar2;
  long lVar3;
  char *pcVar4;
  char **ppcVar5;
  byte bVar6;
  int length;
  char data [999];
  char ligne [999];
  TSTlvProd sTlvInfo;
  
  bVar6 = 0;
  InitTlvProd(&sTlvInfo);
  AnalyseTlvProd(sTlvBuffer,&sTlvInfo);
  builtin_strncpy(ligne,"-----------------------------------------",0x2a);
  trace_event(ligne,5);
  sprintf(ligne,"%.3s\t %25s \t%s\t%s",&DAT_004d4054,&DAT_004d404f,&DAT_004d404b,"VALUE");
  trace_event(ligne,5);
  sprintf(ligne,"%.3s\t-%25s-\t%s\t%s","---","-----");
  trace_event(ligne,5);
  ppcVar5 = &sTlvProd[0].value;
  do {
    while( true ) {
      pcVar4 = data;
      for (lVar3 = 0x7c; lVar3 != 0; lVar3 = lVar3 + -1) {
        pcVar4[0] = '\0';
        pcVar4[1] = '\0';
        pcVar4[2] = '\0';
        pcVar4[3] = '\0';
        pcVar4[4] = '\0';
        pcVar4[5] = '\0';
        pcVar4[6] = '\0';
        pcVar4[7] = '\0';
        pcVar4 = pcVar4 + (ulong)bVar6 * -0x10 + 8;
      }
      pcVar4[4] = '\0';
      pcVar4[5] = '\0';
      pcVar4[0] = '\0';
      pcVar4[1] = '\0';
      pcVar4[2] = '\0';
      pcVar4[3] = '\0';
      pcVar4[6] = '\0';
      iVar2 = GetTlvProd(*ppcVar5,&sTlvInfo,data,&length);
      if (iVar2 != 0) break;
      ptVar1 = (t_tlv_print *)(ppcVar5 + -1);
      pcVar4 = *ppcVar5;
      ppcVar5 = ppcVar5 + 2;
      sprintf(ligne,"%.3s\t{%25s}\t%03d\t%s",pcVar4,ptVar1->description,(ulong)(uint)length,data);
      trace_event(ligne,5);
      if (ppcVar5 == (char **)&tab_TlvAuthoInfo[0].nLength) goto LAB_004887b1;
    }
    ppcVar5 = ppcVar5 + 2;
  } while (ppcVar5 != (char **)&tab_TlvAuthoInfo[0].nLength);
LAB_004887b1:
  builtin_strncpy(ligne,"-----------------------------------------",0x2a);
  trace_event(ligne,5);
  return 0;
}



// WARNING: Unknown calling convention

int AnalyseTlvProd(char *buffer,TSTlvProd *tlvInfo)

{
  int iVar1;
  int iVar2;
  long lVar3;
  char *__src;
  int iVar4;
  char szTlvName [5];
  char szTlvValueLen [5];
  char sLLLL [5];
  
  __src = buffer + 4;
  sLLLL[0] = '\0';
  sLLLL[1] = '\0';
  sLLLL[2] = '\0';
  sLLLL[3] = '\0';
  sLLLL[4] = '\0';
  InitTlvProd(tlvInfo);
  sLLLL._0_4_ = *(undefined4 *)buffer;
  lVar3 = strtol(sLLLL,(char **)0x0,10);
  iVar1 = (int)lVar3;
  tlvInfo->nLength = iVar1;
  memcpy(tlvInfo->sTlvData,__src,(long)iVar1);
  if (0 < iVar1) {
    iVar4 = 0;
    do {
      szTlvName[3] = '0';
      szTlvName._0_3_ = *(undefined3 *)__src;
      szTlvValueLen[3] = '\0';
      szTlvValueLen._0_3_ = *(uint3 *)(__src + 3);
      lVar3 = strtol(szTlvValueLen,(char **)0x0,10);
      iVar2 = GetTlvProdIndice(szTlvName);
      if (-1 < iVar2) {
        (tlvInfo->nPresent + iVar2)[999] = iVar4;
        tlvInfo->nPresent[iVar2] = 0;
      }
      iVar2 = (int)lVar3 + 6;
      iVar4 = iVar4 + iVar2;
      __src = __src + iVar2;
    } while (iVar4 < iVar1);
  }
  return 0;
}



// WARNING: Type propagation algorithm not settling
// WARNING: Unknown calling convention

void InitTlvAutho(TSTlvAutho *tlvInfo)

{
  ulong uVar1;
  int *piVar2;
  int *piVar3;
  TSTlvAutho *pTVar4;
  TSTlvAutho *pTVar5;
  char *pcVar6;
  char *pcVar7;
  int iVar8;
  uint uVar9;
  bool bVar11;
  ulong uVar10;
  
  piVar2 = tlvInfo->nPosTlv;
  uVar10 = 0xf9c;
  iVar8 = 0xf9c;
  bVar11 = ((ulong)piVar2 & 1) != 0;
  if (bVar11) {
    piVar2 = (int *)((long)tlvInfo->nPosTlv + 1);
    *(undefined1 *)tlvInfo->nPosTlv = 0;
    uVar10 = 0xf9b;
    iVar8 = 0xf9b;
  }
  if (((ulong)piVar2 & 2) == 0) {
    uVar9 = (uint)uVar10;
  }
  else {
    uVar9 = iVar8 - 2;
    uVar10 = (ulong)uVar9;
    *(undefined2 *)piVar2 = 0;
    piVar2 = (int *)((long)piVar2 + 2);
  }
  if (((ulong)piVar2 & 4) != 0) {
    *piVar2 = 0;
    uVar10 = (ulong)(uVar9 - 4);
    piVar2 = piVar2 + 1;
  }
  for (uVar1 = uVar10 >> 3; uVar1 != 0; uVar1 = uVar1 - 1) {
    piVar2[0] = 0;
    piVar2[1] = 0;
    piVar2 = piVar2 + 2;
  }
  if ((uVar10 & 4) != 0) {
    *piVar2 = 0;
    piVar2 = piVar2 + 1;
  }
  piVar3 = piVar2;
  if ((uVar10 & 2) != 0) {
    piVar3 = (int *)((long)piVar2 + 2);
    *(undefined2 *)piVar2 = 0;
  }
  if (bVar11) {
    *(undefined1 *)piVar3 = 0;
  }
  bVar11 = ((ulong)tlvInfo & 1) != 0;
  uVar10 = 0xf9c;
  iVar8 = 0xf9c;
  if (bVar11) {
    pTVar4 = (TSTlvAutho *)((long)tlvInfo->nPresent + 1);
    *(undefined1 *)tlvInfo->nPresent = 0xff;
    uVar10 = 0xf9b;
    iVar8 = 0xf9b;
    uVar1 = (ulong)pTVar4 & 2;
  }
  else {
    uVar1 = (ulong)tlvInfo & 2;
    pTVar4 = tlvInfo;
  }
  if (uVar1 == 0) {
    uVar9 = (uint)uVar10;
  }
  else {
    uVar9 = iVar8 - 2;
    uVar10 = (ulong)uVar9;
    *(undefined2 *)pTVar4->nPresent = 0xffff;
    pTVar4 = (TSTlvAutho *)((long)pTVar4->nPresent + 2);
  }
  if (((ulong)pTVar4 & 4) != 0) {
    pTVar4->nPresent[0] = -1;
    uVar10 = (ulong)(uVar9 - 4);
    pTVar4 = (TSTlvAutho *)(pTVar4->nPresent + 1);
  }
  for (uVar1 = uVar10 >> 3; uVar1 != 0; uVar1 = uVar1 - 1) {
    pTVar4->nPresent[0] = -1;
    pTVar4->nPresent[1] = -1;
    pTVar4 = (TSTlvAutho *)(pTVar4->nPresent + 2);
  }
  if ((uVar10 & 4) != 0) {
    pTVar4->nPresent[0] = -1;
    pTVar4 = (TSTlvAutho *)(pTVar4->nPresent + 1);
  }
  pTVar5 = pTVar4;
  if ((uVar10 & 2) != 0) {
    pTVar5 = (TSTlvAutho *)((long)pTVar4->nPresent + 2);
    *(undefined2 *)pTVar4->nPresent = 0xffff;
  }
  if (bVar11) {
    *(undefined1 *)pTVar5->nPresent = 0xff;
  }
  pcVar7 = tlvInfo->sTlvData;
  tlvInfo->nLength = 0;
  uVar10 = 0x1002;
  iVar8 = 0x1002;
  bVar11 = ((ulong)pcVar7 & 1) != 0;
  if (bVar11) {
    pcVar7 = tlvInfo->sTlvData + 1;
    tlvInfo->sTlvData[0] = '\0';
    uVar10 = 0x1001;
    iVar8 = 0x1001;
  }
  if (((ulong)pcVar7 & 2) == 0) {
    uVar9 = (uint)uVar10;
    pcVar6 = pcVar7;
  }
  else {
    pcVar6 = pcVar7 + 2;
    uVar9 = iVar8 - 2;
    uVar10 = (ulong)uVar9;
    pcVar7[0] = '\0';
    pcVar7[1] = '\0';
  }
  if (((ulong)pcVar6 & 4) != 0) {
    pcVar6[0] = '\0';
    pcVar6[1] = '\0';
    pcVar6[2] = '\0';
    pcVar6[3] = '\0';
    uVar10 = (ulong)(uVar9 - 4);
    pcVar6 = pcVar6 + 4;
  }
  for (uVar1 = uVar10 >> 3; uVar1 != 0; uVar1 = uVar1 - 1) {
    pcVar6[0] = '\0';
    pcVar6[1] = '\0';
    pcVar6[2] = '\0';
    pcVar6[3] = '\0';
    pcVar6[4] = '\0';
    pcVar6[5] = '\0';
    pcVar6[6] = '\0';
    pcVar6[7] = '\0';
    pcVar6 = pcVar6 + 8;
  }
  if ((uVar10 & 4) != 0) {
    pcVar6[0] = '\0';
    pcVar6[1] = '\0';
    pcVar6[2] = '\0';
    pcVar6[3] = '\0';
    pcVar6 = pcVar6 + 4;
  }
  pcVar7 = pcVar6;
  if ((uVar10 & 2) != 0) {
    pcVar7 = pcVar6 + 2;
    pcVar6[0] = '\0';
    pcVar6[1] = '\0';
  }
  if (bVar11) {
    *pcVar7 = '\0';
  }
  return;
}



// WARNING: Unknown calling convention

void AdjustTlvAutho(TSTlvAutho *tlvInfo,int nIndice,int nLength)

{
  int *piVar1;
  
  if (nIndice < 999) {
    do {
      piVar1 = tlvInfo->nPresent + nIndice;
      if (*piVar1 == 0) {
        piVar1[999] = piVar1[999] + nLength;
      }
      nIndice = nIndice + 1;
    } while (nIndice != 999);
  }
  return;
}



// WARNING: Unknown calling convention

int GetTlvAuthoIndice(char *szTlvName)

{
  int iVar1;
  int iVar2;
  tlv_info_t *__s2;
  
  __s2 = tab_TlvAuthoInfo;
  iVar2 = 0;
  do {
    iVar1 = memcmp(szTlvName,__s2,3);
    if (iVar1 == 0) {
      return iVar2;
    }
    iVar2 = iVar2 + 1;
    __s2 = __s2 + 1;
  } while (iVar2 != 0x11b);
  return -1;
}



// WARNING: Unknown calling convention

int GetTlvAuthoType(int nIndice)

{
  return tab_TlvAuthoInfo[nIndice].nType;
}



// WARNING: Unknown calling convention

int GetTlvAuthoLength(int nIndice)

{
  return tab_TlvAuthoInfo[nIndice].nLength;
}



// WARNING: Unknown calling convention

int ValidateTlvData(char *pTlvBuffer)

{
  int iVar1;
  long lVar2;
  ulong uVar3;
  tlv_info_t *ptVar4;
  char *pcVar5;
  uint *puVar6;
  uint *puVar7;
  uchar *puVar8;
  uint uVar9;
  uint uVar10;
  bool bVar11;
  byte bVar12;
  int length;
  char tlv_name [256];
  char sLine [512];
  char data [4096];
  TSTlvAutho tlvInfo;
  
  bVar12 = 0;
  trace_event("Start ValidateTlvData()",5);
  InitTlvAutho(&tlvInfo);
  uVar3 = 0;
  AnalyseTlvAutho(pTlvBuffer,&tlvInfo);
  ptVar4 = tab_TlvAuthoInfo;
  do {
    if (tlvInfo.nPresent[uVar3] == 0) {
      pcVar5 = tlv_name;
      for (lVar2 = 0x20; lVar2 != 0; lVar2 = lVar2 + -1) {
        pcVar5[0] = '\0';
        pcVar5[1] = '\0';
        pcVar5[2] = '\0';
        pcVar5[3] = '\0';
        pcVar5[4] = '\0';
        pcVar5[5] = '\0';
        pcVar5[6] = '\0';
        pcVar5[7] = '\0';
        pcVar5 = pcVar5 + (ulong)bVar12 * -0x10 + 8;
      }
      tlv_name._0_2_ = *(undefined2 *)ptVar4->sTlvName;
      tlv_name[2] = ptVar4->sTlvName[2];
      puVar6 = (uint *)data;
      for (lVar2 = 0x200; lVar2 != 0; lVar2 = lVar2 + -1) {
        puVar6[0] = 0;
        puVar6[1] = 0;
        puVar6 = puVar6 + (ulong)bVar12 * -4 + 2;
      }
      iVar1 = GetTlvAutho(tlv_name,&tlvInfo,data,&length);
      if (iVar1 != 0) {
        sprintf(sLine,"End   ValidateTlvData|Presence Error(NOK|%s)",tlv_name);
        trace_event(sLine,5);
        return -1;
      }
      puVar6 = (uint *)data;
      do {
        puVar7 = puVar6;
        uVar9 = *puVar7 + 0xfefefeff & ~*puVar7;
        uVar10 = uVar9 & 0x80808080;
        puVar6 = puVar7 + 1;
      } while (uVar10 == 0);
      bVar11 = (uVar9 & 0x8080) == 0;
      if (bVar11) {
        uVar10 = uVar10 >> 0x10;
      }
      if (bVar11) {
        puVar6 = (uint *)((long)puVar7 + 6);
      }
      puVar8 = (uchar *)((long)puVar6 +
                        ((-3 - (ulong)CARRY1((byte)uVar10,(byte)uVar10)) - (long)data));
      if ((uchar *)(long)length != puVar8) {
        sprintf(sLine,"End   ValidateTlvData|Length Error(NOK|%s|%d|%d|%d)",tlv_name,
                (ulong)(uint)length,puVar8,uVar3 & 0xffffffff);
        trace_event(sLine,5);
        dump_buffer((uchar *)data,length,'A','X','X');
        dump_buffer((uchar *)tlvInfo.sTlvData,tlvInfo.nLength,'A','X','X');
        return -1;
      }
    }
    uVar3 = uVar3 + 1;
    ptVar4 = ptVar4 + 1;
    if (uVar3 == 0x11b) {
      trace_event("End   ValidateTlvData(OK)",5);
      return 0;
    }
  } while( true );
}



// WARNING: Unknown calling convention

int AnalyseTlvAutho(char *buffer,TSTlvAutho *tlvInfo)

{
  int iVar1;
  int iVar2;
  long lVar3;
  char *__src;
  int iVar4;
  char szTlvName [5];
  char szTlvValueLen [5];
  char sLLLL [5];
  
  __src = buffer + 4;
  sLLLL[0] = '\0';
  sLLLL[1] = '\0';
  sLLLL[2] = '\0';
  sLLLL[3] = '\0';
  sLLLL[4] = '\0';
  InitTlvAutho(tlvInfo);
  sLLLL._0_4_ = *(undefined4 *)buffer;
  lVar3 = strtol(sLLLL,(char **)0x0,10);
  iVar1 = (int)lVar3;
  tlvInfo->nLength = iVar1;
  memcpy(tlvInfo->sTlvData,__src,(long)iVar1);
  if (0 < iVar1) {
    iVar4 = 0;
    do {
      szTlvName[3] = '0';
      szTlvName._0_3_ = *(undefined3 *)__src;
      szTlvValueLen[3] = '\0';
      szTlvValueLen._0_3_ = *(uint3 *)(__src + 3);
      lVar3 = strtol(szTlvValueLen,(char **)0x0,10);
      iVar2 = GetTlvAuthoIndice(szTlvName);
      if (-1 < iVar2) {
        (tlvInfo->nPresent + iVar2)[999] = iVar4;
        tlvInfo->nPresent[iVar2] = 0;
      }
      iVar2 = (int)lVar3 + 6;
      iVar4 = iVar4 + iVar2;
      __src = __src + iVar2;
    } while (iVar4 < iVar1);
  }
  return 0;
}



// WARNING: Unknown calling convention

int DelTlvAutho(char *tlv_name,TSTlvAutho *tlvInfo)

{
  int *piVar1;
  int iVar2;
  int iVar3;
  uint uVar4;
  int iVar5;
  long lVar6;
  char *pcVar7;
  size_t __n;
  byte bVar8;
  char szAscTlvLen [4];
  char szOldTlvLen [4];
  char szLastPart [4098];
  
  bVar8 = 0;
  szOldTlvLen[0] = '\0';
  szOldTlvLen[1] = '\0';
  szOldTlvLen[2] = '\0';
  szOldTlvLen[3] = '\0';
  iVar3 = GetTlvAuthoIndice(tlv_name);
  if (iVar3 != -1) {
    uVar4 = GetTlvAuthoType(iVar3);
    GetTlvAuthoLength(iVar3);
    pcVar7 = szLastPart;
    for (lVar6 = 0x200; lVar6 != 0; lVar6 = lVar6 + -1) {
      pcVar7[0] = '\0';
      pcVar7[1] = '\0';
      pcVar7[2] = '\0';
      pcVar7[3] = '\0';
      pcVar7[4] = '\0';
      pcVar7[5] = '\0';
      pcVar7[6] = '\0';
      pcVar7[7] = '\0';
      pcVar7 = pcVar7 + (ulong)bVar8 * -0x10 + 8;
    }
    piVar1 = tlvInfo->nPresent + iVar3;
    iVar2 = *piVar1;
    pcVar7[0] = '\0';
    pcVar7[1] = '\0';
    if (iVar2 == 0) {
      if (1 < uVar4) {
        return 0;
      }
      szOldTlvLen._0_3_ = *(undefined3 *)(tlvInfo->sTlvData + (long)piVar1[999] + 3);
      lVar6 = strtol(szOldTlvLen,(char **)0x0,10);
      iVar2 = piVar1[999];
      iVar5 = (int)lVar6;
      __n = (size_t)(((tlvInfo->nLength - iVar2) + -6) - iVar5);
      memcpy(szLastPart,tlvInfo->sTlvData + (long)iVar2 + (long)iVar5 + 6,__n);
      memcpy(tlvInfo->sTlvData + iVar2,szLastPart,__n);
      iVar3 = iVar3 + 1;
      tlvInfo->nLength = tlvInfo->nLength - (iVar5 + 6);
      *piVar1 = -1;
      if (iVar3 < 999) {
        do {
          piVar1 = tlvInfo->nPresent + iVar3;
          if (*piVar1 == 0) {
            piVar1[999] = piVar1[999] - (iVar5 + 6);
          }
          iVar3 = iVar3 + 1;
        } while (iVar3 != 999);
      }
    }
    iVar3 = 0;
  }
  return iVar3;
}



// WARNING: Unknown calling convention

int GetTlvAutho(char *tlv_name,TSTlvAutho *tlvInfo,char *data,int *length)

{
  int *piVar1;
  int nIndice;
  uint uVar2;
  long lVar3;
  char szAscTlvLen [4];
  
  szAscTlvLen[0] = '\0';
  szAscTlvLen[1] = '\0';
  szAscTlvLen[2] = '\0';
  szAscTlvLen[3] = '\0';
  nIndice = GetTlvAuthoIndice(tlv_name);
  if (nIndice != -1) {
    uVar2 = GetTlvAuthoType(nIndice);
    piVar1 = tlvInfo->nPresent + nIndice;
    GetTlvAuthoLength(nIndice);
    if (*piVar1 != -1) {
      szAscTlvLen._0_3_ = *(undefined3 *)(tlvInfo->sTlvData + (long)piVar1[999] + 3);
      lVar3 = strtol(szAscTlvLen,(char **)0x0,10);
      *length = (int)lVar3;
      if (1 < uVar2) {
        return -1;
      }
      memcpy(data,tlvInfo->sTlvData + (long)piVar1[999] + 6,(long)(int)lVar3);
      data[*length] = '\0';
      return 0;
    }
  }
  return -1;
}



// WARNING: Unknown calling convention

int AddTlvAutho(char *tlv_name,TSTlvAutho *tlvInfo,char *data,int length)

{
  int *piVar1;
  int iVar2;
  uint uVar3;
  char szAscTlvLen [4];
  
  szAscTlvLen[0] = '\0';
  szAscTlvLen[1] = '\0';
  szAscTlvLen[2] = '\0';
  szAscTlvLen[3] = '\0';
  if (length != 0) {
    iVar2 = GetTlvAuthoIndice(tlv_name);
    if (iVar2 != -1) {
      uVar3 = GetTlvAuthoType(iVar2);
      GetTlvAuthoLength(iVar2);
      piVar1 = tlvInfo->nPresent + iVar2;
      sprintf(szAscTlvLen,"%.3d",(ulong)(uint)length);
      if (*piVar1 != 0) {
        if (uVar3 < 2) {
          memcpy(tlvInfo->sTlvData + (long)tlvInfo->nLength + 6,data,(long)length);
        }
        iVar2 = tlvInfo->nLength;
        *(undefined2 *)(tlvInfo->sTlvData + iVar2) = *(undefined2 *)tlv_name;
        tlvInfo->sTlvData[(long)iVar2 + 2] = tlv_name[2];
        iVar2 = tlvInfo->nLength;
        *(undefined2 *)(tlvInfo->sTlvData + (long)iVar2 + 3) = szAscTlvLen._0_2_;
        tlvInfo->sTlvData[(long)iVar2 + 5] = szAscTlvLen[2];
        iVar2 = tlvInfo->nLength;
        *piVar1 = 0;
        piVar1[999] = iVar2;
        tlvInfo->nLength = iVar2 + 6 + length;
        return 0;
      }
    }
  }
  return -1;
}



// WARNING: Restarted to delay deadcode elimination for space: stack
// WARNING: Unknown calling convention

int PutTlvAutho(char *tlv_name,TSTlvAutho *tlvInfo,char *data,int length)

{
  int *piVar1;
  int iVar2;
  uint uVar3;
  size_t __n;
  long lVar4;
  char *pcVar5;
  long lVar6;
  int iVar7;
  byte bVar8;
  char szAscTlvLen [5];
  char szOldTlvLen [5];
  char sLine [4096];
  char szLastPart [4098];
  
  bVar8 = 0;
  szAscTlvLen[0] = '\0';
  szAscTlvLen[1] = '\0';
  szAscTlvLen[2] = '\0';
  szAscTlvLen[3] = '\0';
  szOldTlvLen[0] = '\0';
  szOldTlvLen[1] = '\0';
  szOldTlvLen[2] = '\0';
  szOldTlvLen[3] = '\0';
  pcVar5 = sLine;
  for (lVar4 = 0x200; lVar4 != 0; lVar4 = lVar4 + -1) {
    pcVar5[0] = '\0';
    pcVar5[1] = '\0';
    pcVar5[2] = '\0';
    pcVar5[3] = '\0';
    pcVar5[4] = '\0';
    pcVar5[5] = '\0';
    pcVar5[6] = '\0';
    pcVar5[7] = '\0';
    pcVar5 = pcVar5 + 8;
  }
  if (length != 0) {
    if (*data == '\0') {
      __n = strlen(data);
    }
    else {
      __n = strlen(data);
      if (__n == (long)length) {
        iVar2 = GetTlvAuthoIndice(tlv_name);
        if (iVar2 == -1) {
          return -1;
        }
        uVar3 = GetTlvAuthoType(iVar2);
        GetTlvAuthoLength(iVar2);
        sprintf(szAscTlvLen,"%.3d",(ulong)(uint)length);
        pcVar5 = szLastPart;
        for (lVar4 = 0x200; lVar4 != 0; lVar4 = lVar4 + -1) {
          pcVar5[0] = '\0';
          pcVar5[1] = '\0';
          pcVar5[2] = '\0';
          pcVar5[3] = '\0';
          pcVar5[4] = '\0';
          pcVar5[5] = '\0';
          pcVar5[6] = '\0';
          pcVar5[7] = '\0';
          pcVar5 = pcVar5 + (ulong)bVar8 * -0x10 + 8;
        }
        pcVar5[0] = '\0';
        pcVar5[1] = '\0';
        piVar1 = tlvInfo->nPresent + iVar2;
        if (*piVar1 == 0) {
          if (uVar3 < 2) {
                    // WARNING: Ignoring partial resolution of indirect
            szOldTlvLen._0_2_ = *(undefined2 *)(tlvInfo->sTlvData + (long)piVar1[999] + 3);
            lVar4 = strtol(szOldTlvLen,(char **)0x0,10);
            lVar6 = (long)piVar1[999];
            iVar7 = (int)lVar4;
            memcpy(szLastPart,tlvInfo->sTlvData + lVar6 + iVar7 + 6,
                   (long)(((tlvInfo->nLength - piVar1[999]) + -6) - iVar7));
            *(undefined2 *)(tlvInfo->sTlvData + lVar6 + 3) = szAscTlvLen._0_2_;
            tlvInfo->sTlvData[lVar6 + 5] = szAscTlvLen[2];
            memcpy(tlvInfo->sTlvData + (long)piVar1[999] + 6,data,__n);
            memcpy(tlvInfo->sTlvData + __n + (long)piVar1[999] + 6,szLastPart,
                   (long)(((tlvInfo->nLength - piVar1[999]) + -6) - iVar7));
            tlvInfo->nLength = tlvInfo->nLength + (length - iVar7);
            AdjustTlvAutho(tlvInfo,iVar2 + 1,length - iVar7);
            return 0;
          }
          return 0;
        }
        if (uVar3 < 2) {
          memcpy(tlvInfo->sTlvData + (long)tlvInfo->nLength + 6,data,__n);
        }
        iVar2 = tlvInfo->nLength;
        *(undefined2 *)(tlvInfo->sTlvData + iVar2) = *(undefined2 *)tlv_name;
        tlvInfo->sTlvData[(long)iVar2 + 2] = tlv_name[2];
        iVar2 = tlvInfo->nLength;
        *(undefined2 *)(tlvInfo->sTlvData + (long)iVar2 + 3) = szAscTlvLen._0_2_;
        tlvInfo->sTlvData[(long)iVar2 + 5] = szAscTlvLen[2];
        iVar2 = tlvInfo->nLength;
        *piVar1 = 0;
        piVar1[999] = iVar2;
        tlvInfo->nLength = iVar2 + 6 + length;
        return 0;
      }
    }
    sprintf(sLine,"End PutTlvAutho(ERROR)(Field-> %s,Length-> %d ,Data length-> %d )",tlv_name,
            (ulong)(uint)length,__n);
    trace_event(sLine,1);
  }
  return -1;
}



// WARNING: Unknown calling convention

int AuthoBuildTlv(char *buffer_snd,TSTlvAutho *tlvInfo)

{
  char sLLLL [5];
  
  sLLLL[0] = '\0';
  sLLLL[1] = '\0';
  sLLLL[2] = '\0';
  sLLLL[3] = '\0';
  sLLLL[4] = '\0';
  sprintf(sLLLL,"%04d",(ulong)(uint)tlvInfo->nLength);
  *(undefined4 *)buffer_snd = sLLLL._0_4_;
  memcpy(buffer_snd + 4,tlvInfo->sTlvData,(long)tlvInfo->nLength);
  buffer_snd[(long)tlvInfo->nLength + 4] = '\0';
  return tlvInfo->nLength + 4;
}



// WARNING: Unknown calling convention

int DelTlvBuffer(char *tlv_name,char *tlvbuffer)

{
  int iVar1;
  int iVar2;
  TSTlvAutho tlvInfo;
  
  InitTlvAutho(&tlvInfo);
  AnalyseTlvAutho(tlvbuffer,&tlvInfo);
  iVar1 = DelTlvAutho(tlv_name,&tlvInfo);
  iVar2 = -1;
  if (iVar1 == 0) {
    AuthoBuildTlv(tlvbuffer,&tlvInfo);
    iVar2 = 0;
  }
  return iVar2;
}



// WARNING: Unknown calling convention

int PutTlvBuffer(char *tlv_name,char *tlvbuffer,char *data,int length)

{
  int iVar1;
  long lVar2;
  int iVar3;
  char *pcVar4;
  char sLine [512];
  TSTlvAutho tlvInfo;
  
  pcVar4 = sLine;
  for (lVar2 = 0x40; lVar2 != 0; lVar2 = lVar2 + -1) {
    *(undefined8 *)pcVar4 = 0;
    pcVar4 = (char *)((long)pcVar4 + 8);
  }
  sprintf(sLine,"TAG : %s Length = %d, .%.4s",tlv_name,(ulong)(uint)length,tlvbuffer);
  trace_event(sLine,1);
  InitTlvAutho(&tlvInfo);
  AnalyseTlvAutho(tlvbuffer,&tlvInfo);
  iVar1 = PutTlvAutho(tlv_name,&tlvInfo,data,length);
  iVar3 = -1;
  if (iVar1 == 0) {
    AuthoBuildTlv(tlvbuffer,&tlvInfo);
    iVar3 = 0;
  }
  return iVar3;
}



// WARNING: Unknown calling convention

int GetTlvBuffer(char *tlv_name,char *tlvbuffer,char *data,int *length)

{
  int iVar1;
  size_t sVar2;
  TSTlvAutho tlvInfo;
  
  InitTlvAutho(&tlvInfo);
  sVar2 = strlen(tlvbuffer);
  if (sVar2 < 4) {
    trace_event("PutTlvBuffer ECHEC LENGTH ",5);
    iVar1 = -1;
  }
  else {
    AnalyseTlvAutho(tlvbuffer,&tlvInfo);
    iVar1 = GetTlvAutho(tlv_name,&tlvInfo,data,length);
  }
  return iVar1;
}



// WARNING: Unknown calling convention

int PrintTlvBuffer(char *sTlvBuffer)

{
  int iVar1;
  char *pcVar2;
  char *pcVar3;
  char *pcVar4;
  char *pcVar5;
  int iVar6;
  __pid_t _Var7;
  __pid_t _Var8;
  int iVar9;
  int iVar10;
  uint uVar11;
  uint uVar12;
  uint uVar13;
  long lVar14;
  uint *puVar15;
  uint *puVar16;
  uint *puVar17;
  char *pcVar18;
  char **ppcVar19;
  int iVar20;
  char *pcVar21;
  bool bVar22;
  byte bVar23;
  undefined4 uVar25;
  undefined8 uVar24;
  int length;
  char Mls [4];
  char szAscTlvLen [4];
  char Mls_tmp [7];
  char date [15];
  timeval tp;
  char CardTrunc [23];
  char data [4096];
  char sLine [4096];
  char sLine2 [4096];
  TSTlvPrivate TlvPrivateInfo;
  TSTlvAutho sTlvInfo;
  
  bVar23 = 0;
  CardTrunc[0] = '\0';
  CardTrunc[1] = '\0';
  CardTrunc[2] = '\0';
  CardTrunc[3] = '\0';
  CardTrunc[4] = '\0';
  CardTrunc[5] = '\0';
  CardTrunc[6] = '\0';
  CardTrunc[7] = '\0';
  CardTrunc[8] = '\0';
  CardTrunc[9] = '\0';
  CardTrunc[10] = '\0';
  CardTrunc[0xb] = '\0';
  CardTrunc[0xc] = '\0';
  CardTrunc[0xd] = '\0';
  CardTrunc[0xe] = '\0';
  CardTrunc[0xf] = '\0';
  CardTrunc[0x10] = '\0';
  CardTrunc[0x11] = '\0';
  CardTrunc[0x12] = '\0';
  CardTrunc[0x13] = '\0';
  CardTrunc[0x14] = '\0';
  CardTrunc[0x15] = '\0';
  CardTrunc[0x16] = '\0';
  pcVar18 = sLine2;
  for (lVar14 = 0x200; lVar14 != 0; lVar14 = lVar14 + -1) {
    pcVar18[0] = '\0';
    pcVar18[1] = '\0';
    pcVar18[2] = '\0';
    pcVar18[3] = '\0';
    pcVar18[4] = '\0';
    pcVar18[5] = '\0';
    pcVar18[6] = '\0';
    pcVar18[7] = '\0';
    pcVar18 = pcVar18 + 8;
  }
  date[0] = '\0';
  date[1] = '\0';
  date[2] = '\0';
  date[3] = '\0';
  date[4] = '\0';
  date[5] = '\0';
  date[6] = '\0';
  date[7] = '\0';
  date[8] = '\0';
  date[9] = '\0';
  date[10] = '\0';
  date[0xb] = '\0';
  date[0xc] = '\0';
  date[0xd] = '\0';
  date[0xe] = '\0';
  Mls[0] = '\0';
  Mls[1] = '\0';
  Mls[2] = '\0';
  Mls[3] = '\0';
  Mls_tmp[0] = '\0';
  Mls_tmp[1] = '\0';
  Mls_tmp[2] = '\0';
  Mls_tmp[3] = '\0';
  Mls_tmp[4] = '\0';
  Mls_tmp[5] = '\0';
  Mls_tmp[6] = '\0';
  if (trace_level < 5) {
    return 0;
  }
  trace_event("Start PrintTlvBuffer ()",5);
  current_date(date);
  current_hour(date + 8);
  gettimeofday((timeval *)&tp,(__timezone_ptr_t)0x0);
  sprintf(Mls_tmp,"%06d",tp.tv_usec);
  Mls._0_3_ = (undefined3)Mls_tmp._0_4_;
  InitTlvAutho(&sTlvInfo);
  AnalyseTlvAutho(sTlvBuffer,&sTlvInfo);
  iVar9 = trace_level;
  pcVar18 = data;
  for (lVar14 = 0x200; lVar14 != 0; lVar14 = lVar14 + -1) {
    pcVar18[0] = '\0';
    pcVar18[1] = '\0';
    pcVar18[2] = '\0';
    pcVar18[3] = '\0';
    pcVar18[4] = '\0';
    pcVar18[5] = '\0';
    pcVar18[6] = '\0';
    pcVar18[7] = '\0';
    pcVar18 = pcVar18 + (ulong)bVar23 * -0x10 + 8;
  }
  puVar16 = (uint *)sLine;
  for (lVar14 = 0x200; lVar14 != 0; lVar14 = lVar14 + -1) {
    puVar16[0] = 0;
    puVar16[1] = 0;
    puVar16 = puVar16 + (ulong)bVar23 * -4 + 2;
  }
  lVar14 = syscall(0xba);
  _Var7 = getpid();
  _Var8 = getppid();
  puVar16 = (uint *)(sLine + 0x84);
  sprintf(sLine,
          "%.2s%.2s %.2s%.2s%.2s%.3s %05d %08d %.05ld|%d| -----------------------------------------"
          ,date,date + 2,date + 8,date + 10,date + 0xc,Mls,_Var8,_Var7,(long)(int)lVar14,iVar9);
  puVar17 = (uint *)sLine;
  do {
    while (iVar9 = isprint((int)(char)*puVar17), iVar9 == 0) {
      *(char *)puVar17 = ' ';
      puVar17 = (uint *)((long)puVar17 + 1);
      sLine[0x82] = '.';
      if (puVar17 == puVar16) goto LAB_004899fc;
    }
    puVar17 = (uint *)((long)puVar17 + 1);
  } while (puVar17 != puVar16);
LAB_004899fc:
  sLine[0x83] = '\n';
  write(fd_trace,sLine,0x84);
  iVar9 = trace_level;
  puVar17 = (uint *)sLine;
  for (lVar14 = 0x200; lVar14 != 0; lVar14 = lVar14 + -1) {
    puVar17[0] = 0;
    puVar17[1] = 0;
    puVar17 = puVar17 + (ulong)bVar23 * -4 + 2;
  }
  lVar14 = syscall(0xba);
  _Var7 = getpid();
  _Var8 = getppid();
  sprintf(sLine,"%.2s%.2s %.2s%.2s%.2s%.3s %05d %08d %05d|%d| %.3s\t %25s \t%s\t%s",date,date + 2,
          date + 8,date + 10,date + 0xc,Mls,_Var8,_Var7,(long)(int)lVar14,iVar9,&DAT_004d4054,
          &DAT_004d404f,&DAT_004d404b,"VALUE");
  puVar17 = (uint *)sLine;
  do {
    while (iVar9 = isprint((int)(char)*puVar17), iVar9 == 0) {
      *(char *)puVar17 = ' ';
      puVar17 = (uint *)((long)puVar17 + 1);
      sLine[0x82] = '.';
      if (puVar17 == puVar16) goto LAB_00489b04;
    }
    puVar17 = (uint *)((long)puVar17 + 1);
  } while (puVar17 != puVar16);
LAB_00489b04:
  sLine[0x83] = '\n';
  write(fd_trace,sLine,0x84);
  iVar9 = trace_level;
  puVar17 = (uint *)sLine;
  for (lVar14 = 0x200; lVar14 != 0; lVar14 = lVar14 + -1) {
    puVar17[0] = 0;
    puVar17[1] = 0;
    puVar17 = puVar17 + (ulong)bVar23 * -4 + 2;
  }
  lVar14 = syscall(0xba);
  _Var7 = getpid();
  _Var8 = getppid();
  uVar24 = 0;
  sprintf(sLine,"%.2s%.2s %.2s%.2s%.2s%.3s %05d %08d %05d|%d| %.3s\t-%25s-\t%s\t%s",date,date + 2,
          date + 8,date + 10,date + 0xc,Mls,_Var8,_Var7,(long)(int)lVar14,iVar9,"---","-----","---",
          "-----");
  puVar17 = (uint *)sLine;
  do {
    while (iVar9 = isprint((int)(char)*puVar17), iVar9 == 0) {
      *(char *)puVar17 = ' ';
      puVar17 = (uint *)((long)puVar17 + 1);
      sLine[0x82] = '.';
      if (puVar17 == puVar16) goto LAB_00489c0c;
    }
    puVar17 = (uint *)((long)puVar17 + 1);
  } while (puVar17 != puVar16);
LAB_00489c0c:
  sLine[0x83] = '\n';
  iVar9 = 1;
  write(fd_trace,sLine,0x84);
  ppcVar19 = &sTlvPrint[0].value;
  do {
    puVar17 = (uint *)sLine;
    for (lVar14 = 0x200; lVar14 != 0; lVar14 = lVar14 + -1) {
      puVar17[0] = 0;
      puVar17[1] = 0;
      puVar17 = puVar17 + (ulong)bVar23 * -4 + 2;
    }
    iVar20 = iVar9 + -1;
    pcVar18 = data;
    for (lVar14 = 0x200; lVar14 != 0; lVar14 = lVar14 + -1) {
      pcVar18[0] = '\0';
      pcVar18[1] = '\0';
      pcVar18[2] = '\0';
      pcVar18[3] = '\0';
      pcVar18[4] = '\0';
      pcVar18[5] = '\0';
      pcVar18[6] = '\0';
      pcVar18[7] = '\0';
      pcVar18 = pcVar18 + (ulong)bVar23 * -0x10 + 8;
    }
    iVar10 = GetTlvAutho(*ppcVar19,&sTlvInfo,data,&length);
    iVar6 = length;
    iVar1 = trace_level;
    pcVar5 = sTlvPrint[0x32].value;
    pcVar4 = sTlvPrint[0x32].description;
    pcVar3 = sTlvPrint[0x2b].value;
    pcVar2 = sTlvPrint[0x2b].description;
    pcVar21 = sTlvPrint[0].value;
    pcVar18 = sTlvPrint[0].description;
    uVar25 = (undefined4)((ulong)uVar24 >> 0x20);
    if (iVar10 == 0) {
      if (iVar20 == 0x32) {
        puVar17 = (uint *)sLine;
        for (lVar14 = 0x200; lVar14 != 0; lVar14 = lVar14 + -1) {
          puVar17[0] = 0;
          puVar17[1] = 0;
          puVar17 = puVar17 + (ulong)bVar23 * -4 + 2;
        }
        if (debug_option == 1) {
          lVar14 = syscall(0xba);
          _Var7 = getpid();
          _Var8 = getppid();
          uVar24 = CONCAT44(uVar25,iVar6);
          sprintf(sLine,"%.2s%.2s %.2s%.2s%.2s%.3s %05d %08d %05d|%d| %.3s\t{%25s}\t%03d\t%s",date,
                  date + 2,date + 8,date + 10,date + 0xc,Mls,_Var8,_Var7,(long)(int)lVar14,iVar1,
                  pcVar5,pcVar4,uVar24,data);
          puVar17 = (uint *)sLine;
          do {
            iVar20 = isprint((int)(char)*puVar17);
            if (iVar20 == 0) {
              *(char *)puVar17 = ' ';
              sLine[0x82] = '.';
            }
            puVar17 = (uint *)((long)puVar17 + 1);
          } while (puVar17 != puVar16);
        }
        else {
          lVar14 = syscall(0xba);
          _Var7 = getpid();
          _Var8 = getppid();
          uVar24 = CONCAT44(uVar25,iVar6);
          sprintf(sLine,"%.2s%.2s %.2s%.2s%.2s%.3s %05d %08d %05d|%d| %.3s\t{%25s}\t%03d\t%s",date,
                  date + 2,date + 8,date + 10,date + 0xc,Mls,_Var8,_Var7,(long)(int)lVar14,iVar1,
                  pcVar5,pcVar4,uVar24,"************************");
          puVar17 = (uint *)sLine;
          do {
            iVar20 = isprint((int)(char)*puVar17);
            if (iVar20 == 0) {
              *(char *)puVar17 = ' ';
              sLine[0x82] = '.';
            }
            puVar17 = (uint *)((long)puVar17 + 1);
          } while (puVar17 != puVar16);
        }
        goto LAB_0048a2b0;
      }
      if (0x32 < iVar20) {
        if (iVar20 != 100) {
          if (iVar20 < 0x65) {
            if (iVar20 == 0x35) goto LAB_0048a54b;
          }
          else if ((iVar20 == 0x6f) || (iVar20 == 0xef)) goto LAB_0048a54b;
LAB_00489ef7:
          puVar17 = (uint *)sLine;
          for (lVar14 = 0x200; lVar14 != 0; lVar14 = lVar14 + -1) {
            puVar17[0] = 0;
            puVar17[1] = 0;
            puVar17 = puVar17 + (ulong)bVar23 * -4 + 2;
          }
          pcVar18 = ((t_tlv_print *)(ppcVar19 + -1))->description;
          pcVar21 = *ppcVar19;
          lVar14 = syscall(0xba);
          _Var7 = getpid();
          _Var8 = getppid();
          uVar24 = CONCAT44(uVar25,iVar6);
          sprintf(sLine,"%.2s%.2s %.2s%.2s%.2s%.3s %05d %08d %05d|%d| %.3s\t{%25s}\t%03d\t%s",date,
                  date + 2,date + 8,date + 10,date + 0xc,Mls,_Var8,_Var7,(long)(int)lVar14,iVar1,
                  pcVar21,pcVar18,uVar24,data);
          puVar17 = (uint *)sLine;
          do {
            puVar15 = puVar17;
            uVar12 = *puVar15 + 0xfefefeff & ~*puVar15;
            uVar11 = uVar12 & 0x80808080;
            puVar17 = puVar15 + 1;
          } while (uVar11 == 0);
          bVar22 = (uVar12 & 0x8080) == 0;
          if (bVar22) {
            uVar11 = uVar11 >> 0x10;
          }
          if (bVar22) {
            puVar17 = (uint *)((long)puVar15 + 6);
          }
          *(char *)((long)puVar17 + (-3 - (ulong)CARRY1((byte)uVar11,(byte)uVar11))) = '\n';
          puVar17 = (uint *)sLine;
          do {
            puVar15 = puVar17;
            uVar12 = *puVar15 + 0xfefefeff & ~*puVar15;
            uVar11 = uVar12 & 0x80808080;
            puVar17 = puVar15 + 1;
          } while (uVar11 == 0);
          bVar22 = (uVar12 & 0x8080) == 0;
          if (bVar22) {
            uVar11 = uVar11 >> 0x10;
          }
          if (bVar22) {
            puVar17 = (uint *)((long)puVar15 + 6);
          }
          write(fd_trace,sLine,
                (size_t)((long)puVar17 +
                        ((-3 - (ulong)CARRY1((byte)uVar11,(byte)uVar11)) - (long)sLine)));
          iVar1 = trace_level;
          goto joined_r0x0048a067;
        }
LAB_0048a54b:
        pcVar18 = ((t_tlv_print *)(ppcVar19 + -1))->description;
        pcVar21 = *ppcVar19;
        puVar17 = (uint *)sLine;
        for (lVar14 = 0x200; lVar14 != 0; lVar14 = lVar14 + -1) {
          puVar17[0] = 0;
          puVar17[1] = 0;
          puVar17 = puVar17 + (ulong)bVar23 * -4 + 2;
        }
        if (debug_option == 1) {
          lVar14 = syscall(0xba);
          _Var7 = getpid();
          _Var8 = getppid();
          uVar24 = CONCAT44(uVar25,iVar6);
          sprintf(sLine,"%.2s%.2s %.2s%.2s%.2s%.3s %05d %08d %05d|%d| %.3s\t{%25s}\t%03d\t%s",date,
                  date + 2,date + 8,date + 10,date + 0xc,Mls,_Var8,_Var7,(long)(int)lVar14,iVar1,
                  pcVar21,pcVar18,uVar24,data);
          puVar17 = (uint *)sLine;
          do {
            iVar20 = isprint((int)(char)*puVar17);
            if (iVar20 == 0) {
              *(char *)puVar17 = ' ';
              sLine[0x82] = '.';
            }
            puVar17 = (uint *)((long)puVar17 + 1);
          } while (puVar17 != puVar16);
        }
        else {
          lVar14 = syscall(0xba);
          _Var7 = getpid();
          _Var8 = getppid();
          uVar24 = CONCAT44(uVar25,iVar6);
          sprintf(sLine,"%.2s%.2s %.2s%.2s%.2s%.3s %05d %08d %05d|%d| %.3s\t{%25s}\t%03d\t%s",date,
                  date + 2,date + 8,date + 10,date + 0xc,Mls,_Var8,_Var7,(long)(int)lVar14,iVar1,
                  pcVar21,pcVar18,uVar24,"************************");
          puVar17 = (uint *)sLine;
          do {
            while (iVar20 = isprint((int)(char)*puVar17), iVar20 == 0) {
              *(char *)puVar17 = ' ';
              puVar17 = (uint *)((long)puVar17 + 1);
              sLine[0x82] = '.';
              if (puVar17 == puVar16) goto LAB_0048a67c;
            }
            puVar17 = (uint *)((long)puVar17 + 1);
          } while (puVar17 != puVar16);
        }
LAB_0048a67c:
        sLine[0x83] = '\n';
        write(fd_trace,sLine,0x84);
        iVar1 = trace_level;
        goto joined_r0x0048a067;
      }
      if (iVar20 == 0x21) goto LAB_0048a54b;
      if (iVar20 < 0x22) {
        if (iVar9 != 1) goto LAB_00489ef7;
        puVar17 = (uint *)sLine;
        for (lVar14 = 0x200; lVar14 != 0; lVar14 = lVar14 + -1) {
          puVar17[0] = 0;
          puVar17[1] = 0;
          puVar17 = puVar17 + (ulong)bVar23 * -4 + 2;
        }
        if (debug_option == 1) {
          lVar14 = syscall(0xba);
          _Var7 = getpid();
          _Var8 = getppid();
          uVar24 = CONCAT44(uVar25,iVar6);
          sprintf(sLine,"%.2s%.2s %.2s%.2s%.2s%.3s %05d %08d %05d|%d| %.3s\t{%25s}\t%03d\t%s",date,
                  date + 2,date + 8,date + 10,date + 0xc,Mls,_Var8,_Var7,(long)(int)lVar14,iVar1,
                  pcVar21,pcVar18,uVar24,data);
          puVar17 = (uint *)sLine;
          do {
            iVar20 = isprint((int)(char)*puVar17);
            if (iVar20 == 0) {
              *(char *)puVar17 = ' ';
              sLine[0x82] = '.';
            }
            puVar17 = (uint *)((long)puVar17 + 1);
          } while (puVar17 != puVar16);
        }
        else {
          TrunCard(data,CardTrunc);
          iVar1 = length;
          iVar20 = trace_level;
          pcVar21 = sTlvPrint[0].value;
          pcVar18 = sTlvPrint[0].description;
          lVar14 = syscall(0xba);
          _Var7 = getpid();
          _Var8 = getppid();
          uVar24 = CONCAT44(uVar25,iVar1);
          sprintf(sLine,"%.2s%.2s %.2s%.2s%.2s%.3s %05d %08d %05d|%d| %.3s\t{%25s}\t%03d\t%s",date,
                  date + 2,date + 8,date + 10,date + 0xc,Mls,_Var8,_Var7,(long)(int)lVar14,iVar20,
                  pcVar21,pcVar18,uVar24,CardTrunc);
          puVar17 = (uint *)sLine;
          do {
            while (iVar20 = isprint((int)(char)*puVar17), iVar20 == 0) {
              *(char *)puVar17 = ' ';
              puVar17 = (uint *)((long)puVar17 + 1);
              sLine[0x82] = '.';
              if (puVar16 == puVar17) goto LAB_0048a2b0;
            }
            puVar17 = (uint *)((long)puVar17 + 1);
          } while (puVar16 != puVar17);
        }
LAB_0048a2b0:
        sLine[0x83] = '\n';
        write(fd_trace,sLine,0x84);
      }
      else {
        if (iVar20 == 0x2b) {
          puVar17 = (uint *)sLine;
          for (lVar14 = 0x200; lVar14 != 0; lVar14 = lVar14 + -1) {
            puVar17[0] = 0;
            puVar17[1] = 0;
            puVar17 = puVar17 + (ulong)bVar23 * -4 + 2;
          }
          if (debug_option == 1) {
            lVar14 = syscall(0xba);
            _Var7 = getpid();
            _Var8 = getppid();
            uVar24 = CONCAT44(uVar25,iVar6);
            sprintf(sLine,"%.2s%.2s %.2s%.2s%.2s%.3s %05d %08d %05d|%d| %.3s\t{%25s}\t%03d\t%s",date
                    ,date + 2,date + 8,date + 10,date + 0xc,Mls,_Var8,_Var7,(long)(int)lVar14,iVar1,
                    pcVar3,pcVar2,uVar24,data);
            puVar17 = (uint *)sLine;
            do {
              iVar20 = isprint((int)(char)*puVar17);
              if (iVar20 == 0) {
                *(char *)puVar17 = ' ';
                sLine[0x82] = '.';
              }
              puVar17 = (uint *)((long)puVar17 + 1);
            } while (puVar17 != puVar16);
          }
          else {
            lVar14 = syscall(0xba);
            _Var7 = getpid();
            _Var8 = getppid();
            uVar24 = CONCAT44(uVar25,iVar6);
            sprintf(sLine,"%.2s%.2s %.2s%.2s%.2s%.3s %05d %08d %05d|%d| %.3s\t{%25s}\t%03d\t%s",date
                    ,date + 2,date + 8,date + 10,date + 0xc,Mls,_Var8,_Var7,(long)(int)lVar14,iVar1,
                    pcVar3,pcVar2,uVar24,"************************");
            puVar17 = (uint *)sLine;
            do {
              iVar20 = isprint((int)(char)*puVar17);
              if (iVar20 == 0) {
                *(char *)puVar17 = ' ';
                sLine[0x82] = '.';
              }
              puVar17 = (uint *)((long)puVar17 + 1);
            } while (puVar17 != puVar16);
          }
          goto LAB_0048a2b0;
        }
        if (iVar20 != 0x2e) goto LAB_00489ef7;
        puVar17 = (uint *)sLine;
        for (lVar14 = 0x200; lVar14 != 0; lVar14 = lVar14 + -1) {
          puVar17[0] = 0;
          puVar17[1] = 0;
          puVar17 = puVar17 + (ulong)bVar23 * -4 + 2;
        }
        pcVar18 = sLine2;
        for (lVar14 = 0x200; lVar14 != 0; lVar14 = lVar14 + -1) {
          pcVar18[0] = '\0';
          pcVar18[1] = '\0';
          pcVar18[2] = '\0';
          pcVar18[3] = '\0';
          pcVar18[4] = '\0';
          pcVar18[5] = '\0';
          pcVar18[6] = '\0';
          pcVar18[7] = '\0';
          pcVar18 = pcVar18 + (ulong)bVar23 * -0x10 + 8;
        }
        AnalyseTlvPrivate(data,length,&TlvPrivateInfo);
        iVar1 = length;
        iVar20 = trace_level;
        pcVar21 = sTlvPrint[0x2e].value;
        pcVar18 = sTlvPrint[0x2e].description;
        uVar25 = (undefined4)((ulong)uVar24 >> 0x20);
        szAscTlvLen[0] = '\0';
        szAscTlvLen[1] = '\0';
        szAscTlvLen[2] = '\0';
        szAscTlvLen[3] = '\0';
        if (debug_option == 1) {
          puVar17 = (uint *)sLine;
          for (lVar14 = 0x200; lVar14 != 0; lVar14 = lVar14 + -1) {
            puVar17[0] = 0;
            puVar17[1] = 0;
            puVar17 = puVar17 + (ulong)bVar23 * -4 + 2;
          }
          lVar14 = syscall(0xba);
          _Var7 = getpid();
          _Var8 = getppid();
          uVar24 = CONCAT44(uVar25,iVar1);
          sprintf(sLine,"%.2s%.2s %.2s%.2s%.2s%.3s %05d %08d %05d|%d| %.3s\t{%25s}\t%03d\t%s",date,
                  date + 2,date + 8,date + 10,date + 0xc,Mls,_Var8,_Var7,(long)(int)lVar14,iVar20,
                  pcVar21,pcVar18,uVar24,TlvPrivateInfo.sTlvData);
          puVar17 = (uint *)sLine;
        }
        else {
          iVar20 = GetTlvPrivateIndice("P10");
          if (TlvPrivateInfo.nPresent[iVar20] == 0) {
            szAscTlvLen[2] = TlvPrivateInfo.sTlvData[(long)TlvPrivateInfo.nPosTlv[iVar20] + 5];
            szAscTlvLen._0_2_ =
                 *(undefined2 *)(TlvPrivateInfo.sTlvData + (long)TlvPrivateInfo.nPosTlv[iVar20] + 3)
            ;
            lVar14 = strtol(szAscTlvLen,(char **)0x0,10);
            memset(TlvPrivateInfo.sTlvData + (long)TlvPrivateInfo.nPosTlv[iVar20] + 6,0x2a,
                   (long)(int)lVar14);
          }
          iVar20 = GetTlvPrivateIndice("CL3");
          puVar17 = (uint *)sLine;
          if (TlvPrivateInfo.nPresent[iVar20] == 0) {
            szAscTlvLen[2] = TlvPrivateInfo.sTlvData[(long)TlvPrivateInfo.nPosTlv[iVar20] + 5];
            szAscTlvLen._0_2_ =
                 *(undefined2 *)(TlvPrivateInfo.sTlvData + (long)TlvPrivateInfo.nPosTlv[iVar20] + 3)
            ;
            lVar14 = strtol(szAscTlvLen,(char **)0x0,10);
            memset(TlvPrivateInfo.sTlvData + (long)TlvPrivateInfo.nPosTlv[iVar20] + 6,0x2a,
                   (long)(int)lVar14);
          }
        }
        do {
          puVar15 = puVar17;
          uVar11 = *puVar15 + 0xfefefeff & ~*puVar15;
          uVar12 = uVar11 & 0x80808080;
          puVar17 = puVar15 + 1;
        } while (uVar12 == 0);
        puVar17 = (uint *)((long)puVar15 + 6);
        uVar13 = uVar12 >> 0x10;
        if ((uVar11 & 0x8080) != 0) {
          puVar17 = puVar15 + 1;
          uVar13 = uVar12;
        }
        pcVar18 = (char *)((long)puVar17 +
                          ((-3 - (ulong)CARRY1((byte)uVar13,(byte)uVar13)) - (long)sLine));
        for (pcVar21 = (char *)0x0; iVar20 = trace_level, pcVar21 < pcVar18; pcVar21 = pcVar21 + 1)
        {
          iVar20 = isprint((int)*(char *)((long)sLine + (long)pcVar21));
          if (iVar20 == 0) {
            *(char *)((long)sLine + (long)pcVar21) = ' ';
            puVar17 = (uint *)sLine;
            do {
              puVar15 = puVar17;
              uVar11 = *puVar15 + 0xfefefeff & ~*puVar15;
              uVar12 = uVar11 & 0x80808080;
              puVar17 = puVar15 + 1;
            } while (uVar12 == 0);
            puVar17 = (uint *)((long)puVar15 + 6);
            uVar13 = uVar12 >> 0x10;
            if ((uVar11 & 0x8080) != 0) {
              puVar17 = puVar15 + 1;
              uVar13 = uVar12;
            }
            pcVar18 = (char *)((long)puVar17 +
                              ((-3 - (ulong)CARRY1((byte)uVar13,(byte)uVar13)) - (long)sLine));
          }
        }
        if ((char *)0x82 < pcVar18) {
          lVar14 = 0x10;
          pcVar18 = sLine2;
          while (lVar14 != 0) {
            lVar14 = lVar14 + -1;
            builtin_strncpy(pcVar18,"        ",8);
            pcVar18 = pcVar18 + (ulong)bVar23 * -0x10 + 8;
          }
          builtin_strncpy(pcVar18,"    ",4);
          lVar14 = syscall(0xba);
          _Var7 = getpid();
          _Var8 = getppid();
          sprintf(sLine2,"%.2s%.2s %.2s%.2s%.2s%.3s %05d %08d %05d|%d| ",date,date + 2,date + 8,
                  date + 10,date + 0xc,Mls,_Var8,_Var7,(long)(int)lVar14,iVar20);
          puVar17 = (uint *)sLine;
          do {
            puVar15 = puVar17;
            uVar12 = *puVar15 + 0xfefefeff & ~*puVar15;
            uVar11 = uVar12 & 0x80808080;
            puVar17 = puVar15 + 1;
          } while (uVar11 == 0);
          bVar22 = (uVar12 & 0x8080) == 0;
          if (bVar22) {
            uVar11 = uVar11 >> 0x10;
          }
          if (bVar22) {
            puVar17 = (uint *)((long)puVar15 + 6);
          }
          memcpy(sLine2 + 0x2c,sLine + 0x82,
                 (size_t)((long)puVar17 +
                         (-(long)sLine - (ulong)CARRY1((byte)uVar11,(byte)uVar11)) + -0x85));
          sLine2[0x82] = '.';
          sLine2[0x83] = '\n';
        }
        sLine[0x82] = '.';
        sLine[0x83] = '\n';
        write(fd_trace,sLine,0x84);
        puVar17 = (uint *)sLine;
        do {
          puVar15 = puVar17;
          uVar12 = *puVar15 + 0xfefefeff & ~*puVar15;
          uVar11 = uVar12 & 0x80808080;
          puVar17 = puVar15 + 1;
        } while (uVar11 == 0);
        bVar22 = (uVar12 & 0x8080) == 0;
        if (bVar22) {
          uVar11 = uVar11 >> 0x10;
        }
        if (bVar22) {
          puVar17 = (uint *)((long)puVar15 + 6);
        }
        if (((char *)0x81 <
             (char *)((long)puVar17 +
                     ((-3 - (ulong)CARRY1((byte)uVar11,(byte)uVar11)) - (long)sLine))) &&
           (sLine2[0] != '\0')) {
          write(fd_trace,sLine2,0x84);
        }
      }
    }
    else {
joined_r0x0048a067:
      trace_level = iVar1;
      if (iVar9 == 0x10b) break;
    }
    ppcVar19 = ppcVar19 + 2;
    iVar9 = iVar9 + 1;
  } while( true );
  puVar17 = (uint *)sLine;
  for (lVar14 = 0x200; lVar14 != 0; lVar14 = lVar14 + -1) {
    puVar17[0] = 0;
    puVar17[1] = 0;
    puVar17 = puVar17 + (ulong)bVar23 * -4 + 2;
  }
  lVar14 = syscall(0xba);
  _Var7 = getpid();
  _Var8 = getppid();
  sprintf(sLine,
          "%.2s%.2s %.2s%.2s%.2s%.3s %05d %08d %05d|%d| -----------------------------------------\n"
          ,date,date + 2,date + 8,date + 10,date + 0xc,Mls,_Var8,_Var7,(long)(int)lVar14,iVar1);
  puVar17 = (uint *)sLine;
  do {
    while (iVar9 = isprint((int)(char)*puVar17), iVar9 == 0) {
      *(char *)puVar17 = ' ';
      puVar17 = (uint *)((long)puVar17 + 1);
      sLine[0x82] = '.';
      if (puVar17 == puVar16) goto LAB_0048a124;
    }
    puVar17 = (uint *)((long)puVar17 + 1);
  } while (puVar17 != puVar16);
LAB_0048a124:
  sLine[0x83] = '\n';
  write(fd_trace,sLine,0x84);
  trace_event("End   PrintTlvBuffer ()",5);
  return 0;
}



int SHA224_Init(SHA256_CTX *c)

{
  ulong uVar1;
  int iVar2;
  uint uVar3;
  SHA256_CTX *pSVar5;
  SHA256_CTX *pSVar6;
  bool bVar7;
  ulong uVar4;
  
  uVar4 = 0x70;
  iVar2 = 0x70;
  bVar7 = ((ulong)c & 1) != 0;
  if (bVar7) {
    pSVar5 = (SHA256_CTX *)((long)c->h + 1);
    *(undefined1 *)c->h = 0;
    uVar4 = 0x6f;
    iVar2 = 0x6f;
    uVar1 = (ulong)pSVar5 & 2;
  }
  else {
    uVar1 = (ulong)c & 2;
    pSVar5 = c;
  }
  if (uVar1 == 0) {
    uVar3 = (uint)uVar4;
  }
  else {
    uVar3 = iVar2 - 2;
    uVar4 = (ulong)uVar3;
    *(undefined2 *)pSVar5->h = 0;
    pSVar5 = (SHA256_CTX *)((long)pSVar5->h + 2);
  }
  if (((ulong)pSVar5 & 4) != 0) {
    pSVar5->h[0] = 0;
    uVar4 = (ulong)(uVar3 - 4);
    pSVar5 = (SHA256_CTX *)(pSVar5->h + 1);
  }
  for (uVar1 = uVar4 >> 3; uVar1 != 0; uVar1 = uVar1 - 1) {
    pSVar5->h[0] = 0;
    pSVar5->h[1] = 0;
    pSVar5 = (SHA256_CTX *)(pSVar5->h + 2);
  }
  if ((uVar4 & 4) != 0) {
    pSVar5->h[0] = 0;
    pSVar5 = (SHA256_CTX *)(pSVar5->h + 1);
  }
  pSVar6 = pSVar5;
  if ((uVar4 & 2) != 0) {
    pSVar6 = (SHA256_CTX *)((long)pSVar5->h + 2);
    *(undefined2 *)pSVar5->h = 0;
  }
  if (bVar7) {
    *(undefined1 *)pSVar6->h = 0;
  }
  c->h[0] = 0xc1059ed8;
  c->h[1] = 0x367cd507;
  c->h[2] = 0x3070dd17;
  c->h[3] = 0xf70e5939;
  c->h[4] = 0xffc00b31;
  c->h[5] = 0x68581511;
  c->h[6] = 0x64f98fa7;
  c->h[7] = 0xbefa4fa4;
  c->md_len = 0x1c;
  return 1;
}



int SHA256_Init(SHA256_CTX *c)

{
  ulong uVar1;
  int iVar2;
  uint uVar3;
  SHA256_CTX *pSVar5;
  SHA256_CTX *pSVar6;
  bool bVar7;
  ulong uVar4;
  
  uVar4 = 0x70;
  iVar2 = 0x70;
  bVar7 = ((ulong)c & 1) != 0;
  if (bVar7) {
    pSVar5 = (SHA256_CTX *)((long)c->h + 1);
    *(undefined1 *)c->h = 0;
    uVar4 = 0x6f;
    iVar2 = 0x6f;
    uVar1 = (ulong)pSVar5 & 2;
  }
  else {
    uVar1 = (ulong)c & 2;
    pSVar5 = c;
  }
  if (uVar1 == 0) {
    uVar3 = (uint)uVar4;
  }
  else {
    uVar3 = iVar2 - 2;
    uVar4 = (ulong)uVar3;
    *(undefined2 *)pSVar5->h = 0;
    pSVar5 = (SHA256_CTX *)((long)pSVar5->h + 2);
  }
  if (((ulong)pSVar5 & 4) != 0) {
    pSVar5->h[0] = 0;
    uVar4 = (ulong)(uVar3 - 4);
    pSVar5 = (SHA256_CTX *)(pSVar5->h + 1);
  }
  for (uVar1 = uVar4 >> 3; uVar1 != 0; uVar1 = uVar1 - 1) {
    pSVar5->h[0] = 0;
    pSVar5->h[1] = 0;
    pSVar5 = (SHA256_CTX *)(pSVar5->h + 2);
  }
  if ((uVar4 & 4) != 0) {
    pSVar5->h[0] = 0;
    pSVar5 = (SHA256_CTX *)(pSVar5->h + 1);
  }
  pSVar6 = pSVar5;
  if ((uVar4 & 2) != 0) {
    pSVar6 = (SHA256_CTX *)((long)pSVar5->h + 2);
    *(undefined2 *)pSVar5->h = 0;
  }
  if (bVar7) {
    *(undefined1 *)pSVar6->h = 0;
  }
  c->h[0] = 0x6a09e667;
  c->h[1] = 0xbb67ae85;
  c->h[2] = 0x3c6ef372;
  c->h[3] = 0xa54ff53a;
  c->h[4] = 0x510e527f;
  c->h[5] = 0x9b05688c;
  c->h[6] = 0x1f83d9ab;
  c->h[7] = 0x5be0cd19;
  c->md_len = 0x20;
  return 1;
}



uchar * SHA224(uchar *d,size_t n,uchar *md)

{
  uint uVar1;
  ulong uVar2;
  void *pvVar3;
  long lVar4;
  size_t __n;
  undefined1 *puVar5;
  uint *puVar6;
  undefined8 *puVar7;
  ulong uVar8;
  byte bVar9;
  uint local_98;
  uint local_94;
  uint local_90;
  uint local_8c;
  uint local_88;
  uint local_84;
  uint local_80;
  uint local_7c;
  uint local_78;
  uint local_74;
  undefined8 local_70;
  uint local_38;
  uint local_34;
  uint local_30;
  uint local_2c;
  
  bVar9 = 0;
  lVar4 = 0xe;
  if (md == (uchar *)0x0) {
    md = (uchar *)&m_3831;
  }
  puVar6 = &local_98;
  for (; lVar4 != 0; lVar4 = lVar4 + -1) {
    *(undefined8 *)puVar6 = 0;
    puVar6 = (uint *)((long)puVar6 + 8);
  }
  local_98 = 0xc1059ed8;
  local_94 = 0x367cd507;
  local_90 = 0x3070dd17;
  local_8c = 0xf70e5939;
  local_88 = 0xffc00b31;
  local_84 = 0x68581511;
  local_80 = 0x64f98fa7;
  local_7c = 0xbefa4fa4;
  local_2c = 0x1c;
  if (n == 0) {
    local_70._0_1_ = 0x80;
    uVar2 = 1;
  }
  else {
    uVar1 = (uint)n;
    uVar8 = n >> 6;
    local_74 = (uint)(n >> 0x1d);
    local_78 = uVar1 * 8;
    if (uVar8 == 0) {
LAB_0048b110:
      local_30 = uVar1;
      pvVar3 = memcpy(&local_70,d,n);
      uVar8 = (ulong)local_30;
      puVar5 = (undefined1 *)((long)pvVar3 + uVar8);
    }
    else {
      sha256_block_data_order(&local_98,d,uVar8);
      n = n + uVar8 * -0x40;
      if (n != 0) {
        d = d + uVar8 * 0x40;
        uVar1 = (uint)n;
        goto LAB_0048b110;
      }
      uVar8 = (ulong)local_30;
      puVar5 = (undefined1 *)((long)&local_70 + uVar8);
    }
    uVar2 = uVar8 + 1;
    *puVar5 = 0x80;
    if (0x38 < uVar2) {
      puVar7 = &local_70;
      memset((void *)((long)puVar7 + uVar2),0,0x3f - uVar8);
      sha256_block_data_order(&local_98,puVar7,1);
      __n = 0x38;
      goto LAB_0048afa8;
    }
  }
  puVar7 = (undefined8 *)((long)&local_70 + uVar2);
  __n = 0x38 - uVar2;
LAB_0048afa8:
  memset(puVar7,0,__n);
  local_38 = local_74 >> 0x18 | (local_74 & 0xff0000) >> 8 | (local_74 & 0xff00) << 8 |
             local_74 << 0x18;
  local_34 = local_78 >> 0x18 | (local_78 & 0xff0000) >> 8 | (local_78 & 0xff00) << 8 |
             local_78 << 0x18;
  sha256_block_data_order(&local_98,&local_70,1);
  puVar7 = &local_70;
  for (lVar4 = 8; lVar4 != 0; lVar4 = lVar4 + -1) {
    *puVar7 = 0;
    puVar7 = puVar7 + (ulong)bVar9 * -2 + 1;
  }
  local_30 = 0;
  if (local_2c == 0x1c) {
    *(uint *)md = local_98 >> 0x18 | (local_98 & 0xff0000) >> 8 | (local_98 & 0xff00) << 8 |
                  local_98 << 0x18;
    *(uint *)((long)md + 4) =
         local_94 >> 0x18 | (local_94 & 0xff0000) >> 8 | (local_94 & 0xff00) << 8 | local_94 << 0x18
    ;
    *(uint *)((long)md + 8) =
         local_90 >> 0x18 | (local_90 & 0xff0000) >> 8 | (local_90 & 0xff00) << 8 | local_90 << 0x18
    ;
    *(uint *)((long)md + 0xc) =
         local_8c >> 0x18 | (local_8c & 0xff0000) >> 8 | (local_8c & 0xff00) << 8 | local_8c << 0x18
    ;
    *(uint *)((long)md + 0x10) =
         local_88 >> 0x18 | (local_88 & 0xff0000) >> 8 | (local_88 & 0xff00) << 8 | local_88 << 0x18
    ;
    *(uint *)((long)md + 0x14) =
         local_84 >> 0x18 | (local_84 & 0xff0000) >> 8 | (local_84 & 0xff00) << 8 | local_84 << 0x18
    ;
    *(uint *)((long)md + 0x18) =
         local_80 >> 0x18 | (local_80 & 0xff0000) >> 8 | (local_80 & 0xff00) << 8 | local_80 << 0x18
    ;
  }
  else if (local_2c == 0x20) {
    *(uint *)md = local_98 >> 0x18 | (local_98 & 0xff0000) >> 8 | (local_98 & 0xff00) << 8 |
                  local_98 << 0x18;
    *(uint *)((long)md + 4) =
         local_94 >> 0x18 | (local_94 & 0xff0000) >> 8 | (local_94 & 0xff00) << 8 | local_94 << 0x18
    ;
    *(uint *)((long)md + 8) =
         local_90 >> 0x18 | (local_90 & 0xff0000) >> 8 | (local_90 & 0xff00) << 8 | local_90 << 0x18
    ;
    *(uint *)((long)md + 0xc) =
         local_8c >> 0x18 | (local_8c & 0xff0000) >> 8 | (local_8c & 0xff00) << 8 | local_8c << 0x18
    ;
    *(uint *)((long)md + 0x10) =
         local_88 >> 0x18 | (local_88 & 0xff0000) >> 8 | (local_88 & 0xff00) << 8 | local_88 << 0x18
    ;
    *(uint *)((long)md + 0x14) =
         local_84 >> 0x18 | (local_84 & 0xff0000) >> 8 | (local_84 & 0xff00) << 8 | local_84 << 0x18
    ;
    *(uint *)((long)md + 0x18) =
         local_80 >> 0x18 | (local_80 & 0xff0000) >> 8 | (local_80 & 0xff00) << 8 | local_80 << 0x18
    ;
    *(uint *)((long)md + 0x1c) =
         local_7c >> 0x18 | (local_7c & 0xff0000) >> 8 | (local_7c & 0xff00) << 8 | local_7c << 0x18
    ;
  }
  else if ((local_2c < 0x21) && (uVar1 = local_2c >> 2, local_2c >> 2 != 0)) {
    *(uint *)md = local_98 >> 0x18 | (local_98 & 0xff0000) >> 8 | (local_98 & 0xff00) << 8 |
                  local_98 << 0x18;
    if (1 < uVar1) {
      *(uint *)((long)md + 4) =
           local_94 >> 0x18 | (local_94 & 0xff0000) >> 8 | (local_94 & 0xff00) << 8 |
           local_94 << 0x18;
      if (2 < uVar1) {
        *(uint *)((long)md + 8) =
             local_90 >> 0x18 | (local_90 & 0xff0000) >> 8 | (local_90 & 0xff00) << 8 |
             local_90 << 0x18;
        if (3 < uVar1) {
          *(uint *)((long)md + 0xc) =
               local_8c >> 0x18 | (local_8c & 0xff0000) >> 8 | (local_8c & 0xff00) << 8 |
               local_8c << 0x18;
          if (4 < uVar1) {
            *(uint *)((long)md + 0x10) =
                 local_88 >> 0x18 | (local_88 & 0xff0000) >> 8 | (local_88 & 0xff00) << 8 |
                 local_88 << 0x18;
            if (5 < uVar1) {
              *(uint *)((long)md + 0x14) =
                   local_84 >> 0x18 | (local_84 & 0xff0000) >> 8 | (local_84 & 0xff00) << 8 |
                   local_84 << 0x18;
              if (6 < uVar1) {
                *(uint *)((long)md + 0x18) =
                     local_80 >> 0x18 | (local_80 & 0xff0000) >> 8 | (local_80 & 0xff00) << 8 |
                     local_80 << 0x18;
                if (7 < uVar1) {
                  *(uint *)((long)md + 0x1c) =
                       local_7c >> 0x18 | (local_7c & 0xff0000) >> 8 | (local_7c & 0xff00) << 8 |
                       local_7c << 0x18;
                }
              }
            }
          }
        }
      }
    }
  }
  OPENSSL_cleanse(&local_98,0x70);
  return (uchar *)(uint *)md;
}



uchar * SHA256(uchar *d,size_t n,uchar *md)

{
  uint uVar1;
  ulong uVar2;
  void *pvVar3;
  long lVar4;
  size_t __n;
  undefined1 *puVar5;
  uint *puVar6;
  undefined8 *puVar7;
  ulong uVar8;
  byte bVar9;
  uint local_98;
  uint local_94;
  uint local_90;
  uint local_8c;
  uint local_88;
  uint local_84;
  uint local_80;
  uint local_7c;
  uint local_78;
  uint local_74;
  undefined8 local_70;
  uint local_38;
  uint local_34;
  uint local_30;
  uint local_2c;
  
  bVar9 = 0;
  lVar4 = 0xe;
  if (md == (uchar *)0x0) {
    md = (uchar *)&m_3838;
  }
  puVar6 = &local_98;
  for (; lVar4 != 0; lVar4 = lVar4 + -1) {
    *(undefined8 *)puVar6 = 0;
    puVar6 = (uint *)((long)puVar6 + 8);
  }
  local_98 = 0x6a09e667;
  local_94 = 0xbb67ae85;
  local_90 = 0x3c6ef372;
  local_8c = 0xa54ff53a;
  local_88 = 0x510e527f;
  local_84 = 0x9b05688c;
  local_80 = 0x1f83d9ab;
  local_7c = 0x5be0cd19;
  local_2c = 0x20;
  if (n == 0) {
    local_70._0_1_ = 0x80;
    uVar2 = 1;
  }
  else {
    uVar1 = (uint)n;
    uVar8 = n >> 6;
    local_74 = (uint)(n >> 0x1d);
    local_78 = uVar1 * 8;
    if (uVar8 == 0) {
LAB_0048b400:
      local_30 = uVar1;
      pvVar3 = memcpy(&local_70,d,n);
      uVar8 = (ulong)local_30;
      puVar5 = (undefined1 *)((long)pvVar3 + uVar8);
    }
    else {
      sha256_block_data_order(&local_98,d,uVar8);
      n = n + uVar8 * -0x40;
      if (n != 0) {
        d = d + uVar8 * 0x40;
        uVar1 = (uint)n;
        goto LAB_0048b400;
      }
      uVar8 = (ulong)local_30;
      puVar5 = (undefined1 *)((long)&local_70 + uVar8);
    }
    uVar2 = uVar8 + 1;
    *puVar5 = 0x80;
    if (0x38 < uVar2) {
      puVar7 = &local_70;
      memset((void *)((long)puVar7 + uVar2),0,0x3f - uVar8);
      sha256_block_data_order(&local_98,puVar7,1);
      __n = 0x38;
      goto LAB_0048b298;
    }
  }
  puVar7 = (undefined8 *)((long)&local_70 + uVar2);
  __n = 0x38 - uVar2;
LAB_0048b298:
  memset(puVar7,0,__n);
  local_38 = local_74 >> 0x18 | (local_74 & 0xff0000) >> 8 | (local_74 & 0xff00) << 8 |
             local_74 << 0x18;
  local_34 = local_78 >> 0x18 | (local_78 & 0xff0000) >> 8 | (local_78 & 0xff00) << 8 |
             local_78 << 0x18;
  sha256_block_data_order(&local_98,&local_70,1);
  puVar7 = &local_70;
  for (lVar4 = 8; lVar4 != 0; lVar4 = lVar4 + -1) {
    *puVar7 = 0;
    puVar7 = puVar7 + (ulong)bVar9 * -2 + 1;
  }
  local_30 = 0;
  if (local_2c == 0x1c) {
    *(uint *)md = local_98 >> 0x18 | (local_98 & 0xff0000) >> 8 | (local_98 & 0xff00) << 8 |
                  local_98 << 0x18;
    *(uint *)((long)md + 4) =
         local_94 >> 0x18 | (local_94 & 0xff0000) >> 8 | (local_94 & 0xff00) << 8 | local_94 << 0x18
    ;
    *(uint *)((long)md + 8) =
         local_90 >> 0x18 | (local_90 & 0xff0000) >> 8 | (local_90 & 0xff00) << 8 | local_90 << 0x18
    ;
    *(uint *)((long)md + 0xc) =
         local_8c >> 0x18 | (local_8c & 0xff0000) >> 8 | (local_8c & 0xff00) << 8 | local_8c << 0x18
    ;
    *(uint *)((long)md + 0x10) =
         local_88 >> 0x18 | (local_88 & 0xff0000) >> 8 | (local_88 & 0xff00) << 8 | local_88 << 0x18
    ;
    *(uint *)((long)md + 0x14) =
         local_84 >> 0x18 | (local_84 & 0xff0000) >> 8 | (local_84 & 0xff00) << 8 | local_84 << 0x18
    ;
    *(uint *)((long)md + 0x18) =
         local_80 >> 0x18 | (local_80 & 0xff0000) >> 8 | (local_80 & 0xff00) << 8 | local_80 << 0x18
    ;
  }
  else if (local_2c == 0x20) {
    *(uint *)md = local_98 >> 0x18 | (local_98 & 0xff0000) >> 8 | (local_98 & 0xff00) << 8 |
                  local_98 << 0x18;
    *(uint *)((long)md + 4) =
         local_94 >> 0x18 | (local_94 & 0xff0000) >> 8 | (local_94 & 0xff00) << 8 | local_94 << 0x18
    ;
    *(uint *)((long)md + 8) =
         local_90 >> 0x18 | (local_90 & 0xff0000) >> 8 | (local_90 & 0xff00) << 8 | local_90 << 0x18
    ;
    *(uint *)((long)md + 0xc) =
         local_8c >> 0x18 | (local_8c & 0xff0000) >> 8 | (local_8c & 0xff00) << 8 | local_8c << 0x18
    ;
    *(uint *)((long)md + 0x10) =
         local_88 >> 0x18 | (local_88 & 0xff0000) >> 8 | (local_88 & 0xff00) << 8 | local_88 << 0x18
    ;
    *(uint *)((long)md + 0x14) =
         local_84 >> 0x18 | (local_84 & 0xff0000) >> 8 | (local_84 & 0xff00) << 8 | local_84 << 0x18
    ;
    *(uint *)((long)md + 0x18) =
         local_80 >> 0x18 | (local_80 & 0xff0000) >> 8 | (local_80 & 0xff00) << 8 | local_80 << 0x18
    ;
    *(uint *)((long)md + 0x1c) =
         local_7c >> 0x18 | (local_7c & 0xff0000) >> 8 | (local_7c & 0xff00) << 8 | local_7c << 0x18
    ;
  }
  else if ((local_2c < 0x21) && (uVar1 = local_2c >> 2, local_2c >> 2 != 0)) {
    *(uint *)md = local_98 >> 0x18 | (local_98 & 0xff0000) >> 8 | (local_98 & 0xff00) << 8 |
                  local_98 << 0x18;
    if (1 < uVar1) {
      *(uint *)((long)md + 4) =
           local_94 >> 0x18 | (local_94 & 0xff0000) >> 8 | (local_94 & 0xff00) << 8 |
           local_94 << 0x18;
      if (2 < uVar1) {
        *(uint *)((long)md + 8) =
             local_90 >> 0x18 | (local_90 & 0xff0000) >> 8 | (local_90 & 0xff00) << 8 |
             local_90 << 0x18;
        if (3 < uVar1) {
          *(uint *)((long)md + 0xc) =
               local_8c >> 0x18 | (local_8c & 0xff0000) >> 8 | (local_8c & 0xff00) << 8 |
               local_8c << 0x18;
          if (4 < uVar1) {
            *(uint *)((long)md + 0x10) =
                 local_88 >> 0x18 | (local_88 & 0xff0000) >> 8 | (local_88 & 0xff00) << 8 |
                 local_88 << 0x18;
            if (5 < uVar1) {
              *(uint *)((long)md + 0x14) =
                   local_84 >> 0x18 | (local_84 & 0xff0000) >> 8 | (local_84 & 0xff00) << 8 |
                   local_84 << 0x18;
              if (6 < uVar1) {
                *(uint *)((long)md + 0x18) =
                     local_80 >> 0x18 | (local_80 & 0xff0000) >> 8 | (local_80 & 0xff00) << 8 |
                     local_80 << 0x18;
                if (7 < uVar1) {
                  *(uint *)((long)md + 0x1c) =
                       local_7c >> 0x18 | (local_7c & 0xff0000) >> 8 | (local_7c & 0xff00) << 8 |
                       local_7c << 0x18;
                }
              }
            }
          }
        }
      }
    }
  }
  OPENSSL_cleanse(&local_98,0x70);
  return (uchar *)(uint *)md;
}



int SHA224_Update(SHA256_CTX *c,void *data,size_t len)

{
  uint uVar1;
  uint uVar2;
  ulong uVar3;
  ulong uVar4;
  uint *puVar5;
  uint *puVar6;
  void *pvVar7;
  void *__src;
  size_t __n;
  bool bVar8;
  byte bVar9;
  
  bVar9 = 0;
  if (len != 0) {
    uVar2 = c->Nl + (int)len * 8;
    if (uVar2 < c->Nl) {
      uVar1 = c->Nh + 1;
    }
    else {
      uVar1 = c->Nh;
    }
    c->Nl = uVar2;
    uVar4 = (ulong)c->num;
    c->Nh = (int)(len >> 0x1d) + uVar1;
    pvVar7 = data;
    if (uVar4 != 0) {
      puVar5 = c->data;
      if ((len < 0x40) && (len + uVar4 < 0x40)) {
        memcpy((void *)((long)puVar5 + uVar4),data,len);
        c->num = c->num + (int)len;
        return 1;
      }
      __n = 0x40 - uVar4;
      pvVar7 = (void *)((long)data + __n);
      len = len - __n;
      memcpy((void *)((long)puVar5 + uVar4),data,__n);
      sha256_block_data_order(c,puVar5,1);
      bVar8 = ((ulong)puVar5 & 1) != 0;
      c->num = 0;
      uVar4 = 0x40;
      if (bVar8) {
        *(undefined1 *)c->data = 0;
        puVar5 = (uint *)((long)c->data + 1);
        uVar4 = 0x3f;
      }
      puVar6 = puVar5;
      if (((ulong)puVar5 & 2) != 0) {
        puVar6 = (uint *)((long)puVar5 + 2);
        uVar4 = (ulong)((int)uVar4 - 2);
        *(undefined2 *)puVar5 = 0;
      }
      if (((ulong)puVar6 & 4) != 0) {
        *puVar6 = 0;
        uVar4 = (ulong)((int)uVar4 - 4);
        puVar6 = puVar6 + 1;
      }
      for (uVar3 = uVar4 >> 3; uVar3 != 0; uVar3 = uVar3 - 1) {
        puVar6[0] = 0;
        puVar6[1] = 0;
        puVar6 = puVar6 + (ulong)bVar9 * -4 + 2;
      }
      if ((uVar4 & 4) != 0) {
        *puVar6 = 0;
        puVar6 = puVar6 + 1;
      }
      puVar5 = puVar6;
      if ((uVar4 & 2) != 0) {
        puVar5 = (uint *)((long)puVar6 + 2);
        *(undefined2 *)puVar6 = 0;
      }
      if (bVar8) {
        *(undefined1 *)puVar5 = 0;
      }
    }
    uVar4 = len >> 6;
    __src = pvVar7;
    if (uVar4 != 0) {
      __src = (void *)((long)pvVar7 + uVar4 * 0x40);
      len = len + uVar4 * -0x40;
      sha256_block_data_order(c,pvVar7,uVar4);
    }
    if (len != 0) {
      c->num = (uint)len;
      memcpy(c->data,__src,len);
      return 1;
    }
  }
  return 1;
}



int SHA224_Final(uchar *md,SHA256_CTX *c)

{
  ulong uVar1;
  uint uVar2;
  size_t __n;
  ulong uVar3;
  uint *puVar4;
  uint *puVar5;
  bool bVar6;
  byte bVar7;
  
  bVar7 = 0;
  puVar4 = c->data;
  uVar1 = (ulong)c->num;
  uVar3 = uVar1 + 1;
  *(undefined1 *)((long)c->data + uVar1) = 0x80;
  if (uVar3 < 0x39) {
    __n = 0x37 - uVar1;
  }
  else {
    memset((void *)(uVar3 + (long)puVar4),0,0x3f - uVar1);
    sha256_block_data_order(c,puVar4,1);
    __n = 0x38;
    uVar3 = 0;
  }
  memset((void *)(uVar3 + (long)puVar4),0,__n);
  uVar2 = c->Nh;
  c->data[0xe] = uVar2 >> 0x18 | (uVar2 & 0xff0000) >> 8 | (uVar2 & 0xff00) << 8 | uVar2 << 0x18;
  uVar2 = c->Nl;
  c->data[0xf] = uVar2 >> 0x18 | (uVar2 & 0xff0000) >> 8 | (uVar2 & 0xff00) << 8 | uVar2 << 0x18;
  sha256_block_data_order(c,puVar4,1);
  bVar6 = ((ulong)puVar4 & 1) != 0;
  c->num = 0;
  uVar3 = 0x40;
  if (bVar6) {
    *(undefined1 *)c->data = 0;
    puVar4 = (uint *)((long)c->data + 1);
    uVar3 = 0x3f;
  }
  uVar2 = (uint)uVar3;
  if (((ulong)puVar4 & 2) != 0) {
    uVar2 = uVar2 - 2;
    uVar3 = (ulong)uVar2;
    *(undefined2 *)puVar4 = 0;
    puVar4 = (uint *)((long)puVar4 + 2);
  }
  if (((ulong)puVar4 & 4) != 0) {
    *puVar4 = 0;
    uVar3 = (ulong)(uVar2 - 4);
    puVar4 = puVar4 + 1;
  }
  for (uVar1 = uVar3 >> 3; uVar1 != 0; uVar1 = uVar1 - 1) {
    puVar4[0] = 0;
    puVar4[1] = 0;
    puVar4 = puVar4 + (ulong)bVar7 * -4 + 2;
  }
  if ((uVar3 & 4) != 0) {
    *puVar4 = 0;
    puVar4 = puVar4 + 1;
  }
  puVar5 = puVar4;
  if ((uVar3 & 2) != 0) {
    puVar5 = (uint *)((long)puVar4 + 2);
    *(undefined2 *)puVar4 = 0;
  }
  if (bVar6) {
    *(undefined1 *)puVar5 = 0;
  }
  uVar2 = c->md_len;
  if (uVar2 == 0x1c) {
    uVar2 = c->h[0];
    *(uint *)md = uVar2 >> 0x18 | (uVar2 & 0xff0000) >> 8 | (uVar2 & 0xff00) << 8 | uVar2 << 0x18;
    uVar2 = c->h[1];
    *(uint *)(md + 4) =
         uVar2 >> 0x18 | (uVar2 & 0xff0000) >> 8 | (uVar2 & 0xff00) << 8 | uVar2 << 0x18;
    uVar2 = c->h[2];
    *(uint *)(md + 8) =
         uVar2 >> 0x18 | (uVar2 & 0xff0000) >> 8 | (uVar2 & 0xff00) << 8 | uVar2 << 0x18;
    uVar2 = c->h[3];
    *(uint *)(md + 0xc) =
         uVar2 >> 0x18 | (uVar2 & 0xff0000) >> 8 | (uVar2 & 0xff00) << 8 | uVar2 << 0x18;
    uVar2 = c->h[4];
    *(uint *)(md + 0x10) =
         uVar2 >> 0x18 | (uVar2 & 0xff0000) >> 8 | (uVar2 & 0xff00) << 8 | uVar2 << 0x18;
    uVar2 = c->h[5];
    *(uint *)(md + 0x14) =
         uVar2 >> 0x18 | (uVar2 & 0xff0000) >> 8 | (uVar2 & 0xff00) << 8 | uVar2 << 0x18;
    uVar2 = c->h[6];
    *(uint *)(md + 0x18) =
         uVar2 >> 0x18 | (uVar2 & 0xff0000) >> 8 | (uVar2 & 0xff00) << 8 | uVar2 << 0x18;
  }
  else if (uVar2 == 0x20) {
    uVar2 = c->h[0];
    *(uint *)md = uVar2 >> 0x18 | (uVar2 & 0xff0000) >> 8 | (uVar2 & 0xff00) << 8 | uVar2 << 0x18;
    uVar2 = c->h[1];
    *(uint *)(md + 4) =
         uVar2 >> 0x18 | (uVar2 & 0xff0000) >> 8 | (uVar2 & 0xff00) << 8 | uVar2 << 0x18;
    uVar2 = c->h[2];
    *(uint *)(md + 8) =
         uVar2 >> 0x18 | (uVar2 & 0xff0000) >> 8 | (uVar2 & 0xff00) << 8 | uVar2 << 0x18;
    uVar2 = c->h[3];
    *(uint *)(md + 0xc) =
         uVar2 >> 0x18 | (uVar2 & 0xff0000) >> 8 | (uVar2 & 0xff00) << 8 | uVar2 << 0x18;
    uVar2 = c->h[4];
    *(uint *)(md + 0x10) =
         uVar2 >> 0x18 | (uVar2 & 0xff0000) >> 8 | (uVar2 & 0xff00) << 8 | uVar2 << 0x18;
    uVar2 = c->h[5];
    *(uint *)(md + 0x14) =
         uVar2 >> 0x18 | (uVar2 & 0xff0000) >> 8 | (uVar2 & 0xff00) << 8 | uVar2 << 0x18;
    uVar2 = c->h[6];
    *(uint *)(md + 0x18) =
         uVar2 >> 0x18 | (uVar2 & 0xff0000) >> 8 | (uVar2 & 0xff00) << 8 | uVar2 << 0x18;
    uVar2 = c->h[7];
    *(uint *)(md + 0x1c) =
         uVar2 >> 0x18 | (uVar2 & 0xff0000) >> 8 | (uVar2 & 0xff00) << 8 | uVar2 << 0x18;
  }
  else {
    if (0x20 < uVar2) {
      return 0;
    }
    if (uVar2 >> 2 != 0) {
      uVar2 = c->h[0];
      *(uint *)md = uVar2 >> 0x18 | (uVar2 & 0xff0000) >> 8 | (uVar2 & 0xff00) << 8 | uVar2 << 0x18;
      if (7 < c->md_len) {
        uVar2 = c->h[1];
        *(uint *)(md + 4) =
             uVar2 >> 0x18 | (uVar2 & 0xff0000) >> 8 | (uVar2 & 0xff00) << 8 | uVar2 << 0x18;
        if (0xb < c->md_len) {
          uVar2 = c->h[2];
          *(uint *)(md + 8) =
               uVar2 >> 0x18 | (uVar2 & 0xff0000) >> 8 | (uVar2 & 0xff00) << 8 | uVar2 << 0x18;
          if (0xf < c->md_len) {
            uVar2 = c->h[3];
            *(uint *)(md + 0xc) =
                 uVar2 >> 0x18 | (uVar2 & 0xff0000) >> 8 | (uVar2 & 0xff00) << 8 | uVar2 << 0x18;
            if (0x13 < c->md_len) {
              uVar2 = c->h[4];
              *(uint *)(md + 0x10) =
                   uVar2 >> 0x18 | (uVar2 & 0xff0000) >> 8 | (uVar2 & 0xff00) << 8 | uVar2 << 0x18;
              if (0x17 < c->md_len) {
                uVar2 = c->h[5];
                *(uint *)(md + 0x14) =
                     uVar2 >> 0x18 | (uVar2 & 0xff0000) >> 8 | (uVar2 & 0xff00) << 8 | uVar2 << 0x18
                ;
                if (0x1b < c->md_len) {
                  uVar2 = c->h[6];
                  *(uint *)(md + 0x18) =
                       uVar2 >> 0x18 | (uVar2 & 0xff0000) >> 8 | (uVar2 & 0xff00) << 8 |
                       uVar2 << 0x18;
                  if (0x1f < c->md_len) {
                    uVar2 = c->h[7];
                    *(uint *)(md + 0x1c) =
                         uVar2 >> 0x18 | (uVar2 & 0xff0000) >> 8 | (uVar2 & 0xff00) << 8 |
                         uVar2 << 0x18;
                  }
                }
              }
            }
          }
        }
      }
    }
  }
  return 1;
}



int SHA256_Update(SHA256_CTX *c,void *data,size_t len)

{
  uint uVar1;
  uint uVar2;
  ulong uVar3;
  ulong uVar4;
  uint *puVar5;
  uint *puVar6;
  void *pvVar7;
  void *__src;
  size_t __n;
  bool bVar8;
  byte bVar9;
  
  bVar9 = 0;
  if (len != 0) {
    uVar2 = c->Nl + (int)len * 8;
    if (uVar2 < c->Nl) {
      uVar1 = c->Nh + 1;
    }
    else {
      uVar1 = c->Nh;
    }
    c->Nl = uVar2;
    uVar4 = (ulong)c->num;
    c->Nh = (int)(len >> 0x1d) + uVar1;
    pvVar7 = data;
    if (uVar4 != 0) {
      puVar5 = c->data;
      if ((len < 0x40) && (len + uVar4 < 0x40)) {
        memcpy((void *)((long)puVar5 + uVar4),data,len);
        c->num = c->num + (int)len;
        return 1;
      }
      __n = 0x40 - uVar4;
      pvVar7 = (void *)((long)data + __n);
      len = len - __n;
      memcpy((void *)((long)puVar5 + uVar4),data,__n);
      sha256_block_data_order(c,puVar5,1);
      bVar8 = ((ulong)puVar5 & 1) != 0;
      c->num = 0;
      uVar4 = 0x40;
      if (bVar8) {
        *(undefined1 *)c->data = 0;
        puVar5 = (uint *)((long)c->data + 1);
        uVar4 = 0x3f;
      }
      puVar6 = puVar5;
      if (((ulong)puVar5 & 2) != 0) {
        puVar6 = (uint *)((long)puVar5 + 2);
        uVar4 = (ulong)((int)uVar4 - 2);
        *(undefined2 *)puVar5 = 0;
      }
      if (((ulong)puVar6 & 4) != 0) {
        *puVar6 = 0;
        uVar4 = (ulong)((int)uVar4 - 4);
        puVar6 = puVar6 + 1;
      }
      for (uVar3 = uVar4 >> 3; uVar3 != 0; uVar3 = uVar3 - 1) {
        puVar6[0] = 0;
        puVar6[1] = 0;
        puVar6 = puVar6 + (ulong)bVar9 * -4 + 2;
      }
      if ((uVar4 & 4) != 0) {
        *puVar6 = 0;
        puVar6 = puVar6 + 1;
      }
      if ((uVar4 & 2) != 0) {
        *(undefined2 *)puVar6 = 0;
        puVar6 = (uint *)((long)puVar6 + 2);
      }
      if (bVar8) {
        *(undefined1 *)puVar6 = 0;
      }
    }
    uVar4 = len >> 6;
    __src = pvVar7;
    if (uVar4 != 0) {
      __src = (void *)((long)pvVar7 + uVar4 * 0x40);
      len = len + uVar4 * -0x40;
      sha256_block_data_order(c,pvVar7,uVar4);
    }
    if (len != 0) {
      c->num = (uint)len;
      memcpy(c->data,__src,len);
    }
  }
  return 1;
}



void SHA256_Transform(SHA256_CTX *c,uchar *data)

{
  sha256_block_data_order(c,data,1);
  return;
}



int SHA256_Final(uchar *md,SHA256_CTX *c)

{
  ulong uVar1;
  uint uVar2;
  size_t __n;
  ulong uVar3;
  uint *puVar4;
  uint *puVar5;
  bool bVar6;
  byte bVar7;
  
  bVar7 = 0;
  puVar4 = c->data;
  uVar1 = (ulong)c->num;
  uVar3 = uVar1 + 1;
  *(undefined1 *)((long)c->data + uVar1) = 0x80;
  if (uVar3 < 0x39) {
    __n = 0x37 - uVar1;
  }
  else {
    memset((void *)(uVar3 + (long)puVar4),0,0x3f - uVar1);
    sha256_block_data_order(c,puVar4,1);
    __n = 0x38;
    uVar3 = 0;
  }
  memset((void *)(uVar3 + (long)puVar4),0,__n);
  uVar2 = c->Nh;
  c->data[0xe] = uVar2 >> 0x18 | (uVar2 & 0xff0000) >> 8 | (uVar2 & 0xff00) << 8 | uVar2 << 0x18;
  uVar2 = c->Nl;
  c->data[0xf] = uVar2 >> 0x18 | (uVar2 & 0xff0000) >> 8 | (uVar2 & 0xff00) << 8 | uVar2 << 0x18;
  sha256_block_data_order(c,puVar4,1);
  bVar6 = ((ulong)puVar4 & 1) != 0;
  c->num = 0;
  uVar3 = 0x40;
  if (bVar6) {
    *(undefined1 *)c->data = 0;
    puVar4 = (uint *)((long)c->data + 1);
    uVar3 = 0x3f;
  }
  uVar2 = (uint)uVar3;
  if (((ulong)puVar4 & 2) != 0) {
    uVar2 = uVar2 - 2;
    uVar3 = (ulong)uVar2;
    *(undefined2 *)puVar4 = 0;
    puVar4 = (uint *)((long)puVar4 + 2);
  }
  if (((ulong)puVar4 & 4) != 0) {
    *puVar4 = 0;
    uVar3 = (ulong)(uVar2 - 4);
    puVar4 = puVar4 + 1;
  }
  for (uVar1 = uVar3 >> 3; uVar1 != 0; uVar1 = uVar1 - 1) {
    puVar4[0] = 0;
    puVar4[1] = 0;
    puVar4 = puVar4 + (ulong)bVar7 * -4 + 2;
  }
  if ((uVar3 & 4) != 0) {
    *puVar4 = 0;
    puVar4 = puVar4 + 1;
  }
  puVar5 = puVar4;
  if ((uVar3 & 2) != 0) {
    puVar5 = (uint *)((long)puVar4 + 2);
    *(undefined2 *)puVar4 = 0;
  }
  if (bVar6) {
    *(undefined1 *)puVar5 = 0;
  }
  uVar2 = c->md_len;
  if (uVar2 == 0x1c) {
    uVar2 = c->h[0];
    *(uint *)md = uVar2 >> 0x18 | (uVar2 & 0xff0000) >> 8 | (uVar2 & 0xff00) << 8 | uVar2 << 0x18;
    uVar2 = c->h[1];
    *(uint *)(md + 4) =
         uVar2 >> 0x18 | (uVar2 & 0xff0000) >> 8 | (uVar2 & 0xff00) << 8 | uVar2 << 0x18;
    uVar2 = c->h[2];
    *(uint *)(md + 8) =
         uVar2 >> 0x18 | (uVar2 & 0xff0000) >> 8 | (uVar2 & 0xff00) << 8 | uVar2 << 0x18;
    uVar2 = c->h[3];
    *(uint *)(md + 0xc) =
         uVar2 >> 0x18 | (uVar2 & 0xff0000) >> 8 | (uVar2 & 0xff00) << 8 | uVar2 << 0x18;
    uVar2 = c->h[4];
    *(uint *)(md + 0x10) =
         uVar2 >> 0x18 | (uVar2 & 0xff0000) >> 8 | (uVar2 & 0xff00) << 8 | uVar2 << 0x18;
    uVar2 = c->h[5];
    *(uint *)(md + 0x14) =
         uVar2 >> 0x18 | (uVar2 & 0xff0000) >> 8 | (uVar2 & 0xff00) << 8 | uVar2 << 0x18;
    uVar2 = c->h[6];
    *(uint *)(md + 0x18) =
         uVar2 >> 0x18 | (uVar2 & 0xff0000) >> 8 | (uVar2 & 0xff00) << 8 | uVar2 << 0x18;
  }
  else if (uVar2 == 0x20) {
    uVar2 = c->h[0];
    *(uint *)md = uVar2 >> 0x18 | (uVar2 & 0xff0000) >> 8 | (uVar2 & 0xff00) << 8 | uVar2 << 0x18;
    uVar2 = c->h[1];
    *(uint *)(md + 4) =
         uVar2 >> 0x18 | (uVar2 & 0xff0000) >> 8 | (uVar2 & 0xff00) << 8 | uVar2 << 0x18;
    uVar2 = c->h[2];
    *(uint *)(md + 8) =
         uVar2 >> 0x18 | (uVar2 & 0xff0000) >> 8 | (uVar2 & 0xff00) << 8 | uVar2 << 0x18;
    uVar2 = c->h[3];
    *(uint *)(md + 0xc) =
         uVar2 >> 0x18 | (uVar2 & 0xff0000) >> 8 | (uVar2 & 0xff00) << 8 | uVar2 << 0x18;
    uVar2 = c->h[4];
    *(uint *)(md + 0x10) =
         uVar2 >> 0x18 | (uVar2 & 0xff0000) >> 8 | (uVar2 & 0xff00) << 8 | uVar2 << 0x18;
    uVar2 = c->h[5];
    *(uint *)(md + 0x14) =
         uVar2 >> 0x18 | (uVar2 & 0xff0000) >> 8 | (uVar2 & 0xff00) << 8 | uVar2 << 0x18;
    uVar2 = c->h[6];
    *(uint *)(md + 0x18) =
         uVar2 >> 0x18 | (uVar2 & 0xff0000) >> 8 | (uVar2 & 0xff00) << 8 | uVar2 << 0x18;
    uVar2 = c->h[7];
    *(uint *)(md + 0x1c) =
         uVar2 >> 0x18 | (uVar2 & 0xff0000) >> 8 | (uVar2 & 0xff00) << 8 | uVar2 << 0x18;
  }
  else {
    if (0x20 < uVar2) {
      return 0;
    }
    if (uVar2 >> 2 != 0) {
      uVar2 = c->h[0];
      *(uint *)md = uVar2 >> 0x18 | (uVar2 & 0xff0000) >> 8 | (uVar2 & 0xff00) << 8 | uVar2 << 0x18;
      if (7 < c->md_len) {
        uVar2 = c->h[1];
        *(uint *)(md + 4) =
             uVar2 >> 0x18 | (uVar2 & 0xff0000) >> 8 | (uVar2 & 0xff00) << 8 | uVar2 << 0x18;
        if (0xb < c->md_len) {
          uVar2 = c->h[2];
          *(uint *)(md + 8) =
               uVar2 >> 0x18 | (uVar2 & 0xff0000) >> 8 | (uVar2 & 0xff00) << 8 | uVar2 << 0x18;
          if (0xf < c->md_len) {
            uVar2 = c->h[3];
            *(uint *)(md + 0xc) =
                 uVar2 >> 0x18 | (uVar2 & 0xff0000) >> 8 | (uVar2 & 0xff00) << 8 | uVar2 << 0x18;
            if (0x13 < c->md_len) {
              uVar2 = c->h[4];
              *(uint *)(md + 0x10) =
                   uVar2 >> 0x18 | (uVar2 & 0xff0000) >> 8 | (uVar2 & 0xff00) << 8 | uVar2 << 0x18;
              if (0x17 < c->md_len) {
                uVar2 = c->h[5];
                *(uint *)(md + 0x14) =
                     uVar2 >> 0x18 | (uVar2 & 0xff0000) >> 8 | (uVar2 & 0xff00) << 8 | uVar2 << 0x18
                ;
                if (0x1b < c->md_len) {
                  uVar2 = c->h[6];
                  *(uint *)(md + 0x18) =
                       uVar2 >> 0x18 | (uVar2 & 0xff0000) >> 8 | (uVar2 & 0xff00) << 8 |
                       uVar2 << 0x18;
                  if (0x1f < c->md_len) {
                    uVar2 = c->h[7];
                    *(uint *)(md + 0x1c) =
                         uVar2 >> 0x18 | (uVar2 & 0xff0000) >> 8 | (uVar2 & 0xff00) << 8 |
                         uVar2 << 0x18;
                  }
                }
              }
            }
          }
        }
      }
    }
  }
  return 1;
}



void sha256_block_data_order(uint *param_1,uint *param_2,long param_3)

{
  uint *puVar1;
  uint uVar2;
  uint uVar3;
  uint uVar4;
  uint uVar5;
  uint uVar6;
  uint uVar7;
  ulong uVar8;
  uint uVar9;
  uint uVar10;
  uint uVar11;
  uint uVar12;
  int iVar13;
  uint uVar14;
  uint uVar15;
  uint uVar16;
  uint uVar17;
  uint uVar18;
  uint uVar19;
  uint local_c0;
  uint local_bc;
  uint local_b8;
  uint local_b4;
  uint local_b0;
  uint local_ac;
  uint local_a8;
  uint local_a4;
  uint local_a0;
  uint local_9c;
  uint local_98;
  uint local_94;
  uint local_90;
  uint local_8c;
  uint local_88;
  uint local_84;
  
  puVar1 = param_2 + param_3 * 0x10;
  uVar2 = *param_1;
  uVar6 = param_1[1];
  uVar3 = param_1[2];
  uVar4 = param_1[3];
  uVar18 = param_1[4];
  uVar17 = param_1[5];
  uVar16 = param_1[6];
  uVar15 = param_1[7];
  do {
    uVar14 = *param_2;
    local_c0 = uVar14 >> 0x18 | (uVar14 & 0xff0000) >> 8 | (uVar14 & 0xff00) << 8 | uVar14 << 0x18;
    uVar14 = (uVar18 >> 0xe | uVar18 << 0x12) ^ uVar18;
    uVar19 = (uVar2 >> 9 | uVar2 << 0x17) ^ uVar2;
    uVar14 = (uVar14 >> 5 | uVar14 << 0x1b) ^ uVar18;
    uVar19 = (uVar19 >> 0xb | uVar19 << 0x15) ^ uVar2;
    iVar13 = local_c0 + uVar15 + 0x428a2f98 + ((uVar17 ^ uVar16) & uVar18 ^ uVar16) +
             (uVar14 >> 6 | uVar14 << 0x1a);
    uVar4 = uVar4 + iVar13;
    uVar12 = ((uVar6 ^ uVar3) & uVar2) + (uVar6 & uVar3) + iVar13 + (uVar19 >> 2 | uVar19 << 0x1e);
    uVar15 = param_2[1];
    local_bc = uVar15 >> 0x18 | (uVar15 & 0xff0000) >> 8 | (uVar15 & 0xff00) << 8 | uVar15 << 0x18;
    uVar15 = (uVar4 >> 0xe | uVar4 * 0x40000) ^ uVar4;
    uVar14 = (uVar12 >> 9 | uVar12 * 0x800000) ^ uVar12;
    uVar15 = (uVar15 >> 5 | uVar15 << 0x1b) ^ uVar4;
    uVar14 = (uVar14 >> 0xb | uVar14 << 0x15) ^ uVar12;
    iVar13 = local_bc + uVar16 + 0x71374491 + ((uVar18 ^ uVar17) & uVar4 ^ uVar17) +
             (uVar15 >> 6 | uVar15 << 0x1a);
    uVar3 = uVar3 + iVar13;
    uVar11 = ((uVar2 ^ uVar6) & uVar12) + (uVar2 & uVar6) + iVar13 + (uVar14 >> 2 | uVar14 << 0x1e);
    uVar16 = param_2[2];
    local_b8 = uVar16 >> 0x18 | (uVar16 & 0xff0000) >> 8 | (uVar16 & 0xff00) << 8 | uVar16 << 0x18;
    uVar16 = (uVar3 >> 0xe | uVar3 * 0x40000) ^ uVar3;
    uVar15 = (uVar11 >> 9 | uVar11 * 0x800000) ^ uVar11;
    uVar16 = (uVar16 >> 5 | uVar16 << 0x1b) ^ uVar3;
    uVar15 = (uVar15 >> 0xb | uVar15 << 0x15) ^ uVar11;
    iVar13 = local_b8 + uVar17 + -0x4a3f0431 + ((uVar4 ^ uVar18) & uVar3 ^ uVar18) +
             (uVar16 >> 6 | uVar16 << 0x1a);
    uVar6 = uVar6 + iVar13;
    uVar10 = ((uVar12 ^ uVar2) & uVar11) + (uVar12 & uVar2) + iVar13 +
             (uVar15 >> 2 | uVar15 << 0x1e);
    uVar17 = param_2[3];
    local_b4 = uVar17 >> 0x18 | (uVar17 & 0xff0000) >> 8 | (uVar17 & 0xff00) << 8 | uVar17 << 0x18;
    uVar17 = (uVar6 >> 0xe | uVar6 * 0x40000) ^ uVar6;
    uVar16 = (uVar10 >> 9 | uVar10 * 0x800000) ^ uVar10;
    uVar17 = (uVar17 >> 5 | uVar17 << 0x1b) ^ uVar6;
    uVar16 = (uVar16 >> 0xb | uVar16 << 0x15) ^ uVar10;
    iVar13 = local_b4 + uVar18 + -0x164a245b + ((uVar3 ^ uVar4) & uVar6 ^ uVar4) +
             (uVar17 >> 6 | uVar17 << 0x1a);
    uVar2 = uVar2 + iVar13;
    uVar9 = ((uVar11 ^ uVar12) & uVar10) + (uVar11 & uVar12) + iVar13 +
            (uVar16 >> 2 | uVar16 << 0x1e);
    uVar18 = param_2[4];
    local_b0 = uVar18 >> 0x18 | (uVar18 & 0xff0000) >> 8 | (uVar18 & 0xff00) << 8 | uVar18 << 0x18;
    uVar18 = (uVar2 >> 0xe | uVar2 * 0x40000) ^ uVar2;
    uVar17 = (uVar9 >> 9 | uVar9 * 0x800000) ^ uVar9;
    uVar18 = (uVar18 >> 5 | uVar18 << 0x1b) ^ uVar2;
    uVar17 = (uVar17 >> 0xb | uVar17 << 0x15) ^ uVar9;
    iVar13 = local_b0 + uVar4 + 0x3956c25b + ((uVar6 ^ uVar3) & uVar2 ^ uVar3) +
             (uVar18 >> 6 | uVar18 << 0x1a);
    uVar12 = uVar12 + iVar13;
    uVar5 = ((uVar10 ^ uVar11) & uVar9) + (uVar10 & uVar11) + iVar13 +
            (uVar17 >> 2 | uVar17 << 0x1e);
    uVar4 = param_2[5];
    local_ac = uVar4 >> 0x18 | (uVar4 & 0xff0000) >> 8 | (uVar4 & 0xff00) << 8 | uVar4 << 0x18;
    uVar4 = (uVar12 >> 0xe | uVar12 * 0x40000) ^ uVar12;
    uVar18 = (uVar5 >> 9 | uVar5 * 0x800000) ^ uVar5;
    uVar4 = (uVar4 >> 5 | uVar4 << 0x1b) ^ uVar12;
    uVar18 = (uVar18 >> 0xb | uVar18 << 0x15) ^ uVar5;
    iVar13 = local_ac + uVar3 + 0x59f111f1 + ((uVar2 ^ uVar6) & uVar12 ^ uVar6) +
             (uVar4 >> 6 | uVar4 << 0x1a);
    uVar11 = uVar11 + iVar13;
    uVar19 = ((uVar9 ^ uVar10) & uVar5) + (uVar9 & uVar10) + iVar13 + (uVar18 >> 2 | uVar18 << 0x1e)
    ;
    uVar3 = param_2[6];
    local_a8 = uVar3 >> 0x18 | (uVar3 & 0xff0000) >> 8 | (uVar3 & 0xff00) << 8 | uVar3 << 0x18;
    uVar3 = (uVar11 >> 0xe | uVar11 * 0x40000) ^ uVar11;
    uVar4 = (uVar19 >> 9 | uVar19 * 0x800000) ^ uVar19;
    uVar3 = (uVar3 >> 5 | uVar3 << 0x1b) ^ uVar11;
    uVar4 = (uVar4 >> 0xb | uVar4 << 0x15) ^ uVar19;
    iVar13 = local_a8 + uVar6 + -0x6dc07d5c + ((uVar12 ^ uVar2) & uVar11 ^ uVar2) +
             (uVar3 >> 6 | uVar3 << 0x1a);
    uVar10 = uVar10 + iVar13;
    uVar7 = ((uVar5 ^ uVar9) & uVar19) + (uVar5 & uVar9) + iVar13 + (uVar4 >> 2 | uVar4 << 0x1e);
    uVar6 = param_2[7];
    local_a4 = uVar6 >> 0x18 | (uVar6 & 0xff0000) >> 8 | (uVar6 & 0xff00) << 8 | uVar6 << 0x18;
    uVar6 = (uVar10 >> 0xe | uVar10 * 0x40000) ^ uVar10;
    uVar3 = (uVar7 >> 9 | uVar7 * 0x800000) ^ uVar7;
    uVar6 = (uVar6 >> 5 | uVar6 << 0x1b) ^ uVar10;
    uVar3 = (uVar3 >> 0xb | uVar3 << 0x15) ^ uVar7;
    iVar13 = local_a4 + uVar2 + -0x54e3a12b + ((uVar11 ^ uVar12) & uVar10 ^ uVar12) +
             (uVar6 >> 6 | uVar6 << 0x1a);
    uVar9 = uVar9 + iVar13;
    uVar14 = ((uVar19 ^ uVar5) & uVar7) + (uVar19 & uVar5) + iVar13 + (uVar3 >> 2 | uVar3 << 0x1e);
    uVar2 = param_2[8];
    local_a0 = uVar2 >> 0x18 | (uVar2 & 0xff0000) >> 8 | (uVar2 & 0xff00) << 8 | uVar2 << 0x18;
    uVar2 = (uVar9 >> 0xe | uVar9 * 0x40000) ^ uVar9;
    uVar6 = (uVar14 >> 9 | uVar14 * 0x800000) ^ uVar14;
    uVar2 = (uVar2 >> 5 | uVar2 << 0x1b) ^ uVar9;
    uVar6 = (uVar6 >> 0xb | uVar6 << 0x15) ^ uVar14;
    iVar13 = local_a0 + uVar12 + -0x27f85568 + ((uVar10 ^ uVar11) & uVar9 ^ uVar11) +
             (uVar2 >> 6 | uVar2 << 0x1a);
    uVar5 = uVar5 + iVar13;
    uVar15 = ((uVar7 ^ uVar19) & uVar14) + (uVar7 & uVar19) + iVar13 + (uVar6 >> 2 | uVar6 << 0x1e);
    uVar2 = param_2[9];
    local_9c = uVar2 >> 0x18 | (uVar2 & 0xff0000) >> 8 | (uVar2 & 0xff00) << 8 | uVar2 << 0x18;
    uVar2 = (uVar5 >> 0xe | uVar5 * 0x40000) ^ uVar5;
    uVar6 = (uVar15 >> 9 | uVar15 * 0x800000) ^ uVar15;
    uVar2 = (uVar2 >> 5 | uVar2 << 0x1b) ^ uVar5;
    uVar6 = (uVar6 >> 0xb | uVar6 << 0x15) ^ uVar15;
    iVar13 = local_9c + uVar11 + 0x12835b01 + ((uVar9 ^ uVar10) & uVar5 ^ uVar10) +
             (uVar2 >> 6 | uVar2 << 0x1a);
    uVar19 = uVar19 + iVar13;
    uVar16 = ((uVar14 ^ uVar7) & uVar15) + (uVar14 & uVar7) + iVar13 + (uVar6 >> 2 | uVar6 << 0x1e);
    uVar2 = param_2[10];
    local_98 = uVar2 >> 0x18 | (uVar2 & 0xff0000) >> 8 | (uVar2 & 0xff00) << 8 | uVar2 << 0x18;
    uVar2 = (uVar19 >> 0xe | uVar19 * 0x40000) ^ uVar19;
    uVar6 = (uVar16 >> 9 | uVar16 * 0x800000) ^ uVar16;
    uVar2 = (uVar2 >> 5 | uVar2 << 0x1b) ^ uVar19;
    uVar6 = (uVar6 >> 0xb | uVar6 << 0x15) ^ uVar16;
    iVar13 = local_98 + uVar10 + 0x243185be + ((uVar5 ^ uVar9) & uVar19 ^ uVar9) +
             (uVar2 >> 6 | uVar2 << 0x1a);
    uVar7 = uVar7 + iVar13;
    uVar17 = ((uVar15 ^ uVar14) & uVar16) + (uVar15 & uVar14) + iVar13 +
             (uVar6 >> 2 | uVar6 << 0x1e);
    uVar2 = param_2[0xb];
    local_94 = uVar2 >> 0x18 | (uVar2 & 0xff0000) >> 8 | (uVar2 & 0xff00) << 8 | uVar2 << 0x18;
    uVar2 = (uVar7 >> 0xe | uVar7 * 0x40000) ^ uVar7;
    uVar6 = (uVar17 >> 9 | uVar17 * 0x800000) ^ uVar17;
    uVar2 = (uVar2 >> 5 | uVar2 << 0x1b) ^ uVar7;
    uVar6 = (uVar6 >> 0xb | uVar6 << 0x15) ^ uVar17;
    iVar13 = local_94 + uVar9 + 0x550c7dc3 + ((uVar19 ^ uVar5) & uVar7 ^ uVar5) +
             (uVar2 >> 6 | uVar2 << 0x1a);
    uVar14 = uVar14 + iVar13;
    uVar18 = ((uVar16 ^ uVar15) & uVar17) + (uVar16 & uVar15) + iVar13 +
             (uVar6 >> 2 | uVar6 << 0x1e);
    uVar2 = param_2[0xc];
    local_90 = uVar2 >> 0x18 | (uVar2 & 0xff0000) >> 8 | (uVar2 & 0xff00) << 8 | uVar2 << 0x18;
    uVar2 = (uVar14 >> 0xe | uVar14 * 0x40000) ^ uVar14;
    uVar6 = (uVar18 >> 9 | uVar18 * 0x800000) ^ uVar18;
    uVar2 = (uVar2 >> 5 | uVar2 << 0x1b) ^ uVar14;
    uVar6 = (uVar6 >> 0xb | uVar6 << 0x15) ^ uVar18;
    iVar13 = local_90 + uVar5 + 0x72be5d74 + ((uVar7 ^ uVar19) & uVar14 ^ uVar19) +
             (uVar2 >> 6 | uVar2 << 0x1a);
    uVar15 = uVar15 + iVar13;
    uVar4 = ((uVar17 ^ uVar16) & uVar18) + (uVar17 & uVar16) + iVar13 + (uVar6 >> 2 | uVar6 << 0x1e)
    ;
    uVar2 = param_2[0xd];
    local_8c = uVar2 >> 0x18 | (uVar2 & 0xff0000) >> 8 | (uVar2 & 0xff00) << 8 | uVar2 << 0x18;
    uVar2 = (uVar15 >> 0xe | uVar15 * 0x40000) ^ uVar15;
    uVar6 = (uVar4 >> 9 | uVar4 * 0x800000) ^ uVar4;
    uVar2 = (uVar2 >> 5 | uVar2 << 0x1b) ^ uVar15;
    uVar6 = (uVar6 >> 0xb | uVar6 << 0x15) ^ uVar4;
    iVar13 = local_8c + uVar19 + -0x7f214e02 + ((uVar14 ^ uVar7) & uVar15 ^ uVar7) +
             (uVar2 >> 6 | uVar2 << 0x1a);
    uVar16 = uVar16 + iVar13;
    uVar3 = ((uVar18 ^ uVar17) & uVar4) + (uVar18 & uVar17) + iVar13 + (uVar6 >> 2 | uVar6 << 0x1e);
    uVar2 = param_2[0xe];
    local_88 = uVar2 >> 0x18 | (uVar2 & 0xff0000) >> 8 | (uVar2 & 0xff00) << 8 | uVar2 << 0x18;
    uVar2 = (uVar16 >> 0xe | uVar16 * 0x40000) ^ uVar16;
    uVar6 = (uVar3 >> 9 | uVar3 * 0x800000) ^ uVar3;
    uVar2 = (uVar2 >> 5 | uVar2 << 0x1b) ^ uVar16;
    uVar6 = (uVar6 >> 0xb | uVar6 << 0x15) ^ uVar3;
    iVar13 = local_88 + uVar7 + -0x6423f959 + ((uVar15 ^ uVar14) & uVar16 ^ uVar14) +
             (uVar2 >> 6 | uVar2 << 0x1a);
    uVar17 = uVar17 + iVar13;
    uVar6 = ((uVar4 ^ uVar18) & uVar3) + (uVar4 & uVar18) + iVar13 + (uVar6 >> 2 | uVar6 << 0x1e);
    uVar2 = param_2[0xf];
    local_84 = uVar2 >> 0x18 | (uVar2 & 0xff0000) >> 8 | (uVar2 & 0xff00) << 8 | uVar2 << 0x18;
    uVar2 = (uVar17 >> 0xe | uVar17 * 0x40000) ^ uVar17;
    uVar19 = (uVar6 >> 9 | uVar6 * 0x800000) ^ uVar6;
    uVar2 = (uVar2 >> 5 | uVar2 << 0x1b) ^ uVar17;
    uVar19 = (uVar19 >> 0xb | uVar19 << 0x15) ^ uVar6;
    iVar13 = local_84 + uVar14 + -0x3e640e8c + ((uVar16 ^ uVar15) & uVar17 ^ uVar15) +
             (uVar2 >> 6 | uVar2 << 0x1a);
    uVar18 = uVar18 + iVar13;
    uVar8 = 0x10;
    uVar2 = ((uVar3 ^ uVar4) & uVar6) + (uVar3 & uVar4) + iVar13 + (uVar19 >> 2 | uVar19 << 0x1e);
    do {
      uVar14 = (local_bc >> 0xb | local_bc << 0x15) ^ local_bc;
      uVar19 = (local_88 >> 2 | local_88 << 0x1e) ^ local_88;
      local_c0 = local_9c + (local_bc >> 3 ^ (uVar14 >> 7 | uVar14 << 0x19)) + local_c0 +
                 (local_88 >> 10 ^ (uVar19 >> 0x11 | uVar19 << 0xf));
      uVar14 = (uVar18 >> 0xe | uVar18 << 0x12) ^ uVar18;
      uVar19 = (uVar2 >> 9 | uVar2 << 0x17) ^ uVar2;
      uVar14 = (uVar14 >> 5 | uVar14 << 0x1b) ^ uVar18;
      uVar19 = (uVar19 >> 0xb | uVar19 << 0x15) ^ uVar2;
      iVar13 = local_c0 + uVar15 + (&K256)[uVar8] + ((uVar17 ^ uVar16) & uVar18 ^ uVar16) +
               (uVar14 >> 6 | uVar14 << 0x1a);
      uVar4 = uVar4 + iVar13;
      uVar15 = ((uVar6 ^ uVar3) & uVar2) + (uVar6 & uVar3) + iVar13 + (uVar19 >> 2 | uVar19 << 0x1e)
      ;
      uVar14 = (local_b8 >> 0xb | local_b8 << 0x15) ^ local_b8;
      uVar19 = (local_84 >> 2 | local_84 << 0x1e) ^ local_84;
      local_bc = local_98 + (local_b8 >> 3 ^ (uVar14 >> 7 | uVar14 << 0x19)) + local_bc +
                 (local_84 >> 10 ^ (uVar19 >> 0x11 | uVar19 << 0xf));
      uVar14 = (uVar4 >> 0xe | uVar4 * 0x40000) ^ uVar4;
      uVar19 = (uVar15 >> 9 | uVar15 * 0x800000) ^ uVar15;
      uVar14 = (uVar14 >> 5 | uVar14 << 0x1b) ^ uVar4;
      uVar19 = (uVar19 >> 0xb | uVar19 << 0x15) ^ uVar15;
      iVar13 = local_bc + uVar16 + (&K256)[uVar8 + 1] + ((uVar18 ^ uVar17) & uVar4 ^ uVar17) +
               (uVar14 >> 6 | uVar14 << 0x1a);
      uVar3 = uVar3 + iVar13;
      uVar16 = ((uVar2 ^ uVar6) & uVar15) + (uVar2 & uVar6) + iVar13 +
               (uVar19 >> 2 | uVar19 << 0x1e);
      uVar14 = (local_b4 >> 0xb | local_b4 << 0x15) ^ local_b4;
      uVar19 = (local_c0 >> 2 | local_c0 * 0x40000000) ^ local_c0;
      local_b8 = local_94 + (local_b4 >> 3 ^ (uVar14 >> 7 | uVar14 << 0x19)) + local_b8 +
                 (local_c0 >> 10 ^ (uVar19 >> 0x11 | uVar19 << 0xf));
      uVar14 = (uVar3 >> 0xe | uVar3 * 0x40000) ^ uVar3;
      uVar19 = (uVar16 >> 9 | uVar16 * 0x800000) ^ uVar16;
      uVar14 = (uVar14 >> 5 | uVar14 << 0x1b) ^ uVar3;
      uVar19 = (uVar19 >> 0xb | uVar19 << 0x15) ^ uVar16;
      iVar13 = local_b8 + uVar17 + (&K256)[uVar8 + 2] + ((uVar4 ^ uVar18) & uVar3 ^ uVar18) +
               (uVar14 >> 6 | uVar14 << 0x1a);
      uVar6 = uVar6 + iVar13;
      uVar17 = ((uVar15 ^ uVar2) & uVar16) + (uVar15 & uVar2) + iVar13 +
               (uVar19 >> 2 | uVar19 << 0x1e);
      uVar14 = (local_b0 >> 0xb | local_b0 << 0x15) ^ local_b0;
      uVar19 = (local_bc >> 2 | local_bc * 0x40000000) ^ local_bc;
      local_b4 = local_90 + (local_b0 >> 3 ^ (uVar14 >> 7 | uVar14 << 0x19)) + local_b4 +
                 (local_bc >> 10 ^ (uVar19 >> 0x11 | uVar19 << 0xf));
      uVar14 = (uVar6 >> 0xe | uVar6 * 0x40000) ^ uVar6;
      uVar19 = (uVar17 >> 9 | uVar17 * 0x800000) ^ uVar17;
      uVar14 = (uVar14 >> 5 | uVar14 << 0x1b) ^ uVar6;
      uVar19 = (uVar19 >> 0xb | uVar19 << 0x15) ^ uVar17;
      iVar13 = local_b4 + uVar18 + (&K256)[uVar8 + 3] + ((uVar3 ^ uVar4) & uVar6 ^ uVar4) +
               (uVar14 >> 6 | uVar14 << 0x1a);
      uVar2 = uVar2 + iVar13;
      uVar18 = ((uVar16 ^ uVar15) & uVar17) + (uVar16 & uVar15) + iVar13 +
               (uVar19 >> 2 | uVar19 << 0x1e);
      uVar14 = (local_ac >> 0xb | local_ac << 0x15) ^ local_ac;
      uVar19 = (local_b8 >> 2 | local_b8 * 0x40000000) ^ local_b8;
      local_b0 = local_8c + (local_ac >> 3 ^ (uVar14 >> 7 | uVar14 << 0x19)) + local_b0 +
                 (local_b8 >> 10 ^ (uVar19 >> 0x11 | uVar19 << 0xf));
      uVar14 = (uVar2 >> 0xe | uVar2 * 0x40000) ^ uVar2;
      uVar19 = (uVar18 >> 9 | uVar18 * 0x800000) ^ uVar18;
      uVar14 = (uVar14 >> 5 | uVar14 << 0x1b) ^ uVar2;
      uVar19 = (uVar19 >> 0xb | uVar19 << 0x15) ^ uVar18;
      iVar13 = local_b0 + uVar4 + (&K256)[uVar8 + 4] + ((uVar6 ^ uVar3) & uVar2 ^ uVar3) +
               (uVar14 >> 6 | uVar14 << 0x1a);
      uVar15 = uVar15 + iVar13;
      uVar4 = ((uVar17 ^ uVar16) & uVar18) + (uVar17 & uVar16) + iVar13 +
              (uVar19 >> 2 | uVar19 << 0x1e);
      uVar14 = (local_a8 >> 0xb | local_a8 << 0x15) ^ local_a8;
      uVar19 = (local_b4 >> 2 | local_b4 * 0x40000000) ^ local_b4;
      local_ac = local_88 + (local_a8 >> 3 ^ (uVar14 >> 7 | uVar14 << 0x19)) + local_ac +
                 (local_b4 >> 10 ^ (uVar19 >> 0x11 | uVar19 << 0xf));
      uVar14 = (uVar15 >> 0xe | uVar15 * 0x40000) ^ uVar15;
      uVar19 = (uVar4 >> 9 | uVar4 * 0x800000) ^ uVar4;
      uVar14 = (uVar14 >> 5 | uVar14 << 0x1b) ^ uVar15;
      uVar19 = (uVar19 >> 0xb | uVar19 << 0x15) ^ uVar4;
      iVar13 = local_ac + uVar3 + (&K256)[uVar8 + 5] + ((uVar2 ^ uVar6) & uVar15 ^ uVar6) +
               (uVar14 >> 6 | uVar14 << 0x1a);
      uVar16 = uVar16 + iVar13;
      uVar3 = ((uVar18 ^ uVar17) & uVar4) + (uVar18 & uVar17) + iVar13 +
              (uVar19 >> 2 | uVar19 << 0x1e);
      uVar14 = (local_a4 >> 0xb | local_a4 << 0x15) ^ local_a4;
      uVar19 = (local_b0 >> 2 | local_b0 * 0x40000000) ^ local_b0;
      local_a8 = local_84 + (local_a4 >> 3 ^ (uVar14 >> 7 | uVar14 << 0x19)) + local_a8 +
                 (local_b0 >> 10 ^ (uVar19 >> 0x11 | uVar19 << 0xf));
      uVar14 = (uVar16 >> 0xe | uVar16 * 0x40000) ^ uVar16;
      uVar19 = (uVar3 >> 9 | uVar3 * 0x800000) ^ uVar3;
      uVar14 = (uVar14 >> 5 | uVar14 << 0x1b) ^ uVar16;
      uVar19 = (uVar19 >> 0xb | uVar19 << 0x15) ^ uVar3;
      iVar13 = local_a8 + uVar6 + (&K256)[uVar8 + 6] + ((uVar15 ^ uVar2) & uVar16 ^ uVar2) +
               (uVar14 >> 6 | uVar14 << 0x1a);
      uVar17 = uVar17 + iVar13;
      uVar6 = ((uVar4 ^ uVar18) & uVar3) + (uVar4 & uVar18) + iVar13 +
              (uVar19 >> 2 | uVar19 << 0x1e);
      uVar14 = (local_a0 >> 0xb | local_a0 << 0x15) ^ local_a0;
      uVar19 = (local_ac >> 2 | local_ac * 0x40000000) ^ local_ac;
      local_a4 = local_c0 + (local_a0 >> 3 ^ (uVar14 >> 7 | uVar14 << 0x19)) + local_a4 +
                 (local_ac >> 10 ^ (uVar19 >> 0x11 | uVar19 << 0xf));
      uVar14 = (uVar17 >> 0xe | uVar17 * 0x40000) ^ uVar17;
      uVar19 = (uVar6 >> 9 | uVar6 * 0x800000) ^ uVar6;
      uVar14 = (uVar14 >> 5 | uVar14 << 0x1b) ^ uVar17;
      uVar19 = (uVar19 >> 0xb | uVar19 << 0x15) ^ uVar6;
      iVar13 = local_a4 + uVar2 + (&K256)[uVar8 + 7] + ((uVar16 ^ uVar15) & uVar17 ^ uVar15) +
               (uVar14 >> 6 | uVar14 << 0x1a);
      uVar18 = uVar18 + iVar13;
      uVar2 = ((uVar3 ^ uVar4) & uVar6) + (uVar3 & uVar4) + iVar13 + (uVar19 >> 2 | uVar19 << 0x1e);
      uVar14 = (local_9c >> 0xb | local_9c << 0x15) ^ local_9c;
      uVar19 = (local_a8 >> 2 | local_a8 * 0x40000000) ^ local_a8;
      local_a0 = local_bc + (local_9c >> 3 ^ (uVar14 >> 7 | uVar14 << 0x19)) + local_a0 +
                 (local_a8 >> 10 ^ (uVar19 >> 0x11 | uVar19 << 0xf));
      uVar14 = (uVar18 >> 0xe | uVar18 * 0x40000) ^ uVar18;
      uVar19 = (uVar2 >> 9 | uVar2 * 0x800000) ^ uVar2;
      uVar14 = (uVar14 >> 5 | uVar14 << 0x1b) ^ uVar18;
      uVar19 = (uVar19 >> 0xb | uVar19 << 0x15) ^ uVar2;
      iVar13 = local_a0 + uVar15 + (&K256)[uVar8 + 8] + ((uVar17 ^ uVar16) & uVar18 ^ uVar16) +
               (uVar14 >> 6 | uVar14 << 0x1a);
      uVar4 = uVar4 + iVar13;
      uVar15 = ((uVar6 ^ uVar3) & uVar2) + (uVar6 & uVar3) + iVar13 + (uVar19 >> 2 | uVar19 << 0x1e)
      ;
      uVar14 = (local_98 >> 0xb | local_98 << 0x15) ^ local_98;
      uVar19 = (local_a4 >> 2 | local_a4 * 0x40000000) ^ local_a4;
      local_9c = local_b8 + (local_98 >> 3 ^ (uVar14 >> 7 | uVar14 << 0x19)) + local_9c +
                 (local_a4 >> 10 ^ (uVar19 >> 0x11 | uVar19 << 0xf));
      uVar14 = (uVar4 >> 0xe | uVar4 * 0x40000) ^ uVar4;
      uVar19 = (uVar15 >> 9 | uVar15 * 0x800000) ^ uVar15;
      uVar14 = (uVar14 >> 5 | uVar14 << 0x1b) ^ uVar4;
      uVar19 = (uVar19 >> 0xb | uVar19 << 0x15) ^ uVar15;
      iVar13 = local_9c + uVar16 + (&K256)[uVar8 + 9] + ((uVar18 ^ uVar17) & uVar4 ^ uVar17) +
               (uVar14 >> 6 | uVar14 << 0x1a);
      uVar3 = uVar3 + iVar13;
      uVar16 = ((uVar2 ^ uVar6) & uVar15) + (uVar2 & uVar6) + iVar13 +
               (uVar19 >> 2 | uVar19 << 0x1e);
      uVar14 = (local_94 >> 0xb | local_94 << 0x15) ^ local_94;
      uVar19 = (local_a0 >> 2 | local_a0 * 0x40000000) ^ local_a0;
      local_98 = local_b4 + (local_94 >> 3 ^ (uVar14 >> 7 | uVar14 << 0x19)) + local_98 +
                 (local_a0 >> 10 ^ (uVar19 >> 0x11 | uVar19 << 0xf));
      uVar14 = (uVar3 >> 0xe | uVar3 * 0x40000) ^ uVar3;
      uVar19 = (uVar16 >> 9 | uVar16 * 0x800000) ^ uVar16;
      uVar14 = (uVar14 >> 5 | uVar14 << 0x1b) ^ uVar3;
      uVar19 = (uVar19 >> 0xb | uVar19 << 0x15) ^ uVar16;
      iVar13 = local_98 + uVar17 + (&K256)[uVar8 + 10] + ((uVar4 ^ uVar18) & uVar3 ^ uVar18) +
               (uVar14 >> 6 | uVar14 << 0x1a);
      uVar6 = uVar6 + iVar13;
      uVar17 = ((uVar15 ^ uVar2) & uVar16) + (uVar15 & uVar2) + iVar13 +
               (uVar19 >> 2 | uVar19 << 0x1e);
      uVar14 = (local_90 >> 0xb | local_90 << 0x15) ^ local_90;
      uVar19 = (local_9c >> 2 | local_9c * 0x40000000) ^ local_9c;
      local_94 = local_b0 + (local_90 >> 3 ^ (uVar14 >> 7 | uVar14 << 0x19)) + local_94 +
                 (local_9c >> 10 ^ (uVar19 >> 0x11 | uVar19 << 0xf));
      uVar14 = (uVar6 >> 0xe | uVar6 * 0x40000) ^ uVar6;
      uVar19 = (uVar17 >> 9 | uVar17 * 0x800000) ^ uVar17;
      uVar14 = (uVar14 >> 5 | uVar14 << 0x1b) ^ uVar6;
      uVar19 = (uVar19 >> 0xb | uVar19 << 0x15) ^ uVar17;
      iVar13 = local_94 + uVar18 + (&K256)[uVar8 + 0xb] + ((uVar3 ^ uVar4) & uVar6 ^ uVar4) +
               (uVar14 >> 6 | uVar14 << 0x1a);
      uVar2 = uVar2 + iVar13;
      uVar18 = ((uVar16 ^ uVar15) & uVar17) + (uVar16 & uVar15) + iVar13 +
               (uVar19 >> 2 | uVar19 << 0x1e);
      uVar14 = (local_8c >> 0xb | local_8c << 0x15) ^ local_8c;
      uVar19 = (local_98 >> 2 | local_98 * 0x40000000) ^ local_98;
      local_90 = local_ac + (local_8c >> 3 ^ (uVar14 >> 7 | uVar14 << 0x19)) + local_90 +
                 (local_98 >> 10 ^ (uVar19 >> 0x11 | uVar19 << 0xf));
      uVar14 = (uVar2 >> 0xe | uVar2 * 0x40000) ^ uVar2;
      uVar19 = (uVar18 >> 9 | uVar18 * 0x800000) ^ uVar18;
      uVar14 = (uVar14 >> 5 | uVar14 << 0x1b) ^ uVar2;
      uVar19 = (uVar19 >> 0xb | uVar19 << 0x15) ^ uVar18;
      iVar13 = local_90 + uVar4 + (&K256)[uVar8 + 0xc] + ((uVar6 ^ uVar3) & uVar2 ^ uVar3) +
               (uVar14 >> 6 | uVar14 << 0x1a);
      uVar15 = uVar15 + iVar13;
      uVar4 = ((uVar17 ^ uVar16) & uVar18) + (uVar17 & uVar16) + iVar13 +
              (uVar19 >> 2 | uVar19 << 0x1e);
      uVar14 = (local_88 >> 0xb | local_88 << 0x15) ^ local_88;
      uVar19 = (local_94 >> 2 | local_94 * 0x40000000) ^ local_94;
      local_8c = local_a8 + (local_88 >> 3 ^ (uVar14 >> 7 | uVar14 << 0x19)) + local_8c +
                 (local_94 >> 10 ^ (uVar19 >> 0x11 | uVar19 << 0xf));
      uVar14 = (uVar15 >> 0xe | uVar15 * 0x40000) ^ uVar15;
      uVar19 = (uVar4 >> 9 | uVar4 * 0x800000) ^ uVar4;
      uVar14 = (uVar14 >> 5 | uVar14 << 0x1b) ^ uVar15;
      uVar19 = (uVar19 >> 0xb | uVar19 << 0x15) ^ uVar4;
      iVar13 = local_8c + uVar3 + (&K256)[uVar8 + 0xd] + ((uVar2 ^ uVar6) & uVar15 ^ uVar6) +
               (uVar14 >> 6 | uVar14 << 0x1a);
      uVar16 = uVar16 + iVar13;
      uVar3 = ((uVar18 ^ uVar17) & uVar4) + (uVar18 & uVar17) + iVar13 +
              (uVar19 >> 2 | uVar19 << 0x1e);
      uVar14 = (local_84 >> 0xb | local_84 << 0x15) ^ local_84;
      uVar19 = (local_90 >> 2 | local_90 * 0x40000000) ^ local_90;
      local_88 = local_a4 + (local_84 >> 3 ^ (uVar14 >> 7 | uVar14 << 0x19)) + local_88 +
                 (local_90 >> 10 ^ (uVar19 >> 0x11 | uVar19 << 0xf));
      uVar14 = (uVar16 >> 0xe | uVar16 * 0x40000) ^ uVar16;
      uVar19 = (uVar3 >> 9 | uVar3 * 0x800000) ^ uVar3;
      uVar14 = (uVar14 >> 5 | uVar14 << 0x1b) ^ uVar16;
      uVar19 = (uVar19 >> 0xb | uVar19 << 0x15) ^ uVar3;
      iVar13 = local_88 + uVar6 + (&K256)[uVar8 + 0xe] + ((uVar15 ^ uVar2) & uVar16 ^ uVar2) +
               (uVar14 >> 6 | uVar14 << 0x1a);
      uVar17 = uVar17 + iVar13;
      uVar6 = ((uVar4 ^ uVar18) & uVar3) + (uVar4 & uVar18) + iVar13 +
              (uVar19 >> 2 | uVar19 << 0x1e);
      uVar14 = (local_c0 >> 0xb | local_c0 * 0x200000) ^ local_c0;
      uVar19 = (local_8c >> 2 | local_8c * 0x40000000) ^ local_8c;
      local_84 = local_a0 + (local_c0 >> 3 ^ (uVar14 >> 7 | uVar14 << 0x19)) + local_84 +
                 (local_8c >> 10 ^ (uVar19 >> 0x11 | uVar19 << 0xf));
      uVar14 = (uVar17 >> 0xe | uVar17 * 0x40000) ^ uVar17;
      uVar19 = (uVar6 >> 9 | uVar6 * 0x800000) ^ uVar6;
      uVar14 = (uVar14 >> 5 | uVar14 << 0x1b) ^ uVar17;
      uVar19 = (uVar19 >> 0xb | uVar19 << 0x15) ^ uVar6;
      iVar13 = local_84 + uVar2 + (&K256)[uVar8 + 0xf] + ((uVar16 ^ uVar15) & uVar17 ^ uVar15) +
               (uVar14 >> 6 | uVar14 << 0x1a);
      uVar18 = uVar18 + iVar13;
      uVar8 = uVar8 + 0x10;
      uVar2 = ((uVar3 ^ uVar4) & uVar6) + (uVar3 & uVar4) + iVar13 + (uVar19 >> 2 | uVar19 << 0x1e);
    } while (uVar8 < 0x40);
    param_2 = param_2 + 0x10;
    uVar2 = uVar2 + *param_1;
    uVar6 = uVar6 + param_1[1];
    uVar3 = uVar3 + param_1[2];
    uVar4 = uVar4 + param_1[3];
    uVar18 = uVar18 + param_1[4];
    uVar17 = uVar17 + param_1[5];
    uVar16 = uVar16 + param_1[6];
    uVar15 = uVar15 + param_1[7];
    *param_1 = uVar2;
    param_1[1] = uVar6;
    param_1[2] = uVar3;
    param_1[3] = uVar4;
    param_1[4] = uVar18;
    param_1[5] = uVar17;
    param_1[6] = uVar16;
    param_1[7] = uVar15;
  } while (param_2 < puVar1);
  return;
}



long OPENSSL_atomic_add(int *param_1,int param_2)

{
  int iVar1;
  int iVar2;
  int iVar3;
  bool bVar4;
  
  iVar3 = *param_1;
  do {
    iVar1 = param_2 + iVar3;
    LOCK();
    iVar2 = *param_1;
    bVar4 = iVar3 == iVar2;
    if (bVar4) {
      *param_1 = iVar1;
      iVar2 = iVar3;
    }
    iVar3 = iVar2;
    UNLOCK();
  } while (!bVar4);
  return (long)iVar1;
}



ulong OPENSSL_rdtsc(void)

{
  ulong uVar1;
  undefined8 in_RAX;
  
  uVar1 = rdtsc();
  return CONCAT44((int)((ulong)in_RAX >> 0x20),(int)uVar1) | uVar1 & 0xffffffff00000000;
}



// WARNING: Removing unreachable block (ram,0x0048d18a)
// WARNING: Removing unreachable block (ram,0x0048d17c)
// WARNING: Removing unreachable block (ram,0x0048d1d1)
// WARNING: Removing unreachable block (ram,0x0048d1bc)
// WARNING: Removing unreachable block (ram,0x0048d162)
// WARNING: Removing unreachable block (ram,0x0048d151)
// WARNING: Removing unreachable block (ram,0x0048d0f5)

undefined1  [16] OPENSSL_ia32_cpuid(void)

{
  uint *puVar1;
  uint *puVar2;
  long lVar3;
  long lVar4;
  undefined4 *puVar5;
  uint uVar6;
  uint uVar7;
  ulong uVar8;
  ulong uVar9;
  uint uVar10;
  uint uVar11;
  uint in_XCR0;
  uint in_register_00000604;
  undefined1 auVar12 [16];
  
  puVar1 = (uint *)cpuid_basic_info(0);
  uVar10 = (uint)((puVar1[1] != 0x756e6547 || puVar1[2] != 0x49656e69) || puVar1[3] != 0x6c65746e);
  if ((uVar10 != 0) &&
     ((puVar1[1] == 0x68747541 && puVar1[2] == 0x69746e65) && puVar1[3] == 0x444d4163)) {
    puVar2 = (uint *)cpuid(0x80000000);
    if (0x80000000 < *puVar2) {
      lVar3 = cpuid(0x80000001);
      uVar10 = uVar10 | *(uint *)(lVar3 + 0xc) & 0x801;
      if (0x80000007 < *puVar2) {
        lVar3 = cpuid(0x80000008);
        lVar4 = cpuid_Version_info(1);
        uVar11 = *(uint *)(lVar4 + 8);
        uVar8 = (ulong)uVar11;
        uVar6 = *(uint *)(lVar4 + 0xc);
        if (((uVar11 >> 0x1c & 1) != 0) &&
           ((byte)((uint)*(undefined4 *)(lVar4 + 4) >> 0x10) <=
            (byte)((char)*(undefined4 *)(lVar3 + 0xc) + 1U))) {
          uVar8 = (ulong)(uVar11 & 0xefffffff);
        }
        goto LAB_0048d219;
      }
    }
  }
  uVar11 = 0xffffffff;
  if (3 < *puVar1) {
    puVar1 = (uint *)cpuid_Deterministic_Cache_Parameters_info(4);
    uVar11 = *puVar1 >> 0xe & 0xfff;
  }
  puVar5 = (undefined4 *)cpuid_Version_info(1);
  uVar6 = puVar5[3];
  uVar7 = puVar5[2] & 0xbfefffff;
  uVar8 = (ulong)uVar7;
  if ((uVar10 == 0) &&
     (uVar8 = (ulong)(uVar7 | 0x40000000), ((byte)((uint)*puVar5 >> 8) & 0xf) == 0xf)) {
    uVar8 = (ulong)(uVar7 | 0x40100000);
  }
  if (((uint)uVar8 >> 0x1c & 1) != 0) {
    uVar7 = (uint)uVar8 & 0xefffffff;
    uVar8 = (ulong)uVar7;
    if ((uVar11 != 0) && (uVar8 = (ulong)(uVar7 | 0x10000000), (byte)((uint)puVar5[1] >> 0x10) < 2))
    {
      uVar8 = (ulong)uVar7;
    }
  }
LAB_0048d219:
  uVar10 = uVar10 & 0x800 | uVar6 & 0xfffff7ff;
  uVar9 = uVar8;
  if (((uVar6 & 0x8000000) == 0) || (uVar9 = (ulong)in_register_00000604, (in_XCR0 & 6) != 6)) {
    uVar10 = uVar6 & 0xefffe7ff;
  }
  auVar12._0_8_ = uVar8 | (ulong)uVar10 << 0x20;
  auVar12._8_8_ = uVar9;
  return auVar12;
}



void OPENSSL_cleanse(void *ptr,size_t len)

{
  if (len < 0xf) {
    if (len == 0) {
      return;
    }
  }
  else {
    for (; ((ulong)ptr & 7) != 0; ptr = (void *)((long)ptr + 1)) {
      *(undefined1 *)ptr = 0;
      len = len - 1;
    }
    do {
      *(undefined8 *)ptr = 0;
      len = len - 8;
      ptr = (void *)((long)ptr + 8);
    } while ((len & 0xfffffffffffffff8) != 0);
    if (len == 0) {
      return;
    }
  }
  do {
    *(undefined1 *)ptr = 0;
    len = len - 1;
    ptr = (void *)((long)ptr + 1);
  } while (len != 0);
  return;
}



undefined1 * OPENSSL_wipe_cpu(void)

{
  return &stack0x00000008;
}



long OPENSSL_ia32_rdrand(void)

{
  long lVar1;
  long lVar2;
  bool bVar3;
  
  lVar2 = 8;
  do {
    lVar1 = rdrand();
    bVar3 = (bool)rdrandIsValid();
    if (bVar3) break;
    lVar2 = lVar2 + -1;
  } while (lVar2 != 0);
  if (lVar1 == 0) {
    lVar1 = lVar2;
  }
  return lVar1;
}



int CRYPTO_get_new_lockid(char *name)

{
  int iVar1;
  char *data;
  
  if (app_locks == (_STACK *)0x0) {
    app_locks = sk_new_null();
    iVar1 = 0xd7;
    if (app_locks == (_STACK *)0x0) goto LAB_0048d3c8;
  }
  data = BUF_strdup(name);
  if (data != (char *)0x0) {
    iVar1 = sk_push(app_locks,data);
    if (iVar1 != 0) {
      return iVar1 + 0x29;
    }
    CRYPTO_free(data);
    return 0;
  }
  iVar1 = 0xdc;
LAB_0048d3c8:
  ERR_put_error(0xf,0x65,0x41,"cryptlib.c",iVar1);
  return 0;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

int CRYPTO_num_locks(void)

{
  return 0x29;
}



CRYPTO_dynlock_value * CRYPTO_get_dynlock_create_callback(char *file,int line)

{
  return dynlock_create_callback;
}



void CRYPTO_get_dynlock_lock_callback(int mode,CRYPTO_dynlock_value *l,char *file,int line)

{
  return;
}



void CRYPTO_get_dynlock_destroy_callback(CRYPTO_dynlock_value *l,char *file,int line)

{
  return;
}



void CRYPTO_set_dynlock_create_callback(dyn_create_function *dyn_create_function)

{
  dynlock_create_callback = dyn_create_function;
  return;
}



void CRYPTO_set_dynlock_lock_callback(dyn_lock_function *dyn_lock_function)

{
  dynlock_lock_callback = dyn_lock_function;
  return;
}



void CRYPTO_set_dynlock_destroy_callback(dyn_destroy_function *dyn_destroy_function)

{
  dynlock_destroy_callback = dyn_destroy_function;
  return;
}



void CRYPTO_get_locking_callback(int mode,int type,char *file,int line)

{
  return;
}



int CRYPTO_get_add_lock_callback(int *num,int mount,int type,char *file,int line)

{
  return (int)add_lock_callback;
}



void CRYPTO_set_locking_callback(func *func)

{
  OPENSSL_init();
  locking_callback = func;
  return;
}



void CRYPTO_set_add_lock_callback(func *func)

{
  add_lock_callback = func;
  return;
}



void CRYPTO_THREADID_set_numeric(CRYPTO_THREADID *id,ulong val)

{
  id->ptr = (void *)0x0;
  id->val = val;
  return;
}



void CRYPTO_THREADID_set_pointer(CRYPTO_THREADID *id,void *ptr)

{
  id->ptr = ptr;
  id->val = (ulong)ptr;
  return;
}



int CRYPTO_THREADID_set_callback(threadid_func *threadid_func)

{
  if (threadid_callback != (threadid_func *)0x0) {
    return 0;
  }
  threadid_callback = threadid_func;
  return 1;
}



void CRYPTO_THREADID_get_callback(CRYPTO_THREADID *param_1)

{
  return;
}



void CRYPTO_THREADID_current(CRYPTO_THREADID *id)

{
  ulong uVar1;
  int *piVar2;
  
  if (threadid_callback != (code *)0x0) {
                    // WARNING: Could not recover jumptable at 0x0048d51c. Too many branches
                    // WARNING: Treating indirect jump as call
    (*threadid_callback)();
    return;
  }
  if (id_callback == (code *)0x0) {
    piVar2 = __errno_location();
    id->ptr = piVar2;
    id->val = (ulong)piVar2;
  }
  else {
    uVar1 = (*id_callback)();
    id->ptr = (void *)0x0;
    id->val = uVar1;
  }
  return;
}



int CRYPTO_THREADID_cmp(CRYPTO_THREADID *a,CRYPTO_THREADID *b)

{
  int iVar1;
  
  iVar1 = memcmp(a,b,0x10);
  return iVar1;
}



void CRYPTO_THREADID_cpy(CRYPTO_THREADID *dest,CRYPTO_THREADID *src)

{
  dest->ptr = src->ptr;
  dest->val = src->val;
  return;
}



ulong CRYPTO_THREADID_hash(CRYPTO_THREADID *id)

{
  return id->val;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

ulong CRYPTO_get_id_callback(void)

{
  return id_callback;
}



void CRYPTO_set_id_callback(func *func)

{
  id_callback = func;
  return;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

ulong CRYPTO_thread_id(void)

{
  __pid_t _Var1;
  ulong uVar2;
  
  if (id_callback != (code *)0x0) {
                    // WARNING: Could not recover jumptable at 0x0048d5cc. Too many branches
                    // WARNING: Treating indirect jump as call
    uVar2 = (*id_callback)();
    return uVar2;
  }
  _Var1 = getpid();
  return (long)_Var1;
}



char * CRYPTO_get_lock_name(int type)

{
  int iVar1;
  char *pcVar2;
  
  if (type < 0) {
    return "dynamic";
  }
  if (type < 0x29) {
    return *(char **)(lock_names + (long)type * 8);
  }
  iVar1 = sk_num(app_locks);
  if (iVar1 < type + -0x29) {
    return "ERROR";
  }
  pcVar2 = (char *)sk_value(app_locks,type + -0x29);
  return pcVar2;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

ulong * OPENSSL_ia32cap_loc(void)

{
  return &OPENSSL_ia32cap_P;
}



void OPENSSL_cpuid_setup(void)

{
  char cVar1;
  int iVar2;
  char *pcVar3;
  ulong uVar4;
  ulong local_28 [3];
  
  if (trigger_5147 != 0) {
    return;
  }
  trigger_5147 = 1;
  pcVar3 = getenv("OPENSSL_ia32cap");
  if (pcVar3 == (char *)0x0) {
    local_28[0] = OPENSSL_ia32_cpuid();
  }
  else {
    cVar1 = *pcVar3;
    iVar2 = __isoc99_sscanf(pcVar3 + (cVar1 == '~'),&DAT_004d56ee,local_28);
    if (iVar2 == 0) {
      local_28[0] = strtoul(pcVar3 + (cVar1 == '~'),(char **)0x0,0);
    }
    if (cVar1 == '~') {
      uVar4 = OPENSSL_ia32_cpuid();
      local_28[0] = uVar4 & ~local_28[0];
    }
  }
  OPENSSL_ia32cap_P._4_4_ = (int)(local_28[0] >> 0x20);
  OPENSSL_ia32cap_P._0_4_ = (uint)local_28[0] | 0x400;
  return;
}



void OPENSSL_showfatal(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4,
                      undefined8 param_5,undefined8 param_6,undefined8 param_7,undefined8 param_8,
                      char *param_9,undefined8 param_10,undefined8 param_11,undefined8 param_12,
                      undefined8 param_13,undefined8 param_14)

{
  char in_AL;
  undefined4 local_d0;
  undefined4 local_cc;
  undefined1 *local_c8;
  undefined1 *local_c0;
  undefined1 local_b8 [8];
  undefined8 local_b0;
  undefined8 local_a8;
  undefined8 local_a0;
  undefined8 local_98;
  undefined8 local_90;
  undefined8 local_88;
  undefined8 local_78;
  undefined8 local_68;
  undefined8 local_58;
  undefined8 local_48;
  undefined8 local_38;
  undefined8 local_28;
  undefined8 local_18;
  
  if (in_AL != '\0') {
    local_88 = param_1;
    local_78 = param_2;
    local_68 = param_3;
    local_58 = param_4;
    local_48 = param_5;
    local_38 = param_6;
    local_28 = param_7;
    local_18 = param_8;
  }
  local_c8 = &stack0x00000008;
  local_c0 = local_b8;
  local_d0 = 8;
  local_cc = 0x30;
  local_b0 = param_10;
  local_a8 = param_11;
  local_a0 = param_12;
  local_98 = param_13;
  local_90 = param_14;
  vfprintf(stderr,param_9,&local_d0);
  return;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

int OPENSSL_isservice(void)

{
  return 0;
}



void OpenSSLDie(char *file,int line,char *assertion)

{
  OPENSSL_showfatal("%s(%d): OpenSSL internal error, assertion failed: %s\n",file,line,assertion);
                    // WARNING: Subroutine does not return
  abort();
}



void CRYPTO_destroy_dynlockid(int i)

{
  int iVar1;
  int *ptr;
  
  if (i != 0) {
    i = ~i;
  }
  if (dynlock_destroy_callback != (code *)0x0) {
    if (locking_callback != (code *)0x0) {
      (*locking_callback)(9,0x1d,"cryptlib.c",0x131);
    }
    if ((dyn_locks != (_STACK *)0x0) && (iVar1 = sk_num(dyn_locks), i < iVar1)) {
      ptr = (int *)sk_value(dyn_locks,i);
      if ((ptr == (int *)0x0) || (iVar1 = *ptr, *ptr = iVar1 + -1, 0 < iVar1 + -1)) {
        ptr = (int *)0x0;
      }
      else {
        sk_set(dyn_locks,i,(void *)0x0);
      }
      if (locking_callback != (code *)0x0) {
        (*locking_callback)(10,0x1d,"cryptlib.c",0x14b);
      }
      if (ptr == (int *)0x0) {
        return;
      }
      (*dynlock_destroy_callback)(*(undefined8 *)(ptr + 2),"cryptlib.c",0x14f);
      CRYPTO_free(ptr);
      return;
    }
    if (locking_callback != (code *)0x0) {
                    // WARNING: Could not recover jumptable at 0x0048d850. Too many branches
                    // WARNING: Treating indirect jump as call
      (*locking_callback)(10,0x1d,"cryptlib.c",0x135);
      return;
    }
  }
  return;
}



CRYPTO_dynlock_value * CRYPTO_get_dynlock_value(int i)

{
  int iVar1;
  int *piVar2;
  
  if (i != 0) {
    i = ~i;
  }
  if (locking_callback != (code *)0x0) {
    (*locking_callback)(9,0x1d,"cryptlib.c",0x15a);
  }
  if (dyn_locks != (_STACK *)0x0) {
    iVar1 = sk_num(dyn_locks);
    if (i < iVar1) {
      piVar2 = (int *)sk_value(dyn_locks,i);
      if (piVar2 != (int *)0x0) {
        *piVar2 = *piVar2 + 1;
      }
      goto LAB_0048d935;
    }
  }
  piVar2 = (int *)0x0;
LAB_0048d935:
  if (locking_callback != (code *)0x0) {
    (*locking_callback)(10,0x1d,"cryptlib.c",0x161);
  }
  if (piVar2 != (int *)0x0) {
    return *(CRYPTO_dynlock_value **)(piVar2 + 2);
  }
  return (CRYPTO_dynlock_value *)0x0;
}



void CRYPTO_lock(int mode,int type,char *file,int line)

{
  CRYPTO_dynlock_value *pCVar1;
  
  if (type < 0) {
    if (dynlock_lock_callback != (code *)0x0) {
      pCVar1 = CRYPTO_get_dynlock_value(type);
      if (pCVar1 != (CRYPTO_dynlock_value *)0x0) {
        (*dynlock_lock_callback)(mode,pCVar1);
        CRYPTO_destroy_dynlockid(type);
        return;
      }
                    // WARNING: Subroutine does not return
      CRYPTO_lock_part_0();
    }
  }
  else if (locking_callback != (code *)0x0) {
                    // WARNING: Could not recover jumptable at 0x0048d9b0. Too many branches
                    // WARNING: Treating indirect jump as call
    (*locking_callback)();
    return;
  }
  return;
}



int CRYPTO_add_lock(int *pointer,int amount,int type,char *file,int line)

{
  code *pcVar1;
  int iVar2;
  CRYPTO_dynlock_value *pCVar3;
  bool bVar4;
  
  if (add_lock_callback != (code *)0x0) {
                    // WARNING: Could not recover jumptable at 0x0048da3b. Too many branches
                    // WARNING: Treating indirect jump as call
    iVar2 = (*add_lock_callback)();
    return iVar2;
  }
  if (type < 0) {
    if (dynlock_lock_callback != (code *)0x0) {
      pCVar3 = CRYPTO_get_dynlock_value(type);
      if (pCVar3 != (CRYPTO_dynlock_value *)0x0) {
        (*dynlock_lock_callback)(9,pCVar3,file,line);
        CRYPTO_destroy_dynlockid(type);
        iVar2 = amount + *pointer;
        bVar4 = dynlock_lock_callback == (code *)0x0;
        *pointer = iVar2;
        if (bVar4) {
          return iVar2;
        }
        pCVar3 = CRYPTO_get_dynlock_value(type);
        if (pCVar3 != (CRYPTO_dynlock_value *)0x0) {
          (*dynlock_lock_callback)(10,pCVar3,file,line);
          CRYPTO_destroy_dynlockid(type);
          return iVar2;
        }
      }
                    // WARNING: Subroutine does not return
      CRYPTO_lock_part_0();
    }
  }
  else if (locking_callback != (code *)0x0) {
    (*locking_callback)(9,type,file,line);
    pcVar1 = locking_callback;
    iVar2 = amount + *pointer;
    bVar4 = locking_callback == (code *)0x0;
    *pointer = iVar2;
    if (bVar4) {
      return iVar2;
    }
    (*pcVar1)(10,type,file,line);
    return iVar2;
  }
  iVar2 = *pointer;
  *pointer = amount + iVar2;
  return amount + iVar2;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

int CRYPTO_get_new_dynlockid(void)

{
  uint uVar1;
  uint uVar2;
  int iVar3;
  undefined4 *ptr;
  long lVar4;
  
  if (dynlock_create_callback == (code *)0x0) {
    ERR_put_error(0xf,0x67,100,"cryptlib.c",0xf3);
    return 0;
  }
  if (locking_callback != (code *)0x0) {
    (*locking_callback)(9,0x1d,"cryptlib.c",0xf6);
  }
  if (dyn_locks == (_STACK *)0x0) {
    dyn_locks = sk_new_null();
    if (dyn_locks == (_STACK *)0x0) {
      if (locking_callback != (code *)0x0) {
        (*locking_callback)(10,0x1d,"cryptlib.c",0xfa);
      }
      iVar3 = 0xfb;
      goto LAB_0048dd46;
    }
  }
  if (locking_callback != (code *)0x0) {
    (*locking_callback)(10,0x1d,"cryptlib.c",0xfe);
  }
  ptr = (undefined4 *)CRYPTO_malloc(0x10,"cryptlib.c",0x100);
  if (ptr == (undefined4 *)0x0) {
    iVar3 = 0x103;
  }
  else {
    *ptr = 1;
    lVar4 = (*dynlock_create_callback)("cryptlib.c");
    *(long *)(ptr + 2) = lVar4;
    if (lVar4 != 0) {
      if (locking_callback != (code *)0x0) {
        (*locking_callback)(9,0x1d,"cryptlib.c",0x10f);
      }
      uVar1 = sk_find(dyn_locks,(void *)0x0);
      if (uVar1 == 0xffffffff) {
        iVar3 = sk_push(dyn_locks,ptr);
        uVar1 = iVar3 - 1;
      }
      else {
        sk_set(dyn_locks,uVar1,ptr);
      }
      if (locking_callback != (code *)0x0) {
        (*locking_callback)(10,0x1d,"cryptlib.c",0x11d);
      }
      uVar2 = ~uVar1;
      if (uVar1 == 0xffffffff) {
        (*dynlock_destroy_callback)(*(undefined8 *)(ptr + 2),"cryptlib.c",0x121);
        CRYPTO_free(ptr);
        uVar2 = 1;
      }
      return uVar2;
    }
    CRYPTO_free(ptr);
    iVar3 = 0x10b;
  }
LAB_0048dd46:
  ERR_put_error(0xf,0x67,0x41,"cryptlib.c",iVar3);
  return 0;
}



undefined8 OPENSSL_stderr(void)

{
  return stderr;
}



int CRYPTO_memcmp(void *a,void *b,size_t len)

{
  byte *pbVar1;
  byte *pbVar2;
  long lVar3;
  long lVar4;
  uint uVar5;
  ulong uVar6;
  ulong uVar7;
  ulong uVar8;
  size_t sVar9;
  long lVar10;
  undefined1 auVar11 [16];
  byte local_38;
  
  if (len == 0) {
    uVar5 = 0;
  }
  else {
    uVar6 = (ulong)(-(int)a & 0xf);
    if (len < uVar6) {
      uVar6 = len;
    }
    sVar9 = len;
    if ((len < 0x13) || (sVar9 = uVar6, uVar6 != 0)) {
      uVar5 = 0;
      uVar6 = 0;
      do {
        pbVar1 = (byte *)((long)a + uVar6);
        pbVar2 = (byte *)((long)b + uVar6);
        uVar6 = uVar6 + 1;
        uVar5 = uVar5 | *pbVar1 ^ *pbVar2;
      } while (uVar6 != sVar9);
      if (len == uVar6) {
        return uVar5;
      }
    }
    else {
      sVar9 = 0;
      uVar5 = 0;
      uVar6 = 0;
    }
    uVar7 = len - sVar9 >> 4;
    if (uVar7 != 0) {
      auVar11 = (undefined1  [16])0x0;
      lVar10 = 0;
      uVar8 = 0;
      do {
        lVar4 = lVar10 + sVar9;
        uVar8 = uVar8 + 1;
        lVar3 = lVar10 + sVar9;
        lVar10 = lVar10 + 0x10;
        auVar11 = auVar11 | *(undefined1 (*) [16])((long)b + lVar4) ^
                            *(undefined1 (*) [16])((long)a + lVar3);
      } while (uVar8 < uVar7);
      uVar6 = uVar6 + uVar7 * 0x10;
      auVar11 = auVar11 | auVar11 >> 0x40;
      auVar11 = auVar11 | auVar11 >> 0x20;
      auVar11 = auVar11 | auVar11 >> 0x10;
      local_38 = auVar11[1] | auVar11[0];
      uVar5 = uVar5 | local_38;
      if (len - sVar9 == uVar7 * 0x10) {
        return uVar5;
      }
    }
    uVar5 = uVar5 | *(byte *)((long)a + uVar6) ^ *(byte *)((long)b + uVar6);
    if (((((uVar6 + 1 < len) &&
          (uVar5 = uVar5 | *(byte *)((long)b + uVar6 + 1) ^ *(byte *)((long)a + uVar6 + 1),
          uVar6 + 2 < len)) &&
         (uVar5 = uVar5 | *(byte *)((long)b + uVar6 + 2) ^ *(byte *)((long)a + uVar6 + 2),
         uVar6 + 3 < len)) &&
        ((((uVar5 = uVar5 | *(byte *)((long)b + uVar6 + 3) ^ *(byte *)((long)a + uVar6 + 3),
           uVar6 + 4 < len &&
           (uVar5 = uVar5 | *(byte *)((long)b + uVar6 + 4) ^ *(byte *)((long)a + uVar6 + 4),
           uVar6 + 5 < len)) &&
          ((uVar5 = uVar5 | *(byte *)((long)b + uVar6 + 5) ^ *(byte *)((long)a + uVar6 + 5),
           uVar6 + 6 < len &&
           ((uVar5 = uVar5 | *(byte *)((long)b + uVar6 + 6) ^ *(byte *)((long)a + uVar6 + 6),
            uVar6 + 7 < len &&
            (uVar5 = uVar5 | *(byte *)((long)b + uVar6 + 7) ^ *(byte *)((long)a + uVar6 + 7),
            uVar6 + 8 < len)))))) &&
         (uVar5 = uVar5 | *(byte *)((long)b + uVar6 + 8) ^ *(byte *)((long)a + uVar6 + 8),
         uVar6 + 9 < len)))) &&
       ((((uVar5 = uVar5 | *(byte *)((long)b + uVar6 + 9) ^ *(byte *)((long)a + uVar6 + 9),
          uVar6 + 10 < len &&
          (uVar5 = uVar5 | *(byte *)((long)b + uVar6 + 10) ^ *(byte *)((long)a + uVar6 + 10),
          uVar6 + 0xb < len)) &&
         (uVar5 = uVar5 | *(byte *)((long)b + uVar6 + 0xb) ^ *(byte *)((long)a + uVar6 + 0xb),
         uVar6 + 0xc < len)) &&
        ((uVar5 = uVar5 | *(byte *)((long)b + uVar6 + 0xc) ^ *(byte *)((long)a + uVar6 + 0xc),
         uVar6 + 0xd < len &&
         (uVar5 = uVar5 | *(byte *)((long)b + uVar6 + 0xd) ^ *(byte *)((long)a + uVar6 + 0xd),
         uVar6 + 0xe < len)))))) {
      uVar5 = uVar5 | *(byte *)((long)b + uVar6 + 0xe) ^ *(byte *)((long)a + uVar6 + 0xe);
    }
  }
  return uVar5;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

void * default_malloc_ex(size_t __size)

{
  void *pvVar1;
  
  pvVar1 = (void *)(*(code *)malloc_func)();
  return pvVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

void * default_realloc_ex(void *__ptr,size_t __size)

{
  void *pvVar1;
  
  pvVar1 = (void *)(*(code *)realloc_func)();
  return pvVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

void * default_malloc_locked_ex(size_t __size)

{
  void *pvVar1;
  
  pvVar1 = (void *)(*(code *)malloc_locked_func)();
  return pvVar1;
}



int CRYPTO_set_mem_functions(m *m,r *r,f *f)

{
  int iVar1;
  
  OPENSSL_init();
  iVar1 = 0;
  if (allow_customize != 0) {
    if ((m == (m *)0x0) || (r == (r *)0x0)) {
      return 0;
    }
    if (f != (f *)0x0) {
      malloc_ex_func = default_malloc_ex;
      iVar1 = 1;
      realloc_ex_func = default_realloc_ex;
      malloc_locked_ex_func = default_malloc_locked_ex;
      free_locked_func = f;
      malloc_locked_func = m;
      free_func = f;
      realloc_func = r;
      malloc_func = m;
    }
  }
  return iVar1;
}



int CRYPTO_set_mem_ex_functions(m *m,r *r,f *f)

{
  if ((((allow_customize != 0) && (m != (m *)0x0)) && (r != (r *)0x0)) && (f != (f *)0x0)) {
    malloc_func = (undefined *)0x0;
    malloc_ex_func = m;
    realloc_func = (undefined *)0x0;
    realloc_ex_func = r;
    free_func = f;
    malloc_locked_func = (undefined *)0x0;
    malloc_locked_ex_func = m;
    free_locked_func = f;
    return 1;
  }
  return 0;
}



int CRYPTO_set_locked_mem_functions(m *m,free_func *free_func)

{
  if (((allow_customize != 0) && (m != (m *)0x0)) && (free_func != (free_func *)0x0)) {
    malloc_locked_func = m;
    malloc_locked_ex_func = default_malloc_locked_ex;
    free_locked_func = free_func;
    return 1;
  }
  return 0;
}



int CRYPTO_set_locked_mem_ex_functions(m *m,free_func *free_func)

{
  if (((allow_customize != 0) && (m != (m *)0x0)) && (free_func != (free_func *)0x0)) {
    malloc_locked_func = (undefined *)0x0;
    malloc_locked_ex_func = m;
    ::free_func = free_func;
    return 1;
  }
  return 0;
}



int CRYPTO_set_mem_debug_functions(m *m,r *r,f *f,so *so,go *go)

{
  if (allow_customize_debug == 0) {
    return 0;
  }
  OPENSSL_init();
  malloc_debug_func = m;
  realloc_debug_func = r;
  free_debug_func = f;
  set_debug_options_func = so;
  get_debug_options_func = go;
  return 1;
}



void CRYPTO_get_mem_functions(m **m,r **r,f **f)

{
  m *pmVar1;
  r *prVar2;
  
  if (m != (m **)0x0) {
    pmVar1 = (m *)0x0;
    if ((code *)malloc_ex_func == default_malloc_ex) {
      pmVar1 = (m *)malloc_func;
    }
    *m = pmVar1;
  }
  if (r != (r **)0x0) {
    prVar2 = (r *)0x0;
    if ((code *)realloc_ex_func == default_realloc_ex) {
      prVar2 = (r *)realloc_func;
    }
    *r = prVar2;
  }
  if (f != (f **)0x0) {
    *f = (f *)free_func;
  }
  return;
}



void CRYPTO_get_mem_ex_functions(m **m,r **r,f **f)

{
  m *pmVar1;
  r *prVar2;
  
  if (m != (m **)0x0) {
    pmVar1 = (m *)0x0;
    if ((code *)malloc_ex_func != default_malloc_ex) {
      pmVar1 = (m *)malloc_ex_func;
    }
    *m = pmVar1;
  }
  if (r != (r **)0x0) {
    prVar2 = (r *)0x0;
    if ((code *)realloc_ex_func != default_realloc_ex) {
      prVar2 = (r *)realloc_ex_func;
    }
    *r = prVar2;
  }
  if (f != (f **)0x0) {
    *f = (f *)free_func;
  }
  return;
}



void CRYPTO_get_locked_mem_functions(m **m,f **f)

{
  m *pmVar1;
  
  if (m != (m **)0x0) {
    pmVar1 = (m *)0x0;
    if ((code *)malloc_locked_ex_func == default_malloc_locked_ex) {
      pmVar1 = (m *)malloc_locked_func;
    }
    *m = pmVar1;
  }
  if (f != (f **)0x0) {
    *f = (f *)free_locked_func;
  }
  return;
}



void CRYPTO_get_locked_mem_ex_functions(m **m,f **f)

{
  m *pmVar1;
  
  if (m != (m **)0x0) {
    pmVar1 = (m *)0x0;
    if ((code *)malloc_locked_ex_func != default_malloc_locked_ex) {
      pmVar1 = (m *)malloc_locked_ex_func;
    }
    *m = pmVar1;
  }
  if (f != (f **)0x0) {
    *f = (f *)free_locked_func;
  }
  return;
}



void CRYPTO_get_mem_debug_functions(m **m,r **r,f **f,so **so,go **go)

{
  if (m != (m **)0x0) {
    *m = malloc_debug_func;
  }
  if (r != (r **)0x0) {
    *r = realloc_debug_func;
  }
  if (f != (f **)0x0) {
    *f = free_debug_func;
  }
  if (so != (so **)0x0) {
    *so = set_debug_options_func;
  }
  if (go != (go **)0x0) {
    *go = get_debug_options_func;
  }
  return;
}



void * CRYPTO_malloc_locked(int num,char *file,int line)

{
  void *pvVar1;
  
  if (num < 1) {
    pvVar1 = (void *)0x0;
  }
  else {
    allow_customize = 0;
    if (malloc_debug_func != (code *)0x0) {
      allow_customize_debug = 0;
      (*malloc_debug_func)(0,num,file,line,0);
    }
    pvVar1 = (void *)(*(code *)malloc_locked_ex_func)((long)num,file,line);
    if (malloc_debug_func != (code *)0x0) {
      (*malloc_debug_func)(pvVar1,num,file,line,1);
    }
  }
  return pvVar1;
}



void CRYPTO_free_locked(void *ptr)

{
  if (free_debug_func != (code *)0x0) {
    (*free_debug_func)(ptr,0);
  }
  (*(code *)free_locked_func)(ptr);
  if (free_debug_func != (code *)0x0) {
                    // WARNING: Could not recover jumptable at 0x0048e451. Too many branches
                    // WARNING: Treating indirect jump as call
    (*free_debug_func)(0,1);
    return;
  }
  return;
}



void * CRYPTO_malloc(int num,char *file,int line)

{
  void *pvVar1;
  
  if (num < 1) {
    pvVar1 = (void *)0x0;
  }
  else {
    allow_customize = 0;
    if (malloc_debug_func != (code *)0x0) {
      allow_customize_debug = 0;
      (*malloc_debug_func)(0,num,file,line,0);
    }
    pvVar1 = (void *)(*(code *)malloc_ex_func)((long)num,file,line);
    if (malloc_debug_func != (code *)0x0) {
      (*malloc_debug_func)(pvVar1,num,file,line,1);
    }
  }
  return pvVar1;
}



char * CRYPTO_strdup(char *str,char *file,int line)

{
  size_t sVar1;
  char *__dest;
  int iVar2;
  
  sVar1 = strlen(str);
  iVar2 = (int)sVar1 + 1;
  if (iVar2 < 1) {
    __dest = (char *)0x0;
  }
  else {
    allow_customize = 0;
    if (malloc_debug_func != (code *)0x0) {
      allow_customize_debug = 0;
      (*malloc_debug_func)(0,iVar2,file,line,0);
    }
    __dest = (char *)(*(code *)malloc_ex_func)((long)iVar2,file,line);
    if (malloc_debug_func != (code *)0x0) {
      (*malloc_debug_func)(__dest,iVar2,file,line,1);
    }
  }
  strcpy(__dest,str);
  return __dest;
}



void * CRYPTO_realloc(void *addr,int num,char *file,int line)

{
  void *pvVar1;
  
  if (addr == (void *)0x0) {
    if (0 < num) {
      allow_customize = 0;
      if (malloc_debug_func != (code *)0x0) {
        allow_customize_debug = 0;
        (*malloc_debug_func)(0);
      }
      pvVar1 = (void *)(*(code *)malloc_ex_func)((long)num,file,line);
      if (malloc_debug_func == (code *)0x0) {
        return pvVar1;
      }
      (*malloc_debug_func)(pvVar1,num,file,line,1);
      return pvVar1;
    }
  }
  else if (0 < num) {
    if (realloc_debug_func != (code *)0x0) {
      (*realloc_debug_func)(addr,0,num,file,line,0);
    }
    pvVar1 = (void *)(*(code *)realloc_ex_func)(addr,(long)num,file,line);
    if (realloc_debug_func == (code *)0x0) {
      return pvVar1;
    }
    (*realloc_debug_func)(addr,pvVar1,num,file,line,1);
    return pvVar1;
  }
  return (void *)0x0;
}



void * CRYPTO_realloc_clean(void *addr,int old_num,int num,char *file,int line)

{
  void *pvVar1;
  
  if (addr == (void *)0x0) {
    if (0 < num) {
      allow_customize = 0;
      if (malloc_debug_func != (code *)0x0) {
        allow_customize_debug = 0;
        (*malloc_debug_func)(0,num,file,line,0);
      }
      pvVar1 = (void *)(*(code *)malloc_ex_func)((long)num,file,line);
      if (malloc_debug_func == (code *)0x0) {
        return pvVar1;
      }
      (*malloc_debug_func)(pvVar1,num,file,line,1);
      return pvVar1;
    }
  }
  else if ((0 < num) && (old_num <= num)) {
    if (realloc_debug_func != (code *)0x0) {
      (*realloc_debug_func)(addr,0);
    }
    pvVar1 = (void *)(*(code *)malloc_ex_func)((long)num,file,line);
    if (pvVar1 != (void *)0x0) {
      memcpy(pvVar1,addr,(long)old_num);
      OPENSSL_cleanse(addr,(long)old_num);
      (*(code *)free_func)(addr);
    }
    if (realloc_debug_func == (code *)0x0) {
      return pvVar1;
    }
    (*realloc_debug_func)(addr,pvVar1,num,file,line,1);
    return pvVar1;
  }
  return (void *)0x0;
}



void CRYPTO_free(void *ptr)

{
  if (free_debug_func != (code *)0x0) {
    (*free_debug_func)(ptr,0);
  }
  (*(code *)free_func)(ptr);
  if (free_debug_func != (code *)0x0) {
                    // WARNING: Could not recover jumptable at 0x0048e7f1. Too many branches
                    // WARNING: Treating indirect jump as call
    (*free_debug_func)(0,1);
    return;
  }
  return;
}



void * CRYPTO_remalloc(void *addr,int num,char *file,int line)

{
  void *pvVar1;
  undefined4 in_register_0000000c;
  
  if (addr != (void *)0x0) {
    if (free_debug_func != (code *)0x0) {
      (*free_debug_func)(addr,0,file,CONCAT44(in_register_0000000c,line));
    }
    (*(code *)free_func)(addr);
    if (free_debug_func != (code *)0x0) {
      (*free_debug_func)(0,1);
    }
  }
  if (num < 1) {
    pvVar1 = (void *)0x0;
  }
  else {
    allow_customize = 0;
    if (malloc_debug_func != (code *)0x0) {
      allow_customize_debug = 0;
      (*malloc_debug_func)(0,num,"mem.c",0x195,0);
    }
    pvVar1 = (void *)(*(code *)malloc_ex_func)((long)num,"mem.c",0x195);
    if (malloc_debug_func != (code *)0x0) {
      (*malloc_debug_func)(pvVar1,num,"mem.c",0x195,1);
    }
  }
  return pvVar1;
}



void CRYPTO_set_mem_debug_options(long bits)

{
  if (set_debug_options_func != (code *)0x0) {
                    // WARNING: Could not recover jumptable at 0x0048e8dc. Too many branches
                    // WARNING: Treating indirect jump as call
    (*set_debug_options_func)();
    return;
  }
  return;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

long CRYPTO_get_mem_debug_options(void)

{
  long lVar1;
  
  if (get_debug_options_func != (code *)0x0) {
                    // WARNING: Could not recover jumptable at 0x0048e8fc. Too many branches
                    // WARNING: Treating indirect jump as call
    lVar1 = (*get_debug_options_func)();
    return lVar1;
  }
  return 0;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

void OPENSSL_init(void)

{
  if (done_4573 == 0) {
    done_4573 = 1;
  }
  return;
}



char * BUF_strdup(char *str)

{
  size_t sVar1;
  char *pcVar2;
  char cVar3;
  char *pcVar4;
  ulong uVar6;
  char *pcVar5;
  
  if (str == (char *)0x0) {
    pcVar2 = (char *)0x0;
  }
  else {
    sVar1 = strlen(str);
    pcVar2 = (char *)CRYPTO_malloc((int)sVar1 + 1,"buf_str.c",0x4b);
    if (pcVar2 == (char *)0x0) {
      ERR_put_error(7,0x68,0x41,"buf_str.c",0x4e);
      pcVar2 = (char *)0x0;
    }
    else {
      uVar6 = sVar1 + 1;
      pcVar4 = pcVar2;
      if (uVar6 < 2) {
LAB_0048e99b:
        if (uVar6 == 0) {
          return pcVar2;
        }
      }
      else {
        cVar3 = *str;
        if (cVar3 != '\0') {
          pcVar5 = pcVar2;
          do {
            pcVar4 = pcVar5 + 1;
            str = str + 1;
            uVar6 = uVar6 - 1;
            *pcVar5 = cVar3;
            if (pcVar4 == pcVar2 + sVar1) goto LAB_0048e99b;
            cVar3 = *str;
            pcVar5 = pcVar4;
          } while (cVar3 != '\0');
        }
      }
      *pcVar4 = '\0';
    }
  }
  return pcVar2;
}



char * BUF_strndup(char *str,size_t siz)

{
  char *pcVar1;
  char cVar2;
  char *pcVar3;
  ulong uVar5;
  char *pcVar4;
  
  if (str == (char *)0x0) {
    pcVar1 = (char *)0x0;
  }
  else {
    pcVar1 = (char *)CRYPTO_malloc((int)siz + 1,"buf_str.c",0x4b);
    if (pcVar1 == (char *)0x0) {
      ERR_put_error(7,0x68,0x41,"buf_str.c",0x4e);
      pcVar1 = (char *)0x0;
    }
    else {
      uVar5 = siz + 1;
      pcVar3 = pcVar1;
      if (uVar5 < 2) {
LAB_0048ea53:
        if (uVar5 == 0) {
          return pcVar1;
        }
      }
      else {
        cVar2 = *str;
        if (cVar2 != '\0') {
          pcVar4 = pcVar1;
          do {
            pcVar3 = pcVar4 + 1;
            str = str + 1;
            uVar5 = uVar5 - 1;
            *pcVar4 = cVar2;
            if (pcVar3 == pcVar1 + siz) goto LAB_0048ea53;
            cVar2 = *str;
            pcVar4 = pcVar3;
          } while (cVar2 != '\0');
        }
      }
      *pcVar3 = '\0';
    }
  }
  return pcVar1;
}



void * BUF_memdup(void *data,size_t siz)

{
  void *pvVar1;
  
  if (data != (void *)0x0) {
    pvVar1 = CRYPTO_malloc((int)siz,"buf_str.c",0x5b);
    if (pvVar1 != (void *)0x0) {
      pvVar1 = memcpy(pvVar1,data,siz);
      return pvVar1;
    }
    ERR_put_error(7,0x67,0x41,"buf_str.c",0x5e);
  }
  return (void *)0x0;
}



size_t BUF_strlcpy(char *dst,char *src,size_t siz)

{
  size_t sVar1;
  char *pcVar2;
  long lVar4;
  char cVar5;
  char *pcVar3;
  
  if (siz < 2) {
    if (siz == 0) {
      lVar4 = 0;
      goto LAB_0048eb50;
    }
LAB_0048eb69:
    lVar4 = 0;
    pcVar2 = dst;
  }
  else {
    cVar5 = *src;
    pcVar3 = dst;
    if (cVar5 == '\0') goto LAB_0048eb69;
    do {
      pcVar2 = pcVar3 + 1;
      siz = siz - 1;
      src = src + 1;
      *pcVar3 = cVar5;
      lVar4 = (long)pcVar2 - (long)dst;
      if (siz == 1) break;
      cVar5 = *src;
      pcVar3 = pcVar2;
    } while (cVar5 != '\0');
  }
  *pcVar2 = '\0';
LAB_0048eb50:
  sVar1 = strlen(src);
  return sVar1 + lVar4;
}



size_t BUF_strlcat(char *dst,char *src,size_t siz)

{
  size_t sVar1;
  char *pcVar2;
  long lVar4;
  long lVar5;
  char cVar6;
  char *pcVar3;
  
  lVar4 = 0;
  if (siz != 0) {
    do {
      if (*dst == '\0') {
        if ((1 < siz) && (cVar6 = *src, pcVar3 = dst, cVar6 != '\0')) goto LAB_0048ebb9;
        lVar5 = 0;
        pcVar2 = dst;
        goto LAB_0048ebd5;
      }
      lVar4 = lVar4 + 1;
      dst = dst + 1;
      siz = siz - 1;
    } while (siz != 0);
  }
  lVar5 = 0;
  goto LAB_0048ebe2;
  while (cVar6 = *src, pcVar3 = pcVar2, cVar6 != '\0') {
LAB_0048ebb9:
    pcVar2 = pcVar3 + 1;
    siz = siz - 1;
    src = src + 1;
    *pcVar3 = cVar6;
    lVar5 = (long)pcVar2 - (long)dst;
    if (siz == 1) break;
  }
LAB_0048ebd5:
  *pcVar2 = '\0';
LAB_0048ebe2:
  sVar1 = strlen(src);
  return sVar1 + lVar5 + lVar4;
}



int sk_set_cmp_func(void *param_1,void *param_2)

{
  void *pvVar1;
  
  pvVar1 = *(void **)((long)param_1 + 0x18);
  if (pvVar1 != param_2) {
    *(undefined4 *)((long)param_1 + 0x10) = 0;
  }
  *(void **)((long)param_1 + 0x18) = param_2;
  return (int)pvVar1;
}



_STACK * sk_dup(_STACK *st)

{
  int iVar1;
  _func_257 *p_Var2;
  char **__src;
  _STACK *ptr;
  char **ppcVar3;
  
  p_Var2 = st->comp;
  ptr = (_STACK *)CRYPTO_malloc(0x20,"stack.c",0x7d);
  if (ptr != (_STACK *)0x0) {
    ppcVar3 = (char **)CRYPTO_malloc(0x20,"stack.c",0x7f);
    ptr->data = ppcVar3;
    if (ppcVar3 != (char **)0x0) {
      *ppcVar3 = (char *)0x0;
      ptr->data[1] = (char *)0x0;
      ptr->data[2] = (char *)0x0;
      ptr->data[3] = (char *)0x0;
      ptr->num_alloc = 4;
      iVar1 = st->num_alloc;
      ptr->comp = p_Var2;
      ptr->num = 0;
      ptr->sorted = 0;
      ppcVar3 = (char **)CRYPTO_realloc(ptr->data,iVar1 * 8,"stack.c",99);
      if (ppcVar3 != (char **)0x0) {
        iVar1 = st->num;
        ptr->data = ppcVar3;
        __src = st->data;
        ptr->num = iVar1;
        memcpy(ppcVar3,__src,(long)st->num << 3);
        ptr->sorted = st->sorted;
        ptr->num_alloc = st->num_alloc;
        ptr->comp = st->comp;
        return ptr;
      }
      if (ptr->data != (char **)0x0) {
        CRYPTO_free(ptr->data);
      }
    }
    CRYPTO_free(ptr);
  }
  return (_STACK *)0x0;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

_STACK * sk_new_null(void)

{
  _STACK *ptr;
  char **ppcVar1;
  _STACK *p_Var2;
  
  ptr = (_STACK *)CRYPTO_malloc(0x20,"stack.c",0x7d);
  p_Var2 = (_STACK *)0x0;
  if (ptr != (_STACK *)0x0) {
    ppcVar1 = (char **)CRYPTO_malloc(0x20,"stack.c",0x7f);
    ptr->data = ppcVar1;
    if (ppcVar1 == (char **)0x0) {
      CRYPTO_free(ptr);
      return (_STACK *)0x0;
    }
    *ppcVar1 = (char *)0x0;
    ptr->data[1] = (char *)0x0;
    ptr->data[2] = (char *)0x0;
    ptr->data[3] = (char *)0x0;
    ptr->comp = (_func_257 *)0x0;
    ptr->num_alloc = 4;
    ptr->num = 0;
    ptr->sorted = 0;
    p_Var2 = ptr;
  }
  return p_Var2;
}



_STACK * sk_new(cmp *cmp)

{
  _STACK *ptr;
  char **ppcVar1;
  _STACK *p_Var2;
  
  ptr = (_STACK *)CRYPTO_malloc(0x20,"stack.c",0x7d);
  p_Var2 = (_STACK *)0x0;
  if (ptr != (_STACK *)0x0) {
    ppcVar1 = (char **)CRYPTO_malloc(0x20,"stack.c",0x7f);
    ptr->data = ppcVar1;
    if (ppcVar1 == (char **)0x0) {
      CRYPTO_free(ptr);
      return (_STACK *)0x0;
    }
    *ppcVar1 = (char *)0x0;
    ptr->data[1] = (char *)0x0;
    ptr->data[2] = (char *)0x0;
    ptr->data[3] = (char *)0x0;
    ptr->comp = (_func_257 *)cmp;
    ptr->num_alloc = 4;
    ptr->num = 0;
    ptr->sorted = 0;
    p_Var2 = ptr;
  }
  return p_Var2;
}



int sk_insert(_STACK *sk,void *data,int where)

{
  int iVar1;
  char **ppcVar2;
  long lVar3;
  ulong uVar4;
  int iVar5;
  
  if (sk == (_STACK *)0x0) {
    return 0;
  }
  iVar1 = sk->num;
  iVar5 = iVar1 + 1;
  if (iVar5 < sk->num_alloc) {
    ppcVar2 = sk->data;
  }
  else {
    ppcVar2 = (char **)CRYPTO_realloc(sk->data,sk->num_alloc << 4,"stack.c",0x96);
    if (ppcVar2 == (char **)0x0) {
      return 0;
    }
    iVar1 = sk->num;
    sk->data = ppcVar2;
    sk->num_alloc = sk->num_alloc << 1;
    iVar5 = iVar1 + 1;
  }
  lVar3 = (long)iVar1;
  if ((where < iVar1) && (-1 < where)) {
    uVar4 = (ulong)((iVar1 - where) + 1);
    memmove(ppcVar2 + ((lVar3 + 2) - uVar4),ppcVar2 + ((lVar3 + 1) - uVar4),uVar4 * 8);
    sk->data[where] = (char *)data;
  }
  else {
    ppcVar2[lVar3] = (char *)data;
  }
  sk->sorted = 0;
  sk->num = iVar5;
  return iVar5;
}



void * sk_delete_ptr(_STACK *st,void *p)

{
  int iVar1;
  int iVar2;
  char *pcVar3;
  char **ppcVar4;
  long lVar5;
  int iVar6;
  char **ppcVar7;
  
  iVar2 = st->num;
  if (iVar2 < 1) {
    return (void *)0x0;
  }
  ppcVar7 = st->data;
  iVar6 = 0;
  pcVar3 = *ppcVar7;
  ppcVar4 = ppcVar7;
  if (pcVar3 == (char *)p) {
    iVar6 = 0;
  }
  else {
    do {
      ppcVar4 = ppcVar4 + 1;
      iVar6 = iVar6 + 1;
      if (iVar6 == iVar2) {
        return (void *)0x0;
      }
      pcVar3 = *ppcVar4;
    } while (pcVar3 != (char *)p);
    if (iVar6 < 0) {
      return (void *)0x0;
    }
  }
  iVar1 = iVar2 + -1;
  if ((iVar6 != iVar1) && (iVar6 < iVar1)) {
    lVar5 = (long)iVar6 * 8;
    while( true ) {
      *(undefined8 *)((long)ppcVar7 + lVar5) = *(undefined8 *)((long)ppcVar7 + lVar5 + 8);
      if (((long)iVar6 + 1 + (ulong)(uint)((iVar2 + -2) - iVar6)) * 8 == lVar5 + 8) break;
      ppcVar7 = st->data;
      lVar5 = lVar5 + 8;
    }
  }
  st->num = iVar1;
  return pcVar3;
}



void * sk_delete(_STACK *st,int loc)

{
  int iVar1;
  int iVar2;
  char *pcVar3;
  char **ppcVar4;
  long lVar5;
  long lVar6;
  
  if (((st != (_STACK *)0x0) && (-1 < loc)) && (iVar2 = st->num, loc < iVar2)) {
    ppcVar4 = st->data;
    iVar1 = iVar2 + -1;
    lVar6 = (long)loc;
    pcVar3 = ppcVar4[lVar6];
    if ((iVar1 != loc) && (loc < iVar1)) {
      lVar5 = lVar6 * 8;
      while( true ) {
        *(undefined8 *)((long)ppcVar4 + lVar5) = *(undefined8 *)((long)ppcVar4 + lVar5 + 8);
        if (lVar5 + 8 == (lVar6 + 1 + (ulong)(uint)((iVar2 + -2) - loc)) * 8) break;
        ppcVar4 = st->data;
        lVar5 = lVar5 + 8;
      }
    }
    st->num = iVar1;
    return pcVar3;
  }
  return (void *)0x0;
}



int sk_find(_STACK *st,void *data)

{
  int iVar1;
  void *pvVar2;
  char **ppcVar3;
  void *local_18 [2];
  
  if (st != (_STACK *)0x0) {
    if (st->comp == (_func_257 *)0x0) {
      if (0 < st->num) {
        ppcVar3 = st->data;
        if ((char *)data == *ppcVar3) {
          iVar1 = 0;
        }
        else {
          iVar1 = 0;
          do {
            ppcVar3 = ppcVar3 + 1;
            iVar1 = iVar1 + 1;
            if (iVar1 == st->num) {
              return -1;
            }
          } while ((char *)data != *ppcVar3);
        }
        return iVar1;
      }
    }
    else {
      local_18[0] = data;
      if (st->sorted == 0) {
        qsort(st->data,(long)st->num,8,(__compar_fn_t)st->comp);
        st->sorted = 1;
      }
      if ((local_18[0] != (void *)0x0) &&
         (pvVar2 = OBJ_bsearch_ex_(local_18,st->data,st->num,8,(cmp *)st->comp,2),
         pvVar2 != (void *)0x0)) {
        return (int)((ulong)((long)pvVar2 - (long)st->data) >> 3);
      }
    }
  }
  return -1;
}



int sk_find_ex(_STACK *st,void *data)

{
  int iVar1;
  void *pvVar2;
  char **ppcVar3;
  void *local_18 [2];
  
  if (st != (_STACK *)0x0) {
    if (st->comp == (_func_257 *)0x0) {
      if (0 < st->num) {
        ppcVar3 = st->data;
        if ((char *)data == *ppcVar3) {
          iVar1 = 0;
        }
        else {
          iVar1 = 0;
          do {
            ppcVar3 = ppcVar3 + 1;
            iVar1 = iVar1 + 1;
            if (iVar1 == st->num) {
              return -1;
            }
          } while ((char *)data != *ppcVar3);
        }
        return iVar1;
      }
    }
    else {
      local_18[0] = data;
      if (st->sorted == 0) {
        qsort(st->data,(long)st->num,8,(__compar_fn_t)st->comp);
        st->sorted = 1;
      }
      if ((local_18[0] != (void *)0x0) &&
         (pvVar2 = OBJ_bsearch_ex_(local_18,st->data,st->num,8,(cmp *)st->comp,1),
         pvVar2 != (void *)0x0)) {
        return (int)((ulong)((long)pvVar2 - (long)st->data) >> 3);
      }
    }
  }
  return -1;
}



int sk_push(_STACK *st,void *data)

{
  int iVar1;
  int iVar2;
  int iVar3;
  char **ppcVar4;
  ulong uVar5;
  long lVar6;
  
  iVar1 = st->num;
  lVar6 = (long)iVar1;
  iVar3 = iVar1 + 1;
  if (iVar3 < st->num_alloc) {
    ppcVar4 = st->data;
  }
  else {
    ppcVar4 = (char **)CRYPTO_realloc(st->data,st->num_alloc << 4,"stack.c",0x96);
    if (ppcVar4 == (char **)0x0) {
      return 0;
    }
    iVar2 = st->num;
    st->num_alloc = st->num_alloc << 1;
    st->data = ppcVar4;
    if ((iVar1 < iVar2) && (-1 < iVar1)) {
      iVar3 = iVar2 + 1;
      uVar5 = (ulong)(uint)(iVar3 - iVar1);
      memmove(ppcVar4 + (((long)iVar2 + 2) - uVar5),ppcVar4 + (((long)iVar2 + 1) - uVar5),uVar5 * 8)
      ;
      st->data[lVar6] = (char *)data;
      goto LAB_0048f215;
    }
    iVar3 = iVar2 + 1;
    lVar6 = (long)iVar2;
  }
  ppcVar4[lVar6] = (char *)data;
LAB_0048f215:
  st->num = iVar3;
  st->sorted = 0;
  return iVar3;
}



int sk_unshift(_STACK *st,void *data)

{
  int iVar1;
  char **ppcVar2;
  ulong uVar3;
  uint uVar4;
  
  if (st == (_STACK *)0x0) {
    return 0;
  }
  iVar1 = st->num;
  uVar4 = iVar1 + 1;
  if ((int)uVar4 < st->num_alloc) {
    ppcVar2 = st->data;
  }
  else {
    ppcVar2 = (char **)CRYPTO_realloc(st->data,st->num_alloc << 4,"stack.c",0x96);
    if (ppcVar2 == (char **)0x0) {
      return 0;
    }
    iVar1 = st->num;
    st->data = ppcVar2;
    st->num_alloc = st->num_alloc << 1;
    uVar4 = iVar1 + 1;
  }
  if (iVar1 < 1) {
    ppcVar2[iVar1] = (char *)data;
  }
  else {
    uVar3 = (ulong)uVar4;
    memmove(ppcVar2 + (((long)iVar1 + 2) - uVar3),ppcVar2 + (((long)iVar1 + 1) - uVar3),uVar3 * 8);
    *st->data = (char *)data;
  }
  st->sorted = 0;
  st->num = uVar4;
  return uVar4;
}



void * sk_shift(_STACK *st)

{
  char *pcVar1;
  char **ppcVar2;
  long lVar3;
  int iVar4;
  int iVar5;
  
  if ((st != (_STACK *)0x0) && (0 < st->num)) {
    ppcVar2 = st->data;
    iVar4 = 0;
    iVar5 = st->num + -1;
    pcVar1 = *ppcVar2;
    lVar3 = 0;
    if (iVar5 != 0) {
      while( true ) {
        iVar4 = iVar4 + 1;
        *(undefined8 *)((long)ppcVar2 + lVar3) = *(undefined8 *)((long)ppcVar2 + lVar3 + 8);
        if (iVar5 <= iVar4) break;
        ppcVar2 = st->data;
        lVar3 = lVar3 + 8;
      }
    }
    st->num = iVar5;
    return pcVar1;
  }
  return (void *)0x0;
}



void * sk_pop(_STACK *st)

{
  int iVar1;
  char *pcVar2;
  
  if ((st != (_STACK *)0x0) && (0 < st->num)) {
    iVar1 = st->num + -1;
    pcVar2 = st->data[iVar1];
    st->num = iVar1;
    return pcVar2;
  }
  return (void *)0x0;
}



void sk_zero(_STACK *st)

{
  if ((st != (_STACK *)0x0) && (0 < st->num)) {
    memset(st->data,0,(long)st->num << 3);
    st->num = 0;
  }
  return;
}



void sk_pop_free(_STACK *st,func *func)

{
  int iVar1;
  int iVar2;
  long lVar3;
  char **ptr;
  
  if (st != (_STACK *)0x0) {
    iVar2 = st->num;
    if (iVar2 < 1) {
      ptr = st->data;
    }
    else {
      ptr = st->data;
      lVar3 = 0;
      do {
        if (ptr[lVar3] != (char *)0x0) {
          (*func)(ptr[lVar3]);
          ptr = st->data;
          iVar2 = st->num;
        }
        iVar1 = (int)lVar3;
        lVar3 = lVar3 + 1;
      } while (iVar1 + 1 < iVar2);
    }
    if (ptr != (char **)0x0) {
      CRYPTO_free(ptr);
    }
    CRYPTO_free(st);
    return;
  }
  return;
}



void sk_free(_STACK *param_1)

{
  if (param_1 != (_STACK *)0x0) {
    if (param_1->data != (char **)0x0) {
      CRYPTO_free(param_1->data);
    }
    CRYPTO_free(param_1);
    return;
  }
  return;
}



int sk_num(_STACK *param_1)

{
  if (param_1 != (_STACK *)0x0) {
    return param_1->num;
  }
  return -1;
}



void * sk_value(_STACK *param_1,int param_2)

{
  if (((param_1 != (_STACK *)0x0) && (-1 < param_2)) && (param_2 < param_1->num)) {
    return param_1->data[param_2];
  }
  return (void *)0x0;
}



void * sk_set(_STACK *param_1,int param_2,void *param_3)

{
  if (((param_1 != (_STACK *)0x0) && (-1 < param_2)) && (param_2 < param_1->num)) {
    param_1->data[param_2] = (char *)param_3;
    return param_3;
  }
  return (void *)0x0;
}



void sk_sort(_STACK *st)

{
  if ((st != (_STACK *)0x0) && (st->sorted == 0)) {
    qsort(st->data,(long)st->num,8,(__compar_fn_t)st->comp);
    st->sorted = 1;
    return;
  }
  return;
}



int sk_is_sorted(_STACK *st)

{
  if (st != (_STACK *)0x0) {
    return st->sorted;
  }
  return 1;
}



ulong err_string_data_LHASH_HASH(ulong *param_1)

{
  ulong uVar1;
  
  uVar1 = *param_1;
  uVar1 = (long)(int)((uint)(uVar1 >> 0xc) & 0xfff ^ (uint)(uVar1 >> 0x18) & 0xff) ^ uVar1;
  return (uVar1 % 0x13) * 0xd ^ uVar1;
}



int err_string_data_LHASH_COMP(undefined8 *param_1,int *param_2)

{
  return (int)*param_1 - *param_2;
}



int int_err_get_next_lib(void)

{
  int iVar1;
  
  CRYPTO_lock(9,1,"err.c",0x227);
  iVar1 = int_err_library_number;
  int_err_library_number = int_err_library_number + 1;
  CRYPTO_lock(10,1,"err.c",0x229);
  return iVar1;
}



void int_err_del(void)

{
  CRYPTO_lock(9,1,"err.c",0x172);
  if (int_error_hash != (_LHASH *)0x0) {
    lh_free(int_error_hash);
    int_error_hash = (_LHASH *)0x0;
  }
  CRYPTO_lock(10,1,"err.c",0x178);
  return;
}



void int_thread_release(long *param_1)

{
  int iVar1;
  
  if ((param_1 != (long *)0x0) && (*param_1 != 0)) {
    iVar1 = CRYPTO_add_lock(&int_thread_hash_references,-1,1,"err.c",0x1d5);
    if (iVar1 < 1) {
      *param_1 = 0;
      return;
    }
  }
  return;
}



_LHASH * int_thread_get(int param_1)

{
  _LHASH *p_Var1;
  
  CRYPTO_lock(9,1,"err.c",0x1be);
  if (int_thread_hash == (_LHASH *)0x0) {
    if (param_1 == 0) goto LAB_0048f734;
    CRYPTO_push_info_("int_thread_get (err.c)","err.c",0x1c1);
    int_thread_hash = lh_new(err_state_LHASH_HASH,err_state_LHASH_COMP);
    CRYPTO_pop_info();
    if (int_thread_hash == (_LHASH *)0x0) goto LAB_0048f734;
  }
  int_thread_hash_references = int_thread_hash_references + 1;
LAB_0048f734:
  p_Var1 = int_thread_hash;
  CRYPTO_lock(10,1,"err.c",0x1ca);
  return p_Var1;
}



_LHASH * int_err_get(int param_1)

{
  _LHASH *p_Var1;
  
  CRYPTO_lock(9,1,"err.c",0x162);
  if ((int_error_hash == (_LHASH *)0x0) && (param_1 != 0)) {
    CRYPTO_push_info_("int_err_get (err.c)","err.c",0x165);
    int_error_hash = lh_new(err_string_data_LHASH_HASH,err_string_data_LHASH_COMP);
    CRYPTO_pop_info();
  }
  p_Var1 = int_error_hash;
  CRYPTO_lock(10,1,"err.c",0x16b);
  return p_Var1;
}



int err_state_LHASH_COMP(CRYPTO_THREADID *a,CRYPTO_THREADID *b)

{
  int iVar1;
  
  iVar1 = memcmp(a,b,0x10);
  return iVar1;
}



long err_state_LHASH_HASH(CRYPTO_THREADID *param_1)

{
  ulong uVar1;
  
  uVar1 = CRYPTO_THREADID_hash(param_1);
  return uVar1 * 0xd;
}



void ERR_remove_thread_state_constprop_3(void)

{
  CRYPTO_THREADID aCStack_268 [38];
  
  CRYPTO_THREADID_current(aCStack_268);
  if (err_fns != (undefined1 *)0x0) {
    (**(code **)(err_fns + 0x48))(aCStack_268);
    return;
  }
  CRYPTO_lock(9,1,"err.c",0x127);
  if (err_fns == (undefined1 *)0x0) {
    err_fns = err_defaults;
  }
  CRYPTO_lock(10,1,"err.c",0x12a);
  (**(code **)(err_fns + 0x48))(aCStack_268);
  return;
}



void * int_err_set_item(void *param_1)

{
  _LHASH *lh;
  void *pvVar1;
  
  if ((undefined8 *)err_fns == (undefined8 *)0x0) {
    CRYPTO_lock(9,1,"err.c",0x127);
    if ((undefined8 *)err_fns == (undefined8 *)0x0) {
      err_fns = err_defaults;
    }
    CRYPTO_lock(10,1,"err.c",0x12a);
  }
  lh = (_LHASH *)(**(code **)err_fns)(1);
  if (lh == (_LHASH *)0x0) {
    pvVar1 = (void *)0x0;
  }
  else {
    CRYPTO_lock(9,1,"err.c",0x196);
    pvVar1 = lh_insert(lh,param_1);
    CRYPTO_lock(10,1,"err.c",0x198);
  }
  return pvVar1;
}



void * int_err_get_item(void *param_1)

{
  _LHASH *lh;
  void *pvVar1;
  
  if ((undefined8 *)err_fns == (undefined8 *)0x0) {
    CRYPTO_lock(9,1,"err.c",0x127);
    if ((undefined8 *)err_fns == (undefined8 *)0x0) {
      err_fns = err_defaults;
    }
    CRYPTO_lock(10,1,"err.c",0x12a);
  }
  lh = (_LHASH *)(**(code **)err_fns)(0);
  if (lh == (_LHASH *)0x0) {
    pvVar1 = (void *)0x0;
  }
  else {
    CRYPTO_lock(5,1,"err.c",0x185);
    pvVar1 = lh_retrieve(lh,param_1);
    CRYPTO_lock(6,1,"err.c",0x187);
  }
  return pvVar1;
}



void * int_err_del_item(void *param_1)

{
  _LHASH *lh;
  void *pvVar1;
  
  if ((undefined8 *)err_fns == (undefined8 *)0x0) {
    CRYPTO_lock(9,1,"err.c",0x127);
    if ((undefined8 *)err_fns == (undefined8 *)0x0) {
      err_fns = err_defaults;
    }
    CRYPTO_lock(10,1,"err.c",0x12a);
  }
  lh = (_LHASH *)(**(code **)err_fns)(0);
  if (lh == (_LHASH *)0x0) {
    pvVar1 = (void *)0x0;
  }
  else {
    CRYPTO_lock(9,1,"err.c",0x1a7);
    pvVar1 = lh_delete(lh,param_1);
    CRYPTO_lock(10,1,"err.c",0x1a9);
  }
  return pvVar1;
}



void * int_thread_set_item(void *param_1)

{
  void *pvVar1;
  _LHASH *local_18 [2];
  
  if (err_fns == (undefined1 *)0x0) {
    CRYPTO_lock(9,1,"err.c",0x127);
    if (err_fns == (undefined1 *)0x0) {
      err_fns = err_defaults;
    }
    CRYPTO_lock(10,1,"err.c",0x12a);
  }
  local_18[0] = (_LHASH *)(**(code **)(err_fns + 0x28))(1);
  if (local_18[0] == (_LHASH *)0x0) {
    pvVar1 = (void *)0x0;
  }
  else {
    CRYPTO_lock(9,1,"err.c",0x201);
    pvVar1 = lh_insert(local_18[0],param_1);
    CRYPTO_lock(10,1,"err.c",0x203);
    (**(code **)(err_fns + 0x30))(local_18);
  }
  return pvVar1;
}



void * int_thread_get_item(void *param_1)

{
  void *pvVar1;
  _LHASH *local_18 [2];
  
  if (err_fns == (undefined1 *)0x0) {
    CRYPTO_lock(9,1,"err.c",0x127);
    if (err_fns == (undefined1 *)0x0) {
      err_fns = err_defaults;
    }
    CRYPTO_lock(10,1,"err.c",0x12a);
  }
  local_18[0] = (_LHASH *)(**(code **)(err_fns + 0x28))(0);
  if (local_18[0] == (_LHASH *)0x0) {
    pvVar1 = (void *)0x0;
  }
  else {
    CRYPTO_lock(5,1,"err.c",0x1ef);
    pvVar1 = lh_retrieve(local_18[0],param_1);
    CRYPTO_lock(6,1,"err.c",0x1f1);
    (**(code **)(err_fns + 0x30))(local_18);
  }
  return pvVar1;
}



void int_thread_del_item(void *param_1)

{
  void *ptr;
  void *ptr_00;
  ulong uVar1;
  long lVar2;
  _LHASH *local_28 [3];
  
  if (err_fns == (undefined1 *)0x0) {
    CRYPTO_lock(9,1,"err.c",0x127);
    if (err_fns == (undefined1 *)0x0) {
      err_fns = err_defaults;
    }
    CRYPTO_lock(10,1,"err.c",0x12a);
  }
  local_28[0] = (_LHASH *)(**(code **)(err_fns + 0x28))(0);
  if (local_28[0] != (_LHASH *)0x0) {
    CRYPTO_lock(9,1,"err.c",0x213);
    ptr_00 = lh_delete(local_28[0],param_1);
    if ((int_thread_hash_references == 1) && (int_thread_hash != (_LHASH *)0x0)) {
      uVar1 = lh_num_items(int_thread_hash);
      if (uVar1 == 0) {
        lh_free(int_thread_hash);
        int_thread_hash = (_LHASH *)0x0;
      }
    }
    CRYPTO_lock(10,1,"err.c",0x21c);
    (**(code **)(err_fns + 0x30))(local_28);
    if (ptr_00 != (void *)0x0) {
      lVar2 = 0;
      do {
        ptr = *(void **)((long)ptr_00 + lVar2 * 2 + 0xd0);
        if ((ptr != (void *)0x0) && ((*(byte *)((long)ptr_00 + lVar2 + 0x150) & 1) != 0)) {
          CRYPTO_free(ptr);
          *(undefined8 *)((long)ptr_00 + lVar2 * 2 + 0xd0) = 0;
        }
        *(undefined4 *)((long)ptr_00 + lVar2 + 0x150) = 0;
        lVar2 = lVar2 + 4;
      } while (lVar2 != 0x40);
      CRYPTO_free(ptr_00);
    }
  }
  return;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

ERR_FNS * ERR_get_implementation(void)

{
  if ((ERR_FNS *)err_fns != (ERR_FNS *)0x0) {
    return (ERR_FNS *)err_fns;
  }
  CRYPTO_lock(9,1,"err.c",0x127);
  if ((ERR_FNS *)err_fns == (ERR_FNS *)0x0) {
    err_fns = err_defaults;
  }
  CRYPTO_lock(10,1,"err.c",0x12a);
  return (ERR_FNS *)err_fns;
}



int ERR_set_implementation(ERR_FNS *fns)

{
  bool bVar1;
  
  CRYPTO_lock(9,1,"err.c",0x139);
  bVar1 = err_fns == (ERR_FNS *)0x0;
  if (bVar1) {
    err_fns = fns;
  }
  CRYPTO_lock(10,1,"err.c",0x141);
  return (uint)bVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

void ERR_load_ERR_strings(void)

{
  ulong uVar1;
  ulong *puVar2;
  char *pcVar3;
  long *plVar4;
  long lVar5;
  undefined1 *__dest;
  
  if (err_fns == (undefined1 *)0x0) {
    CRYPTO_lock(9,1,"err.c",0x127);
    if (err_fns == (undefined1 *)0x0) {
      err_fns = err_defaults;
    }
    CRYPTO_lock(10,1,"err.c",0x12a);
  }
  plVar4 = &ERR_str_libraries;
  lVar5 = ERR_str_libraries;
  while (lVar5 != 0) {
    (**(code **)(err_fns + 0x18))(plVar4);
    lVar5 = plVar4[2];
    plVar4 = plVar4 + 2;
  }
  plVar4 = &ERR_str_reasons;
  lVar5 = ERR_str_reasons;
  while (lVar5 != 0) {
    (**(code **)(err_fns + 0x18))(plVar4);
    lVar5 = plVar4[2];
    plVar4 = plVar4 + 2;
  }
  puVar2 = &ERR_str_functs;
  uVar1 = ERR_str_functs;
  while (uVar1 != 0) {
    *puVar2 = uVar1 | 0x2000000;
    (**(code **)(err_fns + 0x18))(puVar2);
    uVar1 = puVar2[2];
    puVar2 = puVar2 + 2;
  }
  CRYPTO_lock(5,1,"err.c",0x244);
  if (init_5116 == 0) {
    CRYPTO_lock(6,1,"err.c",0x247);
  }
  else {
    CRYPTO_lock(6,1,"err.c",0x24b);
    CRYPTO_lock(9,1,"err.c",0x24c);
    if (init_5116 == 0) {
      CRYPTO_lock(10,1,"err.c",0x24f);
    }
    else {
      plVar4 = (long *)&SYS_str_reasons;
      __dest = strerror_tab_5114;
      lVar5 = 1;
      do {
        *plVar4 = lVar5;
        if (plVar4[1] == 0) {
          pcVar3 = strerror((int)lVar5);
          if (pcVar3 == (char *)0x0) {
            pcVar3 = (char *)plVar4[1];
          }
          else {
            strncpy(__dest,pcVar3,0x20);
            __dest[0x1f] = '\0';
            plVar4[1] = (long)__dest;
            pcVar3 = __dest;
          }
          if (pcVar3 == (char *)0x0) {
            plVar4[1] = (long)"unknown";
          }
        }
        lVar5 = lVar5 + 1;
        plVar4 = plVar4 + 2;
        __dest = __dest + 0x20;
      } while (lVar5 != 0x80);
      init_5116 = 0;
      CRYPTO_lock(10,1,"err.c",0x26c);
    }
  }
  puVar2 = &SYS_str_reasons;
  uVar1 = SYS_str_reasons;
  while (uVar1 != 0) {
    *puVar2 = uVar1 | 0x2000000;
    (**(code **)(err_fns + 0x18))(puVar2);
    uVar1 = puVar2[2];
    puVar2 = puVar2 + 2;
  }
  return;
}



void ERR_load_strings(int lib,ERR_STRING_DATA *str)

{
  ulong uVar1;
  ERR_STRING_DATA *pEVar2;
  
  ERR_load_ERR_strings();
  uVar1 = str->error;
  if (uVar1 != 0) {
    if (lib == 0) {
      do {
        pEVar2 = str + 1;
        (**(code **)(err_fns + 0x18))(str);
        str = pEVar2;
      } while (pEVar2->error != 0);
    }
    else {
      do {
        str->error = uVar1 | (ulong)(lib & 0xff) << 0x18;
        (**(code **)(err_fns + 0x18))(str);
        uVar1 = str[1].error;
        str = str + 1;
      } while (uVar1 != 0);
    }
  }
  return;
}



void ERR_unload_strings(int lib,ERR_STRING_DATA *str)

{
  ulong uVar1;
  ERR_STRING_DATA *pEVar2;
  
  uVar1 = str->error;
  if (uVar1 != 0) {
    if (lib == 0) {
      do {
        pEVar2 = str + 1;
        (**(code **)(err_fns + 0x20))(str);
        str = pEVar2;
      } while (pEVar2->error != 0);
    }
    else {
      do {
        str->error = uVar1 | ((ulong)(uint)lib & 0xff) << 0x18;
        (**(code **)(err_fns + 0x20))(str);
        uVar1 = str[1].error;
        str = str + 1;
      } while (uVar1 != 0);
    }
  }
  return;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

void ERR_free_strings(void)

{
  if (err_fns != (undefined1 *)0x0) {
                    // WARNING: Could not recover jumptable at 0x00490340. Too many branches
                    // WARNING: Treating indirect jump as call
    (**(code **)(err_fns + 8))();
    return;
  }
  CRYPTO_lock(9,1,"err.c",0x127);
  if (err_fns == (undefined1 *)0x0) {
    err_fns = err_defaults;
  }
  CRYPTO_lock(10,1,"err.c",0x12a);
                    // WARNING: Could not recover jumptable at 0x00490397. Too many branches
                    // WARNING: Treating indirect jump as call
  (**(code **)(err_fns + 8))();
  return;
}



void ERR_error_string_n(ulong e,char *buf,size_t len)

{
  ulong uVar1;
  ulong uVar2;
  long lVar3;
  ulong *puVar4;
  size_t sVar5;
  char *pcVar6;
  char *pcVar7;
  char *pcVar8;
  ulong uVar9;
  ulong uVar10;
  char local_f8 [64];
  char local_b8 [64];
  ulong local_78 [9];
  
  uVar1 = e >> 0x18 & 0xff;
  uVar9 = (ulong)((uint)(e >> 0xc) & 0xfff);
  uVar2 = (ulong)((uint)e & 0xfff);
  if (err_fns == (undefined1 *)0x0) {
    CRYPTO_lock(9,1,"err.c",0x127);
    if (err_fns == (undefined1 *)0x0) {
      err_fns = err_defaults;
    }
    CRYPTO_lock(10,1,"err.c",0x12a);
  }
  uVar10 = uVar1 << 0x18;
  local_78[0] = uVar10;
  lVar3 = (**(code **)(err_fns + 0x10))(local_78);
  if (lVar3 == 0) {
    pcVar6 = (char *)0x0;
  }
  else {
    pcVar6 = *(char **)(lVar3 + 8);
  }
  if (err_fns == (undefined1 *)0x0) {
    CRYPTO_lock(9,1,"err.c",0x127);
    if (err_fns == (undefined1 *)0x0) {
      err_fns = err_defaults;
    }
    CRYPTO_lock(10,1,"err.c",0x12a);
  }
  local_78[0] = uVar9 << 0xc | uVar10;
  lVar3 = (**(code **)(err_fns + 0x10))(local_78);
  if (lVar3 == 0) {
    pcVar7 = (char *)0x0;
  }
  else {
    pcVar7 = *(char **)(lVar3 + 8);
  }
  if (err_fns == (undefined1 *)0x0) {
    CRYPTO_lock(9,1,"err.c",0x127);
    if (err_fns == (undefined1 *)0x0) {
      err_fns = err_defaults;
    }
    CRYPTO_lock(10,1,"err.c",0x12a);
  }
  local_78[0] = uVar10 | uVar2;
  lVar3 = (**(code **)(err_fns + 0x10))(local_78);
  if (lVar3 == 0) {
    puVar4 = (ulong *)0x0;
    local_78[0] = uVar2;
    lVar3 = (**(code **)(err_fns + 0x10))(local_78);
    if (lVar3 != 0) goto LAB_004904a2;
  }
  else {
LAB_004904a2:
    puVar4 = *(ulong **)(lVar3 + 8);
  }
  if (pcVar6 == (char *)0x0) {
    BIO_snprintf(local_f8,0x40,"lib(%lu)",uVar1);
  }
  if (pcVar7 == (char *)0x0) {
    BIO_snprintf(local_b8,0x40,"func(%lu)",uVar9);
  }
  if (puVar4 == (ulong *)0x0) {
    BIO_snprintf((char *)local_78,0x40,"reason(%lu)",uVar2);
    puVar4 = local_78;
  }
  pcVar8 = local_b8;
  if (pcVar7 != (char *)0x0) {
    pcVar8 = pcVar7;
  }
  pcVar7 = local_f8;
  if (pcVar6 != (char *)0x0) {
    pcVar7 = pcVar6;
  }
  BIO_snprintf(buf,len,"error:%08lX:%s:%s:%s",e,pcVar7,pcVar8,puVar4);
  sVar5 = strlen(buf);
  if (sVar5 != len - 1) {
    return;
  }
  if (len < 5) {
    return;
  }
  pcVar6 = strchr(buf,0x3a);
  if ((pcVar6 == (char *)0x0) || (buf + (len - 5) < pcVar6)) {
    pcVar6 = buf + (len - 5);
    *pcVar6 = ':';
  }
  pcVar6 = strchr(pcVar6 + 1,0x3a);
  if (pcVar6 == (char *)0x0) {
    pcVar7 = buf + (len - 4);
LAB_00490573:
    *pcVar7 = ':';
    pcVar6 = pcVar7;
  }
  else {
    pcVar7 = buf + (len - 4);
    if (pcVar7 < pcVar6) goto LAB_00490573;
  }
  pcVar6 = strchr(pcVar6 + 1,0x3a);
  if (pcVar6 == (char *)0x0) {
    pcVar7 = buf + (len - 3);
  }
  else {
    pcVar7 = buf + (len - 3);
    if (pcVar6 <= pcVar7) goto LAB_0049059d;
  }
  *pcVar7 = ':';
  pcVar6 = pcVar7;
LAB_0049059d:
  pcVar6 = strchr(pcVar6 + 1,0x3a);
  if ((pcVar6 == (char *)0x0) || (buf + (len - 2) < pcVar6)) {
    buf[len - 2] = ':';
  }
  return;
}



char * ERR_error_string(ulong e,char *buf)

{
  if (buf == (char *)0x0) {
    buf = buf_5244;
  }
  ERR_error_string_n(e,buf,0x100);
  return buf;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

lhash_st_ERR_STRING_DATA * ERR_get_string_table(void)

{
  lhash_st_ERR_STRING_DATA *plVar1;
  
  if ((undefined8 *)err_fns != (undefined8 *)0x0) {
                    // WARNING: Could not recover jumptable at 0x00490851. Too many branches
                    // WARNING: Treating indirect jump as call
    plVar1 = (lhash_st_ERR_STRING_DATA *)(**(code **)err_fns)(0);
    return plVar1;
  }
  CRYPTO_lock(9,1,"err.c",0x127);
  if ((undefined8 *)err_fns == (undefined8 *)0x0) {
    err_fns = err_defaults;
  }
  CRYPTO_lock(10,1,"err.c",0x12a);
                    // WARNING: Could not recover jumptable at 0x004908a8. Too many branches
                    // WARNING: Treating indirect jump as call
  plVar1 = (lhash_st_ERR_STRING_DATA *)(**(code **)err_fns)(0);
  return plVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

lhash_st_ERR_STATE * ERR_get_err_state_table(void)

{
  lhash_st_ERR_STATE *plVar1;
  
  if (err_fns != (undefined1 *)0x0) {
                    // WARNING: Could not recover jumptable at 0x004908d2. Too many branches
                    // WARNING: Treating indirect jump as call
    plVar1 = (lhash_st_ERR_STATE *)(**(code **)(err_fns + 0x28))(0);
    return plVar1;
  }
  CRYPTO_lock(9,1,"err.c",0x127);
  if (err_fns == (undefined1 *)0x0) {
    err_fns = err_defaults;
  }
  CRYPTO_lock(10,1,"err.c",0x12a);
                    // WARNING: Could not recover jumptable at 0x00490929. Too many branches
                    // WARNING: Treating indirect jump as call
  plVar1 = (lhash_st_ERR_STATE *)(**(code **)(err_fns + 0x28))(0);
  return plVar1;
}



void ERR_release_err_state_table(lhash_st_ERR_STATE **hash)

{
  if (err_fns != (undefined1 *)0x0) {
                    // WARNING: Could not recover jumptable at 0x00490958. Too many branches
                    // WARNING: Treating indirect jump as call
    (**(code **)(err_fns + 0x30))(hash);
    return;
  }
  CRYPTO_lock(9,1,"err.c",0x127);
  if (err_fns == (undefined1 *)0x0) {
    err_fns = err_defaults;
  }
  CRYPTO_lock(10,1,"err.c",0x12a);
                    // WARNING: Could not recover jumptable at 0x004909ab. Too many branches
                    // WARNING: Treating indirect jump as call
  (**(code **)(err_fns + 0x30))(hash);
  return;
}



char * ERR_lib_error_string(ulong e)

{
  long lVar1;
  char *pcVar2;
  ulong local_18 [2];
  
  if (err_fns == (undefined1 *)0x0) {
    CRYPTO_lock(9,1,"err.c",0x127);
    if (err_fns == (undefined1 *)0x0) {
      err_fns = err_defaults;
    }
    CRYPTO_lock(10,1,"err.c",0x12a);
  }
  local_18[0] = (ulong)((uint)e & 0xff000000);
  lVar1 = (**(code **)(err_fns + 0x10))(local_18);
  if (lVar1 == 0) {
    pcVar2 = (char *)0x0;
  }
  else {
    pcVar2 = *(char **)(lVar1 + 8);
  }
  return pcVar2;
}



char * ERR_func_error_string(ulong e)

{
  long lVar1;
  char *pcVar2;
  ulong local_18 [2];
  
  if (err_fns == (undefined1 *)0x0) {
    CRYPTO_lock(9,1,"err.c",0x127);
    if (err_fns == (undefined1 *)0x0) {
      err_fns = err_defaults;
    }
    CRYPTO_lock(10,1,"err.c",0x12a);
  }
  local_18[0] = (ulong)((uint)e & 0xfffff000);
  lVar1 = (**(code **)(err_fns + 0x10))(local_18);
  if (lVar1 == 0) {
    pcVar2 = (char *)0x0;
  }
  else {
    pcVar2 = *(char **)(lVar1 + 8);
  }
  return pcVar2;
}



char * ERR_reason_error_string(ulong e)

{
  long lVar1;
  ulong local_28 [3];
  
  if (err_fns == (undefined1 *)0x0) {
    CRYPTO_lock(9,1,"err.c",0x127);
    if (err_fns == (undefined1 *)0x0) {
      err_fns = err_defaults;
    }
    CRYPTO_lock(10,1,"err.c",0x12a);
  }
  local_28[0] = (ulong)((uint)e & 0xff000fff);
  lVar1 = (**(code **)(err_fns + 0x10))(local_28);
  if ((lVar1 == 0) &&
     (local_28[0] = (ulong)((uint)e & 0xfff), lVar1 = (**(code **)(err_fns + 0x10))(local_28),
     lVar1 == 0)) {
    return (char *)0x0;
  }
  return *(char **)(lVar1 + 8);
}



void ERR_remove_thread_state(CRYPTO_THREADID *tid)

{
  CRYPTO_THREADID aCStack_268 [38];
  
  if (tid == (CRYPTO_THREADID *)0x0) {
    CRYPTO_THREADID_current(aCStack_268);
  }
  else {
    CRYPTO_THREADID_cpy(aCStack_268,tid);
  }
  if (err_fns != (undefined1 *)0x0) {
    (**(code **)(err_fns + 0x48))(aCStack_268);
    return;
  }
  CRYPTO_lock(9,1,"err.c",0x127);
  if (err_fns == (undefined1 *)0x0) {
    err_fns = err_defaults;
  }
  CRYPTO_lock(10,1,"err.c",0x12a);
  (**(code **)(err_fns + 0x48))(aCStack_268);
  return;
}



void ERR_remove_state(void)

{
  CRYPTO_THREADID aCStack_268 [38];
  
  CRYPTO_THREADID_current(aCStack_268);
  if (err_fns != (undefined1 *)0x0) {
    (**(code **)(err_fns + 0x48))(aCStack_268);
    return;
  }
  CRYPTO_lock(9,1,"err.c",0x127);
  if (err_fns == (undefined1 *)0x0) {
    err_fns = err_defaults;
  }
  CRYPTO_lock(10,1,"err.c",0x12a);
  (**(code **)(err_fns + 0x48))(aCStack_268);
  return;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

ERR_STATE * ERR_get_state(void)

{
  void *ptr;
  undefined1 *puVar1;
  ERR_STATE *dest;
  void *pvVar2;
  ulong uVar3;
  ulong uVar4;
  long lVar5;
  int *piVar6;
  char **ppcVar7;
  char **ppcVar8;
  int *piVar9;
  bool bVar10;
  byte bVar11;
  CRYPTO_THREADID local_288;
  CRYPTO_THREADID local_278 [38];
  
  bVar11 = 0;
  if (err_fns == (undefined1 *)0x0) {
    CRYPTO_lock(9,1,"err.c",0x127);
    if (err_fns == (undefined1 *)0x0) {
      err_fns = err_defaults;
    }
    CRYPTO_lock(10,1,"err.c",0x12a);
  }
  CRYPTO_THREADID_current(&local_288);
  CRYPTO_THREADID_cpy(local_278,&local_288);
  puVar1 = (undefined1 *)(**(code **)(err_fns + 0x38))(local_278);
  if ((ERR_STATE *)puVar1 == (ERR_STATE *)0x0) {
    dest = (ERR_STATE *)CRYPTO_malloc(600,"err.c",0x3fb);
    puVar1 = fallback_5284;
    if (dest != (ERR_STATE *)0x0) {
      CRYPTO_THREADID_cpy((CRYPTO_THREADID *)dest,&local_288);
      ppcVar7 = dest->err_data;
      dest->top = 0;
      dest->bottom = 0;
      uVar4 = 0x80;
      bVar10 = ((ulong)ppcVar7 & 1) != 0;
      if (bVar10) {
        *(undefined1 *)dest->err_data = 0;
        ppcVar7 = (char **)((long)dest->err_data + 1);
        uVar4 = 0x7f;
      }
      ppcVar8 = ppcVar7;
      if (((ulong)ppcVar7 & 2) != 0) {
        ppcVar8 = (char **)((long)ppcVar7 + 2);
        uVar4 = (ulong)((int)uVar4 - 2);
        *(undefined2 *)ppcVar7 = 0;
      }
      if (((ulong)ppcVar8 & 4) != 0) {
        *(undefined4 *)ppcVar8 = 0;
        uVar4 = (ulong)((int)uVar4 - 4);
        ppcVar8 = (char **)((long)ppcVar8 + 4);
      }
      for (uVar3 = uVar4 >> 3; uVar3 != 0; uVar3 = uVar3 - 1) {
        *ppcVar8 = (char *)0x0;
        ppcVar8 = ppcVar8 + (ulong)bVar11 * -2 + 1;
      }
      if ((uVar4 & 4) != 0) {
        *(undefined4 *)ppcVar8 = 0;
        ppcVar8 = (char **)((long)ppcVar8 + 4);
      }
      ppcVar7 = ppcVar8;
      if ((uVar4 & 2) != 0) {
        ppcVar7 = (char **)((long)ppcVar8 + 2);
        *(undefined2 *)ppcVar8 = 0;
      }
      if (bVar10) {
        *(undefined1 *)ppcVar7 = 0;
      }
      piVar6 = dest->err_data_flags;
      uVar4 = 0x40;
      bVar10 = ((ulong)piVar6 & 1) != 0;
      if (bVar10) {
        *(undefined1 *)dest->err_data_flags = 0;
        piVar6 = (int *)((long)dest->err_data_flags + 1);
        uVar4 = 0x3f;
      }
      piVar9 = piVar6;
      if (((ulong)piVar6 & 2) != 0) {
        piVar9 = (int *)((long)piVar6 + 2);
        uVar4 = (ulong)((int)uVar4 - 2);
        *(undefined2 *)piVar6 = 0;
      }
      if (((ulong)piVar9 & 4) != 0) {
        *piVar9 = 0;
        uVar4 = (ulong)((int)uVar4 - 4);
        piVar9 = piVar9 + 1;
      }
      for (uVar3 = uVar4 >> 3; uVar3 != 0; uVar3 = uVar3 - 1) {
        piVar9[0] = 0;
        piVar9[1] = 0;
        piVar9 = piVar9 + (ulong)bVar11 * -4 + 2;
      }
      if ((uVar4 & 4) != 0) {
        *piVar9 = 0;
        piVar9 = piVar9 + 1;
      }
      piVar6 = piVar9;
      if ((uVar4 & 2) != 0) {
        piVar6 = (int *)((long)piVar9 + 2);
        *(undefined2 *)piVar9 = 0;
      }
      if (bVar10) {
        *(undefined1 *)piVar6 = 0;
      }
      pvVar2 = (void *)(**(code **)(err_fns + 0x40))(dest);
      puVar1 = (undefined1 *)(**(code **)(err_fns + 0x38))(dest);
      if ((ERR_STATE *)puVar1 == dest) {
        if (pvVar2 != (void *)0x0) {
          lVar5 = 0;
          do {
            ptr = *(void **)((long)pvVar2 + lVar5 * 2 + 0xd0);
            if ((ptr != (void *)0x0) && ((*(byte *)((long)pvVar2 + lVar5 + 0x150) & 1) != 0)) {
              CRYPTO_free(ptr);
              *(undefined8 *)((long)pvVar2 + lVar5 * 2 + 0xd0) = 0;
            }
            *(undefined4 *)((long)pvVar2 + lVar5 + 0x150) = 0;
            lVar5 = lVar5 + 4;
          } while (lVar5 != 0x40);
          CRYPTO_free(pvVar2);
        }
      }
      else {
        lVar5 = 0;
        do {
          pvVar2 = *(void **)((long)dest->err_data + lVar5 * 2);
          if ((pvVar2 != (void *)0x0) && ((*(byte *)((long)dest->err_data_flags + lVar5) & 1) != 0))
          {
            CRYPTO_free(pvVar2);
            *(undefined8 *)((long)dest->err_data + lVar5 * 2) = 0;
          }
          *(undefined4 *)((long)dest->err_data_flags + lVar5) = 0;
          lVar5 = lVar5 + 4;
        } while (lVar5 != 0x40);
        CRYPTO_free(dest);
        puVar1 = fallback_5284;
      }
    }
  }
  return (ERR_STATE *)puVar1;
}



void ERR_put_error(int lib,int func,int reason,char *file,int line)

{
  ERR_STATE *pEVar1;
  int iVar2;
  long lVar3;
  
  pEVar1 = ERR_get_state();
  iVar2 = (pEVar1->top + 1) % 0x10;
  pEVar1->top = iVar2;
  if (iVar2 == pEVar1->bottom) {
    pEVar1->bottom = (iVar2 + 1) % 0x10;
  }
  lVar3 = (long)iVar2;
  pEVar1->err_flags[lVar3] = 0;
  pEVar1->err_file[lVar3] = file;
  pEVar1->err_buffer[lVar3] =
       (ulong)(func & 0xfff) << 0xc | (ulong)(reason & 0xfff) | ((ulong)(uint)lib & 0xff) << 0x18;
  pEVar1->err_line[lVar3] = line;
  if ((pEVar1->err_data[lVar3] != (char *)0x0) && ((pEVar1->err_data_flags[lVar3] & 1) != 0)) {
    CRYPTO_free(pEVar1->err_data[lVar3]);
    lVar3 = (long)pEVar1->top;
    pEVar1->err_data[lVar3] = (char *)0x0;
  }
  pEVar1->err_data_flags[lVar3] = 0;
  return;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

void ERR_clear_error(void)

{
  ERR_STATE *pEVar1;
  ERR_STATE *pEVar2;
  ERR_STATE *pEVar3;
  int iVar4;
  
  iVar4 = 0x10;
  pEVar1 = ERR_get_state();
  pEVar2 = pEVar1;
  pEVar3 = pEVar1;
  do {
    pEVar2->err_flags[0] = 0;
    pEVar3->err_buffer[0] = 0;
    if ((pEVar3->err_data[0] != (char *)0x0) && ((pEVar2->err_data_flags[0] & 1) != 0)) {
      CRYPTO_free(pEVar3->err_data[0]);
      pEVar3->err_data[0] = (char *)0x0;
    }
    pEVar2->err_data_flags[0] = 0;
    pEVar3->err_file[0] = (char *)0x0;
    pEVar2->err_line[0] = -1;
    iVar4 = iVar4 + -1;
    pEVar2 = (ERR_STATE *)((long)&(pEVar2->tid).ptr + 4);
    pEVar3 = (ERR_STATE *)&(pEVar3->tid).val;
  } while (iVar4 != 0);
  pEVar1->bottom = 0;
  pEVar1->top = 0;
  return;
}



ulong ERR_get_error_line_data(char **file,int *line,char **data,int *flags)

{
  ulong uVar1;
  ERR_STATE *pEVar2;
  int iVar3;
  
  pEVar2 = ERR_get_state();
  if (pEVar2->bottom != pEVar2->top) {
    iVar3 = (pEVar2->bottom + 1) % 0x10;
    uVar1 = pEVar2->err_buffer[iVar3];
    pEVar2->bottom = iVar3;
    pEVar2->err_buffer[iVar3] = 0;
    if ((file != (char **)0x0) && (line != (int *)0x0)) {
      if (pEVar2->err_file[iVar3] == (char *)0x0) {
        *file = "NA";
        *line = 0;
      }
      else {
        *file = pEVar2->err_file[iVar3];
        *line = pEVar2->err_line[iVar3];
      }
    }
    if (data == (char **)0x0) {
      if ((pEVar2->err_data[iVar3] != (char *)0x0) && ((pEVar2->err_data_flags[iVar3] & 1) != 0)) {
        CRYPTO_free(pEVar2->err_data[iVar3]);
        pEVar2->err_data[iVar3] = (char *)0x0;
      }
      pEVar2->err_data_flags[iVar3] = 0;
    }
    else if (pEVar2->err_data[iVar3] == (char *)0x0) {
      *data = "";
      if (flags != (int *)0x0) {
        *flags = 0;
      }
    }
    else {
      *data = pEVar2->err_data[iVar3];
      if (flags != (int *)0x0) {
        *flags = pEVar2->err_data_flags[iVar3];
      }
    }
    return uVar1;
  }
  return 0;
}



ulong ERR_get_error_line(char **file,int *line)

{
  ulong uVar1;
  ERR_STATE *pEVar2;
  int iVar3;
  
  pEVar2 = ERR_get_state();
  if (pEVar2->bottom != pEVar2->top) {
    iVar3 = (pEVar2->bottom + 1) % 0x10;
    uVar1 = pEVar2->err_buffer[iVar3];
    pEVar2->bottom = iVar3;
    pEVar2->err_buffer[iVar3] = 0;
    if ((file != (char **)0x0) && (line != (int *)0x0)) {
      if (pEVar2->err_file[iVar3] == (char *)0x0) {
        *file = "NA";
        *line = 0;
      }
      else {
        *file = pEVar2->err_file[iVar3];
        *line = pEVar2->err_line[iVar3];
      }
    }
    if ((pEVar2->err_data[iVar3] != (char *)0x0) && ((pEVar2->err_data_flags[iVar3] & 1) != 0)) {
      CRYPTO_free(pEVar2->err_data[iVar3]);
      pEVar2->err_data[iVar3] = (char *)0x0;
    }
    pEVar2->err_data_flags[iVar3] = 0;
    return uVar1;
  }
  return 0;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

ulong ERR_peek_last_error(void)

{
  ERR_STATE *pEVar1;
  
  pEVar1 = ERR_get_state();
  if (pEVar1->bottom != pEVar1->top) {
    return pEVar1->err_buffer[pEVar1->top];
  }
  return 0;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

ulong ERR_peek_error(void)

{
  ERR_STATE *pEVar1;
  
  pEVar1 = ERR_get_state();
  if (pEVar1->bottom != pEVar1->top) {
    return pEVar1->err_buffer[(pEVar1->bottom + 1) % 0x10];
  }
  return 0;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

ulong ERR_get_error(void)

{
  ulong uVar1;
  ERR_STATE *pEVar2;
  int iVar3;
  
  pEVar2 = ERR_get_state();
  if (pEVar2->bottom != pEVar2->top) {
    iVar3 = (pEVar2->bottom + 1) % 0x10;
    uVar1 = pEVar2->err_buffer[iVar3];
    pEVar2->bottom = iVar3;
    pEVar2->err_buffer[iVar3] = 0;
    if ((pEVar2->err_data[iVar3] != (char *)0x0) && ((pEVar2->err_data_flags[iVar3] & 1) != 0)) {
      CRYPTO_free(pEVar2->err_data[iVar3]);
      pEVar2->err_data[iVar3] = (char *)0x0;
    }
    pEVar2->err_data_flags[iVar3] = 0;
    return uVar1;
  }
  return 0;
}



ulong ERR_peek_last_error_line(char **file,int *line)

{
  int iVar1;
  int iVar2;
  ulong uVar3;
  ERR_STATE *pEVar4;
  
  pEVar4 = ERR_get_state();
  iVar1 = pEVar4->top;
  if (pEVar4->bottom == iVar1) {
    return 0;
  }
  uVar3 = pEVar4->err_buffer[iVar1];
  if ((file != (char **)0x0) && (line != (int *)0x0)) {
    if (pEVar4->err_file[iVar1] != (char *)0x0) {
      iVar2 = pEVar4->err_line[iVar1];
      *file = pEVar4->err_file[iVar1];
      *line = iVar2;
      return uVar3;
    }
    *file = "NA";
    *line = 0;
  }
  return uVar3;
}



ulong ERR_peek_error_line(char **file,int *line)

{
  int iVar1;
  ulong uVar2;
  ERR_STATE *pEVar3;
  int iVar4;
  
  pEVar3 = ERR_get_state();
  if (pEVar3->bottom == pEVar3->top) {
    return 0;
  }
  iVar4 = (pEVar3->bottom + 1) % 0x10;
  uVar2 = pEVar3->err_buffer[iVar4];
  if ((file != (char **)0x0) && (line != (int *)0x0)) {
    if (pEVar3->err_file[iVar4] != (char *)0x0) {
      iVar1 = pEVar3->err_line[iVar4];
      *file = pEVar3->err_file[iVar4];
      *line = iVar1;
      return uVar2;
    }
    *file = "NA";
    *line = 0;
  }
  return uVar2;
}



ulong ERR_peek_last_error_line_data(char **file,int *line,char **data,int *flags)

{
  int iVar1;
  ulong uVar2;
  ERR_STATE *pEVar3;
  
  pEVar3 = ERR_get_state();
  iVar1 = pEVar3->top;
  if (pEVar3->bottom == iVar1) {
    return 0;
  }
  uVar2 = pEVar3->err_buffer[iVar1];
  if ((file != (char **)0x0) && (line != (int *)0x0)) {
    if (pEVar3->err_file[iVar1] == (char *)0x0) {
      *file = "NA";
      *line = 0;
    }
    else {
      *file = pEVar3->err_file[iVar1];
      *line = pEVar3->err_line[iVar1];
    }
  }
  if (data == (char **)0x0) {
    return uVar2;
  }
  if (pEVar3->err_data[iVar1] == (char *)0x0) {
    *data = "";
    if (flags == (int *)0x0) {
      return uVar2;
    }
    *flags = 0;
  }
  else {
    *data = pEVar3->err_data[iVar1];
    if (flags == (int *)0x0) {
      return uVar2;
    }
    *flags = pEVar3->err_data_flags[iVar1];
  }
  return uVar2;
}



ulong ERR_peek_error_line_data(char **file,int *line,char **data,int *flags)

{
  ulong uVar1;
  ERR_STATE *pEVar2;
  int iVar3;
  
  pEVar2 = ERR_get_state();
  if (pEVar2->bottom == pEVar2->top) {
    return 0;
  }
  iVar3 = (pEVar2->bottom + 1) % 0x10;
  uVar1 = pEVar2->err_buffer[iVar3];
  if ((file != (char **)0x0) && (line != (int *)0x0)) {
    if (pEVar2->err_file[iVar3] == (char *)0x0) {
      *file = "NA";
      *line = 0;
    }
    else {
      *file = pEVar2->err_file[iVar3];
      *line = pEVar2->err_line[iVar3];
    }
  }
  if (data == (char **)0x0) {
    return uVar1;
  }
  if (pEVar2->err_data[iVar3] == (char *)0x0) {
    *data = "";
    if (flags == (int *)0x0) {
      return uVar1;
    }
    *flags = 0;
  }
  else {
    *data = pEVar2->err_data[iVar3];
    if (flags == (int *)0x0) {
      return uVar1;
    }
    *flags = pEVar2->err_data_flags[iVar3];
  }
  return uVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

int ERR_get_next_error_library(void)

{
  int iVar1;
  
  if (err_fns != (undefined1 *)0x0) {
                    // WARNING: Could not recover jumptable at 0x00491900. Too many branches
                    // WARNING: Treating indirect jump as call
    iVar1 = (**(code **)(err_fns + 0x50))();
    return iVar1;
  }
  CRYPTO_lock(9,1,"err.c",0x127);
  if (err_fns == (undefined1 *)0x0) {
    err_fns = err_defaults;
  }
  CRYPTO_lock(10,1,"err.c",0x12a);
                    // WARNING: Could not recover jumptable at 0x00491957. Too many branches
                    // WARNING: Treating indirect jump as call
  iVar1 = (**(code **)(err_fns + 0x50))();
  return iVar1;
}



void ERR_set_error_data(char *data,int flags)

{
  ERR_STATE *pEVar1;
  int iVar2;
  
  pEVar1 = ERR_get_state();
  iVar2 = pEVar1->top;
  if (iVar2 == 0) {
    iVar2 = 0xf;
  }
  if ((pEVar1->err_data[iVar2] != (char *)0x0) && ((pEVar1->err_data_flags[iVar2] & 1) != 0)) {
    CRYPTO_free(pEVar1->err_data[iVar2]);
  }
  pEVar1->err_data[iVar2] = data;
  pEVar1->err_data_flags[iVar2] = flags;
  return;
}



void ERR_add_error_vdata(int num,va_list args)

{
  uint uVar1;
  char *__s;
  char *dst;
  size_t sVar2;
  ERR_STATE *pEVar3;
  undefined8 *puVar4;
  int iVar5;
  int iVar6;
  int iVar7;
  char *addr;
  
  dst = (char *)CRYPTO_malloc(0x51,"err.c",0x438);
  if (dst != (char *)0x0) {
    *dst = '\0';
    if (0 < num) {
      iVar7 = 0x50;
      iVar5 = 0;
      iVar6 = 0;
      addr = dst;
      do {
                    // WARNING: Load size is inaccurate
        uVar1 = *args;
        if (uVar1 < 0x30) {
          puVar4 = (undefined8 *)((ulong)uVar1 + *(long *)((long)args + 0x10));
          *(uint *)args = uVar1 + 8;
        }
        else {
          puVar4 = *(undefined8 **)((long)args + 8);
          *(undefined8 **)((long)args + 8) = puVar4 + 1;
        }
        __s = (char *)*puVar4;
        dst = addr;
        if (__s != (char *)0x0) {
          sVar2 = strlen(__s);
          iVar5 = iVar5 + (int)sVar2;
          if (iVar7 < iVar5) {
            iVar7 = iVar5 + 0x14;
            dst = (char *)CRYPTO_realloc(addr,iVar5 + 0x15,"err.c",0x447);
            if (dst == (char *)0x0) {
              CRYPTO_free(addr);
              return;
            }
          }
          BUF_strlcat(dst,__s,(long)iVar7 + 1);
        }
        iVar6 = iVar6 + 1;
        addr = dst;
      } while (iVar6 != num);
    }
    pEVar3 = ERR_get_state();
    iVar7 = pEVar3->top;
    if (iVar7 == 0) {
      iVar7 = 0xf;
    }
    if ((pEVar3->err_data[iVar7] != (char *)0x0) && ((pEVar3->err_data_flags[iVar7] & 1) != 0)) {
      CRYPTO_free(pEVar3->err_data[iVar7]);
    }
    pEVar3->err_data[iVar7] = dst;
    pEVar3->err_data_flags[iVar7] = 3;
  }
  return;
}



void ERR_add_error_data(int num,...)

{
  char in_AL;
  undefined8 in_RCX;
  undefined8 in_RDX;
  undefined8 in_RSI;
  undefined8 in_R8;
  undefined8 in_R9;
  undefined8 in_XMM0_Qa;
  undefined8 in_XMM1_Qa;
  undefined8 in_XMM2_Qa;
  undefined8 in_XMM3_Qa;
  undefined8 in_XMM4_Qa;
  undefined8 in_XMM5_Qa;
  undefined8 in_XMM6_Qa;
  undefined8 in_XMM7_Qa;
  undefined4 local_d0;
  undefined4 local_cc;
  undefined1 *local_c8;
  undefined1 *local_c0;
  undefined1 local_b8 [8];
  undefined8 local_b0;
  undefined8 local_a8;
  undefined8 local_a0;
  undefined8 local_98;
  undefined8 local_90;
  undefined8 local_88;
  undefined8 local_78;
  undefined8 local_68;
  undefined8 local_58;
  undefined8 local_48;
  undefined8 local_38;
  undefined8 local_28;
  undefined8 local_18;
  
  if (in_AL != '\0') {
    local_88 = in_XMM0_Qa;
    local_78 = in_XMM1_Qa;
    local_68 = in_XMM2_Qa;
    local_58 = in_XMM3_Qa;
    local_48 = in_XMM4_Qa;
    local_38 = in_XMM5_Qa;
    local_28 = in_XMM6_Qa;
    local_18 = in_XMM7_Qa;
  }
  local_c8 = &stack0x00000008;
  local_c0 = local_b8;
  local_d0 = 8;
  local_cc = 0x30;
  local_b0 = in_RSI;
  local_a8 = in_RDX;
  local_a0 = in_RCX;
  local_98 = in_R8;
  local_90 = in_R9;
  ERR_add_error_vdata(num,&local_d0);
  return;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

int ERR_set_mark(void)

{
  ERR_STATE *pEVar1;
  
  pEVar1 = ERR_get_state();
  if (pEVar1->bottom != pEVar1->top) {
    pEVar1->err_flags[pEVar1->top] = pEVar1->err_flags[pEVar1->top] | 1;
    return 1;
  }
  return 0;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

int ERR_pop_to_mark(void)

{
  ERR_STATE *pEVar1;
  long lVar2;
  int iVar3;
  int iVar4;
  
  pEVar1 = ERR_get_state();
  iVar3 = pEVar1->top;
  iVar4 = pEVar1->bottom;
  while( true ) {
    if (iVar3 == iVar4) {
      return 0;
    }
    lVar2 = (long)iVar3;
    if ((pEVar1->err_flags[lVar2] & 1U) != 0) break;
    pEVar1->err_flags[lVar2] = 0;
    pEVar1->err_buffer[lVar2] = 0;
    if ((pEVar1->err_data[lVar2] != (char *)0x0) && ((pEVar1->err_data_flags[lVar2] & 1) != 0)) {
      CRYPTO_free(pEVar1->err_data[lVar2]);
      iVar3 = pEVar1->top;
      iVar4 = pEVar1->bottom;
      lVar2 = (long)iVar3;
      pEVar1->err_data[lVar2] = (char *)0x0;
    }
    iVar3 = iVar3 + -1;
    pEVar1->err_data_flags[lVar2] = 0;
    pEVar1->err_file[lVar2] = (char *)0x0;
    pEVar1->err_line[lVar2] = -1;
    pEVar1->top = iVar3;
    if (iVar3 == -1) {
      pEVar1->top = 0xf;
      iVar3 = 0xf;
    }
  }
  pEVar1->err_flags[lVar2] = pEVar1->err_flags[lVar2] & 0xfffffffe;
  return 1;
}



long mem_LHASH_COMP(long *param_1,long *param_2)

{
  return *param_1 - *param_2;
}



long mem_LHASH_HASH(ulong *param_1)

{
  ulong uVar1;
  
  uVar1 = *param_1;
  return uVar1 * 0x45bb + (uVar1 >> 4) * 0xfb + (uVar1 >> 0xe) * 7;
}



void cb_leak_LHASH_DOALL_ARG(undefined8 *param_1,undefined8 *param_2)

{
                    // WARNING: Could not recover jumptable at 0x00491d6a. Too many branches
                    // WARNING: Treating indirect jump as call
  (*(code *)*param_2)(param_1[6],param_1[2],*(undefined4 *)(param_1 + 3),
                      *(undefined4 *)(param_1 + 1),*param_1,(code *)*param_2);
  return;
}



int app_info_LHASH_COMP(CRYPTO_THREADID *a,CRYPTO_THREADID *b)

{
  int iVar1;
  
  iVar1 = memcmp(a,b,0x10);
  return iVar1;
}



long app_info_LHASH_HASH(CRYPTO_THREADID *param_1)

{
  ulong uVar1;
  
  uVar1 = CRYPTO_THREADID_hash(param_1);
  return (uVar1 >> 4) * 0xfb + (uVar1 >> 0xe) * 7 + uVar1 * 0x45bb;
}



void print_leak_doall_arg(long *param_1,long *param_2)

{
  void *pvVar1;
  int iVar2;
  uint uVar3;
  uint uVar4;
  size_t sVar5;
  ulong uVar6;
  size_t sVar7;
  tm *ptVar8;
  ulong uVar9;
  uint uVar10;
  int iVar11;
  uint *puVar12;
  CRYPTO_THREADID *src;
  undefined1 *n;
  char *pcVar13;
  uint *puVar14;
  int iVar15;
  long lVar16;
  bool bVar17;
  CRYPTO_THREADID local_448;
  uint local_438 [256];
  undefined1 auStack_38 [8];
  
  if (*param_1 != *param_2) {
    if (((byte)options & 1) == 0) {
      puVar14 = local_438;
      n = (undefined1 *)0x400;
    }
    else {
      ptVar8 = localtime(param_1 + 7);
      BIO_snprintf((char *)local_438,0x400,"[%02d:%02d:%02d] ",(ulong)(uint)ptVar8->tm_hour,
                   (ulong)(uint)ptVar8->tm_min,(ulong)(uint)ptVar8->tm_sec);
      puVar14 = local_438;
      do {
        puVar12 = puVar14;
        uVar4 = *puVar12 + 0xfefefeff & ~*puVar12;
        uVar3 = uVar4 & 0x80808080;
        puVar14 = puVar12 + 1;
      } while (uVar3 == 0);
      puVar14 = (uint *)((long)puVar12 + 6);
      uVar10 = uVar3 >> 0x10;
      if ((uVar4 & 0x8080) != 0) {
        puVar14 = puVar12 + 1;
        uVar10 = uVar3;
      }
      puVar14 = (uint *)((long)puVar14 + (-3 - (ulong)CARRY1((byte)uVar10,(byte)uVar10)));
      n = auStack_38 + -(long)puVar14;
    }
    BIO_snprintf((char *)puVar14,(size_t)n,"%5lu file=%s, line=%d, ",param_1[6],param_1[2],
                 (ulong)*(uint *)(param_1 + 3));
    sVar5 = strlen((char *)puVar14);
    pcVar13 = (char *)((long)puVar14 + sVar5);
    if (((byte)options & 2) != 0) {
      uVar9 = CRYPTO_THREADID_hash((CRYPTO_THREADID *)(param_1 + 4));
      BIO_snprintf(pcVar13,(size_t)(auStack_38 + -(long)pcVar13),"thread=%lu, ",uVar9);
      sVar5 = strlen(pcVar13);
      pcVar13 = pcVar13 + sVar5;
    }
    BIO_snprintf(pcVar13,(size_t)(auStack_38 + -(long)pcVar13),"number=%d, address=%08lX\n",
                 (ulong)*(uint *)(param_1 + 1),*param_1);
    BIO_puts((BIO *)*param_2,(char *)local_438);
    lVar16 = param_1[1];
    src = (CRYPTO_THREADID *)param_1[8];
    *(int *)(param_2 + 1) = (int)param_2[1] + 1;
    param_2[2] = param_2[2] + (long)(int)lVar16;
    if (src != (CRYPTO_THREADID *)0x0) {
      sVar5 = 1;
      CRYPTO_THREADID_cpy(&local_448,src);
      do {
        memset(local_438,0x3e,sVar5);
        uVar9 = src[1].val;
        pvVar1 = src[1].ptr;
        uVar6 = CRYPTO_THREADID_hash(src);
        BIO_snprintf((char *)((long)local_438 + sVar5),0x400 - sVar5,
                     " thread=%lu, file=%s, line=%d, info=\"",uVar6,pvVar1,(int)uVar9);
        puVar14 = local_438;
        do {
          puVar12 = puVar14;
          uVar3 = *puVar12 + 0xfefefeff & ~*puVar12;
          uVar4 = uVar3 & 0x80808080;
          puVar14 = puVar12 + 1;
        } while (uVar4 == 0);
        pcVar13 = (char *)src[2].ptr;
        bVar17 = (uVar3 & 0x8080) == 0;
        if (bVar17) {
          uVar4 = uVar4 >> 0x10;
        }
        if (bVar17) {
          puVar14 = (uint *)((long)puVar12 + 6);
        }
        iVar2 = (int)local_438;
        iVar15 = (((int)puVar14 + -3) - (uint)CARRY1((byte)uVar4,(byte)uVar4)) - iVar2;
        sVar7 = strlen(pcVar13);
        iVar11 = 0x7d - iVar15;
        lVar16 = (long)iVar15;
        if (iVar11 < (int)sVar7) {
          memcpy((void *)((long)local_438 + lVar16),pcVar13,(long)iVar11);
          sVar7 = 899;
          lVar16 = 0x7d;
        }
        else {
          BUF_strlcpy((char *)((long)local_438 + lVar16),pcVar13,0x400 - lVar16);
          puVar14 = local_438;
          do {
            puVar12 = puVar14;
            uVar3 = *puVar12 + 0xfefefeff & ~*puVar12;
            uVar4 = uVar3 & 0x80808080;
            puVar14 = puVar12 + 1;
          } while (uVar4 == 0);
          bVar17 = (uVar3 & 0x8080) == 0;
          if (bVar17) {
            uVar4 = uVar4 >> 0x10;
          }
          if (bVar17) {
            puVar14 = (uint *)((long)puVar12 + 6);
          }
          lVar16 = (long)(int)((((int)puVar14 + -3) - (uint)CARRY1((byte)uVar4,(byte)uVar4)) - iVar2
                              );
          sVar7 = 0x400 - lVar16;
        }
        BIO_snprintf((char *)(lVar16 + (long)local_438),sVar7,"\"\n");
        BIO_puts((BIO *)*param_2,(char *)local_438);
        src = (CRYPTO_THREADID *)src[2].val;
        if (src == (CRYPTO_THREADID *)0x0) {
          return;
        }
        sVar5 = sVar5 + 1;
        iVar2 = CRYPTO_THREADID_cmp(src,&local_448);
      } while (iVar2 == 0);
    }
  }
  return;
}



void print_leak_LHASH_DOALL_ARG(long *param_1,long *param_2)

{
  void *pvVar1;
  int iVar2;
  uint uVar3;
  uint uVar4;
  size_t sVar5;
  ulong uVar6;
  size_t sVar7;
  tm *ptVar8;
  ulong uVar9;
  uint uVar10;
  int iVar11;
  uint *puVar12;
  CRYPTO_THREADID *src;
  undefined1 *n;
  char *pcVar13;
  uint *puVar14;
  int iVar15;
  long lVar16;
  bool bVar17;
  CRYPTO_THREADID CStack_448;
  uint auStack_438 [256];
  undefined1 auStack_38 [8];
  
  if (*param_1 != *param_2) {
    if (((byte)options & 1) == 0) {
      puVar14 = auStack_438;
      n = (undefined1 *)0x400;
    }
    else {
      ptVar8 = localtime(param_1 + 7);
      BIO_snprintf((char *)auStack_438,0x400,"[%02d:%02d:%02d] ",(ulong)(uint)ptVar8->tm_hour,
                   (ulong)(uint)ptVar8->tm_min,(ulong)(uint)ptVar8->tm_sec);
      puVar14 = auStack_438;
      do {
        puVar12 = puVar14;
        uVar4 = *puVar12 + 0xfefefeff & ~*puVar12;
        uVar3 = uVar4 & 0x80808080;
        puVar14 = puVar12 + 1;
      } while (uVar3 == 0);
      puVar14 = (uint *)((long)puVar12 + 6);
      uVar10 = uVar3 >> 0x10;
      if ((uVar4 & 0x8080) != 0) {
        puVar14 = puVar12 + 1;
        uVar10 = uVar3;
      }
      puVar14 = (uint *)((long)puVar14 + (-3 - (ulong)CARRY1((byte)uVar10,(byte)uVar10)));
      n = auStack_38 + -(long)puVar14;
    }
    BIO_snprintf((char *)puVar14,(size_t)n,"%5lu file=%s, line=%d, ",param_1[6],param_1[2],
                 (ulong)*(uint *)(param_1 + 3));
    sVar5 = strlen((char *)puVar14);
    pcVar13 = (char *)((long)puVar14 + sVar5);
    if (((byte)options & 2) != 0) {
      uVar9 = CRYPTO_THREADID_hash((CRYPTO_THREADID *)(param_1 + 4));
      BIO_snprintf(pcVar13,(size_t)(auStack_38 + -(long)pcVar13),"thread=%lu, ",uVar9);
      sVar5 = strlen(pcVar13);
      pcVar13 = pcVar13 + sVar5;
    }
    BIO_snprintf(pcVar13,(size_t)(auStack_38 + -(long)pcVar13),"number=%d, address=%08lX\n",
                 (ulong)*(uint *)(param_1 + 1),*param_1);
    BIO_puts((BIO *)*param_2,(char *)auStack_438);
    lVar16 = param_1[1];
    src = (CRYPTO_THREADID *)param_1[8];
    *(int *)(param_2 + 1) = (int)param_2[1] + 1;
    param_2[2] = param_2[2] + (long)(int)lVar16;
    if (src != (CRYPTO_THREADID *)0x0) {
      sVar5 = 1;
      CRYPTO_THREADID_cpy(&CStack_448,src);
      do {
        memset(auStack_438,0x3e,sVar5);
        uVar9 = src[1].val;
        pvVar1 = src[1].ptr;
        uVar6 = CRYPTO_THREADID_hash(src);
        BIO_snprintf((char *)((long)auStack_438 + sVar5),0x400 - sVar5,
                     " thread=%lu, file=%s, line=%d, info=\"",uVar6,pvVar1,(int)uVar9);
        puVar14 = auStack_438;
        do {
          puVar12 = puVar14;
          uVar3 = *puVar12 + 0xfefefeff & ~*puVar12;
          uVar4 = uVar3 & 0x80808080;
          puVar14 = puVar12 + 1;
        } while (uVar4 == 0);
        pcVar13 = (char *)src[2].ptr;
        bVar17 = (uVar3 & 0x8080) == 0;
        if (bVar17) {
          uVar4 = uVar4 >> 0x10;
        }
        if (bVar17) {
          puVar14 = (uint *)((long)puVar12 + 6);
        }
        iVar2 = (int)auStack_438;
        iVar15 = (((int)puVar14 + -3) - (uint)CARRY1((byte)uVar4,(byte)uVar4)) - iVar2;
        sVar7 = strlen(pcVar13);
        iVar11 = 0x7d - iVar15;
        lVar16 = (long)iVar15;
        if (iVar11 < (int)sVar7) {
          memcpy((void *)((long)auStack_438 + lVar16),pcVar13,(long)iVar11);
          sVar7 = 899;
          lVar16 = 0x7d;
        }
        else {
          BUF_strlcpy((char *)((long)auStack_438 + lVar16),pcVar13,0x400 - lVar16);
          puVar14 = auStack_438;
          do {
            puVar12 = puVar14;
            uVar3 = *puVar12 + 0xfefefeff & ~*puVar12;
            uVar4 = uVar3 & 0x80808080;
            puVar14 = puVar12 + 1;
          } while (uVar4 == 0);
          bVar17 = (uVar3 & 0x8080) == 0;
          if (bVar17) {
            uVar4 = uVar4 >> 0x10;
          }
          if (bVar17) {
            puVar14 = (uint *)((long)puVar12 + 6);
          }
          lVar16 = (long)(int)((((int)puVar14 + -3) - (uint)CARRY1((byte)uVar4,(byte)uVar4)) - iVar2
                              );
          sVar7 = 0x400 - lVar16;
        }
        BIO_snprintf((char *)(lVar16 + (long)auStack_438),sVar7,"\"\n");
        BIO_puts((BIO *)*param_2,(char *)auStack_438);
        src = (CRYPTO_THREADID *)src[2].val;
        if (src == (CRYPTO_THREADID *)0x0) {
          return;
        }
        sVar5 = sVar5 + 1;
        iVar2 = CRYPTO_THREADID_cmp(src,&CStack_448);
      } while (iVar2 == 0);
    }
  }
  return;
}



uint CRYPTO_mem_ctrl_constprop_4(void)

{
  uint uVar1;
  int iVar2;
  CRYPTO_THREADID CStack_18;
  
  uVar1 = mh_mode;
  CRYPTO_lock(9,0x14,"mem_dbg.c",0xdc);
  if ((mh_mode & 1) != 0) {
    CRYPTO_THREADID_current(&CStack_18);
    if ((num_disable == 0) ||
       (iVar2 = CRYPTO_THREADID_cmp((CRYPTO_THREADID *)disabling_threadid,&CStack_18), iVar2 != 0))
    {
      CRYPTO_lock(10,0x14,"mem_dbg.c",0xfa);
      CRYPTO_lock(9,0x1b,"mem_dbg.c",0x100);
      CRYPTO_lock(9,0x14,"mem_dbg.c",0x101);
      mh_mode = mh_mode & 0xfffffffd;
      CRYPTO_THREADID_cpy((CRYPTO_THREADID *)disabling_threadid,&CStack_18);
    }
    num_disable = num_disable + 1;
  }
  CRYPTO_lock(10,0x14,"mem_dbg.c",0x11a);
  return uVar1;
}



void app_info_free(void *param_1)

{
  void *ptr;
  int iVar1;
  
  iVar1 = *(int *)((long)param_1 + 0x30) + -1;
  *(int *)((long)param_1 + 0x30) = iVar1;
  if (0 < iVar1) {
    return;
  }
  ptr = *(void **)((long)param_1 + 0x28);
  if ((ptr != (void *)0x0) &&
     (iVar1 = *(int *)((long)ptr + 0x30) + -1, *(int *)((long)ptr + 0x30) = iVar1, iVar1 < 1)) {
    if (*(long *)((long)ptr + 0x28) != 0) {
      app_info_free();
    }
    CRYPTO_free(ptr);
  }
  CRYPTO_free(param_1);
  return;
}



int CRYPTO_mem_ctrl(int mode)

{
  uint uVar1;
  int iVar2;
  CRYPTO_THREADID CStack_28;
  
  uVar1 = mh_mode;
  CRYPTO_lock(9,0x14,"mem_dbg.c",0xdc);
  if (mode == 1) {
    mh_mode = 3;
    num_disable = 0;
  }
  else if (mode < 2) {
    if (mode == 0) {
      mh_mode = 0;
      num_disable = 0;
    }
  }
  else if (mode == 2) {
    if ((((mh_mode & 1) != 0) && (num_disable != 0)) &&
       (num_disable = num_disable + -1, num_disable == 0)) {
      mh_mode = mh_mode | 2;
      CRYPTO_lock(10,0x1b,"mem_dbg.c",0x111);
    }
  }
  else if ((mode == 3) && ((mh_mode & 1) != 0)) {
    CRYPTO_THREADID_current(&CStack_28);
    if ((num_disable == 0) ||
       (iVar2 = CRYPTO_THREADID_cmp((CRYPTO_THREADID *)disabling_threadid,&CStack_28), iVar2 != 0))
    {
      CRYPTO_lock(10,0x14,"mem_dbg.c",0xfa);
      CRYPTO_lock(9,0x1b,"mem_dbg.c",0x100);
      CRYPTO_lock(9,0x14,"mem_dbg.c",0x101);
      mh_mode = mh_mode & 0xfffffffd;
      CRYPTO_THREADID_cpy((CRYPTO_THREADID *)disabling_threadid,&CStack_28);
    }
    num_disable = num_disable + 1;
  }
  CRYPTO_lock(10,0x14,"mem_dbg.c",0x11a);
  return uVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

int CRYPTO_is_mem_check_on(void)

{
  int iVar1;
  uint uVar2;
  CRYPTO_THREADID CStack_18;
  
  if (((byte)mh_mode & 1) == 0) {
    return 0;
  }
  uVar2 = 1;
  CRYPTO_THREADID_current(&CStack_18);
  CRYPTO_lock(5,0x14,"mem_dbg.c",0x126);
  if (((byte)mh_mode & 2) == 0) {
    iVar1 = CRYPTO_THREADID_cmp((CRYPTO_THREADID *)disabling_threadid,&CStack_18);
    uVar2 = (uint)(iVar1 != 0);
  }
  CRYPTO_lock(6,0x14,"mem_dbg.c",299);
  return uVar2;
}



void CRYPTO_dbg_set_options(long bits)

{
  options = bits;
  return;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

long CRYPTO_dbg_get_options(void)

{
  return options;
}



int CRYPTO_push_info_(char *info,char *file,int line)

{
  _LHASH *lh;
  int iVar1;
  CRYPTO_THREADID *id;
  void *pvVar2;
  CRYPTO_THREADID CStack_38;
  
  if ((mh_mode & 1) == 0) {
    return 0;
  }
  CRYPTO_THREADID_current(&CStack_38);
  CRYPTO_lock(5,0x14,"mem_dbg.c",0x126);
  if ((mh_mode & 2) == 0) {
    iVar1 = CRYPTO_THREADID_cmp((CRYPTO_THREADID *)disabling_threadid,&CStack_38);
    CRYPTO_lock(6,0x14,"mem_dbg.c",299);
    if (iVar1 == 0) {
      return 0;
    }
  }
  else {
    CRYPTO_lock(6,0x14,"mem_dbg.c",299);
  }
  CRYPTO_mem_ctrl_constprop_4();
  id = (CRYPTO_THREADID *)CRYPTO_malloc(0x38,"mem_dbg.c",0x196);
  if (id != (CRYPTO_THREADID *)0x0) {
    if ((amih == (_LHASH *)0x0) &&
       (amih = lh_new(app_info_LHASH_HASH,app_info_LHASH_COMP), amih == (_LHASH *)0x0)) {
      CRYPTO_free(id);
    }
    else {
      CRYPTO_THREADID_current(id);
      lh = amih;
      id[1].ptr = file;
      *(int *)&id[1].val = line;
      id[2].ptr = info;
      *(undefined4 *)&id[3].ptr = 1;
      id[2].val = 0;
      pvVar2 = lh_insert(lh,id);
      if (pvVar2 != (void *)0x0) {
        id[2].val = (ulong)pvVar2;
      }
    }
  }
  CRYPTO_lock(9,0x14,"mem_dbg.c",0xdc);
  if ((((mh_mode & 1) != 0) && (num_disable != 0)) &&
     (num_disable = num_disable + -1, num_disable == 0)) {
    mh_mode = mh_mode | 2;
    CRYPTO_lock(10,0x1b,"mem_dbg.c",0x111);
  }
  CRYPTO_lock(10,0x14,"mem_dbg.c",0x11a);
  return 0;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

int CRYPTO_pop_info(void)

{
  void *data;
  int iVar1;
  void *ptr;
  int iVar2;
  CRYPTO_THREADID aCStack_58 [4];
  
  if ((mh_mode & 1) == 0) {
    return 0;
  }
  CRYPTO_THREADID_current(aCStack_58);
  CRYPTO_lock(5,0x14,"mem_dbg.c",0x126);
  if ((mh_mode & 2) == 0) {
    iVar1 = CRYPTO_THREADID_cmp((CRYPTO_THREADID *)disabling_threadid,aCStack_58);
    CRYPTO_lock(6,0x14,"mem_dbg.c",299);
    if (iVar1 == 0) {
      return 0;
    }
  }
  else {
    CRYPTO_lock(6,0x14,"mem_dbg.c",299);
  }
  CRYPTO_mem_ctrl_constprop_4();
  if (amih != (_LHASH *)0x0) {
    CRYPTO_THREADID_current(aCStack_58);
    ptr = lh_delete(amih,aCStack_58);
    if (ptr != (void *)0x0) {
      data = *(void **)((long)ptr + 0x28);
      if (data != (void *)0x0) {
        *(int *)((long)data + 0x30) = *(int *)((long)data + 0x30) + 1;
        lh_insert(amih,data);
      }
      iVar2 = 1;
      iVar1 = *(int *)((long)ptr + 0x30) + -1;
      *(int *)((long)ptr + 0x30) = iVar1;
      if (iVar1 < 1) {
        *(undefined8 *)((long)ptr + 0x28) = 0;
        if (data != (void *)0x0) {
          *(int *)((long)data + 0x30) = *(int *)((long)data + 0x30) + -1;
        }
        iVar2 = 1;
        CRYPTO_free(ptr);
      }
      goto LAB_00492731;
    }
  }
  iVar2 = 0;
LAB_00492731:
  CRYPTO_lock(9,0x14,"mem_dbg.c",0xdc);
  if ((((mh_mode & 1) != 0) && (num_disable != 0)) &&
     (num_disable = num_disable + -1, num_disable == 0)) {
    mh_mode = mh_mode | 2;
    CRYPTO_lock(10,0x1b,"mem_dbg.c",0x111);
  }
  CRYPTO_lock(10,0x14,"mem_dbg.c",0x11a);
  return iVar2;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

int CRYPTO_remove_all_info(void)

{
  int iVar1;
  void *data;
  void *ptr;
  int iVar2;
  CRYPTO_THREADID aCStack_58 [4];
  
  if ((mh_mode & 1) == 0) {
    return 0;
  }
  CRYPTO_THREADID_current(aCStack_58);
  CRYPTO_lock(5,0x14,"mem_dbg.c",0x126);
  if ((mh_mode & 2) == 0) {
    iVar2 = CRYPTO_THREADID_cmp((CRYPTO_THREADID *)disabling_threadid,aCStack_58);
    CRYPTO_lock(6,0x14,"mem_dbg.c",299);
    if (iVar2 == 0) {
      return 0;
    }
  }
  else {
    CRYPTO_lock(6,0x14,"mem_dbg.c",299);
  }
  CRYPTO_mem_ctrl_constprop_4();
  iVar2 = 0;
  while (amih != (_LHASH *)0x0) {
    while( true ) {
      CRYPTO_THREADID_current(aCStack_58);
      ptr = lh_delete(amih,aCStack_58);
      if (ptr == (void *)0x0) goto LAB_00492920;
      data = *(void **)((long)ptr + 0x28);
      if (data != (void *)0x0) {
        *(int *)((long)data + 0x30) = *(int *)((long)data + 0x30) + 1;
        lh_insert(amih,data);
      }
      iVar1 = *(int *)((long)ptr + 0x30) + -1;
      *(int *)((long)ptr + 0x30) = iVar1;
      if (0 < iVar1) break;
      *(undefined8 *)((long)ptr + 0x28) = 0;
      if (data != (void *)0x0) {
        *(int *)((long)data + 0x30) = *(int *)((long)data + 0x30) + -1;
      }
      iVar2 = iVar2 + 1;
      CRYPTO_free(ptr);
      if (amih == (_LHASH *)0x0) goto LAB_00492920;
    }
    iVar2 = iVar2 + 1;
  }
LAB_00492920:
  CRYPTO_lock(9,0x14,"mem_dbg.c",0xdc);
  if ((((mh_mode & 1) != 0) && (num_disable != 0)) &&
     (num_disable = num_disable + -1, num_disable == 0)) {
    mh_mode = mh_mode | 2;
    CRYPTO_lock(10,0x1b,"mem_dbg.c",0x111);
  }
  CRYPTO_lock(10,0x14,"mem_dbg.c",0x11a);
  return iVar2;
}



void CRYPTO_dbg_malloc(void *addr,int num,char *file,int line,int before_p)

{
  int *piVar1;
  ulong uVar2;
  _LHASH *lh;
  int iVar3;
  undefined8 *ptr;
  void *pvVar4;
  time_t tVar5;
  uint uVar6;
  CRYPTO_THREADID aCStack_68 [4];
  
  if ((before_p & 0x7fU) != 1) {
    return;
  }
  if (addr == (void *)0x0) {
    return;
  }
  if ((mh_mode & 1) == 0) {
    return;
  }
  CRYPTO_THREADID_current(aCStack_68);
  CRYPTO_lock(5,0x14,"mem_dbg.c",0x126);
  if ((mh_mode & 2) == 0) {
    iVar3 = CRYPTO_THREADID_cmp((CRYPTO_THREADID *)disabling_threadid,aCStack_68);
    CRYPTO_lock(6,0x14,"mem_dbg.c",299);
    if (iVar3 == 0) {
      return;
    }
  }
  else {
    CRYPTO_lock(6,0x14,"mem_dbg.c",299);
  }
  CRYPTO_mem_ctrl_constprop_4();
  ptr = (undefined8 *)CRYPTO_malloc(0x48,"mem_dbg.c",0x1f2);
  if (ptr != (undefined8 *)0x0) {
    if ((mh == (_LHASH *)0x0) && (mh = lh_new(mem_LHASH_HASH,mem_LHASH_COMP), mh == (_LHASH *)0x0))
    {
      CRYPTO_free(addr);
      CRYPTO_free(ptr);
      goto LAB_00492b4d;
    }
    uVar2 = options;
    uVar6 = (uint)options;
    *ptr = addr;
    ptr[2] = file;
    *(int *)(ptr + 3) = line;
    *(int *)(ptr + 1) = num;
    if ((uVar2 & 2) == 0) {
      ptr[4] = 0;
      ptr[5] = 0;
    }
    else {
      CRYPTO_THREADID_current((CRYPTO_THREADID *)(ptr + 4));
      uVar6 = (uint)options;
    }
    ptr[6] = order;
    if ((uVar6 & 1) == 0) {
      order = order + 1;
      ptr[7] = 0;
    }
    else {
      order = order + 1;
      tVar5 = time((time_t *)0x0);
      ptr[7] = tVar5;
    }
    CRYPTO_THREADID_current(aCStack_68);
    lh = amih;
    ptr[8] = 0;
    if ((lh != (_LHASH *)0x0) && (pvVar4 = lh_retrieve(lh,aCStack_68), pvVar4 != (void *)0x0)) {
      ptr[8] = pvVar4;
      *(int *)((long)pvVar4 + 0x30) = *(int *)((long)pvVar4 + 0x30) + 1;
    }
    addr = lh_insert(mh,ptr);
    if (addr == (void *)0x0) goto LAB_00492b4d;
    if (*(long *)((long)addr + 0x40) != 0) {
      piVar1 = (int *)(*(long *)((long)addr + 0x40) + 0x30);
      *piVar1 = *piVar1 + -1;
    }
  }
  CRYPTO_free(addr);
LAB_00492b4d:
  CRYPTO_lock(9,0x14,"mem_dbg.c",0xdc);
  if ((((mh_mode & 1) != 0) && (num_disable != 0)) &&
     (num_disable = num_disable + -1, num_disable == 0)) {
    mh_mode = mh_mode | 2;
    CRYPTO_lock(10,0x1b,"mem_dbg.c",0x111);
  }
  CRYPTO_lock(10,0x14,"mem_dbg.c",0x11a);
  return;
}



void CRYPTO_dbg_free(void *addr,int before_p)

{
  void *ptr;
  void *ptr_00;
  void *ptr_01;
  void *ptr_02;
  void *ptr_03;
  int iVar1;
  CRYPTO_THREADID local_78 [5];
  
  if (((before_p == 0) && (addr != (void *)0x0)) && ((mh_mode & 1) != 0)) {
    CRYPTO_THREADID_current(local_78);
    CRYPTO_lock(5,0x14,"mem_dbg.c",0x126);
    if ((mh_mode & 2) == 0) {
      iVar1 = CRYPTO_THREADID_cmp((CRYPTO_THREADID *)disabling_threadid,local_78);
      CRYPTO_lock(6,0x14,"mem_dbg.c",299);
      if (iVar1 == 0) {
        return;
      }
    }
    else {
      CRYPTO_lock(6,0x14,"mem_dbg.c",299);
    }
    if (mh != (_LHASH *)0x0) {
      CRYPTO_mem_ctrl_constprop_4();
      local_78[0].ptr = addr;
      ptr_03 = lh_delete(mh,local_78);
      if (ptr_03 != (void *)0x0) {
        ptr = *(void **)((long)ptr_03 + 0x40);
        if ((ptr != (void *)0x0) &&
           (iVar1 = *(int *)((long)ptr + 0x30) + -1, *(int *)((long)ptr + 0x30) = iVar1, iVar1 < 1))
        {
          ptr_00 = *(void **)((long)ptr + 0x28);
          if ((ptr_00 != (void *)0x0) &&
             (iVar1 = *(int *)((long)ptr_00 + 0x30) + -1, *(int *)((long)ptr_00 + 0x30) = iVar1,
             iVar1 < 1)) {
            ptr_01 = *(void **)((long)ptr_00 + 0x28);
            if ((ptr_01 != (void *)0x0) &&
               (iVar1 = *(int *)((long)ptr_01 + 0x30) + -1, *(int *)((long)ptr_01 + 0x30) = iVar1,
               iVar1 < 1)) {
              ptr_02 = *(void **)((long)ptr_01 + 0x28);
              if ((ptr_02 != (void *)0x0) &&
                 (iVar1 = *(int *)((long)ptr_02 + 0x30) + -1, *(int *)((long)ptr_02 + 0x30) = iVar1,
                 iVar1 < 1)) {
                if (*(long *)((long)ptr_02 + 0x28) != 0) {
                  app_info_free();
                }
                CRYPTO_free(ptr_02);
              }
              CRYPTO_free(ptr_01);
            }
            CRYPTO_free(ptr_00);
          }
          CRYPTO_free(ptr);
        }
        CRYPTO_free(ptr_03);
      }
      CRYPTO_lock(9,0x14,"mem_dbg.c",0xdc);
      if ((((mh_mode & 1) != 0) && (num_disable != 0)) &&
         (num_disable = num_disable + -1, num_disable == 0)) {
        mh_mode = mh_mode | 2;
        CRYPTO_lock(10,0x1b,"mem_dbg.c",0x111);
      }
      CRYPTO_lock(10,0x14,"mem_dbg.c",0x11a);
    }
  }
  return;
}



void CRYPTO_dbg_realloc(void *addr1,void *addr2,int num,char *file,int line,int before_p)

{
  _LHASH *lh;
  int iVar1;
  undefined8 *data;
  CRYPTO_THREADID local_78 [5];
  
  if (before_p == 1) {
    if (addr2 != (void *)0x0) {
      if (addr1 == (void *)0x0) {
        CRYPTO_dbg_malloc(addr2,num,file,line,0x81);
      }
      else if ((mh_mode & 1) != 0) {
        CRYPTO_THREADID_current(local_78);
        CRYPTO_lock(5,0x14,"mem_dbg.c",0x126);
        if ((mh_mode & 2) == 0) {
          iVar1 = CRYPTO_THREADID_cmp((CRYPTO_THREADID *)disabling_threadid,local_78);
          CRYPTO_lock(6,0x14,"mem_dbg.c",299);
          if (iVar1 == 0) {
            return;
          }
        }
        else {
          CRYPTO_lock(6,0x14,"mem_dbg.c",299);
        }
        CRYPTO_mem_ctrl_constprop_4();
        local_78[0].ptr = addr1;
        data = (undefined8 *)lh_delete(mh,local_78);
        lh = mh;
        if (data != (undefined8 *)0x0) {
          *data = addr2;
          *(int *)(data + 1) = num;
          lh_insert(lh,data);
        }
        CRYPTO_lock(9,0x14,"mem_dbg.c",0xdc);
        if ((((mh_mode & 1) != 0) && (num_disable != 0)) &&
           (num_disable = num_disable + -1, num_disable == 0)) {
          mh_mode = mh_mode | 2;
          CRYPTO_lock(10,0x1b,"mem_dbg.c",0x111);
        }
        CRYPTO_lock(10,0x14,"mem_dbg.c",0x11a);
      }
    }
  }
  return;
}



void CRYPTO_mem_leaks(bio_st *bio)

{
  uint uVar1;
  ulong uVar2;
  bio_st *local_28;
  int local_20;
  undefined8 local_18;
  
  if ((mh != (_LHASH *)0x0) || (amih != (_LHASH *)0x0)) {
    CRYPTO_mem_ctrl_constprop_4();
    local_18 = 0;
    local_20 = 0;
    local_28 = bio;
    if ((mh == (_LHASH *)0x0) ||
       (lh_doall_arg(mh,print_leak_LHASH_DOALL_ARG,&local_28), local_20 == 0)) {
      CRYPTO_lock(9,0x14,"mem_dbg.c",0x31e);
      uVar1 = mh_mode;
      mh_mode = 0;
      if (mh != (_LHASH *)0x0) {
        lh_free(mh);
        mh = (_LHASH *)0x0;
      }
      if ((amih != (_LHASH *)0x0) && (uVar2 = lh_num_items(amih), uVar2 == 0)) {
        lh_free(amih);
        amih = (_LHASH *)0x0;
      }
      mh_mode = uVar1;
      CRYPTO_lock(10,0x14,"mem_dbg.c",0x334);
    }
    else {
      BIO_printf(bio,"%ld bytes leaked in %d chunks\n",local_18);
    }
    CRYPTO_lock(9,0x14,"mem_dbg.c",0xdc);
    if ((((mh_mode & 1) != 0) && (num_disable != 0)) &&
       (num_disable = num_disable + -1, num_disable == 0)) {
      mh_mode = mh_mode | 2;
      CRYPTO_lock(10,0x1b,"mem_dbg.c",0x111);
    }
    CRYPTO_lock(10,0x14,"mem_dbg.c",0x11a);
  }
  return;
}



void CRYPTO_mem_leaks_fp(FILE *param_1)

{
  BIO_METHOD *type;
  BIO *bp;
  
  if (mh != 0) {
    CRYPTO_mem_ctrl_constprop_4();
    type = BIO_s_file();
    bp = BIO_new(type);
    CRYPTO_lock(9,0x14,"mem_dbg.c",0xdc);
    if ((((mh_mode & 1) != 0) && (num_disable != 0)) &&
       (num_disable = num_disable + -1, num_disable == 0)) {
      mh_mode = mh_mode | 2;
      CRYPTO_lock(10,0x1b,"mem_dbg.c",0x111);
    }
    CRYPTO_lock(10,0x14,"mem_dbg.c",0x11a);
    if (bp != (BIO *)0x0) {
      BIO_ctrl(bp,0x6a,0,param_1);
      CRYPTO_mem_leaks(bp);
      BIO_free(bp);
      return;
    }
  }
  return;
}



void CRYPTO_mem_leaks_cb(undefined1 *cb)

{
  undefined1 *local_10 [2];
  
  if (mh != (_LHASH *)0x0) {
    local_10[0] = cb;
    CRYPTO_lock(9,0x1b,"mem_dbg.c",0x366);
    lh_doall_arg(mh,cb_leak_LHASH_DOALL_ARG,local_10);
    CRYPTO_lock(10,0x1b,"mem_dbg.c",0x369);
  }
  return;
}



void cleanup1_LHASH_DOALL(long param_1)

{
  uint *puVar1;
  long lVar2;
  
  lVar2 = *(long *)(param_1 + 8);
  *(undefined4 *)(lVar2 + 0x10) = 0;
  puVar1 = (uint *)(lVar2 + 0x20);
  *puVar1 = *puVar1 | 0xd;
  return;
}



void cleanup2_LHASH_DOALL(long param_1)

{
  int *piVar1;
  
  piVar1 = (int *)(*(long *)(param_1 + 8) + 0x10);
  *piVar1 = *piVar1 + 1;
  return;
}



void cleanup3_LHASH_DOALL(void *param_1)

{
  int iVar1;
  ASN1_OBJECT *a;
  
  a = *(ASN1_OBJECT **)((long)param_1 + 8);
  iVar1 = a->nid + -1;
  a->nid = iVar1;
  if (iVar1 == 0) {
    ASN1_OBJECT_free(a);
  }
  CRYPTO_free(param_1);
  return;
}



void ln_cmp_BSEARCH_CMP_FN(long *param_1,uint *param_2)

{
  strcmp(*(char **)(*param_1 + 8),(&PTR_s_undefined_004dcce8)[(ulong)*param_2 * 5]);
  return;
}



void sn_cmp_BSEARCH_CMP_FN(undefined8 *param_1,uint *param_2)

{
  strcmp(*(char **)*param_1,(&nid_objs)[(ulong)*param_2 * 5]);
  return;
}



ulong added_obj_LHASH_HASH(int *param_1)

{
  byte bVar1;
  undefined8 *puVar2;
  int iVar3;
  ulong uVar4;
  int iVar5;
  int iVar6;
  byte *pbVar7;
  uint uVar8;
  
  iVar3 = *param_1;
  puVar2 = *(undefined8 **)(param_1 + 2);
  if (iVar3 == 1) {
    uVar4 = lh_strhash((char *)*puVar2);
    uVar8 = (uint)uVar4;
    iVar3 = *param_1;
  }
  else if (iVar3 < 2) {
    if (iVar3 != 0) {
      return 0;
    }
    iVar3 = *(int *)((long)puVar2 + 0x14);
    pbVar7 = (byte *)puVar2[3];
    uVar8 = iVar3 << 0x14;
    if (0 < iVar3) {
      iVar5 = 0;
      do {
        bVar1 = *pbVar7;
        iVar6 = iVar5 + 3;
        pbVar7 = pbVar7 + 1;
        uVar8 = uVar8 ^ (uint)bVar1 << ((char)iVar5 + (char)(iVar5 / 0x18) * -0x18 & 0x1fU);
        iVar5 = iVar6;
      } while (iVar6 != iVar3 * 3);
    }
    iVar3 = 0;
  }
  else if (iVar3 == 2) {
    uVar4 = lh_strhash((char *)puVar2[1]);
    uVar8 = (uint)uVar4;
    iVar3 = *param_1;
  }
  else {
    if (iVar3 != 3) {
      return 0;
    }
    uVar8 = *(uint *)(puVar2 + 2);
    iVar3 = 3;
  }
  return (long)(iVar3 << 0x1e) | (ulong)(uVar8 & 0x3fffffff);
}



void obj_cmp_BSEARCH_CMP_FN(long *param_1,uint *param_2)

{
  int iVar1;
  
  iVar1 = *(int *)(*param_1 + 0x14);
  if (iVar1 == *(int *)(&DAT_004dccf4 + (ulong)*param_2 * 0x28)) {
    memcmp(*(void **)(*param_1 + 0x18),(&PTR_lvalues_004dccf8)[(ulong)*param_2 * 5],(long)iVar1);
    return;
  }
  return;
}



int added_obj_LHASH_COMP(int *param_1,int *param_2)

{
  long *plVar1;
  long *plVar2;
  int iVar3;
  char *__s2;
  char *__s1;
  
  iVar3 = *param_1;
  if (iVar3 - *param_2 != 0) {
    return iVar3 - *param_2;
  }
  plVar1 = *(long **)(param_1 + 2);
  plVar2 = *(long **)(param_2 + 2);
  if (iVar3 == 1) {
    __s1 = (char *)*plVar1;
    if (__s1 == (char *)0x0) {
      return -1;
    }
    __s2 = (char *)*plVar2;
    if (__s2 == (char *)0x0) {
      return 1;
    }
LAB_0049354a:
    iVar3 = strcmp(__s1,__s2);
    return iVar3;
  }
  if (iVar3 < 2) {
    if (iVar3 == 0) {
      iVar3 = *(int *)((long)plVar1 + 0x14) - *(int *)((long)plVar2 + 0x14);
      if (iVar3 != 0) {
        return iVar3;
      }
      iVar3 = memcmp((void *)plVar1[3],(void *)plVar2[3],(long)*(int *)((long)plVar1 + 0x14));
      return iVar3;
    }
  }
  else {
    if (iVar3 == 2) {
      __s1 = (char *)plVar1[1];
      if (__s1 == (char *)0x0) {
        return -1;
      }
      __s2 = (char *)plVar2[1];
      if (__s2 == (char *)0x0) {
        return 1;
      }
      goto LAB_0049354a;
    }
    if (iVar3 == 3) {
      return (int)plVar1[2] - (int)plVar2[2];
    }
  }
  return 0;
}



void check_defer(int nid)

{
  if ((obj_cleanup_defer == 0) && (0x397 < nid)) {
    obj_cleanup_defer = 1;
  }
  return;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

void OBJ_cleanup(void)

{
  _LHASH *lh;
  
  lh = added;
  if (obj_cleanup_defer == 0) {
    if (added != (_LHASH *)0x0) {
      added->down_load = 0;
      lh_doall(lh,cleanup1_LHASH_DOALL);
      lh_doall(added,cleanup2_LHASH_DOALL);
      lh_doall(added,cleanup3_LHASH_DOALL);
      lh_free(added);
      added = (_LHASH *)0x0;
    }
    return;
  }
  obj_cleanup_defer = 2;
  return;
}



int OBJ_new_nid(int num)

{
  int iVar1;
  
  iVar1 = new_nid;
  new_nid = num + new_nid;
  return iVar1;
}



int OBJ_add_object(ASN1_OBJECT *obj)

{
  undefined4 *data;
  _LHASH *lh;
  ASN1_OBJECT *ptr;
  void *pvVar1;
  long lVar2;
  undefined8 *puVar3;
  undefined1 local_38 [16];
  undefined1 local_28 [16];
  
  puVar3 = (undefined8 *)local_38;
  local_38 = (undefined1  [16])0x0;
  local_28 = (undefined1  [16])0x0;
  if ((added == (_LHASH *)0x0) &&
     (added = lh_new(added_obj_LHASH_HASH,added_obj_LHASH_COMP), added == (_LHASH *)0x0)) {
    return 0;
  }
  ptr = OBJ_dup(obj);
  if (ptr == (ASN1_OBJECT *)0x0) goto LAB_0049378f;
  pvVar1 = CRYPTO_malloc(0x10,"obj_dat.c",0x100);
  local_28._8_8_ = pvVar1;
  if (pvVar1 != (void *)0x0) {
    if ((ptr->length != 0) && (obj->data != (uchar *)0x0)) {
      pvVar1 = CRYPTO_malloc(0x10,"obj_dat.c",0x102);
      local_38._0_8_ = pvVar1;
      if (pvVar1 == (void *)0x0) goto LAB_00493770;
    }
    if (ptr->sn != (char *)0x0) {
      pvVar1 = CRYPTO_malloc(0x10,"obj_dat.c",0x104);
      local_38._8_8_ = pvVar1;
      if (pvVar1 == (void *)0x0) goto LAB_00493770;
    }
    if (ptr->ln == (char **)0x0) {
LAB_00493727:
      lVar2 = 0;
      do {
        lh = added;
        data = *(undefined4 **)(local_38 + lVar2 * 8);
        if (data != (undefined4 *)0x0) {
          *data = (int)lVar2;
          *(ASN1_OBJECT **)(data + 2) = ptr;
          pvVar1 = lh_insert(lh,data);
          if (pvVar1 != (void *)0x0) {
            CRYPTO_free(pvVar1);
          }
        }
        lVar2 = lVar2 + 1;
      } while (lVar2 != 4);
      ptr->flags = ptr->flags & 0xfffffff2;
      return ptr->nid;
    }
    pvVar1 = CRYPTO_malloc(0x10,"obj_dat.c",0x106);
    local_28._0_8_ = pvVar1;
    if (pvVar1 != (void *)0x0) goto LAB_00493727;
  }
LAB_00493770:
  ERR_put_error(8,0x69,0x41,"obj_dat.c",0x119);
LAB_0049378f:
  do {
    if ((void *)*puVar3 != (void *)0x0) {
      CRYPTO_free((void *)*puVar3);
    }
    puVar3 = puVar3 + 1;
  } while (puVar3 != (undefined8 *)&stack0xffffffffffffffe8);
  if (ptr != (ASN1_OBJECT *)0x0) {
    CRYPTO_free(ptr);
  }
  return 0;
}



ASN1_OBJECT * OBJ_nid2obj(int n)

{
  void *pvVar1;
  long lVar2;
  int line;
  undefined4 local_48 [2];
  undefined1 *local_40;
  undefined1 local_38 [16];
  int local_28;
  
  if ((uint)n < 0x398) {
    if (n == 0) {
      lVar2 = 0;
    }
    else {
      lVar2 = (long)n;
      line = 0x12a;
      if (*(int *)(&DAT_004dccf0 + lVar2 * 0x28) == 0) goto LAB_00493882;
    }
    return (ASN1_OBJECT *)(&nid_objs + lVar2 * 5);
  }
  if (added == (_LHASH *)0x0) {
    return (ASN1_OBJECT *)0x0;
  }
  local_40 = local_38;
  local_48[0] = 3;
  local_28 = n;
  pvVar1 = lh_retrieve(added,local_48);
  if (pvVar1 != (void *)0x0) {
    return *(ASN1_OBJECT **)((long)pvVar1 + 8);
  }
  line = 0x13b;
LAB_00493882:
  ERR_put_error(8,0x67,0x65,"obj_dat.c",line);
  return (ASN1_OBJECT *)0x0;
}



char * OBJ_nid2sn(int n)

{
  void *pvVar1;
  long lVar2;
  int line;
  undefined4 local_48 [2];
  undefined1 *local_40;
  undefined1 local_38 [16];
  int local_28;
  
  if ((uint)n < 0x398) {
    if (n == 0) {
      lVar2 = 0;
    }
    else {
      lVar2 = (long)n;
      line = 0x14a;
      if (*(int *)(&DAT_004dccf0 + lVar2 * 0x28) == 0) goto LAB_00493932;
    }
    return (&nid_objs)[lVar2 * 5];
  }
  if (added == (_LHASH *)0x0) {
    return (char *)0x0;
  }
  local_40 = local_38;
  local_48[0] = 3;
  local_28 = n;
  pvVar1 = lh_retrieve(added,local_48);
  if (pvVar1 != (void *)0x0) {
    return (char *)**(undefined8 **)((long)pvVar1 + 8);
  }
  line = 0x15b;
LAB_00493932:
  ERR_put_error(8,0x68,0x65,"obj_dat.c",line);
  return (char *)0x0;
}



char * OBJ_nid2ln(int n)

{
  void *pvVar1;
  long lVar2;
  int line;
  undefined4 local_48 [2];
  undefined1 *local_40;
  undefined1 local_38 [16];
  int local_28;
  
  if ((uint)n < 0x398) {
    if (n == 0) {
      lVar2 = 0;
    }
    else {
      lVar2 = (long)n;
      line = 0x16a;
      if (*(int *)(&DAT_004dccf0 + lVar2 * 0x28) == 0) goto LAB_004939e2;
    }
    return (&PTR_s_undefined_004dcce8)[lVar2 * 5];
  }
  if (added == (_LHASH *)0x0) {
    return (char *)0x0;
  }
  local_40 = local_38;
  local_48[0] = 3;
  local_28 = n;
  pvVar1 = lh_retrieve(added,local_48);
  if (pvVar1 != (void *)0x0) {
    return *(char **)(*(long *)((long)pvVar1 + 8) + 8);
  }
  line = 0x17b;
LAB_004939e2:
  ERR_put_error(8,0x66,0x65,"obj_dat.c",line);
  return (char *)0x0;
}



int OBJ_obj2nid(ASN1_OBJECT *o)

{
  long lVar1;
  int iVar2;
  int iVar3;
  void *pvVar4;
  int iVar5;
  int iVar6;
  int iVar7;
  undefined4 local_48 [2];
  ASN1_OBJECT *local_40;
  
  if (o != (ASN1_OBJECT *)0x0) {
    if (o->nid != 0) {
      return o->nid;
    }
    if (added != (_LHASH *)0x0) {
      local_48[0] = 0;
      local_40 = o;
      pvVar4 = lh_retrieve(added,local_48);
      if (pvVar4 != (void *)0x0) {
        return *(int *)(*(long *)((long)pvVar4 + 8) + 0x10);
      }
    }
    iVar2 = o->length;
    iVar6 = 0;
    iVar7 = 0x359;
    do {
      while( true ) {
        iVar5 = iVar6 + iVar7 >> 1;
        lVar1 = (ulong)*(uint *)(obj_objs + iVar5 * 4) * 0x28;
        if (iVar2 != *(int *)(&DAT_004dccf4 + lVar1)) break;
        iVar3 = memcmp(o->data,(&PTR_lvalues_004dccf8)[(ulong)*(uint *)(obj_objs + iVar5 * 4) * 5],
                       (long)iVar2);
        if (-1 < iVar3) {
          if (iVar3 == 0) {
            return *(int *)(&DAT_004dccf0 + lVar1);
          }
          goto LAB_00493a9b;
        }
LAB_00493ad0:
        iVar7 = iVar5;
        if (iVar5 <= iVar6) {
          return 0;
        }
      }
      if (iVar2 - *(int *)(&DAT_004dccf4 + lVar1) < 0) goto LAB_00493ad0;
LAB_00493a9b:
      iVar6 = iVar5 + 1;
    } while (iVar6 < iVar7);
  }
  return 0;
}



int OBJ_obj2txt(char *buf,int buf_len,ASN1_OBJECT *a,int no_name)

{
  bool bVar1;
  char cVar2;
  int iVar3;
  uint uVar4;
  char *pcVar5;
  size_t sVar6;
  BIGNUM *a_00;
  void *pvVar7;
  uint uVar8;
  uint *puVar9;
  uint *puVar10;
  int iVar11;
  char *dst;
  ulong w;
  byte *pbVar12;
  byte *pbVar13;
  bool bVar14;
  int local_98;
  int local_8c;
  char *local_88;
  int local_80;
  undefined4 local_78 [2];
  uint *local_70;
  uint local_68 [4];
  uint local_58;
  
  if ((a == (ASN1_OBJECT *)0x0) || (pbVar12 = a->data, pbVar12 == (byte *)0x0)) {
    *buf = '\0';
    return 0;
  }
  if (no_name != 0) goto LAB_00493b4b;
  uVar8 = OBJ_obj2nid(a);
  if (uVar8 != 0) {
    if (uVar8 < 0x398) {
      iVar11 = 0x16a;
      if (*(int *)(&DAT_004dccf0 + (long)(int)uVar8 * 0x28) == 0) goto LAB_00493fa3;
      pcVar5 = (&PTR_s_undefined_004dcce8)[(long)(int)uVar8 * 5];
LAB_00493e63:
      if (pcVar5 != (char *)0x0) goto LAB_00493e6c;
    }
    else if (added != (_LHASH *)0x0) {
      local_70 = local_68;
      local_78[0] = 3;
      local_58 = uVar8;
      pvVar7 = lh_retrieve(added,local_78);
      if (pvVar7 != (void *)0x0) {
        pcVar5 = *(char **)(*(long *)((long)pvVar7 + 8) + 8);
        goto LAB_00493e63;
      }
      iVar11 = 0x17b;
LAB_00493fa3:
      ERR_put_error(8,0x66,0x65,"obj_dat.c",iVar11);
    }
    if (uVar8 < 0x398) {
      if (*(int *)(&DAT_004dccf0 + (long)(int)uVar8 * 0x28) == 0) {
        iVar11 = 0x14a;
LAB_00494034:
        ERR_put_error(8,0x68,0x65,"obj_dat.c",iVar11);
      }
      else {
        pcVar5 = (&nid_objs)[(long)(int)uVar8 * 5];
LAB_00493fe0:
        if (pcVar5 != (char *)0x0) {
LAB_00493e6c:
          if (buf != (char *)0x0) {
            BUF_strlcpy(buf,pcVar5,(long)buf_len);
          }
          sVar6 = strlen(pcVar5);
          return (int)sVar6;
        }
      }
    }
    else if (added != (_LHASH *)0x0) {
      local_70 = local_68;
      local_78[0] = 3;
      local_58 = uVar8;
      pvVar7 = lh_retrieve(added,local_78);
      if (pvVar7 == (void *)0x0) {
        iVar11 = 0x15b;
        goto LAB_00494034;
      }
      pcVar5 = (char *)**(undefined8 **)((long)pvVar7 + 8);
      goto LAB_00493fe0;
    }
  }
  pbVar12 = a->data;
LAB_00493b4b:
  iVar11 = a->length;
  if (iVar11 < 1) {
    return 0;
  }
  bVar14 = true;
  local_80 = 0;
  a_00 = (BIGNUM *)0x0;
  local_8c = buf_len;
  local_88 = buf;
  do {
    w = 0;
    bVar1 = false;
    pbVar13 = pbVar12;
LAB_00493b80:
    pbVar12 = pbVar13 + 1;
    uVar8 = (uint)*pbVar13;
    iVar11 = iVar11 + -1;
    if ((char)*pbVar13 < '\0') goto LAB_00493c2d;
LAB_00493b94:
    if (bVar1) goto LAB_00493c40;
LAB_00493b9d:
    w = w | uVar8 & 0x7f;
    pbVar13 = pbVar12;
    if ((char)uVar8 < '\0') {
      do {
        if ((0x1ffffffffffffff < w) && (!bVar1)) {
          if ((a_00 == (BIGNUM *)0x0) && (a_00 = BN_new(), a_00 == (BIGNUM *)0x0)) {
            return -1;
          }
          iVar3 = BN_set_word(a_00,w);
          if (iVar3 == 0) goto LAB_00493bef;
          bVar1 = true;
LAB_00493bd6:
          iVar3 = BN_lshift(a_00,a_00,7);
          if (iVar3 != 0) goto LAB_00493b80;
          goto LAB_00493bea;
        }
        if (bVar1) goto LAB_00493bd6;
        pbVar12 = pbVar13 + 1;
        uVar8 = (uint)*pbVar13;
        w = w << 7;
        iVar11 = iVar11 + -1;
        if (-1 < (char)*pbVar13) goto LAB_00493b94;
LAB_00493c2d:
        if (iVar11 == 0) goto LAB_00493bea;
        if (!bVar1) goto LAB_00493b9d;
LAB_00493c40:
        iVar3 = BN_add_word(a_00,(ulong)(uVar8 & 0x7f));
        if (iVar3 == 0) goto LAB_00493bea;
        pbVar13 = pbVar12;
        if (-1 < (char)uVar8) break;
      } while( true );
    }
    if (bVar14) {
      if (w < 0x50) {
        cVar2 = (char)(w / 0x28);
        w = w - (long)((int)(w / 0x28) * 0x28);
      }
      else {
        if (bVar1) {
          iVar3 = BN_sub_word(a_00,0x50);
          if (iVar3 == 0) goto LAB_00493bea;
        }
        else {
          w = w - 0x50;
        }
        cVar2 = '\x02';
      }
      if ((0 < local_8c) && (local_88 != (char *)0x0)) {
        local_8c = local_8c + -1;
        *local_88 = cVar2 + '0';
        local_88 = local_88 + 1;
      }
      local_80 = local_80 + 1;
    }
    if (bVar1) {
      pcVar5 = BN_bn2dec(a_00);
      if (pcVar5 == (char *)0x0) {
LAB_00493bea:
        if (a_00 != (BIGNUM *)0x0) {
LAB_00493bef:
          BN_free(a_00);
        }
        return -1;
      }
      sVar6 = strlen(pcVar5);
      iVar3 = (int)sVar6;
      if (local_88 != (char *)0x0) {
        dst = local_88;
        if (0 < local_8c) {
          local_8c = local_8c + -1;
          dst = local_88 + 1;
          *local_88 = '.';
        }
        BUF_strlcpy(dst,pcVar5,(long)local_8c);
        if (local_8c < iVar3) {
          local_88 = dst + local_8c;
          local_8c = 0;
        }
        else {
          local_8c = local_8c - iVar3;
          local_88 = dst + iVar3;
        }
      }
      local_80 = local_80 + 1 + iVar3;
      CRYPTO_free(pcVar5);
    }
    else {
      BIO_snprintf((char *)local_68,0x25,".%lu",w);
      puVar10 = local_68;
      do {
        puVar9 = puVar10;
        uVar4 = *puVar9 + 0xfefefeff & ~*puVar9;
        uVar8 = uVar4 & 0x80808080;
        puVar10 = puVar9 + 1;
      } while (uVar8 == 0);
      bVar14 = (uVar4 & 0x8080) == 0;
      if (bVar14) {
        uVar8 = uVar8 >> 0x10;
      }
      if (bVar14) {
        puVar10 = (uint *)((long)puVar9 + 6);
      }
      local_98 = (int)local_68;
      local_98 = (((int)puVar10 + -3) - (uint)CARRY1((byte)uVar8,(byte)uVar8)) - local_98;
      if ((0 < local_8c) && (local_88 != (char *)0x0)) {
        BUF_strlcpy(local_88,(char *)local_68,(long)local_8c);
        if (local_8c < local_98) {
          local_88 = local_88 + local_8c;
          local_8c = 0;
        }
        else {
          local_8c = local_8c - local_98;
          local_88 = local_88 + local_98;
        }
      }
      local_80 = local_80 + local_98;
    }
    if (iVar11 < 1) {
      if (a_00 != (BIGNUM *)0x0) {
        BN_free(a_00);
        return local_80;
      }
      return local_80;
    }
    bVar14 = false;
  } while( true );
}



int OBJ_ln2nid(char *s)

{
  uint uVar1;
  char *__s1;
  int iVar2;
  void *pvVar3;
  int iVar4;
  int iVar5;
  int iVar6;
  undefined4 local_68 [2];
  undefined1 *local_60;
  undefined1 local_58 [8];
  char *local_50;
  
  local_50 = s;
  if (added != (_LHASH *)0x0) {
    local_60 = local_58;
    local_68[0] = 2;
    pvVar3 = lh_retrieve(added,local_68);
    if (pvVar3 != (void *)0x0) {
      return *(int *)(*(long *)((long)pvVar3 + 8) + 0x10);
    }
  }
  __s1 = local_50;
  iVar5 = 0;
  iVar6 = 0x391;
  do {
    while( true ) {
      iVar4 = iVar5 + iVar6 >> 1;
      uVar1 = *(uint *)(ln_objs + iVar4 * 4);
      iVar2 = strcmp(__s1,(&PTR_s_undefined_004dcce8)[(ulong)uVar1 * 5]);
      if (-1 < iVar2) break;
      iVar6 = iVar4;
      if (iVar4 <= iVar5) goto LAB_00494121;
    }
    if (iVar2 == 0) goto LAB_00494138;
    iVar5 = iVar4 + 1;
  } while (iVar5 < iVar6);
LAB_00494121:
  if (iVar2 != 0) {
    return 0;
  }
LAB_00494138:
  return *(int *)(&DAT_004dccf0 + (ulong)uVar1 * 0x28);
}



int OBJ_sn2nid(char *s)

{
  uint uVar1;
  char *__s1;
  int iVar2;
  void *pvVar3;
  int iVar4;
  int iVar5;
  int iVar6;
  undefined4 local_68 [2];
  char **local_60;
  char *local_58 [6];
  
  local_58[0] = s;
  if (added != (_LHASH *)0x0) {
    local_60 = local_58;
    local_68[0] = 1;
    pvVar3 = lh_retrieve(added,local_68);
    if (pvVar3 != (void *)0x0) {
      return *(int *)(*(long *)((long)pvVar3 + 8) + 0x10);
    }
  }
  __s1 = local_58[0];
  iVar5 = 0;
  iVar6 = 0x391;
  do {
    while( true ) {
      iVar4 = iVar5 + iVar6 >> 1;
      uVar1 = *(uint *)(sn_objs + iVar4 * 4);
      iVar2 = strcmp(__s1,(&nid_objs)[(ulong)uVar1 * 5]);
      if (-1 < iVar2) break;
      iVar6 = iVar4;
      if (iVar4 <= iVar5) goto LAB_00494211;
    }
    if (iVar2 == 0) goto LAB_00494228;
    iVar5 = iVar4 + 1;
  } while (iVar5 < iVar6);
LAB_00494211:
  if (iVar2 != 0) {
    return 0;
  }
LAB_00494228:
  return *(int *)(&DAT_004dccf0 + (ulong)uVar1 * 0x28);
}



ASN1_OBJECT * OBJ_txt2obj(char *s,int no_name)

{
  uint uVar1;
  int iVar2;
  int num;
  uchar *ptr;
  ASN1_OBJECT *pAVar3;
  void *pvVar4;
  uchar *local_68;
  uchar **local_60;
  uchar *local_58 [2];
  uint local_48;
  
  if ((no_name == 0) && ((uVar1 = OBJ_sn2nid(s), uVar1 != 0 || (uVar1 = OBJ_ln2nid(s), uVar1 != 0)))
     ) {
    if (uVar1 < 0x398) {
      iVar2 = 0x12a;
      if (*(int *)(&DAT_004dccf0 + (long)(int)uVar1 * 0x28) != 0) {
        return (ASN1_OBJECT *)(&nid_objs + (long)(int)uVar1 * 5);
      }
    }
    else {
      if (added == (_LHASH *)0x0) {
        return (ASN1_OBJECT *)0x0;
      }
      local_60 = local_58;
      local_68 = (uchar *)CONCAT44(local_68._4_4_,3);
      local_48 = uVar1;
      pvVar4 = lh_retrieve(added,&local_68);
      if (pvVar4 != (void *)0x0) {
        return *(ASN1_OBJECT **)((long)pvVar4 + 8);
      }
      iVar2 = 0x13b;
    }
    ERR_put_error(8,0x67,0x65,"obj_dat.c",iVar2);
  }
  else {
    iVar2 = a2d_ASN1_OBJECT((uchar *)0x0,0,s,-1);
    if (0 < iVar2) {
      num = ASN1_object_size(0,iVar2,6);
      ptr = (uchar *)CRYPTO_malloc(num,"obj_dat.c",0x1c4);
      if (ptr != (uchar *)0x0) {
        local_68 = ptr;
        ASN1_put_object(&local_68,0,iVar2,6,0);
        a2d_ASN1_OBJECT(local_68,iVar2,s,-1);
        local_58[0] = ptr;
        pAVar3 = d2i_ASN1_OBJECT((ASN1_OBJECT **)0x0,local_58,(long)num);
        CRYPTO_free(ptr);
        return pAVar3;
      }
    }
  }
  return (ASN1_OBJECT *)0x0;
}



int OBJ_txt2nid(char *s)

{
  uint uVar1;
  int iVar2;
  int num;
  uchar *ptr;
  ASN1_OBJECT *o;
  void *pvVar3;
  uchar *local_68;
  uchar **local_60;
  uchar *local_58 [2];
  uint local_48;
  
  uVar1 = OBJ_sn2nid(s);
  if (uVar1 == 0) {
    uVar1 = OBJ_ln2nid(s);
    if (uVar1 != 0) goto LAB_004944a0;
    iVar2 = a2d_ASN1_OBJECT((uchar *)0x0,0,s,-1);
    if (0 < iVar2) {
      num = ASN1_object_size(0,iVar2,6);
      ptr = (uchar *)CRYPTO_malloc(num,"obj_dat.c",0x1c4);
      if (ptr != (uchar *)0x0) {
        local_68 = ptr;
        ASN1_put_object(&local_68,0,iVar2,6,0);
        a2d_ASN1_OBJECT(local_68,iVar2,s,-1);
        local_58[0] = ptr;
        o = d2i_ASN1_OBJECT((ASN1_OBJECT **)0x0,local_58,(long)num);
        CRYPTO_free(ptr);
        goto LAB_0049447d;
      }
    }
  }
  else {
LAB_004944a0:
    if (uVar1 < 0x398) {
      iVar2 = 0x12a;
      o = (ASN1_OBJECT *)(&nid_objs + (long)(int)uVar1 * 5);
      if (*(int *)(&DAT_004dccf0 + (long)(int)uVar1 * 0x28) != 0) goto LAB_0049447d;
    }
    else {
      if (added == (_LHASH *)0x0) goto LAB_00494520;
      local_60 = local_58;
      local_68 = (uchar *)CONCAT44(local_68._4_4_,3);
      local_48 = uVar1;
      pvVar3 = lh_retrieve(added,&local_68);
      if (pvVar3 != (void *)0x0) {
        o = *(ASN1_OBJECT **)((long)pvVar3 + 8);
        goto LAB_0049447d;
      }
      iVar2 = 0x13b;
    }
    ERR_put_error(8,0x67,0x65,"obj_dat.c",iVar2);
  }
LAB_00494520:
  o = (ASN1_OBJECT *)0x0;
LAB_0049447d:
  iVar2 = OBJ_obj2nid(o);
  ASN1_OBJECT_free(o);
  return iVar2;
}



void * OBJ_bsearch_(void *key,void *base,int num,int size,cmp *cmp)

{
  int iVar1;
  int iVar2;
  int iVar3;
  void *pvVar4;
  
  if (num == 0) {
    return (void *)0x0;
  }
  if (num < 1) {
    pvVar4 = (void *)0x0;
  }
  else {
    iVar3 = 0;
    do {
      while( true ) {
        iVar2 = (iVar3 + num) / 2;
        pvVar4 = (void *)((long)(size * iVar2) + (long)base);
        iVar1 = (*cmp)(key,pvVar4);
        if (-1 < iVar1) break;
        num = iVar2;
        if (iVar2 <= iVar3) goto LAB_0049459d;
      }
      if (iVar1 == 0) {
        return pvVar4;
      }
      iVar3 = iVar2 + 1;
    } while (iVar3 < num);
LAB_0049459d:
    if (iVar1 != 0) {
      return (void *)0x0;
    }
  }
  return pvVar4;
}



void * OBJ_bsearch_ex_(void *key,void *base,int num,int size,cmp *cmp,int flags)

{
  uint uVar1;
  int iVar2;
  void *pvVar3;
  int iVar4;
  int iVar5;
  
  if (num != 0) {
    if (num < 1) {
      uVar1 = flags & 2;
      pvVar3 = base;
    }
    else {
      iVar4 = 0;
      do {
        while( true ) {
          iVar5 = iVar4 + num >> 1;
          pvVar3 = (void *)((long)(iVar5 * size) + (long)base);
          iVar2 = (*cmp)(key,pvVar3);
          if (-1 < iVar2) break;
          num = iVar5;
          if (iVar5 <= iVar4) goto LAB_00494648;
        }
        if (iVar2 == 0) goto LAB_00494670;
        iVar4 = iVar5 + 1;
      } while (iVar4 < num);
LAB_00494648:
      if (iVar2 == 0) {
LAB_00494670:
        if ((flags & 2U) == 0) {
          return pvVar3;
        }
        if (iVar5 == 0) {
          return pvVar3;
        }
        pvVar3 = (void *)((long)base + (long)(size * (iVar5 + -1)));
        iVar4 = iVar5 + -1;
        while( true ) {
          iVar2 = (*cmp)(key,pvVar3);
          if (iVar2 != 0) {
            return (void *)((long)(size * iVar5) + (long)base);
          }
          if (iVar4 == 0) break;
          pvVar3 = (void *)((long)pvVar3 + (long)-size);
          iVar5 = iVar4;
          iVar4 = iVar4 + -1;
        }
        return pvVar3;
      }
      uVar1 = flags & 1;
    }
    if (uVar1 != 0) {
      return pvVar3;
    }
  }
  return (void *)0x0;
}



int OBJ_create(char *oid,char *sn,char *ln)

{
  int iVar1;
  int len;
  int iVar2;
  uchar *out;
  ASN1_OBJECT *obj;
  
  iVar1 = a2d_ASN1_OBJECT((uchar *)0x0,0,oid,-1);
  iVar2 = 0;
  if (0 < iVar1) {
    out = (uchar *)CRYPTO_malloc(iVar1,"obj_dat.c",0x319);
    if (out == (uchar *)0x0) {
      ERR_put_error(8,100,0x41,"obj_dat.c",0x31b);
      iVar2 = 0;
    }
    else {
      obj = (ASN1_OBJECT *)0x0;
      len = a2d_ASN1_OBJECT(out,iVar1,oid,-1);
      iVar1 = new_nid;
      iVar2 = 0;
      if (len != 0) {
        new_nid = new_nid + 1;
        obj = ASN1_OBJECT_create(iVar1,out,len,sn,ln);
        iVar2 = 0;
        if (obj != (ASN1_OBJECT *)0x0) {
          iVar2 = OBJ_add_object(obj);
        }
      }
      ASN1_OBJECT_free(obj);
      CRYPTO_free(out);
    }
  }
  return iVar2;
}



int OBJ_create_objects(BIO *in)

{
  byte bVar1;
  ushort *puVar2;
  int iVar3;
  ushort **ppuVar4;
  byte *sn;
  byte *pbVar5;
  byte *ln;
  int iVar7;
  byte bVar8;
  ushort uVar9;
  byte local_218 [512];
  byte *pbVar6;
  
  iVar7 = 0;
  ln = (byte *)0x0;
  do {
    iVar3 = BIO_gets(in,(char *)local_218,0x200);
    if (iVar3 < 1) {
      return iVar7;
    }
    local_218[iVar3 + -1] = 0;
    ppuVar4 = __ctype_b_loc();
    puVar2 = *ppuVar4;
    uVar9 = puVar2[local_218[0]];
    pbVar5 = local_218;
    bVar8 = local_218[0];
    if ((uVar9 & 8) == 0) {
      return iVar7;
    }
    while (((uVar9 & 0x800) != 0 || (bVar8 == 0x2e))) {
      bVar8 = pbVar5[1];
      uVar9 = puVar2[bVar8];
      pbVar5 = pbVar5 + 1;
    }
    sn = (byte *)0x0;
    if (bVar8 != 0) {
      *pbVar5 = 0;
      sn = pbVar5 + 1;
      bVar8 = pbVar5[1];
      bVar1 = *(byte *)((long)puVar2 + (ulong)bVar8 * 2 + 1);
      while ((bVar1 & 0x20) != 0) {
        sn = sn + 1;
        bVar8 = *sn;
        bVar1 = *(byte *)((long)puVar2 + (ulong)bVar8 * 2 + 1);
      }
      pbVar5 = sn;
      if (bVar8 == 0) {
        sn = (byte *)0x0;
      }
      else {
        do {
          pbVar6 = pbVar5;
          pbVar5 = pbVar6 + 1;
          if (*pbVar5 == 0) {
            ln = (byte *)0x0;
            goto joined_r0x004948ae;
          }
        } while ((*(byte *)((long)puVar2 + (ulong)*pbVar5 * 2 + 1) & 0x20) == 0);
        *pbVar5 = 0;
        ln = pbVar6 + 2;
        bVar8 = pbVar6[2];
        bVar1 = *(byte *)((long)puVar2 + (ulong)bVar8 * 2 + 1);
        while ((bVar1 & 0x20) != 0) {
          ln = ln + 1;
          bVar8 = *ln;
          bVar1 = *(byte *)((long)puVar2 + (ulong)bVar8 * 2 + 1);
        }
        if (bVar8 == 0) {
          ln = (byte *)0x0;
        }
      }
    }
joined_r0x004948ae:
    if (local_218[0] == 0) {
      return iVar7;
    }
    iVar3 = OBJ_create((char *)local_218,(char *)sn,(char *)ln);
    if (iVar3 == 0) {
      return iVar7;
    }
    iVar7 = iVar7 + 1;
  } while( true );
}



ASN1_OBJECT * OBJ_dup(ASN1_OBJECT *o)

{
  ASN1_OBJECT *ptr;
  uchar *__dest;
  size_t sVar1;
  char **ppcVar2;
  void *__dest_00;
  char *pcVar3;
  int iVar4;
  
  if (o == (ASN1_OBJECT *)0x0) {
    return (ASN1_OBJECT *)0x0;
  }
  if ((o->flags & 1) == 0) {
    return o;
  }
  ptr = ASN1_OBJECT_new();
  if (ptr == (ASN1_OBJECT *)0x0) {
    ERR_put_error(8,0x65,0xd,"obj_lib.c",0x50);
    return (ASN1_OBJECT *)0x0;
  }
  __dest = (uchar *)CRYPTO_malloc(o->length,"obj_lib.c",0x53);
  if (__dest == (uchar *)0x0) {
    ERR_put_error(8,0x65,0x41,"obj_lib.c",0x72);
    goto LAB_00494aa7;
  }
  if (o->data != (uchar *)0x0) {
    memcpy(__dest,o->data,(long)o->length);
  }
  iVar4 = o->length;
  ptr->data = __dest;
  ptr->length = iVar4;
  iVar4 = o->nid;
  ptr->ln = (char **)0x0;
  ppcVar2 = o->ln;
  ptr->sn = (char *)0x0;
  ptr->nid = iVar4;
  if (ppcVar2 == (char **)0x0) {
    ppcVar2 = (char **)0x0;
LAB_00494a27:
    if (o->sn == (char *)0x0) {
LAB_00494a65:
      ptr->flags = o->flags | 0xd;
      return ptr;
    }
    sVar1 = strlen(o->sn);
    iVar4 = (int)sVar1 + 1;
    __dest_00 = CRYPTO_malloc(iVar4,"obj_lib.c",0x69);
    if (__dest_00 != (void *)0x0) {
      pcVar3 = (char *)memcpy(__dest_00,o->sn,(long)iVar4);
      ptr->sn = pcVar3;
      goto LAB_00494a65;
    }
    ERR_put_error(8,0x65,0x41,"obj_lib.c",0x72);
    if (ppcVar2 != (char **)0x0) {
      CRYPTO_free(ppcVar2);
    }
  }
  else {
    sVar1 = strlen((char *)ppcVar2);
    iVar4 = (int)sVar1 + 1;
    ppcVar2 = (char **)CRYPTO_malloc(iVar4,"obj_lib.c",0x60);
    if (ppcVar2 != (char **)0x0) {
      memcpy(ppcVar2,o->ln,(long)iVar4);
      ptr->ln = ppcVar2;
      goto LAB_00494a27;
    }
    ERR_put_error(8,0x65,0x41,"obj_lib.c",0x72);
  }
  CRYPTO_free(__dest);
LAB_00494aa7:
  CRYPTO_free(ptr);
  return (ASN1_OBJECT *)0x0;
}



int OBJ_cmp(ASN1_OBJECT *a,ASN1_OBJECT *b)

{
  int iVar1;
  
  iVar1 = a->length - b->length;
  if (iVar1 == 0) {
    iVar1 = memcmp(a->data,b->data,(long)a->length);
    return iVar1;
  }
  return iVar1;
}



undefined8 * bn_expand_internal(long *param_1,int param_2)

{
  undefined8 uVar1;
  undefined8 uVar2;
  undefined8 uVar3;
  undefined8 *puVar4;
  undefined8 *puVar5;
  undefined8 *puVar6;
  uint uVar7;
  long lVar8;
  int iVar9;
  int iVar10;
  undefined8 *puVar11;
  
  if (0x7fffff < param_2) {
    ERR_put_error(3,0x78,0x72,"bn_lib.c",0x135);
    return (undefined8 *)0x0;
  }
  if ((*(byte *)((long)param_1 + 0x14) & 2) != 0) {
    ERR_put_error(3,0x78,0x69,"bn_lib.c",0x13a);
    return (undefined8 *)0x0;
  }
  puVar4 = (undefined8 *)CRYPTO_malloc(param_2 * 8,"bn_lib.c",0x13d);
  if (puVar4 == (undefined8 *)0x0) {
    ERR_put_error(3,0x78,0x41,"bn_lib.c",0x140);
    return (undefined8 *)0x0;
  }
  puVar11 = (undefined8 *)*param_1;
  if (puVar11 == (undefined8 *)0x0) {
    return puVar4;
  }
  uVar7 = *(uint *)(param_1 + 1);
  iVar9 = (int)uVar7 >> 2;
  puVar6 = puVar4;
  puVar5 = puVar11;
  iVar10 = iVar9;
  if (0 < iVar9) {
    do {
      uVar1 = puVar5[1];
      uVar2 = puVar5[2];
      uVar3 = puVar5[3];
      *puVar6 = *puVar5;
      puVar6[1] = uVar1;
      puVar6[2] = uVar2;
      puVar6[3] = uVar3;
      iVar10 = iVar10 + -1;
      puVar5 = puVar5 + 4;
      puVar6 = puVar6 + 4;
    } while (iVar10 != 0);
    lVar8 = (long)(iVar9 + -1) + 1;
    puVar11 = puVar11 + lVar8 * 4;
    puVar6 = puVar4 + lVar8 * 4;
  }
  uVar7 = uVar7 & 3;
  if (uVar7 != 2) {
    if (uVar7 != 3) {
      if (uVar7 != 1) {
        return puVar4;
      }
      goto LAB_00494c60;
    }
    puVar6[2] = puVar11[2];
  }
  puVar6[1] = puVar11[1];
LAB_00494c60:
  *puVar6 = *puVar11;
  return puVar4;
}



void BN_set_params(int mul,int high,int low,int mont)

{
  if (-1 < mul) {
    bn_limit_bits = 0x1f;
    if (mul < 0x20) {
      bn_limit_bits = mul;
    }
    bn_limit_num = 1 << ((byte)bn_limit_bits & 0x1f);
  }
  if (-1 < high) {
    bn_limit_bits_high = 0x1f;
    if (high < 0x20) {
      bn_limit_bits_high = high;
    }
    bn_limit_num_high = 1 << ((byte)bn_limit_bits_high & 0x1f);
  }
  if (-1 < low) {
    bn_limit_bits_low = 0x1f;
    if (low < 0x20) {
      bn_limit_bits_low = low;
    }
    bn_limit_num_low = 1 << ((byte)bn_limit_bits_low & 0x1f);
  }
  if (-1 < mont) {
    bn_limit_bits_mont = 0x1f;
    if (mont < 0x20) {
      bn_limit_bits_mont = mont;
    }
    bn_limit_num_mont = 1 << ((byte)bn_limit_bits_mont & 0x1f);
  }
  return;
}



int BN_get_params(int which)

{
  int iVar1;
  
  if (which == 0) {
    return bn_limit_bits;
  }
  if (which != 1) {
    if (which != 2) {
      iVar1 = 0;
      if (which == 3) {
        iVar1 = bn_limit_bits_mont;
      }
      return iVar1;
    }
    return bn_limit_bits_low;
  }
  return bn_limit_bits_high;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

BIGNUM * BN_value_one(void)

{
  return (BIGNUM *)const_one_5772;
}



int BN_num_bits_word(ulong param_1)

{
  if ((param_1 & 0xffffffff00000000) == 0) {
    if ((param_1 & 0xffff0000) == 0) {
      if ((param_1 & 0xff00) == 0) {
        return (int)(byte)bits_5776[(int)param_1];
      }
      return (byte)bits_5776[(int)(param_1 >> 8)] + 8;
    }
    if ((param_1 & 0xff000000) != 0) {
      return (byte)bits_5776[(int)(param_1 >> 0x18)] + 0x18;
    }
    return (byte)bits_5776[(int)(param_1 >> 0x10)] + 0x10;
  }
  if ((param_1 & 0xffff000000000000) == 0) {
    if ((param_1 & 0xff0000000000) != 0) {
      return (byte)bits_5776[param_1 >> 0x28] + 0x28;
    }
    return (byte)bits_5776[(long)param_1 >> 0x20] + 0x20;
  }
  if ((param_1 & 0xff00000000000000) != 0) {
    return (byte)bits_5776[param_1 >> 0x38] + 0x38;
  }
  return (byte)bits_5776[param_1 >> 0x30] + 0x30;
}



int BN_num_bits(BIGNUM *a)

{
  ulong uVar1;
  int iVar2;
  int iVar3;
  
  iVar2 = a->top;
  if (iVar2 != 0) {
    iVar3 = (iVar2 + -1) * 0x40;
    uVar1 = a->d[iVar2 + -1];
    if ((uVar1 & 0xffffffff00000000) == 0) {
      if ((uVar1 & 0xffff0000) == 0) {
        if ((char)(uVar1 >> 8) == '\0') {
          iVar2 = (uint)(byte)bits_5776[(int)uVar1] + iVar3;
        }
        else {
          iVar2 = (byte)bits_5776[(int)(uVar1 >> 8)] + 8 + iVar3;
        }
      }
      else if ((uVar1 & 0xff000000) == 0) {
        iVar2 = (byte)bits_5776[(int)(uVar1 >> 0x10)] + 0x10 + iVar3;
      }
      else {
        iVar2 = (byte)bits_5776[(int)(uVar1 >> 0x18)] + 0x18 + iVar3;
      }
    }
    else if ((uVar1 & 0xffff000000000000) == 0) {
      if ((uVar1 & 0xff0000000000) == 0) {
        iVar2 = (byte)bits_5776[(long)uVar1 >> 0x20] + 0x20 + iVar3;
      }
      else {
        iVar2 = (byte)bits_5776[uVar1 >> 0x28] + 0x28 + iVar3;
      }
    }
    else if ((uVar1 & 0xff00000000000000) == 0) {
      iVar2 = (byte)bits_5776[uVar1 >> 0x30] + 0x30 + iVar3;
    }
    else {
      iVar2 = (byte)bits_5776[uVar1 >> 0x38] + 0x38 + iVar3;
    }
  }
  return iVar2;
}



void BN_clear_free(BIGNUM *a)

{
  uint uVar1;
  
  if (a == (BIGNUM *)0x0) {
    return;
  }
  if (a->d != (ulong *)0x0) {
    OPENSSL_cleanse(a->d,(long)a->dmax << 3);
    uVar1 = a->flags;
    if ((uVar1 & 2) != 0) goto LAB_0049503c;
    CRYPTO_free(a->d);
  }
  uVar1 = a->flags;
LAB_0049503c:
  OPENSSL_cleanse(a,0x18);
  if ((uVar1 & 1) == 0) {
    return;
  }
  CRYPTO_free(a);
  return;
}



void BN_free(BIGNUM *a)

{
  uint uVar1;
  
  if (a != (BIGNUM *)0x0) {
    uVar1 = a->flags;
    if ((a->d != (ulong *)0x0) && ((uVar1 & 2) == 0)) {
      CRYPTO_free(a->d);
      uVar1 = a->flags;
    }
    if ((uVar1 & 1) != 0) {
      CRYPTO_free(a);
      return;
    }
    a->d = (ulong *)0x0;
    a->flags = uVar1 | 0x8000;
  }
  return;
}



void BN_init(BIGNUM *param_1)

{
  param_1->d = (ulong *)0x0;
  param_1->top = 0;
  param_1->dmax = 0;
  param_1->neg = 0;
  param_1->flags = 0;
  return;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

BIGNUM * BN_new(void)

{
  BIGNUM *pBVar1;
  
  pBVar1 = (BIGNUM *)CRYPTO_malloc(0x18,"bn_lib.c",0x11b);
  if (pBVar1 == (BIGNUM *)0x0) {
    ERR_put_error(3,0x71,0x41,"bn_lib.c",0x11d);
    pBVar1 = (BIGNUM *)0x0;
  }
  else {
    pBVar1->d = (ulong *)0x0;
    pBVar1->top = 0;
    pBVar1->dmax = 0;
    pBVar1->neg = 0;
    pBVar1->flags = 1;
  }
  return pBVar1;
}



BIGNUM * bn_expand2(BIGNUM *a,int words)

{
  ulong *puVar1;
  
  if (a->dmax < words) {
    puVar1 = (ulong *)bn_expand_internal();
    if (puVar1 != (ulong *)0x0) {
      if (a->d != (ulong *)0x0) {
        CRYPTO_free(a->d);
      }
      a->dmax = words;
      a->d = puVar1;
      return a;
    }
    a = (BIGNUM *)0x0;
  }
  return a;
}



BIGNUM * BN_dup(BIGNUM *a)

{
  ulong uVar1;
  ulong uVar2;
  ulong uVar3;
  BIGNUM *ptr;
  ulong *puVar4;
  ulong *puVar5;
  uint uVar6;
  ulong *puVar7;
  long lVar8;
  int iVar9;
  ulong *puVar10;
  uint uVar11;
  int iVar12;
  
  if (a == (BIGNUM *)0x0) {
    return (BIGNUM *)0x0;
  }
  ptr = (BIGNUM *)CRYPTO_malloc(0x18,"bn_lib.c",0x11b);
  if (ptr == (BIGNUM *)0x0) {
    ERR_put_error(3,0x71,0x41,"bn_lib.c",0x11d);
    return (BIGNUM *)0x0;
  }
  ptr->d = (ulong *)0x0;
  ptr->top = 0;
  ptr->dmax = 0;
  ptr->neg = 0;
  ptr->flags = 1;
  if (a == ptr) {
    return ptr;
  }
  puVar4 = (ulong *)0x0;
  uVar11 = a->top;
  if (0 < (int)uVar11) {
    puVar4 = (ulong *)bn_expand_internal(ptr,uVar11);
    puVar10 = ptr->d;
    if (puVar4 == (ulong *)0x0) {
      if (puVar10 != (ulong *)0x0) {
        uVar11 = ptr->flags;
        if ((uVar11 & 2) != 0) goto LAB_00495319;
        CRYPTO_free(puVar10);
      }
      uVar11 = ptr->flags;
LAB_00495319:
      if ((uVar11 & 1) == 0) {
        ptr->d = (ulong *)0x0;
        ptr->flags = uVar11 | 0x8000;
        return (BIGNUM *)0x0;
      }
      CRYPTO_free(ptr);
      return (BIGNUM *)0x0;
    }
    if (puVar10 != (ulong *)0x0) {
      CRYPTO_free(puVar10);
    }
    ptr->d = puVar4;
    ptr->dmax = uVar11;
    uVar11 = a->top;
  }
  puVar10 = a->d;
  iVar12 = (int)uVar11 >> 2;
  puVar5 = puVar4;
  puVar7 = puVar10;
  iVar9 = iVar12;
  if (0 < iVar12) {
    do {
      uVar1 = puVar7[1];
      uVar2 = puVar7[2];
      uVar3 = puVar7[3];
      *puVar5 = *puVar7;
      puVar5[1] = uVar1;
      puVar5[2] = uVar2;
      puVar5[3] = uVar3;
      iVar9 = iVar9 + -1;
      puVar5 = puVar5 + 4;
      puVar7 = puVar7 + 4;
    } while (iVar9 != 0);
    lVar8 = (long)(iVar12 + -1) + 1;
    puVar4 = puVar4 + lVar8 * 4;
    puVar10 = puVar10 + lVar8 * 4;
  }
  uVar6 = uVar11 & 3;
  if (uVar6 == 2) {
LAB_00495298:
    puVar4[1] = puVar10[1];
  }
  else {
    if (uVar6 == 3) {
      puVar4[2] = puVar10[2];
      goto LAB_00495298;
    }
    if (uVar6 != 1) goto LAB_00495276;
  }
  *puVar4 = *puVar10;
LAB_00495276:
  iVar9 = a->neg;
  ptr->top = uVar11;
  ptr->neg = iVar9;
  return ptr;
}



BIGNUM * BN_copy(BIGNUM *a,BIGNUM *b)

{
  ulong uVar1;
  ulong uVar2;
  ulong uVar3;
  ulong *puVar4;
  ulong *puVar5;
  uint uVar6;
  ulong *puVar7;
  long lVar8;
  ulong *puVar9;
  uint uVar10;
  int iVar11;
  int iVar12;
  
  if (a == b) {
    return a;
  }
  uVar10 = b->top;
  if (a->dmax < (int)uVar10) {
    puVar4 = (ulong *)bn_expand_internal(a,uVar10);
    if (puVar4 == (ulong *)0x0) {
      return (BIGNUM *)0x0;
    }
    if (a->d != (ulong *)0x0) {
      CRYPTO_free(a->d);
    }
    a->d = puVar4;
    a->dmax = uVar10;
    uVar10 = b->top;
  }
  else {
    puVar4 = a->d;
  }
  puVar9 = b->d;
  iVar12 = (int)uVar10 >> 2;
  puVar5 = puVar9;
  puVar7 = puVar4;
  iVar11 = iVar12;
  if (0 < iVar12) {
    do {
      uVar1 = puVar5[2];
      uVar2 = puVar5[3];
      uVar3 = *puVar5;
      puVar7[1] = puVar5[1];
      puVar7[2] = uVar1;
      *puVar7 = uVar3;
      puVar7[3] = uVar2;
      iVar11 = iVar11 + -1;
      puVar5 = puVar5 + 4;
      puVar7 = puVar7 + 4;
    } while (iVar11 != 0);
    lVar8 = (long)(iVar12 + -1) + 1;
    puVar4 = puVar4 + lVar8 * 4;
    puVar9 = puVar9 + lVar8 * 4;
  }
  uVar6 = uVar10 & 3;
  if (uVar6 == 2) {
LAB_00495418:
    puVar4[1] = puVar9[1];
  }
  else {
    if (uVar6 == 3) {
      puVar4[2] = puVar9[2];
      goto LAB_00495418;
    }
    if (uVar6 != 1) goto LAB_004953f7;
  }
  *puVar4 = *puVar9;
LAB_004953f7:
  iVar11 = b->neg;
  a->top = uVar10;
  a->neg = iVar11;
  return a;
}



BIGNUM * bn_dup_expand(BIGNUM *a,int words)

{
  int iVar1;
  uint uVar2;
  ulong *ptr;
  BIGNUM *a_00;
  BIGNUM *pBVar3;
  
  if (a->dmax < words) {
    ptr = (ulong *)bn_expand_internal();
    if (ptr == (ulong *)0x0) {
      a_00 = (BIGNUM *)0x0;
    }
    else {
      a_00 = (BIGNUM *)CRYPTO_malloc(0x18,"bn_lib.c",0x11b);
      if (a_00 == (BIGNUM *)0x0) {
        ERR_put_error(3,0x71,0x41,"bn_lib.c",0x11d);
        CRYPTO_free(ptr);
      }
      else {
        a_00->neg = 0;
        a_00->flags = 1;
        a_00->top = 0;
        iVar1 = a->top;
        a_00->dmax = words;
        a_00->top = iVar1;
        iVar1 = a->neg;
        a_00->d = ptr;
        a_00->neg = iVar1;
      }
    }
  }
  else {
    a_00 = (BIGNUM *)CRYPTO_malloc(0x18,"bn_lib.c",0x11b);
    if (a_00 == (BIGNUM *)0x0) {
      ERR_put_error(3,0x71,0x41,"bn_lib.c",0x11d);
    }
    else {
      a_00->d = (ulong *)0x0;
      a_00->top = 0;
      a_00->dmax = 0;
      a_00->neg = 0;
      a_00->flags = 1;
      pBVar3 = BN_copy(a_00,a);
      if (pBVar3 == (BIGNUM *)0x0) {
        uVar2 = a_00->flags;
        if ((a_00->d != (ulong *)0x0) && ((uVar2 & 2) == 0)) {
          CRYPTO_free(a_00->d);
          uVar2 = a_00->flags;
        }
        if ((uVar2 & 1) == 0) {
          a_00->d = (ulong *)0x0;
          a_00->flags = uVar2 | 0x8000;
          a_00 = (BIGNUM *)0x0;
        }
        else {
          CRYPTO_free(a_00);
          a_00 = (BIGNUM *)0x0;
        }
      }
    }
  }
  return a_00;
}



void BN_swap(BIGNUM *a,BIGNUM *b)

{
  uint uVar1;
  int iVar2;
  uint uVar3;
  int iVar4;
  int iVar5;
  ulong *puVar6;
  
  uVar1 = b->flags;
  puVar6 = a->d;
  iVar2 = a->top;
  uVar3 = a->flags;
  iVar4 = a->dmax;
  a->d = b->d;
  iVar5 = a->neg;
  a->top = b->top;
  a->dmax = b->dmax;
  a->neg = b->neg;
  b->dmax = iVar4;
  b->neg = iVar5;
  b->d = puVar6;
  b->top = iVar2;
  a->flags = uVar1 & 2 | uVar3 & 1;
  b->flags = uVar3 & 2 | uVar1 & 1;
  return;
}



void BN_clear(BIGNUM *a)

{
  if (a->d != (ulong *)0x0) {
    memset(a->d,0,(long)a->dmax << 3);
  }
  a->top = 0;
  a->neg = 0;
  return;
}



ulong BN_get_word(BIGNUM *a)

{
  ulong uVar1;
  
  uVar1 = 0xffffffffffffffff;
  if ((a->top < 2) && (uVar1 = 0, a->top == 1)) {
    return *a->d;
  }
  return uVar1;
}



int BN_set_word(BIGNUM *a,ulong w)

{
  ulong *puVar1;
  
  if (a->dmax < 1) {
    puVar1 = (ulong *)bn_expand_internal(a,1);
    if (puVar1 == (ulong *)0x0) {
      return 0;
    }
    if (a->d != (ulong *)0x0) {
      CRYPTO_free(a->d);
    }
    a->d = puVar1;
    a->dmax = 1;
  }
  a->neg = 0;
  *a->d = w;
  a->top = (uint)(w != 0);
  return 1;
}



BIGNUM * BN_bin2bn(uchar *s,int len,BIGNUM *ret)

{
  ulong *puVar1;
  ulong uVar2;
  byte *pbVar3;
  byte *pbVar4;
  ulong uVar5;
  uint uVar6;
  uint uVar7;
  BIGNUM *ptr;
  uint uVar8;
  
  ptr = (BIGNUM *)0x0;
  if (ret == (BIGNUM *)0x0) {
    ret = (BIGNUM *)CRYPTO_malloc(0x18,"bn_lib.c",0x11b);
    if (ret == (BIGNUM *)0x0) {
      ERR_put_error(3,0x71,0x41,"bn_lib.c",0x11d);
      return (BIGNUM *)0x0;
    }
    ret->d = (ulong *)0x0;
    ret->top = 0;
    ret->dmax = 0;
    ret->neg = 0;
    ret->flags = 1;
    ptr = ret;
  }
  if (len == 0) {
    ret->top = 0;
    return ret;
  }
  uVar8 = len - 1;
  uVar7 = (uVar8 >> 3) + 1;
  uVar5 = (ulong)uVar7;
  if (ret->dmax < (int)uVar7) {
    puVar1 = (ulong *)bn_expand_internal(ret,uVar7);
    if (puVar1 == (ulong *)0x0) {
      if (ptr != (BIGNUM *)0x0) {
        uVar7 = ptr->flags;
        if ((ptr->d != (ulong *)0x0) && ((uVar7 & 2) == 0)) {
          CRYPTO_free(ptr->d);
          uVar7 = ptr->flags;
        }
        if ((uVar7 & 1) == 0) {
          ptr->d = (ulong *)0x0;
          ptr->flags = uVar7 | 0x8000;
          return (BIGNUM *)0x0;
        }
        CRYPTO_free(ptr);
      }
      return (BIGNUM *)0x0;
    }
    if (ret->d != (ulong *)0x0) {
      CRYPTO_free(ret->d);
    }
    ret->d = puVar1;
    ret->dmax = uVar7;
  }
  ret->top = uVar7;
  ret->neg = 0;
  uVar6 = uVar8 & 7;
  puVar1 = ret->d;
  uVar2 = 0;
  pbVar3 = s;
  do {
    while( true ) {
      pbVar4 = pbVar3 + 1;
      uVar2 = (ulong)*pbVar3 | uVar2 << 8;
      pbVar3 = pbVar4;
      if (uVar6 != 0) break;
      uVar7 = uVar7 - 1;
      puVar1[uVar7] = uVar2;
      uVar2 = 0;
      uVar6 = 7;
      if (pbVar4 == s + (ulong)uVar8 + 1) goto LAB_0049579f;
    }
    uVar6 = uVar6 - 1;
  } while (pbVar4 != s + (ulong)uVar8 + 1);
LAB_0049579f:
  puVar1 = puVar1 + (uVar5 - 1);
  do {
    uVar7 = (uint)uVar5;
    if (*puVar1 != 0) break;
    uVar7 = uVar7 - 1;
    uVar5 = (ulong)uVar7;
    puVar1 = puVar1 + -1;
  } while (uVar7 != 0);
  ret->top = uVar7;
  return ret;
}



int BN_bn2bin(BIGNUM *a,uchar *to)

{
  char cVar1;
  byte bVar2;
  int iVar3;
  int iVar4;
  int iVar5;
  ulong *puVar6;
  
  iVar4 = 0;
  if (a->top != 0) {
    iVar4 = a->top + -1;
    puVar6 = a->d;
    iVar3 = BN_num_bits_word(puVar6[iVar4]);
    iVar3 = iVar4 * 0x40 + iVar3;
    iVar5 = iVar3 + 7;
    iVar4 = iVar3 + 0xe;
    if (-1 < iVar5) {
      iVar4 = iVar5;
    }
    iVar4 = iVar4 >> 3;
    iVar3 = iVar4 + -1;
    if (iVar4 != 0) {
      while( true ) {
        iVar5 = iVar3 + 7;
        if (-1 < iVar3) {
          iVar5 = iVar3;
        }
        cVar1 = (char)iVar3;
        bVar2 = (byte)(iVar3 >> 0x1f);
        iVar3 = iVar3 + -1;
        *to = (uchar)(puVar6[iVar5 >> 3] >>
                     (((cVar1 + (bVar2 >> 5) & 7) - (bVar2 >> 5)) * '\b' & 0x3f));
        if (iVar3 == -1) break;
        puVar6 = a->d;
        to = to + 1;
      }
    }
  }
  return iVar4;
}



int BN_ucmp(BIGNUM *a,BIGNUM *b)

{
  int iVar1;
  ulong *puVar2;
  ulong *puVar3;
  int iVar4;
  ulong uVar5;
  ulong uVar6;
  
  iVar1 = a->top - b->top;
  if (iVar1 == 0) {
    iVar4 = a->top + -1;
    if (-1 < iVar4) {
      uVar5 = a->d[iVar4];
      uVar6 = b->d[iVar4];
      if (uVar5 == uVar6) {
        puVar3 = a->d + (long)iVar4 + -1;
        puVar2 = b->d + (long)iVar4 + -1;
        do {
          iVar4 = iVar4 + -1;
          if (iVar4 == -1) {
            return 0;
          }
          uVar5 = *puVar3;
          uVar6 = *puVar2;
          puVar3 = puVar3 + -1;
          puVar2 = puVar2 + -1;
        } while (uVar5 == uVar6);
      }
      return (-(uint)(uVar6 < uVar5) & 2) - 1;
    }
  }
  return iVar1;
}



int BN_cmp(BIGNUM *a,BIGNUM *b)

{
  int iVar1;
  ulong uVar2;
  ulong uVar3;
  uint uVar4;
  ulong *puVar5;
  ulong *puVar6;
  int iVar7;
  uint uVar8;
  uint uVar9;
  
  if ((a == (BIGNUM *)0x0) || (b == (BIGNUM *)0x0)) {
    uVar4 = 0xffffffff;
    if (a == (BIGNUM *)0x0) {
      return (int)(b != (BIGNUM *)0x0);
    }
  }
  else {
    iVar1 = a->neg;
    if (iVar1 != b->neg) {
      return (-(uint)(iVar1 == 0) & 2) - 1;
    }
    iVar7 = a->top;
    uVar9 = -(uint)(iVar1 == 0) | 1;
    uVar8 = (-(uint)(iVar1 == 0) & 2) - 1;
    uVar4 = uVar8;
    if ((iVar7 <= b->top) && (uVar4 = uVar9, b->top <= iVar7)) {
      iVar7 = iVar7 + -1;
      if (iVar7 < 0) {
        return 0;
      }
      uVar2 = b->d[iVar7];
      uVar3 = a->d[iVar7];
      if (uVar2 < uVar3) {
        return uVar8;
      }
      if (uVar2 <= uVar3) {
        puVar6 = a->d + (long)iVar7 + -1;
        puVar5 = b->d + (long)iVar7 + -1;
        do {
          iVar7 = iVar7 + -1;
          if (iVar7 == -1) {
            return 0;
          }
          uVar2 = *puVar6;
          uVar3 = *puVar5;
          if (uVar3 < uVar2) {
            return uVar8;
          }
          puVar6 = puVar6 + -1;
          puVar5 = puVar5 + -1;
        } while (uVar3 <= uVar2);
      }
    }
  }
  return uVar4;
}



int BN_set_bit(BIGNUM *a,int n)

{
  int iVar1;
  ulong *puVar2;
  size_t __n;
  int iVar3;
  long lVar4;
  
  if (n < 0) {
    return 0;
  }
  lVar4 = (long)a->top;
  iVar3 = n >> 6;
  if (iVar3 < a->top) {
    puVar2 = a->d;
    goto LAB_00495b44;
  }
  iVar1 = iVar3 + 1;
  if ((iVar3 < a->dmax) || (iVar1 <= a->dmax)) {
LAB_00495b11:
    puVar2 = a->d;
    __n = (ulong)(uint)(iVar1 - (int)lVar4) << 3;
    if (iVar3 < (int)lVar4) {
      __n = 8;
    }
    memset(puVar2 + lVar4,0,__n);
  }
  else {
    puVar2 = (ulong *)bn_expand_internal(a);
    if (puVar2 == (ulong *)0x0) {
      return 0;
    }
    if (a->d != (ulong *)0x0) {
      CRYPTO_free(a->d);
    }
    lVar4 = (long)a->top;
    a->d = puVar2;
    a->dmax = iVar1;
    if (a->top <= iVar3) goto LAB_00495b11;
  }
  a->top = iVar1;
LAB_00495b44:
  puVar2[iVar3] = puVar2[iVar3] | 1L << ((byte)n & 0x3f);
  return 1;
}



int BN_clear_bit(BIGNUM *a,int n)

{
  ulong *puVar1;
  int iVar2;
  ulong *puVar3;
  int iVar4;
  
  if (n < 0) {
    return 0;
  }
  iVar4 = a->top;
  iVar2 = 0;
  if (n >> 6 < iVar4) {
    puVar1 = a->d;
    puVar3 = puVar1 + (n >> 6);
    *puVar3 = *puVar3 & ~(1L << ((byte)n & 0x3f));
    if (0 < iVar4) {
      puVar3 = puVar1 + (long)iVar4 + -1;
      do {
        if (*puVar3 != 0) break;
        iVar4 = iVar4 + -1;
        puVar3 = puVar3 + -1;
      } while (iVar4 != 0);
      a->top = iVar4;
      return 1;
    }
    iVar2 = 1;
  }
  return iVar2;
}



int BN_is_bit_set(BIGNUM *a,int n)

{
  if ((-1 < n) && (n >> 6 < a->top)) {
    return (uint)(a->d[n >> 6] >> ((byte)n & 0x3f)) & 1;
  }
  return 0;
}



int BN_mask_bits(BIGNUM *a,int n)

{
  int iVar1;
  int iVar2;
  ulong *puVar3;
  
  if (n < 0) {
    return 0;
  }
  iVar1 = 0;
  iVar2 = n >> 6;
  if (iVar2 < a->top) {
    if ((n & 0x3fU) == 0) {
      a->top = iVar2;
      iVar1 = iVar2;
    }
    else {
      iVar1 = iVar2 + 1;
      a->top = iVar1;
      a->d[iVar2] = a->d[iVar2] & ~(-1L << (sbyte)(n & 0x3fU));
    }
    if (0 < iVar1) {
      puVar3 = a->d + (long)iVar1 + -1;
      do {
        if (*puVar3 != 0) break;
        iVar1 = iVar1 + -1;
        puVar3 = puVar3 + -1;
      } while (iVar1 != 0);
      a->top = iVar1;
      return 1;
    }
    iVar1 = 1;
  }
  return iVar1;
}



void BN_set_negative(BIGNUM *b,int n)

{
  uint uVar1;
  
  uVar1 = 0;
  if (n != 0) {
    uVar1 = (uint)(b->top != 0);
  }
  b->neg = uVar1;
  return;
}



int bn_cmp_words(long param_1,long param_2,int param_3)

{
  ulong uVar1;
  long lVar2;
  ulong uVar3;
  ulong *puVar4;
  ulong *puVar5;
  
  uVar1 = *(ulong *)(param_1 + -8 + (long)param_3 * 8);
  uVar3 = *(ulong *)(param_2 + -8 + (long)param_3 * 8);
  if (uVar1 != uVar3) {
    return (-(uint)(uVar3 < uVar1) & 2) - 1;
  }
  param_3 = param_3 + -2;
  if (param_3 < 0) {
    return 0;
  }
  lVar2 = (long)param_3;
  uVar1 = *(ulong *)(param_1 + lVar2 * 8);
  uVar3 = *(ulong *)(param_2 + lVar2 * 8);
  if (uVar1 == uVar3) {
    lVar2 = lVar2 * 8 + -8;
    puVar5 = (ulong *)(param_1 + lVar2);
    puVar4 = (ulong *)(param_2 + lVar2);
    do {
      param_3 = param_3 + -1;
      if (param_3 == -1) {
        return 0;
      }
      uVar1 = *puVar5;
      uVar3 = *puVar4;
      puVar5 = puVar5 + -1;
      puVar4 = puVar4 + -1;
    } while (uVar1 == uVar3);
  }
  return (-(uint)(uVar3 < uVar1) & 2) - 1;
}



int bn_cmp_part_words(long param_1,long param_2,int param_3,uint param_4)

{
  long *plVar1;
  ulong uVar2;
  ulong *puVar3;
  ulong *puVar4;
  ulong uVar5;
  int iVar6;
  long lVar7;
  
  iVar6 = param_3 + -1;
  if ((int)param_4 < 0) {
    plVar1 = (long *)(param_2 + ((long)iVar6 - (long)(int)param_4) * 8);
    lVar7 = *plVar1;
    while( true ) {
      if (lVar7 != 0) {
        return -1;
      }
      plVar1 = plVar1 + -1;
      if (plVar1 == (long *)(param_2 + -8 + (long)(int)param_4 * -8 + (long)iVar6 * 8 +
                            (ulong)~param_4 * -8)) break;
      lVar7 = *plVar1;
    }
  }
  else if (param_4 != 0) {
    lVar7 = ((long)iVar6 + (long)(int)param_4) * 8;
    plVar1 = (long *)(param_1 + lVar7);
    do {
      if (*plVar1 != 0) {
        return 1;
      }
      plVar1 = plVar1 + -1;
    } while (plVar1 != (long *)(lVar7 + param_1 + -8 + (ulong)(param_4 - 1) * -8));
  }
  uVar2 = *(ulong *)(param_1 + -8 + (long)param_3 * 8);
  uVar5 = *(ulong *)(param_2 + -8 + (long)param_3 * 8);
  if (uVar2 == uVar5) {
    param_3 = param_3 + -2;
    if (param_3 < 0) {
      return 0;
    }
    lVar7 = (long)param_3;
    uVar2 = *(ulong *)(param_1 + lVar7 * 8);
    uVar5 = *(ulong *)(param_2 + lVar7 * 8);
    if (uVar2 == uVar5) {
      lVar7 = lVar7 * 8 + -8;
      puVar3 = (ulong *)(param_1 + lVar7);
      puVar4 = (ulong *)(param_2 + lVar7);
      do {
        param_3 = param_3 + -1;
        if (param_3 == -1) {
          return 0;
        }
        uVar2 = *puVar3;
        uVar5 = *puVar4;
        puVar3 = puVar3 + -1;
        puVar4 = puVar4 + -1;
      } while (uVar2 == uVar5);
    }
    return (-(uint)(uVar5 < uVar2) & 2) - 1;
  }
  return (-(uint)(uVar5 < uVar2) & 2) - 1;
}



char * BN_bn2hex(BIGNUM *a)

{
  char cVar1;
  bool bVar2;
  ushort uVar3;
  uint uVar4;
  bool bVar5;
  byte bVar6;
  bool bVar7;
  bool bVar8;
  bool bVar9;
  bool bVar10;
  bool bVar11;
  bool bVar12;
  bool bVar13;
  char *pcVar14;
  uint uVar15;
  ulong uVar17;
  char *pcVar18;
  char *pcVar19;
  long lVar20;
  uint uVar21;
  int iVar16;
  
  pcVar14 = (char *)CRYPTO_malloc(a->top * 0x10 + 2,"bn_print.c",0x4a);
  if (pcVar14 == (char *)0x0) {
    ERR_put_error(3,0x69,0x41,"bn_print.c",0x4d);
  }
  else {
    pcVar19 = pcVar14;
    if (a->neg != 0) {
      pcVar19 = pcVar14 + 1;
      *pcVar14 = '-';
    }
    iVar16 = a->top;
    if (iVar16 == 0) {
      *pcVar19 = '0';
      pcVar19 = pcVar19 + 1;
      iVar16 = a->top;
    }
    uVar15 = iVar16 - 1;
    if (-1 < (int)uVar15) {
      lVar20 = (long)(int)uVar15 * 8;
      bVar2 = false;
      do {
        uVar17 = *(ulong *)((long)a->d + lVar20);
        bVar6 = (byte)(uVar17 >> 0x38);
        bVar5 = bVar6 != 0;
        pcVar18 = pcVar19;
        if (bVar2 || bVar5) {
          pcVar18 = pcVar19 + 2;
          *pcVar19 = "0123456789ABCDEF"[(int)(uint)bVar6 >> 4];
          pcVar19[1] = "0123456789ABCDEF"[bVar6 & 0xf];
          uVar17 = *(ulong *)((long)a->d + lVar20);
        }
        uVar3 = (ushort)(uVar17 >> 0x30);
        bVar9 = (uVar17 & 0xff000000000000) != 0;
        pcVar19 = pcVar18;
        if ((bVar2 || bVar5) || bVar9) {
          pcVar19 = pcVar18 + 2;
          *pcVar18 = "0123456789ABCDEF"[(int)(uVar3 & 0xff) >> 4];
          pcVar18[1] = "0123456789ABCDEF"[uVar3 & 0xf];
          uVar17 = *(ulong *)((long)a->d + lVar20);
        }
        uVar4 = (uint)(uVar17 >> 0x20);
        uVar21 = uVar4 >> 8 & 0xff;
        bVar10 = uVar21 != 0;
        pcVar18 = pcVar19;
        if (((bVar2 || bVar5) || bVar9) || bVar10) {
          pcVar18 = pcVar19 + 2;
          *pcVar19 = "0123456789ABCDEF"[(int)uVar21 >> 4];
          pcVar19[1] = "0123456789ABCDEF"[uVar4 >> 8 & 0xf];
          uVar17 = *(ulong *)((long)a->d + lVar20);
        }
        uVar4 = (uint)(uVar17 >> 0x20);
        bVar11 = (uVar17 & 0xff00000000) != 0;
        pcVar19 = pcVar18;
        if ((((bVar2 || bVar5) || bVar9) || bVar10) || bVar11) {
          pcVar19 = pcVar18 + 2;
          *pcVar18 = "0123456789ABCDEF"[(int)(uVar4 & 0xff) >> 4];
          pcVar18[1] = "0123456789ABCDEF"[uVar4 & 0xf];
          uVar17 = *(ulong *)((long)a->d + lVar20);
        }
        uVar4 = (uint)(uVar17 >> 0x18);
        bVar12 = (uVar17 & 0xff000000) != 0;
        pcVar18 = pcVar19;
        if (((((bVar2 || bVar5) || bVar9) || bVar10) || bVar11) || bVar12) {
          pcVar18 = pcVar19 + 2;
          *pcVar19 = "0123456789ABCDEF"[(int)(uVar4 & 0xff) >> 4];
          pcVar19[1] = "0123456789ABCDEF"[uVar4 & 0xf];
          uVar17 = *(ulong *)((long)a->d + lVar20);
        }
        uVar4 = (uint)(uVar17 >> 0x10);
        bVar13 = (uVar17 & 0xff0000) != 0;
        pcVar19 = pcVar18;
        if ((((((bVar2 || bVar5) || bVar9) || bVar10) || bVar11) || bVar12) || bVar13) {
          pcVar19 = pcVar18 + 2;
          *pcVar18 = "0123456789ABCDEF"[(int)(uVar4 & 0xff) >> 4];
          pcVar18[1] = "0123456789ABCDEF"[uVar4 & 0xf];
          uVar17 = *(ulong *)((long)a->d + lVar20);
        }
        uVar4 = (uint)(uVar17 >> 8);
        bVar7 = (uVar17 & 0xff00) != 0;
        pcVar18 = pcVar19;
        if (((((((bVar2 || bVar5) || bVar9) || bVar10) || bVar11) || bVar12) || bVar13) || bVar7) {
          pcVar18 = pcVar19 + 2;
          *pcVar19 = "0123456789ABCDEF"[(int)(uVar4 & 0xff) >> 4];
          pcVar19[1] = "0123456789ABCDEF"[uVar4 & 0xf];
          uVar17 = *(ulong *)((long)a->d + lVar20);
        }
        bVar8 = (uVar17 & 0xff) != 0;
        pcVar19 = pcVar18;
        if ((((((((bVar2 || bVar5) || bVar9) || bVar10) || bVar11) || bVar12) || bVar13) || bVar7)
            || bVar8) {
          pcVar19 = pcVar18 + 2;
          cVar1 = "0123456789ABCDEF"[(int)((uint)uVar17 & 0xff) >> 4];
          pcVar18[1] = "0123456789ABCDEF"[(uint)uVar17 & 0xf];
          *pcVar18 = cVar1;
        }
        bVar2 = (((((((bVar2 || bVar5) || bVar9) || bVar10) || bVar11) || bVar12) || bVar13) ||
                bVar7) || bVar8;
        lVar20 = lVar20 + -8;
      } while (lVar20 != ((long)(int)uVar15 - (ulong)uVar15) * 8 + -8);
    }
    *pcVar19 = '\0';
  }
  return pcVar14;
}



char * BN_bn2dec(BIGNUM *a)

{
  char cVar1;
  int iVar2;
  ulong *ptr;
  char *ptr_00;
  BIGNUM *a_00;
  ulong uVar3;
  int num;
  char *pcVar4;
  ulong *puVar5;
  ulong *puVar6;
  bool bVar7;
  long local_40;
  
  iVar2 = BN_num_bits(a);
  iVar2 = (iVar2 * 3) / 10 + (iVar2 * 3) / 1000;
  num = iVar2 + 5;
  ptr = (ulong *)CRYPTO_malloc(((iVar2 + 2) / 0x13) * 8 + 8,"bn_print.c",0x76);
  ptr_00 = (char *)CRYPTO_malloc(num,"bn_print.c",0x77);
  bVar7 = ptr == (ulong *)0x0 || ptr_00 == (char *)0x0;
  if (ptr == (ulong *)0x0 || ptr_00 == (char *)0x0) {
    ERR_put_error(3,0x68,0x41,"bn_print.c",0x7a);
    bVar7 = ptr_00 != (char *)0x0;
    if (ptr != (ulong *)0x0) {
      CRYPTO_free(ptr);
    }
    goto LAB_0049625a;
  }
  a_00 = BN_dup(a);
  if (a_00 == (BIGNUM *)0x0) {
    bVar7 = true;
  }
  else if (a_00->top == 0) {
    *ptr_00 = '0';
    ptr_00[1] = '\0';
  }
  else {
    puVar5 = ptr;
    if (a_00->neg == 0) {
      local_40 = 0;
      pcVar4 = ptr_00;
LAB_004962e0:
      do {
        uVar3 = BN_div_word(a_00,10000000000000000000);
        iVar2 = a_00->top;
        *puVar5 = uVar3;
        puVar6 = puVar5 + 1;
        puVar5 = puVar5 + 1;
      } while (iVar2 != 0);
    }
    else {
      *ptr_00 = '-';
      pcVar4 = ptr_00 + 1;
      local_40 = (long)ptr_00 - (long)pcVar4;
      if (a_00->top != 0) goto LAB_004962e0;
      uVar3 = ptr[-1];
      puVar6 = ptr;
    }
    puVar6 = puVar6 + -1;
    BIO_snprintf(pcVar4,local_40 + num,"%lu",uVar3);
    cVar1 = *pcVar4;
    while (cVar1 != '\0') {
      pcVar4 = pcVar4 + 1;
      cVar1 = *pcVar4;
    }
    while (ptr != puVar6) {
      puVar6 = puVar6 + -1;
      BIO_snprintf(pcVar4,(size_t)(ptr_00 + ((long)num - (long)pcVar4)),"%019lu",*puVar6);
      cVar1 = *pcVar4;
      while (cVar1 != '\0') {
        pcVar4 = pcVar4 + 1;
        cVar1 = *pcVar4;
      }
    }
  }
  CRYPTO_free(ptr);
  if (a_00 != (BIGNUM *)0x0) {
    BN_free(a_00);
  }
LAB_0049625a:
  pcVar4 = ptr_00;
  if (bVar7) {
    pcVar4 = (char *)0x0;
    CRYPTO_free(ptr_00);
  }
  return pcVar4;
}



int BN_hex2bn(BIGNUM **a,char *str)

{
  char cVar1;
  int iVar2;
  ushort **ppuVar3;
  long lVar4;
  BIGNUM *pBVar5;
  BIGNUM *a_00;
  long lVar6;
  ulong uVar7;
  ulong *puVar8;
  uint uVar9;
  int iVar10;
  ulong uVar11;
  int iVar12;
  ulong *puVar13;
  int iVar14;
  ulong uVar15;
  
  if ((str == (char *)0x0) || (cVar1 = *str, cVar1 == '\0')) {
    return 0;
  }
  if (cVar1 == '-') {
    str = str + 1;
  }
  uVar9 = (uint)(cVar1 == '-');
  ppuVar3 = __ctype_b_loc();
  uVar7 = 0;
  do {
    uVar15 = uVar7;
    uVar11 = uVar15 & 0xffffffff;
    uVar7 = uVar15 + 1;
  } while ((*(byte *)((long)*ppuVar3 + (ulong)(byte)str[uVar15] * 2 + 1) & 0x10) != 0);
  iVar2 = (int)uVar15;
  if (a != (BIGNUM **)0x0) {
    a_00 = *a;
    if (a_00 == (BIGNUM *)0x0) {
      a_00 = BN_new();
      if (a_00 == (BIGNUM *)0x0) {
        return 0;
      }
    }
    else {
      BN_set_word(a_00,0);
    }
    iVar12 = iVar2 * 4 + 0x3f >> 6;
    if ((a_00->dmax < iVar12) && (pBVar5 = bn_expand2(a_00,iVar12), pBVar5 == (BIGNUM *)0x0)) {
      if (*a != (BIGNUM *)0x0) {
        return 0;
      }
      BN_free(a_00);
      return 0;
    }
    if (iVar2 == 0) {
      a_00->top = 0;
    }
    else {
      puVar8 = a_00->d;
      lVar4 = (long)iVar2;
      puVar13 = puVar8;
      do {
        iVar10 = (int)uVar11;
        iVar12 = 0x10;
        if (iVar10 < 0x11) {
          iVar12 = iVar10;
        }
        lVar6 = 0;
        uVar7 = 0;
        do {
          iVar14 = (int)str[lVar6 + (lVar4 - iVar12)];
          if (iVar14 - 0x30U < 10) {
            uVar15 = (ulong)(int)(iVar14 - 0x30U);
          }
          else if (iVar14 - 0x61U < 6) {
            uVar15 = (ulong)(iVar14 + -0x57);
          }
          else {
            uVar15 = 0;
            if (iVar14 - 0x41U < 6) {
              uVar15 = (ulong)(iVar14 + -0x37);
            }
          }
          lVar6 = lVar6 + 1;
          uVar7 = uVar7 << 4 | uVar15;
        } while (0 < iVar12 - (int)lVar6);
        uVar11 = (ulong)(iVar10 - 0x10U);
        *puVar13 = uVar7;
        lVar4 = lVar4 + -0x10;
        puVar13 = puVar13 + 1;
      } while (0 < (int)(iVar10 - 0x10U));
      iVar12 = (iVar2 - 1U >> 4) + 1;
      puVar8 = puVar8 + (long)iVar12 + -1;
      do {
        if (*puVar8 != 0) break;
        iVar12 = iVar12 + -1;
        puVar8 = puVar8 + -1;
      } while (iVar12 != 0);
      a_00->top = iVar12;
    }
    a_00->neg = uVar9;
    *a = a_00;
  }
  return uVar9 + iVar2;
}



int BN_dec2bn(BIGNUM **a,char *str)

{
  ulong w;
  char cVar1;
  long lVar2;
  ushort **ppuVar3;
  BIGNUM *pBVar4;
  BIGNUM *a_00;
  ulong *puVar5;
  int iVar6;
  long lVar7;
  int words;
  uint uVar8;
  ulong uVar9;
  int iVar10;
  
  if ((str != (char *)0x0) && (cVar1 = *str, cVar1 != '\0')) {
    if (cVar1 == '-') {
      str = str + 1;
    }
    uVar8 = (uint)(cVar1 == '-');
    ppuVar3 = __ctype_b_loc();
    lVar2 = 0;
    do {
      lVar7 = lVar2;
      lVar2 = lVar7 + 1;
    } while ((*(byte *)((long)*ppuVar3 + (ulong)(byte)str[lVar7] * 2 + 1) & 8) != 0);
    iVar6 = (int)lVar7;
    iVar10 = uVar8 + iVar6;
    if (a == (BIGNUM **)0x0) {
      return iVar10;
    }
    a_00 = *a;
    if (a_00 == (BIGNUM *)0x0) {
      a_00 = BN_new();
      if (a_00 == (BIGNUM *)0x0) {
        return 0;
      }
    }
    else {
      BN_set_word(a_00,0);
    }
    words = iVar6 * 4 + 0x3f >> 6;
    if ((words <= a_00->dmax) || (pBVar4 = bn_expand2(a_00,words), pBVar4 != (BIGNUM *)0x0)) {
      iVar6 = ((iVar6 / 0x13) * 0x13 - iVar6) + 0x13;
      if (iVar6 == 0x13) {
        iVar6 = 0;
      }
      uVar9 = 0;
      while (cVar1 = *str, cVar1 != '\0') {
        while( true ) {
          iVar6 = iVar6 + 1;
          str = str + 1;
          w = (long)(cVar1 + -0x30) + uVar9 * 10;
          uVar9 = w;
          if (iVar6 != 0x13) break;
          BN_mul_word(a_00,10000000000000000000);
          uVar9 = 0;
          BN_add_word(a_00,w);
          cVar1 = *str;
          iVar6 = 0;
          if (cVar1 == '\0') goto LAB_004966d0;
        }
      }
LAB_004966d0:
      iVar6 = a_00->top;
      a_00->neg = uVar8;
      if (0 < iVar6) {
        puVar5 = a_00->d + (long)iVar6 + -1;
        do {
          if (*puVar5 != 0) break;
          iVar6 = iVar6 + -1;
          puVar5 = puVar5 + -1;
        } while (iVar6 != 0);
        a_00->top = iVar6;
      }
      *a = a_00;
      return iVar10;
    }
    if (*a == (BIGNUM *)0x0) {
      BN_free(a_00);
    }
  }
  return 0;
}



int BN_asc2bn(BIGNUM **a,char *str)

{
  char cVar1;
  int iVar2;
  char *str_00;
  
  cVar1 = *str;
  str_00 = str;
  if (cVar1 == '-') {
    str_00 = str + 1;
    cVar1 = str[1];
  }
  if ((cVar1 == '0') && ((str_00[1] & 0xdfU) == 0x58)) {
    iVar2 = BN_hex2bn(a,str_00 + 2);
  }
  else {
    iVar2 = BN_dec2bn(a,str_00);
  }
  if (iVar2 != 0) {
    if (*str == '-') {
      (*a)->neg = 1;
    }
    return 1;
  }
  return 0;
}



int BN_print_fp(FILE *fp,BIGNUM *a)

{
  bool bVar1;
  bool bVar2;
  uint uVar3;
  int iVar4;
  BIO_METHOD *type;
  BIO *bp;
  ulong uVar5;
  int iVar6;
  long lVar7;
  
  type = BIO_s_file();
  bp = BIO_new(type);
  iVar6 = 0;
  if (bp != (BIO *)0x0) {
    BIO_ctrl(bp,0x6a,0,fp);
    if (a->neg != 0) {
      iVar6 = BIO_write(bp,"-",1);
      if (iVar6 != 1) goto LAB_00496929;
    }
    iVar6 = a->top;
    if (iVar6 == 0) {
      iVar6 = BIO_write(bp,"0",1);
      if (iVar6 != 1) {
LAB_00496929:
        BIO_free(bp);
        return 0;
      }
      iVar6 = a->top;
    }
    uVar3 = iVar6 - 1;
    if (-1 < (int)uVar3) {
      bVar2 = false;
      lVar7 = (long)(int)uVar3 * 8;
      do {
        iVar6 = 0x3c;
        bVar1 = bVar2;
        do {
          while( true ) {
            bVar2 = false;
            uVar5 = *(ulong *)((long)a->d + lVar7) >> ((byte)iVar6 & 0x3f);
            if (!bVar1 && (uVar5 & 0xf) == 0) break;
            iVar4 = BIO_write(bp,"0123456789ABCDEF" + (int)((uint)uVar5 & 0xf),1);
            if (iVar4 != 1) goto LAB_00496929;
            iVar6 = iVar6 + -4;
            bVar2 = true;
            bVar1 = bVar2;
            if (iVar6 == -4) goto LAB_004968ed;
          }
          iVar6 = iVar6 + -4;
          bVar1 = bVar2;
        } while (iVar6 != -4);
LAB_004968ed:
        lVar7 = lVar7 + -8;
      } while (lVar7 != ((long)(int)uVar3 - (ulong)uVar3) * 8 + -8);
    }
    BIO_free(bp);
    iVar6 = 1;
  }
  return iVar6;
}



int BN_print(void *fp,BIGNUM *a)

{
  bool bVar1;
  bool bVar2;
  uint uVar3;
  int iVar4;
  ulong uVar5;
  int iVar6;
  long lVar7;
  
  if ((a->neg != 0) && (iVar6 = BIO_write((BIO *)fp,"-",1), iVar6 != 1)) {
    return 0;
  }
  iVar6 = a->top;
  if (iVar6 == 0) {
    iVar6 = BIO_write((BIO *)fp,"0",1);
    if (iVar6 != 1) {
      return 0;
    }
    iVar6 = a->top;
  }
  uVar3 = iVar6 - 1;
  if (-1 < (int)uVar3) {
    lVar7 = (long)(int)uVar3 * 8;
    bVar2 = false;
    do {
      iVar6 = 0x3c;
      bVar1 = bVar2;
      do {
        while( true ) {
          uVar5 = *(ulong *)((long)a->d + lVar7) >> ((byte)iVar6 & 0x3f);
          bVar2 = false;
          if (!bVar1 && (uVar5 & 0xf) == 0) break;
          iVar4 = BIO_write((BIO *)fp,"0123456789ABCDEF" + (int)((uint)uVar5 & 0xf),1);
          if (iVar4 != 1) {
            return 0;
          }
          iVar6 = iVar6 + -4;
          bVar2 = true;
          bVar1 = bVar2;
          if (iVar6 == -4) goto LAB_004969f6;
        }
        iVar6 = iVar6 + -4;
        bVar1 = bVar2;
      } while (iVar6 != -4);
LAB_004969f6:
      lVar7 = lVar7 + -8;
    } while (lVar7 != ((long)(int)uVar3 - (ulong)uVar3) * 8 + -8);
  }
  return 1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

char * BN_options(void)

{
  if (init_5980 != 0) {
    return data_5981;
  }
  init_5980 = 1;
  BIO_snprintf(data_5981,0x10,"bn(%d,%d)",0x40,0x40);
  return data_5981;
}



int BN_lshift1(BIGNUM *r,BIGNUM *a)

{
  ulong *puVar1;
  ulong *puVar2;
  ulong uVar3;
  long lVar4;
  BIGNUM *pBVar5;
  int iVar6;
  ulong uVar7;
  
  if (r == a) {
    if ((r->dmax <= r->top) && (pBVar5 = bn_expand2(r,r->top + 1), pBVar5 == (BIGNUM *)0x0)) {
      return 0;
    }
  }
  else {
    iVar6 = a->top;
    r->neg = a->neg;
    if (r->dmax <= iVar6) {
      pBVar5 = bn_expand2(r,iVar6 + 1);
      if (pBVar5 == (BIGNUM *)0x0) {
        return 0;
      }
      iVar6 = a->top;
    }
    r->top = iVar6;
  }
  iVar6 = a->top;
  lVar4 = 0;
  uVar7 = 0;
  puVar1 = a->d;
  puVar2 = r->d;
  if (0 < iVar6) {
    do {
      uVar3 = puVar1[lVar4];
      puVar2[lVar4] = uVar3 * 2 | uVar7;
      lVar4 = lVar4 + 1;
      uVar7 = -((long)uVar3 >> 0x3f);
    } while ((int)lVar4 < iVar6);
    if (uVar7 != 0) {
      puVar2[(ulong)(iVar6 - 1) + 1] = 1;
      r->top = r->top + 1;
    }
  }
  return 1;
}



int BN_rshift1(BIGNUM *r,BIGNUM *a)

{
  ulong uVar1;
  BIGNUM *pBVar2;
  ulong *puVar3;
  int iVar4;
  ulong *puVar5;
  ulong uVar6;
  int words;
  
  iVar4 = a->top;
  if (iVar4 == 0) {
    BN_set_word(r,0);
    return 1;
  }
  puVar5 = a->d;
  words = iVar4 - (uint)(puVar5[(long)iVar4 + -1] == 1);
  if (a != r) {
    if (r->dmax < words) {
      pBVar2 = bn_expand2(r,words);
      if (pBVar2 == (BIGNUM *)0x0) {
        return 0;
      }
    }
    r->neg = a->neg;
  }
  iVar4 = iVar4 + -1;
  puVar3 = r->d;
  uVar6 = puVar5[iVar4] << 0x3f;
  uVar1 = puVar5[iVar4] >> 1;
  if (uVar1 != 0) {
    puVar3[iVar4] = uVar1;
  }
  if (0 < iVar4) {
    puVar5 = puVar5 + (long)iVar4 + -1;
    puVar3 = puVar3 + (long)iVar4 + -1;
    do {
      uVar1 = *puVar5 >> 1 | uVar6;
      uVar6 = 0;
      if ((*puVar5 & 1) != 0) {
        uVar6 = 0x8000000000000000;
      }
      *puVar3 = uVar1;
      puVar5 = puVar5 + -1;
      puVar3 = puVar3 + -1;
      iVar4 = iVar4 + -1;
    } while (iVar4 != 0);
  }
  r->top = words;
  return 1;
}



int BN_lshift(BIGNUM *r,BIGNUM *a,int n)

{
  ulong *puVar1;
  ulong uVar2;
  byte bVar3;
  BIGNUM *pBVar4;
  int iVar5;
  uint uVar6;
  long lVar7;
  ulong *puVar8;
  int iVar9;
  int iVar10;
  ulong *puVar11;
  
  iVar9 = n + 0x3f;
  if (-1 < n) {
    iVar9 = n;
  }
  iVar9 = iVar9 >> 6;
  r->neg = a->neg;
  iVar5 = a->top;
  iVar10 = iVar5 + iVar9;
  if (r->dmax <= iVar10) {
    pBVar4 = bn_expand2(r,iVar10 + 1);
    if (pBVar4 == (BIGNUM *)0x0) {
      return 0;
    }
    iVar5 = a->top;
    iVar10 = iVar9 + iVar5;
  }
  puVar8 = r->d;
  puVar1 = a->d;
  puVar8[iVar10] = 0;
  if (n % 0x40 == 0) {
    uVar6 = iVar5 - 1;
    if (-1 < (int)uVar6) {
      lVar7 = 0;
      do {
        *(undefined8 *)((long)puVar8 + lVar7 + ((long)(int)uVar6 + (long)iVar9) * 8) =
             *(undefined8 *)((long)puVar1 + lVar7 + (long)(int)uVar6 * 8);
        lVar7 = lVar7 + -8;
      } while (lVar7 != ~(ulong)uVar6 * 8);
    }
  }
  else {
    uVar6 = iVar5 - 1;
    if (-1 < (int)uVar6) {
      lVar7 = 0;
      bVar3 = (byte)(n % 0x40);
      puVar11 = puVar8 + (long)(int)uVar6 + 1 + (long)iVar9;
      do {
        uVar2 = *(ulong *)((long)puVar1 + lVar7 + (long)(int)uVar6 * 8);
        lVar7 = lVar7 + -8;
        *puVar11 = *puVar11 | uVar2 >> (0x40 - bVar3 & 0x3f);
        puVar11 = puVar11 + -1;
        *puVar11 = uVar2 << (bVar3 & 0x3f);
      } while (lVar7 != ~(ulong)uVar6 * 8);
    }
  }
  memset(puVar8,0,(long)iVar9 * 8);
  iVar9 = iVar9 + a->top + 1;
  r->top = iVar9;
  if (0 < iVar9) {
    puVar8 = r->d + (long)iVar9 + -1;
    do {
      if (*puVar8 != 0) break;
      iVar9 = iVar9 + -1;
      puVar8 = puVar8 + -1;
    } while (iVar9 != 0);
    r->top = iVar9;
  }
  return 1;
}



int BN_rshift(BIGNUM *r,BIGNUM *a,int n)

{
  ulong *puVar1;
  int iVar2;
  int iVar3;
  long lVar4;
  BIGNUM *pBVar5;
  byte bVar6;
  ulong *puVar7;
  int iVar8;
  ulong uVar9;
  ulong uVar10;
  
  iVar8 = n + 0x3f;
  if (-1 < n) {
    iVar8 = n;
  }
  iVar8 = iVar8 >> 6;
  if ((iVar8 < a->top) && (a->top != 0)) {
    iVar2 = BN_num_bits(a);
    iVar3 = (iVar2 - n) + 0x3f;
    iVar2 = (iVar2 - n) + 0x7e;
    if (-1 < iVar3) {
      iVar2 = iVar3;
    }
    iVar2 = iVar2 >> 6;
    if (r == a) {
      if (n == 0) {
        return 1;
      }
    }
    else {
      r->neg = a->neg;
      if ((r->dmax < iVar2) && (pBVar5 = bn_expand2(r,iVar2), pBVar5 == (BIGNUM *)0x0)) {
        return 0;
      }
    }
    iVar3 = a->top;
    puVar1 = a->d;
    r->top = iVar2;
    iVar3 = iVar3 - iVar8;
    puVar1 = puVar1 + iVar8;
    puVar7 = r->d;
    if (n % 0x40 == 0) {
      for (; iVar3 != 0; iVar3 = iVar3 + -1) {
        *puVar7 = *puVar1;
        puVar1 = puVar1 + 1;
        puVar7 = puVar7 + 1;
      }
    }
    else {
      uVar10 = *puVar1;
      bVar6 = (byte)(n % 0x40);
      if (iVar3 != 1) {
        lVar4 = 0;
        do {
          uVar9 = uVar10 >> (bVar6 & 0x3f);
          uVar10 = *(ulong *)((long)puVar1 + lVar4 + 8);
          *(ulong *)((long)puVar7 + lVar4) = uVar10 << (0x40 - bVar6 & 0x3f) | uVar9;
          lVar4 = lVar4 + 8;
        } while (lVar4 != (ulong)(iVar3 - 2) * 8 + 8);
        puVar7 = puVar7 + (ulong)(iVar3 - 2) + 1;
      }
      uVar10 = uVar10 >> (bVar6 & 0x3f);
      if (uVar10 != 0) {
        *puVar7 = uVar10;
      }
    }
    return 1;
  }
  BN_set_word(r,0);
  return 1;
}



ulong BN_mod_word(BIGNUM *a,ulong w)

{
  ulong uVar1;
  uint uVar2;
  long lVar3;
  ulong uVar4;
  
  if (w == 0) {
    return 0xffffffffffffffff;
  }
  uVar2 = a->top - 1;
  if (-1 < (int)uVar2) {
    lVar3 = 0;
    uVar4 = 0;
    do {
      uVar1 = *(ulong *)((long)a->d + lVar3 + (long)(int)uVar2 * 8);
      lVar3 = lVar3 + -8;
      uVar4 = ((uVar1 >> 0x20 | uVar4 << 0x20) % w << 0x20 | uVar1 & 0xffffffff) % w;
    } while (lVar3 != ~(ulong)uVar2 * 8);
    return uVar4;
  }
  return 0;
}



ulong BN_div_word(BIGNUM *a,ulong w)

{
  ulong l;
  int iVar1;
  int iVar2;
  ulong uVar3;
  byte bVar4;
  uint uVar5;
  ulong d;
  long lVar6;
  ulong *puVar7;
  
  if (w != 0) {
    uVar3 = 0;
    if (a->top == 0) {
      return 0;
    }
    iVar1 = BN_num_bits_word(w);
    iVar2 = BN_lshift(a,a,0x40 - iVar1);
    if (iVar2 != 0) {
      iVar2 = a->top;
      uVar5 = iVar2 - 1;
      if (-1 < (int)uVar5) {
        bVar4 = (byte)(0x40 - iVar1);
        d = w << (bVar4 & 0x3f);
        puVar7 = a->d;
        uVar3 = 0;
        lVar6 = (long)(int)uVar5 * 8;
        do {
          l = *(ulong *)((long)puVar7 + lVar6);
          uVar3 = bn_div_words(uVar3,l,d);
          puVar7 = a->d;
          *(ulong *)((long)puVar7 + lVar6) = uVar3;
          lVar6 = lVar6 + -8;
          uVar3 = l - uVar3 * d;
        } while (lVar6 != ((long)(int)uVar5 - (ulong)uVar5) * 8 + -8);
        iVar2 = a->top;
        uVar3 = uVar3 >> (bVar4 & 0x3f);
      }
      if (iVar2 < 1) {
        return uVar3;
      }
      if (a->d[(long)iVar2 + -1] != 0) {
        return uVar3;
      }
      a->top = iVar2 + -1;
      return uVar3;
    }
  }
  return 0xffffffffffffffff;
}



int BN_sub_word(BIGNUM *a,ulong w)

{
  ulong uVar1;
  int iVar2;
  BIGNUM *pBVar3;
  ulong uVar4;
  long lVar5;
  ulong *puVar6;
  ulong *puVar7;
  int iVar8;
  
  if (w != 0) {
    iVar2 = a->top;
    lVar5 = (long)iVar2;
    if (iVar2 == 0) {
      iVar2 = BN_set_word(a,w);
      if (iVar2 == 0) {
        return 0;
      }
      BN_set_negative(a,1);
      return iVar2;
    }
    if (a->neg != 0) {
      a->neg = 0;
      if (0 < iVar2) {
        puVar6 = a->d;
        uVar4 = *puVar6;
        *puVar6 = w + uVar4;
        if (w + uVar4 < w) {
          iVar8 = 1;
          uVar4 = 1;
          puVar7 = puVar6;
          do {
            puVar7 = puVar7 + 1;
            if (iVar8 == iVar2) {
              if (a->dmax <= iVar2) {
                pBVar3 = bn_expand2(a,iVar2 + 1);
                if (pBVar3 == (BIGNUM *)0x0) {
                  iVar2 = 0;
                  goto LAB_0049719e;
                }
                iVar2 = a->top;
                puVar6 = a->d;
              }
              a->top = iVar2 + 1;
              puVar6[lVar5] = uVar4;
              break;
            }
            uVar1 = *puVar7;
            *puVar7 = uVar4 + uVar1;
            iVar8 = iVar8 + 1;
            uVar4 = (ulong)(uVar4 + uVar1 < uVar4);
          } while (uVar4 != 0);
        }
      }
      iVar2 = 1;
LAB_0049719e:
      a->neg = 1;
      return iVar2;
    }
    puVar6 = a->d;
    uVar4 = *puVar6;
    if (iVar2 == 1) {
      iVar8 = 0;
      if (uVar4 < w) {
        *puVar6 = w - uVar4;
        iVar2 = 1;
        goto LAB_0049719e;
      }
    }
    else if (uVar4 < w) {
      iVar8 = 0;
      puVar7 = puVar6;
      do {
        puVar6 = puVar7 + 1;
        uVar4 = uVar4 - w;
        iVar8 = iVar8 + 1;
        w = 1;
        *puVar7 = uVar4;
        uVar4 = *puVar6;
        puVar7 = puVar6;
      } while (uVar4 == 0);
    }
    else {
      iVar8 = 0;
    }
    *puVar6 = uVar4 - w;
    if ((uVar4 - w == 0) && (iVar2 + -1 == iVar8)) {
      a->top = iVar8;
    }
  }
  return 1;
}



int BN_add_word(BIGNUM *a,ulong w)

{
  ulong uVar1;
  int iVar2;
  ulong *puVar3;
  BIGNUM *pBVar4;
  ulong *puVar5;
  ulong uVar6;
  int iVar7;
  int iVar8;
  
  if (w == 0) {
    return 1;
  }
  iVar2 = a->top;
  if (iVar2 == 0) {
    iVar2 = BN_set_word(a,w);
    return iVar2;
  }
  if (a->neg == 0) {
    if (iVar2 < 1) {
      return 1;
    }
    puVar3 = a->d;
    uVar6 = *puVar3;
    *puVar3 = w + uVar6;
    if (w <= w + uVar6) {
      return 1;
    }
    iVar7 = 1;
    uVar6 = 1;
    puVar5 = puVar3;
    do {
      puVar5 = puVar5 + 1;
      if (iVar7 == iVar2) {
        if (a->dmax <= iVar7) {
          pBVar4 = bn_expand2(a,iVar7 + 1);
          if (pBVar4 == (BIGNUM *)0x0) {
            return 0;
          }
          iVar2 = a->top;
          puVar3 = a->d;
        }
        a->top = iVar2 + 1;
        puVar3[iVar7] = uVar6;
        return 1;
      }
      uVar1 = *puVar5;
      *puVar5 = uVar6 + uVar1;
      iVar7 = iVar7 + 1;
      uVar6 = (ulong)(uVar6 + uVar1 < uVar6);
    } while (uVar6 != 0);
    return 1;
  }
  puVar3 = a->d;
  a->neg = 0;
  uVar6 = *puVar3;
  if (iVar2 == 1) {
    if (uVar6 < w) {
      iVar7 = 0;
      *puVar3 = w - uVar6;
      goto LAB_0049737c;
    }
LAB_004973b5:
    iVar8 = 0;
  }
  else {
    if (w <= uVar6) goto LAB_004973b5;
    iVar8 = 0;
    puVar5 = puVar3;
    do {
      puVar3 = puVar5 + 1;
      uVar6 = uVar6 - w;
      iVar8 = iVar8 + 1;
      w = 1;
      *puVar5 = uVar6;
      uVar6 = *puVar3;
      puVar5 = puVar3;
    } while (uVar6 == 0);
  }
  iVar7 = 1;
  *puVar3 = uVar6 - w;
  if (((uVar6 - w == 0) && (iVar7 = 1, iVar8 == iVar2 + -1)) && (a->top = iVar8, iVar8 == 0)) {
    return 1;
  }
LAB_0049737c:
  a->neg = iVar7;
  return 1;
}



int BN_mul_word(BIGNUM *a,ulong w)

{
  int iVar1;
  ulong uVar2;
  BIGNUM *pBVar3;
  
  if (a->top != 0) {
    if (w == 0) {
      BN_set_word(a,0);
    }
    else {
      uVar2 = bn_mul_words(a->d,a->d,a->top,w);
      if (uVar2 != 0) {
        iVar1 = a->top;
        if (a->dmax <= iVar1) {
          pBVar3 = bn_expand2(a,iVar1 + 1);
          if (pBVar3 == (BIGNUM *)0x0) {
            return 0;
          }
          iVar1 = a->top;
        }
        a->top = iVar1 + 1;
        a->d[iVar1] = uVar2;
        return 1;
      }
    }
  }
  return 1;
}



ulong bn_mul_add_words(ulong *rp,ulong *ap,int num,ulong w)

{
  ulong *puVar1;
  undefined1 auVar2 [16];
  undefined1 auVar3 [16];
  undefined1 auVar4 [16];
  undefined1 auVar5 [16];
  undefined1 auVar6 [16];
  undefined1 auVar7 [16];
  undefined1 auVar8 [16];
  undefined1 auVar9 [16];
  undefined1 auVar10 [16];
  undefined1 auVar11 [16];
  undefined1 auVar12 [16];
  undefined1 auVar13 [16];
  undefined1 auVar14 [16];
  undefined1 auVar15 [16];
  undefined1 auVar16 [16];
  undefined1 auVar17 [16];
  undefined1 auVar18 [16];
  undefined1 auVar19 [16];
  undefined1 auVar20 [16];
  undefined1 auVar21 [16];
  undefined1 auVar22 [16];
  ulong uVar23;
  ulong *puVar24;
  ulong uVar25;
  
  if (num < 1) {
    return 0;
  }
  uVar23 = 0;
  puVar24 = ap;
  if ((num & 0xfffffffcU) != 0) {
    do {
      auVar16._8_8_ = 0;
      auVar16._0_8_ = uVar23;
      num = num - 4;
      puVar24 = ap + 4;
      auVar2._8_8_ = 0;
      auVar2._0_8_ = w;
      auVar9._8_8_ = 0;
      auVar9._0_8_ = *ap;
      auVar16 = auVar2 * auVar9 + auVar16;
      uVar25 = auVar16._0_8_;
      uVar23 = *rp;
      *rp = *rp + uVar25;
      auVar17._8_8_ = 0;
      auVar17._0_8_ = auVar16._8_8_ + (ulong)CARRY8(uVar23,uVar25);
      auVar3._8_8_ = 0;
      auVar3._0_8_ = w;
      auVar10._8_8_ = 0;
      auVar10._0_8_ = ap[1];
      auVar17 = auVar3 * auVar10 + auVar17;
      uVar25 = auVar17._0_8_;
      puVar1 = rp + 1;
      uVar23 = *puVar1;
      *puVar1 = *puVar1 + uVar25;
      auVar18._8_8_ = 0;
      auVar18._0_8_ = auVar17._8_8_ + (ulong)CARRY8(uVar23,uVar25);
      auVar4._8_8_ = 0;
      auVar4._0_8_ = w;
      auVar11._8_8_ = 0;
      auVar11._0_8_ = ap[2];
      auVar18 = auVar4 * auVar11 + auVar18;
      uVar25 = auVar18._0_8_;
      puVar1 = rp + 2;
      uVar23 = *puVar1;
      *puVar1 = *puVar1 + uVar25;
      auVar19._8_8_ = 0;
      auVar19._0_8_ = auVar18._8_8_ + (ulong)CARRY8(uVar23,uVar25);
      auVar5._8_8_ = 0;
      auVar5._0_8_ = w;
      auVar12._8_8_ = 0;
      auVar12._0_8_ = ap[3];
      auVar19 = auVar5 * auVar12 + auVar19;
      uVar25 = auVar19._0_8_;
      puVar1 = rp + 3;
      uVar23 = *puVar1;
      *puVar1 = *puVar1 + uVar25;
      uVar23 = auVar19._8_8_ + (ulong)CARRY8(uVar23,uVar25);
      rp = rp + 4;
      ap = puVar24;
    } while ((num & 0xfffffffcU) != 0);
    if (num == 0) {
      return uVar23;
    }
  }
  auVar20._8_8_ = 0;
  auVar20._0_8_ = uVar23;
  auVar6._8_8_ = 0;
  auVar6._0_8_ = w;
  auVar13._8_8_ = 0;
  auVar13._0_8_ = *puVar24;
  auVar20 = auVar6 * auVar13 + auVar20;
  uVar25 = auVar20._0_8_;
  uVar23 = *rp;
  *rp = *rp + uVar25;
  uVar23 = auVar20._8_8_ + (ulong)CARRY8(uVar23,uVar25);
  auVar21._8_8_ = 0;
  auVar21._0_8_ = uVar23;
  if (num != 1) {
    auVar7._8_8_ = 0;
    auVar7._0_8_ = w;
    auVar14._8_8_ = 0;
    auVar14._0_8_ = puVar24[1];
    auVar21 = auVar7 * auVar14 + auVar21;
    uVar25 = auVar21._0_8_;
    puVar1 = rp + 1;
    uVar23 = *puVar1;
    *puVar1 = *puVar1 + uVar25;
    uVar23 = auVar21._8_8_ + (ulong)CARRY8(uVar23,uVar25);
    auVar22._8_8_ = 0;
    auVar22._0_8_ = uVar23;
    if (num != 2) {
      auVar8._8_8_ = 0;
      auVar8._0_8_ = w;
      auVar15._8_8_ = 0;
      auVar15._0_8_ = puVar24[2];
      auVar22 = auVar8 * auVar15 + auVar22;
      uVar25 = auVar22._0_8_;
      puVar24 = rp + 2;
      uVar23 = *puVar24;
      *puVar24 = *puVar24 + uVar25;
      uVar23 = auVar22._8_8_ + (ulong)CARRY8(uVar23,uVar25);
    }
  }
  return uVar23;
}



ulong bn_mul_words(ulong *rp,ulong *ap,int num,ulong w)

{
  undefined1 auVar1 [16];
  undefined1 auVar2 [16];
  undefined1 auVar3 [16];
  undefined1 auVar4 [16];
  undefined1 auVar5 [16];
  undefined1 auVar6 [16];
  undefined1 auVar7 [16];
  undefined1 auVar8 [16];
  undefined1 auVar9 [16];
  undefined1 auVar10 [16];
  undefined1 auVar11 [16];
  undefined1 auVar12 [16];
  undefined1 auVar13 [16];
  undefined1 auVar14 [16];
  undefined1 auVar15 [16];
  undefined1 auVar16 [16];
  undefined1 auVar17 [16];
  undefined1 auVar18 [16];
  undefined1 auVar19 [16];
  undefined1 auVar20 [16];
  undefined1 auVar21 [16];
  ulong uVar22;
  ulong *puVar23;
  ulong *puVar24;
  
  if (num < 1) {
    return 0;
  }
  uVar22 = 0;
  puVar23 = ap;
  puVar24 = rp;
  if ((num & 0xfffffffcU) != 0) {
    do {
      auVar15._8_8_ = 0;
      auVar15._0_8_ = uVar22;
      num = num - 4;
      puVar23 = ap + 4;
      auVar1._8_8_ = 0;
      auVar1._0_8_ = w;
      auVar8._8_8_ = 0;
      auVar8._0_8_ = *ap;
      puVar24 = rp + 4;
      auVar15 = auVar1 * auVar8 + auVar15;
      auVar16._8_8_ = 0;
      auVar16._0_8_ = auVar15._8_8_;
      *rp = auVar15._0_8_;
      auVar2._8_8_ = 0;
      auVar2._0_8_ = w;
      auVar9._8_8_ = 0;
      auVar9._0_8_ = ap[1];
      auVar16 = auVar2 * auVar9 + auVar16;
      auVar17._8_8_ = 0;
      auVar17._0_8_ = auVar16._8_8_;
      rp[1] = auVar16._0_8_;
      auVar3._8_8_ = 0;
      auVar3._0_8_ = w;
      auVar10._8_8_ = 0;
      auVar10._0_8_ = ap[2];
      auVar17 = auVar3 * auVar10 + auVar17;
      auVar18._8_8_ = 0;
      auVar18._0_8_ = auVar17._8_8_;
      rp[2] = auVar17._0_8_;
      auVar4._8_8_ = 0;
      auVar4._0_8_ = w;
      auVar11._8_8_ = 0;
      auVar11._0_8_ = ap[3];
      auVar18 = auVar4 * auVar11 + auVar18;
      uVar22 = auVar18._8_8_;
      rp[3] = auVar18._0_8_;
      ap = puVar23;
      rp = puVar24;
    } while ((num & 0xfffffffcU) != 0);
    if (num == 0) {
      return uVar22;
    }
  }
  auVar19._8_8_ = 0;
  auVar19._0_8_ = uVar22;
  auVar5._8_8_ = 0;
  auVar5._0_8_ = w;
  auVar12._8_8_ = 0;
  auVar12._0_8_ = *puVar23;
  auVar19 = auVar5 * auVar12 + auVar19;
  uVar22 = auVar19._8_8_;
  auVar20._8_8_ = 0;
  auVar20._0_8_ = uVar22;
  *puVar24 = auVar19._0_8_;
  if (num != 1) {
    auVar6._8_8_ = 0;
    auVar6._0_8_ = w;
    auVar13._8_8_ = 0;
    auVar13._0_8_ = puVar23[1];
    auVar20 = auVar6 * auVar13 + auVar20;
    uVar22 = auVar20._8_8_;
    auVar21._8_8_ = 0;
    auVar21._0_8_ = uVar22;
    puVar24[1] = auVar20._0_8_;
    if (num != 2) {
      auVar7._8_8_ = 0;
      auVar7._0_8_ = w;
      auVar14._8_8_ = 0;
      auVar14._0_8_ = puVar23[2];
      auVar21 = auVar7 * auVar14 + auVar21;
      puVar24[2] = auVar21._0_8_;
      return auVar21._8_8_;
    }
  }
  return uVar22;
}



void bn_sqr_words(ulong *rp,ulong *ap,int num)

{
  undefined1 auVar1 [16];
  undefined1 auVar2 [16];
  undefined1 auVar3 [16];
  undefined1 auVar4 [16];
  undefined1 auVar5 [16];
  undefined1 auVar6 [16];
  undefined1 auVar7 [16];
  undefined1 auVar8 [16];
  undefined1 auVar9 [16];
  undefined1 auVar10 [16];
  undefined1 auVar11 [16];
  undefined1 auVar12 [16];
  undefined1 auVar13 [16];
  undefined1 auVar14 [16];
  ulong *puVar15;
  undefined1 (*pauVar16) [16];
  
  if (0 < num) {
    puVar15 = ap;
    pauVar16 = (undefined1 (*) [16])rp;
    if ((num & 0xfffffffcU) != 0) {
      do {
        num = num - 4;
        pauVar16 = (undefined1 (*) [16])((long)rp + 0x40);
        auVar1._8_8_ = 0;
        auVar1._0_8_ = *ap;
        auVar8._8_8_ = 0;
        auVar8._0_8_ = *ap;
        puVar15 = ap + 4;
        *(undefined1 (*) [16])rp = auVar1 * auVar8;
        auVar2._8_8_ = 0;
        auVar2._0_8_ = ap[1];
        auVar9._8_8_ = 0;
        auVar9._0_8_ = ap[1];
        *(undefined1 (*) [16])((long)rp + 0x10) = auVar2 * auVar9;
        auVar3._8_8_ = 0;
        auVar3._0_8_ = ap[2];
        auVar10._8_8_ = 0;
        auVar10._0_8_ = ap[2];
        *(undefined1 (*) [16])((long)rp + 0x20) = auVar3 * auVar10;
        auVar4._8_8_ = 0;
        auVar4._0_8_ = ap[3];
        auVar11._8_8_ = 0;
        auVar11._0_8_ = ap[3];
        *(undefined1 (*) [16])((long)rp + 0x30) = auVar4 * auVar11;
        ap = puVar15;
        rp = (ulong *)pauVar16;
      } while ((num & 0xfffffffcU) != 0);
      if (num == 0) {
        return;
      }
    }
    auVar5._8_8_ = 0;
    auVar5._0_8_ = *puVar15;
    auVar12._8_8_ = 0;
    auVar12._0_8_ = *puVar15;
    *pauVar16 = auVar5 * auVar12;
    if ((num != 1) &&
       (auVar6._8_8_ = 0, auVar6._0_8_ = puVar15[1], auVar13._8_8_ = 0, auVar13._0_8_ = puVar15[1],
       pauVar16[1] = auVar6 * auVar13, num != 2)) {
      auVar7._8_8_ = 0;
      auVar7._0_8_ = puVar15[2];
      auVar14._8_8_ = 0;
      auVar14._0_8_ = puVar15[2];
      pauVar16[2] = auVar7 * auVar14;
    }
  }
  return;
}



ulong bn_div_words(ulong h,ulong l,ulong d)

{
  undefined1 auVar1 [16];
  undefined1 auVar2 [16];
  
  auVar1._8_8_ = 0;
  auVar1._0_8_ = d;
  auVar2._8_8_ = h;
  auVar2._0_8_ = l;
  return SUB168(auVar2 / auVar1,0);
}



ulong bn_add_words(ulong *rp,ulong *ap,ulong *bp,int num)

{
  ulong uVar1;
  ulong uVar2;
  undefined4 in_register_0000000c;
  long lVar3;
  long lVar4;
  bool bVar5;
  
  lVar3 = CONCAT44(in_register_0000000c,num);
  if (0 < num) {
    bVar5 = false;
    lVar4 = 0;
    do {
      uVar1 = (ulong)bVar5;
      uVar2 = ap[lVar4] + bp[lVar4];
      bVar5 = CARRY8(ap[lVar4],bp[lVar4]) || CARRY8(uVar2,uVar1);
      rp[lVar4] = uVar2 + uVar1;
      lVar4 = lVar4 + 1;
      lVar3 = lVar3 + -1;
    } while (lVar3 != 0);
    return (ulong)(-(uint)bVar5 & 1);
  }
  return 0;
}



ulong bn_sub_words(ulong *rp,ulong *ap,ulong *bp,int num)

{
  ulong uVar1;
  ulong uVar2;
  undefined4 in_register_0000000c;
  long lVar3;
  long lVar4;
  bool bVar5;
  
  lVar3 = CONCAT44(in_register_0000000c,num);
  if (0 < num) {
    bVar5 = false;
    lVar4 = 0;
    do {
      uVar1 = (ulong)bVar5;
      uVar2 = ap[lVar4] - bp[lVar4];
      bVar5 = ap[lVar4] < bp[lVar4] || uVar2 < uVar1;
      rp[lVar4] = uVar2 - uVar1;
      lVar4 = lVar4 + 1;
      lVar3 = lVar3 + -1;
    } while (lVar3 != 0);
    return (ulong)(-(uint)bVar5 & 1);
  }
  return 0;
}



void bn_mul_comba8(undefined8 *param_1,ulong *param_2,ulong *param_3)

{
  undefined1 auVar1 [16];
  undefined1 auVar2 [16];
  undefined1 auVar3 [16];
  undefined1 auVar4 [16];
  undefined1 auVar5 [16];
  undefined1 auVar6 [16];
  undefined1 auVar7 [16];
  undefined1 auVar8 [16];
  undefined1 auVar9 [16];
  undefined1 auVar10 [16];
  undefined1 auVar11 [16];
  undefined1 auVar12 [16];
  undefined1 auVar13 [16];
  undefined1 auVar14 [16];
  undefined1 auVar15 [16];
  undefined1 auVar16 [16];
  undefined1 auVar17 [16];
  undefined1 auVar18 [16];
  undefined1 auVar19 [16];
  undefined1 auVar20 [16];
  undefined1 auVar21 [16];
  undefined1 auVar22 [16];
  undefined1 auVar23 [16];
  undefined1 auVar24 [16];
  undefined1 auVar25 [16];
  undefined1 auVar26 [16];
  undefined1 auVar27 [16];
  undefined1 auVar28 [16];
  undefined1 auVar29 [16];
  undefined1 auVar30 [16];
  undefined1 auVar31 [16];
  undefined1 auVar32 [16];
  undefined1 auVar33 [16];
  undefined1 auVar34 [16];
  undefined1 auVar35 [16];
  undefined1 auVar36 [16];
  undefined1 auVar37 [16];
  undefined1 auVar38 [16];
  undefined1 auVar39 [16];
  undefined1 auVar40 [16];
  undefined1 auVar41 [16];
  undefined1 auVar42 [16];
  undefined1 auVar43 [16];
  undefined1 auVar44 [16];
  undefined1 auVar45 [16];
  undefined1 auVar46 [16];
  undefined1 auVar47 [16];
  undefined1 auVar48 [16];
  undefined1 auVar49 [16];
  undefined1 auVar50 [16];
  undefined1 auVar51 [16];
  undefined1 auVar52 [16];
  undefined1 auVar53 [16];
  undefined1 auVar54 [16];
  undefined1 auVar55 [16];
  undefined1 auVar56 [16];
  undefined1 auVar57 [16];
  undefined1 auVar58 [16];
  undefined1 auVar59 [16];
  undefined1 auVar60 [16];
  undefined1 auVar61 [16];
  undefined1 auVar62 [16];
  undefined1 auVar63 [16];
  undefined1 auVar64 [16];
  undefined1 auVar65 [16];
  undefined1 auVar66 [16];
  undefined1 auVar67 [16];
  undefined1 auVar68 [16];
  undefined1 auVar69 [16];
  undefined1 auVar70 [16];
  undefined1 auVar71 [16];
  undefined1 auVar72 [16];
  undefined1 auVar73 [16];
  undefined1 auVar74 [16];
  undefined1 auVar75 [16];
  undefined1 auVar76 [16];
  undefined1 auVar77 [16];
  undefined1 auVar78 [16];
  undefined1 auVar79 [16];
  undefined1 auVar80 [16];
  undefined1 auVar81 [16];
  undefined1 auVar82 [16];
  undefined1 auVar83 [16];
  undefined1 auVar84 [16];
  undefined1 auVar85 [16];
  undefined1 auVar86 [16];
  undefined1 auVar87 [16];
  undefined1 auVar88 [16];
  undefined1 auVar89 [16];
  undefined1 auVar90 [16];
  undefined1 auVar91 [16];
  undefined1 auVar92 [16];
  undefined1 auVar93 [16];
  undefined1 auVar94 [16];
  undefined1 auVar95 [16];
  undefined1 auVar96 [16];
  undefined1 auVar97 [16];
  undefined1 auVar98 [16];
  undefined1 auVar99 [16];
  undefined1 auVar100 [16];
  undefined1 auVar101 [16];
  undefined1 auVar102 [16];
  undefined1 auVar103 [16];
  undefined1 auVar104 [16];
  undefined1 auVar105 [16];
  undefined1 auVar106 [16];
  undefined1 auVar107 [16];
  undefined1 auVar108 [16];
  undefined1 auVar109 [16];
  undefined1 auVar110 [16];
  undefined1 auVar111 [16];
  undefined1 auVar112 [16];
  undefined1 auVar113 [16];
  undefined1 auVar114 [16];
  undefined1 auVar115 [16];
  undefined1 auVar116 [16];
  undefined1 auVar117 [16];
  undefined1 auVar118 [16];
  undefined1 auVar119 [16];
  undefined1 auVar120 [16];
  undefined1 auVar121 [16];
  undefined1 auVar122 [16];
  undefined1 auVar123 [16];
  undefined1 auVar124 [16];
  undefined1 auVar125 [16];
  undefined1 auVar126 [16];
  undefined1 auVar127 [16];
  undefined1 auVar128 [16];
  undefined1 auVar129 [16];
  undefined1 auVar130 [16];
  undefined1 auVar131 [16];
  undefined1 auVar132 [16];
  undefined1 auVar133 [16];
  undefined1 auVar134 [16];
  undefined1 auVar135 [16];
  undefined1 auVar136 [16];
  undefined1 auVar137 [16];
  undefined1 auVar138 [16];
  undefined1 auVar139 [16];
  undefined1 auVar140 [16];
  undefined1 auVar141 [16];
  undefined1 auVar142 [16];
  undefined1 auVar143 [16];
  undefined1 auVar144 [16];
  undefined1 auVar145 [16];
  undefined1 auVar146 [16];
  undefined1 auVar147 [16];
  undefined1 auVar148 [16];
  undefined1 auVar149 [16];
  undefined1 auVar150 [16];
  undefined1 auVar151 [16];
  undefined1 auVar152 [16];
  undefined1 auVar153 [16];
  undefined1 auVar154 [16];
  undefined1 auVar155 [16];
  undefined1 auVar156 [16];
  undefined1 auVar157 [16];
  undefined1 auVar158 [16];
  undefined1 auVar159 [16];
  undefined1 auVar160 [16];
  undefined1 auVar161 [16];
  undefined1 auVar162 [16];
  undefined1 auVar163 [16];
  undefined1 auVar164 [16];
  undefined1 auVar165 [16];
  undefined1 auVar166 [16];
  undefined1 auVar167 [16];
  undefined1 auVar168 [16];
  undefined1 auVar169 [16];
  undefined1 auVar170 [16];
  undefined1 auVar171 [16];
  undefined1 auVar172 [16];
  undefined1 auVar173 [16];
  undefined1 auVar174 [16];
  undefined1 auVar175 [16];
  undefined1 auVar176 [16];
  undefined1 auVar177 [16];
  undefined1 auVar178 [16];
  undefined1 auVar179 [16];
  undefined1 auVar180 [16];
  undefined1 auVar181 [16];
  undefined1 auVar182 [16];
  undefined1 auVar183 [16];
  undefined1 auVar184 [16];
  undefined1 auVar185 [16];
  undefined1 auVar186 [16];
  undefined1 auVar187 [16];
  undefined1 auVar188 [16];
  undefined1 auVar189 [16];
  undefined1 auVar190 [16];
  undefined1 auVar191 [16];
  undefined1 auVar192 [16];
  ulong uVar193;
  ulong uVar194;
  ulong uVar195;
  ulong uVar196;
  ulong uVar197;
  ulong uVar198;
  ulong uVar199;
  ulong uVar200;
  ulong uVar201;
  ulong uVar202;
  ulong uVar203;
  ulong uVar204;
  ulong uVar205;
  ulong uVar206;
  ulong uVar207;
  ulong uVar208;
  
  auVar1._8_8_ = 0;
  auVar1._0_8_ = *param_2;
  auVar65._8_8_ = 0;
  auVar65._0_8_ = *param_3;
  auVar1 = auVar1 * auVar65 + ZEXT816(0);
  *param_1 = auVar1._0_8_;
  auVar129._8_8_ = 0;
  auVar129._0_8_ = auVar1._8_8_;
  auVar2._8_8_ = 0;
  auVar2._0_8_ = *param_2;
  auVar66._8_8_ = 0;
  auVar66._0_8_ = param_3[1];
  auVar129 = auVar2 * auVar66 + auVar129;
  auVar130._8_8_ = 0;
  auVar130._0_8_ = auVar129._0_8_;
  uVar193 = auVar129._8_8_;
  auVar3._8_8_ = 0;
  auVar3._0_8_ = param_2[1];
  auVar67._8_8_ = 0;
  auVar67._0_8_ = *param_3;
  auVar130 = auVar3 * auVar67 + auVar130;
  uVar194 = auVar130._8_8_;
  param_1[1] = auVar130._0_8_;
  auVar131._8_8_ = 0;
  auVar131._0_8_ = uVar193 + uVar194;
  uVar193 = (ulong)CARRY8(uVar193,uVar194);
  auVar4._8_8_ = 0;
  auVar4._0_8_ = param_2[2];
  auVar68._8_8_ = 0;
  auVar68._0_8_ = *param_3;
  auVar131 = auVar4 * auVar68 + auVar131;
  auVar132._8_8_ = 0;
  auVar132._0_8_ = auVar131._0_8_;
  uVar194 = auVar131._8_8_;
  uVar197 = uVar193 + uVar194;
  auVar5._8_8_ = 0;
  auVar5._0_8_ = param_2[1];
  auVar69._8_8_ = 0;
  auVar69._0_8_ = param_3[1];
  auVar132 = auVar5 * auVar69 + auVar132;
  auVar133._8_8_ = 0;
  auVar133._0_8_ = auVar132._0_8_;
  uVar195 = auVar132._8_8_;
  uVar198 = uVar197 + uVar195;
  auVar6._8_8_ = 0;
  auVar6._0_8_ = *param_2;
  auVar70._8_8_ = 0;
  auVar70._0_8_ = param_3[2];
  auVar133 = auVar6 * auVar70 + auVar133;
  uVar196 = auVar133._8_8_;
  param_1[2] = auVar133._0_8_;
  auVar134._8_8_ = 0;
  auVar134._0_8_ = uVar198 + uVar196;
  uVar197 = (ulong)CARRY8(uVar193,uVar194) + (ulong)CARRY8(uVar197,uVar195) +
            (ulong)CARRY8(uVar198,uVar196);
  auVar7._8_8_ = 0;
  auVar7._0_8_ = *param_2;
  auVar71._8_8_ = 0;
  auVar71._0_8_ = param_3[3];
  auVar134 = auVar7 * auVar71 + auVar134;
  auVar135._8_8_ = 0;
  auVar135._0_8_ = auVar134._0_8_;
  uVar193 = auVar134._8_8_;
  uVar198 = uVar197 + uVar193;
  auVar8._8_8_ = 0;
  auVar8._0_8_ = param_2[1];
  auVar72._8_8_ = 0;
  auVar72._0_8_ = param_3[2];
  auVar135 = auVar8 * auVar72 + auVar135;
  auVar136._8_8_ = 0;
  auVar136._0_8_ = auVar135._0_8_;
  uVar194 = auVar135._8_8_;
  uVar205 = uVar198 + uVar194;
  auVar9._8_8_ = 0;
  auVar9._0_8_ = param_2[2];
  auVar73._8_8_ = 0;
  auVar73._0_8_ = param_3[1];
  auVar136 = auVar9 * auVar73 + auVar136;
  auVar138._8_8_ = 0;
  auVar138._0_8_ = auVar136._0_8_;
  uVar195 = auVar136._8_8_;
  uVar206 = uVar205 + uVar195;
  auVar10._8_8_ = 0;
  auVar10._0_8_ = param_2[3];
  auVar74._8_8_ = 0;
  auVar74._0_8_ = *param_3;
  auVar137 = auVar10 * auVar74 + auVar138;
  uVar196 = auVar137._8_8_;
  param_1[3] = auVar137._0_8_;
  auVar139._8_8_ = 0;
  auVar139._0_8_ = uVar206 + uVar196;
  uVar198 = (ulong)CARRY8(uVar197,uVar193) + (ulong)CARRY8(uVar198,uVar194) +
            (ulong)CARRY8(uVar205,uVar195) + (ulong)CARRY8(uVar206,uVar196);
  auVar11._8_8_ = 0;
  auVar11._0_8_ = param_2[4];
  auVar75._8_8_ = 0;
  auVar75._0_8_ = *param_3;
  auVar139 = auVar11 * auVar75 + auVar139;
  auVar140._8_8_ = 0;
  auVar140._0_8_ = auVar139._0_8_;
  uVar193 = auVar139._8_8_;
  uVar205 = uVar198 + uVar193;
  auVar12._8_8_ = 0;
  auVar12._0_8_ = param_2[3];
  auVar76._8_8_ = 0;
  auVar76._0_8_ = param_3[1];
  auVar140 = auVar12 * auVar76 + auVar140;
  auVar141._8_8_ = 0;
  auVar141._0_8_ = auVar140._0_8_;
  uVar194 = auVar140._8_8_;
  uVar206 = uVar205 + uVar194;
  auVar13._8_8_ = 0;
  auVar13._0_8_ = param_2[2];
  auVar77._8_8_ = 0;
  auVar77._0_8_ = param_3[2];
  auVar141 = auVar13 * auVar77 + auVar141;
  auVar142._8_8_ = 0;
  auVar142._0_8_ = auVar141._0_8_;
  uVar195 = auVar141._8_8_;
  uVar201 = uVar206 + uVar195;
  auVar14._8_8_ = 0;
  auVar14._0_8_ = param_2[1];
  auVar78._8_8_ = 0;
  auVar78._0_8_ = param_3[3];
  auVar142 = auVar14 * auVar78 + auVar142;
  auVar143._8_8_ = 0;
  auVar143._0_8_ = auVar142._0_8_;
  uVar196 = auVar142._8_8_;
  uVar202 = uVar201 + uVar196;
  auVar15._8_8_ = 0;
  auVar15._0_8_ = *param_2;
  auVar79._8_8_ = 0;
  auVar79._0_8_ = param_3[4];
  auVar143 = auVar15 * auVar79 + auVar143;
  uVar197 = auVar143._8_8_;
  param_1[4] = auVar143._0_8_;
  auVar144._8_8_ = 0;
  auVar144._0_8_ = uVar202 + uVar197;
  uVar205 = (ulong)CARRY8(uVar198,uVar193) + (ulong)CARRY8(uVar205,uVar194) +
            (ulong)CARRY8(uVar206,uVar195) + (ulong)CARRY8(uVar201,uVar196) +
            (ulong)CARRY8(uVar202,uVar197);
  auVar16._8_8_ = 0;
  auVar16._0_8_ = *param_2;
  auVar80._8_8_ = 0;
  auVar80._0_8_ = param_3[5];
  auVar144 = auVar16 * auVar80 + auVar144;
  auVar145._8_8_ = 0;
  auVar145._0_8_ = auVar144._0_8_;
  uVar193 = auVar144._8_8_;
  uVar206 = uVar205 + uVar193;
  auVar17._8_8_ = 0;
  auVar17._0_8_ = param_2[1];
  auVar81._8_8_ = 0;
  auVar81._0_8_ = param_3[4];
  auVar145 = auVar17 * auVar81 + auVar145;
  auVar146._8_8_ = 0;
  auVar146._0_8_ = auVar145._0_8_;
  uVar194 = auVar145._8_8_;
  uVar201 = uVar206 + uVar194;
  auVar18._8_8_ = 0;
  auVar18._0_8_ = param_2[2];
  auVar82._8_8_ = 0;
  auVar82._0_8_ = param_3[3];
  auVar146 = auVar18 * auVar82 + auVar146;
  auVar147._8_8_ = 0;
  auVar147._0_8_ = auVar146._0_8_;
  uVar195 = auVar146._8_8_;
  uVar202 = uVar201 + uVar195;
  auVar19._8_8_ = 0;
  auVar19._0_8_ = param_2[3];
  auVar83._8_8_ = 0;
  auVar83._0_8_ = param_3[2];
  auVar147 = auVar19 * auVar83 + auVar147;
  auVar148._8_8_ = 0;
  auVar148._0_8_ = auVar147._0_8_;
  uVar196 = auVar147._8_8_;
  uVar199 = uVar202 + uVar196;
  auVar20._8_8_ = 0;
  auVar20._0_8_ = param_2[4];
  auVar84._8_8_ = 0;
  auVar84._0_8_ = param_3[1];
  auVar148 = auVar20 * auVar84 + auVar148;
  auVar149._8_8_ = 0;
  auVar149._0_8_ = auVar148._0_8_;
  uVar197 = auVar148._8_8_;
  uVar200 = uVar199 + uVar197;
  auVar21._8_8_ = 0;
  auVar21._0_8_ = param_2[5];
  auVar85._8_8_ = 0;
  auVar85._0_8_ = *param_3;
  auVar149 = auVar21 * auVar85 + auVar149;
  uVar198 = auVar149._8_8_;
  param_1[5] = auVar149._0_8_;
  auVar150._8_8_ = 0;
  auVar150._0_8_ = uVar200 + uVar198;
  uVar206 = (ulong)CARRY8(uVar205,uVar193) + (ulong)CARRY8(uVar206,uVar194) +
            (ulong)CARRY8(uVar201,uVar195) + (ulong)CARRY8(uVar202,uVar196) +
            (ulong)CARRY8(uVar199,uVar197) + (ulong)CARRY8(uVar200,uVar198);
  auVar22._8_8_ = 0;
  auVar22._0_8_ = param_2[6];
  auVar86._8_8_ = 0;
  auVar86._0_8_ = *param_3;
  auVar150 = auVar22 * auVar86 + auVar150;
  auVar151._8_8_ = 0;
  auVar151._0_8_ = auVar150._0_8_;
  uVar193 = auVar150._8_8_;
  uVar201 = uVar206 + uVar193;
  auVar23._8_8_ = 0;
  auVar23._0_8_ = param_2[5];
  auVar87._8_8_ = 0;
  auVar87._0_8_ = param_3[1];
  auVar151 = auVar23 * auVar87 + auVar151;
  auVar152._8_8_ = 0;
  auVar152._0_8_ = auVar151._0_8_;
  uVar194 = auVar151._8_8_;
  uVar202 = uVar201 + uVar194;
  auVar24._8_8_ = 0;
  auVar24._0_8_ = param_2[4];
  auVar88._8_8_ = 0;
  auVar88._0_8_ = param_3[2];
  auVar152 = auVar24 * auVar88 + auVar152;
  auVar153._8_8_ = 0;
  auVar153._0_8_ = auVar152._0_8_;
  uVar195 = auVar152._8_8_;
  uVar199 = uVar202 + uVar195;
  auVar25._8_8_ = 0;
  auVar25._0_8_ = param_2[3];
  auVar89._8_8_ = 0;
  auVar89._0_8_ = param_3[3];
  auVar153 = auVar25 * auVar89 + auVar153;
  auVar154._8_8_ = 0;
  auVar154._0_8_ = auVar153._0_8_;
  uVar196 = auVar153._8_8_;
  uVar200 = uVar199 + uVar196;
  auVar26._8_8_ = 0;
  auVar26._0_8_ = param_2[2];
  auVar90._8_8_ = 0;
  auVar90._0_8_ = param_3[4];
  auVar154 = auVar26 * auVar90 + auVar154;
  auVar155._8_8_ = 0;
  auVar155._0_8_ = auVar154._0_8_;
  uVar197 = auVar154._8_8_;
  uVar207 = uVar200 + uVar197;
  auVar27._8_8_ = 0;
  auVar27._0_8_ = param_2[1];
  auVar91._8_8_ = 0;
  auVar91._0_8_ = param_3[5];
  auVar155 = auVar27 * auVar91 + auVar155;
  auVar156._8_8_ = 0;
  auVar156._0_8_ = auVar155._0_8_;
  uVar198 = auVar155._8_8_;
  uVar208 = uVar207 + uVar198;
  auVar28._8_8_ = 0;
  auVar28._0_8_ = *param_2;
  auVar92._8_8_ = 0;
  auVar92._0_8_ = param_3[6];
  auVar156 = auVar28 * auVar92 + auVar156;
  uVar205 = auVar156._8_8_;
  param_1[6] = auVar156._0_8_;
  auVar157._8_8_ = 0;
  auVar157._0_8_ = uVar208 + uVar205;
  uVar201 = (ulong)CARRY8(uVar206,uVar193) + (ulong)CARRY8(uVar201,uVar194) +
            (ulong)CARRY8(uVar202,uVar195) + (ulong)CARRY8(uVar199,uVar196) +
            (ulong)CARRY8(uVar200,uVar197) + (ulong)CARRY8(uVar207,uVar198) +
            (ulong)CARRY8(uVar208,uVar205);
  auVar29._8_8_ = 0;
  auVar29._0_8_ = *param_2;
  auVar93._8_8_ = 0;
  auVar93._0_8_ = param_3[7];
  auVar157 = auVar29 * auVar93 + auVar157;
  auVar158._8_8_ = 0;
  auVar158._0_8_ = auVar157._0_8_;
  uVar193 = auVar157._8_8_;
  uVar202 = uVar201 + uVar193;
  auVar30._8_8_ = 0;
  auVar30._0_8_ = param_2[1];
  auVar94._8_8_ = 0;
  auVar94._0_8_ = param_3[6];
  auVar158 = auVar30 * auVar94 + auVar158;
  auVar159._8_8_ = 0;
  auVar159._0_8_ = auVar158._0_8_;
  uVar194 = auVar158._8_8_;
  uVar199 = uVar202 + uVar194;
  auVar31._8_8_ = 0;
  auVar31._0_8_ = param_2[2];
  auVar95._8_8_ = 0;
  auVar95._0_8_ = param_3[5];
  auVar159 = auVar31 * auVar95 + auVar159;
  auVar160._8_8_ = 0;
  auVar160._0_8_ = auVar159._0_8_;
  uVar195 = auVar159._8_8_;
  uVar200 = uVar199 + uVar195;
  auVar32._8_8_ = 0;
  auVar32._0_8_ = param_2[3];
  auVar96._8_8_ = 0;
  auVar96._0_8_ = param_3[4];
  auVar160 = auVar32 * auVar96 + auVar160;
  auVar161._8_8_ = 0;
  auVar161._0_8_ = auVar160._0_8_;
  uVar196 = auVar160._8_8_;
  uVar207 = uVar200 + uVar196;
  auVar33._8_8_ = 0;
  auVar33._0_8_ = param_2[4];
  auVar97._8_8_ = 0;
  auVar97._0_8_ = param_3[3];
  auVar161 = auVar33 * auVar97 + auVar161;
  auVar162._8_8_ = 0;
  auVar162._0_8_ = auVar161._0_8_;
  uVar197 = auVar161._8_8_;
  uVar208 = uVar207 + uVar197;
  auVar34._8_8_ = 0;
  auVar34._0_8_ = param_2[5];
  auVar98._8_8_ = 0;
  auVar98._0_8_ = param_3[2];
  auVar162 = auVar34 * auVar98 + auVar162;
  auVar163._8_8_ = 0;
  auVar163._0_8_ = auVar162._0_8_;
  uVar198 = auVar162._8_8_;
  uVar203 = uVar208 + uVar198;
  auVar35._8_8_ = 0;
  auVar35._0_8_ = param_2[6];
  auVar99._8_8_ = 0;
  auVar99._0_8_ = param_3[1];
  auVar163 = auVar35 * auVar99 + auVar163;
  auVar164._8_8_ = 0;
  auVar164._0_8_ = auVar163._0_8_;
  uVar205 = auVar163._8_8_;
  uVar204 = uVar203 + uVar205;
  auVar36._8_8_ = 0;
  auVar36._0_8_ = param_2[7];
  auVar100._8_8_ = 0;
  auVar100._0_8_ = *param_3;
  auVar164 = auVar36 * auVar100 + auVar164;
  uVar206 = auVar164._8_8_;
  param_1[7] = auVar164._0_8_;
  auVar165._8_8_ = 0;
  auVar165._0_8_ = uVar204 + uVar206;
  uVar206 = (ulong)CARRY8(uVar201,uVar193) + (ulong)CARRY8(uVar202,uVar194) +
            (ulong)CARRY8(uVar199,uVar195) + (ulong)CARRY8(uVar200,uVar196) +
            (ulong)CARRY8(uVar207,uVar197) + (ulong)CARRY8(uVar208,uVar198) +
            (ulong)CARRY8(uVar203,uVar205) + (ulong)CARRY8(uVar204,uVar206);
  auVar37._8_8_ = 0;
  auVar37._0_8_ = param_2[7];
  auVar101._8_8_ = 0;
  auVar101._0_8_ = param_3[1];
  auVar165 = auVar37 * auVar101 + auVar165;
  auVar166._8_8_ = 0;
  auVar166._0_8_ = auVar165._0_8_;
  uVar193 = auVar165._8_8_;
  uVar201 = uVar206 + uVar193;
  auVar38._8_8_ = 0;
  auVar38._0_8_ = param_2[6];
  auVar102._8_8_ = 0;
  auVar102._0_8_ = param_3[2];
  auVar166 = auVar38 * auVar102 + auVar166;
  auVar167._8_8_ = 0;
  auVar167._0_8_ = auVar166._0_8_;
  uVar194 = auVar166._8_8_;
  uVar202 = uVar201 + uVar194;
  auVar39._8_8_ = 0;
  auVar39._0_8_ = param_2[5];
  auVar103._8_8_ = 0;
  auVar103._0_8_ = param_3[3];
  auVar167 = auVar39 * auVar103 + auVar167;
  auVar168._8_8_ = 0;
  auVar168._0_8_ = auVar167._0_8_;
  uVar195 = auVar167._8_8_;
  uVar199 = uVar202 + uVar195;
  auVar40._8_8_ = 0;
  auVar40._0_8_ = param_2[4];
  auVar104._8_8_ = 0;
  auVar104._0_8_ = param_3[4];
  auVar168 = auVar40 * auVar104 + auVar168;
  auVar169._8_8_ = 0;
  auVar169._0_8_ = auVar168._0_8_;
  uVar196 = auVar168._8_8_;
  uVar200 = uVar199 + uVar196;
  auVar41._8_8_ = 0;
  auVar41._0_8_ = param_2[3];
  auVar105._8_8_ = 0;
  auVar105._0_8_ = param_3[5];
  auVar169 = auVar41 * auVar105 + auVar169;
  auVar170._8_8_ = 0;
  auVar170._0_8_ = auVar169._0_8_;
  uVar197 = auVar169._8_8_;
  uVar207 = uVar200 + uVar197;
  auVar42._8_8_ = 0;
  auVar42._0_8_ = param_2[2];
  auVar106._8_8_ = 0;
  auVar106._0_8_ = param_3[6];
  auVar170 = auVar42 * auVar106 + auVar170;
  auVar171._8_8_ = 0;
  auVar171._0_8_ = auVar170._0_8_;
  uVar198 = auVar170._8_8_;
  uVar208 = uVar207 + uVar198;
  auVar43._8_8_ = 0;
  auVar43._0_8_ = param_2[1];
  auVar107._8_8_ = 0;
  auVar107._0_8_ = param_3[7];
  auVar171 = auVar43 * auVar107 + auVar171;
  uVar205 = auVar171._8_8_;
  param_1[8] = auVar171._0_8_;
  auVar172._8_8_ = 0;
  auVar172._0_8_ = uVar208 + uVar205;
  uVar205 = (ulong)CARRY8(uVar206,uVar193) + (ulong)CARRY8(uVar201,uVar194) +
            (ulong)CARRY8(uVar202,uVar195) + (ulong)CARRY8(uVar199,uVar196) +
            (ulong)CARRY8(uVar200,uVar197) + (ulong)CARRY8(uVar207,uVar198) +
            (ulong)CARRY8(uVar208,uVar205);
  auVar44._8_8_ = 0;
  auVar44._0_8_ = param_2[2];
  auVar108._8_8_ = 0;
  auVar108._0_8_ = param_3[7];
  auVar172 = auVar44 * auVar108 + auVar172;
  auVar173._8_8_ = 0;
  auVar173._0_8_ = auVar172._0_8_;
  uVar193 = auVar172._8_8_;
  uVar206 = uVar205 + uVar193;
  auVar45._8_8_ = 0;
  auVar45._0_8_ = param_2[3];
  auVar109._8_8_ = 0;
  auVar109._0_8_ = param_3[6];
  auVar173 = auVar45 * auVar109 + auVar173;
  auVar174._8_8_ = 0;
  auVar174._0_8_ = auVar173._0_8_;
  uVar194 = auVar173._8_8_;
  uVar201 = uVar206 + uVar194;
  auVar46._8_8_ = 0;
  auVar46._0_8_ = param_2[4];
  auVar110._8_8_ = 0;
  auVar110._0_8_ = param_3[5];
  auVar174 = auVar46 * auVar110 + auVar174;
  auVar175._8_8_ = 0;
  auVar175._0_8_ = auVar174._0_8_;
  uVar195 = auVar174._8_8_;
  uVar202 = uVar201 + uVar195;
  auVar47._8_8_ = 0;
  auVar47._0_8_ = param_2[5];
  auVar111._8_8_ = 0;
  auVar111._0_8_ = param_3[4];
  auVar175 = auVar47 * auVar111 + auVar175;
  auVar176._8_8_ = 0;
  auVar176._0_8_ = auVar175._0_8_;
  uVar196 = auVar175._8_8_;
  uVar199 = uVar202 + uVar196;
  auVar48._8_8_ = 0;
  auVar48._0_8_ = param_2[6];
  auVar112._8_8_ = 0;
  auVar112._0_8_ = param_3[3];
  auVar176 = auVar48 * auVar112 + auVar176;
  auVar177._8_8_ = 0;
  auVar177._0_8_ = auVar176._0_8_;
  uVar197 = auVar176._8_8_;
  uVar200 = uVar199 + uVar197;
  auVar49._8_8_ = 0;
  auVar49._0_8_ = param_2[7];
  auVar113._8_8_ = 0;
  auVar113._0_8_ = param_3[2];
  auVar177 = auVar49 * auVar113 + auVar177;
  uVar198 = auVar177._8_8_;
  param_1[9] = auVar177._0_8_;
  auVar178._8_8_ = 0;
  auVar178._0_8_ = uVar200 + uVar198;
  uVar198 = (ulong)CARRY8(uVar205,uVar193) + (ulong)CARRY8(uVar206,uVar194) +
            (ulong)CARRY8(uVar201,uVar195) + (ulong)CARRY8(uVar202,uVar196) +
            (ulong)CARRY8(uVar199,uVar197) + (ulong)CARRY8(uVar200,uVar198);
  auVar50._8_8_ = 0;
  auVar50._0_8_ = param_2[7];
  auVar114._8_8_ = 0;
  auVar114._0_8_ = param_3[3];
  auVar178 = auVar50 * auVar114 + auVar178;
  auVar179._8_8_ = 0;
  auVar179._0_8_ = auVar178._0_8_;
  uVar193 = auVar178._8_8_;
  uVar205 = uVar198 + uVar193;
  auVar51._8_8_ = 0;
  auVar51._0_8_ = param_2[6];
  auVar115._8_8_ = 0;
  auVar115._0_8_ = param_3[4];
  auVar179 = auVar51 * auVar115 + auVar179;
  auVar180._8_8_ = 0;
  auVar180._0_8_ = auVar179._0_8_;
  uVar194 = auVar179._8_8_;
  uVar206 = uVar205 + uVar194;
  auVar52._8_8_ = 0;
  auVar52._0_8_ = param_2[5];
  auVar116._8_8_ = 0;
  auVar116._0_8_ = param_3[5];
  auVar180 = auVar52 * auVar116 + auVar180;
  auVar181._8_8_ = 0;
  auVar181._0_8_ = auVar180._0_8_;
  uVar195 = auVar180._8_8_;
  uVar201 = uVar206 + uVar195;
  auVar53._8_8_ = 0;
  auVar53._0_8_ = param_2[4];
  auVar117._8_8_ = 0;
  auVar117._0_8_ = param_3[6];
  auVar181 = auVar53 * auVar117 + auVar181;
  auVar182._8_8_ = 0;
  auVar182._0_8_ = auVar181._0_8_;
  uVar196 = auVar181._8_8_;
  uVar202 = uVar201 + uVar196;
  auVar54._8_8_ = 0;
  auVar54._0_8_ = param_2[3];
  auVar118._8_8_ = 0;
  auVar118._0_8_ = param_3[7];
  auVar182 = auVar54 * auVar118 + auVar182;
  uVar197 = auVar182._8_8_;
  param_1[10] = auVar182._0_8_;
  auVar183._8_8_ = 0;
  auVar183._0_8_ = uVar202 + uVar197;
  uVar197 = (ulong)CARRY8(uVar198,uVar193) + (ulong)CARRY8(uVar205,uVar194) +
            (ulong)CARRY8(uVar206,uVar195) + (ulong)CARRY8(uVar201,uVar196) +
            (ulong)CARRY8(uVar202,uVar197);
  auVar55._8_8_ = 0;
  auVar55._0_8_ = param_2[4];
  auVar119._8_8_ = 0;
  auVar119._0_8_ = param_3[7];
  auVar183 = auVar55 * auVar119 + auVar183;
  auVar184._8_8_ = 0;
  auVar184._0_8_ = auVar183._0_8_;
  uVar193 = auVar183._8_8_;
  uVar198 = uVar197 + uVar193;
  auVar56._8_8_ = 0;
  auVar56._0_8_ = param_2[5];
  auVar120._8_8_ = 0;
  auVar120._0_8_ = param_3[6];
  auVar184 = auVar56 * auVar120 + auVar184;
  auVar185._8_8_ = 0;
  auVar185._0_8_ = auVar184._0_8_;
  uVar194 = auVar184._8_8_;
  uVar205 = uVar198 + uVar194;
  auVar57._8_8_ = 0;
  auVar57._0_8_ = param_2[6];
  auVar121._8_8_ = 0;
  auVar121._0_8_ = param_3[5];
  auVar185 = auVar57 * auVar121 + auVar185;
  auVar186._8_8_ = 0;
  auVar186._0_8_ = auVar185._0_8_;
  uVar195 = auVar185._8_8_;
  uVar206 = uVar205 + uVar195;
  auVar58._8_8_ = 0;
  auVar58._0_8_ = param_2[7];
  auVar122._8_8_ = 0;
  auVar122._0_8_ = param_3[4];
  auVar186 = auVar58 * auVar122 + auVar186;
  uVar196 = auVar186._8_8_;
  param_1[0xb] = auVar186._0_8_;
  auVar187._8_8_ = 0;
  auVar187._0_8_ = uVar206 + uVar196;
  uVar196 = (ulong)CARRY8(uVar197,uVar193) + (ulong)CARRY8(uVar198,uVar194) +
            (ulong)CARRY8(uVar205,uVar195) + (ulong)CARRY8(uVar206,uVar196);
  auVar59._8_8_ = 0;
  auVar59._0_8_ = param_2[7];
  auVar123._8_8_ = 0;
  auVar123._0_8_ = param_3[5];
  auVar187 = auVar59 * auVar123 + auVar187;
  auVar188._8_8_ = 0;
  auVar188._0_8_ = auVar187._0_8_;
  uVar193 = auVar187._8_8_;
  uVar197 = uVar196 + uVar193;
  auVar60._8_8_ = 0;
  auVar60._0_8_ = param_2[6];
  auVar124._8_8_ = 0;
  auVar124._0_8_ = param_3[6];
  auVar188 = auVar60 * auVar124 + auVar188;
  auVar189._8_8_ = 0;
  auVar189._0_8_ = auVar188._0_8_;
  uVar194 = auVar188._8_8_;
  uVar198 = uVar197 + uVar194;
  auVar61._8_8_ = 0;
  auVar61._0_8_ = param_2[5];
  auVar125._8_8_ = 0;
  auVar125._0_8_ = param_3[7];
  auVar189 = auVar61 * auVar125 + auVar189;
  uVar195 = auVar189._8_8_;
  param_1[0xc] = auVar189._0_8_;
  auVar190._8_8_ = 0;
  auVar190._0_8_ = uVar198 + uVar195;
  uVar195 = (ulong)CARRY8(uVar196,uVar193) + (ulong)CARRY8(uVar197,uVar194) +
            (ulong)CARRY8(uVar198,uVar195);
  auVar62._8_8_ = 0;
  auVar62._0_8_ = param_2[6];
  auVar126._8_8_ = 0;
  auVar126._0_8_ = param_3[7];
  auVar190 = auVar62 * auVar126 + auVar190;
  auVar191._8_8_ = 0;
  auVar191._0_8_ = auVar190._0_8_;
  uVar193 = auVar190._8_8_;
  uVar196 = uVar195 + uVar193;
  auVar63._8_8_ = 0;
  auVar63._0_8_ = param_2[7];
  auVar127._8_8_ = 0;
  auVar127._0_8_ = param_3[6];
  auVar191 = auVar63 * auVar127 + auVar191;
  uVar194 = auVar191._8_8_;
  auVar192._8_8_ = (ulong)CARRY8(uVar195,uVar193) + (ulong)CARRY8(uVar196,uVar194);
  auVar192._0_8_ = uVar196 + uVar194;
  param_1[0xd] = auVar191._0_8_;
  auVar64._8_8_ = 0;
  auVar64._0_8_ = param_2[7];
  auVar128._8_8_ = 0;
  auVar128._0_8_ = param_3[7];
  *(undefined1 (*) [16])(param_1 + 0xe) = auVar64 * auVar128 + auVar192;
  return;
}



void bn_mul_comba4(undefined8 *param_1,ulong *param_2,ulong *param_3)

{
  undefined1 auVar1 [16];
  undefined1 auVar2 [16];
  undefined1 auVar3 [16];
  undefined1 auVar4 [16];
  undefined1 auVar5 [16];
  undefined1 auVar6 [16];
  undefined1 auVar7 [16];
  undefined1 auVar8 [16];
  undefined1 auVar9 [16];
  undefined1 auVar10 [16];
  undefined1 auVar11 [16];
  undefined1 auVar12 [16];
  undefined1 auVar13 [16];
  undefined1 auVar14 [16];
  undefined1 auVar15 [16];
  undefined1 auVar16 [16];
  undefined1 auVar17 [16];
  undefined1 auVar18 [16];
  undefined1 auVar19 [16];
  undefined1 auVar20 [16];
  undefined1 auVar21 [16];
  undefined1 auVar22 [16];
  undefined1 auVar23 [16];
  undefined1 auVar24 [16];
  undefined1 auVar25 [16];
  undefined1 auVar26 [16];
  undefined1 auVar27 [16];
  undefined1 auVar28 [16];
  undefined1 auVar29 [16];
  undefined1 auVar30 [16];
  undefined1 auVar31 [16];
  undefined1 auVar32 [16];
  undefined1 auVar33 [16];
  undefined1 auVar34 [16];
  undefined1 auVar35 [16];
  undefined1 auVar36 [16];
  undefined1 auVar37 [16];
  undefined1 auVar38 [16];
  undefined1 auVar39 [16];
  undefined1 auVar40 [16];
  undefined1 auVar41 [16];
  undefined1 auVar42 [16];
  undefined1 auVar43 [16];
  undefined1 auVar44 [16];
  undefined1 auVar45 [16];
  undefined1 auVar46 [16];
  undefined1 auVar47 [16];
  undefined1 auVar48 [16];
  ulong uVar49;
  ulong uVar50;
  ulong uVar51;
  ulong uVar52;
  ulong uVar53;
  ulong uVar54;
  ulong uVar55;
  ulong uVar56;
  
  auVar1._8_8_ = 0;
  auVar1._0_8_ = *param_2;
  auVar17._8_8_ = 0;
  auVar17._0_8_ = *param_3;
  auVar1 = auVar1 * auVar17 + ZEXT816(0);
  *param_1 = auVar1._0_8_;
  auVar33._8_8_ = 0;
  auVar33._0_8_ = auVar1._8_8_;
  auVar2._8_8_ = 0;
  auVar2._0_8_ = *param_2;
  auVar18._8_8_ = 0;
  auVar18._0_8_ = param_3[1];
  auVar33 = auVar2 * auVar18 + auVar33;
  auVar34._8_8_ = 0;
  auVar34._0_8_ = auVar33._0_8_;
  uVar49 = auVar33._8_8_;
  auVar3._8_8_ = 0;
  auVar3._0_8_ = param_2[1];
  auVar19._8_8_ = 0;
  auVar19._0_8_ = *param_3;
  auVar34 = auVar3 * auVar19 + auVar34;
  uVar50 = auVar34._8_8_;
  param_1[1] = auVar34._0_8_;
  auVar35._8_8_ = 0;
  auVar35._0_8_ = uVar49 + uVar50;
  uVar49 = (ulong)CARRY8(uVar49,uVar50);
  auVar4._8_8_ = 0;
  auVar4._0_8_ = param_2[2];
  auVar20._8_8_ = 0;
  auVar20._0_8_ = *param_3;
  auVar35 = auVar4 * auVar20 + auVar35;
  auVar36._8_8_ = 0;
  auVar36._0_8_ = auVar35._0_8_;
  uVar50 = auVar35._8_8_;
  uVar55 = uVar49 + uVar50;
  auVar5._8_8_ = 0;
  auVar5._0_8_ = param_2[1];
  auVar21._8_8_ = 0;
  auVar21._0_8_ = param_3[1];
  auVar36 = auVar5 * auVar21 + auVar36;
  auVar37._8_8_ = 0;
  auVar37._0_8_ = auVar36._0_8_;
  uVar51 = auVar36._8_8_;
  uVar56 = uVar55 + uVar51;
  auVar6._8_8_ = 0;
  auVar6._0_8_ = *param_2;
  auVar22._8_8_ = 0;
  auVar22._0_8_ = param_3[2];
  auVar37 = auVar6 * auVar22 + auVar37;
  uVar52 = auVar37._8_8_;
  param_1[2] = auVar37._0_8_;
  auVar38._8_8_ = 0;
  auVar38._0_8_ = uVar56 + uVar52;
  uVar55 = (ulong)CARRY8(uVar49,uVar50) + (ulong)CARRY8(uVar55,uVar51) +
           (ulong)CARRY8(uVar56,uVar52);
  auVar7._8_8_ = 0;
  auVar7._0_8_ = *param_2;
  auVar23._8_8_ = 0;
  auVar23._0_8_ = param_3[3];
  auVar38 = auVar7 * auVar23 + auVar38;
  auVar39._8_8_ = 0;
  auVar39._0_8_ = auVar38._0_8_;
  uVar49 = auVar38._8_8_;
  uVar56 = uVar55 + uVar49;
  auVar8._8_8_ = 0;
  auVar8._0_8_ = param_2[1];
  auVar24._8_8_ = 0;
  auVar24._0_8_ = param_3[2];
  auVar39 = auVar8 * auVar24 + auVar39;
  auVar40._8_8_ = 0;
  auVar40._0_8_ = auVar39._0_8_;
  uVar50 = auVar39._8_8_;
  uVar53 = uVar56 + uVar50;
  auVar9._8_8_ = 0;
  auVar9._0_8_ = param_2[2];
  auVar25._8_8_ = 0;
  auVar25._0_8_ = param_3[1];
  auVar40 = auVar9 * auVar25 + auVar40;
  auVar42._8_8_ = 0;
  auVar42._0_8_ = auVar40._0_8_;
  uVar51 = auVar40._8_8_;
  uVar54 = uVar53 + uVar51;
  auVar10._8_8_ = 0;
  auVar10._0_8_ = param_2[3];
  auVar26._8_8_ = 0;
  auVar26._0_8_ = *param_3;
  auVar41 = auVar10 * auVar26 + auVar42;
  uVar52 = auVar41._8_8_;
  param_1[3] = auVar41._0_8_;
  auVar43._8_8_ = 0;
  auVar43._0_8_ = uVar54 + uVar52;
  uVar52 = (ulong)CARRY8(uVar55,uVar49) + (ulong)CARRY8(uVar56,uVar50) +
           (ulong)CARRY8(uVar53,uVar51) + (ulong)CARRY8(uVar54,uVar52);
  auVar11._8_8_ = 0;
  auVar11._0_8_ = param_2[3];
  auVar27._8_8_ = 0;
  auVar27._0_8_ = param_3[1];
  auVar43 = auVar11 * auVar27 + auVar43;
  auVar44._8_8_ = 0;
  auVar44._0_8_ = auVar43._0_8_;
  uVar49 = auVar43._8_8_;
  uVar55 = uVar52 + uVar49;
  auVar12._8_8_ = 0;
  auVar12._0_8_ = param_2[2];
  auVar28._8_8_ = 0;
  auVar28._0_8_ = param_3[2];
  auVar44 = auVar12 * auVar28 + auVar44;
  auVar45._8_8_ = 0;
  auVar45._0_8_ = auVar44._0_8_;
  uVar50 = auVar44._8_8_;
  uVar56 = uVar55 + uVar50;
  auVar13._8_8_ = 0;
  auVar13._0_8_ = param_2[1];
  auVar29._8_8_ = 0;
  auVar29._0_8_ = param_3[3];
  auVar45 = auVar13 * auVar29 + auVar45;
  uVar51 = auVar45._8_8_;
  param_1[4] = auVar45._0_8_;
  auVar46._8_8_ = 0;
  auVar46._0_8_ = uVar56 + uVar51;
  uVar51 = (ulong)CARRY8(uVar52,uVar49) + (ulong)CARRY8(uVar55,uVar50) +
           (ulong)CARRY8(uVar56,uVar51);
  auVar14._8_8_ = 0;
  auVar14._0_8_ = param_2[2];
  auVar30._8_8_ = 0;
  auVar30._0_8_ = param_3[3];
  auVar46 = auVar14 * auVar30 + auVar46;
  auVar47._8_8_ = 0;
  auVar47._0_8_ = auVar46._0_8_;
  uVar49 = auVar46._8_8_;
  uVar52 = uVar51 + uVar49;
  auVar15._8_8_ = 0;
  auVar15._0_8_ = param_2[3];
  auVar31._8_8_ = 0;
  auVar31._0_8_ = param_3[2];
  auVar47 = auVar15 * auVar31 + auVar47;
  uVar50 = auVar47._8_8_;
  auVar48._8_8_ = (ulong)CARRY8(uVar51,uVar49) + (ulong)CARRY8(uVar52,uVar50);
  auVar48._0_8_ = uVar52 + uVar50;
  param_1[5] = auVar47._0_8_;
  auVar16._8_8_ = 0;
  auVar16._0_8_ = param_2[3];
  auVar32._8_8_ = 0;
  auVar32._0_8_ = param_3[3];
  *(undefined1 (*) [16])(param_1 + 6) = auVar16 * auVar32 + auVar48;
  return;
}



void bn_sqr_comba8(undefined8 *param_1,ulong *param_2)

{
  undefined1 auVar1 [16];
  undefined1 auVar2 [16];
  undefined1 auVar3 [16];
  undefined1 auVar4 [16];
  undefined1 auVar5 [16];
  undefined1 auVar6 [16];
  undefined1 auVar7 [16];
  undefined1 auVar8 [16];
  undefined1 auVar9 [16];
  undefined1 auVar10 [16];
  undefined1 auVar11 [16];
  undefined1 auVar12 [16];
  undefined1 auVar13 [16];
  undefined1 auVar14 [16];
  undefined1 auVar15 [16];
  undefined1 auVar16 [16];
  undefined1 auVar17 [16];
  undefined1 auVar18 [16];
  undefined1 auVar19 [16];
  undefined1 auVar20 [16];
  undefined1 auVar21 [16];
  undefined1 auVar22 [16];
  undefined1 auVar23 [16];
  undefined1 auVar24 [16];
  undefined1 auVar25 [16];
  undefined1 auVar26 [16];
  undefined1 auVar27 [16];
  undefined1 auVar28 [16];
  undefined1 auVar29 [16];
  undefined1 auVar30 [16];
  undefined1 auVar31 [16];
  undefined1 auVar32 [16];
  undefined1 auVar33 [16];
  undefined1 auVar34 [16];
  undefined1 auVar35 [16];
  undefined1 auVar36 [16];
  undefined1 auVar37 [16];
  undefined1 auVar38 [16];
  undefined1 auVar39 [16];
  undefined1 auVar40 [16];
  undefined1 auVar41 [16];
  undefined1 auVar42 [16];
  undefined1 auVar43 [16];
  undefined1 auVar44 [16];
  undefined1 auVar45 [16];
  undefined1 auVar46 [16];
  undefined1 auVar47 [16];
  undefined1 auVar48 [16];
  undefined1 auVar49 [16];
  undefined1 auVar50 [16];
  undefined1 auVar51 [16];
  undefined1 auVar52 [16];
  undefined1 auVar53 [16];
  undefined1 auVar54 [16];
  undefined1 auVar55 [16];
  undefined1 auVar56 [16];
  undefined1 auVar57 [16];
  undefined1 auVar58 [16];
  undefined1 auVar59 [16];
  undefined1 auVar60 [16];
  undefined1 auVar61 [16];
  undefined1 auVar62 [16];
  undefined1 auVar63 [16];
  undefined1 auVar64 [16];
  undefined1 auVar65 [16];
  undefined1 auVar66 [16];
  undefined1 auVar67 [16];
  undefined1 auVar68 [16];
  undefined1 auVar69 [16];
  undefined1 auVar70 [16];
  undefined1 auVar71 [16];
  undefined1 auVar72 [16];
  undefined1 auVar73 [16];
  undefined1 auVar74 [16];
  undefined1 auVar75 [16];
  undefined1 auVar76 [16];
  undefined1 auVar77 [16];
  undefined1 auVar78 [16];
  undefined1 auVar79 [16];
  ulong uVar80;
  ulong uVar81;
  ulong uVar82;
  ulong uVar83;
  ulong uVar84;
  ulong uVar85;
  ulong uVar86;
  ulong uVar87;
  ulong uVar88;
  ulong uVar89;
  ulong uVar90;
  ulong uVar91;
  ulong uVar92;
  ulong uVar93;
  
  auVar1._8_8_ = 0;
  auVar1._0_8_ = *param_2;
  auVar37._8_8_ = 0;
  auVar37._0_8_ = *param_2;
  auVar1 = auVar1 * auVar37 + ZEXT816(0);
  uVar81 = auVar1._8_8_;
  *param_1 = auVar1._0_8_;
  auVar2._8_8_ = 0;
  auVar2._0_8_ = param_2[1];
  auVar38._8_8_ = 0;
  auVar38._0_8_ = *param_2;
  uVar82 = SUB168(auVar2 * auVar38,8);
  uVar80 = SUB168(auVar2 * auVar38,0);
  param_1[1] = uVar81 + uVar80 * 2;
  auVar73._8_8_ = 0;
  auVar73._0_8_ = uVar82 * 2 + (ulong)CARRY8(uVar80,uVar80) + (ulong)CARRY8(uVar81,uVar80 * 2);
  auVar3._8_8_ = 0;
  auVar3._0_8_ = param_2[1];
  auVar39._8_8_ = 0;
  auVar39._0_8_ = param_2[1];
  auVar73 = auVar3 * auVar39 + auVar73;
  uVar86 = auVar73._0_8_;
  uVar81 = auVar73._8_8_;
  uVar85 = CARRY8(uVar82,uVar82) + uVar81;
  auVar4._8_8_ = 0;
  auVar4._0_8_ = param_2[2];
  auVar40._8_8_ = 0;
  auVar40._0_8_ = *param_2;
  uVar83 = SUB168(auVar4 * auVar40,8);
  uVar80 = SUB168(auVar4 * auVar40,0);
  uVar84 = uVar83 * 2 + (ulong)CARRY8(uVar80,uVar80) + (ulong)CARRY8(uVar86,uVar80 * 2);
  param_1[2] = uVar86 + uVar80 * 2;
  uVar86 = uVar85 + uVar84;
  uVar89 = (ulong)CARRY8((ulong)CARRY8(uVar82,uVar82),uVar81) + (ulong)CARRY8(uVar83,uVar83) +
           (ulong)CARRY8(uVar85,uVar84);
  auVar5._8_8_ = 0;
  auVar5._0_8_ = param_2[3];
  auVar41._8_8_ = 0;
  auVar41._0_8_ = *param_2;
  uVar81 = SUB168(auVar5 * auVar41,8);
  uVar80 = SUB168(auVar5 * auVar41,0);
  uVar85 = uVar86 + uVar80 * 2;
  uVar82 = uVar81 * 2 + (ulong)CARRY8(uVar80,uVar80) + (ulong)CARRY8(uVar86,uVar80 * 2);
  uVar86 = uVar89 + uVar82;
  auVar6._8_8_ = 0;
  auVar6._0_8_ = param_2[2];
  auVar42._8_8_ = 0;
  auVar42._0_8_ = param_2[1];
  uVar83 = SUB168(auVar6 * auVar42,8);
  uVar80 = SUB168(auVar6 * auVar42,0);
  uVar84 = uVar83 * 2 + (ulong)CARRY8(uVar80,uVar80) + (ulong)CARRY8(uVar85,uVar80 * 2);
  param_1[3] = uVar85 + uVar80 * 2;
  auVar74._8_8_ = 0;
  auVar74._0_8_ = uVar86 + uVar84;
  uVar86 = (ulong)CARRY8(uVar81,uVar81) + (ulong)CARRY8(uVar89,uVar82) +
           (ulong)CARRY8(uVar83,uVar83) + (ulong)CARRY8(uVar86,uVar84);
  auVar7._8_8_ = 0;
  auVar7._0_8_ = param_2[2];
  auVar43._8_8_ = 0;
  auVar43._0_8_ = param_2[2];
  auVar74 = auVar7 * auVar43 + auVar74;
  uVar83 = auVar74._0_8_;
  uVar81 = auVar74._8_8_;
  uVar89 = uVar86 + uVar81;
  auVar8._8_8_ = 0;
  auVar8._0_8_ = param_2[3];
  auVar44._8_8_ = 0;
  auVar44._0_8_ = param_2[1];
  uVar82 = SUB168(auVar8 * auVar44,8);
  uVar80 = SUB168(auVar8 * auVar44,0);
  uVar90 = uVar83 + uVar80 * 2;
  uVar83 = uVar82 * 2 + (ulong)CARRY8(uVar80,uVar80) + (ulong)CARRY8(uVar83,uVar80 * 2);
  uVar87 = uVar89 + uVar83;
  auVar9._8_8_ = 0;
  auVar9._0_8_ = param_2[4];
  auVar45._8_8_ = 0;
  auVar45._0_8_ = *param_2;
  uVar84 = SUB168(auVar9 * auVar45,8);
  uVar80 = SUB168(auVar9 * auVar45,0);
  uVar85 = uVar84 * 2 + (ulong)CARRY8(uVar80,uVar80) + (ulong)CARRY8(uVar90,uVar80 * 2);
  param_1[4] = uVar90 + uVar80 * 2;
  uVar90 = uVar87 + uVar85;
  uVar89 = (ulong)CARRY8(uVar86,uVar81) + (ulong)CARRY8(uVar82,uVar82) +
           (ulong)CARRY8(uVar89,uVar83) + (ulong)CARRY8(uVar84,uVar84) +
           (ulong)CARRY8(uVar87,uVar85);
  auVar10._8_8_ = 0;
  auVar10._0_8_ = param_2[5];
  auVar46._8_8_ = 0;
  auVar46._0_8_ = *param_2;
  uVar81 = SUB168(auVar10 * auVar46,8);
  uVar80 = SUB168(auVar10 * auVar46,0);
  uVar84 = uVar90 + uVar80 * 2;
  uVar82 = uVar81 * 2 + (ulong)CARRY8(uVar80,uVar80) + (ulong)CARRY8(uVar90,uVar80 * 2);
  uVar87 = uVar89 + uVar82;
  auVar11._8_8_ = 0;
  auVar11._0_8_ = param_2[4];
  auVar47._8_8_ = 0;
  auVar47._0_8_ = param_2[1];
  uVar83 = SUB168(auVar11 * auVar47,8);
  uVar80 = SUB168(auVar11 * auVar47,0);
  uVar88 = uVar84 + uVar80 * 2;
  uVar84 = uVar83 * 2 + (ulong)CARRY8(uVar80,uVar80) + (ulong)CARRY8(uVar84,uVar80 * 2);
  uVar90 = uVar87 + uVar84;
  auVar12._8_8_ = 0;
  auVar12._0_8_ = param_2[3];
  auVar48._8_8_ = 0;
  auVar48._0_8_ = param_2[2];
  uVar85 = SUB168(auVar12 * auVar48,8);
  uVar80 = SUB168(auVar12 * auVar48,0);
  uVar86 = uVar85 * 2 + (ulong)CARRY8(uVar80,uVar80) + (ulong)CARRY8(uVar88,uVar80 * 2);
  param_1[5] = uVar88 + uVar80 * 2;
  auVar75._8_8_ = 0;
  auVar75._0_8_ = uVar90 + uVar86;
  uVar90 = (ulong)CARRY8(uVar81,uVar81) + (ulong)CARRY8(uVar89,uVar82) +
           (ulong)CARRY8(uVar83,uVar83) + (ulong)CARRY8(uVar87,uVar84) +
           (ulong)CARRY8(uVar85,uVar85) + (ulong)CARRY8(uVar90,uVar86);
  auVar13._8_8_ = 0;
  auVar13._0_8_ = param_2[3];
  auVar49._8_8_ = 0;
  auVar49._0_8_ = param_2[3];
  auVar75 = auVar13 * auVar49 + auVar75;
  uVar83 = auVar75._0_8_;
  uVar81 = auVar75._8_8_;
  uVar88 = uVar90 + uVar81;
  auVar14._8_8_ = 0;
  auVar14._0_8_ = param_2[4];
  auVar50._8_8_ = 0;
  auVar50._0_8_ = param_2[2];
  uVar82 = SUB168(auVar14 * auVar50,8);
  uVar80 = SUB168(auVar14 * auVar50,0);
  uVar85 = uVar83 + uVar80 * 2;
  uVar83 = uVar82 * 2 + (ulong)CARRY8(uVar80,uVar80) + (ulong)CARRY8(uVar83,uVar80 * 2);
  uVar91 = uVar88 + uVar83;
  auVar15._8_8_ = 0;
  auVar15._0_8_ = param_2[5];
  auVar51._8_8_ = 0;
  auVar51._0_8_ = param_2[1];
  uVar84 = SUB168(auVar15 * auVar51,8);
  uVar80 = SUB168(auVar15 * auVar51,0);
  uVar87 = uVar85 + uVar80 * 2;
  uVar85 = uVar84 * 2 + (ulong)CARRY8(uVar80,uVar80) + (ulong)CARRY8(uVar85,uVar80 * 2);
  uVar92 = uVar91 + uVar85;
  auVar16._8_8_ = 0;
  auVar16._0_8_ = param_2[6];
  auVar52._8_8_ = 0;
  auVar52._0_8_ = *param_2;
  uVar86 = SUB168(auVar16 * auVar52,8);
  uVar80 = SUB168(auVar16 * auVar52,0);
  uVar89 = uVar86 * 2 + (ulong)CARRY8(uVar80,uVar80) + (ulong)CARRY8(uVar87,uVar80 * 2);
  param_1[6] = uVar87 + uVar80 * 2;
  uVar87 = uVar92 + uVar89;
  uVar90 = (ulong)CARRY8(uVar90,uVar81) + (ulong)CARRY8(uVar82,uVar82) +
           (ulong)CARRY8(uVar88,uVar83) + (ulong)CARRY8(uVar84,uVar84) +
           (ulong)CARRY8(uVar91,uVar85) + (ulong)CARRY8(uVar86,uVar86) +
           (ulong)CARRY8(uVar92,uVar89);
  auVar17._8_8_ = 0;
  auVar17._0_8_ = param_2[7];
  auVar53._8_8_ = 0;
  auVar53._0_8_ = *param_2;
  uVar81 = SUB168(auVar17 * auVar53,8);
  uVar80 = SUB168(auVar17 * auVar53,0);
  uVar84 = uVar87 + uVar80 * 2;
  uVar82 = uVar81 * 2 + (ulong)CARRY8(uVar80,uVar80) + (ulong)CARRY8(uVar87,uVar80 * 2);
  uVar88 = uVar90 + uVar82;
  auVar18._8_8_ = 0;
  auVar18._0_8_ = param_2[6];
  auVar54._8_8_ = 0;
  auVar54._0_8_ = param_2[1];
  uVar83 = SUB168(auVar18 * auVar54,8);
  uVar80 = SUB168(auVar18 * auVar54,0);
  uVar86 = uVar84 + uVar80 * 2;
  uVar84 = uVar83 * 2 + (ulong)CARRY8(uVar80,uVar80) + (ulong)CARRY8(uVar84,uVar80 * 2);
  uVar91 = uVar88 + uVar84;
  auVar19._8_8_ = 0;
  auVar19._0_8_ = param_2[5];
  auVar55._8_8_ = 0;
  auVar55._0_8_ = param_2[2];
  uVar85 = SUB168(auVar19 * auVar55,8);
  uVar80 = SUB168(auVar19 * auVar55,0);
  uVar93 = uVar86 + uVar80 * 2;
  uVar86 = uVar85 * 2 + (ulong)CARRY8(uVar80,uVar80) + (ulong)CARRY8(uVar86,uVar80 * 2);
  uVar92 = uVar91 + uVar86;
  auVar20._8_8_ = 0;
  auVar20._0_8_ = param_2[4];
  auVar56._8_8_ = 0;
  auVar56._0_8_ = param_2[3];
  uVar89 = SUB168(auVar20 * auVar56,8);
  uVar80 = SUB168(auVar20 * auVar56,0);
  uVar87 = uVar89 * 2 + (ulong)CARRY8(uVar80,uVar80) + (ulong)CARRY8(uVar93,uVar80 * 2);
  param_1[7] = uVar93 + uVar80 * 2;
  auVar76._8_8_ = 0;
  auVar76._0_8_ = uVar92 + uVar87;
  uVar87 = (ulong)CARRY8(uVar81,uVar81) + (ulong)CARRY8(uVar90,uVar82) +
           (ulong)CARRY8(uVar83,uVar83) + (ulong)CARRY8(uVar88,uVar84) +
           (ulong)CARRY8(uVar85,uVar85) + (ulong)CARRY8(uVar91,uVar86) +
           (ulong)CARRY8(uVar89,uVar89) + (ulong)CARRY8(uVar92,uVar87);
  auVar21._8_8_ = 0;
  auVar21._0_8_ = param_2[4];
  auVar57._8_8_ = 0;
  auVar57._0_8_ = param_2[4];
  auVar76 = auVar21 * auVar57 + auVar76;
  uVar83 = auVar76._0_8_;
  uVar81 = auVar76._8_8_;
  uVar90 = uVar87 + uVar81;
  auVar22._8_8_ = 0;
  auVar22._0_8_ = param_2[5];
  auVar58._8_8_ = 0;
  auVar58._0_8_ = param_2[3];
  uVar82 = SUB168(auVar22 * auVar58,8);
  uVar80 = SUB168(auVar22 * auVar58,0);
  uVar85 = uVar83 + uVar80 * 2;
  uVar83 = uVar82 * 2 + (ulong)CARRY8(uVar80,uVar80) + (ulong)CARRY8(uVar83,uVar80 * 2);
  uVar88 = uVar90 + uVar83;
  auVar23._8_8_ = 0;
  auVar23._0_8_ = param_2[6];
  auVar59._8_8_ = 0;
  auVar59._0_8_ = param_2[2];
  uVar84 = SUB168(auVar23 * auVar59,8);
  uVar80 = SUB168(auVar23 * auVar59,0);
  uVar92 = uVar85 + uVar80 * 2;
  uVar85 = uVar84 * 2 + (ulong)CARRY8(uVar80,uVar80) + (ulong)CARRY8(uVar85,uVar80 * 2);
  uVar91 = uVar88 + uVar85;
  auVar24._8_8_ = 0;
  auVar24._0_8_ = param_2[7];
  auVar60._8_8_ = 0;
  auVar60._0_8_ = param_2[1];
  uVar86 = SUB168(auVar24 * auVar60,8);
  uVar80 = SUB168(auVar24 * auVar60,0);
  uVar89 = uVar86 * 2 + (ulong)CARRY8(uVar80,uVar80) + (ulong)CARRY8(uVar92,uVar80 * 2);
  param_1[8] = uVar92 + uVar80 * 2;
  uVar92 = uVar91 + uVar89;
  uVar87 = (ulong)CARRY8(uVar87,uVar81) + (ulong)CARRY8(uVar82,uVar82) +
           (ulong)CARRY8(uVar90,uVar83) + (ulong)CARRY8(uVar84,uVar84) +
           (ulong)CARRY8(uVar88,uVar85) + (ulong)CARRY8(uVar86,uVar86) +
           (ulong)CARRY8(uVar91,uVar89);
  auVar25._8_8_ = 0;
  auVar25._0_8_ = param_2[7];
  auVar61._8_8_ = 0;
  auVar61._0_8_ = param_2[2];
  uVar81 = SUB168(auVar25 * auVar61,8);
  uVar80 = SUB168(auVar25 * auVar61,0);
  uVar84 = uVar92 + uVar80 * 2;
  uVar82 = uVar81 * 2 + (ulong)CARRY8(uVar80,uVar80) + (ulong)CARRY8(uVar92,uVar80 * 2);
  uVar90 = uVar87 + uVar82;
  auVar26._8_8_ = 0;
  auVar26._0_8_ = param_2[6];
  auVar62._8_8_ = 0;
  auVar62._0_8_ = param_2[3];
  uVar83 = SUB168(auVar26 * auVar62,8);
  uVar80 = SUB168(auVar26 * auVar62,0);
  uVar89 = uVar84 + uVar80 * 2;
  uVar84 = uVar83 * 2 + (ulong)CARRY8(uVar80,uVar80) + (ulong)CARRY8(uVar84,uVar80 * 2);
  uVar88 = uVar90 + uVar84;
  auVar27._8_8_ = 0;
  auVar27._0_8_ = param_2[5];
  auVar63._8_8_ = 0;
  auVar63._0_8_ = param_2[4];
  uVar85 = SUB168(auVar27 * auVar63,8);
  uVar80 = SUB168(auVar27 * auVar63,0);
  uVar86 = uVar85 * 2 + (ulong)CARRY8(uVar80,uVar80) + (ulong)CARRY8(uVar89,uVar80 * 2);
  param_1[9] = uVar89 + uVar80 * 2;
  auVar77._8_8_ = 0;
  auVar77._0_8_ = uVar88 + uVar86;
  uVar86 = (ulong)CARRY8(uVar81,uVar81) + (ulong)CARRY8(uVar87,uVar82) +
           (ulong)CARRY8(uVar83,uVar83) + (ulong)CARRY8(uVar90,uVar84) +
           (ulong)CARRY8(uVar85,uVar85) + (ulong)CARRY8(uVar88,uVar86);
  auVar28._8_8_ = 0;
  auVar28._0_8_ = param_2[5];
  auVar64._8_8_ = 0;
  auVar64._0_8_ = param_2[5];
  auVar77 = auVar28 * auVar64 + auVar77;
  uVar83 = auVar77._0_8_;
  uVar81 = auVar77._8_8_;
  uVar89 = uVar86 + uVar81;
  auVar29._8_8_ = 0;
  auVar29._0_8_ = param_2[6];
  auVar65._8_8_ = 0;
  auVar65._0_8_ = param_2[4];
  uVar82 = SUB168(auVar29 * auVar65,8);
  uVar80 = SUB168(auVar29 * auVar65,0);
  uVar90 = uVar83 + uVar80 * 2;
  uVar83 = uVar82 * 2 + (ulong)CARRY8(uVar80,uVar80) + (ulong)CARRY8(uVar83,uVar80 * 2);
  uVar87 = uVar89 + uVar83;
  auVar30._8_8_ = 0;
  auVar30._0_8_ = param_2[7];
  auVar66._8_8_ = 0;
  auVar66._0_8_ = param_2[3];
  uVar84 = SUB168(auVar30 * auVar66,8);
  uVar80 = SUB168(auVar30 * auVar66,0);
  uVar85 = uVar84 * 2 + (ulong)CARRY8(uVar80,uVar80) + (ulong)CARRY8(uVar90,uVar80 * 2);
  param_1[10] = uVar90 + uVar80 * 2;
  uVar90 = uVar87 + uVar85;
  uVar85 = (ulong)CARRY8(uVar86,uVar81) + (ulong)CARRY8(uVar82,uVar82) +
           (ulong)CARRY8(uVar89,uVar83) + (ulong)CARRY8(uVar84,uVar84) +
           (ulong)CARRY8(uVar87,uVar85);
  auVar31._8_8_ = 0;
  auVar31._0_8_ = param_2[7];
  auVar67._8_8_ = 0;
  auVar67._0_8_ = param_2[4];
  uVar81 = SUB168(auVar31 * auVar67,8);
  uVar80 = SUB168(auVar31 * auVar67,0);
  uVar89 = uVar90 + uVar80 * 2;
  uVar82 = uVar81 * 2 + (ulong)CARRY8(uVar80,uVar80) + (ulong)CARRY8(uVar90,uVar80 * 2);
  uVar86 = uVar85 + uVar82;
  auVar32._8_8_ = 0;
  auVar32._0_8_ = param_2[6];
  auVar68._8_8_ = 0;
  auVar68._0_8_ = param_2[5];
  uVar83 = SUB168(auVar32 * auVar68,8);
  uVar80 = SUB168(auVar32 * auVar68,0);
  uVar84 = uVar83 * 2 + (ulong)CARRY8(uVar80,uVar80) + (ulong)CARRY8(uVar89,uVar80 * 2);
  param_1[0xb] = uVar89 + uVar80 * 2;
  auVar78._8_8_ = 0;
  auVar78._0_8_ = uVar86 + uVar84;
  uVar85 = (ulong)CARRY8(uVar81,uVar81) + (ulong)CARRY8(uVar85,uVar82) +
           (ulong)CARRY8(uVar83,uVar83) + (ulong)CARRY8(uVar86,uVar84);
  auVar33._8_8_ = 0;
  auVar33._0_8_ = param_2[6];
  auVar69._8_8_ = 0;
  auVar69._0_8_ = param_2[6];
  auVar78 = auVar33 * auVar69 + auVar78;
  uVar84 = auVar78._0_8_;
  uVar81 = auVar78._8_8_;
  uVar86 = uVar85 + uVar81;
  auVar34._8_8_ = 0;
  auVar34._0_8_ = param_2[7];
  auVar70._8_8_ = 0;
  auVar70._0_8_ = param_2[5];
  uVar82 = SUB168(auVar34 * auVar70,8);
  uVar80 = SUB168(auVar34 * auVar70,0);
  uVar83 = uVar82 * 2 + (ulong)CARRY8(uVar80,uVar80) + (ulong)CARRY8(uVar84,uVar80 * 2);
  param_1[0xc] = uVar84 + uVar80 * 2;
  uVar84 = uVar86 + uVar83;
  uVar83 = (ulong)CARRY8(uVar85,uVar81) + (ulong)CARRY8(uVar82,uVar82) +
           (ulong)CARRY8(uVar86,uVar83);
  auVar35._8_8_ = 0;
  auVar35._0_8_ = param_2[7];
  auVar71._8_8_ = 0;
  auVar71._0_8_ = param_2[6];
  uVar81 = SUB168(auVar35 * auVar71,8);
  uVar80 = SUB168(auVar35 * auVar71,0);
  uVar82 = uVar81 * 2 + (ulong)CARRY8(uVar80,uVar80) + (ulong)CARRY8(uVar84,uVar80 * 2);
  auVar79._8_8_ = (ulong)CARRY8(uVar81,uVar81) + (ulong)CARRY8(uVar83,uVar82);
  auVar79._0_8_ = uVar83 + uVar82;
  param_1[0xd] = uVar84 + uVar80 * 2;
  auVar36._8_8_ = 0;
  auVar36._0_8_ = param_2[7];
  auVar72._8_8_ = 0;
  auVar72._0_8_ = param_2[7];
  *(undefined1 (*) [16])(param_1 + 0xe) = auVar36 * auVar72 + auVar79;
  return;
}



void bn_sqr_comba4(undefined8 *param_1,ulong *param_2)

{
  undefined1 auVar1 [16];
  undefined1 auVar2 [16];
  undefined1 auVar3 [16];
  undefined1 auVar4 [16];
  undefined1 auVar5 [16];
  undefined1 auVar6 [16];
  undefined1 auVar7 [16];
  undefined1 auVar8 [16];
  undefined1 auVar9 [16];
  undefined1 auVar10 [16];
  undefined1 auVar11 [16];
  undefined1 auVar12 [16];
  undefined1 auVar13 [16];
  undefined1 auVar14 [16];
  undefined1 auVar15 [16];
  undefined1 auVar16 [16];
  undefined1 auVar17 [16];
  undefined1 auVar18 [16];
  undefined1 auVar19 [16];
  undefined1 auVar20 [16];
  undefined1 auVar21 [16];
  undefined1 auVar22 [16];
  undefined1 auVar23 [16];
  ulong uVar24;
  ulong uVar25;
  ulong uVar26;
  ulong uVar27;
  ulong uVar28;
  ulong uVar29;
  ulong uVar30;
  ulong uVar31;
  
  auVar1._8_8_ = 0;
  auVar1._0_8_ = *param_2;
  auVar11._8_8_ = 0;
  auVar11._0_8_ = *param_2;
  auVar1 = auVar1 * auVar11 + ZEXT816(0);
  uVar25 = auVar1._8_8_;
  *param_1 = auVar1._0_8_;
  auVar2._8_8_ = 0;
  auVar2._0_8_ = param_2[1];
  auVar12._8_8_ = 0;
  auVar12._0_8_ = *param_2;
  uVar26 = SUB168(auVar2 * auVar12,8);
  uVar24 = SUB168(auVar2 * auVar12,0);
  param_1[1] = uVar25 + uVar24 * 2;
  auVar21._8_8_ = 0;
  auVar21._0_8_ = uVar26 * 2 + (ulong)CARRY8(uVar24,uVar24) + (ulong)CARRY8(uVar25,uVar24 * 2);
  auVar3._8_8_ = 0;
  auVar3._0_8_ = param_2[1];
  auVar13._8_8_ = 0;
  auVar13._0_8_ = param_2[1];
  auVar21 = auVar3 * auVar13 + auVar21;
  uVar31 = auVar21._0_8_;
  uVar25 = auVar21._8_8_;
  uVar29 = CARRY8(uVar26,uVar26) + uVar25;
  auVar4._8_8_ = 0;
  auVar4._0_8_ = param_2[2];
  auVar14._8_8_ = 0;
  auVar14._0_8_ = *param_2;
  uVar27 = SUB168(auVar4 * auVar14,8);
  uVar24 = SUB168(auVar4 * auVar14,0);
  uVar28 = uVar27 * 2 + (ulong)CARRY8(uVar24,uVar24) + (ulong)CARRY8(uVar31,uVar24 * 2);
  param_1[2] = uVar31 + uVar24 * 2;
  uVar31 = uVar29 + uVar28;
  uVar29 = (ulong)CARRY8((ulong)CARRY8(uVar26,uVar26),uVar25) + (ulong)CARRY8(uVar27,uVar27) +
           (ulong)CARRY8(uVar29,uVar28);
  auVar5._8_8_ = 0;
  auVar5._0_8_ = param_2[3];
  auVar15._8_8_ = 0;
  auVar15._0_8_ = *param_2;
  uVar25 = SUB168(auVar5 * auVar15,8);
  uVar24 = SUB168(auVar5 * auVar15,0);
  uVar30 = uVar31 + uVar24 * 2;
  uVar26 = uVar25 * 2 + (ulong)CARRY8(uVar24,uVar24) + (ulong)CARRY8(uVar31,uVar24 * 2);
  uVar31 = uVar29 + uVar26;
  auVar6._8_8_ = 0;
  auVar6._0_8_ = param_2[2];
  auVar16._8_8_ = 0;
  auVar16._0_8_ = param_2[1];
  uVar27 = SUB168(auVar6 * auVar16,8);
  uVar24 = SUB168(auVar6 * auVar16,0);
  uVar28 = uVar27 * 2 + (ulong)CARRY8(uVar24,uVar24) + (ulong)CARRY8(uVar30,uVar24 * 2);
  param_1[3] = uVar30 + uVar24 * 2;
  auVar22._8_8_ = 0;
  auVar22._0_8_ = uVar31 + uVar28;
  uVar29 = (ulong)CARRY8(uVar25,uVar25) + (ulong)CARRY8(uVar29,uVar26) +
           (ulong)CARRY8(uVar27,uVar27) + (ulong)CARRY8(uVar31,uVar28);
  auVar7._8_8_ = 0;
  auVar7._0_8_ = param_2[2];
  auVar17._8_8_ = 0;
  auVar17._0_8_ = param_2[2];
  auVar22 = auVar7 * auVar17 + auVar22;
  uVar28 = auVar22._0_8_;
  uVar25 = auVar22._8_8_;
  uVar31 = uVar29 + uVar25;
  auVar8._8_8_ = 0;
  auVar8._0_8_ = param_2[3];
  auVar18._8_8_ = 0;
  auVar18._0_8_ = param_2[1];
  uVar26 = SUB168(auVar8 * auVar18,8);
  uVar24 = SUB168(auVar8 * auVar18,0);
  uVar27 = uVar26 * 2 + (ulong)CARRY8(uVar24,uVar24) + (ulong)CARRY8(uVar28,uVar24 * 2);
  uVar30 = uVar31 + uVar27;
  uVar27 = (ulong)CARRY8(uVar29,uVar25) + (ulong)CARRY8(uVar26,uVar26) +
           (ulong)CARRY8(uVar31,uVar27);
  param_1[4] = uVar28 + uVar24 * 2;
  auVar9._8_8_ = 0;
  auVar9._0_8_ = param_2[3];
  auVar19._8_8_ = 0;
  auVar19._0_8_ = param_2[2];
  uVar25 = SUB168(auVar9 * auVar19,8);
  uVar24 = SUB168(auVar9 * auVar19,0);
  uVar26 = uVar25 * 2 + (ulong)CARRY8(uVar24,uVar24) + (ulong)CARRY8(uVar30,uVar24 * 2);
  auVar23._8_8_ = (ulong)CARRY8(uVar25,uVar25) + (ulong)CARRY8(uVar27,uVar26);
  auVar23._0_8_ = uVar27 + uVar26;
  param_1[5] = uVar30 + uVar24 * 2;
  auVar10._8_8_ = 0;
  auVar10._0_8_ = param_2[3];
  auVar20._8_8_ = 0;
  auVar20._0_8_ = param_2[3];
  *(undefined1 (*) [16])(param_1 + 6) = auVar10 * auVar20 + auVar23;
  return;
}



BIO * BIO_new(BIO_METHOD *type)

{
  int iVar1;
  BIO *obj;
  
  obj = (BIO *)CRYPTO_malloc(0x70,"bio_lib.c",0x46);
  if (obj == (BIO *)0x0) {
    ERR_put_error(0x20,0x6c,0x41,"bio_lib.c",0x49);
    obj = (BIO *)0x0;
  }
  else {
    obj->method = type;
    obj->callback = (_func_603 *)0x0;
    obj->cb_arg = (char *)0x0;
    obj->init = 0;
    obj->shutdown = 1;
    obj->flags = 0;
    obj->retry_reason = 0;
    obj->num = 0;
    obj->ptr = (void *)0x0;
    obj->prev_bio = (bio_st *)0x0;
    obj->next_bio = (bio_st *)0x0;
    obj->references = 1;
    obj->num_read = 0;
    obj->num_write = 0;
    CRYPTO_new_ex_data(0,obj,&obj->ex_data);
    if ((type->create != (_func_600 *)0x0) && (iVar1 = (*type->create)(obj), iVar1 == 0)) {
      CRYPTO_free_ex_data(0,obj,&obj->ex_data);
      CRYPTO_free(obj);
      return (BIO *)0x0;
    }
  }
  return obj;
}



int BIO_set(BIO *a,BIO_METHOD *type)

{
  int iVar1;
  
  a->method = type;
  a->callback = (_func_603 *)0x0;
  a->cb_arg = (char *)0x0;
  a->init = 0;
  a->shutdown = 1;
  a->flags = 0;
  a->retry_reason = 0;
  a->num = 0;
  a->ptr = (void *)0x0;
  a->prev_bio = (bio_st *)0x0;
  a->next_bio = (bio_st *)0x0;
  a->references = 1;
  a->num_read = 0;
  a->num_write = 0;
  CRYPTO_new_ex_data(0,a,&a->ex_data);
  if (type->create != (_func_600 *)0x0) {
    iVar1 = (*type->create)(a);
    if (iVar1 == 0) {
      CRYPTO_free_ex_data(0,a,&a->ex_data);
      return 0;
    }
  }
  return 1;
}



int BIO_free(BIO *a)

{
  _func_601 *p_Var1;
  int iVar2;
  long lVar3;
  
  iVar2 = 0;
  if (a != (BIO *)0x0) {
    iVar2 = CRYPTO_add_lock(&a->references,-1,0x15,"bio_lib.c",0x75);
    if (iVar2 < 1) {
      if (a->callback != (_func_603 *)0x0) {
        lVar3 = (*a->callback)(a,1,(char *)0x0,0,0,1);
        if ((int)lVar3 < 1) {
          return (int)lVar3;
        }
      }
      CRYPTO_free_ex_data(0,a,&a->ex_data);
      if ((a->method != (BIO_METHOD *)0x0) &&
         (p_Var1 = a->method->destroy, p_Var1 != (_func_601 *)0x0)) {
        (*p_Var1)(a);
        CRYPTO_free(a);
        return 1;
      }
    }
    iVar2 = 1;
  }
  return iVar2;
}



void BIO_vfree(BIO *a)

{
  _func_601 *p_Var1;
  int iVar2;
  long lVar3;
  
  if ((a != (BIO *)0x0) &&
     (iVar2 = CRYPTO_add_lock(&a->references,-1,0x15,"bio_lib.c",0x75), iVar2 < 1)) {
    if ((a->callback != (_func_603 *)0x0) &&
       (lVar3 = (*a->callback)(a,1,(char *)0x0,0,0,1), (int)lVar3 < 1)) {
      return;
    }
    CRYPTO_free_ex_data(0,a,&a->ex_data);
    if ((a->method != (BIO_METHOD *)0x0) &&
       (p_Var1 = a->method->destroy, p_Var1 != (_func_601 *)0x0)) {
      (*p_Var1)(a);
      CRYPTO_free(a);
      return;
    }
  }
  return;
}



void BIO_clear_flags(BIO *b,int flags)

{
  b->flags = b->flags & ~flags;
  return;
}



int BIO_test_flags(BIO *b,int flags)

{
  return b->flags & flags;
}



void BIO_set_flags(BIO *b,int flags)

{
  b->flags = b->flags | flags;
  return;
}



long BIO_get_callback(bio_st *param_1,int param_2,char *param_3,int param_4,long param_5,
                     long param_6)

{
  return (long)param_1->callback;
}



void BIO_set_callback(BIO *b,callback *callback)

{
  b->callback = (_func_603 *)callback;
  return;
}



void BIO_set_callback_arg(BIO *b,char *arg)

{
  b->cb_arg = arg;
  return;
}



char * BIO_get_callback_arg(BIO *b)

{
  return b->cb_arg;
}



char * BIO_method_name(BIO *b)

{
  return b->method->name;
}



int BIO_method_type(BIO *b)

{
  return b->method->type;
}



int BIO_read(BIO *b,void *data,int len)

{
  _func_603 *p_Var1;
  int iVar2;
  long lVar3;
  
  if (((b == (BIO *)0x0) || (b->method == (BIO_METHOD *)0x0)) ||
     (b->method->bread == (_func_596 *)0x0)) {
    ERR_put_error(0x20,0x6f,0x79,"bio_lib.c",0xc5);
    iVar2 = -2;
  }
  else {
    p_Var1 = b->callback;
    if (p_Var1 != (_func_603 *)0x0) {
      lVar3 = (*p_Var1)(b,2,(char *)data,len,0,1);
      if ((int)lVar3 < 1) {
        return (int)lVar3;
      }
    }
    if (b->init == 0) {
      ERR_put_error(0x20,0x6f,0x78,"bio_lib.c",0xd0);
      iVar2 = -2;
    }
    else {
      iVar2 = (*b->method->bread)(b,(char *)data,len);
      if (0 < iVar2) {
        b->num_read = b->num_read + (long)iVar2;
      }
      if (p_Var1 != (_func_603 *)0x0) {
        lVar3 = (*p_Var1)(b,0x82,(char *)data,len,0,(long)iVar2);
        iVar2 = (int)lVar3;
      }
    }
  }
  return iVar2;
}



int BIO_write(BIO *b,void *data,int len)

{
  _func_603 *p_Var1;
  int iVar2;
  long lVar3;
  
  if (b == (BIO *)0x0) {
    return 0;
  }
  p_Var1 = b->callback;
  if ((b->method == (BIO_METHOD *)0x0) || (b->method->bwrite == (_func_595 *)0x0)) {
    ERR_put_error(0x20,0x71,0x79,"bio_lib.c",0xe9);
    iVar2 = -2;
  }
  else {
    if (p_Var1 != (_func_603 *)0x0) {
      lVar3 = (*p_Var1)(b,3,(char *)data,len,0,1);
      if ((int)lVar3 < 1) {
        return (int)lVar3;
      }
    }
    if (b->init == 0) {
      ERR_put_error(0x20,0x71,0x78,"bio_lib.c",0xf3);
      iVar2 = -2;
    }
    else {
      iVar2 = (*b->method->bwrite)(b,(char *)data,len);
      if (0 < iVar2) {
        b->num_write = b->num_write + (long)iVar2;
      }
      if (p_Var1 != (_func_603 *)0x0) {
        lVar3 = (*p_Var1)(b,0x83,(char *)data,len,0,(long)iVar2);
        iVar2 = (int)lVar3;
      }
    }
  }
  return iVar2;
}



int BIO_puts(BIO *bp,char *buf)

{
  _func_603 *p_Var1;
  int iVar2;
  long lVar3;
  
  if (((bp == (BIO *)0x0) || (bp->method == (BIO_METHOD *)0x0)) ||
     (bp->method->bputs == (_func_597 *)0x0)) {
    ERR_put_error(0x20,0x6e,0x79,"bio_lib.c",0x108);
    iVar2 = -2;
  }
  else {
    p_Var1 = bp->callback;
    if (p_Var1 != (_func_603 *)0x0) {
      lVar3 = (*p_Var1)(bp,4,buf,0,0,1);
      if ((int)lVar3 < 1) {
        return (int)lVar3;
      }
    }
    if (bp->init == 0) {
      ERR_put_error(0x20,0x6e,0x78,"bio_lib.c",0x114);
      iVar2 = -2;
    }
    else {
      iVar2 = (*bp->method->bputs)(bp,buf);
      if (0 < iVar2) {
        bp->num_write = bp->num_write + (long)iVar2;
      }
      if (p_Var1 != (_func_603 *)0x0) {
        lVar3 = (*p_Var1)(bp,0x84,buf,0,0,(long)iVar2);
        iVar2 = (int)lVar3;
      }
    }
  }
  return iVar2;
}



int BIO_gets(BIO *bp,char *buf,int size)

{
  _func_603 *p_Var1;
  int iVar2;
  long lVar3;
  
  if (((bp == (BIO *)0x0) || (bp->method == (BIO_METHOD *)0x0)) ||
     (bp->method->bgets == (_func_598 *)0x0)) {
    ERR_put_error(0x20,0x68,0x79,"bio_lib.c",0x129);
    iVar2 = -2;
  }
  else {
    p_Var1 = bp->callback;
    if (p_Var1 != (_func_603 *)0x0) {
      lVar3 = (*p_Var1)(bp,5,buf,size,0,1);
      if ((int)lVar3 < 1) {
        return (int)lVar3;
      }
    }
    if (bp->init == 0) {
      ERR_put_error(0x20,0x68,0x78,"bio_lib.c",0x135);
      iVar2 = -2;
    }
    else {
      iVar2 = (*bp->method->bgets)(bp,buf,size);
      if (p_Var1 != (_func_603 *)0x0) {
        lVar3 = (*p_Var1)(bp,0x85,buf,size,0,(long)iVar2);
        iVar2 = (int)lVar3;
      }
    }
  }
  return iVar2;
}



int BIO_indent(BIO *b,int indent,int max)

{
  _func_603 *p_Var1;
  int iVar2;
  long lVar3;
  
  iVar2 = 0;
  if (-1 < indent) {
    iVar2 = indent;
  }
  if (iVar2 <= max) {
    max = iVar2;
  }
  do {
    if (max == 0) {
      return 1;
    }
    if (((b == (BIO *)0x0) || (b->method == (BIO_METHOD *)0x0)) ||
       (b->method->bputs == (_func_597 *)0x0)) {
      ERR_put_error(0x20,0x6e,0x79,"bio_lib.c",0x108);
      return 0;
    }
    p_Var1 = b->callback;
    if ((p_Var1 != (_func_603 *)0x0) && (lVar3 = (*p_Var1)(b,4," ",0,0,1), (int)lVar3 < 1)) {
      return 0;
    }
    if (b->init == 0) {
      ERR_put_error(0x20,0x6e,0x78,"bio_lib.c",0x114);
      return 0;
    }
    iVar2 = (*b->method->bputs)(b," ");
    if (0 < iVar2) {
      b->num_write = b->num_write + (long)iVar2;
    }
    if (p_Var1 != (_func_603 *)0x0) {
      lVar3 = (*p_Var1)(b,0x84," ",0,0,(long)iVar2);
      iVar2 = (int)lVar3;
    }
    max = max + -1;
  } while (iVar2 == 1);
  return 0;
}



long BIO_int_ctrl(BIO *bp,int cmd,long larg,int iarg)

{
  _func_599 *p_Var1;
  _func_603 *p_Var2;
  long lVar3;
  int local_38 [6];
  
  if (bp == (BIO *)0x0) {
    return 0;
  }
  local_38[0] = iarg;
  if ((bp->method == (BIO_METHOD *)0x0) || (p_Var1 = bp->method->ctrl, p_Var1 == (_func_599 *)0x0))
  {
    ERR_put_error(0x20,0x67,0x79,"bio_lib.c",0x168);
    lVar3 = -2;
  }
  else {
    p_Var2 = bp->callback;
    if (p_Var2 == (_func_603 *)0x0) {
      lVar3 = (*p_Var1)(bp,cmd,larg,local_38);
      return lVar3;
    }
    lVar3 = (*p_Var2)(bp,6,(char *)local_38,cmd,larg,1);
    if (0 < lVar3) {
      lVar3 = (*bp->method->ctrl)(bp,cmd,larg,local_38);
      lVar3 = (*p_Var2)(bp,0x86,(char *)local_38,cmd,larg,lVar3);
    }
  }
  return lVar3;
}



char * BIO_ptr_ctrl(BIO *bp,int cmd,long larg)

{
  _func_599 *p_Var1;
  _func_603 *p_Var2;
  long lVar3;
  char *local_38 [3];
  
  local_38[0] = (char *)0x0;
  if (bp != (BIO *)0x0) {
    if ((bp->method == (BIO_METHOD *)0x0) || (p_Var1 = bp->method->ctrl, p_Var1 == (_func_599 *)0x0)
       ) {
      ERR_put_error(0x20,0x67,0x79,"bio_lib.c",0x168);
    }
    else {
      p_Var2 = bp->callback;
      if (p_Var2 == (_func_603 *)0x0) {
        lVar3 = (*p_Var1)(bp,cmd,larg,local_38);
      }
      else {
        lVar3 = (*p_Var2)(bp,6,(char *)local_38,cmd,larg,1);
        if (lVar3 < 1) {
          return (char *)0x0;
        }
        lVar3 = (*bp->method->ctrl)(bp,cmd,larg,local_38);
        lVar3 = (*p_Var2)(bp,0x86,(char *)local_38,cmd,larg,lVar3);
      }
      if (0 < lVar3) {
        return local_38[0];
      }
    }
  }
  return (char *)0x0;
}



long BIO_ctrl(BIO *bp,int cmd,long larg,void *parg)

{
  _func_599 *UNRECOVERED_JUMPTABLE;
  _func_603 *UNRECOVERED_JUMPTABLE_00;
  long lVar1;
  
  if (bp == (BIO *)0x0) {
    return 0;
  }
  if ((bp->method == (BIO_METHOD *)0x0) ||
     (UNRECOVERED_JUMPTABLE = bp->method->ctrl, UNRECOVERED_JUMPTABLE == (_func_599 *)0x0)) {
    ERR_put_error(0x20,0x67,0x79,"bio_lib.c",0x168);
    lVar1 = -2;
  }
  else {
    UNRECOVERED_JUMPTABLE_00 = bp->callback;
    if (UNRECOVERED_JUMPTABLE_00 == (_func_603 *)0x0) {
                    // WARNING: Could not recover jumptable at 0x004990f8. Too many branches
                    // WARNING: Treating indirect jump as call
      lVar1 = (*UNRECOVERED_JUMPTABLE)(bp,cmd,larg,parg);
      return lVar1;
    }
    lVar1 = (*UNRECOVERED_JUMPTABLE_00)(bp,6,(char *)parg,cmd,larg,1);
    if (0 < lVar1) {
      lVar1 = (*bp->method->ctrl)(bp,cmd,larg,parg);
                    // WARNING: Could not recover jumptable at 0x004990b6. Too many branches
                    // WARNING: Treating indirect jump as call
      lVar1 = (*UNRECOVERED_JUMPTABLE_00)(bp,0x86,(char *)parg,cmd,larg,lVar1);
      return lVar1;
    }
  }
  return lVar1;
}



long BIO_callback_ctrl(BIO *b,int cmd,fp *fp)

{
  _func_602 *p_Var1;
  _func_603 *p_Var2;
  long lVar3;
  fp *local_20;
  
  if (b == (BIO *)0x0) {
    return 0;
  }
  local_20 = fp;
  if ((b->method == (BIO_METHOD *)0x0) ||
     (p_Var1 = b->method->callback_ctrl, p_Var1 == (_func_602 *)0x0)) {
    ERR_put_error(0x20,0x83,0x79,"bio_lib.c",0x183);
    lVar3 = -2;
  }
  else {
    p_Var2 = b->callback;
    if (p_Var2 == (_func_603 *)0x0) {
      lVar3 = (*p_Var1)(b,cmd,fp);
      return lVar3;
    }
    lVar3 = (*p_Var2)(b,6,(char *)&local_20,cmd,0,1);
    if (0 < lVar3) {
      lVar3 = (*b->method->callback_ctrl)(b,cmd,local_20);
      lVar3 = (*p_Var2)(b,0x86,(char *)&local_20,cmd,0,lVar3);
    }
  }
  return lVar3;
}



size_t BIO_ctrl_pending(BIO *b)

{
  _func_599 *UNRECOVERED_JUMPTABLE;
  _func_603 *UNRECOVERED_JUMPTABLE_00;
  size_t sVar1;
  long lVar2;
  
  if (b == (BIO *)0x0) {
    return 0;
  }
  if ((b->method == (BIO_METHOD *)0x0) ||
     (UNRECOVERED_JUMPTABLE = b->method->ctrl, UNRECOVERED_JUMPTABLE == (_func_599 *)0x0)) {
    ERR_put_error(0x20,0x67,0x79,"bio_lib.c",0x168);
    sVar1 = 0xfffffffffffffffe;
  }
  else {
    UNRECOVERED_JUMPTABLE_00 = b->callback;
    if (UNRECOVERED_JUMPTABLE_00 == (_func_603 *)0x0) {
                    // WARNING: Could not recover jumptable at 0x0049929f. Too many branches
                    // WARNING: Treating indirect jump as call
      sVar1 = (*UNRECOVERED_JUMPTABLE)(b,10,0,(void *)0x0);
      return sVar1;
    }
    sVar1 = (*UNRECOVERED_JUMPTABLE_00)(b,6,(char *)0x0,10,0,1);
    if (0 < (long)sVar1) {
      lVar2 = (*b->method->ctrl)(b,10,0,(void *)0x0);
                    // WARNING: Could not recover jumptable at 0x0049925c. Too many branches
                    // WARNING: Treating indirect jump as call
      sVar1 = (*UNRECOVERED_JUMPTABLE_00)(b,0x86,(char *)0x0,10,0,lVar2);
      return sVar1;
    }
  }
  return sVar1;
}



size_t BIO_ctrl_wpending(BIO *b)

{
  _func_599 *UNRECOVERED_JUMPTABLE;
  _func_603 *UNRECOVERED_JUMPTABLE_00;
  size_t sVar1;
  long lVar2;
  
  if (b == (BIO *)0x0) {
    return 0;
  }
  if ((b->method == (BIO_METHOD *)0x0) ||
     (UNRECOVERED_JUMPTABLE = b->method->ctrl, UNRECOVERED_JUMPTABLE == (_func_599 *)0x0)) {
    ERR_put_error(0x20,0x67,0x79,"bio_lib.c",0x168);
    sVar1 = 0xfffffffffffffffe;
  }
  else {
    UNRECOVERED_JUMPTABLE_00 = b->callback;
    if (UNRECOVERED_JUMPTABLE_00 == (_func_603 *)0x0) {
                    // WARNING: Could not recover jumptable at 0x0049937f. Too many branches
                    // WARNING: Treating indirect jump as call
      sVar1 = (*UNRECOVERED_JUMPTABLE)(b,0xd,0,(void *)0x0);
      return sVar1;
    }
    sVar1 = (*UNRECOVERED_JUMPTABLE_00)(b,6,(char *)0x0,0xd,0,1);
    if (0 < (long)sVar1) {
      lVar2 = (*b->method->ctrl)(b,0xd,0,(void *)0x0);
                    // WARNING: Could not recover jumptable at 0x0049933c. Too many branches
                    // WARNING: Treating indirect jump as call
      sVar1 = (*UNRECOVERED_JUMPTABLE_00)(b,0x86,(char *)0x0,0xd,0,lVar2);
      return sVar1;
    }
  }
  return sVar1;
}



BIO * BIO_push(BIO *b,BIO *append)

{
  _func_599 *p_Var1;
  _func_603 *p_Var2;
  BIO *pBVar3;
  long lVar4;
  bio_st *pbVar5;
  
  pBVar3 = b;
  if (b == (BIO *)0x0) {
    return append;
  }
  do {
    pbVar5 = pBVar3;
    pBVar3 = pbVar5->next_bio;
  } while (pbVar5->next_bio != (bio_st *)0x0);
  pbVar5->next_bio = append;
  if (append != (BIO *)0x0) {
    append->prev_bio = pbVar5;
  }
  if ((b->method != (BIO_METHOD *)0x0) && (p_Var1 = b->method->ctrl, p_Var1 != (_func_599 *)0x0)) {
    p_Var2 = b->callback;
    if (p_Var2 == (_func_603 *)0x0) {
      (*p_Var1)(b,6,0,pbVar5);
    }
    else {
      lVar4 = (*p_Var2)(b,6,(char *)pbVar5,6,0,1);
      if (0 < lVar4) {
        lVar4 = (*b->method->ctrl)(b,6,0,pbVar5);
        (*p_Var2)(b,0x86,(char *)pbVar5,6,0,lVar4);
        return b;
      }
    }
    return b;
  }
  ERR_put_error(0x20,0x67,0x79,"bio_lib.c",0x168);
  return b;
}



BIO * BIO_pop(BIO *b)

{
  _func_599 *p_Var1;
  _func_603 *p_Var2;
  bio_st *pbVar3;
  long lVar4;
  BIO *pBVar5;
  
  if (b == (BIO *)0x0) {
    pBVar5 = (BIO *)0x0;
  }
  else {
    pBVar5 = b->next_bio;
    if ((b->method == (BIO_METHOD *)0x0) || (p_Var1 = b->method->ctrl, p_Var1 == (_func_599 *)0x0))
    {
      ERR_put_error(0x20,0x67,0x79,"bio_lib.c",0x168);
    }
    else {
      p_Var2 = b->callback;
      if (p_Var2 == (_func_603 *)0x0) {
        (*p_Var1)(b,7,0,b);
      }
      else {
        lVar4 = (*p_Var2)(b,6,(char *)b,7,0,1);
        if (0 < lVar4) {
          lVar4 = (*b->method->ctrl)(b,7,0,b);
          (*p_Var2)(b,0x86,(char *)b,7,0,lVar4);
        }
      }
    }
    pbVar3 = b->prev_bio;
    if (pbVar3 != (bio_st *)0x0) {
      pbVar3->next_bio = b->next_bio;
    }
    if (b->next_bio != (bio_st *)0x0) {
      b->next_bio->prev_bio = pbVar3;
    }
    b->next_bio = (bio_st *)0x0;
    b->prev_bio = (bio_st *)0x0;
  }
  return pBVar5;
}



BIO * BIO_get_retry_BIO(BIO *bio,int *reason)

{
  bio_st **ppbVar1;
  BIO *pBVar2;
  
  pBVar2 = bio;
  do {
    if ((pBVar2->flags & 8) == 0) break;
    ppbVar1 = &pBVar2->next_bio;
    bio = pBVar2;
    pBVar2 = *ppbVar1;
  } while (*ppbVar1 != (bio_st *)0x0);
  if (reason != (int *)0x0) {
    *reason = bio->retry_reason;
  }
  return bio;
}



int BIO_get_retry_reason(BIO *bio)

{
  return bio->retry_reason;
}



BIO * BIO_find_type(BIO *b,int bio_type)

{
  if (b != (BIO *)0x0) {
    if ((char)bio_type == '\0') {
      while ((b->method == (BIO_METHOD *)0x0 || ((b->method->type & bio_type) == 0))) {
        b = b->next_bio;
        if (b == (bio_st *)0x0) {
          return (BIO *)0x0;
        }
      }
      return b;
    }
    do {
      if ((b->method != (BIO_METHOD *)0x0) && (b->method->type == bio_type)) {
        return b;
      }
      b = b->next_bio;
    } while (b != (bio_st *)0x0);
  }
  return (BIO *)0x0;
}



BIO * BIO_next(BIO *b)

{
  if (b != (BIO *)0x0) {
    return b->next_bio;
  }
  return (BIO *)0x0;
}



void BIO_free_all(BIO *a)

{
  int iVar1;
  bio_st *pbVar2;
  _func_601 *p_Var3;
  int iVar4;
  long lVar5;
  
  if (a != (BIO *)0x0) {
    do {
      iVar1 = a->references;
      pbVar2 = a->next_bio;
      iVar4 = CRYPTO_add_lock(&a->references,-1,0x15,"bio_lib.c",0x75);
      if ((iVar4 < 1) &&
         ((a->callback == (_func_603 *)0x0 ||
          (lVar5 = (*a->callback)(a,1,(char *)0x0,0,0,1), 0 < (int)lVar5)))) {
        CRYPTO_free_ex_data(0,a,&a->ex_data);
        if ((a->method != (BIO_METHOD *)0x0) &&
           (p_Var3 = a->method->destroy, p_Var3 != (_func_601 *)0x0)) {
          (*p_Var3)(a);
          CRYPTO_free(a);
        }
      }
    } while ((iVar1 < 2) && (a = pbVar2, pbVar2 != (bio_st *)0x0));
  }
  return;
}



BIO * BIO_dup_chain(BIO *in)

{
  CRYPTO_EX_DATA *ad;
  BIO_METHOD *pBVar1;
  _func_600 *p_Var2;
  _func_601 *p_Var3;
  BIO *pBVar4;
  int iVar5;
  BIO *obj;
  long lVar6;
  bio_st *parg;
  BIO *bp;
  BIO *obj_00;
  
  obj_00 = (bio_st *)0x0;
  bp = (BIO *)0x0;
  if (in != (BIO *)0x0) {
    while( true ) {
      pBVar1 = in->method;
      obj = (BIO *)CRYPTO_malloc(0x70,"bio_lib.c",0x46);
      if (obj == (BIO *)0x0) break;
      ad = &obj->ex_data;
      obj->method = pBVar1;
      obj->callback = (_func_603 *)0x0;
      obj->cb_arg = (char *)0x0;
      obj->init = 0;
      obj->shutdown = 1;
      obj->flags = 0;
      obj->retry_reason = 0;
      obj->num = 0;
      obj->ptr = (void *)0x0;
      obj->prev_bio = (bio_st *)0x0;
      obj->next_bio = (bio_st *)0x0;
      obj->references = 1;
      obj->num_read = 0;
      obj->num_write = 0;
      CRYPTO_new_ex_data(0,obj,ad);
      p_Var2 = pBVar1->create;
      if ((p_Var2 != (_func_600 *)0x0) && (iVar5 = (*p_Var2)(obj), iVar5 == 0)) {
        CRYPTO_free_ex_data(0,obj,ad);
        CRYPTO_free(obj);
        goto LAB_004998bd;
      }
      obj->callback = in->callback;
      obj->cb_arg = in->cb_arg;
      obj->init = in->init;
      obj->shutdown = in->shutdown;
      obj->flags = in->flags;
      obj->num = in->num;
      lVar6 = BIO_ctrl(in,0xc,0,obj);
      if (lVar6 == 0) {
        iVar5 = CRYPTO_add_lock(&obj->references,-1,0x15,"bio_lib.c",0x75);
        if ((iVar5 < 1) &&
           ((obj->callback == (_func_603 *)0x0 ||
            (lVar6 = (*obj->callback)(obj,1,(char *)0x0,0,0,1), 0 < (int)lVar6)))) {
          CRYPTO_free_ex_data(0,obj,ad);
          if ((obj->method != (BIO_METHOD *)0x0) &&
             (p_Var3 = obj->method->destroy, p_Var3 != (_func_601 *)0x0)) {
            (*p_Var3)(obj);
            CRYPTO_free(obj);
          }
        }
        goto LAB_004998bd;
      }
      iVar5 = CRYPTO_dup_ex_data(0,ad,&in->ex_data);
      if (iVar5 == 0) goto LAB_004998bd;
      if (obj_00 == (bio_st *)0x0) {
        in = in->next_bio;
        obj_00 = obj;
      }
      else {
        pBVar4 = bp;
        if (bp != (BIO *)0x0) {
          do {
            parg = pBVar4;
            pBVar4 = parg->next_bio;
          } while (parg->next_bio != (bio_st *)0x0);
          parg->next_bio = obj;
          obj->prev_bio = parg;
          BIO_ctrl(bp,6,0,parg);
        }
        in = in->next_bio;
      }
      bp = obj;
      if (in == (bio_st *)0x0) {
        return obj_00;
      }
    }
    ERR_put_error(0x20,0x6c,0x41,"bio_lib.c",0x49);
LAB_004998bd:
    if (((obj_00 != (bio_st *)0x0) &&
        (iVar5 = CRYPTO_add_lock(&obj_00->references,-1,0x15,"bio_lib.c",0x75), iVar5 < 1)) &&
       ((obj_00->callback == (_func_603 *)0x0 ||
        (lVar6 = (*obj_00->callback)(obj_00,1,(char *)0x0,0,0,1), 0 < (int)lVar6)))) {
      CRYPTO_free_ex_data(0,obj_00,&obj_00->ex_data);
      if ((obj_00->method != (BIO_METHOD *)0x0) &&
         (p_Var3 = obj_00->method->destroy, p_Var3 != (_func_601 *)0x0)) {
        (*p_Var3)(obj_00);
        CRYPTO_free(obj_00);
      }
    }
  }
  return (BIO *)0x0;
}



void BIO_copy_next_retry(BIO *b)

{
  b->flags = b->flags | b->next_bio->flags & 0xfU;
  b->retry_reason = b->next_bio->retry_reason;
  return;
}



int BIO_get_ex_new_index
              (long argl,void *argp,undefined1 *new_func,undefined1 *dup_func,undefined1 *free_func)

{
  int iVar1;
  
  iVar1 = CRYPTO_get_ex_new_index(0,argl,argp,new_func,dup_func,free_func);
  return iVar1;
}



int BIO_set_ex_data(BIO *bio,int idx,void *data)

{
  int iVar1;
  
  iVar1 = CRYPTO_set_ex_data(&bio->ex_data,idx,data);
  return iVar1;
}



void * BIO_get_ex_data(BIO *bio,int idx)

{
  void *pvVar1;
  
  pvVar1 = CRYPTO_get_ex_data(&bio->ex_data,idx);
  return pvVar1;
}



ulong BIO_number_read(BIO *bio)

{
  if (bio != (BIO *)0x0) {
    return bio->num_read;
  }
  return 0;
}



ulong BIO_number_written(BIO *bio)

{
  if (bio != (BIO *)0x0) {
    return bio->num_write;
  }
  return 0;
}



undefined8 file_new(long param_1)

{
  *(undefined4 *)(param_1 + 0x18) = 0;
  *(undefined4 *)(param_1 + 0x28) = 0;
  *(undefined8 *)(param_1 + 0x30) = 0;
  *(undefined4 *)(param_1 + 0x20) = 0;
  return 1;
}



size_t file_gets(long param_1,char *param_2,int param_3)

{
  char *pcVar1;
  size_t sVar2;
  
  *param_2 = '\0';
  pcVar1 = fgets(param_2,param_3,*(FILE **)(param_1 + 0x30));
  sVar2 = 0;
  if ((pcVar1 != (char *)0x0) && (*param_2 != '\0')) {
    sVar2 = strlen(param_2);
  }
  return sVar2;
}



undefined8 file_free(long param_1)

{
  if (param_1 != 0) {
    if (*(int *)(param_1 + 0x1c) != 0) {
      if ((*(int *)(param_1 + 0x18) != 0) && (*(FILE **)(param_1 + 0x30) != (FILE *)0x0)) {
        fclose(*(FILE **)(param_1 + 0x30));
        *(undefined8 *)(param_1 + 0x30) = 0;
        *(undefined4 *)(param_1 + 0x20) = 0;
      }
      *(undefined4 *)(param_1 + 0x18) = 0;
    }
    return 1;
  }
  return 0;
}



ulong file_read(long param_1,void *param_2,int param_3)

{
  int iVar1;
  size_t sVar2;
  int *piVar3;
  ulong uVar4;
  
  uVar4 = 0;
  if ((*(int *)(param_1 + 0x18) != 0) && (param_2 != (void *)0x0)) {
    sVar2 = fread(param_2,1,(long)param_3,*(FILE **)(param_1 + 0x30));
    uVar4 = sVar2 & 0xffffffff;
    iVar1 = ferror(*(FILE **)(param_1 + 0x30));
    if (iVar1 != 0) {
      piVar3 = __errno_location();
      uVar4 = 0xffffffff;
      ERR_put_error(2,0xb,*piVar3,"bss_file.c",0xf5);
      ERR_put_error(0x20,0x82,2,"bss_file.c",0xf6);
    }
  }
  return uVar4;
}



ulong file_puts(long param_1,char *param_2)

{
  size_t sVar1;
  size_t sVar2;
  ulong uVar3;
  
  sVar1 = strlen(param_2);
  uVar3 = 0;
  if ((*(int *)(param_1 + 0x18) != 0) && (param_2 != (char *)0x0)) {
    sVar2 = fwrite(param_2,(long)(int)sVar1,1,*(FILE **)(param_1 + 0x30));
    uVar3 = sVar2 & 0xffffffff;
    if ((int)sVar2 != 0) {
      uVar3 = sVar1 & 0xffffffff;
    }
  }
  return uVar3;
}



ulong file_write(long param_1,void *param_2,uint param_3)

{
  size_t sVar1;
  ulong uVar2;
  
  uVar2 = 0;
  if ((*(int *)(param_1 + 0x18) != 0) && (param_2 != (void *)0x0)) {
    sVar1 = fwrite(param_2,(long)(int)param_3,1,*(FILE **)(param_1 + 0x30));
    uVar2 = sVar1 & 0xffffffff;
    if ((int)sVar1 != 0) {
      uVar2 = (ulong)param_3;
    }
  }
  return uVar2;
}



long file_ctrl(BIO *param_1,int param_2,ulong param_3,char *param_4)

{
  int iVar1;
  FILE *pFVar2;
  long lVar3;
  int *piVar4;
  uint uVar5;
  char acStack_28 [16];
  
  pFVar2 = (FILE *)param_1->ptr;
  if (param_2 == 0xb) {
    fflush(pFVar2);
    return 1;
  }
  uVar5 = (uint)param_3;
  if (param_2 < 0xc) {
    if (param_2 == 3) {
LAB_00499eb0:
      lVar3 = ftell(pFVar2);
      return lVar3;
    }
    if (param_2 < 4) {
      if (param_2 == 1) goto LAB_00499e60;
      if (param_2 == 2) {
        iVar1 = feof(pFVar2);
        return (long)iVar1;
      }
    }
    else {
      if (param_2 == 8) {
        return (long)param_1->shutdown;
      }
      if (param_2 == 9) {
        param_1->shutdown = uVar5;
        return 1;
      }
    }
  }
  else {
    if (param_2 == 0x6b) {
      if (param_4 != (char *)0x0) {
        *(FILE **)param_4 = pFVar2;
        return 1;
      }
      return 1;
    }
    if (param_2 < 0x6c) {
      if (param_2 == 0xc) {
        return 1;
      }
      if (param_2 == 0x6a) {
        if (((param_1->shutdown != 0) && (param_1->init != 0)) && (pFVar2 != (FILE *)0x0)) {
          fclose(pFVar2);
          param_1->flags = 0;
        }
        param_1->ptr = param_4;
        param_1->init = 1;
        param_1->shutdown = uVar5 & 1;
        return 1;
      }
    }
    else {
      if (param_2 == 0x80) {
LAB_00499e60:
        iVar1 = fseek(pFVar2,param_3,0);
        return (long)iVar1;
      }
      if (param_2 == 0x85) goto LAB_00499eb0;
      if (param_2 == 0x6c) {
        if (param_1->shutdown != 0) {
          if ((param_1->init != 0) && (pFVar2 != (FILE *)0x0)) {
            fclose(pFVar2);
            param_1->ptr = (void *)0x0;
            param_1->flags = 0;
          }
          param_1->init = 0;
        }
        param_1->shutdown = uVar5 & 1;
        if ((param_3 & 8) == 0) {
          if ((uVar5 & 6) == 6) {
            BUF_strlcpy(acStack_28,"r+",4);
          }
          else if ((param_3 & 4) == 0) {
            if ((param_3 & 2) == 0) {
              ERR_put_error(0x20,0x74,0x65,"bss_file.c",0x17b);
              return 0;
            }
            BUF_strlcpy(acStack_28,"r",4);
          }
          else {
            BUF_strlcpy(acStack_28,"w",4);
          }
        }
        else if ((param_3 & 2) == 0) {
          BUF_strlcpy(acStack_28,"a",4);
        }
        else {
          BUF_strlcpy(acStack_28,"a+",4);
        }
        pFVar2 = fopen64(param_4,acStack_28);
        if (pFVar2 != (FILE *)0x0) {
          param_1->ptr = pFVar2;
          param_1->init = 1;
          BIO_clear_flags(param_1,0);
          return 1;
        }
        piVar4 = __errno_location();
        ERR_put_error(2,1,*piVar4,"bss_file.c",0x18e);
        ERR_add_error_data(5,"fopen(\'",param_4,&DAT_004e8051,acStack_28,&DAT_004e804e);
        ERR_put_error(0x20,0x74,2,"bss_file.c",400);
        return 0;
      }
    }
  }
  return 0;
}



BIO * BIO_new_file(char *filename,char *mode)

{
  FILE *__stream;
  BIO *b;
  int *piVar1;
  
  __stream = fopen64(filename,mode);
  if (__stream == (FILE *)0x0) {
    piVar1 = __errno_location();
    ERR_put_error(2,1,*piVar1,"bss_file.c",0xa9);
    ERR_add_error_data(5,"fopen(\'",filename,&DAT_004e8051,mode,&DAT_004e804e);
    if (*piVar1 != 2) {
      ERR_put_error(0x20,0x6d,2,"bss_file.c",0xae);
      return (BIO *)0x0;
    }
    ERR_put_error(0x20,0x6d,0x80,"bss_file.c",0xac);
    b = (BIO *)0x0;
  }
  else {
    b = BIO_new((BIO_METHOD *)methods_filep);
    if (b == (BIO *)0x0) {
      fclose(__stream);
      b = (BIO *)0x0;
    }
    else {
      BIO_clear_flags(b,0);
      BIO_ctrl(b,0x6a,1,__stream);
    }
  }
  return b;
}



BIO * BIO_new_fp(FILE *stream,int close_flag)

{
  BIO *b;
  
  b = BIO_new((BIO_METHOD *)methods_filep);
  if (b != (BIO *)0x0) {
    BIO_set_flags(b,0);
    BIO_ctrl(b,0x6a,(long)close_flag,stream);
  }
  return b;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

BIO_METHOD * BIO_s_file(void)

{
  return (BIO_METHOD *)methods_filep;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

void fmtint_constprop_3(long *param_1,ulong *param_2,ulong *param_3,ulong param_4,uint param_5,
                       int param_6,int param_7,uint param_8)

{
  char cVar1;
  bool bVar2;
  size_t sVar3;
  ulong uVar4;
  long lVar5;
  int iVar6;
  int iVar7;
  int iVar8;
  char *pcVar9;
  ulong uVar10;
  char *__s;
  int iVar11;
  uint local_70;
  undefined1 local_5c;
  char local_58 [40];
  
  iVar6 = 0;
  if (-1 < param_7) {
    iVar6 = param_7;
  }
  if ((param_8 & 0x40) == 0) {
    if ((long)param_4 < 0) {
      param_4 = -param_4;
      local_70 = 1;
      bVar2 = true;
      local_5c = 0x2d;
      goto LAB_0049a1d5;
    }
    if ((param_8 & 2) != 0) {
      local_70 = 1;
      bVar2 = true;
      local_5c = 0x2b;
      goto LAB_0049a1d5;
    }
    local_70 = param_8 & 4;
    if (local_70 != 0) {
      local_70 = 1;
      bVar2 = true;
      local_5c = 0x20;
      goto LAB_0049a1d5;
    }
  }
  else {
    local_70 = 0;
  }
  bVar2 = false;
  local_5c = 0;
LAB_0049a1d5:
  __s = "";
  if ((((param_8 & 8) != 0) && (__s = "0", param_5 != 8)) && (__s = "", param_5 == 0x10)) {
    __s = "0x";
  }
  uVar10 = (ulong)param_5;
  pcVar9 = local_58;
  iVar7 = 0;
  if ((param_8 & 0x20) == 0) {
    do {
      iVar11 = iVar7;
      iVar7 = iVar11 + 1;
      *pcVar9 = "0123456789abcdef"[param_4 % uVar10];
      if (param_4 / uVar10 == 0) break;
      param_4 = param_4 / uVar10;
      pcVar9 = pcVar9 + 1;
    } while (iVar7 < 0x1a);
  }
  else {
    do {
      iVar11 = iVar7;
      iVar7 = iVar11 + 1;
      uVar4 = param_4 / uVar10;
      *pcVar9 = "0123456789ABCDEF"[param_4 % uVar10];
      if (0x19 < iVar7) break;
      param_4 = uVar4;
      pcVar9 = pcVar9 + 1;
    } while (uVar4 != 0);
  }
  if (iVar7 == 0x1a) {
    iVar7 = iVar11;
  }
  local_58[iVar7] = '\0';
  sVar3 = strlen(__s);
  iVar11 = iVar6;
  if (iVar6 <= iVar7) {
    iVar11 = iVar7;
  }
  iVar8 = iVar6 - iVar7;
  if (iVar6 - iVar7 < 0) {
    iVar8 = 0;
  }
  iVar11 = ((param_6 - iVar11) - local_70) - (int)sVar3;
  iVar6 = 0;
  if (-1 < iVar11) {
    iVar6 = iVar11;
  }
  if ((param_8 & 0x10) != 0) {
    if (iVar8 < iVar6) {
      iVar8 = iVar6;
    }
    iVar6 = 0;
  }
  if ((param_8 & 1) == 0) {
    if (0 < iVar6) {
      do {
        uVar10 = *param_2;
        if (uVar10 < *param_3) {
          lVar5 = *param_1;
          if (*param_1 == 0) {
            lVar5 = _DAT_00000000;
          }
          *param_2 = uVar10 + 1;
          *(undefined1 *)(lVar5 + uVar10) = 0x20;
        }
        iVar6 = iVar6 + -1;
      } while (iVar6 != 0);
    }
  }
  else {
    iVar6 = -iVar6;
  }
  if ((bVar2) && (uVar10 = *param_2, uVar10 < *param_3)) {
    lVar5 = *param_1;
    if (*param_1 == 0) {
      lVar5 = _DAT_00000000;
    }
    *param_2 = uVar10 + 1;
    *(undefined1 *)(lVar5 + uVar10) = local_5c;
  }
  for (; cVar1 = *__s, cVar1 != '\0'; __s = __s + 1) {
    uVar10 = *param_2;
    if (uVar10 < *param_3) {
      lVar5 = *param_1;
      if (*param_1 == 0) {
        lVar5 = _DAT_00000000;
      }
      *param_2 = uVar10 + 1;
      *(char *)(lVar5 + uVar10) = cVar1;
    }
  }
  for (; iVar8 != 0; iVar8 = iVar8 + -1) {
    uVar10 = *param_2;
    if (uVar10 < *param_3) {
      lVar5 = *param_1;
      if (*param_1 == 0) {
        lVar5 = _DAT_00000000;
      }
      *param_2 = uVar10 + 1;
      *(undefined1 *)(lVar5 + uVar10) = 0x30;
    }
  }
  while (iVar7 != 0) {
    while( true ) {
      iVar7 = iVar7 + -1;
      cVar1 = local_58[iVar7];
      uVar10 = *param_2;
      if (*param_3 <= uVar10) break;
      lVar5 = *param_1;
      if (*param_1 == 0) {
        lVar5 = _DAT_00000000;
      }
      *param_2 = uVar10 + 1;
      *(char *)(lVar5 + uVar10) = cVar1;
      if (iVar7 == 0) goto joined_r0x0049a3a4;
    }
  }
joined_r0x0049a3a4:
  for (; iVar6 != 0; iVar6 = iVar6 + 1) {
    uVar10 = *param_2;
    if (uVar10 < *param_3) {
      lVar5 = *param_1;
      if (*param_1 == 0) {
        lVar5 = _DAT_00000000;
      }
      *param_2 = uVar10 + 1;
      *(undefined1 *)(lVar5 + uVar10) = 0x20;
    }
  }
  return;
}



void fmtint(long *param_1,long *param_2,ulong *param_3,ulong *param_4,ulong param_5,uint param_6,
           int param_7,int param_8,uint param_9)

{
  char cVar1;
  bool bVar2;
  undefined1 uVar3;
  size_t sVar4;
  void *pvVar5;
  long lVar6;
  ulong uVar7;
  int iVar8;
  ulong uVar9;
  int iVar10;
  char *pcVar11;
  uint uVar12;
  int iVar13;
  int iVar14;
  int local_74;
  char *local_70;
  int local_68;
  char local_58 [40];
  
  iVar13 = 0;
  if (-1 < param_8) {
    iVar13 = param_8;
  }
  if ((param_9 & 0x40) == 0) {
    if ((long)param_5 < 0) {
      param_5 = -param_5;
      uVar12 = 1;
      bVar2 = true;
      uVar3 = 0x2d;
    }
    else if ((param_9 & 2) == 0) {
      uVar12 = param_9 & 4;
      if (uVar12 == 0) goto LAB_0049a83d;
      uVar12 = 1;
      bVar2 = true;
      uVar3 = 0x20;
    }
    else {
      uVar12 = 1;
      bVar2 = true;
      uVar3 = 0x2b;
    }
  }
  else {
    uVar12 = 0;
LAB_0049a83d:
    bVar2 = false;
    uVar3 = 0;
  }
  local_70 = "";
  if ((((param_9 & 8) != 0) && (local_70 = "0", param_6 != 8)) && (local_70 = "0x", param_6 != 0x10)
     ) {
    local_70 = "";
  }
  uVar9 = (ulong)param_6;
  pcVar11 = local_58;
  iVar14 = 0;
  if ((param_9 & 0x20) == 0) {
    do {
      iVar10 = iVar14;
      iVar14 = iVar10 + 1;
      *pcVar11 = "0123456789abcdef"[param_5 % uVar9];
      if (param_5 / uVar9 == 0) break;
      param_5 = param_5 / uVar9;
      pcVar11 = pcVar11 + 1;
    } while (iVar14 < 0x1a);
  }
  else {
    do {
      iVar10 = iVar14;
      iVar14 = iVar10 + 1;
      uVar7 = param_5 / uVar9;
      *pcVar11 = "0123456789ABCDEF"[param_5 % uVar9];
      if (0x19 < iVar14) break;
      param_5 = uVar7;
      pcVar11 = pcVar11 + 1;
    } while (uVar7 != 0);
  }
  if (iVar14 == 0x1a) {
    iVar14 = iVar10;
  }
  local_58[iVar14] = '\0';
  sVar4 = strlen(local_70);
  iVar10 = iVar13;
  if (iVar13 <= iVar14) {
    iVar10 = iVar14;
  }
  iVar8 = iVar13 - iVar14;
  if (iVar13 - iVar14 < 0) {
    iVar8 = 0;
  }
  iVar10 = ((param_7 - iVar10) - uVar12) - (int)sVar4;
  iVar13 = 0;
  if (-1 < iVar10) {
    iVar13 = iVar10;
  }
  local_74 = iVar13;
  local_68 = iVar8;
  if (((param_9 & 0x10) != 0) && (local_74 = 0, local_68 = iVar13, iVar13 <= iVar8)) {
    local_68 = iVar8;
  }
  if ((param_9 & 1) == 0) {
    if (0 < local_74) {
      do {
        uVar9 = *param_3;
        if (param_2 == (long *)0x0) {
          if (uVar9 < *param_4) goto LAB_0049aafc;
        }
        else {
          while (uVar7 = *param_4, uVar7 <= uVar9) {
            while (pvVar5 = (void *)*param_2, pvVar5 != (void *)0x0) {
              *param_4 = uVar7 + 0x400;
              pvVar5 = CRYPTO_realloc(pvVar5,(int)(uVar7 + 0x400),"b_print.c",0x2ed);
              uVar9 = *param_3;
              uVar7 = *param_4;
              *param_2 = (long)pvVar5;
              if (uVar9 < uVar7) goto LAB_0049aafc;
            }
            iVar13 = (int)uVar7;
            if (uVar7 == 0) {
              *param_4 = 0x400;
              iVar13 = 0x400;
            }
            pvVar5 = CRYPTO_malloc(iVar13,"b_print.c",0x2e5);
            sVar4 = *param_3;
            uVar9 = 0;
            *param_2 = (long)pvVar5;
            if (sVar4 != 0) {
              memcpy(pvVar5,(void *)*param_1,sVar4);
              uVar9 = *param_3;
            }
            *param_1 = 0;
          }
LAB_0049aafc:
          lVar6 = *param_1;
          if (lVar6 == 0) {
            lVar6 = *param_2;
          }
          *param_3 = uVar9 + 1;
          *(undefined1 *)(lVar6 + uVar9) = 0x20;
        }
        local_74 = local_74 + -1;
      } while (local_74 != 0);
      local_74 = 0;
    }
  }
  else {
    local_74 = -local_74;
  }
  if (bVar2) {
    uVar9 = *param_3;
    if (param_2 == (long *)0x0) {
      if (*param_4 <= uVar9) goto LAB_0049a617;
    }
    else {
      while (uVar7 = *param_4, uVar7 <= uVar9) {
        while (pvVar5 = (void *)*param_2, pvVar5 != (void *)0x0) {
          *param_4 = uVar7 + 0x400;
          pvVar5 = CRYPTO_realloc(pvVar5,(int)(uVar7 + 0x400),"b_print.c",0x2ed);
          uVar9 = *param_3;
          *param_2 = (long)pvVar5;
          uVar7 = *param_4;
          if (uVar9 < uVar7) goto LAB_0049ab7a;
        }
        iVar13 = (int)uVar7;
        if (uVar7 == 0) {
          *param_4 = 0x400;
          iVar13 = 0x400;
        }
        pvVar5 = CRYPTO_malloc(iVar13,"b_print.c",0x2e5);
        sVar4 = *param_3;
        uVar9 = 0;
        *param_2 = (long)pvVar5;
        if (sVar4 != 0) {
          memcpy(pvVar5,(void *)*param_1,sVar4);
          uVar9 = *param_3;
        }
        *param_1 = 0;
      }
    }
LAB_0049ab7a:
    lVar6 = *param_1;
    if (lVar6 == 0) {
      lVar6 = *param_2;
    }
    *param_3 = uVar9 + 1;
    *(undefined1 *)(lVar6 + uVar9) = uVar3;
  }
LAB_0049a617:
  cVar1 = *local_70;
  while (cVar1 != '\0') {
    uVar9 = *param_3;
    if (param_2 == (long *)0x0) {
      if (uVar9 < *param_4) goto LAB_0049a684;
    }
    else {
      while (uVar7 = *param_4, uVar7 <= uVar9) {
        while (pvVar5 = (void *)*param_2, pvVar5 != (void *)0x0) {
          *param_4 = uVar7 + 0x400;
          pvVar5 = CRYPTO_realloc(pvVar5,(int)(uVar7 + 0x400),"b_print.c",0x2ed);
          uVar9 = *param_3;
          uVar7 = *param_4;
          *param_2 = (long)pvVar5;
          if (uVar9 < uVar7) goto LAB_0049a684;
        }
        iVar13 = (int)uVar7;
        if (uVar7 == 0) {
          *param_4 = 0x400;
          iVar13 = 0x400;
        }
        pvVar5 = CRYPTO_malloc(iVar13,"b_print.c",0x2e5);
        sVar4 = *param_3;
        uVar9 = 0;
        *param_2 = (long)pvVar5;
        if (sVar4 != 0) {
          memcpy(pvVar5,(void *)*param_1,sVar4);
          uVar9 = *param_3;
        }
        *param_1 = 0;
      }
LAB_0049a684:
      lVar6 = *param_1;
      if (lVar6 == 0) {
        lVar6 = *param_2;
      }
      *param_3 = uVar9 + 1;
      *(char *)(lVar6 + uVar9) = cVar1;
    }
    local_70 = local_70 + 1;
    cVar1 = *local_70;
  }
  for (; local_68 != 0; local_68 = local_68 + -1) {
    uVar9 = *param_3;
    if (param_2 == (long *)0x0) {
      if (uVar9 < *param_4) goto LAB_0049a70c;
    }
    else {
      while (uVar7 = *param_4, uVar7 <= uVar9) {
        while (pvVar5 = (void *)*param_2, pvVar5 != (void *)0x0) {
          *param_4 = uVar7 + 0x400;
          pvVar5 = CRYPTO_realloc(pvVar5,(int)(uVar7 + 0x400),"b_print.c",0x2ed);
          uVar9 = *param_3;
          uVar7 = *param_4;
          *param_2 = (long)pvVar5;
          if (uVar9 < uVar7) goto LAB_0049a70c;
        }
        iVar13 = (int)uVar7;
        if (uVar7 == 0) {
          *param_4 = 0x400;
          iVar13 = 0x400;
        }
        pvVar5 = CRYPTO_malloc(iVar13,"b_print.c",0x2e5);
        sVar4 = *param_3;
        uVar9 = 0;
        *param_2 = (long)pvVar5;
        if (sVar4 != 0) {
          memcpy(pvVar5,(void *)*param_1,sVar4);
          uVar9 = *param_3;
        }
        *param_1 = 0;
      }
LAB_0049a70c:
      lVar6 = *param_1;
      if (lVar6 == 0) {
        lVar6 = *param_2;
      }
      *param_3 = uVar9 + 1;
      *(undefined1 *)(lVar6 + uVar9) = 0x30;
    }
  }
LAB_0049a730:
  if (iVar14 != 0) {
    do {
      iVar14 = iVar14 + -1;
      uVar9 = *param_3;
      cVar1 = local_58[iVar14];
      if (param_2 == (long *)0x0) {
        if (*param_4 <= uVar9) goto LAB_0049a730;
      }
      else {
        while (uVar7 = *param_4, uVar7 <= uVar9) {
          while (pvVar5 = (void *)*param_2, pvVar5 != (void *)0x0) {
            *param_4 = uVar7 + 0x400;
            pvVar5 = CRYPTO_realloc(pvVar5,(int)(uVar7 + 0x400),"b_print.c",0x2ed);
            uVar9 = *param_3;
            uVar7 = *param_4;
            *param_2 = (long)pvVar5;
            if (uVar9 < uVar7) goto LAB_0049a78e;
          }
          iVar13 = (int)uVar7;
          if (uVar7 == 0) {
            *param_4 = 0x400;
            iVar13 = 0x400;
          }
          pvVar5 = CRYPTO_malloc(iVar13,"b_print.c",0x2e5);
          sVar4 = *param_3;
          uVar9 = 0;
          *param_2 = (long)pvVar5;
          if (sVar4 != 0) {
            memcpy(pvVar5,(void *)*param_1,sVar4);
            uVar9 = *param_3;
          }
          *param_1 = 0;
        }
      }
LAB_0049a78e:
      lVar6 = *param_1;
      if (lVar6 == 0) {
        lVar6 = *param_2;
      }
      *param_3 = uVar9 + 1;
      *(char *)(lVar6 + uVar9) = cVar1;
      if (iVar14 == 0) break;
    } while( true );
  }
  do {
    if (local_74 == 0) {
      return;
    }
    uVar9 = *param_3;
    if (param_2 == (long *)0x0) {
      if (uVar9 < *param_4) goto LAB_0049a80c;
    }
    else {
      while (uVar7 = *param_4, uVar7 <= uVar9) {
        while (pvVar5 = (void *)*param_2, pvVar5 != (void *)0x0) {
          *param_4 = uVar7 + 0x400;
          pvVar5 = CRYPTO_realloc(pvVar5,(int)(uVar7 + 0x400),"b_print.c",0x2ed);
          uVar9 = *param_3;
          uVar7 = *param_4;
          *param_2 = (long)pvVar5;
          if (uVar9 < uVar7) goto LAB_0049a80c;
        }
        iVar13 = (int)uVar7;
        if (uVar7 == 0) {
          *param_4 = 0x400;
          iVar13 = 0x400;
        }
        pvVar5 = CRYPTO_malloc(iVar13,"b_print.c",0x2e5);
        sVar4 = *param_3;
        uVar9 = 0;
        *param_2 = (long)pvVar5;
        if (sVar4 != 0) {
          memcpy(pvVar5,(void *)*param_1,sVar4);
          uVar9 = *param_3;
        }
        *param_1 = 0;
      }
LAB_0049a80c:
      lVar6 = *param_1;
      if (lVar6 == 0) {
        lVar6 = *param_2;
      }
      *param_3 = uVar9 + 1;
      *(undefined1 *)(lVar6 + uVar9) = 0x20;
    }
    local_74 = local_74 + 1;
  } while( true );
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

void _dopr_constprop_0(long *param_1,ulong *param_2,long *param_3,uint *param_4,char *param_5,
                      uint *param_6)

{
  bool bVar1;
  uint uVar2;
  int iVar3;
  ushort **ppuVar4;
  int *piVar5;
  double *pdVar6;
  undefined8 *puVar7;
  char *pcVar8;
  undefined4 *puVar9;
  short *psVar10;
  int iVar11;
  ulong uVar12;
  uint *puVar13;
  ushort *puVar14;
  ulong *puVar15;
  int iVar16;
  long lVar17;
  ulong uVar18;
  ulong uVar19;
  ulong uVar20;
  char *pcVar21;
  int iVar22;
  int iVar23;
  undefined8 uVar24;
  long lVar25;
  long lVar26;
  char *pcVar27;
  char cVar28;
  double dVar29;
  double dVar30;
  double dVar31;
  uint local_b4;
  int local_a8;
  ulong local_88 [2];
  char local_78 [32];
  char acStack_58 [40];
  
  iVar23 = 0;
  uVar19 = (ulong)(uint)(int)*param_5;
  uVar20 = *param_2;
  iVar16 = -1;
  local_88[0] = 0;
  local_a8 = 0;
  iVar3 = 0;
  local_b4 = 0;
  uVar12 = 0;
  pcVar27 = param_5 + 1;
LAB_0049ad10:
  do {
    cVar28 = (char)uVar19;
    if ((cVar28 == '\0') || (uVar20 <= uVar12)) goto LAB_0049ad15;
    switch(iVar23) {
    case 0:
      if (cVar28 == '%') {
        uVar19 = (ulong)(uint)(int)*pcVar27;
        iVar23 = 1;
        pcVar27 = pcVar27 + 1;
      }
      else {
        if (*param_1 == 0) {
          *(char *)(_DAT_00000000 + uVar12) = cVar28;
        }
        else {
          *(char *)(*param_1 + uVar12) = cVar28;
          uVar20 = *param_2;
        }
        local_88[0] = uVar12 + 1;
        uVar19 = (ulong)(uint)(int)*pcVar27;
        uVar12 = local_88[0];
        pcVar27 = pcVar27 + 1;
      }
      break;
    case 1:
      switch(cVar28) {
      case ' ':
        uVar19 = (ulong)(uint)(int)*pcVar27;
        local_b4 = local_b4 | 4;
        pcVar27 = pcVar27 + 1;
        break;
      default:
        iVar23 = 2;
        break;
      case '#':
        uVar19 = (ulong)(uint)(int)*pcVar27;
        local_b4 = local_b4 | 8;
        pcVar27 = pcVar27 + 1;
        break;
      case '+':
        uVar19 = (ulong)(uint)(int)*pcVar27;
        local_b4 = local_b4 | 2;
        pcVar27 = pcVar27 + 1;
        break;
      case '-':
        uVar19 = (ulong)(uint)(int)*pcVar27;
        local_b4 = local_b4 | 1;
        pcVar27 = pcVar27 + 1;
        break;
      case '0':
        uVar19 = (ulong)(uint)(int)*pcVar27;
        local_b4 = local_b4 | 0x10;
        pcVar27 = pcVar27 + 1;
      }
      break;
    case 2:
      ppuVar4 = __ctype_b_loc();
      if ((*(byte *)((long)*ppuVar4 + (uVar19 & 0xff) * 2 + 1) & 8) == 0) {
        iVar23 = 3;
        if (cVar28 == '*') {
          uVar2 = *param_6;
          if (uVar2 < 0x30) {
            piVar5 = (int *)((ulong)uVar2 + *(long *)(param_6 + 4));
            *param_6 = uVar2 + 8;
          }
          else {
            piVar5 = *(int **)(param_6 + 2);
            *(int **)(param_6 + 2) = piVar5 + 2;
          }
          iVar3 = *piVar5;
          uVar19 = (ulong)(uint)(int)*pcVar27;
          iVar23 = 3;
          pcVar27 = pcVar27 + 1;
        }
      }
      else {
        iVar3 = (int)uVar19 + -0x30 + iVar3 * 10;
        uVar19 = (ulong)(uint)(int)*pcVar27;
        pcVar27 = pcVar27 + 1;
      }
      break;
    case 3:
      iVar23 = 5;
      if (cVar28 == '.') {
        uVar19 = (ulong)(uint)(int)*pcVar27;
        iVar23 = 4;
        pcVar27 = pcVar27 + 1;
      }
      break;
    case 4:
      ppuVar4 = __ctype_b_loc();
      if ((*(byte *)((long)*ppuVar4 + (uVar19 & 0xff) * 2 + 1) & 8) == 0) {
        iVar23 = 5;
        if (cVar28 == '*') {
          uVar2 = *param_6;
          if (uVar2 < 0x30) {
            piVar5 = (int *)((ulong)uVar2 + *(long *)(param_6 + 4));
            *param_6 = uVar2 + 8;
          }
          else {
            piVar5 = *(int **)(param_6 + 2);
            *(int **)(param_6 + 2) = piVar5 + 2;
          }
          uVar19 = (ulong)(uint)(int)*pcVar27;
          iVar16 = *piVar5;
          iVar23 = 5;
          pcVar27 = pcVar27 + 1;
        }
      }
      else {
        iVar11 = 0;
        if (-1 < iVar16) {
          iVar11 = iVar16;
        }
        iVar16 = (int)uVar19 + -0x30 + iVar11 * 10;
        uVar19 = (ulong)(uint)(int)*pcVar27;
        pcVar27 = pcVar27 + 1;
      }
      break;
    case 5:
      if (cVar28 == 'h') {
        uVar19 = (ulong)(uint)(int)*pcVar27;
        local_a8 = 1;
        iVar23 = 6;
        pcVar27 = pcVar27 + 1;
        break;
      }
      if (cVar28 < 'i') {
        if (cVar28 == 'L') {
          uVar19 = (ulong)(uint)(int)*pcVar27;
          local_a8 = 3;
          iVar23 = 6;
          pcVar27 = pcVar27 + 1;
          break;
        }
      }
      else {
        if (cVar28 == 'l') {
          cVar28 = *pcVar27;
          local_a8 = 2;
          if (cVar28 == 'l') {
            cVar28 = pcVar27[1];
            local_a8 = 4;
            pcVar27 = pcVar27 + 1;
          }
          uVar19 = (ulong)(uint)(int)cVar28;
          iVar23 = 6;
          pcVar27 = pcVar27 + 1;
          break;
        }
        if (cVar28 == 'q') {
          uVar19 = (ulong)(uint)(int)*pcVar27;
          local_a8 = 4;
          iVar23 = 6;
          pcVar27 = pcVar27 + 1;
          break;
        }
      }
      iVar23 = 6;
      break;
    case 6:
      uVar18 = uVar12;
      switch(cVar28) {
      case '%':
        if (*param_1 == 0) {
          uVar18 = uVar12 + 1;
          *(undefined1 *)(_DAT_00000000 + uVar12) = 0x25;
          local_88[0] = uVar18;
        }
        else {
          uVar18 = uVar12 + 1;
          *(undefined1 *)(*param_1 + uVar12) = 0x25;
          uVar20 = *param_2;
          local_88[0] = uVar18;
        }
        break;
      case 'E':
      case 'e':
        uVar2 = param_6[1];
        if (local_a8 != 3) goto LAB_0049b1e4;
        if (uVar2 < 0xb0) {
          param_6[1] = uVar2 + 0x10;
          break;
        }
LAB_0049b6a0:
        *(long *)(param_6 + 2) = *(long *)(param_6 + 2) + 8;
        break;
      case 'G':
      case 'g':
        uVar2 = param_6[1];
LAB_0049b1e4:
        if (0xaf < uVar2) goto LAB_0049b6a0;
        param_6[1] = uVar2 + 0x10;
        break;
      case 'X':
        local_b4 = local_b4 | 0x20;
      case 'o':
      case 'u':
      case 'x':
        local_b4 = local_b4 | 0x40;
        if (local_a8 == 2) {
          uVar2 = *param_6;
          if (uVar2 < 0x30) {
            puVar15 = (ulong *)((ulong)uVar2 + *(long *)(param_6 + 4));
            *param_6 = uVar2 + 8;
          }
          else {
LAB_0049bad7:
            puVar15 = *(ulong **)(param_6 + 2);
            *(ulong **)(param_6 + 2) = puVar15 + 1;
          }
LAB_0049ba84:
          uVar12 = *puVar15;
        }
        else {
          if (local_a8 == 4) {
            uVar2 = *param_6;
            if (0x2f < uVar2) goto LAB_0049bad7;
            puVar15 = (ulong *)((ulong)uVar2 + *(long *)(param_6 + 4));
            *param_6 = uVar2 + 8;
            goto LAB_0049ba84;
          }
          if (local_a8 == 1) {
            uVar2 = *param_6;
            if (uVar2 < 0x30) {
              puVar14 = (ushort *)((ulong)uVar2 + *(long *)(param_6 + 4));
              *param_6 = uVar2 + 8;
            }
            else {
              puVar14 = *(ushort **)(param_6 + 2);
              *(ushort **)(param_6 + 2) = puVar14 + 4;
            }
            uVar12 = (ulong)*puVar14;
          }
          else {
            uVar2 = *param_6;
            if (uVar2 < 0x30) {
              puVar13 = (uint *)((ulong)uVar2 + *(long *)(param_6 + 4));
              *param_6 = uVar2 + 8;
            }
            else {
              puVar13 = *(uint **)(param_6 + 2);
              *(uint **)(param_6 + 2) = puVar13 + 2;
            }
            uVar12 = (ulong)*puVar13;
          }
        }
        uVar24 = 8;
        if ((cVar28 != 'o') && (uVar24 = 10, cVar28 != 'u')) {
          uVar24 = 0x10;
        }
        goto LAB_0049af44;
      case 'c':
        uVar2 = *param_6;
        if (uVar2 < 0x30) {
          puVar9 = (undefined4 *)((ulong)uVar2 + *(long *)(param_6 + 4));
          *param_6 = uVar2 + 8;
        }
        else {
          puVar9 = *(undefined4 **)(param_6 + 2);
          *(undefined4 **)(param_6 + 2) = puVar9 + 2;
        }
        if (*param_1 == 0) {
          uVar18 = uVar12 + 1;
          *(char *)(_DAT_00000000 + uVar12) = (char)*puVar9;
          local_88[0] = uVar18;
        }
        else {
          uVar18 = uVar12 + 1;
          *(char *)(*param_1 + uVar12) = (char)*puVar9;
          uVar20 = *param_2;
          local_88[0] = uVar18;
        }
        break;
      case 'd':
      case 'i':
        if ((local_a8 == 2) || (local_a8 == 4)) {
          uVar2 = *param_6;
          if (uVar2 < 0x30) {
            puVar15 = (ulong *)((ulong)uVar2 + *(long *)(param_6 + 4));
            *param_6 = uVar2 + 8;
          }
          else {
            puVar15 = *(ulong **)(param_6 + 2);
            *(ulong **)(param_6 + 2) = puVar15 + 1;
          }
          uVar12 = *puVar15;
        }
        else {
          uVar2 = *param_6;
          if (local_a8 == 1) {
            if (uVar2 < 0x30) {
              psVar10 = (short *)((ulong)uVar2 + *(long *)(param_6 + 4));
              *param_6 = uVar2 + 8;
            }
            else {
              psVar10 = *(short **)(param_6 + 2);
              *(short **)(param_6 + 2) = psVar10 + 4;
            }
            uVar12 = (ulong)*psVar10;
          }
          else {
            if (uVar2 < 0x30) {
              piVar5 = (int *)((ulong)uVar2 + *(long *)(param_6 + 4));
              *param_6 = uVar2 + 8;
            }
            else {
              piVar5 = *(int **)(param_6 + 2);
              *(int **)(param_6 + 2) = piVar5 + 2;
            }
            uVar12 = (ulong)*piVar5;
          }
        }
        uVar24 = 10;
        goto LAB_0049af44;
      case 'f':
        uVar2 = param_6[1];
        if (local_a8 == 3) {
          if (0xaf < uVar2) goto LAB_0049b83e;
          pdVar6 = (double *)((ulong)uVar2 + *(long *)(param_6 + 4));
          param_6[1] = uVar2 + 0x10;
        }
        else if (uVar2 < 0xb0) {
          pdVar6 = (double *)((ulong)uVar2 + *(long *)(param_6 + 4));
          param_6[1] = uVar2 + 0x10;
        }
        else {
LAB_0049b83e:
          pdVar6 = *(double **)(param_6 + 2);
          *(double **)(param_6 + 2) = pdVar6 + 1;
        }
        dVar31 = *pdVar6;
        iVar23 = 6;
        if ((-1 < iVar16) && (iVar23 = 9, iVar16 < 10)) {
          iVar23 = iVar16;
        }
        if (dVar31 < 0.0) {
          dVar31 = -dVar31;
          cVar28 = '-';
          local_a8 = 1;
          bVar1 = true;
        }
        else if (dVar31 < 0.0) {
          local_a8 = 1;
          bVar1 = true;
          cVar28 = '-';
        }
        else if ((local_b4 & 2) == 0) {
          if ((local_b4 & 4) == 0) {
            bVar1 = false;
            cVar28 = '\0';
            local_a8 = 0;
          }
          else {
            local_a8 = 1;
            bVar1 = true;
            cVar28 = ' ';
          }
        }
        else {
          local_a8 = 1;
          bVar1 = true;
          cVar28 = '+';
        }
        lVar25 = (long)dVar31;
        if (iVar23 == 0) {
          lVar17 = 1;
          dVar30 = 1.0;
        }
        else {
          dVar29 = 1.0;
          iVar16 = iVar23;
          do {
            iVar16 = iVar16 + -1;
            dVar29 = dVar29 * 10.0;
          } while (iVar16 != 0);
          lVar17 = (long)dVar29;
          dVar30 = 1.0;
          iVar16 = iVar23;
          if (0.5 <= dVar29 - (double)lVar17) {
            lVar17 = lVar17 + 1;
          }
          do {
            iVar16 = iVar16 + -1;
            dVar30 = dVar30 * 10.0;
          } while (iVar16 != 0);
        }
        dVar30 = (dVar31 - (double)lVar25) * dVar30;
        lVar26 = (long)dVar30;
        if (0.5 <= dVar30 - (double)lVar26) {
          lVar26 = lVar26 + 1;
        }
        if (lVar17 <= lVar26) {
          lVar25 = lVar25 + 1;
          lVar26 = lVar26 - lVar17;
        }
        pcVar21 = local_78;
        iVar16 = 0;
        do {
          iVar11 = iVar16;
          iVar16 = iVar11 + 1;
          lVar17 = lVar25 / 10;
          *pcVar21 = "0123456789abcdef"[lVar25 % 10];
          if (0x13 < iVar16) break;
          pcVar21 = pcVar21 + 1;
          lVar25 = lVar17;
        } while (lVar17 != 0);
        if (iVar16 == 0x14) {
          iVar16 = iVar11;
        }
        lVar25 = 0;
        local_78[iVar16] = '\0';
        do {
          acStack_58[lVar25] = "0123456789abcdef"[lVar26 % 10];
          lVar25 = lVar25 + 1;
          lVar26 = lVar26 / 10;
        } while ((int)lVar25 < iVar23);
        iVar11 = 1;
        if (0 < iVar23) {
          iVar11 = iVar23;
        }
        acStack_58[iVar11] = '\0';
        iVar22 = iVar23 - iVar11;
        if (iVar22 < 0) {
          iVar22 = 0;
        }
        local_a8 = (((iVar3 - iVar16) - iVar23) + -1) - local_a8;
        if (local_a8 < 0) {
          local_a8 = 0;
        }
        if ((local_b4 & 1) != 0) {
          local_a8 = -local_a8;
        }
        if ((local_b4 & 0x10) == 0) {
          uVar19 = uVar12;
          if (0 < local_a8) {
            do {
              uVar12 = uVar19;
              if (uVar19 < uVar20) {
                if (*param_1 == 0) {
                  uVar12 = uVar19 + 1;
                  *(undefined1 *)(_DAT_00000000 + uVar19) = 0x20;
                  local_88[0] = uVar12;
                }
                else {
                  uVar12 = uVar19 + 1;
                  *(undefined1 *)(*param_1 + uVar19) = 0x20;
                  uVar20 = *param_2;
                  local_88[0] = uVar12;
                }
              }
              local_a8 = local_a8 + -1;
              uVar19 = uVar12;
            } while (local_a8 != 0);
            goto LAB_0049b740;
          }
          if (cVar28 == '\0') goto LAB_0049b770;
LAB_0049b74a:
          if (*param_1 == 0) {
            uVar12 = uVar19 + 1;
            *(char *)(_DAT_00000000 + uVar19) = cVar28;
            local_88[0] = uVar12;
          }
          else {
            uVar12 = uVar19 + 1;
            *(char *)(*param_1 + uVar19) = cVar28;
            uVar20 = *param_2;
            local_88[0] = uVar12;
          }
        }
        else if (local_a8 < 1) {
LAB_0049b740:
          if ((cVar28 != '\0') && (uVar19 = uVar12, uVar12 < uVar20)) goto LAB_0049b74a;
        }
        else {
          if (!bVar1) goto LAB_0049b456;
          if (*param_1 == 0) {
            uVar19 = uVar12 + 1;
            *(char *)(_DAT_00000000 + uVar12) = cVar28;
            local_88[0] = uVar19;
          }
          else {
            *(char *)(*param_1 + uVar12) = cVar28;
            uVar20 = *param_2;
            uVar19 = uVar12 + 1;
            local_88[0] = uVar12 + 1;
          }
          while (local_a8 = local_a8 + -1, uVar12 = uVar19, local_a8 != 0) {
LAB_0049b456:
            uVar19 = uVar12;
            if (uVar12 < uVar20) {
              if (*param_1 == 0) {
                uVar19 = uVar12 + 1;
                *(undefined1 *)(_DAT_00000000 + uVar12) = 0x30;
                local_88[0] = uVar19;
              }
              else {
                uVar19 = uVar12 + 1;
                *(undefined1 *)(*param_1 + uVar12) = 0x30;
                uVar20 = *param_2;
                local_88[0] = uVar19;
              }
            }
          }
        }
LAB_0049b770:
        uVar19 = uVar12;
        if (iVar16 != 0) {
          while( true ) {
            iVar16 = iVar16 + -1;
            uVar12 = uVar19;
            if (uVar20 <= uVar19) break;
            if (*param_1 == 0) {
              uVar12 = uVar19 + 1;
              *(char *)(_DAT_00000000 + uVar19) = local_78[iVar16];
              local_88[0] = uVar12;
              break;
            }
            uVar12 = uVar19 + 1;
            *(char *)(*param_1 + uVar19) = local_78[iVar16];
            uVar20 = *param_2;
            uVar19 = uVar12;
            local_88[0] = uVar12;
            if (iVar16 == 0) goto LAB_0049b7ab;
          }
          goto LAB_0049b770;
        }
LAB_0049b7ab:
        if ((iVar23 != 0) || ((local_b4 & 8) != 0)) {
          uVar19 = uVar12;
          if (uVar12 < uVar20) {
            if (*param_1 == 0) {
              uVar19 = uVar12 + 1;
              *(undefined1 *)(_DAT_00000000 + uVar12) = 0x2e;
              local_88[0] = uVar19;
            }
            else {
              *(undefined1 *)(*param_1 + uVar12) = 0x2e;
              uVar20 = *param_2;
              uVar19 = uVar12 + 1;
              local_88[0] = uVar12 + 1;
            }
          }
          do {
            iVar11 = iVar11 + -1;
            uVar12 = uVar19;
            if (uVar19 < uVar20) {
              if (*param_1 == 0) {
                uVar12 = uVar19 + 1;
                *(char *)(_DAT_00000000 + uVar19) = acStack_58[iVar11];
                local_88[0] = uVar12;
              }
              else {
                uVar12 = uVar19 + 1;
                *(char *)(*param_1 + uVar19) = acStack_58[iVar11];
                uVar20 = *param_2;
                local_88[0] = uVar12;
              }
            }
            uVar19 = uVar12;
          } while (iVar11 != 0);
        }
        for (; iVar22 != 0; iVar22 = iVar22 + -1) {
          uVar19 = uVar12;
          if (uVar12 < uVar20) {
            if (*param_1 == 0) {
              uVar19 = uVar12 + 1;
              *(undefined1 *)(_DAT_00000000 + uVar12) = 0x30;
              local_88[0] = uVar19;
            }
            else {
              uVar19 = uVar12 + 1;
              *(undefined1 *)(*param_1 + uVar12) = 0x30;
              uVar20 = *param_2;
              local_88[0] = uVar19;
            }
          }
          uVar12 = uVar19;
        }
        for (; uVar18 = uVar12, local_a8 != 0; local_a8 = local_a8 + 1) {
          uVar19 = uVar12;
          if (uVar12 < uVar20) {
            if (*param_1 == 0) {
              uVar19 = uVar12 + 1;
              *(undefined1 *)(_DAT_00000000 + uVar12) = 0x20;
              local_88[0] = uVar19;
            }
            else {
              uVar19 = uVar12 + 1;
              *(undefined1 *)(*param_1 + uVar12) = 0x20;
              uVar20 = *param_2;
              local_88[0] = uVar19;
            }
          }
          uVar12 = uVar19;
        }
        break;
      case 'n':
        if (local_a8 == 1) {
          uVar2 = *param_6;
          if (uVar2 < 0x30) {
            puVar7 = (undefined8 *)((ulong)uVar2 + *(long *)(param_6 + 4));
            *param_6 = uVar2 + 8;
          }
          else {
            puVar7 = *(undefined8 **)(param_6 + 2);
            *(undefined8 **)(param_6 + 2) = puVar7 + 1;
          }
          *(short *)*puVar7 = (short)uVar12;
        }
        else if ((local_a8 == 2) || (local_a8 == 4)) {
          uVar2 = *param_6;
          if (uVar2 < 0x30) {
            puVar7 = (undefined8 *)((ulong)uVar2 + *(long *)(param_6 + 4));
            *param_6 = uVar2 + 8;
          }
          else {
            puVar7 = *(undefined8 **)(param_6 + 2);
            *(undefined8 **)(param_6 + 2) = puVar7 + 1;
          }
          *(ulong *)*puVar7 = uVar12;
          uVar20 = *param_2;
          uVar18 = local_88[0];
        }
        else {
          uVar2 = *param_6;
          if (uVar2 < 0x30) {
            puVar7 = (undefined8 *)((ulong)uVar2 + *(long *)(param_6 + 4));
            *param_6 = uVar2 + 8;
          }
          else {
            puVar7 = *(undefined8 **)(param_6 + 2);
            *(undefined8 **)(param_6 + 2) = puVar7 + 1;
          }
          *(int *)*puVar7 = (int)uVar12;
        }
        break;
      case 'p':
        uVar2 = *param_6;
        if (uVar2 < 0x30) {
          puVar15 = (ulong *)((ulong)uVar2 + *(long *)(param_6 + 4));
          *param_6 = uVar2 + 8;
        }
        else {
          puVar15 = *(ulong **)(param_6 + 2);
          *(ulong **)(param_6 + 2) = puVar15 + 1;
        }
        uVar24 = 0x10;
        local_b4 = local_b4 | 8;
        uVar12 = *puVar15;
LAB_0049af44:
        fmtint_constprop_3(param_1,local_88,param_2,uVar12,uVar24,iVar3,iVar16,local_b4);
        uVar20 = *param_2;
        uVar18 = local_88[0];
        break;
      case 's':
        uVar2 = *param_6;
        if (uVar2 < 0x30) {
          puVar7 = (undefined8 *)((ulong)uVar2 + *(long *)(param_6 + 4));
          *param_6 = uVar2 + 8;
        }
        else {
          puVar7 = *(undefined8 **)(param_6 + 2);
          *(undefined8 **)(param_6 + 2) = puVar7 + 1;
        }
        pcVar21 = (char *)*puVar7;
        if (iVar16 < 0) {
          iVar16 = (int)uVar20;
        }
        if (pcVar21 == (char *)0x0) {
          pcVar21 = "<NULL>";
        }
        cVar28 = *pcVar21;
        if (cVar28 == '\0') {
          iVar23 = 0;
        }
        else {
          iVar23 = 0;
          pcVar8 = pcVar21;
          do {
            pcVar8 = pcVar8 + 1;
            iVar23 = iVar23 + 1;
          } while (*pcVar8 != '\0');
        }
        iVar11 = 0;
        if (-1 < iVar3 - iVar23) {
          iVar11 = iVar3 - iVar23;
        }
        if ((local_b4 & 1) != 0) {
          iVar11 = -iVar11;
        }
        bVar1 = 0 < iVar16;
        if ((iVar11 < 1) || (!bVar1)) {
          iVar3 = 0;
        }
        else {
          iVar3 = 0;
          do {
            uVar18 = uVar12;
            if (uVar12 < uVar20) {
              if (*param_1 == 0) {
                uVar18 = uVar12 + 1;
                *(undefined1 *)(_DAT_00000000 + uVar12) = 0x20;
                local_88[0] = uVar18;
              }
              else {
                uVar18 = uVar12 + 1;
                *(undefined1 *)(*param_1 + uVar12) = 0x20;
                uVar20 = *param_2;
                local_88[0] = uVar18;
              }
            }
            iVar3 = iVar3 + 1;
            iVar11 = iVar11 + -1;
            bVar1 = iVar3 < iVar16;
          } while ((iVar3 < iVar16) && (uVar12 = uVar18, 0 < iVar11));
          cVar28 = *pcVar21;
        }
        if (cVar28 == '\0') {
LAB_0049b9f2:
          iVar23 = iVar11;
          if (bVar1) {
            do {
              if (-1 < iVar23) break;
              uVar12 = uVar18;
              if (uVar18 < uVar20) {
                if (*param_1 == 0) {
                  uVar12 = uVar18 + 1;
                  *(undefined1 *)(_DAT_00000000 + uVar18) = 0x20;
                  local_88[0] = uVar12;
                }
                else {
                  uVar12 = uVar18 + 1;
                  *(undefined1 *)(*param_1 + uVar18) = 0x20;
                  uVar20 = *param_2;
                  local_88[0] = uVar12;
                }
              }
              iVar23 = iVar23 + 1;
              uVar18 = uVar12;
            } while ((iVar23 - iVar11) + iVar3 < iVar16);
          }
        }
        else {
          uVar12 = uVar18;
          if (iVar3 < iVar16) {
            do {
              pcVar21 = pcVar21 + 1;
              uVar18 = uVar12;
              if (uVar12 < uVar20) {
                if (*param_1 == 0) {
                  uVar18 = uVar12 + 1;
                  *(char *)(_DAT_00000000 + uVar12) = cVar28;
                  local_88[0] = uVar18;
                }
                else {
                  uVar18 = uVar12 + 1;
                  *(char *)(*param_1 + uVar12) = cVar28;
                  uVar20 = *param_2;
                  local_88[0] = uVar18;
                }
              }
              cVar28 = *pcVar21;
              iVar3 = iVar3 + 1;
              if (cVar28 == '\0') {
                bVar1 = iVar3 < iVar16;
                goto LAB_0049b9f2;
              }
              uVar12 = uVar18;
            } while (iVar3 != iVar16);
          }
        }
        break;
      case 'w':
        pcVar27 = pcVar27 + 1;
      }
      uVar19 = (ulong)(uint)(int)*pcVar27;
      local_a8 = 0;
      local_b4 = 0;
      iVar23 = 0;
      iVar16 = -1;
      iVar3 = 0;
      uVar12 = uVar18;
      pcVar27 = pcVar27 + 1;
      break;
    default:
      goto switchD_0049ad82_default;
    }
  } while( true );
switchD_0049ad82_default:
  if (iVar23 == 7) {
LAB_0049ad15:
    uVar2 = (uint)(uVar20 - 1 < uVar12);
    *param_4 = uVar2;
    if (uVar2 != 0) {
      uVar12 = uVar20 - 1;
    }
    uVar19 = uVar12;
    if (uVar12 < uVar20) {
      if (*param_1 == 0) {
        uVar19 = uVar12 + 1;
      }
      else {
        uVar19 = uVar12 + 1;
        *(undefined1 *)(*param_1 + uVar12) = 0;
      }
    }
    *param_3 = uVar19 - 1;
    return;
  }
  goto LAB_0049ad10;
}



int BIO_vprintf(BIO *bio,char *format,va_list args)

{
  undefined4 uVar1;
  int iVar2;
  int iVar3;
  ushort **ppuVar4;
  int *piVar5;
  undefined8 *puVar6;
  char *pcVar7;
  undefined4 *puVar8;
  short *psVar9;
  bool bVar10;
  long lVar11;
  ulong uVar12;
  int iVar13;
  uint *puVar14;
  double *pdVar15;
  long lVar16;
  ulong *puVar17;
  ushort *puVar18;
  int iVar19;
  long lVar20;
  undefined8 uVar21;
  int iVar22;
  char *pcVar23;
  int iVar24;
  ulong uVar25;
  char cVar26;
  uint uVar27;
  char *pcVar28;
  double dVar29;
  double dVar30;
  double dVar31;
  uint local_8c0;
  undefined1 *local_8b8 [2];
  ulong local_8a8 [2];
  void *local_898 [2];
  ulong local_888 [2];
  char local_878 [32];
  char acStack_858 [32];
  undefined1 local_838 [2056];
  
  iVar3 = 0;
  iVar19 = 0;
  iVar24 = 0;
  local_8b8[0] = local_838;
  local_8a8[0] = 0x800;
  local_898[0] = (void *)0x0;
  CRYPTO_push_info_("doapr()","b_print.c",0x31a);
  uVar27 = (uint)*format;
  local_888[0] = 0;
  iVar2 = -1;
  local_8c0 = 0;
  pcVar28 = format + 1;
LAB_0049be20:
  do {
    cVar26 = (char)uVar27;
    if (cVar26 == '\0') goto LAB_0049be29;
    switch(iVar19) {
    case 0:
      if (cVar26 == '%') {
        iVar19 = 1;
      }
      else {
        while (uVar25 = local_888[0], local_8a8[0] <= local_888[0]) {
          while (local_898[0] == (void *)0x0) {
            iVar22 = (int)local_8a8[0];
            if (local_8a8[0] == 0) {
              local_8a8[0] = 0x400;
              iVar22 = 0x400;
            }
            local_898[0] = CRYPTO_malloc(iVar22,"b_print.c",0x2e5);
            uVar25 = 0;
            if (local_888[0] != 0) {
              memcpy(local_898[0],local_8b8[0],local_888[0]);
              uVar25 = local_888[0];
            }
            local_8b8[0] = (undefined1 *)0x0;
            if (uVar25 < local_8a8[0]) goto LAB_0049c085;
          }
          local_8a8[0] = local_8a8[0] + 0x400;
          local_898[0] = CRYPTO_realloc(local_898[0],(int)local_8a8[0],"b_print.c",0x2ed);
        }
LAB_0049c085:
        if (uVar25 < local_8a8[0]) {
          if (local_8b8[0] == (undefined1 *)0x0) {
            local_888[0] = uVar25 + 1;
            *(char *)((long)local_898[0] + uVar25) = cVar26;
          }
          else {
            local_888[0] = uVar25 + 1;
            local_8b8[0][uVar25] = cVar26;
          }
        }
      }
      goto LAB_0049bfec;
    case 1:
      switch(cVar26) {
      case ' ':
        uVar27 = (uint)*pcVar28;
        local_8c0 = local_8c0 | 4;
        pcVar28 = pcVar28 + 1;
        break;
      default:
        iVar19 = 2;
        break;
      case '#':
        uVar27 = (uint)*pcVar28;
        local_8c0 = local_8c0 | 8;
        pcVar28 = pcVar28 + 1;
        break;
      case '+':
        uVar27 = (uint)*pcVar28;
        local_8c0 = local_8c0 | 2;
        pcVar28 = pcVar28 + 1;
        break;
      case '-':
        local_8c0 = local_8c0 | 1;
LAB_0049bfec:
        uVar27 = (uint)*pcVar28;
        pcVar28 = pcVar28 + 1;
        break;
      case '0':
        uVar27 = (uint)*pcVar28;
        local_8c0 = local_8c0 | 0x10;
        pcVar28 = pcVar28 + 1;
      }
      break;
    case 2:
      ppuVar4 = __ctype_b_loc();
      if ((*(byte *)((long)*ppuVar4 + (ulong)(uVar27 & 0xff) * 2 + 1) & 8) == 0) {
        iVar19 = 3;
        if (cVar26 == '*') {
                    // WARNING: Load size is inaccurate
          uVar27 = *args;
          if (uVar27 < 0x30) {
            piVar5 = (int *)((ulong)uVar27 + *(long *)((long)args + 0x10));
            *(uint *)args = uVar27 + 8;
          }
          else {
            piVar5 = *(int **)((long)args + 8);
            *(int **)((long)args + 8) = piVar5 + 2;
          }
          uVar27 = (uint)*pcVar28;
          iVar24 = *piVar5;
          pcVar28 = pcVar28 + 1;
          iVar19 = 3;
        }
      }
      else {
        iVar24 = (uVar27 - 0x30) + iVar24 * 10;
        uVar27 = (uint)*pcVar28;
        pcVar28 = pcVar28 + 1;
      }
      break;
    case 3:
      iVar19 = 5;
      if (cVar26 == '.') {
        uVar27 = (uint)*pcVar28;
        iVar19 = 4;
        pcVar28 = pcVar28 + 1;
      }
      break;
    case 4:
      ppuVar4 = __ctype_b_loc();
      if ((*(byte *)((long)*ppuVar4 + (ulong)(uVar27 & 0xff) * 2 + 1) & 8) == 0) {
        iVar19 = 5;
        if (cVar26 == '*') {
                    // WARNING: Load size is inaccurate
          uVar27 = *args;
          if (uVar27 < 0x30) {
            piVar5 = (int *)((ulong)uVar27 + *(long *)((long)args + 0x10));
            *(uint *)args = uVar27 + 8;
          }
          else {
            piVar5 = *(int **)((long)args + 8);
            *(int **)((long)args + 8) = piVar5 + 2;
          }
          uVar27 = (uint)*pcVar28;
          iVar2 = *piVar5;
          iVar19 = 5;
          pcVar28 = pcVar28 + 1;
        }
      }
      else {
        iVar22 = 0;
        if (-1 < iVar2) {
          iVar22 = iVar2;
        }
        iVar2 = (uVar27 - 0x30) + iVar22 * 10;
        uVar27 = (uint)*pcVar28;
        pcVar28 = pcVar28 + 1;
      }
      break;
    case 5:
      if (cVar26 == 'h') {
        uVar27 = (uint)*pcVar28;
        iVar3 = 1;
        iVar19 = 6;
        pcVar28 = pcVar28 + 1;
        break;
      }
      if (cVar26 < 'i') {
        if (cVar26 == 'L') {
          uVar27 = (uint)*pcVar28;
          iVar3 = 3;
          iVar19 = 6;
          pcVar28 = pcVar28 + 1;
          break;
        }
      }
      else {
        if (cVar26 == 'l') {
          cVar26 = *pcVar28;
          iVar3 = 2;
          if (cVar26 == 'l') {
            cVar26 = pcVar28[1];
            iVar3 = 4;
            pcVar28 = pcVar28 + 1;
          }
          uVar27 = (uint)cVar26;
          iVar19 = 6;
          pcVar28 = pcVar28 + 1;
          break;
        }
        if (cVar26 == 'q') {
          uVar27 = (uint)*pcVar28;
          iVar3 = 4;
          iVar19 = 6;
          pcVar28 = pcVar28 + 1;
          break;
        }
      }
      iVar19 = 6;
      break;
    case 6:
      switch(cVar26) {
      case '%':
        do {
          uVar25 = local_888[0];
          while( true ) {
            if (uVar25 < local_8a8[0]) {
              if (uVar25 < local_8a8[0]) {
                if (local_8b8[0] == (undefined1 *)0x0) {
                  local_888[0] = uVar25 + 1;
                  *(undefined1 *)((long)local_898[0] + uVar25) = 0x25;
                }
                else {
                  local_888[0] = uVar25 + 1;
                  local_8b8[0][uVar25] = 0x25;
                }
              }
              goto switchD_0049c0bf_caseD_26;
            }
            if (local_898[0] != (void *)0x0) break;
            iVar2 = (int)local_8a8[0];
            if (local_8a8[0] == 0) {
              local_8a8[0] = 0x400;
              iVar2 = 0x400;
            }
            local_898[0] = CRYPTO_malloc(iVar2,"b_print.c",0x2e5);
            uVar25 = 0;
            if (local_888[0] != 0) {
              memcpy(local_898[0],local_8b8[0],local_888[0]);
              uVar25 = local_888[0];
            }
            local_8b8[0] = (undefined1 *)0x0;
          }
          local_8a8[0] = local_8a8[0] + 0x400;
          local_898[0] = CRYPTO_realloc(local_898[0],(int)local_8a8[0],"b_print.c",0x2ed);
        } while( true );
      case 'E':
      case 'G':
      case 'e':
      case 'g':
        if (*(uint *)((long)args + 4) < 0xb0) {
          *(uint *)((long)args + 4) = *(uint *)((long)args + 4) + 0x10;
        }
        else {
          *(long *)((long)args + 8) = *(long *)((long)args + 8) + 8;
        }
        break;
      case 'X':
        local_8c0 = local_8c0 | 0x20;
      case 'o':
      case 'u':
      case 'x':
        local_8c0 = local_8c0 | 0x40;
                    // WARNING: Load size is inaccurate
        uVar27 = *args;
        if ((iVar3 == 2) || (iVar3 == 4)) {
          if (uVar27 < 0x30) {
            puVar17 = (ulong *)((ulong)uVar27 + *(long *)((long)args + 0x10));
            *(uint *)args = uVar27 + 8;
          }
          else {
            puVar17 = *(ulong **)((long)args + 8);
            *(ulong **)((long)args + 8) = puVar17 + 1;
          }
          uVar25 = *puVar17;
        }
        else if (iVar3 == 1) {
          if (uVar27 < 0x30) {
            puVar18 = (ushort *)((ulong)uVar27 + *(long *)((long)args + 0x10));
            *(uint *)args = uVar27 + 8;
          }
          else {
            puVar18 = *(ushort **)((long)args + 8);
            *(ushort **)((long)args + 8) = puVar18 + 4;
          }
          uVar25 = (ulong)*puVar18;
        }
        else {
          if (uVar27 < 0x30) {
            puVar14 = (uint *)((ulong)uVar27 + *(long *)((long)args + 0x10));
            *(uint *)args = uVar27 + 8;
          }
          else {
            puVar14 = *(uint **)((long)args + 8);
            *(uint **)((long)args + 8) = puVar14 + 2;
          }
          uVar25 = (ulong)*puVar14;
        }
        uVar21 = 8;
        if ((cVar26 != 'o') && (uVar21 = 10, cVar26 != 'u')) {
          uVar21 = 0x10;
        }
        goto LAB_0049c545;
      case 'c':
                    // WARNING: Load size is inaccurate
        uVar27 = *args;
        if (uVar27 < 0x30) {
          puVar8 = (undefined4 *)((ulong)uVar27 + *(long *)((long)args + 0x10));
          *(uint *)args = uVar27 + 8;
        }
        else {
          puVar8 = *(undefined4 **)((long)args + 8);
          *(undefined4 **)((long)args + 8) = puVar8 + 2;
        }
        uVar1 = *puVar8;
        uVar25 = local_888[0];
        while (local_8a8[0] <= uVar25) {
          while (local_898[0] != (void *)0x0) {
            local_8a8[0] = local_8a8[0] + 0x400;
            local_898[0] = CRYPTO_realloc(local_898[0],(int)local_8a8[0],"b_print.c",0x2ed);
            uVar25 = local_888[0];
            if (local_888[0] < local_8a8[0]) goto LAB_0049cb31;
          }
          iVar2 = (int)local_8a8[0];
          if (local_8a8[0] == 0) {
            local_8a8[0] = 0x400;
            iVar2 = 0x400;
          }
          local_898[0] = CRYPTO_malloc(iVar2,"b_print.c",0x2e5);
          uVar25 = 0;
          if (local_888[0] != 0) {
            memcpy(local_898[0],local_8b8[0],local_888[0]);
            uVar25 = local_888[0];
          }
          local_8b8[0] = (undefined1 *)0x0;
        }
LAB_0049cb31:
        if (uVar25 < local_8a8[0]) {
          if (local_8b8[0] == (undefined1 *)0x0) {
            local_888[0] = uVar25 + 1;
            *(char *)((long)local_898[0] + uVar25) = (char)uVar1;
          }
          else {
            local_888[0] = uVar25 + 1;
            local_8b8[0][uVar25] = (char)uVar1;
          }
        }
        break;
      case 'd':
      case 'i':
                    // WARNING: Load size is inaccurate
        uVar27 = *args;
        if ((iVar3 == 2) || (iVar3 == 4)) {
          if (uVar27 < 0x30) {
            puVar17 = (ulong *)((ulong)uVar27 + *(long *)((long)args + 0x10));
            *(uint *)args = uVar27 + 8;
          }
          else {
            puVar17 = *(ulong **)((long)args + 8);
            *(ulong **)((long)args + 8) = puVar17 + 1;
          }
          uVar25 = *puVar17;
        }
        else if (iVar3 == 1) {
          if (uVar27 < 0x30) {
            psVar9 = (short *)((ulong)uVar27 + *(long *)((long)args + 0x10));
            *(uint *)args = uVar27 + 8;
          }
          else {
            psVar9 = *(short **)((long)args + 8);
            *(short **)((long)args + 8) = psVar9 + 4;
          }
          uVar25 = (ulong)*psVar9;
        }
        else {
          if (uVar27 < 0x30) {
            piVar5 = (int *)((ulong)uVar27 + *(long *)((long)args + 0x10));
            *(uint *)args = uVar27 + 8;
          }
          else {
            piVar5 = *(int **)((long)args + 8);
            *(int **)((long)args + 8) = piVar5 + 2;
          }
          uVar25 = (ulong)*piVar5;
        }
        uVar21 = 10;
        goto LAB_0049c545;
      case 'f':
        if (iVar3 == 3) {
          uVar27 = *(uint *)((long)args + 4);
          if (uVar27 < 0xb0) {
            pdVar15 = (double *)((ulong)uVar27 + *(long *)((long)args + 0x10));
            *(uint *)((long)args + 4) = uVar27 + 0x10;
          }
          else {
            pdVar15 = *(double **)((long)args + 8);
            *(double **)((long)args + 8) = pdVar15 + 1;
          }
          dVar31 = *pdVar15;
        }
        else {
          uVar27 = *(uint *)((long)args + 4);
          if (uVar27 < 0xb0) {
            pdVar15 = (double *)((ulong)uVar27 + *(long *)((long)args + 0x10));
            *(uint *)((long)args + 4) = uVar27 + 0x10;
          }
          else {
            pdVar15 = *(double **)((long)args + 8);
            *(double **)((long)args + 8) = pdVar15 + 1;
          }
          dVar31 = *pdVar15;
        }
        iVar19 = 6;
        if ((-1 < iVar2) && (iVar19 = 9, iVar2 < 10)) {
          iVar19 = iVar2;
        }
        if (dVar31 < 0.0) {
          dVar31 = -dVar31;
          iVar2 = 1;
          bVar10 = true;
          cVar26 = '-';
        }
        else if (dVar31 < 0.0) {
          iVar2 = 1;
          bVar10 = true;
          cVar26 = '-';
        }
        else if ((local_8c0 & 2) == 0) {
          if ((local_8c0 & 4) == 0) {
            bVar10 = false;
            cVar26 = '\0';
            iVar2 = 0;
          }
          else {
            iVar2 = 1;
            bVar10 = true;
            cVar26 = ' ';
          }
        }
        else {
          iVar2 = 1;
          bVar10 = true;
          cVar26 = '+';
        }
        lVar11 = (long)dVar31;
        if (iVar19 == 0) {
          lVar16 = 1;
          dVar30 = 1.0;
        }
        else {
          dVar29 = 1.0;
          iVar3 = iVar19;
          do {
            iVar3 = iVar3 + -1;
            dVar29 = dVar29 * 10.0;
          } while (iVar3 != 0);
          lVar16 = (long)dVar29;
          dVar30 = 1.0;
          iVar3 = iVar19;
          if (0.5 <= dVar29 - (double)lVar16) {
            lVar16 = lVar16 + 1;
          }
          do {
            iVar3 = iVar3 + -1;
            dVar30 = dVar30 * 10.0;
          } while (iVar3 != 0);
        }
        dVar30 = (dVar31 - (double)lVar11) * dVar30;
        lVar20 = (long)dVar30;
        if (0.5 <= dVar30 - (double)lVar20) {
          lVar20 = lVar20 + 1;
        }
        if (lVar16 <= lVar20) {
          lVar11 = lVar11 + 1;
          lVar20 = lVar20 - lVar16;
        }
        pcVar23 = local_878;
        iVar3 = 0;
        do {
          iVar22 = iVar3;
          iVar3 = iVar22 + 1;
          lVar16 = lVar11 / 10;
          *pcVar23 = "0123456789abcdef"[lVar11 % 10];
          if (0x13 < iVar3) break;
          lVar11 = lVar16;
          pcVar23 = pcVar23 + 1;
        } while (lVar16 != 0);
        if (iVar3 == 0x14) {
          iVar3 = iVar22;
        }
        lVar11 = 0;
        local_878[iVar3] = '\0';
        do {
          acStack_858[lVar11] = "0123456789abcdef"[lVar20 % 10];
          lVar11 = lVar11 + 1;
          lVar20 = lVar20 / 10;
        } while ((int)lVar11 < iVar19);
        iVar22 = 1;
        if (0 < iVar19) {
          iVar22 = iVar19;
        }
        acStack_858[iVar22] = '\0';
        iVar13 = iVar19 - iVar22;
        if (iVar13 < 0) {
          iVar13 = 0;
        }
        iVar2 = (((iVar24 - iVar3) - iVar19) + -1) - iVar2;
        if (iVar2 < 0) {
          iVar2 = 0;
        }
        if ((local_8c0 & 1) != 0) {
          iVar2 = -iVar2;
        }
        if ((local_8c0 & 0x10) == 0) {
          uVar25 = local_888[0];
          if (0 < iVar2) {
            do {
              while (local_8a8[0] <= uVar25) {
                if (local_898[0] == (void *)0x0) {
                  iVar24 = (int)local_8a8[0];
                  if (local_8a8[0] == 0) {
                    local_8a8[0] = 0x400;
                    iVar24 = 0x400;
                  }
                  local_898[0] = CRYPTO_malloc(iVar24,"b_print.c",0x2e5);
                  uVar25 = 0;
                  if (local_888[0] != 0) {
                    memcpy(local_898[0],local_8b8[0],local_888[0]);
                    uVar25 = local_888[0];
                  }
                  local_8b8[0] = (undefined1 *)0x0;
                }
                else {
                  local_8a8[0] = local_8a8[0] + 0x400;
                  local_898[0] = CRYPTO_realloc(local_898[0],(int)local_8a8[0],"b_print.c",0x2ed);
                  uVar25 = local_888[0];
                }
              }
              if (uVar25 < local_8a8[0]) {
                if (local_8b8[0] == (undefined1 *)0x0) {
                  local_888[0] = uVar25 + 1;
                  *(undefined1 *)((long)local_898[0] + uVar25) = 0x20;
                }
                else {
                  local_888[0] = uVar25 + 1;
                  local_8b8[0][uVar25] = 0x20;
                }
              }
              iVar2 = iVar2 + -1;
              uVar25 = local_888[0];
            } while (iVar2 != 0);
          }
LAB_0049d069:
          uVar25 = local_888[0];
          if (cVar26 != '\0') {
            while (local_8a8[0] <= uVar25) {
              if (local_898[0] == (void *)0x0) {
                iVar24 = (int)local_8a8[0];
                if (local_8a8[0] == 0) {
                  local_8a8[0] = 0x400;
                  iVar24 = 0x400;
                }
                local_898[0] = CRYPTO_malloc(iVar24,"b_print.c",0x2e5);
                uVar25 = 0;
                if (local_888[0] != 0) {
                  memcpy(local_898[0],local_8b8[0],local_888[0]);
                  uVar25 = local_888[0];
                }
                local_8b8[0] = (undefined1 *)0x0;
              }
              else {
                local_8a8[0] = local_8a8[0] + 0x400;
                local_898[0] = CRYPTO_realloc(local_898[0],(int)local_8a8[0],"b_print.c",0x2ed);
                uVar25 = local_888[0];
              }
            }
            if (uVar25 < local_8a8[0]) goto LAB_0049caa5;
          }
        }
        else {
          if (iVar2 < 1) goto LAB_0049d069;
          uVar25 = local_888[0];
          if (!bVar10) goto LAB_0049c9b0;
          while (local_8a8[0] <= uVar25) {
            if (local_898[0] == (void *)0x0) {
              iVar24 = (int)local_8a8[0];
              if (local_8a8[0] == 0) {
                local_8a8[0] = 0x400;
                iVar24 = 0x400;
              }
              local_898[0] = CRYPTO_malloc(iVar24,"b_print.c",0x2e5);
              uVar25 = 0;
              if (local_888[0] != 0) {
                memcpy(local_898[0],local_8b8[0],local_888[0]);
                uVar25 = local_888[0];
              }
              local_8b8[0] = (undefined1 *)0x0;
            }
            else {
              local_8a8[0] = local_8a8[0] + 0x400;
              local_898[0] = CRYPTO_realloc(local_898[0],(int)local_8a8[0],"b_print.c",0x2ed);
              uVar25 = local_888[0];
            }
          }
          if (uVar25 < local_8a8[0]) {
            if (local_8b8[0] == (undefined1 *)0x0) {
              local_888[0] = uVar25 + 1;
              *(char *)((long)local_898[0] + uVar25) = cVar26;
            }
            else {
              local_888[0] = uVar25 + 1;
              local_8b8[0][uVar25] = cVar26;
            }
          }
          while (iVar2 = iVar2 + -1, iVar2 != 0) {
LAB_0049c9b0:
            while (uVar25 = local_888[0], local_8a8[0] <= local_888[0]) {
              while (local_898[0] == (void *)0x0) {
                iVar24 = (int)local_8a8[0];
                if (local_8a8[0] == 0) {
                  local_8a8[0] = 0x400;
                  iVar24 = 0x400;
                }
                local_898[0] = CRYPTO_malloc(iVar24,"b_print.c",0x2e5);
                uVar25 = 0;
                if (local_888[0] != 0) {
                  memcpy(local_898[0],local_8b8[0],local_888[0]);
                  uVar25 = local_888[0];
                }
                local_8b8[0] = (undefined1 *)0x0;
                if (uVar25 < local_8a8[0]) goto LAB_0049ca15;
              }
              local_8a8[0] = local_8a8[0] + 0x400;
              local_898[0] = CRYPTO_realloc(local_898[0],(int)local_8a8[0],"b_print.c",0x2ed);
            }
LAB_0049ca15:
            if (uVar25 < local_8a8[0]) {
              if (local_8b8[0] == (undefined1 *)0x0) {
                local_888[0] = uVar25 + 1;
                *(undefined1 *)((long)local_898[0] + uVar25) = 0x30;
              }
              else {
                local_888[0] = uVar25 + 1;
                local_8b8[0][uVar25] = 0x30;
              }
            }
          }
          iVar2 = 0;
        }
        while (iVar3 != 0) {
          iVar3 = iVar3 + -1;
          cVar26 = local_878[iVar3];
          uVar25 = local_888[0];
          while (local_8a8[0] <= uVar25) {
            while (local_898[0] != (void *)0x0) {
              local_8a8[0] = local_8a8[0] + 0x400;
              local_898[0] = CRYPTO_realloc(local_898[0],(int)local_8a8[0],"b_print.c",0x2ed);
              uVar25 = local_888[0];
              if (local_888[0] < local_8a8[0]) goto LAB_0049caa0;
            }
            iVar24 = (int)local_8a8[0];
            if (local_8a8[0] == 0) {
              local_8a8[0] = 0x400;
              iVar24 = 0x400;
            }
            local_898[0] = CRYPTO_malloc(iVar24,"b_print.c",0x2e5);
            uVar25 = 0;
            if (local_888[0] != 0) {
              memcpy(local_898[0],local_8b8[0],local_888[0]);
              uVar25 = local_888[0];
            }
            local_8b8[0] = (undefined1 *)0x0;
          }
LAB_0049caa0:
          if (uVar25 < local_8a8[0]) {
LAB_0049caa5:
            if (local_8b8[0] == (undefined1 *)0x0) {
              local_888[0] = uVar25 + 1;
              *(char *)((long)local_898[0] + uVar25) = cVar26;
            }
            else {
              local_888[0] = uVar25 + 1;
              local_8b8[0][uVar25] = cVar26;
            }
          }
        }
        uVar25 = local_888[0];
        if ((iVar19 != 0) || ((local_8c0 & 8) != 0)) {
          while (local_8a8[0] <= uVar25) {
            if (local_898[0] == (void *)0x0) {
              iVar24 = (int)local_8a8[0];
              if (local_8a8[0] == 0) {
                local_8a8[0] = 0x400;
                iVar24 = 0x400;
              }
              local_898[0] = CRYPTO_malloc(iVar24,"b_print.c",0x2e5);
              uVar25 = 0;
              if (local_888[0] != 0) {
                memcpy(local_898[0],local_8b8[0],local_888[0]);
                uVar25 = local_888[0];
              }
              local_8b8[0] = (undefined1 *)0x0;
            }
            else {
              local_8a8[0] = local_8a8[0] + 0x400;
              local_898[0] = CRYPTO_realloc(local_898[0],(int)local_8a8[0],"b_print.c",0x2ed);
              uVar25 = local_888[0];
            }
          }
          if (uVar25 < local_8a8[0]) {
            if (local_8b8[0] == (undefined1 *)0x0) {
              local_888[0] = uVar25 + 1;
              *(undefined1 *)((long)local_898[0] + uVar25) = 0x2e;
            }
            else {
              local_888[0] = uVar25 + 1;
              local_8b8[0][uVar25] = 0x2e;
            }
          }
          do {
            iVar22 = iVar22 + -1;
            cVar26 = acStack_858[iVar22];
            uVar25 = local_888[0];
            while (local_8a8[0] <= uVar25) {
              if (local_898[0] == (void *)0x0) {
                iVar24 = (int)local_8a8[0];
                if (local_8a8[0] == 0) {
                  local_8a8[0] = 0x400;
                  iVar24 = 0x400;
                }
                local_898[0] = CRYPTO_malloc(iVar24,"b_print.c",0x2e5);
                uVar25 = 0;
                if (local_888[0] != 0) {
                  memcpy(local_898[0],local_8b8[0],local_888[0]);
                  uVar25 = local_888[0];
                }
                local_8b8[0] = (undefined1 *)0x0;
              }
              else {
                local_8a8[0] = local_8a8[0] + 0x400;
                local_898[0] = CRYPTO_realloc(local_898[0],(int)local_8a8[0],"b_print.c",0x2ed);
                uVar25 = local_888[0];
              }
            }
            if (uVar25 < local_8a8[0]) {
              if (local_8b8[0] == (undefined1 *)0x0) {
                local_888[0] = uVar25 + 1;
                *(char *)((long)local_898[0] + uVar25) = cVar26;
              }
              else {
                local_888[0] = uVar25 + 1;
                local_8b8[0][uVar25] = cVar26;
              }
            }
          } while (iVar22 != 0);
        }
        for (; iVar13 != 0; iVar13 = iVar13 + -1) {
          while (uVar25 = local_888[0], local_8a8[0] <= local_888[0]) {
            while (local_898[0] == (void *)0x0) {
              iVar24 = (int)local_8a8[0];
              if (local_8a8[0] == 0) {
                local_8a8[0] = 0x400;
                iVar24 = 0x400;
              }
              local_898[0] = CRYPTO_malloc(iVar24,"b_print.c",0x2e5);
              uVar25 = 0;
              if (local_888[0] != 0) {
                memcpy(local_898[0],local_8b8[0],local_888[0]);
                uVar25 = local_888[0];
              }
              local_8b8[0] = (undefined1 *)0x0;
              if (uVar25 < local_8a8[0]) goto LAB_0049d1a5;
            }
            local_8a8[0] = local_8a8[0] + 0x400;
            local_898[0] = CRYPTO_realloc(local_898[0],(int)local_8a8[0],"b_print.c",0x2ed);
          }
LAB_0049d1a5:
          if (uVar25 < local_8a8[0]) {
            if (local_8b8[0] == (undefined1 *)0x0) {
              local_888[0] = uVar25 + 1;
              *(undefined1 *)((long)local_898[0] + uVar25) = 0x30;
            }
            else {
              local_888[0] = uVar25 + 1;
              local_8b8[0][uVar25] = 0x30;
            }
          }
        }
        for (; iVar2 != 0; iVar2 = iVar2 + 1) {
          while (uVar25 = local_888[0], local_8a8[0] <= local_888[0]) {
            while (local_898[0] == (void *)0x0) {
              iVar24 = (int)local_8a8[0];
              if (local_8a8[0] == 0) {
                local_8a8[0] = 0x400;
                iVar24 = 0x400;
              }
              local_898[0] = CRYPTO_malloc(iVar24,"b_print.c",0x2e5);
              uVar25 = 0;
              if (local_888[0] != 0) {
                memcpy(local_898[0],local_8b8[0],local_888[0]);
                uVar25 = local_888[0];
              }
              local_8b8[0] = (undefined1 *)0x0;
              if (uVar25 < local_8a8[0]) goto LAB_0049d265;
            }
            local_8a8[0] = local_8a8[0] + 0x400;
            local_898[0] = CRYPTO_realloc(local_898[0],(int)local_8a8[0],"b_print.c",0x2ed);
          }
LAB_0049d265:
          if (uVar25 < local_8a8[0]) {
            if (local_8b8[0] == (undefined1 *)0x0) {
              local_888[0] = uVar25 + 1;
              *(undefined1 *)((long)local_898[0] + uVar25) = 0x20;
            }
            else {
              local_888[0] = uVar25 + 1;
              local_8b8[0][uVar25] = 0x20;
            }
          }
        }
        break;
      case 'n':
                    // WARNING: Load size is inaccurate
        uVar27 = *args;
        if (iVar3 == 1) {
          if (uVar27 < 0x30) {
            puVar6 = (undefined8 *)((ulong)uVar27 + *(long *)((long)args + 0x10));
            *(uint *)args = uVar27 + 8;
          }
          else {
            puVar6 = *(undefined8 **)((long)args + 8);
            *(undefined8 **)((long)args + 8) = puVar6 + 1;
          }
          *(short *)*puVar6 = (short)local_888[0];
        }
        else if ((iVar3 == 2) || (iVar3 == 4)) {
          if (uVar27 < 0x30) {
            puVar6 = (undefined8 *)((ulong)uVar27 + *(long *)((long)args + 0x10));
            *(uint *)args = uVar27 + 8;
          }
          else {
            puVar6 = *(undefined8 **)((long)args + 8);
            *(undefined8 **)((long)args + 8) = puVar6 + 1;
          }
          *(ulong *)*puVar6 = local_888[0];
        }
        else {
          if (uVar27 < 0x30) {
            puVar6 = (undefined8 *)((ulong)uVar27 + *(long *)((long)args + 0x10));
            *(uint *)args = uVar27 + 8;
          }
          else {
            puVar6 = *(undefined8 **)((long)args + 8);
            *(undefined8 **)((long)args + 8) = puVar6 + 1;
          }
          *(int *)*puVar6 = (int)local_888[0];
        }
        break;
      case 'p':
                    // WARNING: Load size is inaccurate
        uVar27 = *args;
        if (uVar27 < 0x30) {
          puVar17 = (ulong *)((ulong)uVar27 + *(long *)((long)args + 0x10));
          *(uint *)args = uVar27 + 8;
        }
        else {
          puVar17 = *(ulong **)((long)args + 8);
          *(ulong **)((long)args + 8) = puVar17 + 1;
        }
        uVar21 = 0x10;
        local_8c0 = local_8c0 | 8;
        uVar25 = *puVar17;
LAB_0049c545:
        fmtint(local_8b8,local_898,local_888,local_8a8,uVar25,uVar21,iVar24,iVar2,local_8c0);
        break;
      case 's':
                    // WARNING: Load size is inaccurate
        uVar27 = *args;
        if (uVar27 < 0x30) {
          puVar6 = (undefined8 *)((ulong)uVar27 + *(long *)((long)args + 0x10));
          *(uint *)args = uVar27 + 8;
        }
        else {
          puVar6 = *(undefined8 **)((long)args + 8);
          *(undefined8 **)((long)args + 8) = puVar6 + 1;
        }
        pcVar23 = (char *)*puVar6;
        iVar19 = iVar2;
        if (iVar2 < 0) {
          iVar19 = 0x7fffffff;
        }
        bVar10 = iVar2 != 0;
        if (pcVar23 == (char *)0x0) {
          pcVar23 = "<NULL>";
        }
        cVar26 = *pcVar23;
        if (cVar26 == '\0') {
          iVar2 = 0;
        }
        else {
          iVar2 = 0;
          pcVar7 = pcVar23;
          do {
            pcVar7 = pcVar7 + 1;
            iVar2 = iVar2 + 1;
          } while (*pcVar7 != '\0');
        }
        uVar27 = 0;
        if (-1 < iVar24 - iVar2) {
          uVar27 = iVar24 - iVar2;
        }
        if ((local_8c0 & 1) != 0) {
          uVar27 = -uVar27;
        }
        uVar25 = (ulong)uVar27;
        iVar2 = 0;
        if ((0 < (int)uVar27) && (bVar10)) {
LAB_0049c620:
          do {
            uVar12 = local_888[0];
            if (local_8a8[0] <= local_888[0]) {
              do {
                if (local_898[0] != (void *)0x0) {
                  local_8a8[0] = local_8a8[0] + 0x400;
                  local_898[0] = CRYPTO_realloc(local_898[0],(int)local_8a8[0],"b_print.c",0x2ed);
                  goto LAB_0049c620;
                }
                iVar24 = (int)local_8a8[0];
                if (local_8a8[0] == 0) {
                  local_8a8[0] = 0x400;
                  iVar24 = 0x400;
                }
                local_898[0] = CRYPTO_malloc(iVar24,"b_print.c",0x2e5);
                uVar12 = 0;
                if (local_888[0] != 0) {
                  memcpy(local_898[0],local_8b8[0],local_888[0]);
                  uVar12 = local_888[0];
                }
                local_8b8[0] = (undefined1 *)0x0;
              } while (local_8a8[0] <= uVar12);
            }
            if (uVar12 < local_8a8[0]) {
              if (local_8b8[0] == (undefined1 *)0x0) {
                local_888[0] = uVar12 + 1;
                *(undefined1 *)((long)local_898[0] + uVar12) = 0x20;
              }
              else {
                local_888[0] = uVar12 + 1;
                local_8b8[0][uVar12] = 0x20;
              }
            }
            iVar2 = iVar2 + 1;
            uVar27 = (int)uVar25 - 1;
            uVar25 = (ulong)uVar27;
            bVar10 = iVar2 < iVar19;
          } while ((iVar2 < iVar19) && (0 < (int)uVar27));
          cVar26 = *pcVar23;
        }
        if (cVar26 == '\0') {
LAB_0049cd6a:
          if ((bVar10) && (iVar24 = (int)uVar25, uVar25 >> 0x1f != 0)) {
LAB_0049cda8:
            do {
              uVar12 = local_888[0];
              if (local_8a8[0] <= local_888[0]) {
                do {
                  if (local_898[0] != (void *)0x0) {
                    local_8a8[0] = local_8a8[0] + 0x400;
                    local_898[0] = CRYPTO_realloc(local_898[0],(int)local_8a8[0],"b_print.c",0x2ed);
                    goto LAB_0049cda8;
                  }
                  iVar3 = (int)local_8a8[0];
                  if (local_8a8[0] == 0) {
                    local_8a8[0] = 0x400;
                    iVar3 = 0x400;
                  }
                  local_898[0] = CRYPTO_malloc(iVar3,"b_print.c",0x2e5);
                  uVar12 = 0;
                  if (local_888[0] != 0) {
                    memcpy(local_898[0],local_8b8[0],local_888[0]);
                    uVar12 = local_888[0];
                  }
                  local_8b8[0] = (undefined1 *)0x0;
                } while (local_8a8[0] <= uVar12);
              }
              if (uVar12 < local_8a8[0]) {
                if (local_8b8[0] == (undefined1 *)0x0) {
                  local_888[0] = uVar12 + 1;
                  *(undefined1 *)((long)local_898[0] + uVar12) = 0x20;
                }
                else {
                  local_888[0] = uVar12 + 1;
                  local_8b8[0][uVar12] = 0x20;
                }
              }
              uVar27 = (int)uVar25 + 1;
              uVar25 = (ulong)uVar27;
            } while (((int)((iVar2 - iVar24) + uVar27) < iVar19) && ((int)uVar27 < 0));
          }
        }
        else if (iVar2 < iVar19) {
          do {
            pcVar23 = pcVar23 + 1;
            uVar12 = local_888[0];
            while (local_8a8[0] <= uVar12) {
              while (local_898[0] != (void *)0x0) {
                local_8a8[0] = local_8a8[0] + 0x400;
                local_898[0] = CRYPTO_realloc(local_898[0],(int)local_8a8[0],"b_print.c",0x2ed);
                uVar12 = local_888[0];
                if (local_888[0] < local_8a8[0]) goto LAB_0049c728;
              }
              iVar24 = (int)local_8a8[0];
              if (local_8a8[0] == 0) {
                local_8a8[0] = 0x400;
                iVar24 = 0x400;
              }
              local_898[0] = CRYPTO_malloc(iVar24,"b_print.c",0x2e5);
              uVar12 = 0;
              if (local_888[0] != 0) {
                memcpy(local_898[0],local_8b8[0],local_888[0]);
                uVar12 = local_888[0];
              }
              local_8b8[0] = (undefined1 *)0x0;
            }
LAB_0049c728:
            if (uVar12 < local_8a8[0]) {
              if (local_8b8[0] == (undefined1 *)0x0) {
                local_888[0] = uVar12 + 1;
                *(char *)((long)local_898[0] + uVar12) = cVar26;
              }
              else {
                local_888[0] = uVar12 + 1;
                local_8b8[0][uVar12] = cVar26;
              }
            }
            cVar26 = *pcVar23;
            iVar2 = iVar2 + 1;
            if (cVar26 == '\0') {
              bVar10 = iVar2 < iVar19;
              goto LAB_0049cd6a;
            }
          } while (iVar2 != iVar19);
        }
        break;
      case 'w':
        pcVar28 = pcVar28 + 1;
      }
switchD_0049c0bf_caseD_26:
      uVar27 = (uint)*pcVar28;
      iVar3 = 0;
      local_8c0 = 0;
      iVar19 = 0;
      iVar2 = -1;
      iVar24 = 0;
      pcVar28 = pcVar28 + 1;
      break;
    default:
      goto switchD_0049bee5_default;
    }
  } while( true );
switchD_0049bee5_default:
  if (iVar19 == 7) {
LAB_0049be29:
    uVar25 = local_8a8[0] - 1;
    uVar12 = local_888[0];
    if (uVar25 < local_888[0]) {
      uVar12 = uVar25;
      local_888[0] = uVar25;
    }
    while (local_8a8[0] <= uVar12) {
      if (local_898[0] == (void *)0x0) {
        iVar2 = (int)local_8a8[0];
        if (local_8a8[0] == 0) {
          local_8a8[0] = 0x400;
          iVar2 = 0x400;
        }
        local_898[0] = CRYPTO_malloc(iVar2,"b_print.c",0x2e5);
        uVar12 = 0;
        if (local_888[0] != 0) {
          memcpy(local_898[0],local_8b8[0],local_888[0]);
          uVar12 = local_888[0];
        }
        local_8b8[0] = (undefined1 *)0x0;
      }
      else {
        local_8a8[0] = local_8a8[0] + 0x400;
        local_898[0] = CRYPTO_realloc(local_898[0],(int)local_8a8[0],"b_print.c",0x2ed);
        uVar12 = local_888[0];
      }
    }
    if (local_8b8[0] == (undefined1 *)0x0) {
      *(undefined1 *)((long)local_898[0] + uVar12) = 0;
    }
    else {
      local_8b8[0][uVar12] = 0;
    }
    local_888[0] = uVar12 + 1;
    if (local_898[0] == (void *)0x0) {
      iVar2 = BIO_write(bio,local_838,(int)uVar12);
    }
    else {
      iVar2 = BIO_write(bio,local_898[0],(int)uVar12);
      CRYPTO_free(local_898[0]);
    }
    CRYPTO_pop_info();
    return iVar2;
  }
  goto LAB_0049be20;
}



int BIO_printf(BIO *bio,char *format,...)

{
  char in_AL;
  int iVar1;
  undefined8 in_RCX;
  undefined8 in_RDX;
  undefined8 in_R8;
  undefined8 in_R9;
  undefined8 in_XMM0_Qa;
  undefined8 in_XMM1_Qa;
  undefined8 in_XMM2_Qa;
  undefined8 in_XMM3_Qa;
  undefined8 in_XMM4_Qa;
  undefined8 in_XMM5_Qa;
  undefined8 in_XMM6_Qa;
  undefined8 in_XMM7_Qa;
  undefined4 local_d0;
  undefined4 local_cc;
  undefined1 *local_c8;
  undefined1 *local_c0;
  undefined1 local_b8 [16];
  undefined8 local_a8;
  undefined8 local_a0;
  undefined8 local_98;
  undefined8 local_90;
  undefined8 local_88;
  undefined8 local_78;
  undefined8 local_68;
  undefined8 local_58;
  undefined8 local_48;
  undefined8 local_38;
  undefined8 local_28;
  undefined8 local_18;
  
  if (in_AL != '\0') {
    local_88 = in_XMM0_Qa;
    local_78 = in_XMM1_Qa;
    local_68 = in_XMM2_Qa;
    local_58 = in_XMM3_Qa;
    local_48 = in_XMM4_Qa;
    local_38 = in_XMM5_Qa;
    local_28 = in_XMM6_Qa;
    local_18 = in_XMM7_Qa;
  }
  local_c8 = &stack0x00000008;
  local_c0 = local_b8;
  local_d0 = 0x10;
  local_cc = 0x30;
  local_a8 = in_RDX;
  local_a0 = in_RCX;
  local_98 = in_R8;
  local_90 = in_R9;
  iVar1 = BIO_vprintf(bio,format,&local_d0);
  return iVar1;
}



int BIO_snprintf(char *buf,size_t n,char *format,...)

{
  char in_AL;
  int iVar1;
  undefined8 in_RCX;
  undefined8 in_R8;
  undefined8 in_R9;
  undefined8 in_XMM0_Qa;
  undefined8 in_XMM1_Qa;
  undefined8 in_XMM2_Qa;
  undefined8 in_XMM3_Qa;
  undefined8 in_XMM4_Qa;
  undefined8 in_XMM5_Qa;
  undefined8 in_XMM6_Qa;
  undefined8 in_XMM7_Qa;
  int local_f8 [4];
  ulong local_e8;
  char *local_e0;
  size_t local_d8;
  undefined4 local_d0;
  undefined4 local_cc;
  undefined1 *local_c8;
  undefined1 *local_c0;
  undefined1 local_b8 [24];
  undefined8 local_a0;
  undefined8 local_98;
  undefined8 local_90;
  undefined8 local_88;
  undefined8 local_78;
  undefined8 local_68;
  undefined8 local_58;
  undefined8 local_48;
  undefined8 local_38;
  undefined8 local_28;
  undefined8 local_18;
  
  if (in_AL != '\0') {
    local_88 = in_XMM0_Qa;
    local_78 = in_XMM1_Qa;
    local_68 = in_XMM2_Qa;
    local_58 = in_XMM3_Qa;
    local_48 = in_XMM4_Qa;
    local_38 = in_XMM5_Qa;
    local_28 = in_XMM6_Qa;
    local_18 = in_XMM7_Qa;
  }
  local_c8 = &stack0x00000008;
  local_c0 = local_b8;
  local_d0 = 0x18;
  local_cc = 0x30;
  local_e0 = buf;
  local_d8 = n;
  local_a0 = in_RCX;
  local_98 = in_R8;
  local_90 = in_R9;
  _dopr_constprop_0(&local_e0,&local_d8,&local_e8,local_f8,format,&local_d0);
  if (local_f8[0] == 0) {
    iVar1 = -1;
    if (local_e8 < 0x80000000) {
      iVar1 = (int)local_e8;
    }
  }
  else {
    iVar1 = -1;
  }
  return iVar1;
}



int BIO_vsnprintf(char *buf,size_t n,char *format,va_list args)

{
  int iVar1;
  size_t local_38;
  char *local_30;
  int local_28 [4];
  ulong local_18 [3];
  
  local_38 = n;
  local_30 = buf;
  _dopr_constprop_0(&local_30,&local_38,local_18,local_28,format,args);
  if (local_28[0] == 0) {
    iVar1 = -1;
    if (local_18[0] < 0x80000000) {
      iVar1 = (int)local_18[0];
    }
  }
  else {
    iVar1 = -1;
  }
  return iVar1;
}



ulong lh_strhash(char *c)

{
  byte bVar1;
  ulong uVar2;
  byte bVar3;
  ulong uVar4;
  ulong uVar5;
  
  if ((c != (char *)0x0) && (bVar3 = *c, bVar3 != 0)) {
    uVar4 = 0;
    uVar5 = 0x100;
    do {
      uVar2 = (long)(char)bVar3 | uVar5;
      c = (char *)((byte *)c + 1);
      uVar5 = uVar5 + 0x100;
      bVar1 = ((byte)(uVar2 >> 2) ^ bVar3) & 0xf;
      bVar3 = *c;
      uVar4 = (ulong)((uint)(uVar4 >> (0x20 - bVar1 & 0x3f)) | (uint)(uVar4 << bVar1)) ^
              uVar2 * uVar2;
    } while (bVar3 != 0);
    return uVar4 >> 0x10 ^ uVar4;
  }
  return 0;
}



_LHASH * lh_new(LHASH_HASH_FN_TYPE h,LHASH_COMP_FN_TYPE c)

{
  _LHASH *ptr;
  LHASH_NODE **ppLVar1;
  code *pcVar2;
  
  ptr = (_LHASH *)CRYPTO_malloc(0xb0,"lhash.c",0x77);
  if (ptr == (_LHASH *)0x0) {
    ptr = (_LHASH *)0x0;
  }
  else {
    ppLVar1 = (LHASH_NODE **)CRYPTO_malloc(0x80,"lhash.c",0x79);
    ptr->b = ppLVar1;
    if (ppLVar1 == (LHASH_NODE **)0x0) {
      CRYPTO_free(ptr);
      ptr = (_LHASH *)0x0;
    }
    else {
      *ppLVar1 = (LHASH_NODE *)0x0;
      ptr->b[1] = (LHASH_NODE *)0x0;
      ptr->b[2] = (LHASH_NODE *)0x0;
      ptr->b[3] = (LHASH_NODE *)0x0;
      ptr->b[4] = (LHASH_NODE *)0x0;
      ptr->b[5] = (LHASH_NODE *)0x0;
      ptr->b[6] = (LHASH_NODE *)0x0;
      ptr->b[7] = (LHASH_NODE *)0x0;
      ptr->b[8] = (LHASH_NODE *)0x0;
      ptr->b[9] = (LHASH_NODE *)0x0;
      ptr->b[10] = (LHASH_NODE *)0x0;
      ptr->b[0xb] = (LHASH_NODE *)0x0;
      ptr->b[0xc] = (LHASH_NODE *)0x0;
      ptr->b[0xd] = (LHASH_NODE *)0x0;
      ptr->b[0xe] = (LHASH_NODE *)0x0;
      ptr->b[0xf] = (LHASH_NODE *)0x0;
      pcVar2 = strcmp;
      if (c != (LHASH_COMP_FN_TYPE)0x0) {
        pcVar2 = c;
      }
      ptr->comp = pcVar2;
      pcVar2 = lh_strhash;
      if (h != (LHASH_HASH_FN_TYPE)0x0) {
        pcVar2 = h;
      }
      ptr->hash = pcVar2;
      ptr->num_nodes = 8;
      ptr->num_alloc_nodes = 0x10;
      ptr->p = 0;
      ptr->pmax = 8;
      ptr->up_load = 0x200;
      ptr->down_load = 0x100;
      ptr->num_items = 0;
      ptr->num_expands = 0;
      ptr->num_expand_reallocs = 0;
      ptr->num_contracts = 0;
      ptr->num_contract_reallocs = 0;
      ptr->num_hash_calls = 0;
      ptr->num_comp_calls = 0;
      ptr->num_insert = 0;
      ptr->num_replace = 0;
      ptr->num_delete = 0;
      ptr->num_no_delete = 0;
      ptr->num_retrieve = 0;
      ptr->num_retrieve_miss = 0;
      ptr->num_hash_comps = 0;
      ptr->error = 0;
    }
  }
  return ptr;
}



void lh_free(_LHASH *lh)

{
  lhash_node_st *plVar1;
  LHASH_NODE **ptr;
  uint uVar2;
  uint uVar3;
  ulong uVar4;
  LHASH_NODE *ptr_00;
  
  if (lh == (_LHASH *)0x0) {
    return;
  }
  uVar2 = lh->num_nodes;
  uVar4 = 0;
  ptr = lh->b;
  if (uVar2 != 0) {
    do {
      ptr_00 = ptr[uVar4];
      if (ptr[uVar4] != (LHASH_NODE *)0x0) {
        do {
          plVar1 = ptr_00->next;
          CRYPTO_free(ptr_00);
          ptr_00 = plVar1;
        } while (plVar1 != (lhash_node_st *)0x0);
        ptr = lh->b;
        uVar2 = lh->num_nodes;
      }
      uVar3 = (int)uVar4 + 1;
      uVar4 = (ulong)uVar3;
    } while (uVar3 < uVar2);
  }
  CRYPTO_free(ptr);
  CRYPTO_free(lh);
  return;
}



void * lh_insert(_LHASH *lh,void *data)

{
  uint uVar1;
  uint uVar2;
  LHASH_COMP_FN_TYPE pLVar3;
  LHASH_NODE *pLVar4;
  void *pvVar5;
  LHASH_NODE **ppLVar6;
  int iVar7;
  ulong uVar8;
  LHASH_NODE **ppLVar9;
  lhash_node_st *plVar10;
  uint uVar11;
  uint uVar12;
  ulong uVar13;
  lhash_node_st **pplVar14;
  
  lh->error = 0;
  if (lh->up_load <= (lh->num_items << 8) / (ulong)lh->num_nodes) {
    uVar1 = lh->p;
    uVar2 = lh->pmax;
    ppLVar6 = lh->b;
    uVar11 = lh->num_alloc_nodes;
    lh->num_nodes = lh->num_nodes + 1;
    lh->num_expands = lh->num_expands + 1;
    ppLVar9 = ppLVar6 + (uVar1 + uVar2);
    lh->p = uVar1 + 1;
    *ppLVar9 = (LHASH_NODE *)0x0;
    pplVar14 = ppLVar6 + uVar1;
    while (plVar10 = *pplVar14, plVar10 != (lhash_node_st *)0x0) {
      while ((ulong)uVar1 != plVar10->hash % (ulong)uVar11) {
        *pplVar14 = plVar10->next;
        plVar10->next = *ppLVar9;
        *ppLVar9 = plVar10;
        plVar10 = *pplVar14;
        if (plVar10 == (lhash_node_st *)0x0) goto LAB_0049ddda;
      }
      pplVar14 = &plVar10->next;
    }
LAB_0049ddda:
    if (uVar2 <= uVar1 + 1) {
      uVar1 = uVar11 * 2;
      ppLVar9 = (LHASH_NODE **)CRYPTO_realloc(lh->b,uVar11 << 4,"lhash.c",0x15b);
      if (ppLVar9 == (LHASH_NODE **)0x0) {
        lh->error = lh->error + 1;
        lh->p = 0;
      }
      else {
        uVar2 = lh->num_alloc_nodes;
        uVar11 = uVar2;
        if (uVar2 < uVar1) {
          do {
            uVar12 = uVar11 + 1;
            ppLVar9[uVar11] = (LHASH_NODE *)0x0;
            uVar11 = uVar12;
          } while (uVar1 != uVar12);
        }
        lh->pmax = uVar2;
        lh->num_alloc_nodes = uVar1;
        lh->num_expand_reallocs = lh->num_expand_reallocs + 1;
        lh->p = 0;
        lh->b = ppLVar9;
      }
    }
  }
  uVar8 = (*lh->hash)(data);
  lh->num_hash_calls = lh->num_hash_calls + 1;
  uVar13 = uVar8 % (ulong)lh->pmax;
  iVar7 = (int)uVar13;
  if (uVar13 < lh->p) {
    iVar7 = (int)(uVar8 % (ulong)lh->num_alloc_nodes);
  }
  pLVar3 = lh->comp;
  pplVar14 = lh->b + iVar7;
  pLVar4 = *pplVar14;
  do {
    if (pLVar4 == (LHASH_NODE *)0x0) {
LAB_0049de60:
      plVar10 = (lhash_node_st *)CRYPTO_malloc(0x18,"lhash.c",0xc1);
      if (plVar10 == (lhash_node_st *)0x0) {
        lh->error = lh->error + 1;
      }
      else {
        plVar10->data = data;
        plVar10->next = (lhash_node_st *)0x0;
        plVar10->hash = uVar8;
        *pplVar14 = plVar10;
        lh->num_insert = lh->num_insert + 1;
        lh->num_items = lh->num_items + 1;
      }
      return (void *)0x0;
    }
    lh->num_hash_comps = lh->num_hash_comps + 1;
    if (uVar8 == pLVar4->hash) {
      lh->num_comp_calls = lh->num_comp_calls + 1;
      iVar7 = (*pLVar3)(pLVar4->data,data);
      if (iVar7 == 0) {
        plVar10 = *pplVar14;
        if (plVar10 != (lhash_node_st *)0x0) {
          pvVar5 = plVar10->data;
          plVar10->data = data;
          lh->num_replace = lh->num_replace + 1;
          return pvVar5;
        }
        goto LAB_0049de60;
      }
    }
    pplVar14 = &pLVar4->next;
    pLVar4 = pLVar4->next;
  } while( true );
}



void * lh_delete(_LHASH *lh,void *data)

{
  uint uVar1;
  LHASH_COMP_FN_TYPE pLVar2;
  LHASH_NODE *pLVar3;
  lhash_node_st *ptr;
  void *pvVar4;
  LHASH_NODE *pLVar5;
  lhash_node_st **pplVar6;
  int iVar7;
  ulong uVar8;
  LHASH_NODE **ppLVar9;
  uint uVar10;
  uint uVar11;
  ulong uVar12;
  LHASH_NODE *pLVar13;
  
  lh->error = 0;
  uVar8 = (*lh->hash)(data);
  lh->num_hash_calls = lh->num_hash_calls + 1;
  uVar12 = uVar8 % (ulong)lh->pmax;
  iVar7 = (int)uVar12;
  if (uVar12 < lh->p) {
    iVar7 = (int)(uVar8 % (ulong)lh->num_alloc_nodes);
  }
  pLVar2 = lh->comp;
  pplVar6 = lh->b + iVar7;
  pLVar3 = *pplVar6;
  do {
    if (pLVar3 == (LHASH_NODE *)0x0) {
LAB_0049e020:
      lh->num_no_delete = lh->num_no_delete + 1;
      return (void *)0x0;
    }
    lh->num_hash_comps = lh->num_hash_comps + 1;
    if (uVar8 == pLVar3->hash) {
      lh->num_comp_calls = lh->num_comp_calls + 1;
      iVar7 = (*pLVar2)(pLVar3->data,data);
      if (iVar7 == 0) {
        ptr = *pplVar6;
        if (ptr != (lhash_node_st *)0x0) {
          *pplVar6 = ptr->next;
          pvVar4 = ptr->data;
          CRYPTO_free(ptr);
          uVar10 = lh->num_nodes;
          lh->num_delete = lh->num_delete + 1;
          uVar8 = lh->num_items - 1;
          lh->num_items = uVar8;
          if (uVar10 < 0x11) {
            return pvVar4;
          }
          if (lh->down_load < (uVar8 * 0x100) / (ulong)uVar10) {
            return pvVar4;
          }
          uVar11 = lh->p;
          uVar1 = lh->pmax;
          pLVar3 = lh->b[(uVar11 - 1) + uVar1];
          lh->b[(uVar11 - 1) + uVar1] = (LHASH_NODE *)0x0;
          if (uVar11 == 0) {
            ppLVar9 = (LHASH_NODE **)CRYPTO_realloc(lh->b,uVar1 << 3,"lhash.c",0x177);
            if (ppLVar9 == (LHASH_NODE **)0x0) {
              lh->error = lh->error + 1;
              return pvVar4;
            }
            lh->num_contract_reallocs = lh->num_contract_reallocs + 1;
            lh->num_alloc_nodes = lh->num_alloc_nodes >> 1;
            lh->b = ppLVar9;
            uVar10 = lh->num_nodes;
            uVar11 = lh->pmax >> 1;
            lh->pmax = uVar11;
            uVar11 = uVar11 - 1;
            lh->p = uVar11;
          }
          else {
            uVar11 = uVar11 - 1;
            ppLVar9 = lh->b;
            lh->p = uVar11;
          }
          lh->num_contracts = lh->num_contracts + 1;
          lh->num_nodes = uVar10 - 1;
          pLVar5 = ppLVar9[(int)uVar11];
          if (pLVar5 == (LHASH_NODE *)0x0) {
            ppLVar9[(int)uVar11] = pLVar3;
            return pvVar4;
          }
          do {
            pLVar13 = pLVar5;
            pLVar5 = pLVar13->next;
          } while (pLVar5 != (lhash_node_st *)0x0);
          pLVar13->next = pLVar3;
          return pvVar4;
        }
        goto LAB_0049e020;
      }
    }
    pplVar6 = &pLVar3->next;
    pLVar3 = pLVar3->next;
  } while( true );
}



void * lh_retrieve(_LHASH *lh,void *data)

{
  LHASH_COMP_FN_TYPE pLVar1;
  LHASH_NODE *pLVar2;
  void *pvVar3;
  lhash_node_st **pplVar4;
  int iVar5;
  ulong uVar6;
  ulong uVar7;
  
  lh->error = 0;
  uVar6 = (*lh->hash)(data);
  lh->num_hash_calls = lh->num_hash_calls + 1;
  uVar7 = uVar6 % (ulong)lh->pmax;
  iVar5 = (int)uVar7;
  if (uVar7 < lh->p) {
    iVar5 = (int)(uVar6 % (ulong)lh->num_alloc_nodes);
  }
  pLVar1 = lh->comp;
  pplVar4 = lh->b + iVar5;
  pLVar2 = *pplVar4;
  do {
    if (pLVar2 == (LHASH_NODE *)0x0) {
LAB_0049e150:
      lh->num_retrieve_miss = lh->num_retrieve_miss + 1;
      return (void *)0x0;
    }
    lh->num_hash_comps = lh->num_hash_comps + 1;
    if (uVar6 == pLVar2->hash) {
      lh->num_comp_calls = lh->num_comp_calls + 1;
      iVar5 = (*pLVar1)(pLVar2->data,data);
      if (iVar5 == 0) {
        if (*pplVar4 != (lhash_node_st *)0x0) {
          pvVar3 = (*pplVar4)->data;
          lh->num_retrieve = lh->num_retrieve + 1;
          return pvVar3;
        }
        goto LAB_0049e150;
      }
    }
    pplVar4 = &pLVar2->next;
    pLVar2 = pLVar2->next;
  } while( true );
}



void lh_doall(_LHASH *lh,LHASH_DOALL_FN_TYPE func)

{
  undefined8 *puVar1;
  undefined8 *puVar2;
  int iVar3;
  long lVar4;
  
  if ((lh != (_LHASH *)0x0) && (iVar3 = lh->num_nodes - 1, -1 < iVar3)) {
    lVar4 = (long)iVar3 << 3;
    do {
      puVar2 = *(undefined8 **)((long)lh->b + lVar4);
      while (puVar2 != (undefined8 *)0x0) {
        puVar1 = (undefined8 *)puVar2[1];
        (*func)((void *)*puVar2);
        puVar2 = puVar1;
      }
      lVar4 = lVar4 + -8;
      iVar3 = iVar3 + -1;
    } while (-1 < iVar3);
  }
  return;
}



void lh_doall_arg(_LHASH *lh,LHASH_DOALL_ARG_FN_TYPE func,void *arg)

{
  undefined8 *puVar1;
  undefined8 *puVar2;
  int iVar3;
  long lVar4;
  
  if ((lh != (_LHASH *)0x0) && (iVar3 = lh->num_nodes - 1, -1 < iVar3)) {
    lVar4 = (long)iVar3 << 3;
    do {
      puVar2 = *(undefined8 **)((long)lh->b + lVar4);
      while (puVar2 != (undefined8 *)0x0) {
        puVar1 = (undefined8 *)puVar2[1];
        (*func)((void *)*puVar2,arg);
        puVar2 = puVar1;
      }
      lVar4 = lVar4 + -8;
      iVar3 = iVar3 + -1;
    } while (-1 < iVar3);
  }
  return;
}



ulong lh_num_items(_LHASH *lh)

{
  if (lh != (_LHASH *)0x0) {
    return lh->num_items;
  }
  return 0;
}



int i2d_ASN1_OBJECT(ASN1_OBJECT *a,uchar **pp)

{
  int iVar1;
  uchar *local_28 [2];
  
  iVar1 = 0;
  if ((a != (ASN1_OBJECT *)0x0) && (iVar1 = 0, a->data != (uchar *)0x0)) {
    iVar1 = ASN1_object_size(0,a->length,6);
    if (pp != (uchar **)0x0) {
      local_28[0] = *pp;
      ASN1_put_object(local_28,0,a->length,6,0);
      memcpy(local_28[0],a->data,(long)a->length);
      *pp = local_28[0] + a->length;
    }
  }
  return iVar1;
}



int a2d_ASN1_OBJECT(uchar *out,int olen,char *buf,int num)

{
  uint uVar1;
  uint uVar2;
  byte bVar3;
  bool bVar4;
  byte *pbVar5;
  byte *pbVar6;
  size_t sVar7;
  int iVar8;
  ulong uVar9;
  ulong uVar10;
  byte *pbVar11;
  int iVar12;
  char *pcVar13;
  int iVar15;
  BIGNUM *local_a8;
  byte *local_98;
  int local_8c;
  byte *local_80;
  int local_60;
  byte local_58 [40];
  char *pcVar14;
  
  if (num != 0) {
    if (num == -1) {
      sVar7 = strlen(buf);
      num = (int)sVar7;
    }
    uVar2 = (int)*buf - 0x30;
    if (uVar2 < 3) {
      if (num < 2) {
        ERR_put_error(0xd,100,0x8a,"a_object.c",0x73);
      }
      else {
        iVar8 = num + -2;
        pcVar13 = buf + 2;
        if (iVar8 != 0) {
          if ((buf[1] == '.') || (buf[1] == ' ')) {
            local_60 = 0x18;
            local_8c = 0;
            local_a8 = (BIGNUM *)0x0;
            local_98 = local_58;
            do {
              uVar9 = 0;
              bVar4 = false;
              pcVar14 = pcVar13;
              do {
                while( true ) {
                  pcVar13 = pcVar14 + 1;
                  iVar12 = (int)*pcVar14;
                  iVar8 = iVar8 + -1;
                  if ((iVar12 == 0x2e) || (iVar12 == 0x20)) goto LAB_0049e45a;
                  uVar1 = iVar12 - 0x30;
                  if (9 < uVar1) {
                    ERR_put_error(0xd,100,0x82,"a_object.c",0x8b);
                    goto LAB_0049e5c4;
                  }
                  pcVar14 = pcVar13;
                  if ((uVar9 < 0x1999999999999991) || (bVar4)) break;
                  if (((local_a8 == (BIGNUM *)0x0) &&
                      (local_a8 = BN_new(), local_a8 == (BIGNUM *)0x0)) ||
                     (iVar15 = BN_set_word(local_a8,uVar9), iVar15 == 0)) goto LAB_0049e5c4;
                  bVar4 = true;
LAB_0049e3d9:
                  iVar15 = BN_mul_word(local_a8,10);
                  if ((iVar15 == 0) ||
                     (iVar15 = BN_add_word(local_a8,(long)(int)uVar1), iVar15 == 0))
                  goto LAB_0049e5c4;
                  if (iVar8 == 0) goto LAB_0049e45a;
                }
                if (bVar4) goto LAB_0049e3d9;
                uVar9 = (long)(int)uVar1 + uVar9 * 10;
              } while (iVar8 != 0);
LAB_0049e45a:
              if (local_8c == 0) {
                if ((0x27 < uVar9) && ((int)uVar2 < 2)) {
                  ERR_put_error(0xd,100,0x93,"a_object.c",0xa3);
                  goto LAB_0049e5c4;
                }
                uVar9 = uVar9 + (long)(int)uVar2 * 0x28;
                if (!bVar4) goto LAB_0049e485;
                iVar15 = BN_add_word(local_a8,(long)(int)(uVar2 * 0x28));
                if (iVar15 == 0) goto LAB_0049e5c4;
LAB_0049e628:
                iVar15 = BN_num_bits(local_a8);
                iVar15 = (iVar15 + 6) / 7;
                if (local_60 < iVar15) {
                  if (local_98 != local_58) {
                    CRYPTO_free(local_98);
                  }
                  local_60 = iVar15 + 0x20;
                  local_98 = (byte *)CRYPTO_malloc(local_60,"a_object.c",0xb9);
                  if (local_98 == (byte *)0x0) goto LAB_0049e5d0;
LAB_0049e68f:
                  pbVar5 = local_98;
                  do {
                    pbVar11 = pbVar5 + 1;
                    uVar9 = BN_div_word(local_a8,0x80);
                    *pbVar5 = (byte)uVar9;
                    pbVar5 = pbVar11;
                  } while (pbVar11 != local_98 + (ulong)(iVar15 - 1) + 1);
                }
                else if (iVar15 != 0) goto LAB_0049e68f;
              }
              else {
                if (bVar4) goto LAB_0049e628;
LAB_0049e485:
                iVar15 = 0;
                pbVar5 = local_98;
                do {
                  uVar10 = uVar9 >> 7;
                  iVar15 = iVar15 + 1;
                  *pbVar5 = (byte)uVar9 & 0x7f;
                  pbVar5 = pbVar5 + 1;
                  uVar9 = uVar10;
                } while (uVar10 != 0);
              }
              if (out == (uchar *)0x0) {
                local_8c = local_8c + iVar15;
              }
              else {
                if (olen < local_8c + iVar15) {
                  ERR_put_error(0xd,100,0x6b,"a_object.c",0xcf);
                  goto LAB_0049e5c4;
                }
                if (0 < iVar15 + -1) {
                  pbVar11 = local_98 + (iVar15 + -1);
                  pbVar5 = out + local_8c;
                  do {
                    bVar3 = *pbVar11;
                    pbVar6 = pbVar5 + 1;
                    pbVar11 = pbVar11 + -1;
                    *pbVar5 = bVar3 | 0x80;
                    pbVar5 = pbVar6;
                  } while (pbVar6 != out + (ulong)(iVar15 - 2U) + (long)local_8c + 1);
                  local_8c = local_8c + 1 + (iVar15 - 2U);
                }
                out[local_8c] = *local_98;
                local_8c = local_8c + 1;
              }
              if (iVar8 == 0) {
                if (local_98 != local_58) {
                  CRYPTO_free(local_98);
                }
                if (local_a8 == (BIGNUM *)0x0) {
                  return local_8c;
                }
                BN_free(local_a8);
                return local_8c;
              }
            } while ((iVar12 == 0x20) || (iVar12 == 0x2e));
          }
          else {
            local_98 = local_58;
            local_a8 = (BIGNUM *)0x0;
          }
          ERR_put_error(0xd,100,0x83,"a_object.c",0x7d);
LAB_0049e5c4:
          local_80 = local_58;
          if (local_98 != local_80) {
LAB_0049e5d0:
            CRYPTO_free(local_98);
          }
          if (local_a8 != (BIGNUM *)0x0) {
            BN_free(local_a8);
            return 0;
          }
        }
      }
    }
    else {
      ERR_put_error(0xd,100,0x7a,"a_object.c",0x6d);
    }
  }
  return 0;
}



int i2t_ASN1_OBJECT(char *buf,int buf_len,ASN1_OBJECT *a)

{
  int iVar1;
  
  iVar1 = OBJ_obj2txt(buf,buf_len,a,0);
  return iVar1;
}



int i2a_ASN1_OBJECT(BIO *bp,ASN1_OBJECT *a)

{
  int len;
  char *buf;
  char acStack_88 [88];
  
  if ((a == (ASN1_OBJECT *)0x0) || (a->data == (uchar *)0x0)) {
    len = BIO_write(bp,"NULL",4);
  }
  else {
    len = OBJ_obj2txt(acStack_88,0x50,a,0);
    if (len < 0x50) {
      if (len < 1) {
        len = BIO_write(bp,"<INVALID>",9);
      }
      else {
        BIO_write(bp,acStack_88,len);
      }
    }
    else {
      buf = (char *)CRYPTO_malloc(len + 1,"a_object.c",0xf5);
      if (buf == (char *)0x0) {
        len = -1;
      }
      else {
        OBJ_obj2txt(buf,len + 1,a,0);
        BIO_write(bp,buf,len);
        if (buf != acStack_88) {
          CRYPTO_free(buf);
        }
      }
    }
  }
  return len;
}



ASN1_OBJECT * c2i_ASN1_OBJECT(ASN1_OBJECT **a,uchar **pp,long length)

{
  uint uVar1;
  uchar *puVar2;
  ASN1_OBJECT *ptr;
  void *__dest;
  uchar *puVar3;
  uchar *puVar4;
  int iVar5;
  int num;
  
  puVar3 = *pp;
  if (0 < length) {
    puVar2 = puVar3;
    do {
      if ((*puVar2 == 0x80) && (((int)puVar2 == (int)puVar3 || (-1 < (char)puVar2[-1])))) {
        ERR_put_error(0xd,0xc4,0xd8,"a_object.c",300);
        return (ASN1_OBJECT *)0x0;
      }
      puVar2 = puVar2 + 1;
    } while (puVar2 != puVar3 + length);
  }
  iVar5 = (int)length;
  if (((a == (ASN1_OBJECT **)0x0) || (ptr = *a, ptr == (ASN1_OBJECT *)0x0)) ||
     ((ptr->flags & 1) == 0)) {
    ptr = (ASN1_OBJECT *)CRYPTO_malloc(0x28,"a_object.c",0x15f);
    if (ptr == (ASN1_OBJECT *)0x0) {
      ERR_put_error(0xd,0x7b,0x41,"a_object.c",0x162);
      return (ASN1_OBJECT *)0x0;
    }
    ptr->data = (uchar *)0x0;
    ptr->sn = (char *)0x0;
    ptr->ln = (char **)0x0;
    puVar3 = *pp;
    ptr->length = 0;
    ptr->nid = 0;
    ptr->flags = 1;
LAB_0049e9ca:
    ptr->length = 0;
LAB_0049e9d2:
    num = 1;
    if (iVar5 != 0) {
      num = iVar5;
    }
    __dest = CRYPTO_malloc(num,"a_object.c",0x143);
    if (__dest == (void *)0x0) {
      ERR_put_error(0xd,0xc4,0x41,"a_object.c",0x155);
      if ((a == (ASN1_OBJECT **)0x0) || (*a != ptr)) {
        uVar1 = ptr->flags;
        if ((uVar1 & 4) != 0) {
          if (ptr->sn != (char *)0x0) {
            CRYPTO_free(ptr->sn);
          }
          if (ptr->ln != (char **)0x0) {
            CRYPTO_free(ptr->ln);
          }
          uVar1 = ptr->flags;
          ptr->ln = (char **)0x0;
          ptr->sn = (char *)0x0;
        }
        if ((uVar1 & 8) != 0) {
          if (ptr->data != (uchar *)0x0) {
            CRYPTO_free(ptr->data);
            uVar1 = ptr->flags;
          }
          ptr->data = (uchar *)0x0;
          ptr->length = 0;
        }
        if ((uVar1 & 1) != 0) {
          CRYPTO_free(ptr);
          return (ASN1_OBJECT *)0x0;
        }
      }
      return (ASN1_OBJECT *)0x0;
    }
    ptr->flags = ptr->flags | 8;
    puVar2 = puVar3 + length;
    puVar3 = (uchar *)memcpy(__dest,puVar3,(long)iVar5);
    ptr->data = puVar3;
    ptr->length = iVar5;
    ptr->sn = (char *)0x0;
    ptr->ln = (char **)0x0;
    if (a == (ASN1_OBJECT **)0x0) goto LAB_0049ea2a;
  }
  else {
    puVar2 = ptr->data;
    ptr->data = (uchar *)0x0;
    if (puVar2 == (uchar *)0x0) goto LAB_0049e9ca;
    if (ptr->length < length) {
      ptr->length = 0;
      CRYPTO_free(puVar2);
      goto LAB_0049e9d2;
    }
    puVar4 = (uchar *)memcpy(puVar2,puVar3,(long)iVar5);
    puVar2 = puVar3 + length;
    ptr->data = puVar4;
    ptr->length = iVar5;
    ptr->sn = (char *)0x0;
    ptr->ln = (char **)0x0;
  }
  *a = ptr;
LAB_0049ea2a:
  *pp = puVar2;
  return ptr;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

ASN1_OBJECT * ASN1_OBJECT_new(void)

{
  ASN1_OBJECT *pAVar1;
  
  pAVar1 = (ASN1_OBJECT *)CRYPTO_malloc(0x28,"a_object.c",0x15f);
  if (pAVar1 == (ASN1_OBJECT *)0x0) {
    ERR_put_error(0xd,0x7b,0x41,"a_object.c",0x162);
    pAVar1 = (ASN1_OBJECT *)0x0;
  }
  else {
    pAVar1->length = 0;
    pAVar1->data = (uchar *)0x0;
    pAVar1->nid = 0;
    pAVar1->sn = (char *)0x0;
    pAVar1->ln = (char **)0x0;
    pAVar1->flags = 1;
  }
  return pAVar1;
}



void ASN1_OBJECT_free(ASN1_OBJECT *a)

{
  uint uVar1;
  
  if (a != (ASN1_OBJECT *)0x0) {
    uVar1 = a->flags;
    if ((uVar1 & 4) != 0) {
      if (a->sn != (char *)0x0) {
        CRYPTO_free(a->sn);
      }
      if (a->ln != (char **)0x0) {
        CRYPTO_free(a->ln);
      }
      uVar1 = a->flags;
      a->ln = (char **)0x0;
      a->sn = (char *)0x0;
    }
    if ((uVar1 & 8) != 0) {
      if (a->data != (uchar *)0x0) {
        CRYPTO_free(a->data);
        uVar1 = a->flags;
      }
      a->data = (uchar *)0x0;
      a->length = 0;
    }
    if ((uVar1 & 1) != 0) {
      CRYPTO_free(a);
      return;
    }
  }
  return;
}



ASN1_OBJECT * d2i_ASN1_OBJECT(ASN1_OBJECT **a,uchar **pp,long length)

{
  uint uVar1;
  uchar *puVar2;
  uchar *puVar3;
  ASN1_OBJECT *a_00;
  void *__dest;
  uchar *puVar4;
  int iVar5;
  int num;
  int local_68 [4];
  int local_58 [4];
  uchar *local_48 [2];
  long local_38 [2];
  
  local_48[0] = *pp;
  uVar1 = ASN1_get_object(local_48,local_38,local_68,local_58,length);
  puVar4 = local_48[0];
  if ((uVar1 & 0x80) != 0) {
    iVar5 = 0x66;
LAB_0049ede5:
    ERR_put_error(0xd,0x93,iVar5,"a_object.c",0x11b);
    return (ASN1_OBJECT *)0x0;
  }
  if (local_68[0] != 6) {
    iVar5 = 0x74;
    goto LAB_0049ede5;
  }
  if (0 < local_38[0]) {
    puVar2 = local_48[0];
    do {
      if ((*puVar2 == 0x80) && (((int)local_48[0] == (int)puVar2 || (-1 < (char)puVar2[-1])))) {
        ERR_put_error(0xd,0xc4,0xd8,"a_object.c",300);
        goto LAB_0049edc7;
      }
      puVar2 = puVar2 + 1;
    } while (puVar2 != local_48[0] + local_38[0]);
  }
  iVar5 = (int)local_38[0];
  if (((a == (ASN1_OBJECT **)0x0) || (a_00 = *a, a_00 == (ASN1_OBJECT *)0x0)) ||
     ((a_00->flags & 1) == 0)) {
    a_00 = (ASN1_OBJECT *)CRYPTO_malloc(0x28,"a_object.c",0x15f);
    if (a_00 != (ASN1_OBJECT *)0x0) {
      a_00->length = 0;
      a_00->nid = 0;
      a_00->sn = (char *)0x0;
      a_00->ln = (char **)0x0;
      a_00->flags = 1;
      a_00->data = (uchar *)0x0;
      goto LAB_0049ee61;
    }
    ERR_put_error(0xd,0x7b,0x41,"a_object.c",0x162);
LAB_0049edc7:
    a_00 = (ASN1_OBJECT *)0x0;
  }
  else {
    puVar2 = a_00->data;
    a_00->data = (uchar *)0x0;
    if (puVar2 == (uchar *)0x0) {
LAB_0049ee61:
      a_00->length = 0;
      puVar4 = local_48[0];
LAB_0049ee69:
      num = 1;
      if (iVar5 != 0) {
        num = iVar5;
      }
      __dest = CRYPTO_malloc(num,"a_object.c",0x143);
      if (__dest == (void *)0x0) {
        ERR_put_error(0xd,0xc4,0x41,"a_object.c",0x155);
        if ((a == (ASN1_OBJECT **)0x0) || (a_00 != *a)) {
          ASN1_OBJECT_free(a_00);
        }
        goto LAB_0049edc7;
      }
      a_00->flags = a_00->flags | 8;
      puVar2 = puVar4 + local_38[0];
      puVar4 = (uchar *)memcpy(__dest,puVar4,(long)iVar5);
      a_00->data = puVar4;
      a_00->length = iVar5;
      a_00->sn = (char *)0x0;
      a_00->ln = (char **)0x0;
      if (a != (ASN1_OBJECT **)0x0) goto LAB_0049ed89;
    }
    else {
      if (a_00->length < local_38[0]) {
        a_00->length = 0;
        CRYPTO_free(puVar2);
        goto LAB_0049ee69;
      }
      puVar3 = (uchar *)memcpy(puVar2,local_48[0],(long)iVar5);
      puVar2 = puVar4 + local_38[0];
      a_00->data = puVar3;
      a_00->length = iVar5;
      a_00->sn = (char *)0x0;
      a_00->ln = (char **)0x0;
LAB_0049ed89:
      *a = a_00;
    }
    *pp = puVar2;
  }
  return a_00;
}



ASN1_OBJECT * ASN1_OBJECT_create(int nid,uchar *data,int len,char *sn,char *ln)

{
  ASN1_OBJECT *pAVar1;
  ASN1_OBJECT local_38;
  
  local_38.flags = 0xd;
  local_38.sn = sn;
  local_38.ln = (char **)ln;
  local_38.nid = nid;
  local_38.length = len;
  local_38.data = data;
  pAVar1 = OBJ_dup(&local_38);
  return pAVar1;
}



int ASN1_check_infinite_end(uchar **p,long len)

{
  uchar *puVar1;
  int iVar2;
  
  if (len < 1) {
    iVar2 = 1;
  }
  else {
    iVar2 = 0;
    if (((len != 1) && (puVar1 = *p, *puVar1 == '\0')) && (puVar1[1] == '\0')) {
      *p = puVar1 + 2;
      return 1;
    }
  }
  return iVar2;
}



int ASN1_const_check_infinite_end(uchar **p,long len)

{
  uchar *puVar1;
  int iVar2;
  
  if (len < 1) {
    iVar2 = 1;
  }
  else {
    iVar2 = 0;
    if (((len != 1) && (puVar1 = *p, *puVar1 == '\0')) && (puVar1[1] == '\0')) {
      *p = puVar1 + 2;
      return 1;
    }
  }
  return iVar2;
}



int ASN1_get_object(uchar **pp,long *plength,int *ptag,int *pclass,long omax)

{
  byte bVar1;
  byte bVar2;
  byte *pbVar3;
  ushort uVar4;
  uint3 uVar5;
  uint5 uVar6;
  uint6 uVar7;
  uint7 uVar8;
  ulong uVar9;
  byte *pbVar10;
  byte bVar11;
  int iVar12;
  long lVar13;
  uint uVar14;
  byte *pbVar15;
  uint uVar16;
  
  pbVar3 = *pp;
  if (omax != 0) {
    bVar1 = *pbVar3;
    uVar14 = bVar1 & 0x1f;
    if (uVar14 == 0x1f) {
      lVar13 = omax + -1;
      if (lVar13 != 0) {
        uVar9 = 0;
        pbVar15 = pbVar3;
        while( true ) {
          bVar2 = pbVar15[1];
          if (-1 < (char)bVar2) break;
          uVar9 = (ulong)(bVar2 & 0x7f) | uVar9 << 7;
          lVar13 = lVar13 + -1;
          if ((lVar13 == 0) || (pbVar15 = pbVar15 + 1, 0xffffff < (long)uVar9)) goto LAB_0049f023;
        }
        lVar13 = lVar13 + -1;
        if (lVar13 != 0) {
          pbVar15 = pbVar15 + 2;
          uVar14 = (uint)(uVar9 << 7) | (uint)bVar2;
          goto LAB_0049f0b4;
        }
      }
    }
    else {
      lVar13 = omax + -1;
      if (lVar13 != 0) {
        pbVar15 = pbVar3 + 1;
LAB_0049f0b4:
        *ptag = uVar14;
        iVar12 = (int)lVar13;
        *pclass = bVar1 & 0xc0;
        if (0 < iVar12) {
          bVar2 = *pbVar15;
          if (bVar2 == 0x80) {
            pbVar10 = pbVar15 + 1;
            uVar14 = 1;
            uVar9 = 0;
          }
          else {
            pbVar10 = pbVar15 + 1;
            bVar11 = bVar2 & 0x7f;
            uVar9 = (ulong)bVar11;
            if ((char)bVar2 < '\0') {
              if ((8 < bVar11) || (iVar12 == 1)) goto LAB_0049f023;
              if (bVar11 == 0) {
                uVar9 = 0;
              }
              else {
                pbVar10 = pbVar15 + 2;
                uVar9 = (ulong)pbVar15[1];
                if (iVar12 == 2) goto LAB_0049f023;
                if (bVar11 != 1) {
                  pbVar10 = pbVar15 + 3;
                  uVar4 = CONCAT11(pbVar15[1],pbVar15[2]);
                  uVar9 = (ulong)uVar4;
                  if (iVar12 == 3) goto LAB_0049f023;
                  if (bVar11 != 2) {
                    pbVar10 = pbVar15 + 4;
                    uVar5 = CONCAT21(uVar4,pbVar15[3]);
                    uVar9 = (ulong)uVar5;
                    if (iVar12 == 4) goto LAB_0049f023;
                    if (bVar11 != 3) {
                      pbVar10 = pbVar15 + 5;
                      uVar14 = CONCAT31(uVar5,pbVar15[4]);
                      uVar9 = (ulong)uVar14;
                      if (iVar12 == 5) goto LAB_0049f023;
                      if (bVar11 != 4) {
                        pbVar10 = pbVar15 + 6;
                        uVar6 = CONCAT41(uVar14,pbVar15[5]);
                        uVar9 = (ulong)uVar6;
                        if (iVar12 == 6) goto LAB_0049f023;
                        if (bVar11 != 5) {
                          pbVar10 = pbVar15 + 7;
                          uVar7 = CONCAT51(uVar6,pbVar15[6]);
                          uVar9 = (ulong)uVar7;
                          if (iVar12 == 7) goto LAB_0049f023;
                          if (bVar11 != 6) {
                            pbVar10 = pbVar15 + 8;
                            uVar8 = CONCAT61(uVar7,pbVar15[7]);
                            uVar9 = (ulong)uVar8;
                            if (iVar12 == 8) goto LAB_0049f023;
                            if (bVar11 != 7) {
                              pbVar10 = pbVar15 + 9;
                              uVar9 = CONCAT71(uVar8,pbVar15[8]);
                              if (iVar12 == 9) goto LAB_0049f023;
                            }
                          }
                        }
                      }
                    }
                  }
                }
              }
            }
            if ((long)uVar9 < 0) goto LAB_0049f023;
            uVar14 = 0;
          }
          uVar16 = bVar1 & 0x20;
          *plength = uVar9;
          if ((long)(pbVar3 + (omax - (long)pbVar10)) < (long)uVar9) {
            uVar16 = uVar16 | 0xffffff80;
            ERR_put_error(0xd,0x72,0x9b,"asn1_lib.c",0x8e);
          }
          *pp = pbVar10;
          return uVar16 & 0xff | uVar14;
        }
      }
    }
  }
LAB_0049f023:
  ERR_put_error(0xd,0x72,0x7b,"asn1_lib.c",0x96);
  return 0x80;
}



void ASN1_put_object(uchar **pp,int constructed,int length,int tag,int xclass)

{
  byte *pbVar1;
  int iVar2;
  int iVar3;
  long lVar4;
  int iVar5;
  long lVar6;
  byte *pbVar7;
  byte bVar8;
  
  pbVar1 = *pp;
  bVar8 = ~-(constructed == 0) & 0x20U | (byte)xclass & 0xc0;
  if (tag < 0x1f) {
    pbVar7 = pbVar1 + 1;
    *pbVar1 = (byte)tag & 0x1f | bVar8;
  }
  else {
    *pbVar1 = bVar8 | 0x1f;
    iVar2 = tag;
    iVar5 = 0;
    do {
      iVar3 = iVar5;
      iVar2 = iVar2 >> 7;
      iVar5 = iVar3 + 1;
    } while (iVar2 != 0);
    pbVar1[(long)iVar3 + 1] = (byte)tag & 0x7f;
    pbVar7 = pbVar1 + iVar3;
    iVar2 = iVar3;
    while( true ) {
      tag = tag >> 7;
      if (iVar2 < 1) break;
      bVar8 = (byte)tag & 0x7f;
      if (iVar2 + -1 != iVar3) {
        bVar8 = bVar8 | 0x80;
      }
      *pbVar7 = bVar8;
      pbVar7 = pbVar7 + -1;
      iVar2 = iVar2 + -1;
    }
    pbVar7 = pbVar1 + (long)(iVar3 + 1) + 1;
  }
  if (constructed == 2) {
    *pbVar7 = 0x80;
    *pp = pbVar7 + 1;
    return;
  }
  lVar6 = 0;
  iVar2 = length;
  if (length < 0x80) {
    *pbVar7 = (byte)length;
    *pp = pbVar7 + 1;
    return;
  }
  while( true ) {
    iVar2 = iVar2 >> 8;
    iVar5 = (int)lVar6 + 1;
    if (iVar2 == 0) break;
    lVar6 = (long)iVar5;
  }
  *pbVar7 = (byte)iVar5 | 0x80;
  lVar4 = 0;
  do {
    pbVar7[lVar4 + lVar6 + 1] = (byte)length;
    lVar4 = lVar4 + -1;
    length = length >> 8;
  } while (0 < iVar5 + (int)lVar4);
  *pp = pbVar7 + (long)iVar5 + 1;
  return;
}



int ASN1_put_eoc(uchar **pp)

{
  uchar *puVar1;
  
  puVar1 = *pp;
  *puVar1 = '\0';
  puVar1[1] = '\0';
  *pp = puVar1 + 2;
  return 2;
}



int ASN1_object_size(int constructed,int length,int tag)

{
  int iVar1;
  int iVar2;
  
  iVar1 = length + 1;
  iVar2 = iVar1;
  if (0x1e < tag) {
    do {
      iVar1 = iVar2 + 1;
      if (tag >> 7 == 0) break;
      tag = tag >> 0xe;
      iVar1 = iVar2 + 2;
      iVar2 = iVar1;
    } while (tag != 0);
  }
  if (constructed == 2) {
    return iVar1 + 3;
  }
  iVar1 = iVar1 + 1;
  if (0x7f < length) {
    do {
      length = length >> 8;
      iVar1 = iVar1 + 1;
    } while (length != 0);
  }
  return iVar1;
}



int asn1_Finish(ASN1_CTX *c)

{
  uchar *puVar1;
  long lVar2;
  
  if ((c->inf == 0x21) && (c->eos == 0)) {
    lVar2 = c->slen;
    if (lVar2 < 1) goto LAB_0049f44c;
    if (((lVar2 == 1) || (puVar1 = c->p, *puVar1 != '\0')) || (puVar1[1] != '\0')) {
      c->error = 0x3f;
      return 0;
    }
    c->p = puVar1 + 2;
  }
  else {
    lVar2 = c->slen;
LAB_0049f44c:
    if (lVar2 == 0) {
      return 1;
    }
    if ((c->inf & 1U) == 0) goto LAB_0049f46a;
  }
  if (-1 < lVar2) {
    return 1;
  }
LAB_0049f46a:
  c->error = 0x3e;
  return 0;
}



int asn1_const_Finish(ASN1_const_CTX *c)

{
  uchar *puVar1;
  long lVar2;
  
  if ((c->inf == 0x21) && (c->eos == 0)) {
    lVar2 = c->slen;
    if (lVar2 < 1) goto LAB_0049f4cc;
    if (((lVar2 == 1) || (puVar1 = c->p, *puVar1 != '\0')) || (puVar1[1] != '\0')) {
      c->error = 0x3f;
      return 0;
    }
    c->p = puVar1 + 2;
  }
  else {
    lVar2 = c->slen;
LAB_0049f4cc:
    if (lVar2 == 0) {
      return 1;
    }
    if ((c->inf & 1U) == 0) goto LAB_0049f4ea;
  }
  if (-1 < lVar2) {
    return 1;
  }
LAB_0049f4ea:
  c->error = 0x3e;
  return 0;
}



int asn1_GetSequence(ASN1_const_CTX *c,long *length)

{
  byte bVar1;
  byte bVar2;
  long lVar3;
  uchar *puVar4;
  ushort uVar5;
  uint3 uVar6;
  uint5 uVar7;
  uint6 uVar8;
  uint7 uVar9;
  int iVar10;
  long lVar11;
  ulong uVar12;
  uint uVar13;
  byte *pbVar14;
  byte *pbVar15;
  byte bVar16;
  byte *pbVar17;
  uint uVar18;
  
  lVar3 = *length;
  pbVar14 = c->p;
  if (lVar3 != 0) {
    bVar1 = *pbVar14;
    uVar13 = bVar1 & 0x1f;
    if (uVar13 == 0x1f) {
      lVar11 = lVar3 + -1;
      if (lVar11 != 0) {
        uVar12 = 0;
        pbVar15 = pbVar14;
        while( true ) {
          bVar2 = pbVar15[1];
          if (-1 < (char)bVar2) break;
          uVar12 = (ulong)(bVar2 & 0x7f) | uVar12 << 7;
          lVar11 = lVar11 + -1;
          if ((lVar11 == 0) || (pbVar15 = pbVar15 + 1, 0xffffff < (long)uVar12)) goto LAB_0049f57c;
        }
        lVar11 = lVar11 + -1;
        if (lVar11 != 0) {
          pbVar15 = pbVar15 + 2;
          uVar13 = (uint)(uVar12 << 7) | (uint)bVar2;
          goto LAB_0049f61c;
        }
      }
    }
    else {
      lVar11 = lVar3 + -1;
      if (lVar11 != 0) {
        pbVar15 = pbVar14 + 1;
LAB_0049f61c:
        c->tag = uVar13;
        iVar10 = (int)lVar11;
        c->xclass = bVar1 & 0xc0;
        if (0 < iVar10) {
          bVar2 = *pbVar15;
          if (bVar2 == 0x80) {
            pbVar17 = pbVar15 + 1;
            uVar13 = 1;
            uVar12 = 0;
          }
          else {
            pbVar17 = pbVar15 + 1;
            bVar16 = bVar2 & 0x7f;
            uVar12 = (ulong)bVar16;
            if ((char)bVar2 < '\0') {
              if ((8 < bVar16) || (iVar10 == 1)) goto LAB_0049f57c;
              if (bVar16 == 0) {
                uVar12 = 0;
              }
              else {
                pbVar17 = pbVar15 + 2;
                uVar12 = (ulong)pbVar15[1];
                if (iVar10 == 2) goto LAB_0049f57c;
                if (bVar16 != 1) {
                  pbVar17 = pbVar15 + 3;
                  uVar5 = CONCAT11(pbVar15[1],pbVar15[2]);
                  uVar12 = (ulong)uVar5;
                  if (iVar10 == 3) goto LAB_0049f57c;
                  if (bVar16 != 2) {
                    pbVar17 = pbVar15 + 4;
                    uVar6 = CONCAT21(uVar5,pbVar15[3]);
                    uVar12 = (ulong)uVar6;
                    if (iVar10 == 4) goto LAB_0049f57c;
                    if (bVar16 != 3) {
                      pbVar17 = pbVar15 + 5;
                      uVar13 = CONCAT31(uVar6,pbVar15[4]);
                      uVar12 = (ulong)uVar13;
                      if (iVar10 == 5) goto LAB_0049f57c;
                      if (bVar16 != 4) {
                        pbVar17 = pbVar15 + 6;
                        uVar7 = CONCAT41(uVar13,pbVar15[5]);
                        uVar12 = (ulong)uVar7;
                        if (iVar10 == 6) goto LAB_0049f57c;
                        if (bVar16 != 5) {
                          pbVar17 = pbVar15 + 7;
                          uVar8 = CONCAT51(uVar7,pbVar15[6]);
                          uVar12 = (ulong)uVar8;
                          if (iVar10 == 7) goto LAB_0049f57c;
                          if (bVar16 != 6) {
                            pbVar17 = pbVar15 + 8;
                            uVar9 = CONCAT61(uVar8,pbVar15[7]);
                            uVar12 = (ulong)uVar9;
                            if (iVar10 == 8) goto LAB_0049f57c;
                            if (bVar16 != 7) {
                              pbVar17 = pbVar15 + 9;
                              uVar12 = CONCAT71(uVar9,pbVar15[8]);
                              if (iVar10 == 9) goto LAB_0049f57c;
                            }
                          }
                        }
                      }
                    }
                  }
                }
              }
            }
            if ((long)uVar12 < 0) goto LAB_0049f57c;
            uVar13 = 0;
          }
          c->slen = uVar12;
          uVar18 = bVar1 & 0x20;
          if ((long)(pbVar14 + (lVar3 - (long)pbVar17)) < (long)uVar12) {
            uVar18 = uVar18 | 0xffffff80;
            ERR_put_error(0xd,0x72,0x9b,"asn1_lib.c",0x8e);
          }
          c->p = pbVar17;
          uVar13 = uVar18 & 0xff | uVar13;
          c->inf = uVar13;
          if ((uVar18 & 0x80) == 0) {
            if (c->tag != 0x10) {
              c->error = 0x3d;
              return uVar18 & 0x80;
            }
            pbVar14 = pbVar14 + (*length - (long)pbVar17);
            puVar4 = c->max;
            *length = (long)pbVar14;
            if ((puVar4 != (uchar *)0x0) && ((long)pbVar14 < 0)) {
              c->error = 0x3e;
              return 0;
            }
            if (uVar13 == 0x21) {
              c->slen = (long)(*c->pp + ((long)pbVar14 - (long)pbVar17));
            }
            c->eos = 0;
            return 1;
          }
          goto LAB_0049f5a2;
        }
      }
    }
  }
LAB_0049f57c:
  ERR_put_error(0xd,0x72,0x7b,"asn1_lib.c",0x96);
  c->inf = 0x80;
LAB_0049f5a2:
  c->error = 0x3c;
  return 0;
}



int ASN1_STRING_copy(ASN1_STRING *dst,ASN1_STRING *str)

{
  uchar *__s;
  int iVar1;
  size_t sVar2;
  uchar *__dest;
  uchar *addr;
  
  if (str == (ASN1_STRING *)0x0) {
    return 0;
  }
  iVar1 = str->length;
  __s = str->data;
  dst->type = str->type;
  if (iVar1 < 0) {
    if (__s != (uchar *)0x0) {
      sVar2 = strlen((char *)__s);
      iVar1 = (int)sVar2;
      goto LAB_0049f8db;
    }
LAB_0049f96d:
    iVar1 = 0;
  }
  else {
LAB_0049f8db:
    if (dst->length < iVar1) {
      addr = dst->data;
      if (addr == (uchar *)0x0) goto LAB_0049f990;
      __dest = (uchar *)CRYPTO_realloc(addr,iVar1 + 1,"asn1_lib.c",0x184);
      dst->data = __dest;
LAB_0049f947:
      if (__dest == (uchar *)0x0) {
        ERR_put_error(0xd,0xba,0x41,"asn1_lib.c",0x188);
        dst->data = addr;
        goto LAB_0049f96d;
      }
    }
    else {
      __dest = dst->data;
      if (__dest == (uchar *)0x0) {
LAB_0049f990:
        addr = (uchar *)0x0;
        __dest = (uchar *)CRYPTO_malloc(iVar1 + 1,"asn1_lib.c",0x182);
        dst->data = __dest;
        goto LAB_0049f947;
      }
    }
    dst->length = iVar1;
    if (__s != (uchar *)0x0) {
      memcpy(__dest,__s,(long)iVar1);
      dst->data[iVar1] = '\0';
    }
    dst->flags = str->flags;
    iVar1 = 1;
  }
  return iVar1;
}



ASN1_STRING * ASN1_STRING_dup(ASN1_STRING *a)

{
  uchar *__s;
  int iVar1;
  ASN1_STRING *ptr;
  uchar *__dest;
  size_t sVar2;
  
  if (a == (ASN1_STRING *)0x0) {
    return (ASN1_STRING *)0x0;
  }
  ptr = (ASN1_STRING *)CRYPTO_malloc(0x18,"asn1_lib.c",0x1a9);
  if (ptr == (ASN1_STRING *)0x0) {
    ERR_put_error(0xd,0x82,0x41,"asn1_lib.c",0x1ac);
    return (ASN1_STRING *)0x0;
  }
  ptr->length = 0;
  iVar1 = a->length;
  ptr->data = (uchar *)0x0;
  ptr->type = 4;
  ptr->flags = 0;
  __s = a->data;
  ptr->type = a->type;
  if (iVar1 < 0) {
    if (__s == (uchar *)0x0) goto LAB_0049faaf;
    sVar2 = strlen((char *)__s);
    iVar1 = (int)sVar2;
  }
  __dest = (uchar *)CRYPTO_malloc(iVar1 + 1,"asn1_lib.c",0x182);
  ptr->data = __dest;
  if (__dest != (uchar *)0x0) {
    ptr->length = iVar1;
    if (__s != (uchar *)0x0) {
      memcpy(__dest,__s,(long)iVar1);
      ptr->data[iVar1] = '\0';
    }
    ptr->flags = a->flags;
    return ptr;
  }
  ERR_put_error(0xd,0xba,0x41,"asn1_lib.c",0x188);
  ptr->data = (uchar *)0x0;
LAB_0049faaf:
  CRYPTO_free(ptr);
  return (ASN1_STRING *)0x0;
}



int ASN1_STRING_set(ASN1_STRING *str,void *data,int len)

{
  uchar *__dest;
  size_t sVar1;
  uchar *addr;
  
  if (len < 0) {
    if (data == (void *)0x0) {
      return 0;
    }
    sVar1 = strlen((char *)data);
    len = (int)sVar1;
  }
  if (str->length < len) {
    addr = str->data;
    if (addr == (uchar *)0x0) goto LAB_0049fb79;
    __dest = (uchar *)CRYPTO_realloc(addr,len + 1,"asn1_lib.c",0x184);
    str->data = __dest;
  }
  else {
    __dest = str->data;
    if (__dest != (uchar *)0x0) goto LAB_0049fb3e;
LAB_0049fb79:
    addr = (uchar *)0x0;
    __dest = (uchar *)CRYPTO_malloc(len + 1,"asn1_lib.c",0x182);
    str->data = __dest;
  }
  if (__dest == (uchar *)0x0) {
    ERR_put_error(0xd,0xba,0x41,"asn1_lib.c",0x188);
    str->data = addr;
    return 0;
  }
LAB_0049fb3e:
  str->length = len;
  if (data != (void *)0x0) {
    memcpy(__dest,data,(long)len);
    str->data[len] = '\0';
  }
  return 1;
}



void ASN1_STRING_set0(ASN1_STRING *str,void *data,int len)

{
  if (str->data != (uchar *)0x0) {
    CRYPTO_free(str->data);
  }
  str->data = (uchar *)data;
  str->length = len;
  return;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

ASN1_STRING * ASN1_STRING_new(void)

{
  ASN1_STRING *pAVar1;
  
  pAVar1 = (ASN1_STRING *)CRYPTO_malloc(0x18,"asn1_lib.c",0x1a9);
  if (pAVar1 == (ASN1_STRING *)0x0) {
    ERR_put_error(0xd,0x82,0x41,"asn1_lib.c",0x1ac);
    pAVar1 = (ASN1_STRING *)0x0;
  }
  else {
    pAVar1->length = 0;
    pAVar1->type = 4;
    pAVar1->data = (uchar *)0x0;
    pAVar1->flags = 0;
  }
  return pAVar1;
}



ASN1_STRING * ASN1_STRING_type_new(int type)

{
  ASN1_STRING *pAVar1;
  
  pAVar1 = (ASN1_STRING *)CRYPTO_malloc(0x18,"asn1_lib.c",0x1a9);
  if (pAVar1 != (ASN1_STRING *)0x0) {
    pAVar1->length = 0;
    pAVar1->type = type;
    pAVar1->data = (uchar *)0x0;
    pAVar1->flags = 0;
    return pAVar1;
  }
  ERR_put_error(0xd,0x82,0x41,"asn1_lib.c",0x1ac);
  return (ASN1_STRING *)0x0;
}



void ASN1_STRING_free(ASN1_STRING *a)

{
  if (a == (ASN1_STRING *)0x0) {
    return;
  }
  if ((a->data != (uchar *)0x0) && ((a->flags & 0x10) == 0)) {
    CRYPTO_free(a->data);
    CRYPTO_free(a);
    return;
  }
  CRYPTO_free(a);
  return;
}



int ASN1_STRING_cmp(ASN1_STRING *a,ASN1_STRING *b)

{
  int iVar1;
  
  iVar1 = a->length - b->length;
  if (iVar1 == 0) {
    iVar1 = memcmp(a->data,b->data,(long)a->length);
    if (iVar1 == 0) {
      iVar1 = a->type - b->type;
    }
  }
  return iVar1;
}



void asn1_add_error(uchar *address,int offset)

{
  char acStack_38 [16];
  char local_28 [32];
  
  BIO_snprintf(local_28,0x18,"%lu",address);
  BIO_snprintf(acStack_38,0xd,"%d",offset);
  ERR_add_error_data(4,"address=",local_28," offset=",acStack_38);
  return;
}



int ASN1_STRING_length(ASN1_STRING *x)

{
  return x->length;
}



void ASN1_STRING_length_set(ASN1_STRING *x,int n)

{
  x->length = n;
  return;
}



int ASN1_STRING_type(ASN1_STRING *x)

{
  return x->type;
}



uchar * ASN1_STRING_data(ASN1_STRING *x)

{
  return x->data;
}



long ex_class_item_LHASH_HASH(int *param_1)

{
  return (long)*param_1;
}



int ex_class_item_LHASH_COMP(int *param_1,int *param_2)

{
  return *param_1 - *param_2;
}



int int_new_class(void)

{
  int iVar1;
  
  CRYPTO_lock(9,2,"ex_data.c",0x175);
  iVar1 = ex_class;
  ex_class = ex_class + 1;
  CRYPTO_lock(10,2,"ex_data.c",0x177);
  return iVar1;
}



void def_cleanup_util_cb(void *ptr)

{
  if (free_debug_func != (code *)0x0) {
    (*free_debug_func)(ptr,0);
  }
  (*(code *)free_func)(ptr);
  if (free_debug_func != (code *)0x0) {
                    // WARNING: Could not recover jumptable at 0x0048e7f1. Too many branches
                    // WARNING: Treating indirect jump as call
    (*free_debug_func)(0,1);
    return;
  }
  return;
}



undefined4 * def_get_class(undefined4 param_1)

{
  undefined4 *ptr;
  _STACK *p_Var1;
  undefined4 local_38 [10];
  
  if (ex_data == (_LHASH *)0x0) {
    CRYPTO_lock(9,2,"ex_data.c",0x10e);
    if ((ex_data == (_LHASH *)0x0) &&
       (ex_data = lh_new(ex_class_item_LHASH_HASH,ex_class_item_LHASH_COMP),
       ex_data == (_LHASH *)0x0)) {
      CRYPTO_lock(10,2,"ex_data.c",0x112);
      return (undefined4 *)0x0;
    }
    CRYPTO_lock(10,2,"ex_data.c",0x112);
  }
  local_38[0] = param_1;
  CRYPTO_lock(9,2,"ex_data.c",0x130);
  ptr = (undefined4 *)lh_retrieve(ex_data,local_38);
  if (ptr == (undefined4 *)0x0) {
    ptr = (undefined4 *)CRYPTO_malloc(0x18,"ex_data.c",0x134);
    if (ptr != (undefined4 *)0x0) {
      *ptr = param_1;
      ptr[4] = 0;
      p_Var1 = sk_new_null();
      *(_STACK **)(ptr + 2) = p_Var1;
      if (p_Var1 != (_STACK *)0x0) {
        lh_insert(ex_data,ptr);
        goto LAB_0049fee5;
      }
      CRYPTO_free(ptr);
    }
    CRYPTO_lock(10,2,"ex_data.c",0x145);
    ERR_put_error(0xf,0x69,0x41,"ex_data.c",0x147);
    ptr = (undefined4 *)0x0;
  }
  else {
LAB_0049fee5:
    CRYPTO_lock(10,2,"ex_data.c",0x145);
  }
  return ptr;
}



void def_cleanup_cb(void *param_1)

{
  sk_pop_free(*(_STACK **)((long)param_1 + 8),def_cleanup_util_cb);
  CRYPTO_free(param_1);
  return;
}



int int_get_new_index(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4,
                     undefined8 param_5,undefined8 param_6)

{
  int iVar1;
  int iVar2;
  long lVar3;
  undefined8 *ptr;
  
  lVar3 = def_get_class();
  if (lVar3 == 0) {
    iVar1 = -1;
  }
  else {
    ptr = (undefined8 *)CRYPTO_malloc(0x28,"ex_data.c",0x153);
    if (ptr == (undefined8 *)0x0) {
      ERR_put_error(0xf,0x68,0x41,"ex_data.c",0x156);
      iVar1 = -1;
    }
    else {
      *ptr = param_2;
      ptr[1] = param_3;
      ptr[2] = param_4;
      ptr[3] = param_6;
      ptr[4] = param_5;
      CRYPTO_lock(9,2,"ex_data.c",0x15e);
      do {
        iVar2 = sk_num(*(_STACK **)(lVar3 + 8));
        iVar1 = *(int *)(lVar3 + 0x10);
        if (iVar1 < iVar2) {
          *(int *)(lVar3 + 0x10) = iVar1 + 1;
          sk_set(*(_STACK **)(lVar3 + 8),iVar1,ptr);
          goto LAB_004a0112;
        }
        iVar1 = sk_push(*(_STACK **)(lVar3 + 8),(void *)0x0);
      } while (iVar1 != 0);
      iVar1 = -1;
      ERR_put_error(0xf,0x68,0x41,"ex_data.c",0x163);
      CRYPTO_free(ptr);
LAB_004a0112:
      CRYPTO_lock(10,2,"ex_data.c",0x16b);
    }
  }
  return iVar1;
}



undefined8 int_new_ex_data(undefined8 param_1,undefined8 param_2,undefined8 *param_3)

{
  int iVar1;
  int iVar2;
  long lVar3;
  void *ptr;
  void *pvVar4;
  long lVar5;
  ulong uVar6;
  undefined8 uVar7;
  undefined8 *puVar8;
  code *pcVar9;
  
  uVar7 = 0;
  lVar3 = def_get_class();
  if (lVar3 != 0) {
    *param_3 = 0;
    CRYPTO_lock(5,2,"ex_data.c",0x19d);
    iVar1 = sk_num(*(_STACK **)(lVar3 + 8));
    if (iVar1 < 1) {
      uVar7 = 1;
      CRYPTO_lock(6,2,"ex_data.c",0x1a8);
    }
    else {
      ptr = CRYPTO_malloc(iVar1 * 8,"ex_data.c",0x1a1);
      if (ptr == (void *)0x0) {
        CRYPTO_lock(6,2,"ex_data.c",0x1a8);
        ERR_put_error(0xf,0x6c,0x41,"ex_data.c",0x1ab);
      }
      else {
        lVar5 = 0;
        do {
          pvVar4 = sk_value(*(_STACK **)(lVar3 + 8),(int)lVar5);
          *(void **)((long)ptr + lVar5 * 8) = pvVar4;
          lVar5 = lVar5 + 1;
        } while ((int)lVar5 < iVar1);
        uVar6 = 0;
        CRYPTO_lock(6,2,"ex_data.c",0x1a8);
        do {
          puVar8 = *(undefined8 **)((long)ptr + uVar6 * 8);
          if ((puVar8 != (undefined8 *)0x0) && (pcVar9 = (code *)puVar8[2], pcVar9 != (code *)0x0))
          {
            if ((_STACK *)*param_3 == (_STACK *)0x0) {
              pvVar4 = (void *)0x0;
            }
            else {
              iVar2 = sk_num((_STACK *)*param_3);
              if ((int)uVar6 < iVar2) {
                pvVar4 = sk_value((_STACK *)*param_3,(int)uVar6);
                puVar8 = *(undefined8 **)((long)ptr + uVar6 * 8);
                pcVar9 = (code *)puVar8[2];
              }
              else {
                puVar8 = *(undefined8 **)((long)ptr + uVar6 * 8);
                pvVar4 = (void *)0x0;
                pcVar9 = (code *)puVar8[2];
              }
            }
            (*pcVar9)(param_2,pvVar4,param_3,uVar6 & 0xffffffff,*puVar8,puVar8[1]);
          }
          uVar6 = uVar6 + 1;
        } while ((int)uVar6 < iVar1);
        uVar7 = 1;
        CRYPTO_free(ptr);
      }
    }
  }
  return uVar7;
}



void int_free_ex_data(undefined8 param_1,undefined8 param_2,undefined8 *param_3)

{
  int iVar1;
  int iVar2;
  long lVar3;
  void *ptr;
  void *pvVar4;
  long lVar5;
  ulong uVar6;
  undefined8 *puVar7;
  code *pcVar8;
  
  lVar3 = def_get_class();
  if (lVar3 != 0) {
    CRYPTO_lock(5,2,"ex_data.c",500);
    iVar1 = sk_num(*(_STACK **)(lVar3 + 8));
    if (iVar1 < 1) {
      CRYPTO_lock(6,2,"ex_data.c",0x1ff);
    }
    else {
      ptr = CRYPTO_malloc(iVar1 * 8,"ex_data.c",0x1f8);
      if (ptr == (void *)0x0) {
        CRYPTO_lock(6,2,"ex_data.c",0x1ff);
        ERR_put_error(0xf,0x6b,0x41,"ex_data.c",0x202);
        return;
      }
      lVar5 = 0;
      do {
        pvVar4 = sk_value(*(_STACK **)(lVar3 + 8),(int)lVar5);
        *(void **)((long)ptr + lVar5 * 8) = pvVar4;
        lVar5 = lVar5 + 1;
      } while ((int)lVar5 < iVar1);
      uVar6 = 0;
      CRYPTO_lock(6,2,"ex_data.c",0x1ff);
      do {
        puVar7 = *(undefined8 **)((long)ptr + uVar6 * 8);
        if ((puVar7 != (undefined8 *)0x0) && (pcVar8 = (code *)puVar7[3], pcVar8 != (code *)0x0)) {
          if ((_STACK *)*param_3 == (_STACK *)0x0) {
            pvVar4 = (void *)0x0;
          }
          else {
            iVar2 = sk_num((_STACK *)*param_3);
            if ((int)uVar6 < iVar2) {
              pvVar4 = sk_value((_STACK *)*param_3,(int)uVar6);
              puVar7 = *(undefined8 **)((long)ptr + uVar6 * 8);
              pcVar8 = (code *)puVar7[3];
            }
            else {
              puVar7 = *(undefined8 **)((long)ptr + uVar6 * 8);
              pvVar4 = (void *)0x0;
              pcVar8 = (code *)puVar7[3];
            }
          }
          (*pcVar8)(param_2,pvVar4,param_3,uVar6 & 0xffffffff,*puVar7,puVar7[1]);
        }
        uVar6 = uVar6 + 1;
      } while ((int)uVar6 < iVar1);
      CRYPTO_free(ptr);
    }
    if ((_STACK *)*param_3 != (_STACK *)0x0) {
      sk_free((_STACK *)*param_3);
      *param_3 = 0;
    }
  }
  return;
}



void int_cleanup(void)

{
  if (ex_data == (_LHASH *)0x0) {
    CRYPTO_lock(9,2,"ex_data.c",0x10e);
    if (ex_data == (_LHASH *)0x0) {
      ex_data = lh_new(ex_class_item_LHASH_HASH,ex_class_item_LHASH_COMP);
      if (ex_data == (_LHASH *)0x0) {
        CRYPTO_lock(10,2,"ex_data.c",0x112);
        return;
      }
    }
    CRYPTO_lock(10,2,"ex_data.c",0x112);
  }
  lh_doall(ex_data,def_cleanup_cb);
  lh_free(ex_data);
  ex_data = (_LHASH *)0x0;
  impl = 0;
  return;
}



undefined8 int_dup_ex_data(undefined8 param_1,long *param_2,long *param_3)

{
  undefined8 *puVar1;
  int iVar2;
  int iVar3;
  int iVar4;
  int iVar5;
  long lVar6;
  void *ptr;
  void *pvVar7;
  _STACK *p_Var8;
  long lVar9;
  ulong uVar10;
  void *local_48 [3];
  
  if (*param_3 != 0) {
    lVar6 = def_get_class();
    if (lVar6 == 0) {
      return 0;
    }
    CRYPTO_lock(5,2,"ex_data.c",0x1c9);
    iVar2 = sk_num(*(_STACK **)(lVar6 + 8));
    iVar3 = sk_num((_STACK *)*param_3);
    if (iVar3 <= iVar2) {
      iVar2 = iVar3;
    }
    if (iVar2 < 1) {
      CRYPTO_lock(6,2,"ex_data.c",0x1d7);
      return 1;
    }
    ptr = CRYPTO_malloc(iVar2 * 8,"ex_data.c",0x1d0);
    if (ptr == (void *)0x0) {
      CRYPTO_lock(6,2,"ex_data.c",0x1d7);
      ERR_put_error(0xf,0x6a,0x41,"ex_data.c",0x1da);
      return 0;
    }
    lVar9 = 0;
    do {
      pvVar7 = sk_value(*(_STACK **)(lVar6 + 8),(int)lVar9);
      *(void **)((long)ptr + lVar9 * 8) = pvVar7;
      lVar9 = lVar9 + 1;
    } while ((int)lVar9 < iVar2);
    uVar10 = 0;
    CRYPTO_lock(6,2,"ex_data.c",0x1d7);
    do {
      iVar3 = (int)uVar10;
      if (((_STACK *)*param_3 == (_STACK *)0x0) ||
         (iVar4 = sk_num((_STACK *)*param_3), iVar4 <= iVar3)) {
        local_48[0] = (void *)0x0;
      }
      else {
        local_48[0] = sk_value((_STACK *)*param_3,iVar3);
      }
      puVar1 = *(undefined8 **)((long)ptr + uVar10 * 8);
      if ((puVar1 != (undefined8 *)0x0) && ((code *)puVar1[4] != (code *)0x0)) {
        (*(code *)puVar1[4])(param_2,param_3,local_48,uVar10 & 0xffffffff,*puVar1,puVar1[1]);
      }
      pvVar7 = local_48[0];
      p_Var8 = (_STACK *)*param_2;
      if (p_Var8 == (_STACK *)0x0) {
        p_Var8 = sk_new_null();
        *param_2 = (long)p_Var8;
        if (p_Var8 != (_STACK *)0x0) goto LAB_004a0755;
        ERR_put_error(0xf,0x66,0x41,"ex_data.c",0x25d);
      }
      else {
LAB_004a0755:
        for (iVar4 = sk_num(p_Var8); iVar4 <= iVar3; iVar4 = iVar4 + 1) {
          iVar5 = sk_push((_STACK *)*param_2,(void *)0x0);
          if (iVar5 == 0) {
            ERR_put_error(0xf,0x66,0x41,"ex_data.c",0x267);
            goto LAB_004a07a7;
          }
        }
        sk_set((_STACK *)*param_2,iVar3,pvVar7);
      }
LAB_004a07a7:
      uVar10 = uVar10 + 1;
    } while ((int)uVar10 < iVar2);
    CRYPTO_free(ptr);
  }
  return 1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

CRYPTO_EX_DATA_IMPL * CRYPTO_get_ex_data_implementation(void)

{
  if ((CRYPTO_EX_DATA_IMPL *)impl != (CRYPTO_EX_DATA_IMPL *)0x0) {
    return (CRYPTO_EX_DATA_IMPL *)impl;
  }
  CRYPTO_lock(9,2,"ex_data.c",0xcb);
  if ((CRYPTO_EX_DATA_IMPL *)impl == (CRYPTO_EX_DATA_IMPL *)0x0) {
    impl = impl_default;
  }
  CRYPTO_lock(10,2,"ex_data.c",0xce);
  return (CRYPTO_EX_DATA_IMPL *)impl;
}



int CRYPTO_set_ex_data_implementation(CRYPTO_EX_DATA_IMPL *i)

{
  bool bVar1;
  
  CRYPTO_lock(9,2,"ex_data.c",0xdd);
  bVar1 = impl == (CRYPTO_EX_DATA_IMPL *)0x0;
  if (bVar1) {
    impl = i;
  }
  CRYPTO_lock(10,2,"ex_data.c",0xe3);
  return (uint)bVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

int CRYPTO_ex_data_new_class(void)

{
  int iVar1;
  
  if ((undefined8 *)impl != (undefined8 *)0x0) {
                    // WARNING: Could not recover jumptable at 0x004a098f. Too many branches
                    // WARNING: Treating indirect jump as call
    iVar1 = (**(code **)impl)();
    return iVar1;
  }
  CRYPTO_lock(9,2,"ex_data.c",0xcb);
  if ((undefined8 *)impl == (undefined8 *)0x0) {
    impl = impl_default;
  }
  CRYPTO_lock(10,2,"ex_data.c",0xce);
                    // WARNING: Could not recover jumptable at 0x004a09e6. Too many branches
                    // WARNING: Treating indirect jump as call
  iVar1 = (**(code **)impl)();
  return iVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

void CRYPTO_cleanup_all_ex_data(void)

{
  if (impl != (undefined1 *)0x0) {
                    // WARNING: Could not recover jumptable at 0x004a0a10. Too many branches
                    // WARNING: Treating indirect jump as call
    (**(code **)(impl + 8))();
    return;
  }
  CRYPTO_lock(9,2,"ex_data.c",0xcb);
  if (impl == (undefined1 *)0x0) {
    impl = impl_default;
  }
  CRYPTO_lock(10,2,"ex_data.c",0xce);
                    // WARNING: Could not recover jumptable at 0x004a0a67. Too many branches
                    // WARNING: Treating indirect jump as call
  (**(code **)(impl + 8))();
  return;
}



int CRYPTO_get_ex_new_index
              (int class_index,long argl,void *argp,undefined1 *new_func,undefined1 *dup_func,
              undefined1 *free_func)

{
  int iVar1;
  
  if (impl == (undefined1 *)0x0) {
    CRYPTO_lock(9,2,"ex_data.c",0xcb);
    if (impl == (undefined1 *)0x0) {
      impl = impl_default;
    }
    CRYPTO_lock(10,2,"ex_data.c",0xce);
  }
                    // WARNING: Could not recover jumptable at 0x004a0aba. Too many branches
                    // WARNING: Treating indirect jump as call
  iVar1 = (**(code **)(impl + 0x10))(class_index,argl,argp,new_func,dup_func,free_func);
  return iVar1;
}



int CRYPTO_new_ex_data(int class_index,void *obj,CRYPTO_EX_DATA *ad)

{
  int iVar1;
  
  if (impl == (undefined1 *)0x0) {
    CRYPTO_lock(9,2,"ex_data.c",0xcb);
    if (impl == (undefined1 *)0x0) {
      impl = impl_default;
    }
    CRYPTO_lock(10,2,"ex_data.c",0xce);
  }
                    // WARNING: Could not recover jumptable at 0x004a0b68. Too many branches
                    // WARNING: Treating indirect jump as call
  iVar1 = (**(code **)(impl + 0x18))(class_index,obj,ad);
  return iVar1;
}



int CRYPTO_dup_ex_data(int class_index,CRYPTO_EX_DATA *to,CRYPTO_EX_DATA *from)

{
  int iVar1;
  
  if (impl == (undefined1 *)0x0) {
    CRYPTO_lock(9,2,"ex_data.c",0xcb);
    if (impl == (undefined1 *)0x0) {
      impl = impl_default;
    }
    CRYPTO_lock(10,2,"ex_data.c",0xce);
  }
                    // WARNING: Could not recover jumptable at 0x004a0bf8. Too many branches
                    // WARNING: Treating indirect jump as call
  iVar1 = (**(code **)(impl + 0x20))(class_index,to,from);
  return iVar1;
}



void CRYPTO_free_ex_data(int class_index,void *obj,CRYPTO_EX_DATA *ad)

{
  if (impl == (undefined1 *)0x0) {
    CRYPTO_lock(9,2,"ex_data.c",0xcb);
    if (impl == (undefined1 *)0x0) {
      impl = impl_default;
    }
    CRYPTO_lock(10,2,"ex_data.c",0xce);
  }
                    // WARNING: Could not recover jumptable at 0x004a0c88. Too many branches
                    // WARNING: Treating indirect jump as call
  (**(code **)(impl + 0x28))(class_index,obj,ad);
  return;
}



int CRYPTO_set_ex_data(CRYPTO_EX_DATA *ad,int idx,void *val)

{
  int iVar1;
  int iVar2;
  _STACK *p_Var3;
  
  p_Var3 = &ad->sk->stack;
  if (p_Var3 == (_STACK *)0x0) {
    p_Var3 = sk_new_null();
    ad->sk = (stack_st_void *)p_Var3;
    if (p_Var3 == (_STACK *)0x0) {
      ERR_put_error(0xf,0x66,0x41,"ex_data.c",0x25d);
      return 0;
    }
  }
  iVar1 = sk_num(p_Var3);
  while( true ) {
    if (idx < iVar1) {
      sk_set(&ad->sk->stack,idx,val);
      return 1;
    }
    iVar2 = sk_push(&ad->sk->stack,(void *)0x0);
    if (iVar2 == 0) break;
    iVar1 = iVar1 + 1;
  }
  ERR_put_error(0xf,0x66,0x41,"ex_data.c",0x267);
  return 0;
}



void * CRYPTO_get_ex_data(CRYPTO_EX_DATA *ad,int idx)

{
  int iVar1;
  void *pvVar2;
  
  if (&ad->sk->stack != (_STACK *)0x0) {
    iVar1 = sk_num(&ad->sk->stack);
    if (idx < iVar1) {
      pvVar2 = sk_value(&ad->sk->stack,idx);
      return pvVar2;
    }
  }
  return (void *)0x0;
}



// WARNING: Unknown calling convention

void compress(uchar *target,uchar *source)

{
  uchar uVar1;
  byte bVar2;
  long lVar3;
  byte bVar4;
  byte bVar5;
  
  lVar3 = 0;
  do {
    uVar1 = source[lVar3 * 2];
    bVar2 = source[lVar3 * 2 + 1];
    bVar5 = 0xa0;
    if ((((uVar1 != 'A') && (bVar5 = 0xb0, uVar1 != 'B')) && (bVar5 = 0xc0, uVar1 != 'C')) &&
       ((bVar5 = 0xd0, uVar1 != 'D' && (bVar5 = 0xe0, uVar1 != 'E')))) {
      bVar5 = 0xf0;
      if (uVar1 != 'F') {
        bVar5 = uVar1 << 4;
      }
    }
    bVar4 = 10;
    if (((bVar2 != 0x41) && (bVar4 = 0xb, bVar2 != 0x42)) &&
       ((bVar4 = 0xc, bVar2 != 0x43 &&
        (((bVar4 = 0xd, bVar2 != 0x44 && (bVar4 = 0xe, bVar2 != 0x45)) &&
         (bVar4 = bVar2 & 0xf, bVar2 == 0x46)))))) {
      bVar4 = 0xf;
    }
    target[lVar3] = bVar5 | bVar4;
    lVar3 = lVar3 + 1;
  } while (lVar3 != 8);
  return;
}



// WARNING: Unknown calling convention

int odd(int x)

{
  return x & 1;
}



// WARNING: Unknown calling convention

int ByteBin(uchar c,uchar *s)

{
  s[8] = '\0';
  s[7] = (c & 1) + 0x30;
  s[6] = (c >> 1 & 1) + 0x30;
  s[5] = (c >> 2 & 1) + 0x30;
  s[4] = (c >> 3 & 1) + 0x30;
  s[3] = (c >> 4 & 1) + 0x30;
  s[2] = (c >> 5 & 1) + 0x30;
  *s = '0' - ((char)c >> 7);
  s[1] = (c >> 6 & 1) + 0x30;
  return 0;
}



// WARNING: Unknown calling convention

uchar BinByte(uchar *s)

{
  return s[7] + 0xd0 +
         (s[6] + 0xd0 +
         (s[5] + 0xd0 +
         (s[4] + 0xd0 +
         (s[3] + 0xd0 + (s[2] + 0xd0 + (s[1] + 'p' + *s * '\x02') * '\x02') * '\x02') * '\x02') *
         '\x02') * '\x02') * '\x02';
}



// WARNING: Unknown calling convention

uchar pos(uchar *s,uchar c)

{
  byte bVar1;
  
  if (*s == c) {
    return '\0';
  }
  bVar1 = 0;
  if (*s != '\0') {
    while( true ) {
      bVar1 = bVar1 + 1;
      if ((s[bVar1] == c) || (s[bVar1] == '\0')) break;
      if (bVar1 == 0xff) {
        return 0xff;
      }
    }
  }
  return bVar1;
}



// WARNING: Unknown calling convention

uchar HexaByte(uchar *s)

{
  uchar uVar1;
  uchar uVar2;
  uchar Hexa [17];
  
  builtin_memcpy(Hexa,"0123456789ABCDEF",0x11);
  uVar1 = pos(Hexa,*s);
  uVar2 = pos(Hexa,s[1]);
  return uVar2 + uVar1 * '\x10';
}



// WARNING: Unknown calling convention

int Transpose(uchar *Data,uchar *T,int n)

{
  long lVar1;
  uchar X [65];
  
  X._0_8_ = *(undefined8 *)Data;
  X._8_8_ = *(undefined8 *)(Data + 8);
  X._16_8_ = *(undefined8 *)(Data + 0x10);
  X._24_8_ = *(undefined8 *)(Data + 0x18);
  X._32_8_ = *(undefined8 *)(Data + 0x20);
  X._40_8_ = *(undefined8 *)(Data + 0x28);
  X._48_8_ = *(undefined8 *)(Data + 0x30);
  X._56_8_ = *(undefined8 *)(Data + 0x38);
  lVar1 = 0;
  if (0 < n) {
    do {
      Data[lVar1] = X[(int)(T[lVar1] - 1)];
      lVar1 = lVar1 + 1;
    } while ((int)lVar1 < n);
  }
  return 0;
}



// WARNING: Unknown calling convention

int Rotate(uchar *Key)

{
  uchar uVar1;
  undefined1 uVar2;
  void *pvVar3;
  
  uVar1 = *Key;
  pvVar3 = memmove(Key,Key + 1,0x37);
  uVar2 = *(undefined1 *)((long)pvVar3 + 0x1b);
  *(uchar *)((long)pvVar3 + 0x1b) = uVar1;
  *(undefined1 *)((long)pvVar3 + 0x37) = uVar2;
  return 0;
}



// WARNING: Unknown calling convention

int Calcul_I_Key(uchar *xKey)

{
  byte bVar1;
  uchar *puVar2;
  uchar (*Data) [65];
  uchar Key [65];
  
  Key._0_8_ = *(undefined8 *)xKey;
  puVar2 = Rots;
  Key._8_8_ = *(undefined8 *)(xKey + 8);
  Key._16_8_ = *(undefined8 *)(xKey + 0x10);
  Key._24_8_ = *(undefined8 *)(xKey + 0x18);
  Key._32_8_ = *(undefined8 *)(xKey + 0x20);
  Key._40_8_ = *(undefined8 *)(xKey + 0x28);
  Key._48_8_ = *(undefined8 *)(xKey + 0x30);
  Key._56_8_ = *(undefined8 *)(xKey + 0x38);
  Data = I_Key;
  do {
    if (*puVar2 != 0) {
      bVar1 = 1;
      do {
        bVar1 = bVar1 + 1;
        Rotate(Key);
      } while (bVar1 <= *puVar2);
    }
    puVar2 = puVar2 + 1;
    *(undefined8 *)*Data = Key._0_8_;
    *(undefined8 *)(*Data + 8) = Key._8_8_;
    *(undefined8 *)(*Data + 0x10) = Key._16_8_;
    *(undefined8 *)(*Data + 0x18) = Key._24_8_;
    *(undefined8 *)(*Data + 0x20) = Key._32_8_;
    *(undefined8 *)(*Data + 0x28) = Key._40_8_;
    *(undefined8 *)(*Data + 0x30) = Key._48_8_;
    *(undefined8 *)(*Data + 0x38) = Key._56_8_;
    Transpose(*Data,Tab_KeyTr2,0x30);
    Data = Data + 1;
  } while (puVar2 != Rots + 0x10);
  return 0;
}



// WARNING: Unknown calling convention

int Split(uchar *Rn,uchar *Ln,uchar *A)

{
  undefined8 uVar1;
  long lVar2;
  
  if ((A < Ln + 0x10) && (Ln < A + 0x10)) {
    lVar2 = 0;
    do {
      Ln[lVar2] = A[lVar2];
      lVar2 = lVar2 + 1;
    } while (lVar2 != 0x20);
  }
  else {
    uVar1 = *(undefined8 *)(A + 8);
    *(undefined8 *)Ln = *(undefined8 *)A;
    *(undefined8 *)(Ln + 8) = uVar1;
    uVar1 = *(undefined8 *)(A + 0x18);
    *(undefined8 *)(Ln + 0x10) = *(undefined8 *)(A + 0x10);
    *(undefined8 *)(Ln + 0x18) = uVar1;
  }
  if ((Rn < A + 0x30) && (A + 0x20 < Rn + 0x10)) {
    lVar2 = 0;
    do {
      Rn[lVar2] = A[lVar2 + 0x20];
      lVar2 = lVar2 + 1;
    } while (lVar2 != 0x20);
    return 0;
  }
  uVar1 = *(undefined8 *)(A + 0x28);
  *(undefined8 *)Rn = *(undefined8 *)(A + 0x20);
  *(undefined8 *)(Rn + 8) = uVar1;
  uVar1 = *(undefined8 *)(A + 0x38);
  *(undefined8 *)(Rn + 0x10) = *(undefined8 *)(A + 0x30);
  *(undefined8 *)(Rn + 0x18) = uVar1;
  return 0;
}



// WARNING: Unknown calling convention

int Expand(uchar *A,uchar *Rn,uchar *Ln)

{
  undefined8 uVar1;
  long lVar2;
  
  if ((Ln < A + 0x10) && (A < Ln + 0x10)) {
    lVar2 = 0;
    do {
      A[lVar2] = Ln[lVar2];
      lVar2 = lVar2 + 1;
    } while (lVar2 != 0x20);
  }
  else {
    uVar1 = *(undefined8 *)(Ln + 8);
    *(undefined8 *)A = *(undefined8 *)Ln;
    *(undefined8 *)(A + 8) = uVar1;
    uVar1 = *(undefined8 *)(Ln + 0x18);
    *(undefined8 *)(A + 0x10) = *(undefined8 *)(Ln + 0x10);
    *(undefined8 *)(A + 0x18) = uVar1;
  }
  if ((Rn < A + 0x30) && (A + 0x20 < Rn + 0x10)) {
    lVar2 = 0;
    do {
      A[lVar2 + 0x20] = Rn[lVar2];
      lVar2 = lVar2 + 1;
    } while (lVar2 != 0x20);
    return 0;
  }
  uVar1 = *(undefined8 *)(Rn + 8);
  *(undefined8 *)(A + 0x20) = *(undefined8 *)Rn;
  *(undefined8 *)(A + 0x28) = uVar1;
  uVar1 = *(undefined8 *)(Rn + 0x18);
  *(undefined8 *)(A + 0x30) = *(undefined8 *)(Rn + 0x10);
  *(undefined8 *)(A + 0x38) = uVar1;
  return 0;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address
// WARNING: Unknown calling convention

int F(int i,uchar *RnLn,uchar *X)

{
  undefined8 uVar1;
  undefined8 uVar2;
  undefined8 uVar3;
  undefined8 uVar4;
  undefined8 uVar5;
  undefined1 auVar6 [15];
  undefined1 auVar7 [15];
  undefined1 auVar8 [14];
  undefined1 auVar9 [15];
  undefined1 auVar10 [15];
  undefined1 auVar11 [14];
  undefined1 auVar12 [14];
  undefined1 auVar13 [15];
  undefined1 auVar14 [15];
  undefined1 auVar15 [14];
  undefined1 auVar16 [14];
  undefined1 auVar17 [15];
  undefined1 auVar18 [14];
  undefined1 auVar19 [15];
  undefined1 auVar20 [15];
  undefined1 auVar21 [15];
  undefined1 auVar22 [15];
  undefined1 auVar23 [15];
  undefined1 auVar24 [15];
  undefined1 auVar25 [15];
  undefined1 auVar26 [15];
  undefined1 auVar27 [15];
  undefined1 auVar28 [15];
  undefined1 auVar29 [15];
  uint uVar30;
  undefined1 auVar31 [15];
  uint uVar32;
  undefined1 auVar33 [15];
  undefined1 auVar34 [14];
  undefined1 auVar35 [13];
  undefined1 auVar36 [13];
  undefined1 auVar37 [13];
  undefined1 auVar38 [13];
  undefined1 auVar39 [13];
  undefined1 auVar40 [13];
  undefined1 auVar41 [15];
  undefined1 auVar42 [15];
  undefined1 auVar43 [14];
  undefined1 auVar44 [14];
  undefined1 auVar45 [13];
  undefined1 auVar46 [13];
  undefined1 auVar47 [13];
  undefined1 auVar48 [13];
  undefined1 auVar49 [13];
  undefined1 auVar50 [13];
  undefined1 auVar51 [15];
  undefined1 auVar52 [15];
  undefined1 auVar53 [14];
  undefined1 auVar54 [14];
  undefined1 auVar55 [13];
  undefined1 auVar56 [13];
  undefined1 auVar57 [13];
  undefined1 auVar58 [13];
  undefined1 auVar59 [13];
  undefined1 auVar60 [13];
  undefined1 auVar61 [15];
  undefined1 auVar62 [15];
  undefined1 auVar63 [15];
  undefined1 auVar64 [15];
  undefined1 auVar65 [15];
  undefined1 auVar66 [15];
  undefined1 auVar67 [15];
  undefined1 auVar68 [15];
  undefined1 auVar69 [15];
  undefined1 auVar70 [15];
  undefined1 auVar71 [15];
  undefined1 auVar72 [15];
  undefined1 auVar73 [15];
  undefined1 auVar74 [15];
  undefined1 auVar75 [15];
  undefined1 auVar76 [15];
  undefined1 auVar77 [15];
  undefined1 auVar78 [15];
  undefined1 auVar79 [15];
  undefined1 auVar80 [15];
  undefined1 auVar81 [15];
  undefined1 auVar82 [15];
  undefined1 auVar83 [15];
  undefined1 auVar84 [15];
  undefined1 auVar85 [16];
  undefined1 auVar86 [16];
  undefined1 auVar87 [15];
  unkuint9 Var88;
  undefined1 auVar89 [11];
  undefined1 auVar90 [14];
  undefined1 auVar91 [15];
  undefined1 auVar92 [11];
  undefined1 auVar93 [14];
  undefined1 auVar94 [16];
  undefined1 auVar95 [16];
  undefined1 auVar96 [13];
  undefined1 auVar97 [16];
  undefined1 auVar98 [13];
  undefined1 auVar99 [16];
  undefined1 auVar100 [16];
  undefined1 auVar101 [16];
  undefined1 auVar102 [16];
  undefined1 auVar103 [16];
  undefined1 auVar104 [16];
  undefined1 auVar105 [16];
  undefined1 auVar106 [16];
  undefined1 auVar107 [16];
  undefined1 auVar108 [16];
  undefined1 auVar109 [16];
  undefined1 auVar110 [16];
  undefined1 auVar111 [16];
  undefined1 auVar112 [16];
  undefined1 auVar113 [16];
  undefined1 auVar114 [15];
  undefined1 auVar115 [11];
  undefined1 auVar116 [15];
  unkuint9 Var117;
  undefined1 auVar118 [11];
  undefined1 auVar119 [14];
  undefined1 auVar120 [14];
  undefined1 auVar121 [16];
  undefined1 auVar122 [16];
  undefined1 auVar123 [13];
  undefined1 auVar124 [16];
  undefined1 auVar125 [13];
  undefined1 auVar126 [16];
  undefined1 auVar127 [16];
  undefined1 auVar128 [16];
  undefined1 auVar129 [16];
  undefined1 auVar130 [16];
  undefined1 auVar131 [16];
  undefined1 auVar132 [16];
  undefined1 auVar133 [16];
  undefined1 auVar134 [16];
  undefined1 auVar135 [16];
  undefined1 auVar136 [16];
  undefined1 auVar137 [16];
  undefined1 auVar138 [16];
  undefined1 auVar139 [16];
  undefined1 auVar140 [16];
  undefined1 auVar141 [15];
  undefined1 auVar142 [11];
  undefined1 auVar143 [15];
  undefined1 auVar144 [11];
  undefined1 auVar145 [14];
  undefined1 auVar146 [14];
  undefined1 auVar147 [13];
  undefined1 auVar148 [16];
  undefined1 auVar149 [16];
  undefined1 auVar150 [13];
  undefined1 auVar151 [16];
  undefined1 auVar152 [16];
  undefined1 auVar153 [16];
  undefined1 auVar154 [16];
  undefined1 auVar155 [16];
  undefined1 auVar156 [16];
  undefined1 auVar157 [16];
  undefined1 auVar158 [16];
  undefined1 auVar159 [16];
  undefined1 auVar160 [16];
  undefined1 auVar161 [16];
  undefined1 auVar162 [16];
  undefined1 auVar163 [16];
  undefined1 auVar164 [16];
  undefined1 auVar165 [16];
  undefined1 auVar166 [16];
  undefined1 auVar167 [15];
  undefined1 auVar168 [15];
  undefined1 auVar169 [15];
  undefined1 auVar170 [15];
  undefined1 auVar171 [15];
  undefined1 auVar172 [15];
  undefined1 auVar173 [15];
  undefined1 auVar174 [15];
  undefined1 auVar175 [15];
  undefined1 auVar176 [15];
  undefined1 auVar177 [15];
  undefined1 auVar178 [15];
  uint6 uVar179;
  uint6 uVar180;
  int iVar181;
  long lVar182;
  uchar *puVar183;
  uchar *puVar184;
  uchar *puVar185;
  int iVar186;
  int iVar219;
  int iVar220;
  int iVar222;
  undefined1 auVar188 [16];
  undefined1 auVar196 [16];
  undefined1 auVar204 [16];
  undefined1 auVar212 [16];
  undefined1 auVar223 [16];
  undefined1 auVar224 [16];
  undefined1 auVar228 [16];
  undefined1 auVar232 [16];
  uint uVar238;
  undefined1 auVar239 [16];
  undefined1 auVar240 [16];
  undefined1 auVar244 [16];
  undefined1 auVar248 [16];
  undefined1 auVar252 [16];
  undefined1 auVar260 [16];
  undefined1 auVar268 [16];
  undefined1 auVar276 [16];
  undefined1 auVar283 [16];
  undefined1 auVar284 [16];
  undefined1 auVar288 [16];
  undefined1 auVar292 [16];
  undefined1 auVar296 [16];
  undefined1 auVar304 [16];
  undefined1 auVar312 [16];
  undefined1 auVar320 [16];
  undefined1 auVar327 [16];
  undefined1 auVar330 [16];
  undefined1 auVar331 [16];
  undefined1 auVar332 [16];
  undefined1 auVar333 [16];
  undefined1 auVar334 [16];
  undefined1 auVar335 [16];
  uint uVar336;
  undefined1 uVar339;
  byte bVar340;
  undefined1 auVar337 [16];
  undefined1 auVar338 [16];
  ushort uVar341;
  uchar E [65];
  uchar IKey [65];
  uchar Y [65];
  undefined1 uVar187;
  undefined1 auVar189 [16];
  undefined1 auVar197 [16];
  undefined1 auVar205 [16];
  undefined1 auVar190 [16];
  undefined1 auVar198 [16];
  undefined1 auVar206 [16];
  undefined1 auVar213 [16];
  undefined1 auVar191 [16];
  undefined1 auVar199 [16];
  undefined1 auVar207 [16];
  undefined1 auVar214 [16];
  undefined1 auVar192 [16];
  undefined1 auVar200 [16];
  undefined1 auVar208 [16];
  undefined1 auVar215 [16];
  undefined1 auVar193 [16];
  undefined1 auVar201 [16];
  undefined1 auVar209 [16];
  undefined1 auVar216 [16];
  undefined1 auVar194 [16];
  undefined1 auVar202 [16];
  undefined1 auVar210 [16];
  undefined1 auVar217 [16];
  undefined1 auVar195 [16];
  undefined1 auVar203 [16];
  undefined1 auVar211 [16];
  undefined1 auVar218 [16];
  undefined8 uVar221;
  undefined1 auVar225 [16];
  undefined1 auVar229 [16];
  undefined1 auVar233 [16];
  undefined1 auVar226 [16];
  undefined1 auVar230 [16];
  undefined1 auVar234 [16];
  undefined1 auVar227 [16];
  undefined1 auVar231 [16];
  undefined1 auVar235 [16];
  undefined1 uVar236;
  undefined1 uVar237;
  undefined1 auVar241 [16];
  undefined1 auVar245 [16];
  undefined1 auVar249 [16];
  undefined1 auVar253 [16];
  undefined1 auVar261 [16];
  undefined1 auVar269 [16];
  undefined1 auVar285 [16];
  undefined1 auVar289 [16];
  undefined1 auVar293 [16];
  undefined1 auVar297 [16];
  undefined1 auVar305 [16];
  undefined1 auVar313 [16];
  undefined1 auVar254 [16];
  undefined1 auVar262 [16];
  undefined1 auVar270 [16];
  undefined1 auVar277 [16];
  undefined1 auVar298 [16];
  undefined1 auVar306 [16];
  undefined1 auVar314 [16];
  undefined1 auVar321 [16];
  undefined1 auVar242 [16];
  undefined1 auVar246 [16];
  undefined1 auVar250 [16];
  undefined1 auVar255 [16];
  undefined1 auVar263 [16];
  undefined1 auVar271 [16];
  undefined1 auVar278 [16];
  undefined1 auVar286 [16];
  undefined1 auVar290 [16];
  undefined1 auVar294 [16];
  undefined1 auVar299 [16];
  undefined1 auVar307 [16];
  undefined1 auVar315 [16];
  undefined1 auVar322 [16];
  undefined1 auVar256 [16];
  undefined1 auVar264 [16];
  undefined1 auVar272 [16];
  undefined1 auVar279 [16];
  undefined1 auVar300 [16];
  undefined1 auVar308 [16];
  undefined1 auVar316 [16];
  undefined1 auVar323 [16];
  undefined1 auVar243 [16];
  undefined1 auVar247 [16];
  undefined1 auVar251 [16];
  undefined1 auVar257 [16];
  undefined1 auVar265 [16];
  undefined1 auVar273 [16];
  undefined1 auVar280 [16];
  undefined1 auVar287 [16];
  undefined1 auVar291 [16];
  undefined1 auVar295 [16];
  undefined1 auVar301 [16];
  undefined1 auVar309 [16];
  undefined1 auVar317 [16];
  undefined1 auVar324 [16];
  undefined1 auVar258 [16];
  undefined1 auVar266 [16];
  undefined1 auVar274 [16];
  undefined1 auVar281 [16];
  undefined1 auVar302 [16];
  undefined1 auVar310 [16];
  undefined1 auVar318 [16];
  undefined1 auVar325 [16];
  undefined1 auVar259 [16];
  undefined1 auVar267 [16];
  undefined1 auVar275 [16];
  undefined1 auVar282 [16];
  undefined1 auVar303 [16];
  undefined1 auVar311 [16];
  undefined1 auVar319 [16];
  undefined1 auVar326 [16];
  undefined8 uVar328;
  undefined8 uVar329;
  
  iVar186 = 0;
  E._0_8_ = *(undefined8 *)RnLn;
  E._8_8_ = *(undefined8 *)(RnLn + 8);
  E._16_8_ = *(undefined8 *)(RnLn + 0x10);
  E._24_8_ = *(undefined8 *)(RnLn + 0x18);
  Transpose(E,Tab_Etr,0x30);
  auVar85[8] = E[8];
  auVar85[9] = E[9];
  auVar85[10] = E[10];
  auVar85[0xb] = E[0xb];
  auVar85[0xc] = E[0xc];
  auVar85[0xd] = E[0xd];
  auVar85[0xe] = E[0xe];
  auVar85[0xf] = E[0xf];
  auVar85[0] = E[0];
  auVar85[1] = E[1];
  auVar85[2] = E[2];
  auVar85[3] = E[3];
  auVar85[4] = E[4];
  auVar85[5] = E[5];
  auVar85[6] = E[6];
  auVar85[7] = E[7];
  auVar6[0xd] = 0;
  auVar6._0_13_ = auVar85._0_13_;
  auVar6[0xe] = SUB81(E._0_8_,7);
  auVar17[0xc] = SUB81(E._0_8_,6);
  auVar17._0_12_ = auVar85._0_12_;
  auVar17._13_2_ = auVar6._13_2_;
  auVar24[0xb] = 0;
  auVar24._0_11_ = auVar85._0_11_;
  auVar24._12_3_ = auVar17._12_3_;
  uVar30 = auVar24._11_4_;
  auVar31[10] = SUB81(E._0_8_,5);
  auVar31._0_10_ = auVar85._0_10_;
  auVar31._11_4_ = uVar30;
  auVar61[9] = 0;
  auVar61._0_9_ = auVar85._0_9_;
  auVar61._10_5_ = auVar31._10_5_;
  auVar67[8] = SUB81(E._0_8_,4);
  auVar67[0] = E[0];
  auVar67[1] = E[1];
  auVar67[2] = E[2];
  auVar67[3] = E[3];
  auVar67[4] = E[4];
  auVar67[5] = E[5];
  auVar67[6] = E[6];
  auVar67[7] = E[7];
  auVar67._9_6_ = auVar61._9_6_;
  auVar87._7_8_ = 0;
  auVar87._0_7_ = auVar67._8_7_;
  Var88 = CONCAT81(SUB158(auVar87 << 0x40,7),SUB81(E._0_8_,3));
  auVar167._9_6_ = 0;
  auVar167._0_9_ = Var88;
  auVar89._1_10_ = SUB1510(auVar167 << 0x30,5);
  auVar89[0] = SUB81(E._0_8_,2);
  auVar168._11_4_ = 0;
  auVar168._0_11_ = auVar89;
  auVar73[2] = SUB81(E._0_8_,1);
  auVar73._0_2_ = (ushort)E._0_8_;
  auVar73._3_12_ = SUB1512(auVar168 << 0x20,3);
  uVar341 = (ushort)E._0_8_ & 0xff;
  auVar79._2_13_ = auVar73._2_13_;
  auVar79._0_2_ = uVar341;
  uVar238 = CONCAT13(0,CONCAT12(SUB81(E._8_8_,1),(ushort)(byte)E._8_8_));
  uVar1 = *(undefined8 *)I_Key[i];
  uVar2 = *(undefined8 *)(I_Key[i] + 8);
  auVar85 = *(undefined1 (*) [16])I_Key[i];
  auVar18._10_2_ = 0;
  auVar18._0_10_ = auVar79._0_10_;
  auVar18._12_2_ = (short)Var88;
  uVar179 = CONCAT42(auVar18._10_4_,auVar89._0_2_);
  auVar90._6_8_ = 0;
  auVar90._0_6_ = uVar179;
  uVar3 = *(undefined8 *)(I_Key[i] + 0x10);
  uVar339 = (undefined1)((ulong)uVar2 >> 8);
  uVar336 = CONCAT13(0,CONCAT12(uVar339,(ushort)(byte)uVar2));
  bVar340 = (byte)((ulong)uVar2 >> 0x20);
  uVar4 = *(undefined8 *)(I_Key[i] + 0x18);
  auVar284 = *(undefined1 (*) [16])(I_Key[i] + 0x10);
  auVar7[0xd] = 0;
  auVar7._0_13_ = auVar85._0_13_;
  auVar7[0xe] = (char)((ulong)uVar1 >> 0x38);
  auVar19[0xc] = (char)((ulong)uVar1 >> 0x30);
  auVar19._0_12_ = auVar85._0_12_;
  auVar19._13_2_ = auVar7._13_2_;
  auVar25[0xb] = 0;
  auVar25._0_11_ = auVar85._0_11_;
  auVar25._12_3_ = auVar19._12_3_;
  uVar32 = auVar25._11_4_;
  auVar33[10] = (char)((ulong)uVar1 >> 0x28);
  auVar33._0_10_ = auVar85._0_10_;
  auVar33._11_4_ = uVar32;
  auVar62[9] = 0;
  auVar62._0_9_ = auVar85._0_9_;
  auVar62._10_5_ = auVar33._10_5_;
  auVar68[8] = (char)((ulong)uVar1 >> 0x20);
  auVar68._0_8_ = uVar1;
  auVar68._9_6_ = auVar62._9_6_;
  auVar91._7_8_ = 0;
  auVar91._0_7_ = auVar68._8_7_;
  Var88 = CONCAT81(SUB158(auVar91 << 0x40,7),(char)((ulong)uVar1 >> 0x18));
  auVar169._9_6_ = 0;
  auVar169._0_9_ = Var88;
  auVar92._1_10_ = SUB1510(auVar169 << 0x30,5);
  auVar92[0] = (char)((ulong)uVar1 >> 0x10);
  auVar170._11_4_ = 0;
  auVar170._0_11_ = auVar92;
  auVar74[2] = (char)((ulong)uVar1 >> 8);
  auVar74._0_2_ = (ushort)uVar1;
  auVar74._3_12_ = SUB1512(auVar170 << 0x20,3);
  auVar80._2_13_ = auVar74._2_13_;
  auVar80._0_2_ = (ushort)uVar1 & 0xff;
  uVar1 = *(undefined8 *)(I_Key[i] + 0x20);
  auVar8._10_2_ = 0;
  auVar8._0_10_ = auVar80._0_10_;
  auVar8._12_2_ = (short)Var88;
  uVar180 = CONCAT42(auVar8._10_4_,auVar92._0_2_);
  auVar93._6_8_ = 0;
  auVar93._0_6_ = uVar180;
  auVar34._4_2_ = auVar74._2_2_;
  auVar34._0_4_ = auVar80._0_4_;
  auVar34._6_8_ = SUB148(auVar93 << 0x40,6);
  uVar5 = *(undefined8 *)(I_Key[i] + 0x28);
  auVar85 = *(undefined1 (*) [16])(I_Key[i] + 0x20);
  iVar181 = (int)DAT_004e8840;
  auVar239._0_4_ = -(uint)((uint)uVar341 + (auVar80._0_4_ & 0xffff) == iVar181);
  iVar219 = DAT_004e8840._4_4_;
  auVar239._4_4_ =
       -(uint)((int)CONCAT82(SUB148(auVar90 << 0x40,6),auVar73._2_2_) + auVar34._4_4_ == iVar219);
  iVar220 = DAT_004e8840._8_4_;
  auVar239._8_4_ = -(uint)((int)uVar179 + (int)uVar180 == iVar220);
  iVar222 = DAT_004e8840._12_4_;
  auVar239._12_4_ = -(uint)((auVar18._10_4_ >> 0x10) + (auVar8._10_4_ >> 0x10) == iVar222);
  auVar330._0_4_ = -(uint)((uint)auVar67._8_2_ + (uint)auVar68._8_2_ == iVar181);
  auVar330._4_4_ = -(uint)((uint)auVar31._10_2_ + (uint)auVar33._10_2_ == iVar219);
  auVar330._8_4_ = -(uint)((uVar30 >> 8 & 0xffff) + (uVar32 >> 8 & 0xffff) == iVar220);
  auVar330._12_4_ = -(uint)((uVar30 >> 0x18) + (uVar32 >> 0x18) == iVar222);
  auVar239 = auVar239 & _DAT_004e8840;
  auVar330 = auVar330 & _DAT_004e8840;
  auVar243._0_12_ = auVar239._0_12_;
  auVar243._12_2_ = auVar239._6_2_;
  auVar243._14_2_ = auVar330._6_2_;
  auVar242._12_4_ = auVar243._12_4_;
  auVar242._0_10_ = auVar239._0_10_;
  auVar242._10_2_ = auVar330._4_2_;
  auVar241._10_6_ = auVar242._10_6_;
  auVar241._0_8_ = auVar239._0_8_;
  auVar241._8_2_ = auVar239._4_2_;
  auVar94._2_8_ = auVar241._8_8_;
  auVar94._0_2_ = auVar330._2_2_;
  auVar94._10_6_ = 0;
  auVar240._12_4_ = 0;
  auVar240._0_12_ = SUB1612(auVar94 << 0x30,4);
  auVar240 = auVar240 << 0x20;
  auVar247._0_12_ = auVar240._0_12_;
  auVar247._12_2_ = auVar330._2_2_;
  auVar247._14_2_ = auVar330._10_2_;
  auVar246._12_4_ = auVar247._12_4_;
  auVar246._0_10_ = auVar240._0_10_;
  auVar246._10_2_ = auVar239._10_2_;
  auVar245._10_6_ = auVar246._10_6_;
  auVar245._0_8_ = auVar240._0_8_;
  auVar245._8_2_ = auVar239._2_2_;
  auVar95._2_8_ = auVar245._8_8_;
  auVar95._0_2_ = auVar330._8_2_;
  auVar95._10_6_ = 0;
  auVar244._12_4_ = 0;
  auVar244._0_12_ = SUB1612(auVar95 << 0x30,4);
  auVar244 = auVar244 << 0x20;
  auVar35[0xc] = SUB81(E._8_8_,3);
  auVar35._0_12_ = ZEXT112(SUB81(E._8_8_,4)) << 0x40;
  auVar36._10_3_ = auVar35._10_3_;
  auVar36._0_10_ = (unkuint10)SUB81(E._8_8_,2) << 0x40;
  auVar96._5_8_ = 0;
  auVar96._0_5_ = auVar36._8_5_;
  auVar37[4] = SUB81(E._8_8_,1);
  auVar37._0_4_ = uVar238;
  auVar37[5] = 0;
  auVar37._6_7_ = SUB137(auVar96 << 0x40,6);
  auVar251._0_12_ = auVar244._0_12_;
  auVar251._12_2_ = auVar330._8_2_;
  auVar251._14_2_ = auVar330._12_2_;
  auVar250._12_4_ = auVar251._12_4_;
  auVar250._0_10_ = auVar244._0_10_;
  auVar250._10_2_ = auVar330._4_2_;
  auVar249._10_6_ = auVar250._10_6_;
  auVar249._0_8_ = auVar244._0_8_;
  auVar249._8_2_ = auVar330._0_2_;
  auVar97._2_8_ = auVar249._8_8_;
  auVar97._0_2_ = auVar239._12_2_;
  auVar97._10_6_ = 0;
  auVar248._12_4_ = 0;
  auVar248._0_12_ = SUB1612(auVar97 << 0x30,4);
  auVar248 = auVar248 << 0x20;
  auVar38[0xc] = (char)((ulong)uVar2 >> 0x18);
  auVar38._0_12_ = ZEXT112(bVar340) << 0x40;
  auVar39._10_3_ = auVar38._10_3_;
  auVar39._0_10_ = (unkuint10)(byte)((ulong)uVar2 >> 0x10) << 0x40;
  auVar98._5_8_ = 0;
  auVar98._0_5_ = auVar39._8_5_;
  auVar40[4] = uVar339;
  auVar40._0_4_ = uVar336;
  auVar40[5] = 0;
  auVar40._6_7_ = SUB137(auVar98 << 0x40,6);
  auVar337._0_4_ = -(uint)((uint)SUB81(E._8_8_,4) + (uint)bVar340 == iVar181);
  auVar337._4_4_ = -(uint)((uint)SUB81(E._8_8_,5) + (uint)(byte)((ulong)uVar2 >> 0x28) == iVar219);
  auVar337._8_4_ = -(uint)((uint)SUB81(E._8_8_,6) + (uint)(byte)((ulong)uVar2 >> 0x30) == iVar220);
  auVar337._12_4_ = -(uint)((uint)SUB81(E._8_8_,7) + (uint)(byte)((ulong)uVar2 >> 0x38) == iVar222);
  auVar331._0_4_ = -(uint)((uVar336 & 0xffff) + (uVar238 & 0xffff) == iVar181);
  auVar331._4_4_ = -(uint)(auVar40._4_4_ + auVar37._4_4_ == iVar219);
  auVar331._8_4_ = -(uint)(auVar39._8_4_ + auVar36._8_4_ == iVar220);
  auVar331._12_4_ =
       -(uint)((uint)(uint3)(auVar38._10_3_ >> 0x10) + (uint)(uint3)(auVar35._10_3_ >> 0x10) ==
              iVar222);
  auVar337 = auVar337 & _DAT_004e8840;
  auVar331 = auVar331 & _DAT_004e8840;
  auVar259._0_14_ = auVar248._0_14_;
  auVar259[0xe] = auVar239[0xd];
  auVar259[0xf] = auVar331[0xd];
  auVar258._14_2_ = auVar259._14_2_;
  auVar258._0_13_ = auVar248._0_13_;
  auVar258[0xd] = auVar331[0xc];
  auVar257._13_3_ = auVar258._13_3_;
  auVar257._0_12_ = auVar248._0_12_;
  auVar257[0xc] = auVar239[0xc];
  auVar256._12_4_ = auVar257._12_4_;
  auVar256._0_11_ = auVar248._0_11_;
  auVar256[0xb] = auVar331[9];
  auVar255._11_5_ = auVar256._11_5_;
  auVar255._0_10_ = auVar248._0_10_;
  auVar255[10] = auVar239[9];
  auVar254._10_6_ = auVar255._10_6_;
  auVar254._0_9_ = auVar248._0_9_;
  auVar254[9] = auVar331[8];
  auVar253._9_7_ = auVar254._9_7_;
  auVar253._0_8_ = auVar248._0_8_;
  auVar253[8] = auVar239[8];
  auVar103._1_8_ = auVar253._8_8_;
  auVar103[0] = auVar331[5];
  auVar103._9_7_ = 0;
  auVar102._10_6_ = 0;
  auVar102._0_10_ = SUB1610(auVar103 << 0x38,6);
  auVar101._11_5_ = 0;
  auVar101._0_11_ = SUB1611(auVar102 << 0x30,5);
  auVar100._12_4_ = 0;
  auVar100._0_12_ = SUB1612(auVar101 << 0x28,4);
  auVar99._13_3_ = 0;
  auVar99._0_13_ = SUB1613(auVar100 << 0x20,3);
  uVar236 = auVar239[0];
  auVar252._14_2_ = 0;
  auVar252._0_14_ = SUB1614(auVar99 << 0x18,2);
  auVar252 = auVar252 << 0x10;
  auVar267._0_14_ = auVar252._0_14_;
  auVar267[0xe] = auVar331[5];
  auVar267[0xf] = auVar337[5];
  auVar266._14_2_ = auVar267._14_2_;
  auVar266._0_13_ = auVar252._0_13_;
  auVar266[0xd] = auVar330[5];
  auVar265._13_3_ = auVar266._13_3_;
  auVar265._0_12_ = auVar252._0_12_;
  auVar265[0xc] = auVar239[5];
  auVar264._12_4_ = auVar265._12_4_;
  auVar264._0_11_ = auVar252._0_11_;
  auVar264[0xb] = auVar337[4];
  auVar263._11_5_ = auVar264._11_5_;
  auVar263._0_10_ = auVar252._0_10_;
  auVar263[10] = auVar331[4];
  auVar262._10_6_ = auVar263._10_6_;
  auVar262._0_9_ = auVar252._0_9_;
  auVar262[9] = auVar330[4];
  auVar261._9_7_ = auVar262._9_7_;
  auVar261._0_8_ = auVar252._0_8_;
  auVar261[8] = auVar239[4];
  auVar108._1_8_ = auVar261._8_8_;
  auVar108[0] = auVar337[1];
  auVar108._9_7_ = 0;
  auVar107._10_6_ = 0;
  auVar107._0_10_ = SUB1610(auVar108 << 0x38,6);
  auVar106._11_5_ = 0;
  auVar106._0_11_ = SUB1611(auVar107 << 0x30,5);
  auVar105._12_4_ = 0;
  auVar105._0_12_ = SUB1612(auVar106 << 0x28,4);
  auVar104._13_3_ = 0;
  auVar104._0_13_ = SUB1613(auVar105 << 0x20,3);
  auVar260._14_2_ = 0;
  auVar260._0_14_ = SUB1614(auVar104 << 0x18,2);
  auVar260 = auVar260 << 0x10;
  auVar275._0_14_ = auVar260._0_14_;
  auVar275[0xe] = auVar337[1];
  auVar275[0xf] = auVar337[9];
  auVar274._14_2_ = auVar275._14_2_;
  auVar274._0_13_ = auVar260._0_13_;
  auVar274[0xd] = auVar331[9];
  auVar273._13_3_ = auVar274._13_3_;
  auVar273._0_12_ = auVar260._0_12_;
  auVar273[0xc] = auVar331[1];
  auVar272._12_4_ = auVar273._12_4_;
  auVar272._0_11_ = auVar260._0_11_;
  auVar272[0xb] = auVar330[9];
  auVar271._11_5_ = auVar272._11_5_;
  auVar271._0_10_ = auVar260._0_10_;
  auVar271[10] = auVar330[1];
  auVar270._10_6_ = auVar271._10_6_;
  auVar270._0_9_ = auVar260._0_9_;
  auVar270[9] = auVar239[9];
  auVar269._9_7_ = auVar270._9_7_;
  auVar269._0_8_ = auVar260._0_8_;
  auVar269[8] = auVar239[1];
  auVar113._1_8_ = auVar269._8_8_;
  auVar113[0] = auVar337[8];
  auVar113._9_7_ = 0;
  auVar112._10_6_ = 0;
  auVar112._0_10_ = SUB1610(auVar113 << 0x38,6);
  auVar111._11_5_ = 0;
  auVar111._0_11_ = SUB1611(auVar112 << 0x30,5);
  auVar110._12_4_ = 0;
  auVar110._0_12_ = SUB1612(auVar111 << 0x28,4);
  auVar109._13_3_ = 0;
  auVar109._0_13_ = SUB1613(auVar110 << 0x20,3);
  auVar268._14_2_ = 0;
  auVar268._0_14_ = SUB1614(auVar109 << 0x18,2);
  auVar268 = auVar268 << 0x10;
  auVar282._0_14_ = auVar268._0_14_;
  auVar282[0xe] = auVar337[8];
  auVar282[0xf] = auVar337[0xc];
  auVar281._14_2_ = auVar282._14_2_;
  auVar281._0_13_ = auVar268._0_13_;
  auVar281[0xd] = auVar337[4];
  auVar280._13_3_ = auVar281._13_3_;
  auVar280._0_12_ = auVar268._0_12_;
  auVar280[0xc] = auVar337[0];
  auVar279._12_4_ = auVar280._12_4_;
  auVar279._0_11_ = auVar268._0_11_;
  auVar279[0xb] = auVar331[0xc];
  auVar278._11_5_ = auVar279._11_5_;
  auVar278._0_10_ = auVar268._0_10_;
  auVar278[10] = auVar331[8];
  auVar277._10_6_ = auVar278._10_6_;
  auVar277._0_9_ = auVar268._0_9_;
  auVar277[9] = auVar331[4];
  auVar276._9_7_ = auVar277._9_7_;
  auVar276._0_8_ = auVar268._0_8_;
  auVar276[8] = auVar331[0];
  uVar328 = auVar276._8_8_;
  auVar86[8] = E[0x18];
  auVar86[9] = E[0x19];
  auVar86[10] = E[0x1a];
  auVar86[0xb] = E[0x1b];
  auVar86[0xc] = E[0x1c];
  auVar86[0xd] = E[0x1d];
  auVar86[0xe] = E[0x1e];
  auVar86[0xf] = E[0x1f];
  auVar86[0] = E[0x10];
  auVar86[1] = E[0x11];
  auVar86[2] = E[0x12];
  auVar86[3] = E[0x13];
  auVar86[4] = E[0x14];
  auVar86[5] = E[0x15];
  auVar86[6] = E[0x16];
  auVar86[7] = E[0x17];
  Y[0] = uVar236;
  Y[1] = auVar239[4];
  Y[2] = auVar239[8];
  Y[3] = auVar239[0xc];
  Y[4] = auVar330[0];
  Y[5] = auVar330[4];
  Y[6] = auVar330[8];
  Y[7] = auVar330[0xc];
  Y[8] = (char)uVar328;
  Y[9] = (char)((ulong)uVar328 >> 8);
  Y[10] = (char)((ulong)uVar328 >> 0x10);
  Y[0xb] = (char)((ulong)uVar328 >> 0x18);
  Y[0xc] = (char)((ulong)uVar328 >> 0x20);
  Y[0xd] = (char)((ulong)uVar328 >> 0x28);
  Y[0xe] = (char)((ulong)uVar328 >> 0x30);
  Y[0xf] = (char)((ulong)uVar328 >> 0x38);
  auVar9[0xd] = 0;
  auVar9._0_13_ = auVar86._0_13_;
  auVar9[0xe] = SUB81(E._16_8_,7);
  auVar20[0xc] = SUB81(E._16_8_,6);
  auVar20._0_12_ = auVar86._0_12_;
  auVar20._13_2_ = auVar9._13_2_;
  auVar26[0xb] = 0;
  auVar26._0_11_ = auVar86._0_11_;
  auVar26._12_3_ = auVar20._12_3_;
  uVar30 = auVar26._11_4_;
  auVar41[10] = SUB81(E._16_8_,5);
  auVar41._0_10_ = auVar86._0_10_;
  auVar41._11_4_ = uVar30;
  auVar63[9] = 0;
  auVar63._0_9_ = auVar86._0_9_;
  auVar63._10_5_ = auVar41._10_5_;
  auVar69[8] = SUB81(E._16_8_,4);
  auVar69[0] = E[0x10];
  auVar69[1] = E[0x11];
  auVar69[2] = E[0x12];
  auVar69[3] = E[0x13];
  auVar69[4] = E[0x14];
  auVar69[5] = E[0x15];
  auVar69[6] = E[0x16];
  auVar69[7] = E[0x17];
  auVar69._9_6_ = auVar63._9_6_;
  auVar114._7_8_ = 0;
  auVar114._0_7_ = auVar69._8_7_;
  Var88 = CONCAT81(SUB158(auVar114 << 0x40,7),SUB81(E._16_8_,3));
  auVar171._9_6_ = 0;
  auVar171._0_9_ = Var88;
  auVar115._1_10_ = SUB1510(auVar171 << 0x30,5);
  auVar115[0] = SUB81(E._16_8_,2);
  auVar172._11_4_ = 0;
  auVar172._0_11_ = auVar115;
  auVar75[2] = SUB81(E._16_8_,1);
  auVar75._0_2_ = (ushort)E._16_8_;
  auVar75._3_12_ = SUB1512(auVar172 << 0x20,3);
  auVar81._2_13_ = auVar75._2_13_;
  auVar81._0_2_ = (ushort)E._16_8_ & 0xff;
  uVar238 = CONCAT13(0,CONCAT12(SUB81(E._24_8_,1),(ushort)(byte)E._24_8_));
  uVar339 = (undefined1)((ulong)uVar4 >> 8);
  uVar336 = CONCAT13(0,CONCAT12(uVar339,(ushort)(byte)uVar4));
  bVar340 = (byte)((ulong)uVar4 >> 0x20);
  auVar10[0xd] = 0;
  auVar10._0_13_ = auVar284._0_13_;
  auVar10[0xe] = (char)((ulong)uVar3 >> 0x38);
  auVar21[0xc] = (char)((ulong)uVar3 >> 0x30);
  auVar21._0_12_ = auVar284._0_12_;
  auVar21._13_2_ = auVar10._13_2_;
  auVar27[0xb] = 0;
  auVar27._0_11_ = auVar284._0_11_;
  auVar27._12_3_ = auVar21._12_3_;
  uVar32 = auVar27._11_4_;
  auVar42[10] = (char)((ulong)uVar3 >> 0x28);
  auVar42._0_10_ = auVar284._0_10_;
  auVar42._11_4_ = uVar32;
  auVar64[9] = 0;
  auVar64._0_9_ = auVar284._0_9_;
  auVar64._10_5_ = auVar42._10_5_;
  auVar70[8] = (char)((ulong)uVar3 >> 0x20);
  auVar70._0_8_ = uVar3;
  auVar70._9_6_ = auVar64._9_6_;
  auVar116._7_8_ = 0;
  auVar116._0_7_ = auVar70._8_7_;
  Var117 = CONCAT81(SUB158(auVar116 << 0x40,7),(char)((ulong)uVar3 >> 0x18));
  auVar173._9_6_ = 0;
  auVar173._0_9_ = Var117;
  auVar118._1_10_ = SUB1510(auVar173 << 0x30,5);
  auVar118[0] = (char)((ulong)uVar3 >> 0x10);
  auVar174._11_4_ = 0;
  auVar174._0_11_ = auVar118;
  auVar76[2] = (char)((ulong)uVar3 >> 8);
  auVar76._0_2_ = (ushort)uVar3;
  auVar76._3_12_ = SUB1512(auVar174 << 0x20,3);
  auVar82._2_13_ = auVar76._2_13_;
  auVar82._0_2_ = (ushort)uVar3 & 0xff;
  auVar11._10_2_ = 0;
  auVar11._0_10_ = auVar81._0_10_;
  auVar11._12_2_ = (short)Var88;
  uVar179 = CONCAT42(auVar11._10_4_,auVar115._0_2_);
  auVar119._6_8_ = 0;
  auVar119._0_6_ = uVar179;
  auVar43._4_2_ = auVar75._2_2_;
  auVar43._0_4_ = auVar81._0_4_;
  auVar43._6_8_ = SUB148(auVar119 << 0x40,6);
  auVar12._10_2_ = 0;
  auVar12._0_10_ = auVar82._0_10_;
  auVar12._12_2_ = (short)Var117;
  uVar180 = CONCAT42(auVar12._10_4_,auVar118._0_2_);
  auVar120._6_8_ = 0;
  auVar120._0_6_ = uVar180;
  auVar44._4_2_ = auVar76._2_2_;
  auVar44._0_4_ = auVar82._0_4_;
  auVar44._6_8_ = SUB148(auVar120 << 0x40,6);
  auVar332._0_4_ = -(uint)((uint)auVar69._8_2_ + (uint)auVar70._8_2_ == iVar181);
  auVar332._4_4_ = -(uint)((uint)auVar41._10_2_ + (uint)auVar42._10_2_ == iVar219);
  auVar332._8_4_ = -(uint)((uVar30 >> 8 & 0xffff) + (uVar32 >> 8 & 0xffff) == iVar220);
  auVar332._12_4_ = -(uint)((uVar30 >> 0x18) + (uVar32 >> 0x18) == iVar222);
  auVar283._0_4_ = -(uint)((auVar82._0_4_ & 0xffff) + (auVar81._0_4_ & 0xffff) == iVar181);
  auVar283._4_4_ = -(uint)(auVar44._4_4_ + auVar43._4_4_ == iVar219);
  auVar283._8_4_ = -(uint)((int)uVar180 + (int)uVar179 == iVar220);
  auVar283._12_4_ = -(uint)((auVar12._10_4_ >> 0x10) + (auVar11._10_4_ >> 0x10) == iVar222);
  auVar332 = auVar332 & _DAT_004e8840;
  auVar283 = auVar283 & _DAT_004e8840;
  auVar287._0_12_ = auVar283._0_12_;
  auVar287._12_2_ = auVar283._6_2_;
  auVar287._14_2_ = auVar332._6_2_;
  auVar286._12_4_ = auVar287._12_4_;
  auVar286._0_10_ = auVar283._0_10_;
  auVar286._10_2_ = auVar332._4_2_;
  auVar285._10_6_ = auVar286._10_6_;
  auVar285._0_8_ = auVar283._0_8_;
  auVar285._8_2_ = auVar283._4_2_;
  auVar121._2_8_ = auVar285._8_8_;
  auVar121._0_2_ = auVar332._2_2_;
  auVar121._10_6_ = 0;
  auVar284._12_4_ = 0;
  auVar284._0_12_ = SUB1612(auVar121 << 0x30,4);
  auVar284 = auVar284 << 0x20;
  auVar291._0_12_ = auVar284._0_12_;
  auVar291._12_2_ = auVar332._2_2_;
  auVar291._14_2_ = auVar332._10_2_;
  auVar290._12_4_ = auVar291._12_4_;
  auVar290._0_10_ = auVar284._0_10_;
  auVar290._10_2_ = auVar283._10_2_;
  auVar289._10_6_ = auVar290._10_6_;
  auVar289._0_8_ = auVar284._0_8_;
  auVar289._8_2_ = auVar283._2_2_;
  auVar122._2_8_ = auVar289._8_8_;
  auVar122._0_2_ = auVar332._8_2_;
  auVar122._10_6_ = 0;
  auVar288._12_4_ = 0;
  auVar288._0_12_ = SUB1612(auVar122 << 0x30,4);
  auVar288 = auVar288 << 0x20;
  auVar45[0xc] = SUB81(E._24_8_,3);
  auVar45._0_12_ = ZEXT112(SUB81(E._24_8_,4)) << 0x40;
  auVar46._10_3_ = auVar45._10_3_;
  auVar46._0_10_ = (unkuint10)SUB81(E._24_8_,2) << 0x40;
  auVar123._5_8_ = 0;
  auVar123._0_5_ = auVar46._8_5_;
  auVar47[4] = SUB81(E._24_8_,1);
  auVar47._0_4_ = uVar238;
  auVar47[5] = 0;
  auVar47._6_7_ = SUB137(auVar123 << 0x40,6);
  auVar295._0_12_ = auVar288._0_12_;
  auVar295._12_2_ = auVar332._8_2_;
  auVar295._14_2_ = auVar332._12_2_;
  auVar294._12_4_ = auVar295._12_4_;
  auVar294._0_10_ = auVar288._0_10_;
  auVar294._10_2_ = auVar332._4_2_;
  auVar293._10_6_ = auVar294._10_6_;
  auVar293._0_8_ = auVar288._0_8_;
  auVar293._8_2_ = auVar332._0_2_;
  auVar124._2_8_ = auVar293._8_8_;
  auVar124._0_2_ = auVar283._12_2_;
  auVar124._10_6_ = 0;
  auVar292._12_4_ = 0;
  auVar292._0_12_ = SUB1612(auVar124 << 0x30,4);
  auVar292 = auVar292 << 0x20;
  auVar48[0xc] = (char)((ulong)uVar4 >> 0x18);
  auVar48._0_12_ = ZEXT112(bVar340) << 0x40;
  auVar49._10_3_ = auVar48._10_3_;
  auVar49._0_10_ = (unkuint10)(byte)((ulong)uVar4 >> 0x10) << 0x40;
  auVar125._5_8_ = 0;
  auVar125._0_5_ = auVar49._8_5_;
  auVar50[4] = uVar339;
  auVar50._0_4_ = uVar336;
  auVar50[5] = 0;
  auVar50._6_7_ = SUB137(auVar125 << 0x40,6);
  auVar338._0_4_ = -(uint)((uint)SUB81(E._24_8_,4) + (uint)bVar340 == iVar181);
  auVar338._4_4_ = -(uint)((uint)SUB81(E._24_8_,5) + (uint)(byte)((ulong)uVar4 >> 0x28) == iVar219);
  auVar338._8_4_ = -(uint)((uint)SUB81(E._24_8_,6) + (uint)(byte)((ulong)uVar4 >> 0x30) == iVar220);
  auVar338._12_4_ = -(uint)((uint)SUB81(E._24_8_,7) + (uint)(byte)((ulong)uVar4 >> 0x38) == iVar222)
  ;
  auVar333._0_4_ = -(uint)((uVar336 & 0xffff) + (uVar238 & 0xffff) == iVar181);
  auVar333._4_4_ = -(uint)(auVar50._4_4_ + auVar47._4_4_ == iVar219);
  auVar333._8_4_ = -(uint)(auVar49._8_4_ + auVar46._8_4_ == iVar220);
  auVar333._12_4_ =
       -(uint)((uint)(uint3)(auVar48._10_3_ >> 0x10) + (uint)(uint3)(auVar45._10_3_ >> 0x10) ==
              iVar222);
  auVar338 = auVar338 & _DAT_004e8840;
  auVar333 = auVar333 & _DAT_004e8840;
  auVar303._0_14_ = auVar292._0_14_;
  auVar303[0xe] = auVar283[0xd];
  auVar303[0xf] = auVar333[0xd];
  auVar302._14_2_ = auVar303._14_2_;
  auVar302._0_13_ = auVar292._0_13_;
  auVar302[0xd] = auVar333[0xc];
  auVar301._13_3_ = auVar302._13_3_;
  auVar301._0_12_ = auVar292._0_12_;
  auVar301[0xc] = auVar283[0xc];
  auVar300._12_4_ = auVar301._12_4_;
  auVar300._0_11_ = auVar292._0_11_;
  auVar300[0xb] = auVar333[9];
  auVar299._11_5_ = auVar300._11_5_;
  auVar299._0_10_ = auVar292._0_10_;
  auVar299[10] = auVar283[9];
  auVar298._10_6_ = auVar299._10_6_;
  auVar298._0_9_ = auVar292._0_9_;
  auVar298[9] = auVar333[8];
  auVar297._9_7_ = auVar298._9_7_;
  auVar297._0_8_ = auVar292._0_8_;
  auVar297[8] = auVar283[8];
  auVar130._1_8_ = auVar297._8_8_;
  auVar130[0] = auVar333[5];
  auVar130._9_7_ = 0;
  auVar129._10_6_ = 0;
  auVar129._0_10_ = SUB1610(auVar130 << 0x38,6);
  auVar128._11_5_ = 0;
  auVar128._0_11_ = SUB1611(auVar129 << 0x30,5);
  auVar127._12_4_ = 0;
  auVar127._0_12_ = SUB1612(auVar128 << 0x28,4);
  auVar126._13_3_ = 0;
  auVar126._0_13_ = SUB1613(auVar127 << 0x20,3);
  uVar237 = auVar283[0];
  auVar296._14_2_ = 0;
  auVar296._0_14_ = SUB1614(auVar126 << 0x18,2);
  auVar296 = auVar296 << 0x10;
  auVar311._0_14_ = auVar296._0_14_;
  auVar311[0xe] = auVar333[5];
  auVar311[0xf] = auVar338[5];
  auVar310._14_2_ = auVar311._14_2_;
  auVar310._0_13_ = auVar296._0_13_;
  auVar310[0xd] = auVar332[5];
  auVar309._13_3_ = auVar310._13_3_;
  auVar309._0_12_ = auVar296._0_12_;
  auVar309[0xc] = auVar283[5];
  auVar308._12_4_ = auVar309._12_4_;
  auVar308._0_11_ = auVar296._0_11_;
  auVar308[0xb] = auVar338[4];
  auVar307._11_5_ = auVar308._11_5_;
  auVar307._0_10_ = auVar296._0_10_;
  auVar307[10] = auVar333[4];
  auVar306._10_6_ = auVar307._10_6_;
  auVar306._0_9_ = auVar296._0_9_;
  auVar306[9] = auVar332[4];
  auVar305._9_7_ = auVar306._9_7_;
  auVar305._0_8_ = auVar296._0_8_;
  auVar305[8] = auVar283[4];
  auVar135._1_8_ = auVar305._8_8_;
  auVar135[0] = auVar338[1];
  auVar135._9_7_ = 0;
  auVar134._10_6_ = 0;
  auVar134._0_10_ = SUB1610(auVar135 << 0x38,6);
  auVar133._11_5_ = 0;
  auVar133._0_11_ = SUB1611(auVar134 << 0x30,5);
  auVar132._12_4_ = 0;
  auVar132._0_12_ = SUB1612(auVar133 << 0x28,4);
  auVar131._13_3_ = 0;
  auVar131._0_13_ = SUB1613(auVar132 << 0x20,3);
  auVar304._14_2_ = 0;
  auVar304._0_14_ = SUB1614(auVar131 << 0x18,2);
  auVar304 = auVar304 << 0x10;
  auVar319._0_14_ = auVar304._0_14_;
  auVar319[0xe] = auVar338[1];
  auVar319[0xf] = auVar338[9];
  auVar318._14_2_ = auVar319._14_2_;
  auVar318._0_13_ = auVar304._0_13_;
  auVar318[0xd] = auVar333[9];
  auVar317._13_3_ = auVar318._13_3_;
  auVar317._0_12_ = auVar304._0_12_;
  auVar317[0xc] = auVar333[1];
  auVar316._12_4_ = auVar317._12_4_;
  auVar316._0_11_ = auVar304._0_11_;
  auVar316[0xb] = auVar332[9];
  auVar315._11_5_ = auVar316._11_5_;
  auVar315._0_10_ = auVar304._0_10_;
  auVar315[10] = auVar332[1];
  auVar314._10_6_ = auVar315._10_6_;
  auVar314._0_9_ = auVar304._0_9_;
  auVar314[9] = auVar283[9];
  auVar313._9_7_ = auVar314._9_7_;
  auVar313._0_8_ = auVar304._0_8_;
  auVar313[8] = auVar283[1];
  auVar140._1_8_ = auVar313._8_8_;
  auVar140[0] = auVar338[8];
  auVar140._9_7_ = 0;
  auVar139._10_6_ = 0;
  auVar139._0_10_ = SUB1610(auVar140 << 0x38,6);
  auVar138._11_5_ = 0;
  auVar138._0_11_ = SUB1611(auVar139 << 0x30,5);
  auVar137._12_4_ = 0;
  auVar137._0_12_ = SUB1612(auVar138 << 0x28,4);
  auVar136._13_3_ = 0;
  auVar136._0_13_ = SUB1613(auVar137 << 0x20,3);
  auVar312._14_2_ = 0;
  auVar312._0_14_ = SUB1614(auVar136 << 0x18,2);
  auVar312 = auVar312 << 0x10;
  auVar326._0_14_ = auVar312._0_14_;
  auVar326[0xe] = auVar338[8];
  auVar326[0xf] = auVar338[0xc];
  auVar325._14_2_ = auVar326._14_2_;
  auVar325._0_13_ = auVar312._0_13_;
  auVar325[0xd] = auVar338[4];
  auVar324._13_3_ = auVar325._13_3_;
  auVar324._0_12_ = auVar312._0_12_;
  auVar324[0xc] = auVar338[0];
  auVar323._12_4_ = auVar324._12_4_;
  auVar323._0_11_ = auVar312._0_11_;
  auVar323[0xb] = auVar333[0xc];
  auVar322._11_5_ = auVar323._11_5_;
  auVar322._0_10_ = auVar312._0_10_;
  auVar322[10] = auVar333[8];
  auVar321._10_6_ = auVar322._10_6_;
  auVar321._0_9_ = auVar312._0_9_;
  auVar321[9] = auVar333[4];
  auVar320._9_7_ = auVar321._9_7_;
  auVar320._0_8_ = auVar312._0_8_;
  auVar320[8] = auVar333[0];
  uVar329 = auVar320._8_8_;
  Y[0x10] = uVar237;
  Y[0x11] = auVar283[4];
  Y[0x12] = auVar283[8];
  Y[0x13] = auVar283[0xc];
  Y[0x14] = auVar332[0];
  Y[0x15] = auVar332[4];
  Y[0x16] = auVar332[8];
  Y[0x17] = auVar332[0xc];
  Y[0x18] = (char)uVar329;
  Y[0x19] = (char)((ulong)uVar329 >> 8);
  Y[0x1a] = (char)((ulong)uVar329 >> 0x10);
  Y[0x1b] = (char)((ulong)uVar329 >> 0x18);
  Y[0x1c] = (char)((ulong)uVar329 >> 0x20);
  Y[0x1d] = (char)((ulong)uVar329 >> 0x28);
  Y[0x1e] = (char)((ulong)uVar329 >> 0x30);
  Y[0x1f] = (char)((ulong)uVar329 >> 0x38);
  uVar238 = CONCAT13(0,CONCAT12(E[0x29],(ushort)E[0x28]));
  auVar13[0xd] = 0;
  auVar13._0_13_ = E._32_13_;
  auVar13[0xe] = E[0x27];
  auVar22[0xc] = E[0x26];
  auVar22._0_12_ = E._32_12_;
  auVar22._13_2_ = auVar13._13_2_;
  auVar28[0xb] = 0;
  auVar28._0_11_ = E._32_11_;
  auVar28._12_3_ = auVar22._12_3_;
  uVar30 = auVar28._11_4_;
  auVar51[10] = E[0x25];
  auVar51._0_10_ = E._32_10_;
  auVar51._11_4_ = uVar30;
  auVar65[9] = 0;
  auVar65._0_9_ = E._32_9_;
  auVar65._10_5_ = auVar51._10_5_;
  auVar71[8] = E[0x24];
  auVar71._0_8_ = E._32_8_;
  auVar71._9_6_ = auVar65._9_6_;
  auVar141._7_8_ = 0;
  auVar141._0_7_ = auVar71._8_7_;
  Var88 = CONCAT81(SUB158(auVar141 << 0x40,7),E[0x23]);
  auVar175._9_6_ = 0;
  auVar175._0_9_ = Var88;
  auVar142._1_10_ = SUB1510(auVar175 << 0x30,5);
  auVar142[0] = E[0x22];
  auVar176._11_4_ = 0;
  auVar176._0_11_ = auVar142;
  auVar77[2] = E[0x21];
  auVar77._0_2_ = E._32_2_;
  auVar77._3_12_ = SUB1512(auVar176 << 0x20,3);
  auVar83._2_13_ = auVar77._2_13_;
  auVar83._0_2_ = E._32_2_ & 0xff;
  uVar339 = (undefined1)((ulong)uVar5 >> 8);
  uVar336 = CONCAT13(0,CONCAT12(uVar339,(ushort)(byte)uVar5));
  bVar340 = (byte)((ulong)uVar5 >> 0x20);
  auVar14[0xd] = 0;
  auVar14._0_13_ = auVar85._0_13_;
  auVar14[0xe] = (char)((ulong)uVar1 >> 0x38);
  auVar23[0xc] = (char)((ulong)uVar1 >> 0x30);
  auVar23._0_12_ = auVar85._0_12_;
  auVar23._13_2_ = auVar14._13_2_;
  auVar29[0xb] = 0;
  auVar29._0_11_ = auVar85._0_11_;
  auVar29._12_3_ = auVar23._12_3_;
  uVar32 = auVar29._11_4_;
  auVar52[10] = (char)((ulong)uVar1 >> 0x28);
  auVar52._0_10_ = auVar85._0_10_;
  auVar52._11_4_ = uVar32;
  auVar66[9] = 0;
  auVar66._0_9_ = auVar85._0_9_;
  auVar66._10_5_ = auVar52._10_5_;
  auVar72[8] = (char)((ulong)uVar1 >> 0x20);
  auVar72._0_8_ = uVar1;
  auVar72._9_6_ = auVar66._9_6_;
  auVar143._7_8_ = 0;
  auVar143._0_7_ = auVar72._8_7_;
  Var117 = CONCAT81(SUB158(auVar143 << 0x40,7),(char)((ulong)uVar1 >> 0x18));
  auVar177._9_6_ = 0;
  auVar177._0_9_ = Var117;
  auVar144._1_10_ = SUB1510(auVar177 << 0x30,5);
  auVar144[0] = (char)((ulong)uVar1 >> 0x10);
  auVar178._11_4_ = 0;
  auVar178._0_11_ = auVar144;
  auVar78[2] = (char)((ulong)uVar1 >> 8);
  auVar78._0_2_ = (ushort)uVar1;
  auVar78._3_12_ = SUB1512(auVar178 << 0x20,3);
  auVar84._2_13_ = auVar78._2_13_;
  auVar84._0_2_ = (ushort)uVar1 & 0xff;
  auVar15._10_2_ = 0;
  auVar15._0_10_ = auVar83._0_10_;
  auVar15._12_2_ = (short)Var88;
  uVar179 = CONCAT42(auVar15._10_4_,auVar142._0_2_);
  auVar145._6_8_ = 0;
  auVar145._0_6_ = uVar179;
  auVar53._4_2_ = auVar77._2_2_;
  auVar53._0_4_ = auVar83._0_4_;
  auVar53._6_8_ = SUB148(auVar145 << 0x40,6);
  auVar16._10_2_ = 0;
  auVar16._0_10_ = auVar84._0_10_;
  auVar16._12_2_ = (short)Var117;
  uVar180 = CONCAT42(auVar16._10_4_,auVar144._0_2_);
  auVar146._6_8_ = 0;
  auVar146._0_6_ = uVar180;
  auVar54._4_2_ = auVar78._2_2_;
  auVar54._0_4_ = auVar84._0_4_;
  auVar54._6_8_ = SUB148(auVar146 << 0x40,6);
  auVar334._0_4_ = -(uint)((uint)auVar71._8_2_ + (uint)auVar72._8_2_ == iVar181);
  auVar334._4_4_ = -(uint)((uint)auVar51._10_2_ + (uint)auVar52._10_2_ == iVar219);
  auVar334._8_4_ = -(uint)((uVar30 >> 8 & 0xffff) + (uVar32 >> 8 & 0xffff) == iVar220);
  auVar334._12_4_ = -(uint)((uVar30 >> 0x18) + (uVar32 >> 0x18) == iVar222);
  auVar223._0_4_ = -(uint)((auVar84._0_4_ & 0xffff) + (auVar83._0_4_ & 0xffff) == iVar181);
  auVar223._4_4_ = -(uint)(auVar54._4_4_ + auVar53._4_4_ == iVar219);
  auVar223._8_4_ = -(uint)((int)uVar180 + (int)uVar179 == iVar220);
  auVar223._12_4_ = -(uint)((auVar16._10_4_ >> 0x10) + (auVar15._10_4_ >> 0x10) == iVar222);
  auVar334 = auVar334 & _DAT_004e8840;
  auVar223 = auVar223 & _DAT_004e8840;
  auVar55[0xc] = E[0x2b];
  auVar55._0_12_ = ZEXT112(E[0x2c]) << 0x40;
  auVar56._10_3_ = auVar55._10_3_;
  auVar56._0_10_ = (unkuint10)E[0x2a] << 0x40;
  auVar147._5_8_ = 0;
  auVar147._0_5_ = auVar56._8_5_;
  auVar57[4] = E[0x29];
  auVar57._0_4_ = uVar238;
  auVar57[5] = 0;
  auVar57._6_7_ = SUB137(auVar147 << 0x40,6);
  auVar227._0_12_ = auVar223._0_12_;
  auVar227._12_2_ = auVar223._6_2_;
  auVar227._14_2_ = auVar334._6_2_;
  auVar226._12_4_ = auVar227._12_4_;
  auVar226._0_10_ = auVar223._0_10_;
  auVar226._10_2_ = auVar334._4_2_;
  auVar225._10_6_ = auVar226._10_6_;
  auVar225._0_8_ = auVar223._0_8_;
  auVar225._8_2_ = auVar223._4_2_;
  auVar148._2_8_ = auVar225._8_8_;
  auVar148._0_2_ = auVar334._2_2_;
  auVar148._10_6_ = 0;
  auVar224._12_4_ = 0;
  auVar224._0_12_ = SUB1612(auVar148 << 0x30,4);
  auVar224 = auVar224 << 0x20;
  auVar231._0_12_ = auVar224._0_12_;
  auVar231._12_2_ = auVar334._2_2_;
  auVar231._14_2_ = auVar334._10_2_;
  auVar230._12_4_ = auVar231._12_4_;
  auVar230._0_10_ = auVar224._0_10_;
  auVar230._10_2_ = auVar223._10_2_;
  auVar229._10_6_ = auVar230._10_6_;
  auVar229._0_8_ = auVar224._0_8_;
  auVar229._8_2_ = auVar223._2_2_;
  auVar149._2_8_ = auVar229._8_8_;
  auVar149._0_2_ = auVar334._8_2_;
  auVar149._10_6_ = 0;
  auVar228._12_4_ = 0;
  auVar228._0_12_ = SUB1612(auVar149 << 0x30,4);
  auVar228 = auVar228 << 0x20;
  auVar58[0xc] = (char)((ulong)uVar5 >> 0x18);
  auVar58._0_12_ = ZEXT112(bVar340) << 0x40;
  auVar59._10_3_ = auVar58._10_3_;
  auVar59._0_10_ = (unkuint10)(byte)((ulong)uVar5 >> 0x10) << 0x40;
  auVar150._5_8_ = 0;
  auVar150._0_5_ = auVar59._8_5_;
  auVar60[4] = uVar339;
  auVar60._0_4_ = uVar336;
  auVar60[5] = 0;
  auVar60._6_7_ = SUB137(auVar150 << 0x40,6);
  auVar235._0_12_ = auVar228._0_12_;
  auVar235._12_2_ = auVar334._8_2_;
  auVar235._14_2_ = auVar334._12_2_;
  auVar234._12_4_ = auVar235._12_4_;
  auVar234._0_10_ = auVar228._0_10_;
  auVar234._10_2_ = auVar334._4_2_;
  auVar233._10_6_ = auVar234._10_6_;
  auVar233._0_8_ = auVar228._0_8_;
  auVar233._8_2_ = auVar334._0_2_;
  auVar151._2_8_ = auVar233._8_8_;
  auVar151._0_2_ = auVar223._12_2_;
  auVar151._10_6_ = 0;
  auVar232._12_4_ = 0;
  auVar232._0_12_ = SUB1612(auVar151 << 0x30,4);
  auVar232 = auVar232 << 0x20;
  auVar327._0_4_ = -(uint)((uint)E[0x2c] + (uint)bVar340 == iVar181);
  auVar327._4_4_ = -(uint)((uint)E[0x2d] + (uint)(byte)((ulong)uVar5 >> 0x28) == iVar219);
  auVar327._8_4_ = -(uint)((uint)E[0x2e] + (uint)(byte)((ulong)uVar5 >> 0x30) == iVar220);
  auVar327._12_4_ = -(uint)((uint)E[0x2f] + (uint)(byte)((ulong)uVar5 >> 0x38) == iVar222);
  auVar327 = auVar327 & _DAT_004e8840;
  auVar335._0_4_ = -(uint)((uVar336 & 0xffff) + (uVar238 & 0xffff) == iVar181);
  auVar335._4_4_ = -(uint)(auVar60._4_4_ + auVar57._4_4_ == iVar219);
  auVar335._8_4_ = -(uint)(auVar59._8_4_ + auVar56._8_4_ == iVar220);
  auVar335._12_4_ =
       -(uint)((uint)(uint3)(auVar58._10_3_ >> 0x10) + (uint)(uint3)(auVar55._10_3_ >> 0x10) ==
              iVar222);
  auVar335 = auVar335 & _DAT_004e8840;
  auVar195._0_14_ = auVar232._0_14_;
  auVar195[0xe] = auVar223[0xd];
  auVar195[0xf] = auVar335[0xd];
  auVar194._14_2_ = auVar195._14_2_;
  auVar194._0_13_ = auVar232._0_13_;
  auVar194[0xd] = auVar335[0xc];
  auVar193._13_3_ = auVar194._13_3_;
  auVar193._0_12_ = auVar232._0_12_;
  auVar193[0xc] = auVar223[0xc];
  auVar192._12_4_ = auVar193._12_4_;
  auVar192._0_11_ = auVar232._0_11_;
  auVar192[0xb] = auVar335[9];
  auVar191._11_5_ = auVar192._11_5_;
  auVar191._0_10_ = auVar232._0_10_;
  auVar191[10] = auVar223[9];
  auVar190._10_6_ = auVar191._10_6_;
  auVar190._0_9_ = auVar232._0_9_;
  auVar190[9] = auVar335[8];
  auVar189._9_7_ = auVar190._9_7_;
  auVar189._0_8_ = auVar232._0_8_;
  auVar189[8] = auVar223[8];
  auVar156._1_8_ = auVar189._8_8_;
  auVar156[0] = auVar335[5];
  auVar156._9_7_ = 0;
  auVar155._10_6_ = 0;
  auVar155._0_10_ = SUB1610(auVar156 << 0x38,6);
  auVar154._11_5_ = 0;
  auVar154._0_11_ = SUB1611(auVar155 << 0x30,5);
  auVar153._12_4_ = 0;
  auVar153._0_12_ = SUB1612(auVar154 << 0x28,4);
  auVar152._13_3_ = 0;
  auVar152._0_13_ = SUB1613(auVar153 << 0x20,3);
  uVar187 = auVar223[0];
  auVar188._14_2_ = 0;
  auVar188._0_14_ = SUB1614(auVar152 << 0x18,2);
  auVar188 = auVar188 << 0x10;
  auVar203._0_14_ = auVar188._0_14_;
  auVar203[0xe] = auVar335[5];
  auVar203[0xf] = auVar327[5];
  auVar202._14_2_ = auVar203._14_2_;
  auVar202._0_13_ = auVar188._0_13_;
  auVar202[0xd] = auVar334[5];
  auVar201._13_3_ = auVar202._13_3_;
  auVar201._0_12_ = auVar188._0_12_;
  auVar201[0xc] = auVar223[5];
  auVar200._12_4_ = auVar201._12_4_;
  auVar200._0_11_ = auVar188._0_11_;
  auVar200[0xb] = auVar327[4];
  auVar199._11_5_ = auVar200._11_5_;
  auVar199._0_10_ = auVar188._0_10_;
  auVar199[10] = auVar335[4];
  auVar198._10_6_ = auVar199._10_6_;
  auVar198._0_9_ = auVar188._0_9_;
  auVar198[9] = auVar334[4];
  auVar197._9_7_ = auVar198._9_7_;
  auVar197._0_8_ = auVar188._0_8_;
  auVar197[8] = auVar223[4];
  auVar161._1_8_ = auVar197._8_8_;
  auVar161[0] = auVar327[1];
  auVar161._9_7_ = 0;
  auVar160._10_6_ = 0;
  auVar160._0_10_ = SUB1610(auVar161 << 0x38,6);
  auVar159._11_5_ = 0;
  auVar159._0_11_ = SUB1611(auVar160 << 0x30,5);
  auVar158._12_4_ = 0;
  auVar158._0_12_ = SUB1612(auVar159 << 0x28,4);
  auVar157._13_3_ = 0;
  auVar157._0_13_ = SUB1613(auVar158 << 0x20,3);
  auVar196._14_2_ = 0;
  auVar196._0_14_ = SUB1614(auVar157 << 0x18,2);
  auVar196 = auVar196 << 0x10;
  auVar211._0_14_ = auVar196._0_14_;
  auVar211[0xe] = auVar327[1];
  auVar211[0xf] = auVar327[9];
  auVar210._14_2_ = auVar211._14_2_;
  auVar210._0_13_ = auVar196._0_13_;
  auVar210[0xd] = auVar335[9];
  auVar209._13_3_ = auVar210._13_3_;
  auVar209._0_12_ = auVar196._0_12_;
  auVar209[0xc] = auVar335[1];
  auVar208._12_4_ = auVar209._12_4_;
  auVar208._0_11_ = auVar196._0_11_;
  auVar208[0xb] = auVar334[9];
  auVar207._11_5_ = auVar208._11_5_;
  auVar207._0_10_ = auVar196._0_10_;
  auVar207[10] = auVar334[1];
  auVar206._10_6_ = auVar207._10_6_;
  auVar206._0_9_ = auVar196._0_9_;
  auVar206[9] = auVar223[9];
  auVar205._9_7_ = auVar206._9_7_;
  auVar205._0_8_ = auVar196._0_8_;
  auVar205[8] = auVar223[1];
  auVar166._1_8_ = auVar205._8_8_;
  auVar166[0] = auVar327[8];
  auVar166._9_7_ = 0;
  auVar165._10_6_ = 0;
  auVar165._0_10_ = SUB1610(auVar166 << 0x38,6);
  auVar164._11_5_ = 0;
  auVar164._0_11_ = SUB1611(auVar165 << 0x30,5);
  auVar163._12_4_ = 0;
  auVar163._0_12_ = SUB1612(auVar164 << 0x28,4);
  auVar162._13_3_ = 0;
  auVar162._0_13_ = SUB1613(auVar163 << 0x20,3);
  auVar204._14_2_ = 0;
  auVar204._0_14_ = SUB1614(auVar162 << 0x18,2);
  auVar204 = auVar204 << 0x10;
  auVar218._0_14_ = auVar204._0_14_;
  auVar218[0xe] = auVar327[8];
  auVar218[0xf] = auVar327[0xc];
  auVar217._14_2_ = auVar218._14_2_;
  auVar217._0_13_ = auVar204._0_13_;
  auVar217[0xd] = auVar327[4];
  auVar216._13_3_ = auVar217._13_3_;
  auVar216._0_12_ = auVar204._0_12_;
  auVar216[0xc] = auVar327[0];
  auVar215._12_4_ = auVar216._12_4_;
  auVar215._0_11_ = auVar204._0_11_;
  auVar215[0xb] = auVar335[0xc];
  auVar214._11_5_ = auVar215._11_5_;
  auVar214._0_10_ = auVar204._0_10_;
  auVar214[10] = auVar335[8];
  auVar213._10_6_ = auVar214._10_6_;
  auVar213._0_9_ = auVar204._0_9_;
  auVar213[9] = auVar335[4];
  auVar212._9_7_ = auVar213._9_7_;
  auVar212._0_8_ = auVar204._0_8_;
  auVar212[8] = auVar335[0];
  uVar221 = auVar212._8_8_;
  Y[0x20] = uVar187;
  Y[0x21] = auVar223[4];
  Y[0x22] = auVar223[8];
  Y[0x23] = auVar223[0xc];
  Y[0x24] = auVar334[0];
  Y[0x25] = auVar334[4];
  Y[0x26] = auVar334[8];
  Y[0x27] = auVar334[0xc];
  Y[0x28] = (char)uVar221;
  Y[0x29] = (char)((ulong)uVar221 >> 8);
  Y[0x2a] = (char)((ulong)uVar221 >> 0x10);
  Y[0x2b] = (char)((ulong)uVar221 >> 0x18);
  Y[0x2c] = (char)((ulong)uVar221 >> 0x20);
  Y[0x2d] = (char)((ulong)uVar221 >> 0x28);
  Y[0x2e] = (char)((ulong)uVar221 >> 0x30);
  Y[0x2f] = (char)((ulong)uVar221 >> 0x38);
  puVar183 = Y;
  puVar184 = X;
  do {
    lVar182 = (long)iVar186;
    iVar186 = iVar186 + 1;
    puVar185 = S[lVar182] +
               (int)((byte)(puVar183[4] + '\x01' +
                           (puVar183[3] +
                           (puVar183[2] +
                           (puVar183[1] + (puVar183[5] + *puVar183 * '\x02') * '\x02') * '\x02') *
                           '\x02') * '\x02') - 1);
    iVar181 = odd((uint)(*puVar185 >> 3));
    *puVar184 = (uchar)iVar181;
    iVar181 = odd((uint)(*puVar185 >> 2));
    puVar184[1] = (uchar)iVar181;
    iVar181 = odd((uint)(*puVar185 >> 1));
    puVar184[2] = (uchar)iVar181;
    iVar181 = odd((uint)*puVar185);
    puVar184[3] = (uchar)iVar181;
    puVar183 = puVar183 + 6;
    puVar184 = puVar184 + 4;
  } while (iVar186 != 8);
  Transpose(X,Tab_Ptr,0x20);
  return 0;
}



// WARNING: Unknown calling convention

int Binary(uchar *VarDecR,uchar *ArrayBinR)

{
  uchar *puVar1;
  long lVar2;
  uchar S [9];
  
  lVar2 = 0;
  do {
    puVar1 = VarDecR + lVar2;
    lVar2 = lVar2 + 1;
    ByteBin(*puVar1,S);
    *ArrayBinR = S[0] + 0xd0;
    ArrayBinR[1] = S[1] + 0xd0;
    ArrayBinR[2] = S[2] + 0xd0;
    ArrayBinR[3] = S[3] + 0xd0;
    ArrayBinR[4] = S[4] + 0xd0;
    ArrayBinR[5] = S[5] + 0xd0;
    ArrayBinR[6] = S[6] + 0xd0;
    ArrayBinR[7] = S[7] + 0xd0;
    ArrayBinR = ArrayBinR + 8;
  } while (lVar2 != 8);
  return 0;
}



// WARNING: Unknown calling convention

int Binary_1(uchar *ArrayBinR,uchar *VarDecR)

{
  uchar uVar1;
  long lVar2;
  uchar S [9];
  
  lVar2 = 0;
  do {
    S[8] = '\0';
    S[0] = *ArrayBinR + '0';
    S[1] = ArrayBinR[1] + '0';
    S[2] = ArrayBinR[2] + '0';
    S[3] = ArrayBinR[3] + '0';
    S[4] = ArrayBinR[4] + '0';
    S[5] = ArrayBinR[5] + '0';
    S[6] = ArrayBinR[6] + '0';
    S[7] = ArrayBinR[7] + '0';
    uVar1 = BinByte(S);
    VarDecR[lVar2] = uVar1;
    lVar2 = lVar2 + 1;
    ArrayBinR = ArrayBinR + 8;
  } while (lVar2 != 8);
  return 0;
}



// WARNING: Unknown calling convention

int HexaDecimal(uchar *VarDecR,uchar *VarHexR)

{
  uchar auStack_108 [224];
  uchar Arr [17];
  
  builtin_memcpy(Arr,"0123456789ABCDEF",0x11);
  *VarHexR = Arr[*VarDecR >> 4];
  VarHexR[1] = Arr[(int)((uint)*VarDecR + (uint)(*VarDecR >> 4) * -0x10)];
  VarHexR[2] = Arr[VarDecR[1] >> 4];
  VarHexR[3] = Arr[(int)((uint)VarDecR[1] + (uint)(VarDecR[1] >> 4) * -0x10)];
  VarHexR[4] = Arr[VarDecR[2] >> 4];
  VarHexR[5] = Arr[(int)((uint)VarDecR[2] + (uint)(VarDecR[2] >> 4) * -0x10)];
  VarHexR[6] = Arr[VarDecR[3] >> 4];
  VarHexR[7] = Arr[(int)((uint)VarDecR[3] + (uint)(VarDecR[3] >> 4) * -0x10)];
  VarHexR[8] = Arr[VarDecR[4] >> 4];
  VarHexR[9] = Arr[(int)((uint)VarDecR[4] + (uint)(VarDecR[4] >> 4) * -0x10)];
  VarHexR[10] = Arr[VarDecR[5] >> 4];
  VarHexR[0xb] = Arr[(int)((uint)VarDecR[5] + (uint)(VarDecR[5] >> 4) * -0x10)];
  VarHexR[0xc] = Arr[VarDecR[6] >> 4];
  VarHexR[0xd] = Arr[(int)((uint)VarDecR[6] + (uint)(VarDecR[6] >> 4) * -0x10)];
  VarHexR[0xe] = Arr[VarDecR[7] >> 4];
  VarHexR[0xf] = Arr[(int)((uint)VarDecR[7] + (uint)(VarDecR[7] >> 4) * -0x10)];
  return 0;
}



// WARNING: Unknown calling convention

int HexaDecimal_1(uchar *VarHexR,uchar *VarDecR)

{
  uchar uVar1;
  long lVar2;
  uchar TempStr [3];
  
  lVar2 = 0;
  do {
    TempStr[0] = VarHexR[lVar2 * 2];
    TempStr[2] = '\0';
    TempStr[1] = VarHexR[lVar2 * 2 + 1];
    uVar1 = HexaByte(TempStr);
    VarDecR[lVar2] = uVar1;
    lVar2 = lVar2 + 1;
  } while (lVar2 != 8);
  return 0;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address
// WARNING: Unknown calling convention

int DES_Bin(int Funct,uchar *PlainText,uchar *Key,uchar *CipherText)

{
  uint uVar1;
  undefined8 uVar2;
  undefined1 auVar3 [14];
  undefined1 auVar4 [14];
  undefined1 auVar5 [14];
  undefined1 auVar6 [14];
  undefined1 auVar7 [14];
  undefined1 auVar8 [14];
  undefined1 auVar9 [14];
  undefined1 auVar10 [14];
  undefined1 auVar11 [14];
  undefined1 auVar12 [14];
  undefined1 auVar13 [14];
  undefined1 auVar14 [14];
  undefined1 auVar15 [16];
  undefined1 auVar16 [16];
  undefined1 auVar17 [14];
  undefined1 auVar18 [12];
  unkuint10 Var19;
  undefined1 auVar20 [14];
  undefined1 auVar21 [12];
  unkuint10 Var22;
  undefined1 auVar23 [14];
  undefined1 auVar24 [14];
  undefined1 auVar25 [16];
  undefined1 auVar26 [16];
  undefined1 auVar27 [16];
  undefined1 auVar28 [14];
  undefined1 auVar29 [12];
  undefined1 auVar30 [16];
  undefined1 auVar31 [16];
  undefined1 auVar32 [16];
  undefined1 auVar33 [16];
  undefined1 auVar34 [16];
  undefined1 auVar35 [16];
  undefined1 auVar36 [16];
  undefined1 auVar37 [16];
  undefined1 auVar38 [16];
  undefined1 auVar39 [16];
  undefined1 auVar40 [16];
  undefined1 auVar41 [16];
  undefined1 auVar42 [16];
  undefined1 auVar43 [16];
  undefined1 auVar44 [16];
  undefined1 auVar45 [14];
  undefined1 auVar46 [12];
  undefined1 auVar47 [14];
  undefined1 auVar48 [14];
  undefined1 auVar49 [16];
  undefined1 auVar50 [16];
  undefined1 auVar51 [16];
  undefined1 auVar52 [16];
  undefined1 auVar53 [16];
  undefined1 auVar54 [16];
  undefined1 auVar55 [16];
  undefined1 auVar56 [16];
  undefined1 auVar57 [16];
  undefined1 auVar58 [16];
  undefined1 auVar59 [16];
  undefined1 auVar60 [16];
  undefined1 auVar61 [16];
  undefined1 auVar62 [16];
  undefined1 auVar63 [16];
  undefined1 auVar64 [16];
  undefined1 auVar65 [16];
  undefined1 auVar66 [16];
  undefined1 auVar67 [13];
  undefined1 auVar68 [11];
  undefined1 auVar69 [13];
  undefined1 auVar70 [11];
  undefined1 auVar71 [13];
  undefined1 auVar72 [13];
  undefined1 auVar73 [13];
  undefined1 auVar74 [13];
  undefined1 auVar75 [13];
  undefined1 auVar76 [11];
  undefined1 auVar77 [13];
  undefined1 auVar78 [11];
  undefined1 auVar79 [13];
  undefined1 auVar80 [13];
  undefined1 auVar81 [13];
  undefined1 auVar82 [13];
  undefined1 auVar83 [15];
  undefined1 auVar84 [15];
  undefined1 auVar85 [15];
  undefined1 auVar86 [15];
  undefined1 auVar87 [15];
  undefined1 auVar88 [15];
  undefined1 auVar89 [15];
  undefined1 auVar90 [15];
  uint3 uVar91;
  undefined1 auVar92 [15];
  uint3 uVar93;
  undefined1 auVar94 [15];
  undefined1 auVar95 [15];
  undefined1 auVar96 [15];
  undefined1 auVar97 [15];
  undefined1 auVar98 [15];
  undefined1 auVar99 [15];
  undefined1 auVar100 [15];
  undefined1 auVar101 [15];
  undefined1 auVar102 [15];
  undefined1 auVar103 [15];
  undefined1 auVar104 [15];
  undefined1 auVar105 [15];
  undefined1 auVar106 [15];
  undefined1 auVar107 [15];
  undefined1 auVar108 [15];
  uint6 uVar109;
  uint6 uVar110;
  undefined1 auVar111 [16];
  undefined8 uVar112;
  undefined8 uVar113;
  undefined8 uVar114;
  undefined8 uVar115;
  undefined8 uVar116;
  undefined8 uVar117;
  long lVar118;
  char cVar119;
  uchar *puVar120;
  uchar *puVar121;
  uint uVar122;
  undefined1 auVar123 [16];
  undefined1 auVar124 [16];
  undefined1 auVar132 [16];
  undefined1 auVar140 [16];
  undefined1 auVar148 [16];
  int iVar155;
  int iVar157;
  int iVar158;
  undefined1 auVar156 [16];
  int iVar159;
  undefined1 auVar160 [16];
  undefined1 auVar161 [16];
  undefined1 auVar165 [16];
  undefined1 auVar169 [16];
  undefined1 auVar173 [16];
  undefined1 auVar181 [16];
  undefined1 auVar189 [16];
  undefined1 auVar197 [16];
  undefined1 auVar204 [16];
  undefined1 auVar205 [16];
  undefined1 auVar206 [16];
  undefined1 auVar207 [16];
  undefined1 auVar208 [16];
  undefined1 auVar209 [16];
  undefined1 auVar213 [16];
  undefined1 auVar217 [16];
  byte bVar222;
  byte bVar223;
  byte bVar224;
  uchar uVar225;
  byte bVar226;
  byte bVar227;
  byte bVar228;
  byte bVar229;
  undefined1 auVar221 [16];
  undefined1 auVar230 [16];
  undefined1 auVar231 [16];
  undefined1 auVar232 [16];
  uchar Buff [33];
  uchar A [65];
  uchar X [65];
  undefined1 auVar125 [16];
  undefined1 auVar133 [16];
  undefined1 auVar141 [16];
  undefined1 auVar126 [16];
  undefined1 auVar134 [16];
  undefined1 auVar142 [16];
  undefined1 auVar149 [16];
  undefined1 auVar127 [16];
  undefined1 auVar135 [16];
  undefined1 auVar143 [16];
  undefined1 auVar150 [16];
  undefined1 auVar128 [16];
  undefined1 auVar136 [16];
  undefined1 auVar144 [16];
  undefined1 auVar151 [16];
  undefined1 auVar129 [16];
  undefined1 auVar137 [16];
  undefined1 auVar145 [16];
  undefined1 auVar152 [16];
  undefined1 auVar130 [16];
  undefined1 auVar138 [16];
  undefined1 auVar146 [16];
  undefined1 auVar153 [16];
  undefined1 auVar131 [16];
  undefined1 auVar139 [16];
  undefined1 auVar147 [16];
  undefined1 auVar154 [16];
  undefined1 auVar162 [16];
  undefined1 auVar166 [16];
  undefined1 auVar170 [16];
  undefined1 auVar174 [16];
  undefined1 auVar182 [16];
  undefined1 auVar190 [16];
  undefined1 auVar175 [16];
  undefined1 auVar183 [16];
  undefined1 auVar191 [16];
  undefined1 auVar198 [16];
  undefined1 auVar163 [16];
  undefined1 auVar167 [16];
  undefined1 auVar171 [16];
  undefined1 auVar176 [16];
  undefined1 auVar184 [16];
  undefined1 auVar192 [16];
  undefined1 auVar199 [16];
  undefined1 auVar177 [16];
  undefined1 auVar185 [16];
  undefined1 auVar193 [16];
  undefined1 auVar200 [16];
  undefined1 auVar164 [16];
  undefined1 auVar168 [16];
  undefined1 auVar172 [16];
  undefined1 auVar178 [16];
  undefined1 auVar186 [16];
  undefined1 auVar194 [16];
  undefined1 auVar201 [16];
  undefined1 auVar179 [16];
  undefined1 auVar187 [16];
  undefined1 auVar195 [16];
  undefined1 auVar202 [16];
  undefined1 auVar180 [16];
  undefined1 auVar188 [16];
  undefined1 auVar196 [16];
  undefined1 auVar203 [16];
  undefined1 auVar210 [16];
  undefined1 auVar214 [16];
  undefined1 auVar218 [16];
  undefined1 auVar211 [16];
  undefined1 auVar215 [16];
  undefined1 auVar219 [16];
  undefined1 auVar212 [16];
  undefined1 auVar216 [16];
  undefined1 auVar220 [16];
  
  cVar119 = '\x10';
  lVar118 = 0x40;
  puVar120 = Tab_S;
  puVar121 = S[0];
  for (; lVar118 != 0; lVar118 = lVar118 + -1) {
    *(undefined8 *)puVar121 = *(undefined8 *)puVar120;
    puVar120 = puVar120 + 8;
    puVar121 = puVar121 + 8;
  }
  Rots[8] = Tab_Rots[8];
  Rots[9] = Tab_Rots[9];
  Rots[10] = Tab_Rots[10];
  Rots[0xb] = Tab_Rots[0xb];
  Rots[0xc] = Tab_Rots[0xc];
  Rots[0xd] = Tab_Rots[0xd];
  Rots[0xe] = Tab_Rots[0xe];
  Rots[0xf] = Tab_Rots[0xf];
  Rots[0] = Tab_Rots[0];
  Rots[1] = Tab_Rots[1];
  Rots[2] = Tab_Rots[2];
  Rots[3] = Tab_Rots[3];
  Rots[4] = Tab_Rots[4];
  Rots[5] = Tab_Rots[5];
  Rots[6] = Tab_Rots[6];
  Rots[7] = Tab_Rots[7];
  A._0_8_ = *(undefined8 *)PlainText;
  A._8_8_ = *(undefined8 *)(PlainText + 8);
  A._16_8_ = *(undefined8 *)(PlainText + 0x10);
  A._24_8_ = *(undefined8 *)(PlainText + 0x18);
  A._32_8_ = *(undefined8 *)(PlainText + 0x20);
  A._40_8_ = *(undefined8 *)(PlainText + 0x28);
  A._48_8_ = *(undefined8 *)(PlainText + 0x30);
  A._56_8_ = *(undefined8 *)(PlainText + 0x38);
  Transpose(A,Tab_InitialTr,0x40);
  Transpose(Key,Tab_KeyTr1,0x38);
  Calcul_I_Key(Key);
  Split(Rn,Ln,A);
  auVar111 = _DAT_004e8840;
  uVar122 = 0xf;
  if (Funct != -1) {
    uVar122 = 0;
  }
  uVar115 = Ln._0_8_;
  uVar116 = Ln._8_8_;
  uVar117 = Ln._24_8_;
  do {
    Ln._24_8_ = uVar117;
    Ln._8_8_ = uVar116;
    Ln._0_8_ = uVar115;
    uVar116 = Rn._0_8_;
    uVar117 = Rn._8_8_;
    uVar112 = Rn._16_8_;
    uVar113 = Rn._24_8_;
    F(uVar122 & 0xff,Rn,X);
    uVar114 = Ln._16_8_;
    auVar15[8] = Ln[8];
    auVar15[9] = Ln[9];
    auVar15[10] = Ln[10];
    auVar15[0xb] = Ln[0xb];
    auVar15[0xc] = Ln[0xc];
    auVar15[0xd] = Ln[0xd];
    auVar15[0xe] = Ln[0xe];
    auVar15[0xf] = Ln[0xf];
    auVar15[0] = Ln[0];
    auVar15[1] = Ln[1];
    auVar15[2] = Ln[2];
    auVar15[3] = Ln[3];
    auVar15[4] = Ln[4];
    auVar15[5] = Ln[5];
    auVar15[6] = Ln[6];
    auVar15[7] = Ln[7];
    uVar1 = uVar122 + 1;
    Rn[0] = (uchar)uVar116;
    Rn[1] = SUB81(uVar116,1);
    Rn[2] = SUB81(uVar116,2);
    Rn[3] = SUB81(uVar116,3);
    Rn[4] = SUB81(uVar116,4);
    Rn[5] = SUB81(uVar116,5);
    Rn[6] = SUB81(uVar116,6);
    Rn[7] = SUB81(uVar116,7);
    uVar115._0_1_ = Rn[0];
    uVar115._1_1_ = Rn[1];
    uVar115._2_1_ = Rn[2];
    uVar115._3_1_ = Rn[3];
    uVar115._4_1_ = Rn[4];
    uVar115._5_1_ = Rn[5];
    uVar115._6_1_ = Rn[6];
    uVar115._7_1_ = Rn[7];
    bVar222 = (byte)Ln._8_8_;
    bVar223 = SUB81(Ln._8_8_,1);
    bVar224 = SUB81(Ln._8_8_,2);
    uVar225 = SUB81(Ln._8_8_,3);
    bVar226 = SUB81(Ln._8_8_,4);
    bVar227 = SUB81(Ln._8_8_,5);
    bVar228 = SUB81(Ln._8_8_,6);
    bVar229 = SUB81(Ln._8_8_,7);
    auVar83[0xd] = 0;
    auVar83._0_13_ = auVar15._0_13_;
    auVar83[0xe] = SUB81(Ln._0_8_,7);
    auVar87[0xc] = SUB81(Ln._0_8_,6);
    auVar87._0_12_ = auVar15._0_12_;
    auVar87._13_2_ = auVar83._13_2_;
    uVar91 = auVar87._12_3_;
    auVar92[0xb] = 0;
    auVar92._0_11_ = auVar15._0_11_;
    auVar92._12_3_ = uVar91;
    auVar97[10] = SUB81(Ln._0_8_,5);
    auVar97._0_10_ = auVar15._0_10_;
    auVar97._11_4_ = auVar92._11_4_;
    auVar101[9] = 0;
    auVar101._0_9_ = auVar15._0_9_;
    auVar101._10_5_ = auVar97._10_5_;
    auVar105[8] = SUB81(Ln._0_8_,4);
    auVar105[0] = Ln[0];
    auVar105[1] = Ln[1];
    auVar105[2] = Ln[2];
    auVar105[3] = Ln[3];
    auVar105[4] = Ln[4];
    auVar105[5] = Ln[5];
    auVar105[6] = Ln[6];
    auVar105[7] = Ln[7];
    auVar105._9_6_ = auVar101._9_6_;
    Var19 = CONCAT91((unkuint9)auVar105._8_7_ << 8,SUB81(Ln._0_8_,3));
    auVar68[10] = 0;
    auVar68._0_10_ = Var19;
    auVar18._1_11_ = auVar68 << 8;
    auVar18[0] = SUB81(Ln._0_8_,2);
    auVar67[0xc] = 0;
    auVar67._0_12_ = auVar18;
    auVar17._1_13_ = auVar67 << 8;
    auVar17[0] = SUB81(Ln._0_8_,1);
    auVar156[0] = (byte)Ln._0_8_;
    auVar156[1] = 0;
    auVar156._2_14_ = auVar17;
    Rn[0] = (uchar)uVar116;
    Rn[1] = SUB81(uVar116,1);
    Rn[2] = SUB81(uVar116,2);
    Rn[3] = SUB81(uVar116,3);
    Rn[4] = SUB81(uVar116,4);
    Rn[5] = SUB81(uVar116,5);
    Rn[6] = SUB81(uVar116,6);
    Rn[7] = SUB81(uVar116,7);
    Ln[0] = Rn[0];
    Ln[1] = Rn[1];
    Ln[2] = Rn[2];
    Ln[3] = Rn[3];
    Ln[4] = Rn[4];
    Ln[5] = Rn[5];
    Ln[6] = Rn[6];
    Ln[7] = Rn[7];
    Rn[8] = (uchar)uVar117;
    Rn[9] = SUB81(uVar117,1);
    Rn[10] = SUB81(uVar117,2);
    Rn[0xb] = SUB81(uVar117,3);
    Rn[0xc] = SUB81(uVar117,4);
    Rn[0xd] = SUB81(uVar117,5);
    Rn[0xe] = SUB81(uVar117,6);
    Rn[0xf] = SUB81(uVar117,7);
    uVar116._0_1_ = Rn[8];
    uVar116._1_1_ = Rn[9];
    uVar116._2_1_ = Rn[10];
    uVar116._3_1_ = Rn[0xb];
    uVar116._4_1_ = Rn[0xc];
    uVar116._5_1_ = Rn[0xd];
    uVar116._6_1_ = Rn[0xe];
    uVar116._7_1_ = Rn[0xf];
    auVar84[0xd] = 0;
    auVar84._0_13_ = X._0_13_;
    auVar84[0xe] = X[7];
    auVar88[0xc] = X[6];
    auVar88._0_12_ = X._0_12_;
    auVar88._13_2_ = auVar84._13_2_;
    uVar93 = auVar88._12_3_;
    auVar94[0xb] = 0;
    auVar94._0_11_ = X._0_11_;
    auVar94._12_3_ = uVar93;
    auVar98[10] = X[5];
    auVar98._0_10_ = X._0_10_;
    auVar98._11_4_ = auVar94._11_4_;
    auVar102[9] = 0;
    auVar102._0_9_ = X._0_9_;
    auVar102._10_5_ = auVar98._10_5_;
    auVar106[8] = X[4];
    auVar106._0_8_ = X._0_8_;
    auVar106._9_6_ = auVar102._9_6_;
    Var22 = CONCAT91((unkuint9)auVar106._8_7_ << 8,X[3]);
    auVar70[10] = 0;
    auVar70._0_10_ = Var22;
    auVar21._1_11_ = auVar70 << 8;
    auVar21[0] = X[2];
    auVar69[0xc] = 0;
    auVar69._0_12_ = auVar21;
    auVar20._1_13_ = auVar69 << 8;
    auVar20[0] = X[1];
    auVar230[0] = X[0];
    auVar230[1] = 0;
    auVar230._2_14_ = auVar20;
    auVar3._10_2_ = 0;
    auVar3._0_10_ = auVar156._0_10_;
    auVar3._12_2_ = (short)Var19;
    uVar109 = CONCAT42(auVar3._10_4_,auVar18._0_2_);
    auVar23._6_8_ = 0;
    auVar23._0_6_ = uVar109;
    auVar7._4_2_ = auVar17._0_2_;
    auVar7._0_4_ = auVar156._0_4_;
    auVar7._6_8_ = SUB148(auVar23 << 0x40,6);
    Rn[8] = (uchar)uVar117;
    Rn[9] = SUB81(uVar117,1);
    Rn[10] = SUB81(uVar117,2);
    Rn[0xb] = SUB81(uVar117,3);
    Rn[0xc] = SUB81(uVar117,4);
    Rn[0xd] = SUB81(uVar117,5);
    Rn[0xe] = SUB81(uVar117,6);
    Rn[0xf] = SUB81(uVar117,7);
    Ln[8] = Rn[8];
    Ln[9] = Rn[9];
    Ln[10] = Rn[10];
    Ln[0xb] = Rn[0xb];
    Ln[0xc] = Rn[0xc];
    Ln[0xd] = Rn[0xd];
    Ln[0xe] = Rn[0xe];
    Ln[0xf] = Rn[0xf];
    Rn[0x10] = (uchar)uVar112;
    Rn[0x11] = SUB81(uVar112,1);
    Rn[0x12] = SUB81(uVar112,2);
    Rn[0x13] = SUB81(uVar112,3);
    Rn[0x14] = SUB81(uVar112,4);
    Rn[0x15] = SUB81(uVar112,5);
    Rn[0x16] = SUB81(uVar112,6);
    Rn[0x17] = SUB81(uVar112,7);
    uVar2._0_1_ = Rn[0x10];
    uVar2._1_1_ = Rn[0x11];
    uVar2._2_1_ = Rn[0x12];
    uVar2._3_1_ = Rn[0x13];
    uVar2._4_1_ = Rn[0x14];
    uVar2._5_1_ = Rn[0x15];
    uVar2._6_1_ = Rn[0x16];
    uVar2._7_1_ = Rn[0x17];
    auVar4._10_2_ = 0;
    auVar4._0_10_ = auVar230._0_10_;
    auVar4._12_2_ = (short)Var22;
    uVar110 = CONCAT42(auVar4._10_4_,auVar21._0_2_);
    auVar24._6_8_ = 0;
    auVar24._0_6_ = uVar110;
    auVar8._4_2_ = auVar20._0_2_;
    auVar8._0_4_ = auVar230._0_4_;
    auVar8._6_8_ = SUB148(auVar24 << 0x40,6);
    iVar155 = auVar111._0_4_;
    auVar206._0_4_ = -(uint)((uint)auVar105._8_2_ + (uint)auVar106._8_2_ == iVar155);
    iVar157 = auVar111._4_4_;
    auVar206._4_4_ = -(uint)((uint)auVar97._10_2_ + (uint)auVar98._10_2_ == iVar157);
    iVar158 = auVar111._8_4_;
    auVar206._8_4_ = -(uint)((uVar91 & 0xffff) + (uVar93 & 0xffff) == iVar158);
    iVar159 = auVar111._12_4_;
    auVar206._12_4_ = -(uint)((uint)(uVar91 >> 0x10) + (uint)(uVar93 >> 0x10) == iVar159);
    auVar160._0_4_ = -(uint)((auVar230._0_4_ & 0xffff) + (auVar156._0_4_ & 0xffff) == iVar155);
    auVar160._4_4_ = -(uint)(auVar8._4_4_ + auVar7._4_4_ == iVar157);
    auVar160._8_4_ = -(uint)((int)uVar110 + (int)uVar109 == iVar158);
    auVar160._12_4_ = -(uint)((auVar4._10_4_ >> 0x10) + (auVar3._10_4_ >> 0x10) == iVar159);
    auVar206 = auVar206 & auVar111;
    auVar160 = auVar160 & auVar111;
    auVar164._0_12_ = auVar160._0_12_;
    auVar164._12_2_ = auVar160._6_2_;
    auVar164._14_2_ = auVar206._6_2_;
    auVar163._12_4_ = auVar164._12_4_;
    auVar163._0_10_ = auVar160._0_10_;
    auVar163._10_2_ = auVar206._4_2_;
    auVar162._10_6_ = auVar163._10_6_;
    auVar162._0_8_ = auVar160._0_8_;
    auVar162._8_2_ = auVar160._4_2_;
    auVar25._2_8_ = auVar162._8_8_;
    auVar25._0_2_ = auVar206._2_2_;
    auVar25._10_6_ = 0;
    auVar161._12_4_ = 0;
    auVar161._0_12_ = SUB1612(auVar25 << 0x30,4);
    auVar161 = auVar161 << 0x20;
    auVar168._0_12_ = auVar161._0_12_;
    auVar168._12_2_ = auVar206._2_2_;
    auVar168._14_2_ = auVar206._10_2_;
    auVar167._12_4_ = auVar168._12_4_;
    auVar167._0_10_ = auVar161._0_10_;
    auVar167._10_2_ = auVar160._10_2_;
    auVar166._10_6_ = auVar167._10_6_;
    auVar166._0_8_ = auVar161._0_8_;
    auVar166._8_2_ = auVar160._2_2_;
    auVar26._2_8_ = auVar166._8_8_;
    auVar26._0_2_ = auVar206._8_2_;
    auVar26._10_6_ = 0;
    auVar165._12_4_ = 0;
    auVar165._0_12_ = SUB1612(auVar26 << 0x30,4);
    auVar165 = auVar165 << 0x20;
    auVar71[0xc] = uVar225;
    auVar71._0_12_ = ZEXT112(bVar226) << 0x40;
    auVar72._10_3_ = auVar71._10_3_;
    auVar72._0_10_ = (unkuint10)bVar224 << 0x40;
    auVar9._6_8_ = SUB148(ZEXT514(auVar72._8_5_) << 0x40,6);
    auVar9._0_6_ = (uint6)bVar223 << 0x20;
    auVar172._0_12_ = auVar165._0_12_;
    auVar172._12_2_ = auVar206._8_2_;
    auVar172._14_2_ = auVar206._12_2_;
    auVar171._12_4_ = auVar172._12_4_;
    auVar171._0_10_ = auVar165._0_10_;
    auVar171._10_2_ = auVar206._4_2_;
    auVar170._10_6_ = auVar171._10_6_;
    auVar170._0_8_ = auVar165._0_8_;
    auVar170._8_2_ = auVar206._0_2_;
    auVar27._2_8_ = auVar170._8_8_;
    auVar27._0_2_ = auVar160._12_2_;
    auVar27._10_6_ = 0;
    auVar169._12_4_ = 0;
    auVar169._0_12_ = SUB1612(auVar27 << 0x30,4);
    auVar169 = auVar169 << 0x20;
    auVar73[0xc] = X[0xb];
    auVar73._0_12_ = ZEXT112(X[0xc]) << 0x40;
    auVar74._10_3_ = auVar73._10_3_;
    auVar74._0_10_ = (unkuint10)X[10] << 0x40;
    auVar10._6_8_ = SUB148(ZEXT514(auVar74._8_5_) << 0x40,6);
    auVar10._0_6_ = (uint6)X[9] << 0x20;
    auVar221._0_4_ = -(uint)((uint)bVar226 + (uint)X[0xc] == iVar155);
    auVar221._4_4_ = -(uint)((uint)bVar227 + (uint)X[0xd] == iVar157);
    auVar221._8_4_ = -(uint)((uint)bVar228 + (uint)X[0xe] == iVar158);
    auVar221._12_4_ = -(uint)((uint)bVar229 + (uint)X[0xf] == iVar159);
    auVar207._0_4_ =
         -(uint)((CONCAT12(X[9],(ushort)X[8]) & 0xffff) +
                 (CONCAT12(bVar223,(ushort)bVar222) & 0xffff) == iVar155);
    auVar207._4_4_ = -(uint)(auVar10._4_4_ + auVar9._4_4_ == iVar157);
    auVar207._8_4_ = -(uint)(auVar74._8_4_ + auVar72._8_4_ == iVar158);
    auVar207._12_4_ =
         -(uint)((uint)(uint3)(auVar73._10_3_ >> 0x10) + (uint)(uint3)(auVar71._10_3_ >> 0x10) ==
                iVar159);
    auVar221 = auVar221 & auVar111;
    auVar207 = auVar207 & auVar111;
    auVar16[8] = Ln[0x18];
    auVar16[9] = Ln[0x19];
    auVar16[10] = Ln[0x1a];
    auVar16[0xb] = Ln[0x1b];
    auVar16[0xc] = Ln[0x1c];
    auVar16[0xd] = Ln[0x1d];
    auVar16[0xe] = Ln[0x1e];
    auVar16[0xf] = Ln[0x1f];
    auVar16[0] = Ln[0x10];
    auVar16[1] = Ln[0x11];
    auVar16[2] = Ln[0x12];
    auVar16[3] = Ln[0x13];
    auVar16[4] = Ln[0x14];
    auVar16[5] = Ln[0x15];
    auVar16[6] = Ln[0x16];
    auVar16[7] = Ln[0x17];
    Rn[0x10] = (uchar)uVar112;
    Rn[0x11] = SUB81(uVar112,1);
    Rn[0x12] = SUB81(uVar112,2);
    Rn[0x13] = SUB81(uVar112,3);
    Rn[0x14] = SUB81(uVar112,4);
    Rn[0x15] = SUB81(uVar112,5);
    Rn[0x16] = SUB81(uVar112,6);
    Rn[0x17] = SUB81(uVar112,7);
    Ln[0x10] = Rn[0x10];
    Ln[0x11] = Rn[0x11];
    Ln[0x12] = Rn[0x12];
    Ln[0x13] = Rn[0x13];
    Ln[0x14] = Rn[0x14];
    Ln[0x15] = Rn[0x15];
    Ln[0x16] = Rn[0x16];
    Ln[0x17] = Rn[0x17];
    uVar112 = Ln._16_8_;
    Rn[0x18] = (uchar)uVar113;
    Rn[0x19] = SUB81(uVar113,1);
    Rn[0x1a] = SUB81(uVar113,2);
    Rn[0x1b] = SUB81(uVar113,3);
    Rn[0x1c] = SUB81(uVar113,4);
    Rn[0x1d] = SUB81(uVar113,5);
    Rn[0x1e] = SUB81(uVar113,6);
    Rn[0x1f] = SUB81(uVar113,7);
    uVar117._0_1_ = Rn[0x18];
    uVar117._1_1_ = Rn[0x19];
    uVar117._2_1_ = Rn[0x1a];
    uVar117._3_1_ = Rn[0x1b];
    uVar117._4_1_ = Rn[0x1c];
    uVar117._5_1_ = Rn[0x1d];
    uVar117._6_1_ = Rn[0x1e];
    uVar117._7_1_ = Rn[0x1f];
    bVar222 = (byte)Ln._24_8_;
    bVar223 = SUB81(Ln._24_8_,1);
    bVar224 = SUB81(Ln._24_8_,2);
    uVar225 = SUB81(Ln._24_8_,3);
    bVar226 = SUB81(Ln._24_8_,4);
    bVar227 = SUB81(Ln._24_8_,5);
    bVar228 = SUB81(Ln._24_8_,6);
    bVar229 = SUB81(Ln._24_8_,7);
    auVar85[0xd] = 0;
    auVar85._0_13_ = auVar16._0_13_;
    auVar85[0xe] = SUB81(uVar114,7);
    auVar89[0xc] = SUB81(uVar114,6);
    auVar89._0_12_ = auVar16._0_12_;
    auVar89._13_2_ = auVar85._13_2_;
    uVar91 = auVar89._12_3_;
    auVar95[0xb] = 0;
    auVar95._0_11_ = auVar16._0_11_;
    auVar95._12_3_ = uVar91;
    auVar99[10] = SUB81(uVar114,5);
    auVar99._0_10_ = auVar16._0_10_;
    auVar99._11_4_ = auVar95._11_4_;
    auVar103[9] = 0;
    auVar103._0_9_ = auVar16._0_9_;
    auVar103._10_5_ = auVar99._10_5_;
    auVar107[8] = SUB81(uVar114,4);
    Ln[0x10] = (uchar)uVar114;
    Ln[0x11] = SUB81(uVar114,1);
    Ln[0x12] = SUB81(uVar114,2);
    Ln[0x13] = SUB81(uVar114,3);
    Ln[0x14] = SUB81(uVar114,4);
    Ln[0x15] = SUB81(uVar114,5);
    Ln[0x16] = SUB81(uVar114,6);
    Ln[0x17] = SUB81(uVar114,7);
    auVar107[0] = Ln[0x10];
    auVar107[1] = Ln[0x11];
    auVar107[2] = Ln[0x12];
    auVar107[3] = Ln[0x13];
    auVar107[4] = Ln[0x14];
    auVar107[5] = Ln[0x15];
    auVar107[6] = Ln[0x16];
    auVar107[7] = Ln[0x17];
    auVar107._9_6_ = auVar103._9_6_;
    Var19 = CONCAT91((unkuint9)auVar107._8_7_ << 8,SUB81(uVar114,3));
    auVar76[10] = 0;
    auVar76._0_10_ = Var19;
    auVar29._1_11_ = auVar76 << 8;
    auVar29[0] = SUB81(uVar114,2);
    auVar75[0xc] = 0;
    auVar75._0_12_ = auVar29;
    auVar28._1_13_ = auVar75 << 8;
    auVar28[0] = SUB81(uVar114,1);
    auVar231[0] = (byte)uVar114;
    auVar231[1] = 0;
    auVar231._2_14_ = auVar28;
    Rn[0x18] = (uchar)uVar113;
    Rn[0x19] = SUB81(uVar113,1);
    Rn[0x1a] = SUB81(uVar113,2);
    Rn[0x1b] = SUB81(uVar113,3);
    Rn[0x1c] = SUB81(uVar113,4);
    Rn[0x1d] = SUB81(uVar113,5);
    Rn[0x1e] = SUB81(uVar113,6);
    Rn[0x1f] = SUB81(uVar113,7);
    Ln[0x18] = Rn[0x18];
    Ln[0x19] = Rn[0x19];
    Ln[0x1a] = Rn[0x1a];
    Ln[0x1b] = Rn[0x1b];
    Ln[0x1c] = Rn[0x1c];
    Ln[0x1d] = Rn[0x1d];
    Ln[0x1e] = Rn[0x1e];
    Ln[0x1f] = Rn[0x1f];
    auVar180._0_14_ = auVar169._0_14_;
    auVar180[0xe] = auVar160[0xd];
    auVar180[0xf] = auVar207[0xd];
    auVar179._14_2_ = auVar180._14_2_;
    auVar179._0_13_ = auVar169._0_13_;
    auVar179[0xd] = auVar207[0xc];
    auVar178._13_3_ = auVar179._13_3_;
    auVar178._0_12_ = auVar169._0_12_;
    auVar178[0xc] = auVar160[0xc];
    auVar177._12_4_ = auVar178._12_4_;
    auVar177._0_11_ = auVar169._0_11_;
    auVar177[0xb] = auVar207[9];
    auVar176._11_5_ = auVar177._11_5_;
    auVar176._0_10_ = auVar169._0_10_;
    auVar176[10] = auVar160[9];
    auVar175._10_6_ = auVar176._10_6_;
    auVar175._0_9_ = auVar169._0_9_;
    auVar175[9] = auVar207[8];
    auVar174._9_7_ = auVar175._9_7_;
    auVar174._0_8_ = auVar169._0_8_;
    auVar174[8] = auVar160[8];
    auVar34._1_8_ = auVar174._8_8_;
    auVar34[0] = auVar207[5];
    auVar34._9_7_ = 0;
    auVar33._10_6_ = 0;
    auVar33._0_10_ = SUB1610(auVar34 << 0x38,6);
    auVar32._11_5_ = 0;
    auVar32._0_11_ = SUB1611(auVar33 << 0x30,5);
    auVar31._12_4_ = 0;
    auVar31._0_12_ = SUB1612(auVar32 << 0x28,4);
    auVar30._13_3_ = 0;
    auVar30._0_13_ = SUB1613(auVar31 << 0x20,3);
    Rn[0] = auVar160[0];
    auVar173._14_2_ = 0;
    auVar173._0_14_ = SUB1614(auVar30 << 0x18,2);
    auVar173 = auVar173 << 0x10;
    uVar122 = uVar122 - 1;
    if (Funct != -1) {
      uVar122 = uVar1;
    }
    cVar119 = cVar119 + -1;
    auVar188._0_14_ = auVar173._0_14_;
    auVar188[0xe] = auVar207[5];
    auVar188[0xf] = auVar221[5];
    auVar187._14_2_ = auVar188._14_2_;
    auVar187._0_13_ = auVar173._0_13_;
    auVar187[0xd] = auVar206[5];
    auVar186._13_3_ = auVar187._13_3_;
    auVar186._0_12_ = auVar173._0_12_;
    auVar186[0xc] = auVar160[5];
    auVar185._12_4_ = auVar186._12_4_;
    auVar185._0_11_ = auVar173._0_11_;
    auVar185[0xb] = auVar221[4];
    auVar184._11_5_ = auVar185._11_5_;
    auVar184._0_10_ = auVar173._0_10_;
    auVar184[10] = auVar207[4];
    auVar183._10_6_ = auVar184._10_6_;
    auVar183._0_9_ = auVar173._0_9_;
    auVar183[9] = auVar206[4];
    auVar182._9_7_ = auVar183._9_7_;
    auVar182._0_8_ = auVar173._0_8_;
    auVar182[8] = auVar160[4];
    auVar39._1_8_ = auVar182._8_8_;
    auVar39[0] = auVar221[1];
    auVar39._9_7_ = 0;
    auVar38._10_6_ = 0;
    auVar38._0_10_ = SUB1610(auVar39 << 0x38,6);
    auVar37._11_5_ = 0;
    auVar37._0_11_ = SUB1611(auVar38 << 0x30,5);
    auVar36._12_4_ = 0;
    auVar36._0_12_ = SUB1612(auVar37 << 0x28,4);
    auVar35._13_3_ = 0;
    auVar35._0_13_ = SUB1613(auVar36 << 0x20,3);
    auVar181._14_2_ = 0;
    auVar181._0_14_ = SUB1614(auVar35 << 0x18,2);
    auVar181 = auVar181 << 0x10;
    auVar196._0_14_ = auVar181._0_14_;
    auVar196[0xe] = auVar221[1];
    auVar196[0xf] = auVar221[9];
    auVar195._14_2_ = auVar196._14_2_;
    auVar195._0_13_ = auVar181._0_13_;
    auVar195[0xd] = auVar207[9];
    auVar194._13_3_ = auVar195._13_3_;
    auVar194._0_12_ = auVar181._0_12_;
    auVar194[0xc] = auVar207[1];
    auVar193._12_4_ = auVar194._12_4_;
    auVar193._0_11_ = auVar181._0_11_;
    auVar193[0xb] = auVar206[9];
    auVar192._11_5_ = auVar193._11_5_;
    auVar192._0_10_ = auVar181._0_10_;
    auVar192[10] = auVar206[1];
    auVar191._10_6_ = auVar192._10_6_;
    auVar191._0_9_ = auVar181._0_9_;
    auVar191[9] = auVar160[9];
    auVar190._9_7_ = auVar191._9_7_;
    auVar190._0_8_ = auVar181._0_8_;
    auVar190[8] = auVar160[1];
    auVar44._1_8_ = auVar190._8_8_;
    auVar44[0] = auVar221[8];
    auVar44._9_7_ = 0;
    auVar43._10_6_ = 0;
    auVar43._0_10_ = SUB1610(auVar44 << 0x38,6);
    auVar42._11_5_ = 0;
    auVar42._0_11_ = SUB1611(auVar43 << 0x30,5);
    auVar41._12_4_ = 0;
    auVar41._0_12_ = SUB1612(auVar42 << 0x28,4);
    auVar40._13_3_ = 0;
    auVar40._0_13_ = SUB1613(auVar41 << 0x20,3);
    auVar189._14_2_ = 0;
    auVar189._0_14_ = SUB1614(auVar40 << 0x18,2);
    auVar189 = auVar189 << 0x10;
    auVar203._0_14_ = auVar189._0_14_;
    auVar203[0xe] = auVar221[8];
    auVar203[0xf] = auVar221[0xc];
    auVar202._14_2_ = auVar203._14_2_;
    auVar202._0_13_ = auVar189._0_13_;
    auVar202[0xd] = auVar221[4];
    auVar201._13_3_ = auVar202._13_3_;
    auVar201._0_12_ = auVar189._0_12_;
    auVar201[0xc] = auVar221[0];
    auVar200._12_4_ = auVar201._12_4_;
    auVar200._0_11_ = auVar189._0_11_;
    auVar200[0xb] = auVar207[0xc];
    auVar199._11_5_ = auVar200._11_5_;
    auVar199._0_10_ = auVar189._0_10_;
    auVar199[10] = auVar207[8];
    auVar198._10_6_ = auVar199._10_6_;
    auVar198._0_9_ = auVar189._0_9_;
    auVar198[9] = auVar207[4];
    auVar197._9_7_ = auVar198._9_7_;
    auVar197._0_8_ = auVar189._0_8_;
    auVar197[8] = auVar207[0];
    Rn._8_8_ = auVar197._8_8_;
    Rn[7] = auVar206[0xc];
    Rn[6] = auVar206[8];
    Rn[5] = auVar206[4];
    Rn[4] = auVar206[0];
    Rn[3] = auVar160[0xc];
    Rn[2] = auVar160[8];
    Rn[1] = auVar160[4];
    auVar86[0xd] = 0;
    auVar86._0_13_ = X._16_13_;
    auVar86[0xe] = X[0x17];
    auVar90[0xc] = X[0x16];
    auVar90._0_12_ = X._16_12_;
    auVar90._13_2_ = auVar86._13_2_;
    uVar93 = auVar90._12_3_;
    auVar96[0xb] = 0;
    auVar96._0_11_ = X._16_11_;
    auVar96._12_3_ = uVar93;
    auVar100[10] = X[0x15];
    auVar100._0_10_ = X._16_10_;
    auVar100._11_4_ = auVar96._11_4_;
    auVar104[9] = 0;
    auVar104._0_9_ = X._16_9_;
    auVar104._10_5_ = auVar100._10_5_;
    auVar108[8] = X[0x14];
    auVar108._0_8_ = X._16_8_;
    auVar108._9_6_ = auVar104._9_6_;
    Var22 = CONCAT91((unkuint9)auVar108._8_7_ << 8,X[0x13]);
    auVar78[10] = 0;
    auVar78._0_10_ = Var22;
    auVar46._1_11_ = auVar78 << 8;
    auVar46[0] = X[0x12];
    auVar77[0xc] = 0;
    auVar77._0_12_ = auVar46;
    auVar45._1_13_ = auVar77 << 8;
    auVar45[0] = X[0x11];
    auVar232[0] = X[0x10];
    auVar232[1] = 0;
    auVar232._2_14_ = auVar45;
    auVar5._10_2_ = 0;
    auVar5._0_10_ = auVar231._0_10_;
    auVar5._12_2_ = (short)Var19;
    uVar109 = CONCAT42(auVar5._10_4_,auVar29._0_2_);
    auVar47._6_8_ = 0;
    auVar47._0_6_ = uVar109;
    auVar11._4_2_ = auVar28._0_2_;
    auVar11._0_4_ = auVar231._0_4_;
    auVar11._6_8_ = SUB148(auVar47 << 0x40,6);
    auVar6._10_2_ = 0;
    auVar6._0_10_ = auVar232._0_10_;
    auVar6._12_2_ = (short)Var22;
    uVar110 = CONCAT42(auVar6._10_4_,auVar46._0_2_);
    auVar48._6_8_ = 0;
    auVar48._0_6_ = uVar110;
    auVar12._4_2_ = auVar45._0_2_;
    auVar12._0_4_ = auVar232._0_4_;
    auVar12._6_8_ = SUB148(auVar48 << 0x40,6);
    auVar204._0_4_ = -(uint)((uint)auVar107._8_2_ + (uint)auVar108._8_2_ == iVar155);
    auVar204._4_4_ = -(uint)((uint)auVar99._10_2_ + (uint)auVar100._10_2_ == iVar157);
    auVar204._8_4_ = -(uint)((uVar91 & 0xffff) + (uVar93 & 0xffff) == iVar158);
    auVar204._12_4_ = -(uint)((uint)(uVar91 >> 0x10) + (uint)(uVar93 >> 0x10) == iVar159);
    auVar208._0_4_ = -(uint)((auVar232._0_4_ & 0xffff) + (auVar231._0_4_ & 0xffff) == iVar155);
    auVar208._4_4_ = -(uint)(auVar12._4_4_ + auVar11._4_4_ == iVar157);
    auVar208._8_4_ = -(uint)((int)uVar110 + (int)uVar109 == iVar158);
    auVar208._12_4_ = -(uint)((auVar6._10_4_ >> 0x10) + (auVar5._10_4_ >> 0x10) == iVar159);
    auVar204 = auVar204 & auVar111;
    auVar208 = auVar208 & auVar111;
    auVar212._0_12_ = auVar208._0_12_;
    auVar212._12_2_ = auVar208._6_2_;
    auVar212._14_2_ = auVar204._6_2_;
    auVar211._12_4_ = auVar212._12_4_;
    auVar211._0_10_ = auVar208._0_10_;
    auVar211._10_2_ = auVar204._4_2_;
    auVar210._10_6_ = auVar211._10_6_;
    auVar210._0_8_ = auVar208._0_8_;
    auVar210._8_2_ = auVar208._4_2_;
    auVar49._2_8_ = auVar210._8_8_;
    auVar49._0_2_ = auVar204._2_2_;
    auVar49._10_6_ = 0;
    auVar209._12_4_ = 0;
    auVar209._0_12_ = SUB1612(auVar49 << 0x30,4);
    auVar209 = auVar209 << 0x20;
    auVar216._0_12_ = auVar209._0_12_;
    auVar216._12_2_ = auVar204._2_2_;
    auVar216._14_2_ = auVar204._10_2_;
    auVar215._12_4_ = auVar216._12_4_;
    auVar215._0_10_ = auVar209._0_10_;
    auVar215._10_2_ = auVar208._10_2_;
    auVar214._10_6_ = auVar215._10_6_;
    auVar214._0_8_ = auVar209._0_8_;
    auVar214._8_2_ = auVar208._2_2_;
    auVar50._2_8_ = auVar214._8_8_;
    auVar50._0_2_ = auVar204._8_2_;
    auVar50._10_6_ = 0;
    auVar213._12_4_ = 0;
    auVar213._0_12_ = SUB1612(auVar50 << 0x30,4);
    auVar213 = auVar213 << 0x20;
    auVar79[0xc] = uVar225;
    auVar79._0_12_ = ZEXT112(bVar226) << 0x40;
    auVar80._10_3_ = auVar79._10_3_;
    auVar80._0_10_ = (unkuint10)bVar224 << 0x40;
    auVar13._6_8_ = SUB148(ZEXT514(auVar80._8_5_) << 0x40,6);
    auVar13._0_6_ = (uint6)bVar223 << 0x20;
    auVar220._0_12_ = auVar213._0_12_;
    auVar220._12_2_ = auVar204._8_2_;
    auVar220._14_2_ = auVar204._12_2_;
    auVar219._12_4_ = auVar220._12_4_;
    auVar219._0_10_ = auVar213._0_10_;
    auVar219._10_2_ = auVar204._4_2_;
    auVar218._10_6_ = auVar219._10_6_;
    auVar218._0_8_ = auVar213._0_8_;
    auVar218._8_2_ = auVar204._0_2_;
    auVar51._2_8_ = auVar218._8_8_;
    auVar51._0_2_ = auVar208._12_2_;
    auVar51._10_6_ = 0;
    auVar217._12_4_ = 0;
    auVar217._0_12_ = SUB1612(auVar51 << 0x30,4);
    auVar217 = auVar217 << 0x20;
    auVar81[0xc] = X[0x1b];
    auVar81._0_12_ = ZEXT112(X[0x1c]) << 0x40;
    auVar82._10_3_ = auVar81._10_3_;
    auVar82._0_10_ = (unkuint10)X[0x1a] << 0x40;
    auVar14._6_8_ = SUB148(ZEXT514(auVar82._8_5_) << 0x40,6);
    auVar14._0_6_ = (uint6)X[0x19] << 0x20;
    auVar205._0_4_ =
         -(uint)((CONCAT12(X[0x19],(ushort)X[0x18]) & 0xffff) +
                 (CONCAT12(bVar223,(ushort)bVar222) & 0xffff) == iVar155);
    auVar205._4_4_ = -(uint)(auVar14._4_4_ + auVar13._4_4_ == iVar157);
    auVar205._8_4_ = -(uint)(auVar82._8_4_ + auVar80._8_4_ == iVar158);
    auVar205._12_4_ =
         -(uint)((uint)(uint3)(auVar81._10_3_ >> 0x10) + (uint)(uint3)(auVar79._10_3_ >> 0x10) ==
                iVar159);
    auVar123._0_4_ = -(uint)((uint)bVar226 + (uint)X[0x1c] == iVar155);
    auVar123._4_4_ = -(uint)((uint)bVar227 + (uint)X[0x1d] == iVar157);
    auVar123._8_4_ = -(uint)((uint)bVar228 + (uint)X[0x1e] == iVar158);
    auVar123._12_4_ = -(uint)((uint)bVar229 + (uint)X[0x1f] == iVar159);
    auVar205 = auVar205 & auVar111;
    auVar123 = auVar123 & auVar111;
    auVar131._0_14_ = auVar217._0_14_;
    auVar131[0xe] = auVar208[0xd];
    auVar131[0xf] = auVar205[0xd];
    auVar130._14_2_ = auVar131._14_2_;
    auVar130._0_13_ = auVar217._0_13_;
    auVar130[0xd] = auVar205[0xc];
    auVar129._13_3_ = auVar130._13_3_;
    auVar129._0_12_ = auVar217._0_12_;
    auVar129[0xc] = auVar208[0xc];
    auVar128._12_4_ = auVar129._12_4_;
    auVar128._0_11_ = auVar217._0_11_;
    auVar128[0xb] = auVar205[9];
    auVar127._11_5_ = auVar128._11_5_;
    auVar127._0_10_ = auVar217._0_10_;
    auVar127[10] = auVar208[9];
    auVar126._10_6_ = auVar127._10_6_;
    auVar126._0_9_ = auVar217._0_9_;
    auVar126[9] = auVar205[8];
    auVar125._9_7_ = auVar126._9_7_;
    auVar125._0_8_ = auVar217._0_8_;
    auVar125[8] = auVar208[8];
    auVar56._1_8_ = auVar125._8_8_;
    auVar56[0] = auVar205[5];
    auVar56._9_7_ = 0;
    auVar55._10_6_ = 0;
    auVar55._0_10_ = SUB1610(auVar56 << 0x38,6);
    auVar54._11_5_ = 0;
    auVar54._0_11_ = SUB1611(auVar55 << 0x30,5);
    auVar53._12_4_ = 0;
    auVar53._0_12_ = SUB1612(auVar54 << 0x28,4);
    auVar52._13_3_ = 0;
    auVar52._0_13_ = SUB1613(auVar53 << 0x20,3);
    Rn[0x10] = auVar208[0];
    auVar124._14_2_ = 0;
    auVar124._0_14_ = SUB1614(auVar52 << 0x18,2);
    auVar124 = auVar124 << 0x10;
    auVar139._0_14_ = auVar124._0_14_;
    auVar139[0xe] = auVar205[5];
    auVar139[0xf] = auVar123[5];
    auVar138._14_2_ = auVar139._14_2_;
    auVar138._0_13_ = auVar124._0_13_;
    auVar138[0xd] = auVar204[5];
    auVar137._13_3_ = auVar138._13_3_;
    auVar137._0_12_ = auVar124._0_12_;
    auVar137[0xc] = auVar208[5];
    auVar136._12_4_ = auVar137._12_4_;
    auVar136._0_11_ = auVar124._0_11_;
    auVar136[0xb] = auVar123[4];
    auVar135._11_5_ = auVar136._11_5_;
    auVar135._0_10_ = auVar124._0_10_;
    auVar135[10] = auVar205[4];
    auVar134._10_6_ = auVar135._10_6_;
    auVar134._0_9_ = auVar124._0_9_;
    auVar134[9] = auVar204[4];
    auVar133._9_7_ = auVar134._9_7_;
    auVar133._0_8_ = auVar124._0_8_;
    auVar133[8] = auVar208[4];
    auVar61._1_8_ = auVar133._8_8_;
    auVar61[0] = auVar123[1];
    auVar61._9_7_ = 0;
    auVar60._10_6_ = 0;
    auVar60._0_10_ = SUB1610(auVar61 << 0x38,6);
    auVar59._11_5_ = 0;
    auVar59._0_11_ = SUB1611(auVar60 << 0x30,5);
    auVar58._12_4_ = 0;
    auVar58._0_12_ = SUB1612(auVar59 << 0x28,4);
    auVar57._13_3_ = 0;
    auVar57._0_13_ = SUB1613(auVar58 << 0x20,3);
    auVar132._14_2_ = 0;
    auVar132._0_14_ = SUB1614(auVar57 << 0x18,2);
    auVar132 = auVar132 << 0x10;
    auVar147._0_14_ = auVar132._0_14_;
    auVar147[0xe] = auVar123[1];
    auVar147[0xf] = auVar123[9];
    auVar146._14_2_ = auVar147._14_2_;
    auVar146._0_13_ = auVar132._0_13_;
    auVar146[0xd] = auVar205[9];
    auVar145._13_3_ = auVar146._13_3_;
    auVar145._0_12_ = auVar132._0_12_;
    auVar145[0xc] = auVar205[1];
    auVar144._12_4_ = auVar145._12_4_;
    auVar144._0_11_ = auVar132._0_11_;
    auVar144[0xb] = auVar204[9];
    auVar143._11_5_ = auVar144._11_5_;
    auVar143._0_10_ = auVar132._0_10_;
    auVar143[10] = auVar204[1];
    auVar142._10_6_ = auVar143._10_6_;
    auVar142._0_9_ = auVar132._0_9_;
    auVar142[9] = auVar208[9];
    auVar141._9_7_ = auVar142._9_7_;
    auVar141._0_8_ = auVar132._0_8_;
    auVar141[8] = auVar208[1];
    auVar66._1_8_ = auVar141._8_8_;
    auVar66[0] = auVar123[8];
    auVar66._9_7_ = 0;
    auVar65._10_6_ = 0;
    auVar65._0_10_ = SUB1610(auVar66 << 0x38,6);
    auVar64._11_5_ = 0;
    auVar64._0_11_ = SUB1611(auVar65 << 0x30,5);
    auVar63._12_4_ = 0;
    auVar63._0_12_ = SUB1612(auVar64 << 0x28,4);
    auVar62._13_3_ = 0;
    auVar62._0_13_ = SUB1613(auVar63 << 0x20,3);
    auVar140._14_2_ = 0;
    auVar140._0_14_ = SUB1614(auVar62 << 0x18,2);
    auVar140 = auVar140 << 0x10;
    auVar154._0_14_ = auVar140._0_14_;
    auVar154[0xe] = auVar123[8];
    auVar154[0xf] = auVar123[0xc];
    auVar153._14_2_ = auVar154._14_2_;
    auVar153._0_13_ = auVar140._0_13_;
    auVar153[0xd] = auVar123[4];
    auVar152._13_3_ = auVar153._13_3_;
    auVar152._0_12_ = auVar140._0_12_;
    auVar152[0xc] = auVar123[0];
    auVar151._12_4_ = auVar152._12_4_;
    auVar151._0_11_ = auVar140._0_11_;
    auVar151[0xb] = auVar205[0xc];
    auVar150._11_5_ = auVar151._11_5_;
    auVar150._0_10_ = auVar140._0_10_;
    auVar150[10] = auVar205[8];
    auVar149._10_6_ = auVar150._10_6_;
    auVar149._0_9_ = auVar140._0_9_;
    auVar149[9] = auVar205[4];
    auVar148._9_7_ = auVar149._9_7_;
    auVar148._0_8_ = auVar140._0_8_;
    auVar148[8] = auVar205[0];
    Rn._24_8_ = auVar148._8_8_;
    Rn[0x17] = auVar204[0xc];
    Rn[0x16] = auVar204[8];
    Rn[0x15] = auVar204[4];
    Rn[0x14] = auVar204[0];
    Rn[0x13] = auVar208[0xc];
    Rn[0x12] = auVar208[8];
    Rn[0x11] = auVar208[4];
    Ln._16_8_ = uVar2;
  } while (cVar119 != '\0');
  Ln._16_8_ = uVar112;
  Expand(A,Rn,Ln);
  Transpose(A,Tab_Swap,0x40);
  Transpose(A,Tab_FinalTr,0x40);
  *(undefined8 *)CipherText = A._0_8_;
  *(undefined8 *)(CipherText + 8) = A._8_8_;
  *(undefined8 *)(CipherText + 0x10) = A._16_8_;
  *(undefined8 *)(CipherText + 0x18) = A._24_8_;
  *(undefined8 *)(CipherText + 0x20) = A._32_8_;
  *(undefined8 *)(CipherText + 0x28) = A._40_8_;
  *(undefined8 *)(CipherText + 0x30) = A._48_8_;
  *(undefined8 *)(CipherText + 0x38) = A._56_8_;
  return 0;
}



// WARNING: Unknown calling convention

int DES_Chr(int Funct,uchar *PlainText,uchar *Key,uchar *CipherText)

{
  uchar P [65];
  uchar K [65];
  uchar C [65];
  
  Binary(PlainText,P);
  Binary(Key,K);
  DES_Bin(Funct,P,K,C);
  Binary_1(C,CipherText);
  return 0;
}



// WARNING: Unknown calling convention

int DES_Hex(int Funct,uchar *PlainText,uchar *Key,uchar *CipherText)

{
  uchar P [9];
  uchar K [9];
  uchar C [9];
  
  HexaDecimal_1(PlainText,P);
  HexaDecimal_1(Key,K);
  DES_Chr(Funct,P,K,C);
  HexaDecimal(C,CipherText);
  return 0;
}



// WARNING: Unknown calling convention

int DES(int Funct,uchar Format,uchar *PlainText,uchar *Key,uchar *CipherText)

{
  if (Format == 'H') {
LAB_004a20c8:
    DES_Hex(Funct,PlainText,Key,CipherText);
    return 0;
  }
  if (Format < 0x49) {
    if (Format == 'B') goto LAB_004a20ae;
  }
  else {
    if (Format == 'b') {
LAB_004a20ae:
      DES_Bin(Funct,PlainText,Key,CipherText);
      return 0;
    }
    if (Format == 'h') goto LAB_004a20c8;
  }
  DES_Chr(Funct,PlainText,Key,CipherText);
  return 0;
}



// WARNING: Unknown calling convention

int Encrypte(uchar *Source,uchar *Key)

{
  DES(1,'\x1c',Source,Key,Source);
  return 0;
}



// WARNING: Unknown calling convention

int Decrypt_hex(uchar *Source,uchar *Key)

{
  DES(-1,0xeb,Source,Key,Source);
  return 0;
}



// WARNING: Unknown calling convention

int Encrypte_hex(uchar *Source,uchar *Key)

{
  DES(1,0xeb,Source,Key,Source);
  return 0;
}



// WARNING: Unknown calling convention

int Decrypte(uchar *Source,uchar *Key)

{
  DES(-1,'\x1c',Source,Key,Source);
  return 0;
}



// WARNING: Unknown calling convention

int KCV_hex(uchar *Source)

{
  uchar T_Key [16];
  
  builtin_memcpy(T_Key,"0000000000000000",0x10);
  DES(1,0xeb,Source,T_Key,Source);
  return 0;
}



// WARNING: Unknown calling convention

int KCV(uchar *Source)

{
  uchar T_Key [8];
  
  T_Key[0] = '\0';
  T_Key[1] = '\0';
  T_Key[2] = '\0';
  T_Key[3] = '\0';
  T_Key[4] = '\0';
  T_Key[5] = '\0';
  T_Key[6] = '\0';
  T_Key[7] = '\0';
  DES(1,'\x1c',Source,T_Key,Source);
  return 0;
}



// WARNING: Unknown calling convention

int KCV_1(uchar *Source)

{
  uchar T_Key [8];
  
  T_Key[0] = '\0';
  T_Key[1] = '\0';
  T_Key[2] = '\0';
  T_Key[3] = '\0';
  T_Key[4] = '\0';
  T_Key[5] = '\0';
  T_Key[6] = '\0';
  T_Key[7] = '\0';
  DES(-1,'\x1c',Source,T_Key,Source);
  return 0;
}



void __libc_csu_init(EVP_PKEY_CTX *param_1,undefined8 param_2,undefined8 param_3)

{
  long lVar1;
  
  lVar1 = 0;
  _init(param_1);
  do {
    (*(code *)(&__frame_dummy_init_array_entry)[lVar1])((ulong)param_1 & 0xffffffff,param_2,param_3)
    ;
    lVar1 = lVar1 + 1;
  } while (lVar1 != 1);
  return;
}



void __libc_csu_fini(void)

{
  return;
}



void _fini(void)

{
  return;
}


